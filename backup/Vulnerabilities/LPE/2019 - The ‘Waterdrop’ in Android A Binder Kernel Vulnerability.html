<!DOCTYPE html>
<!-- saved from url=(0051)https://blogs.360.cn/post/Binder_Kernel_Vul_EN.html -->
<html lang="zh-CN" class=" pc"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no">
  <title>The ‘Waterdrop’ in Android: A Binder Kernel Vulnerability - 360 核心安全技术博客</title>
  <link rel="icon" href="https://blogs.360.cn/blog/20181112/upload_0f0bb5d715da5c3a2e3560e76f48fcd4.ico">
  
  <link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="https://blogs.360.cn/rss.html">
  <link rel="search" type="application/opensearchdescription+xml" href="https://blogs.360.cn/opensearch.xml" title="360 核心安全技术博客">
  <meta name="keywords" content="360, 技术, 前端, 后端, 服务端, 安全, 病毒, 黑客, 攻击">
  <meta name="description" content="分享奇虎360公司的技术，与安全的互联网共同成长。"><link rel="canonical" href="https://blogs.360.cn/post/Binder_Kernel_Vul_EN.html">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="https://blogs.360.cn">
<meta name="twitter:title" content="The ‘Waterdrop’ in Android: A Binder Kernel Vulnerability">
<meta name="twitter:description" content="">
<meta name="twitter:creator" content="admin001">
<meta name="twitter:image" content="">
<meta name="twitter:domain" content="https://blogs.360.cn">
<meta property="og:url" content="https://blogs.360.cn/post/Binder_Kernel_Vul_EN.html">
<meta property="og:title" content="The ‘Waterdrop’ in Android: A Binder Kernel Vulnerability">
<meta property="og:description" content="">
<meta property="og:image" content="">
  <link rel="stylesheet" href="./2019 - The ‘Waterdrop’ in Android A Binder Kernel Vulnerability_files/all.css" type="text/css" data-ls="css_firekylin">
  
  <style>
    

    
    /** 隐藏列表页评论数 **/
/** 取消代码高亮语言显示 **/
#main .meta .comment, article pre b.name {
  display: none;
}

/** 设置正文图片大小统一宽度 **/
#page-post img {
  margin: auto;
}
#page-post p.figure {
  text-align: center;
}
/** 取消正文 center 标签样式 **/
#page-post center {
  text-align: left;
}

/** 正文 pre 样式修改 **/
#page-post pre.pure {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px;
  white-space: pre;
}

.hljs{display:block;overflow-x:auto;padding:0.5em;background:#272822;color:#ddd}.hljs-tag,.hljs-keyword,.hljs-selector-tag,.hljs-literal,.hljs-strong,.hljs-name{color:#f92672}.hljs-code{color:#66d9ef}.hljs-class .hljs-title{color:white}.hljs-attribute,.hljs-symbol,.hljs-regexp,.hljs-link{color:#bf79db}.hljs-string,.hljs-bullet,.hljs-subst,.hljs-title,.hljs-section,.hljs-emphasis,.hljs-type,.hljs-built_in,.hljs-builtin-name,.hljs-selector-attr,.hljs-selector-pseudo,.hljs-addition,.hljs-variable,.hljs-template-tag,.hljs-template-variable{color:#a6e22e}.hljs-comment,.hljs-quote,.hljs-deletion,.hljs-meta{color:#75715e}.hljs-keyword,.hljs-selector-tag,.hljs-literal,.hljs-doctag,.hljs-title,.hljs-section,.hljs-type,.hljs-selector-id{font-weight:bold}
article .entry-content pre .firekylin-code,
article .firekylin-code > ul,
article .firekylin-code li:nth-of-type(even),
article .firekylin-code li:hover,
article .firekylin-code li {
  background-color: #272822 !important;
  border-left: none;
  line-height: 1.5;
}
  </style>
  
</head>
<body>
<nav id="sidebar" class="behavior_1">
  <div class="wrap">
      <div class="profile">
          <a href="https://blogs.360.cn/">
              <img src="./2019 - The ‘Waterdrop’ in Android A Binder Kernel Vulnerability_files/upload_f2fe77d9cf177c20255844973031ff23.png" alt="360 核心安全技术博客">
          </a>
          <span>360 核心安全技术博客</span>
      </div>
      <ul class="buttons">
          
          <li>
              <a class="" href="https://blogs.360.cn/" title="主页 Home">
                  <i class="iconfont icon-home"></i>
                  <span>主页 Home</span>
              </a>
          </li>
          
          <li>
              <a class="" href="https://blogs.360.cn/archives" title="归档 Archive">
                  <i class="iconfont icon-https"></i>
                  <span>归档 Archive</span>
              </a>
          </li>
          
          <li>
              <a class="" href="https://blogs.360.cn/page/cates.html" title="分类 Category">
                  <i class="iconfont icon-archive"></i>
                  <span>分类 Category</span>
              </a>
          </li>
          
          <li>
              <a class="" href="https://blogs.360.cn/about" title="关于 About">
                  <i class="iconfont icon-user"></i>
                  <span>关于 About</span>
              </a>
          </li>
          
      </ul>
      <ul class="buttons">
        <li>
          
          <a class="inline" rel="nofollow" target="_blank" href="https://github.com/Qihoo360">
            <i class="iconfont icon-github-v" title="GitHub"></i>
          </a>
          
          
            
            <a class="inline" rel="nofollow" target="_blank" href="https://twitter.com/360CoreSec">
              <i class="iconfont icon-twitter-v" title="Twitter"></i>
            </a>
            
            
          
          <a class="inline" href="https://blogs.360.cn/rss.html">
            <i class="iconfont icon-rss-v" title="RSS"></i>
          </a>
          <a class="inline" href="https://blogs.360.cn/search.html">
            <i class="iconfont icon-search" title="Search"></i>
          </a>
        </li>
      </ul>
  </div>
</nav>
<div id="header">
  <div class="btn-bar"><i></i></div>
  <h1><a href="https://blogs.360.cn/">360 核心安全技术博客</a></h1>
  <a class="me" href="https://blogs.360.cn/about/"><img src="./2019 - The ‘Waterdrop’ in Android A Binder Kernel Vulnerability_files/upload_f2fe77d9cf177c20255844973031ff23.png" alt="360 核心安全技术博客"></a>
</div>
<div id="sidebar-mask"></div>
<div id="main">

<div id="page-post">
    <article class="post detail">
        <div class="meta">
            <div class="date">03月06, 2019</div>
            <div class="comment">
                <a href="https://blogs.360.cn/post/Binder_Kernel_Vul_EN.html#comments">0 comments</a>
            </div>
        </div>
        <h1 class="title">The ‘Waterdrop’ in Android: A Binder Kernel Vulnerability</h1>
        <div class="entry-content">
            <div class="toc"><ul>
<li><a href="https://blogs.360.cn/post/Binder_Kernel_Vul_EN.html#introduction">Introduction</a></li>
<li><a href="https://blogs.360.cn/post/Binder_Kernel_Vul_EN.html#impact">Impact</a><ul>
<li><a href="https://blogs.360.cn/post/Binder_Kernel_Vul_EN.html#toc-953">The ‘Watrerdrop’</a></li>
<li><a href="https://blogs.360.cn/post/Binder_Kernel_Vul_EN.html#impact">Impact</a></li>
</ul>
</li>
<li><a href="https://blogs.360.cn/post/Binder_Kernel_Vul_EN.html#rootcauses">Root Causes</a><ul>
<li><a href="https://blogs.360.cn/post/Binder_Kernel_Vul_EN.html#basics">Basics</a></li>
<li><a href="https://blogs.360.cn/post/Binder_Kernel_Vul_EN.html#rootcauses">Root causes</a></li>
</ul>
</li>
<li><a href="https://blogs.360.cn/post/Binder_Kernel_Vul_EN.html#exploit">Exploit</a><ul>
<li><a href="https://blogs.360.cn/post/Binder_Kernel_Vul_EN.html#arbitraryaddresswriting">Arbitrary Address Writing</a></li>
<li><a href="https://blogs.360.cn/post/Binder_Kernel_Vul_EN.html#arbitraryaddressreading">Arbitrary Address Reading</a></li>
<li><a href="https://blogs.360.cn/post/Binder_Kernel_Vul_EN.html#informationleakage">Information Leakage</a></li>
</ul>
</li>
<li><a href="https://blogs.360.cn/post/Binder_Kernel_Vul_EN.html#timeline">Timeline</a></li>
<li><a href="https://blogs.360.cn/post/Binder_Kernel_Vul_EN.html#summary">Summary</a></li>
<li><a href="https://blogs.360.cn/post/Binder_Kernel_Vul_EN.html#references">References</a></li>
</ul>
</div><p>Author: Hongli Han(@hexb1n) of Qihoo 360 C0RE Team</p>
<h2><a id="introduction" class="anchor" href="https://blogs.360.cn/post/Binder_Kernel_Vul_EN.html#introduction"></a>Introduction</h2>
<p>Binder is based on OpenBinder and is an important part of the Android operating system. Binder is built on the Binder driver in the Linux kernel. All the inner-process communication that involves Binder needs to communicate with the Binder driver to transfer data. Due to the important role the Binder driver plays in the entire Android system, it has always been one of the focuses of Android security research.</p>
<p>In the binary world, there are certain processes and time points for object generation and destruction. Some are implemented at the compiler level, while others require programmers to maintain them. Once this process is not designed to be perfect, it can leaves chances for an attacker to disrupt its normal life cycle through illegal operations, thus causing a series security problems. When I was conducting a security audit of the Binder driver code in August last year, I found a killing kernel vulnerability which is as destructive as the "Waterdrop" in "the Three-body Problems". It has great destructive power and can be exploited to implement arbitrary address reading/ writing, arbitrary content writing and information leakage by itself. At the same time, the Binder driver is currently one of the few drivers that can be accessed by processes in the sandbox; hence, the vulnerability could be used for sandbox escaping. It is vital risk since such a killing vulnerability is lurking in such an important kernel driver.</p>
<p><strong>Based on this vulnerability, we gained the root access of all the Pixel series mobile phones. Among them, Pixel 3’ operating system represents the highest security defense level of the Google Android kernel. This is the first public ROOT attack since Pixel 3 has been released. I would like to thank @Mingjian_Zhou, Xiaodong Wang(@phybio88), Jun Yao(@_2freeman), Dacheng Shao(@DachengSshao) and other teammates for their support, so that the exploit can be completed on time. At the end of the article, you will find video links of the rooting process [1].</strong></p>
<p>This vulnerability has been published in the <strong>Android Security Updates in March 2019</strong>, and the corresponding vulnerability number is <strong>CVE-2019-2025</strong>. Below I will introduce the vulnerability, its impact, the root causes and exploitation details.</p>
<h2><a id="impact" class="anchor" href="https://blogs.360.cn/post/Binder_Kernel_Vul_EN.html#impact"></a>Impact</h2>
<h3><a id="toc-953" class="anchor" href="https://blogs.360.cn/post/Binder_Kernel_Vul_EN.html#toc-953"></a>The ‘Watrerdrop’</h3>
<p>1) Widespread impact . Basically, almost all the mainstream Android models at home and abroad will be affected; </p>
<p>2) Strong attack ability. The vulnerability can achieve quite stable arbitrary address reading and writing. On the defense side, the existing mitigation measures of the Android kernel vulnerabilities have no effective defense mechanism for the vulnerability with such primitives; </p>
<p>3) Sandbox escapes. It may be used for sandbox escape and directly to gain the ROOT.</p>
<p>At the same time, the Binder driver was merged into the Linux mainline and was released as early as 2015, so all platforms using the Binder module may be affected.</p>
<h3><a id="impact" class="anchor" href="https://blogs.360.cn/post/Binder_Kernel_Vul_EN.html#impact"></a>Impact</h3>
<p>The vulnerability is a USE-AFTER-FREE issue caused by race condition between multiple "binder_ioctl()" calls. Whereas, in earlier designs, "binder_ioctl()" was protected by a less efficient global mutex, so this problem coundl’t be triggered, see Figure 1.</p>
<p><img class="lazy-load" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" data-src="https://blogs.360.cn/blog/20190305/upload_332c8e385ae22028f258dda37e93f9c7.png" alt="image.png"><noscript><img src="https://blogs.360.cn/blog/20190305/upload_332c8e385ae22028f258dda37e93f9c7.png" alt="image.png"></noscript></p>
<p class="figure">Figure 1</p>

<p>This problem is subsequently optimized. From the commit log of the "binder.c" file, you can see that a patch on November 14, 2016 removed this global mutex and optimized it for a more fine-grained mutex. See Figure 2. A complete patch can be found in the link [2].</p>
<p> <img class="lazy-load" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" data-src="https://blogs.360.cn/blog/20190305/upload_893b9f64cd332a06399b30e98220cf87.png" alt="image.png"><noscript><img src="https://blogs.360.cn/blog/20190305/upload_893b9f64cd332a06399b30e98220cf87.png" alt="image.png"></noscript></p>
<p class="figure">Figure 2</p>

<p>The kernel source with this patch may be affected by this vulnerability. Because the vulnerability appears in the general module of the Android system, the kernel version after November 2016 that is currently in use on the market may all be affected. A large number of devices will be at risk before the problem is fixed. The vulnerability can be used to obtain the highest privilege of the system after successful exploitation. The vulnerability may also be used in the remote attack chain. If it is used by the underground economy, it may cause serious hazard to the privacy, propety and personal safety of Android users. .Currently, patches for this vulnerability have been provided on the Linux mainline. Android vendors can refer to the link [3] for timely patching.</p>
<h2><a id="rootcauses" class="anchor" href="https://blogs.360.cn/post/Binder_Kernel_Vul_EN.html#rootcauses"></a>Root Causes</h2>
<h3><a id="basics" class="anchor" href="https://blogs.360.cn/post/Binder_Kernel_Vul_EN.html#basics"></a>Basics</h3>
<p>The Binder mechanism will not be further introduced here. Readers who have known Android should have some knowledge of it. To understand the vulnerability, you need to be familiar with the basic interaction process between the two parties communicating through Binder, as well as some structural objects used in the process. The information about Binder on the network is very rich and you can search to learn by yourself if needed.</p>
<h3><a id="rootcauses" class="anchor" href="https://blogs.360.cn/post/Binder_Kernel_Vul_EN.html#rootcauses"></a>Root causes</h3>
<p>When the client process requests data from the server process by calling "IPCThreadState::transact()", the server process will call "IPCThreadState::sendReply()" to return data to the client process as a response. In this process, the server process will fall into the kernel and call "binder_alloc_new_buf()" to apply for a "struct binder_buffer" type from the "alloc-&gt;free_buffers.rb_node" Red-black tree corresponding to the client process ("target_proc-&gt;alloc"). The object that is applied for will be removed from the "alloc-&gt;free_buffers.rb_node" Red-black tree and chained to the "alloc-&gt;allocated_buffers.rb_node" Red-black tree for maintenance. Afterwards, "t-&gt; Buffer-&gt;allow_user_free" will be assigned a value of 0 to prevent "t-&gt;buffer" from being released during use, as shown in Figure 3.</p>
<p><img class="lazy-load" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" data-src="https://blogs.360.cn/blog/20190305/upload_b9bacf90b2e713588e5010b72c49b054.png" alt="image.png"><noscript><img src="https://blogs.360.cn/blog/20190305/upload_b9bacf90b2e713588e5010b72c49b054.png" alt="image.png"></noscript> </p>
<p class="figure">Figure 3</p>

<p>The client process has the right to release the "t-&gt;buffer", but it happens when the client process receives the message from the server process, ends the interaction and destroys the Parcel object used. However, we can release the "t-&gt;buffer" object in advance by sending a "BC_FREE_BUFFER" request to the kernel, but this needs to satisfy the kernel's check of each parameter, as shown in Figure 4.</p>
<p><img class="lazy-load" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" data-src="https://blogs.360.cn/blog/20190305/upload_8cd81a6b58aeb63689245946ddcfe5f7.png" alt="image.png"><noscript><img src="https://blogs.360.cn/blog/20190305/upload_8cd81a6b58aeb63689245946ddcfe5f7.png" alt="image.png"></noscript> </p>
<p class="figure">Figure 4</p>

<p>The "t-&gt;buffer" mentioned above can be found by passing the corresponding "data_ptr" value to the kernel, and then by calling the "binder_alloc_prepare_to_free()" function. The return value will be assigned to "buffer", and then the kernel will check the validity of "buffer-&gt;allow_user_free" and "buffer-&gt;transaction". Due to the lack of protection of the mutex, there is a race condition problem. If the client process can trigger  "binder_alloc_free_buf()-&gt;binder_free_buf_locked()-&gt;rb_erase()" before “t-&gt;buffer-&gt;allow_user_free”(shown in Figure 3) is assigned with a value of 0, it is possible to remove it from "alloc-&gt;buffers", as shown in Figure 5.</p>
<p><img class="lazy-load" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" data-src="https://blogs.360.cn/blog/20190305/upload_31baa220972642da1f761bca5cb0d803.png" alt="image.png"><noscript><img src="https://blogs.360.cn/blog/20190305/upload_31baa220972642da1f761bca5cb0d803.png" alt="image.png"></noscript> </p>
<p class="figure">Figure 5</p>

<p>Then you can choose the appropriate time to trigger "kfree()" to release it. At this time the USE-AFTER-FREE problem is triggered when the server process continues to use "t-&gt;buffer". In this way, we can use heap spray to achieve arbitrary address reading/ writing and information leakage.</p>
<h2><a id="exploit" class="anchor" href="https://blogs.360.cn/post/Binder_Kernel_Vul_EN.html#exploit"></a>Exploit</h2>
<p>There are hundreds of kernel vulnerabilities reveiled each year, but few are really able to successfully gain privilege acess. In recent years, with the continuous improvement of system protection, some vulnerabilities that can be used for ROOT have become incompetent under the existing protection mechanism. In the general module of Android, such a vulnerability is very rare with ability to read/write arbitrary address, leak information, and possibly being used for sandbox escape. Even with the introduction of some new protection mechanisms to the Android system, such vulnerabilities may still be of high risks. Due to the features of the vulnerability, the attack method is also a thing of ‘the wise see the wisdom’, We have also made several exploit schemes. Here will introduce the basic ideas of the exploits, rather than the specific details.</p>
<h3><a id="arbitraryaddresswriting" class="anchor" href="https://blogs.360.cn/post/Binder_Kernel_Vul_EN.html#arbitraryaddresswriting"></a>Arbitrary Address Writing</h3>
<p>Call the appropriate heap spray function to occupy the "t-&gt;buffer" object. After the heap is successfully sprayed, the "t-&gt;buffer-&gt;data" shown in line 3178 in Figure 3 can be completely controlled by the attacker. "tr- &gt;data.ptr.buffer" is the reply data sent by the server process to the client process, which can be indirectly controlled by the attacker. When the "copy_from_user()" function is executed, an arbitrary address write problem is triggered</p>
<h3><a id="arbitraryaddressreading" class="anchor" href="https://blogs.360.cn/post/Binder_Kernel_Vul_EN.html#arbitraryaddressreading"></a>Arbitrary Address Reading</h3>
<p>The server process will then call the "binder_enqueue_thread_work_ilocked()" function to send a message to the client process, as shown in line 3377 in Figure 6.</p>
<p><img class="lazy-load" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" data-src="https://blogs.360.cn/blog/20190305/upload_e9e593194f0885069bf8301e8659ed20.png" alt="image.png"><noscript><img src="https://blogs.360.cn/blog/20190305/upload_e9e593194f0885069bf8301e8659ed20.png" alt="image.png"></noscript> </p>
<p class="figure">Figure 6</p>

<p>In the meanwhile, the client process calls "IPCThreadState::talkWithDriver()" in a loop to wait for a response from the server process. When a message arrives, the kernel will take out the object of type "struct binder_transaction" sent by the server process by calling the function shown in lines 4100 and 4107 in Figure 7, and save it in the variable "t". "t-&gt; "buffer" is a malicious object that we control. "target_node" is a member variable of the "struct binder_buffer" structure; if it is set to a non-null value, it will be treated as a pointer of type "struct binder_node". The pointer is incremented by 0x58 and 0x5c and assigned to "tr.target.ptr" and "tr.cookie". The kernel then calls "copy_to_user()" as shown in line 4319 to pass the data to the client process. Through this mechanism we can achieve arbitrary address reading.</p>
<p><img class="lazy-load" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" data-src="https://blogs.360.cn/blog/20190305/upload_fd6071ce332aa3335ecac01d4795bc30.png" alt="image.png"><noscript><img src="https://blogs.360.cn/blog/20190305/upload_fd6071ce332aa3335ecac01d4795bc30.png" alt="image.png"></noscript></p>
<p class="figure">Figure 7</p>

<h3><a id="informationleakage" class="anchor" href="https://blogs.360.cn/post/Binder_Kernel_Vul_EN.html#informationleakage"></a>Information Leakage</h3>
<p>Heap spray "t-&gt;buffer" by looking for some structures with sensitive information. "t-&gt;buffer-&gt;target_node", "t-&gt;buffer-&gt;data_size", "t-&gt;buffer-&gt;data" will all serve as information leaks, leaking sensitive data from the heap structure to the client process.</p>
<h2><a id="timeline" class="anchor" href="https://blogs.360.cn/post/Binder_Kernel_Vul_EN.html#timeline"></a>Timeline</h2>
<ul>
<li>2018-08 The vulnerability was discovered and its impact was confirmed</li>
<li>2018-09-28 Submitted to Google</li>
<li>2018-10-06 Google replied for further details of the vulnerability; </li>
<li>2018-10-23 Google confirms the issue; </li>
<li>2018-11-02 Submitted the exploit to Google; </li>
<li>2018-11-06 The issue was fixed on Linux kernel mainline </li>
<li>2018-12-18 Google notified us the releasing time of the vulnerability sent acknowledgements</li>
<li>2019-03-05 Android Security Updates released, a vulnerability number was assigned CVE-2019-2025.</li>
</ul>
<p><img class="lazy-load" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" data-src="https://blogs.360.cn/blog/20190306/upload_60136f5ebe2309b5beb7535e9c66191b.png" alt="image.png"><noscript><img src="https://blogs.360.cn/blog/20190306/upload_60136f5ebe2309b5beb7535e9c66191b.png" alt="image.png"></noscript></p>
<p>We are the first security team to discover the vulnerability and implement successfully exploit to bypass the highest level protection mechanism of Google Android kernel to gain the root access of Pixel series models. Right after the discovery, we submitted this high risk vulnerability to Google. Google responded with great efficiency and sent my team their sincere thanks. </p>
<p><img class="lazy-load" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" data-src="https://blogs.360.cn/blog/20190305/upload_c03abd858bea9ca1ee64762b549423d9.png" alt="image.png"><noscript><img src="https://blogs.360.cn/blog/20190305/upload_c03abd858bea9ca1ee64762b549423d9.png" alt="image.png"></noscript></p>
<h2><a id="summary" class="anchor" href="https://blogs.360.cn/post/Binder_Kernel_Vul_EN.html#summary"></a>Summary</h2>
<p>The vulnerability has a very powerful in attacking theoretically, but there are still certain thresholds in the actual use. The attackers need to be very familiar with the exploiting techniques and the relevant knowledge of the kernel to make stable exploit of it. We have implemented nearly 100% successful triggering on Pixel series devices. In the time of a more and more perfect security protection for Android systems, such vulnerabilities are scarce and are dreamed of by the underground economy. If security researchers can't find and fix the vulnerability before them, he damage and losses caused by illegal large-scale use will be difficult to estimate. We strongly recommend Android manufacturers to patch this vulnerability as soon as possible to prevent users from being exposed to potential risks.</p>
<h2><a id="references" class="anchor" href="https://blogs.360.cn/post/Binder_Kernel_Vul_EN.html#references"></a>References</h2>
<p>[1]<a href="https://weibo.com/tv/v/HaeCNbLmz?fid=1034:4324393006868015">https://weibo.com/tv/v/HaeCNbLmz?fid=1034:4324393006868015</a></p>
<p>[2]<a href="https://lore.kernel.org/patchwork/patch/805040/">https://lore.kernel.org/patchwork/patch/805040/</a></p>
<p>[3]<a href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=7bada55ab50697861eee6bb7d60b41e68a961a9c">https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=7bada55ab50697861eee6bb7d60b41e68a961a9c</a></p>
 </div> <p>本文链接：<a href="https://blogs.360.cn/post/Binder_Kernel_Vul_EN.html">https://blogs.360.cn/post/Binder_Kernel_Vul_EN.html</a></p>
            <p>-- <acronym title="End of File">EOF</acronym> --</p>

            <div class="post-info">
                <p>
                    作者
                    
                    <a href="https://blogs.360.cn/author/admin001" data-user="admin001">
                        <code class="notebook">admin001</code>
                    </a>

                    发表于
                    <i>2019-03-06 02:50:47</i>

                    
                    ，添加在分类
                    
                    <a href="https://blogs.360.cn/cate/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90" data-cate="漏洞分析">
                        <code class="notebook">漏洞分析</code>
                    </a>
                    
                    <a href="https://blogs.360.cn/cate/android%E5%B9%B3%E5%8F%B0" data-cate="android平台">
                        <code class="notebook">android平台</code>
                    </a>
                    
                    <a href="https://blogs.360.cn/cate/vulnerabilities" data-cate="Vulnerability Analysis">
                        <code class="notebook">Vulnerability Analysis</code>
                    </a>
                    
                    下
                    

                    

                    ，最后修改于
                    <i>2019-03-06 14:59:14</i>
                </p>
                
                <p></p><div class="bdsharebuttonbox"><a href="https://blogs.360.cn/post/Binder_Kernel_Vul_EN.html#" class="bds_more" data-cmd="more">分享到：</a><a href="https://blogs.360.cn/post/Binder_Kernel_Vul_EN.html#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博">新浪微博</a><a href="https://blogs.360.cn/post/Binder_Kernel_Vul_EN.html#" class="bds_weixin" data-cmd="weixin" title="分享到微信">微信</a><a href="https://blogs.360.cn/post/Binder_Kernel_Vul_EN.html#" class="bds_twi" data-cmd="twi" title="分享到Twitter">Twitter</a><a href="https://blogs.360.cn/post/Binder_Kernel_Vul_EN.html#" class="bds_evernotecn" data-cmd="evernotecn" title="分享到印象笔记">印象笔记</a><a href="https://blogs.360.cn/post/Binder_Kernel_Vul_EN.html#" class="bds_sqq" data-cmd="sqq" title="分享到QQ好友">QQ好友</a><a href="https://blogs.360.cn/post/Binder_Kernel_Vul_EN.html#" class="bds_youdao" data-cmd="youdao" title="分享到有道云笔记">有道云笔记</a></div><p></p>
                
            </div>
    </article>
    
    <nav class="pagination">
        
        <a href="https://blogs.360.cn/post/Binder_Kernel_Vul_CH.html" class="prev">« “水滴”来袭：详解Binder内核通杀漏洞</a>
        

        
        <a href="https://blogs.360.cn/post/malicious_PE_files_discovered_on_Google%20Play.html" class="next">携带恶意PE文件的壁纸类应用出现在Google Play »</a>
        
    </nav>
    
    
    <div id="comments" data-type="custom" data-thread-key="d41d8cd98f00b204e9800998ecf8427e" data-url="https://blogs.360.cn/post/Binder_Kernel_Vul_EN.html">
    <h1 class="title">Comments</h1>
    

      
      <!---->
      
    
</div>

    
</div>

<footer id="footer" class="inner">
  © 2021&nbsp;-&nbsp; 360 核心安全技术博客
  
    &nbsp;-&nbsp;<a href="https://blogs.360.cn/">blogs.360.cn</a>
  
  <br>
  Powered by&nbsp;<a target="_blank" href="https://thinkjs.org/">ThinkJS</a>&nbsp;&amp;&nbsp;<a target="_blank" rel="nofollow" class="external" href="https://firekylin.org/">FireKylin 1.3.1</a>
</footer>
</div>
<script type="text/javascript" async="" src="./2019 - The ‘Waterdrop’ in Android A Binder Kernel Vulnerability_files/analytics.js.下載"></script><script src="./2019 - The ‘Waterdrop’ in Android A Binder Kernel Vulnerability_files/firekylin.js.下載" data-ls="js_firekylin"></script>

  <!--<script>
(function(b,a,e,h,f,c,g,s){b[h]=b[h]||function(){(b[h].c=b[h].c||[]).push(arguments)};
b[h].s=!!c;g=a.getElementsByTagName(e)[0];s=a.createElement(e);
s.src="//s.union.360.cn/"+f+".js";s.defer=!0;s.async=!0;g.parentNode.insertBefore(s,g)
})(window,document,"script","_qha",299978,false);
</script>
<script>
(function(b,a,e,h,f,c,g,s){b[h]=b[h]||function(){(b[h].c=b[h].c||[]).push(arguments)};
b[h].s=!!c;g=a.getElementsByTagName(e)[0];s=a.createElement(e);
s.src="//s.union.360.cn/"+f+".js";s.defer=!0;s.async=!0;g.parentNode.insertBefore(s,g)
})(window,document,"script","_qha",300084,false);
</script>-->

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async="" src="./2019 - The ‘Waterdrop’ in Android A Binder Kernel Vulnerability_files/js"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-137484248-1');
</script>

<script>if(location.protocol !== 'https:') {
  window._bd_share_config={
    "common":{
      "bdSnsKey":{},
      "bdText":"",
      "bdMini":"2",
      "bdMiniList":false,
      "bdPic":"",
      "bdStyle":"1",
      "bdSize":"16"
    },
    "share":{
      "bdSize":16
    },
    "image":{
      "viewList":["tsina","weixin","twi","evernotecn","sqq","youdao"],
      "viewText":"分享到：",
      "viewSize":"16"
    }
  };
  with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
}

//微信分享
function wxload(src) {
	return new Promise(function(resolve, reject) {
		var s = document.createElement('script');
		s.onload = resolve;
		s.onerror = reject;
		s.src = src;
      	document.body.appendChild(s);
	});
}

function wxjsonp(src) {
  let cbName = 'wxjsonpcb';
  if(window[cbName]) {
    cbName += cbName;
  }
  
  let url = 'https://misc.hao.360.cn/weixin/api?format=json&appKey=360Blogs:360blog:360blog&url='+encodeURIComponent(location.href.split('#')[0])+'&_callback='+cbName;
  return new Promise(function(resolve, reject) {
  	window[cbName] = resolve;
    wxload(url).then(null, reject);
  });
}

function wxshare(wxData) {
    // 第一步：通过通用服务获取config数据
    function getWxConfig() {
      	wxjsonp().then(function(result){
          bindWxEvent(result.data);
        });
    }

    function bindWxEvent(config) {
        wx.config({
          debug: location.search.indexOf('wxdebug=1') > 0,
          appId: config.appId,
          timestamp: config.timestamp,
          nonceStr: config.nonceStr,
          signature: config.signature,
          jsApiList: [
            'checkJsApi',
            'onMenuShareTimeline',
            'onMenuShareAppMessage',
            'onMenuShareQQ',
            'onMenuShareWeibo',
            'hideMenuItems',
            'showMenuItems',
            'hideAllNonBaseMenuItem',
            'showAllNonBaseMenuItem'
          ]
        });
 

        wx.ready(function () {
            wx.onMenuShareTimeline({
                title: wxData.desc, // 分享标题
                link: wxData.link, // 分享链接
                imgUrl: wxData.imgUrl, // 分享图标
                success: function () {
                    // 用户确认分享后执行的回调函数
                },
                cancel: function () {
                    // 用户取消分享后执行的回调函数
                }
            });
            wx.onMenuShareAppMessage({
                title: wxData.title,
                desc: wxData.desc,
                link: wxData.link,
                imgUrl: wxData.imgUrl,
                trigger: function (res) {
                },
                success: function (res) {
                },
                cancel: function (res) {
                },
                fail: function (res) {
                }
            });
        });
    }
 
 	getWxConfig();
}

wxload('https://res.wx.qq.com/open/js/jweixin-1.0.0.js').then(function() {
	const avatar = document.querySelector('.profile img');
  	const content = document.querySelector('#page-post p');
  	const descMeta = document.querySelector('meta[name=description]');
  	return wxshare({
      imgUrl: avatar.src,
      link: location.href,
      title: document.title,
      desc: content ? content.innerText : descMeta.content
	});	
})</script><script src="./2019 - The ‘Waterdrop’ in Android A Binder Kernel Vulnerability_files/jweixin-1.0.0.js.下載"></script>



<script src="./2019 - The ‘Waterdrop’ in Android A Binder Kernel Vulnerability_files/api"></script></body></html>