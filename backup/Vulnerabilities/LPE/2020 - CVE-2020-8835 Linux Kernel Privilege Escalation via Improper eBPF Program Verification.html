<!DOCTYPE html>
<!-- saved from url=(0134)https://www.zerodayinitiative.com/blog/2020/4/8/cve-2020-8835-linux-kernel-privilege-escalation-via-improper-ebpf-program-verification -->
<html xmlns:og="http://opengraphprotocol.org/schema/" xmlns:fb="http://www.facebook.com/2008/fbml" lang="en-US" class="yui3-js-enabled js flexbox canvas canvastext webgl no-touch hashchange history draganddrop rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients cssreflections csstransforms no-csstransforms3d csstransitions video audio svg inlinesvg svgclippaths" style="" id="yui_3_17_2_1_1638469490801_121"><div id="yui3-css-stamp" style="position: absolute !important; visibility: hidden !important"></div><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <meta name="viewport" content="width=device-width,initial-scale=1">
    

    <link href="./2020 - CVE-2020-8835 Linux Kernel Privilege Escalation via Improper eBPF Program Verification_files/css" rel="stylesheet"> 
    <link href="./2020 - CVE-2020-8835 Linux Kernel Privilege Escalation via Improper eBPF Program Verification_files/icon" rel="stylesheet">

    <!--INCLUDE SQS SCRIPTS, META TAGS AND USER CONTENT FROM THE CODE INJECTION TAB-->

    <!-- This is Squarespace. --><!-- brian-gorenc -->
<link charset="utf-8" rel="stylesheet" id="yui_3_17_2_1_1638469490801_253" href="./2020 - CVE-2020-8835 Linux Kernel Privilege Escalation via Improper eBPF Program Verification_files/simple-liking-47606e375db2b296c3464-min.en-US.css"><script charset="utf-8" id="yui_3_17_2_1_1638469490801_252" src="./2020 - CVE-2020-8835 Linux Kernel Privilege Escalation via Improper eBPF Program Verification_files/simple-liking-84b2629024662e9fb2c97-min.en-US.js.下載"></script><link charset="utf-8" rel="stylesheet" id="yui_3_17_2_1_1638469490801_257" href="./2020 - CVE-2020-8835 Linux Kernel Privilege Escalation via Improper eBPF Program Verification_files/social-buttons-b186d09e02921fd7f8e00-min.en-US.css"><script charset="utf-8" id="yui_3_17_2_1_1638469490801_256" src="./2020 - CVE-2020-8835 Linux Kernel Privilege Escalation via Improper eBPF Program Verification_files/social-buttons-b1c03a6501dfedc48861a-min.en-US.js.下載"></script><!--<base href="">--><base href=".">

<title>Zero Day Initiative — CVE-2020-8835: Linux Kernel Privilege Escalation via Improper eBPF Program Verification</title>
<link rel="shortcut icon" type="image/x-icon" href="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1487670157237-HOXHMI54TA0SZP21OY7C/favicon.ico">
<link rel="canonical" href="https://www.thezdi.com/blog/2020/4/8/cve-2020-8835-linux-kernel-privilege-escalation-via-improper-ebpf-program-verification">
<meta property="og:site_name" content="Zero Day Initiative">
<meta property="og:title" content="Zero Day Initiative — CVE-2020-8835: Linux Kernel Privilege Escalation via Improper eBPF Program Verification">
<meta property="og:latitude" content="40.7207559">
<meta property="og:longitude" content="-74.0007613">
<meta property="og:locality" content="">
<meta property="og:url" content="https://www.thezdi.com/blog/2020/4/8/cve-2020-8835-linux-kernel-privilege-escalation-via-improper-ebpf-program-verification">
<meta property="og:type" content="article">
<meta property="og:description" content="During the recent    Pwn2Own 2020    competition, Manfred Paul (   @_manfp   ) of    RedRocket CTF    used an improper input validation bug in the Linux kernel to go from a standard user to root. Manfred used this bug during the contest to win $30,000 in the Privilege Escalation category. He has gra">
<meta property="og:image" content="http://static1.squarespace.com/static/5894c269e4fcb5e65a1ed623/58a5b38cb3db2bd67b608658/5e8e2ebde23ec1577ee2fcd9/1587049552452/Pwn2Own+Blur.png?format=1500w">
<meta property="og:image:width" content="1500">
<meta property="og:image:height" content="892">
<meta itemprop="name" content="Zero Day Initiative — CVE-2020-8835: Linux Kernel Privilege Escalation via Improper eBPF Program Verification">
<meta itemprop="url" content="https://www.thezdi.com/blog/2020/4/8/cve-2020-8835-linux-kernel-privilege-escalation-via-improper-ebpf-program-verification">
<meta itemprop="description" content="During the recent    Pwn2Own 2020    competition, Manfred Paul (   @_manfp   ) of    RedRocket CTF    used an improper input validation bug in the Linux kernel to go from a standard user to root. Manfred used this bug during the contest to win $30,000 in the Privilege Escalation category. He has gra">
<meta itemprop="thumbnailUrl" content="http://static1.squarespace.com/static/5894c269e4fcb5e65a1ed623/58a5b38cb3db2bd67b608658/5e8e2ebde23ec1577ee2fcd9/1587049552452/Pwn2Own+Blur.png?format=1500w">
<link rel="image_src" href="http://static1.squarespace.com/static/5894c269e4fcb5e65a1ed623/58a5b38cb3db2bd67b608658/5e8e2ebde23ec1577ee2fcd9/1587049552452/Pwn2Own+Blur.png?format=1500w">
<meta itemprop="image" content="http://static1.squarespace.com/static/5894c269e4fcb5e65a1ed623/58a5b38cb3db2bd67b608658/5e8e2ebde23ec1577ee2fcd9/1587049552452/Pwn2Own+Blur.png?format=1500w">
<meta itemprop="author" content="Guest Blogger">
<meta itemprop="datePublished" content="2020-04-16T10:05:52-0500">
<meta itemprop="dateModified" content="2020-04-16T10:05:52-0500">
<meta itemprop="headline" content="CVE-2020-8835: Linux Kernel Privilege Escalation via Improper eBPF Program Verification">
<meta itemprop="publisher" content="Zero Day Initiative">
<meta name="twitter:title" content="Zero Day Initiative — CVE-2020-8835: Linux Kernel Privilege Escalation via Improper eBPF Program Verification">
<meta name="twitter:image" content="http://static1.squarespace.com/static/5894c269e4fcb5e65a1ed623/58a5b38cb3db2bd67b608658/5e8e2ebde23ec1577ee2fcd9/1587049552452/Pwn2Own+Blur.png?format=1500w">
<meta name="twitter:url" content="https://www.thezdi.com/blog/2020/4/8/cve-2020-8835-linux-kernel-privilege-escalation-via-improper-ebpf-program-verification">
<meta name="twitter:card" content="summary">
<meta name="twitter:description" content="During the recent    Pwn2Own 2020    competition, Manfred Paul (   @_manfp   ) of    RedRocket CTF    used an improper input validation bug in the Linux kernel to go from a standard user to root. Manfred used this bug during the contest to win $30,000 in the Privilege Escalation category. He has gra">
<meta name="description" content="">
<link rel="preconnect" href="https://images.squarespace-cdn.com/">
<link rel="stylesheet" type="text/css" href="./2020 - CVE-2020-8835 Linux Kernel Privilege Escalation via Improper eBPF Program Verification_files/css2">
<script async="" src="./2020 - CVE-2020-8835 Linux Kernel Privilege Escalation via Improper eBPF Program Verification_files/analytics.js.下載"></script><script type="text/javascript" crossorigin="anonymous" nomodule="nomodule" src="./2020 - CVE-2020-8835 Linux Kernel Privilege Escalation via Improper eBPF Program Verification_files/legacy.js.下載"></script>
<script type="text/javascript" crossorigin="anonymous" src="./2020 - CVE-2020-8835 Linux Kernel Privilege Escalation via Improper eBPF Program Verification_files/modern.js.下載"></script>
<script type="text/javascript">SQUARESPACE_ROLLUPS = {};</script>
<script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/moment-js-vendor-26ddeab7fa5f90b6c8cb3-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-moment_js_vendor');</script>
<script crossorigin="anonymous" src="./2020 - CVE-2020-8835 Linux Kernel Privilege Escalation via Improper eBPF Program Verification_files/moment-js-vendor-26ddeab7fa5f90b6c8cb3-min.en-US.js.下載"></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/cldr-resource-pack-be81d1ce004cbca505842-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-cldr_resource_pack');</script>
<script crossorigin="anonymous" src="./2020 - CVE-2020-8835 Linux Kernel Privilege Escalation via Improper eBPF Program Verification_files/cldr-resource-pack-be81d1ce004cbca505842-min.en-US.js.下載"></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/common-vendors-stable-5f58a0e5b599c258afba7-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-common_vendors_stable');</script>
<script crossorigin="anonymous" src="./2020 - CVE-2020-8835 Linux Kernel Privilege Escalation via Improper eBPF Program Verification_files/common-vendors-stable-5f58a0e5b599c258afba7-min.en-US.js.下載"></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/common-vendors-2b8d103c58c279879debb-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-common_vendors');</script>
<script crossorigin="anonymous" src="./2020 - CVE-2020-8835 Linux Kernel Privilege Escalation via Improper eBPF Program Verification_files/common-vendors-2b8d103c58c279879debb-min.en-US.js.下載"></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/common-4e8968d09e387393951e6-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-common');</script>
<script crossorigin="anonymous" src="./2020 - CVE-2020-8835 Linux Kernel Privilege Escalation via Improper eBPF Program Verification_files/common-4e8968d09e387393951e6-min.en-US.js.下載"></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/performance-bc3576cf7eca79df62e49-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-performance');</script>
<script crossorigin="anonymous" src="./2020 - CVE-2020-8835 Linux Kernel Privilege Escalation via Improper eBPF Program Verification_files/performance-bc3576cf7eca79df62e49-min.en-US.js.下載" defer=""></script><script data-name="static-context">Static = window.Static || {}; Static.SQUARESPACE_CONTEXT = {"facebookAppId":"314192535267336","facebookApiVersion":"v6.0","rollups":{"squarespace-announcement-bar":{"js":"//assets.squarespace.com/universal/scripts-compressed/announcement-bar-2f7261bafe0cccffc79c1-min.en-US.js"},"squarespace-audio-player":{"css":"//assets.squarespace.com/universal/styles-compressed/audio-player-7273d8fcec67906942b35-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/audio-player-bf3733dc1a7a1a312f00b-min.en-US.js"},"squarespace-blog-collection-list":{"css":"//assets.squarespace.com/universal/styles-compressed/blog-collection-list-3d55c64c25996c7633fc2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/blog-collection-list-41fb020c05858537c749a-min.en-US.js"},"squarespace-calendar-block-renderer":{"css":"//assets.squarespace.com/universal/styles-compressed/calendar-block-renderer-5668de53c0ce16e20cc01-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/calendar-block-renderer-8e106d6ff1e1b025652e1-min.en-US.js"},"squarespace-chartjs-helpers":{"css":"//assets.squarespace.com/universal/styles-compressed/chartjs-helpers-58ae73137091cd0a61360-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/chartjs-helpers-f7fcba491a8523ac88fff-min.en-US.js"},"squarespace-comments":{"css":"//assets.squarespace.com/universal/styles-compressed/comments-eeb99f32a31032af774cb-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/comments-6f87194ca559fd42b7649-min.en-US.js"},"squarespace-commerce-cart":{"js":"//assets.squarespace.com/universal/scripts-compressed/commerce-cart-1bf72f78bcd6ff67a17f4-min.en-US.js"},"squarespace-dialog":{"css":"//assets.squarespace.com/universal/styles-compressed/dialog-7b3fdec47b80fd63e5e6f-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/dialog-cbcfce3803b0c7c3a195c-min.en-US.js"},"squarespace-events-collection":{"css":"//assets.squarespace.com/universal/styles-compressed/events-collection-5668de53c0ce16e20cc01-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/events-collection-32833edadee64550abcb4-min.en-US.js"},"squarespace-form-rendering-utils":{"js":"//assets.squarespace.com/universal/scripts-compressed/form-rendering-utils-bb354724a3757df74ec71-min.en-US.js"},"squarespace-forms":{"css":"//assets.squarespace.com/universal/styles-compressed/forms-1cc007b21ede0b73086c9-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/forms-40e56e15ffcec85859b95-min.en-US.js"},"squarespace-gallery-collection-list":{"css":"//assets.squarespace.com/universal/styles-compressed/gallery-collection-list-3d55c64c25996c7633fc2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/gallery-collection-list-cd5d8e548068a3a2586f7-min.en-US.js"},"squarespace-image-zoom":{"css":"//assets.squarespace.com/universal/styles-compressed/image-zoom-60e14b9bac69739c96fa7-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/image-zoom-fa19933bfc5ac12f6e17f-min.en-US.js"},"squarespace-pinterest":{"css":"//assets.squarespace.com/universal/styles-compressed/pinterest-3d55c64c25996c7633fc2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/pinterest-94a487a04e13fea79ec08-min.en-US.js"},"squarespace-popup-overlay":{"css":"//assets.squarespace.com/universal/styles-compressed/popup-overlay-e4ea05bd2ae9c1568e432-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/popup-overlay-b061b4158487e7ae7e527-min.en-US.js"},"squarespace-product-quick-view":{"css":"//assets.squarespace.com/universal/styles-compressed/product-quick-view-663fb8b8c08febe7303f1-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/product-quick-view-d8b0257186afe8865af43-min.en-US.js"},"squarespace-products-collection-item-v2":{"css":"//assets.squarespace.com/universal/styles-compressed/products-collection-item-v2-60e14b9bac69739c96fa7-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/products-collection-item-v2-dbbb091f4df62f531003e-min.en-US.js"},"squarespace-products-collection-list-v2":{"css":"//assets.squarespace.com/universal/styles-compressed/products-collection-list-v2-60e14b9bac69739c96fa7-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/products-collection-list-v2-49760745a9d44239d49d0-min.en-US.js"},"squarespace-search-page":{"css":"//assets.squarespace.com/universal/styles-compressed/search-page-568ad8f2a40e76c0175c8-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/search-page-c5f76c478bd25aaf2e466-min.en-US.js"},"squarespace-search-preview":{"js":"//assets.squarespace.com/universal/scripts-compressed/search-preview-6766a2def97ff8ef1ecfb-min.en-US.js"},"squarespace-share-buttons":{"js":"//assets.squarespace.com/universal/scripts-compressed/share-buttons-b677b0661ada7b7447f04-min.en-US.js"},"squarespace-simple-liking":{"css":"//assets.squarespace.com/universal/styles-compressed/simple-liking-47606e375db2b296c3464-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/simple-liking-84b2629024662e9fb2c97-min.en-US.js"},"squarespace-social-buttons":{"css":"//assets.squarespace.com/universal/styles-compressed/social-buttons-b186d09e02921fd7f8e00-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/social-buttons-b1c03a6501dfedc48861a-min.en-US.js"},"squarespace-tourdates":{"css":"//assets.squarespace.com/universal/styles-compressed/tourdates-3d55c64c25996c7633fc2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/tourdates-63b620d61e3da5004abf0-min.en-US.js"},"squarespace-website-overlays-manager":{"css":"//assets.squarespace.com/universal/styles-compressed/website-overlays-manager-5c2f030f6ee94f066dc3d-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/website-overlays-manager-c7281d57b648e036b6739-min.en-US.js"}},"pageType":50,"website":{"id":"5894c269e4fcb5e65a1ed623","identifier":"brian-gorenc","websiteType":1,"contentModifiedOn":1635895979747,"cloneable":false,"hasBeenCloneable":false,"developerMode":true,"siteStatus":{},"language":"en-US","timeZone":"America/Chicago","machineTimeZoneOffset":-21600000,"timeZoneOffset":-21600000,"timeZoneAbbr":"CST","siteTitle":"Zero Day Initiative","fullSiteTitle":"Zero Day Initiative \u2014 CVE-2020-8835: Linux Kernel Privilege Escalation via Improper eBPF Program Verification","siteDescription":"","shareButtonOptions":{"3":true,"2":true,"1":true,"6":true,"4":true},"authenticUrl":"https://www.thezdi.com","internalUrl":"https://brian-gorenc.squarespace.com","baseUrl":"https://www.thezdi.com","primaryDomain":"www.thezdi.com","sslSetting":3,"socialAccounts":[{"serviceId":4,"userId":"86973588","userName":"thezdi","screenname":"Zero Day Initiative","addedOn":1492718968086,"profileUrl":"https://twitter.com/thezdi","iconUrl":"http://pbs.twimg.com/profile_images/626740860508442632/dC1lsJPl_normal.png","collectionId":"58f91578e58c6231c1daf261","iconEnabled":true,"serviceName":"twitter"},{"serviceId":11,"userId":"UChbH7B5YhXANmlMYJRHpw0g","screenname":"TippingPoint Zero Day Initiative","addedOn":1492722141068,"profileUrl":"https://www.youtube.com/channel/UChbH7B5YhXANmlMYJRHpw0g","iconUrl":"https://yt3.ggpht.com/-5tyoeQlg_Jk/AAAAAAAAAAI/AAAAAAAAAAA/lrjg7w8bQgA/s88-c-k-no-mo-rj-c0xffffff/photo.jpg","iconEnabled":true,"serviceName":"youtube"}],"typekitId":"","statsMigrated":false,"imageMetadataProcessingEnabled":false,"screenshotId":"a0a901f81f08cc6c7c9e5108d43c513fa4847e74de2b39c335909e3f8dd88d34","showOwnerLogin":false},"websiteSettings":{"id":"5894c269e4fcb5e65a1ed625","websiteId":"5894c269e4fcb5e65a1ed623","subjects":[],"country":"US","state":"TX","simpleLikingEnabled":true,"mobileInfoBarSettings":{"isContactEmailEnabled":false,"isContactPhoneNumberEnabled":false,"isLocationEnabled":false,"isBusinessHoursEnabled":false},"commentLikesAllowed":true,"commentAnonAllowed":true,"commentThreaded":true,"commentApprovalRequired":false,"commentAvatarsOn":true,"commentSortType":2,"commentFlagThreshold":0,"commentFlagsAllowed":true,"commentEnableByDefault":true,"commentDisableAfterDaysDefault":0,"disqusShortname":"","commentsEnabled":false,"contactPhoneNumber":"","storeSettings":{"returnPolicy":null,"termsOfService":null,"privacyPolicy":null,"expressCheckout":false,"continueShoppingLinkUrl":"/","useLightCart":false,"showNoteField":false,"shippingCountryDefaultValue":"US","billToShippingDefaultValue":false,"showShippingPhoneNumber":true,"isShippingPhoneRequired":false,"showBillingPhoneNumber":true,"isBillingPhoneRequired":false,"currenciesSupported":["CHF","HKD","MXN","EUR","DKK","USD","CAD","MYR","NOK","THB","AUD","SGD","ILS","PLN","GBP","CZK","SEK","NZD","PHP","RUB"],"defaultCurrency":"USD","selectedCurrency":"USD","measurementStandard":1,"showCustomCheckoutForm":false,"checkoutPageMarketingOptInEnabled":false,"enableMailingListOptInByDefault":false,"sameAsRetailLocation":false,"merchandisingSettings":{"scarcityEnabledOnProductItems":false,"scarcityEnabledOnProductBlocks":false,"scarcityMessageType":"DEFAULT_SCARCITY_MESSAGE","scarcityThreshold":10,"multipleQuantityAllowedForServices":true,"restockNotificationsEnabled":false,"restockNotificationsMailingListSignUpEnabled":false,"relatedProductsEnabled":false,"relatedProductsOrdering":"random","soldOutVariantsDropdownDisabled":false,"productComposerOptedIn":false,"productComposerABTestOptedOut":false,"productReviewsEnabled":false},"isLive":false,"multipleQuantityAllowedForServices":true},"useEscapeKeyToLogin":true,"ssBadgeType":1,"ssBadgePosition":4,"ssBadgeVisibility":1,"ssBadgeDevices":1,"pinterestOverlayOptions":{"mode":"disabled"},"ampEnabled":false},"cookieSettings":{"isCookieBannerEnabled":false,"isRestrictiveCookiePolicyEnabled":false,"isRestrictiveCookiePolicyAbsolute":false,"cookieBannerText":"","cookieBannerTheme":"","cookieBannerVariant":"","cookieBannerPosition":"","cookieBannerCtaVariant":"","cookieBannerCtaText":"","cookieBannerAcceptType":"OPT_IN","cookieBannerOptOutCtaText":""},"websiteCloneable":false,"collection":{"title":"Blog","id":"58a5b38cb3db2bd67b608658","fullUrl":"/blog","type":1,"permissionType":1},"item":{"title":"CVE-2020-8835: Linux Kernel Privilege Escalation via Improper eBPF Program Verification","id":"5e8e2ebde23ec1577ee2fcd9","fullUrl":"/blog/2020/4/8/cve-2020-8835-linux-kernel-privilege-escalation-via-improper-ebpf-program-verification","publicCommentCount":0,"commentState":2,"recordType":1},"subscribed":false,"appDomain":"squarespace.com","templateTweakable":false,"tweakJSON":{"aspect-ratio":"Auto","gallery-arrow-style":"No Background","gallery-aspect-ratio":"3:2 Standard","gallery-auto-crop":"true","gallery-autoplay":"false","gallery-design":"Slideshow","gallery-info-overlay":"Show on Hover","gallery-loop":"false","gallery-navigation":"Bullets","gallery-show-arrows":"true","gallery-transitions":"Fade","galleryArrowBackground":"rgba(34,34,34,1)","galleryArrowColor":"rgba(255,255,255,1)","galleryAutoplaySpeed":"3","galleryCircleColor":"rgba(255,255,255,1)","galleryInfoBackground":"rgba(0, 0, 0, .7)","galleryThumbnailSize":"100px","gridSize":"350px","gridSpacing":"20px","product-gallery-auto-crop":"true","product-image-auto-crop":"true","tweak-v1-related-products-title-spacing":"50px"},"templateId":"58a5cc48579fb3f464465a0c","templateVersion":"7","pageFeatures":[1,2,4],"gmRenderKey":"QUl6YVN5Q0JUUk9xNkx1dkZfSUUxcjQ2LVQ0QWVUU1YtMGQ3bXk4","templateScriptsRootUrl":"https://static1.squarespace.com/static/ta/5894c269e4fcb5e65a1ed623/26/scripts/","betaFeatureFlags":["commerce_checkout_marketing_opt_in","viewer-role-contributor-invites","campaigns_global_uc_ab","startup_checklist","commerce_instagram_product_checkout_links","product_composer_feedback_form_on_save","uas_swagger_session_client","nested_categories_migration_enabled","campaigns_audience_card","campaigns_banner_reduce_size","commerce_product_branching","campaigns_show_apply_website_styles_button","commerce_multiple_product_reviews","commerce_restock_notifications","commerce_category_id_discounts_enabled","campaigns_blog_product_image_editor","commerce_etsy_product_import","background_art_onboarding","commerce_product_review_etsy_import","transactional_email_pipeline_v2_enabled","commerce_native_product_reviews","campaigns_thumbnail_layout","uas_swagger_unauthenticated_session_client","commerce_product_review_import_ga","commerce_afterpay_pdp","commerce_pdp_survey_modal","member_areas_schedule_interview","commerce_product_composer_ab_test_all_users","tock_block","reduce_general_search_api_traffic","member_areas_annual_subscriptions","customer_account_creation_recaptcha","uas_swagger_token_client","commerce_etsy_shipping_import","commerce_activation_experiment_add_payment_processor_card","uas_swagger_site_user_account_client","campaigns_section_reorder_arrows","commerce_pdp_layouts","campaigns_new_subscriber_search","campaigns_hide_deleted_automations_panel","commerce_onboarding_tools_screen_test","commerce_site_visitor_metrics","member_areas_billing_state_migration","category-delete-product-service-enabled"],"impersonatedSession":false,"tzData":{"zones":[[-360,"US","C%sT",null]],"rules":{"US":[[1967,2006,null,"Oct","lastSun","2:00","0","S"],[1987,2006,null,"Apr","Sun>=1","2:00","1:00","D"],[2007,"max",null,"Mar","Sun>=8","2:00","1:00","D"],[2007,"max",null,"Nov","Sun>=1","2:00","0","S"]]}},"showAnnouncementBar":false};</script><script type="text/javascript"> SquarespaceFonts.loadViaContext(); Squarespace.load(window);</script><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="https://www.thezdi.com/blog?format=rss">
<script type="application/ld+json">{"url":"https://www.thezdi.com","name":"Zero Day Initiative","description":"","@context":"http://schema.org","@type":"WebSite"}</script><script type="application/ld+json">{"name":"Zero Day Initiative \u2014 CVE-2020-8835: Linux Kernel Privilege Escalation via Improper eBPF Program Verification","url":"https://www.thezdi.com/blog/2020/4/8/cve-2020-8835-linux-kernel-privilege-escalation-via-improper-ebpf-program-verification","datePublished":"2020-04-16T10:05:52-0500","dateModified":"2020-04-16T10:05:52-0500","headline":"CVE-2020-8835: Linux Kernel Privilege Escalation via Improper eBPF Program Verification","author":"Guest Blogger","publisher":{"name":"Zero Day Initiative","logo":{"@type":"ImageObject"},"@context":"http://schema.org","@type":"Organization"},"image":"http://static1.squarespace.com/static/5894c269e4fcb5e65a1ed623/58a5b38cb3db2bd67b608658/5e8e2ebde23ec1577ee2fcd9/1587049552452/Pwn2Own+Blur.png?format=1500w","@context":"http://schema.org","@type":"Article"}</script><link rel="stylesheet" type="text/css" href="./2020 - CVE-2020-8835 Linux Kernel Privilege Escalation via Improper eBPF Program Verification_files/site.css"><script>
if (window.location.host == "www.thezdi.com") {window.location = "https://www.zerodayinitiative.com" + window.location.pathname}</script><script>Static.COOKIE_BANNER_CAPABLE = true;</script>
<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create', 'UA-93169700-1', 'auto');ga('send', 'pageview');</script><!-- End of Squarespace Headers -->
    <link rel="stylesheet" href="./2020 - CVE-2020-8835 Linux Kernel Privilege Escalation via Improper eBPF Program Verification_files/main.css">


  </head>

  <body id="item-5e8e2ebde23ec1577ee2fcd9" class="event-show-past-events event-thumbnails event-thumbnail-size-32-standard event-date-label  event-list-show-cats event-list-date event-list-time event-list-address   event-icalgcal-links  event-excerpts      gallery-design-slideshow aspect-ratio-auto lightbox-style-dark gallery-navigation-bullets gallery-info-overlay-show-on-hover gallery-aspect-ratio-32-standard gallery-arrow-style-no-background gallery-transitions-fade gallery-show-arrows gallery-auto-crop   product-list-titles-under product-list-alignment-left product-item-size-11-square product-image-auto-crop product-gallery-size-11-square product-gallery-auto-crop show-product-price show-product-item-nav product-social-sharing tweak-v1-related-products-image-aspect-ratio-11-square tweak-v1-related-products-details-alignment-center newsletter-style-dark hide-opentable-icons opentable-style-dark small-button-style-solid small-button-shape-square medium-button-style-solid medium-button-shape-square large-button-style-solid large-button-shape-square image-block-poster-text-alignment-center image-block-card-dynamic-font-sizing image-block-card-content-position-center image-block-card-text-alignment-left image-block-overlap-dynamic-font-sizing image-block-overlap-content-position-center image-block-overlap-text-alignment-left image-block-collage-dynamic-font-sizing image-block-collage-content-position-top image-block-collage-text-alignment-left image-block-stack-dynamic-font-sizing image-block-stack-text-alignment-left button-style-solid button-corner-style-square tweak-product-quick-view-button-style-floating tweak-product-quick-view-button-position-bottom tweak-product-quick-view-lightbox-excerpt-display-truncate tweak-product-quick-view-lightbox-show-arrows tweak-product-quick-view-lightbox-show-close-button tweak-product-quick-view-lightbox-controls-weight-light native-currency-code-usd collection-58a5b38cb3db2bd67b608658 view-item collection-type-blog collection-layout-default mobile-style-available">

    <div id="outerWrapper">

      <div id="bgOverlay"></div>

      <!--HEADER-->

      <header id="header">

        <!--MAIN NAVIGATION-->
            <!-- Begin Off Canvas Menu-->
    <div class="off-canvas">
        <nav class="off-canvas__list" role="main-navigation2">
            <div class="js-mobile-nav-toggle">Menu</div>
            <ul class="topMenu">
                <li class="nav__tier1"><a href="https://www.trendmicro.com/privacy">PRIVACY</a></li>
                <li class="nav__tier1"><a href="https://www.zerodayinitiative.com/about">WHO WE ARE</a></li>
                <li class="nav__tier1"><a href="https://www.zerodayinitiative.com/about/benefits">HOW IT WORKS</a></li>
                <li class="nav__tier1"><a href="https://www.zerodayinitiative.com/blog">BLOG</a></li>
                <li class="nav__tier1"><a href="https://www.zerodayinitiative.com/advisories">ADVISORIES</a></li>
                <li class="nav__tier1"><a class="sign-in" href="https://www.zerodayinitiative.com/portal">LOG IN</a></li>
                <li class="nav__tier1"><a class="sign-in" href="https://www.zerodayinitiative.com/portal/register">SIGN UP</a></li>
            </ul>
            <ul class="bottomMenu">
                <li class="nav__tier1 logo"><a href="https://www.zerodayinitiative.com/"><img src="./2020 - CVE-2020-8835 Linux Kernel Privilege Escalation via Improper eBPF Program Verification_files/logo.svg" width="125" height="37" alt="thezdi"></a></li>
                <li class="nav__tier1"><a href="https://www.trendmicro.com/">Trend Micro</a></li>
            </ul>
        </nav>
    </div>
    <!-- End Off Canvas Menu -->
            <div id="nav" class="group">
        <div id="navContent">
            <div class="nav__container">
                <div class="nav__header">
                    <div class="global-header__logo">
                        <a href="https://www.zerodayinitiative.com/"><img src="./2020 - CVE-2020-8835 Linux Kernel Privilege Escalation via Improper eBPF Program Verification_files/logo.svg" alt="thezdi"></a>
                    </div>
                    <div id="mobileNavIcon" class="js-mobile-nav-toggle">Menu</div>
                    <div id="mobileOverlay"></div>
                </div>
                <nav class="nav__list" role="main-navigation">
                    <ul class="list-no-bullets">
                        <li class="nav__tier1"><a href="https://www.trendmicro.com/privacy">PRIVACY</a></li>
                        <li class="nav__tier1"><a href="https://www.zerodayinitiative.com/about">WHO WE ARE</a></li>
                        <li class="nav__tier1"><a href="https://www.zerodayinitiative.com/about/benefits">HOW IT WORKS</a></li>
                        <li class="nav__tier1"><a href="https://www.zerodayinitiative.com/blog">BLOG</a></li>
                        <li class="nav__tier1"><a href="https://www.zerodayinitiative.com/advisories">ADVISORIES</a></li>
                        <li class="nav__tier1 userActions">
                            <a href="https://www.zerodayinitiative.com/portal/">LOG IN</a>
                            <a href="https://www.zerodayinitiative.com/portal/register">SIGN UP</a>
                            </li><li>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>
    </div>


      </header>

      <!--SITE TITLE OR LOGO-->
      <div id="innerWrapper">

      <!--CONTENT INJECTION POINT-->
        <section id="content">
          <div class="main-content-wrapper cf" data-content-field="main-content" id="yui_3_17_2_1_1638469490801_120">
            <!-- CATEGORY NAV -->
            
            <div id="mainContent" class="blogDetails group subscribeAbs">
    <div id="imageMasthead" class="smaller">
        <div class="content">
            
                <h1 class="title" data-content-field="title">
                  
                    CVE-2020-8835: Linux Kernel Privilege Escalation via Improper eBPF Program Verification
                  
                </h1>
                <data>April 16, 2020  |  Guest Blogger</data>
            
        </div>
    </div>

    <div class="blog-listing blog-details" id="yui_3_17_2_1_1638469490801_119">
        <div class="subscribe-container">
            <a href="https://www.zerodayinitiative.com/rss/" class="btn subscribe rounded">SUBSCRIBE</a>
        </div>
        <div class="section" id="yui_3_17_2_1_1638469490801_118">
            <div class="contentBlock" id="yui_3_17_2_1_1638469490801_117">
                <div class="contentBlockCopy" id="yui_3_17_2_1_1638469490801_116">
                    
                      <div class="group" id="yui_3_17_2_1_1638469490801_115">
                        <div class="sqs-layout sqs-grid-12 columns-12" data-layout-label="Post Body" data-type="item" data-updated-on="1586376449445" id="item-5e8e2ebde23ec1577ee2fcd9"><div class="row sqs-row" id="yui_3_17_2_1_1638469490801_114"><div class="col sqs-col-12 span-12" id="yui_3_17_2_1_1638469490801_113"><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-8244e7e308e43eb3c8ce"><div class="sqs-block-content"><p class="" style="white-space:pre-wrap;"><em>During the recent </em><a href="https://www.zerodayinitiative.com/blog/2020/3/19/pwn2own-2020-day-one-results"><em>Pwn2Own 2020</em></a><em> competition, Manfred Paul (</em><a href="https://twitter.com/_manfp" target="_blank"><em>@_manfp</em></a><em>) of </em><a href="https://twitter.com/redrocket_ctf"><em>RedRocket CTF</em></a><em> used an improper input validation bug in the Linux kernel to go from a standard user to root. Manfred used this bug during the contest to win $30,000 in the Privilege Escalation category. He has graciously put together this write-up of his research describing the bug and the exploit used during the contest.</em></p></div></div><div class="sqs-block horizontalrule-block sqs-block-horizontalrule" data-block-type="47" id="block-yui_3_17_2_1_1586193049426_189216"><div class="sqs-block-content"><hr></div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1586193049426_202123"><div class="sqs-block-content"><p class="" style="white-space:pre-wrap;">This blog explains the technical details of an exploit using the Linux eBPF feature to achieve local privilege escalation. Due to the nature of the bug(s), which are rather subtle misbehaviors of a safety-critical feature called the “verifier”, some explanations about the inner workings of eBPF need to be provided first. It may be helpful to have the kernel source (<a href="https://github.com/torvalds/linux/blob/master/kernel/bpf/verifier.c">kernel/bpf/verifier.c</a> in particular) as a reference alongside these explanations. This bug has been assigned CVE-2020-8835 and was patched on <a href="https://www.openwall.com/lists/oss-security/2020/03/30/3">March 30, 2020</a>. Here’s a quick video demonstration of the exploit in action:</p></div></div><div class="sqs-block video-block sqs-block-video" data-block-json="{&quot;blockAnimation&quot;:&quot;none&quot;,&quot;layout&quot;:&quot;caption-hidden&quot;,&quot;overlay&quot;:false,&quot;description&quot;:{&quot;html&quot;:&quot;&quot;,&quot;raw&quot;:false},&quot;hSize&quot;:null,&quot;floatDir&quot;:null,&quot;html&quot;:&quot;&lt;iframe src=\&quot;//www.youtube.com/embed/8rNsxbCgKzY?wmode=opaque&amp;amp;enablejsapi=1\&quot; height=\&quot;480\&quot; width=\&quot;854\&quot; scrolling=\&quot;no\&quot; frameborder=\&quot;0\&quot; allowfullscreen=\&quot;\&quot;&gt;\n&lt;/iframe&gt;&quot;,&quot;url&quot;:&quot;https://youtu.be/8rNsxbCgKzY&quot;,&quot;width&quot;:854,&quot;height&quot;:480,&quot;providerName&quot;:&quot;YouTube&quot;,&quot;resolvedBy&quot;:&quot;youtube&quot;}" data-block-type="32" id="block-yui_3_17_2_1_1586978442892_34812"><div class="sqs-block-content" id="yui_3_17_2_1_1638469490801_66"><div class="intrinsic" style="max-width:100%"><div class="embed-block-wrapper" style="padding-bottom:56.20609%;"><div class="sqs-video-wrapper video-none" data-html="&lt;iframe src=&quot;//www.youtube.com/embed/8rNsxbCgKzY?wmode=opaque&amp;enablejsapi=1&quot; height=&quot;480&quot; width=&quot;854&quot; scrolling=&quot;no&quot; frameborder=&quot;0&quot; allowfullscreen=&quot;&quot;&gt;&lt;br/&gt;&lt;/iframe&gt;" data-provider-name="YouTube" id="yui_3_17_2_1_1638469490801_73"><div class="intrinsic"><div class="intrinsic-inner" style="padding-bottom: 56.2061%;"><iframe src="./2020 - CVE-2020-8835 Linux Kernel Privilege Escalation via Improper eBPF Program Verification_files/8rNsxbCgKzY.html" height="480" width="854" scrolling="no" frameborder="0" allowfullscreen="" id="yui_3_17_2_1_1638469490801_77"><br/></iframe></div></div></div></div></div></div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1586978442892_34880"><div class="sqs-block-content"><p class="" style="white-space:pre-wrap;"><strong>How eBPF works</strong></p><p class="" style="white-space:pre-wrap;"><strong>eBPF</strong></p><p class="" style="white-space:pre-wrap;">Since version 3.15, the Linux kernel supports a general tracing feature called “extended Berkeley Packet Filters”, or eBPF for short. This feature allows users to run eBPF programs, which are written in an assembly-like instruction set, directly in kernel space and can be used to trace certain kernel functionalities. This feature can also be used to filter network packets.</p><p class="" style="white-space:pre-wrap;">All BPF features are accessed through the BPF syscall, which supports various commands. The man page for <a href="http://man7.org/linux/man-pages/man2/bpf.2.html">BPF(2)</a> states:</p><p style="margin-left:40px;white-space:pre-wrap;" class="">In the current implementation, all bpf() commands require the caller to have the CAP_SYS_ADMIN capability.</p><p class="" style="white-space:pre-wrap;">This is incorrect. Since Linux 4.4, any user can load eBPF programs and run them by attaching them to a socket they own.</p><p class="" style="white-space:pre-wrap;"><strong>eBPF Programs</strong></p><p class="" style="white-space:pre-wrap;">eBPF uses an instruction set that is quite similar to a (very) limited subset of standard x86 assembly. There are 10 registers (plus one stack pointer), and we can execute all basic copy and arithmetic operations on them, including bitwise operations and shifts. For example:</p></div></div><div class="sqs-block markdown-block sqs-block-markdown" data-block-type="44" id="block-yui_3_17_2_1_1586193049426_202857"><div class="sqs-block-content"><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code>BPF_MOV64_IMM(BPF_REG_3, 1)</code></p>
<p>sets register 3 to value 1, and </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code>BPF_ALU64_REG(BPF_ARSH, BPF_REG_7, BPF_REG_5)</code></p>
<p>arithmetically shifts register 7 right by the contents of register 5. Note that the suffix <code>_REG</code> denotes a register as second operand, while <code>_IMM</code>-instructions take an immediate value. </p>
<p>There are also branching jump instructions: </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code>BPF_JMP_IMM(BPF_JNE, BPF_REG_3, 0, 3)</code></p>
<p>jumps over the next three instructions, if register 3 is not equal to 0. </p>
<p>For each <code>mov</code>, <code>alu</code> and <code>jmp</code> instruction, there is also a corresponding 32-bit version that operates just on the lower 32 bits of the registers (results are zero-extended where needed). </p>
<p>Finally, there are memory loads and stores: </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code>BPF_LDX_MEM(BPF_DW, BPF_REG_3, BPF_REG_9, 24)</code></p>
<p>loads a 64-bit value from <code>[reg9+24]</code> into <code>reg3</code>, and </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code>BPF_STX_MEM(BPF_DW, BPF_REG_8, BPF_REG_6, 0)</code></p>
<p>stores the contents of register 6 in <code>[reg8+0]</code>. </p>
<p>To execute an eBPF program, it first has to be loaded via the <code>BPF_PROG_LOAD</code> command. This returns a file descriptor corresponding to the program. This file descriptor can then be attached to a socket. The program is then executed for every packet that comes through this socket.   </p>
<p><b data-preserve-html-node="true">eBPF Maps</b> </p>
<p>To store data or communicate with user space programs (or each other), eBPF programs can use a feature called maps. All maps represent key-value-mappings of some kind. There are different map types, for example, queues and stacks, however for this exploit, the only one that is used is the <code>arraymap</code>. As the name implies, this type of map is just a contiguous array of entries. It is defined by three parameters:   </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <code>key_size</code> is the size in bytes of each index used to access an element. The exploit always uses <code>key_size=sizeof(int)=4</code>.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <code>value_size</code> is the size of each array element. This size can be arbitrary, within reasonable limits.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <code>max_entries</code> is the length of the array. We will always just set <code>value_size</code> as high as we need, and set <code>max_entries</code> to 1.</p>
<p>One advantage to setting <code>max_entries</code> to 1, rather than having a small <code>value_size</code> but more entries, is that we can then get a pointer to the single value inside the eBPF program, so that the <code>arraymap</code> is in effect just a single memory chunk. This will be very convenient later on.</p>
<p>Similar to programs, maps are created by the <code>BPF_MAP_CREATE</code> command of the <code>bpf</code> syscall and are identified by a file descriptor. </p>
<p>The exploit will use three maps: </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <code>inmap</code> is a small map containing all parameters the exploit needs to run (e.g. the offset of an out-of-bounds read to perform). Note that although there will be multiple parameters, they will all be stored inside a single larger array entry.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <code>outmap</code> is a very small map containing any output from the exploit program (for Out-of-Bounds (OOB) reads, the read value).<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <code>explmap</code> is a larger map that will be used for the exploit itself.</p>
<p><b data-preserve-html-node="true">JIT Compiler</b> </p>
<p>For performance reasons, all eBPF programs are JIT compiled into native machine code when they are loaded (except when <code>CONFIG_BPF_JIT_ALWAYS_ON</code> is disabled). </p>
<p>The JIT compilation process is pretty much straightforward, as it is very easy to find x86 instructions corresponding to most eBPF instructions. The compiled program runs in kernel space with no additional sandboxing. </p>
<p><b data-preserve-html-node="true">Verifier</b></p>
<p>Obviously, running arbitrary JIT-compiled eBPF instructions would trivially allow arbitrary memory access, because the load and store instructions are translated into indirect <code>mov</code>s. Therefore, the kernel runs a verifier on each program to make sure no OOB memory access can be performed, and also that no kernel pointers can be leaked. The verifier enforces roughly the following (some of these apply only to programs loaded by non-privileged processes): </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- No pointer arithmetic or comparisons can be performed, except for the addition or subtraction of a pointer and a scalar value (a <i data-preserve-html-node="true">scalar value</i> is any value that is not derived from a pointer value).<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- No pointer arithmetic that leaves the bounds of known-safe memory regions (i.e. maps) can be performed.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- No pointer values can be returned from maps, nor can they be stored in maps, where they would be readable from user space.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- No instruction is reachable from itself, meaning that the program may not contain any loops. </p>
<p>To do this, the verifier must track – for each program instruction – which registers contain pointers and which contain scalar values. In addition, the verifier must perform range computations to ensure that pointers can never leave their appropriate memory regions. It must also perform range tracking for scalar values, because without knowing lower and upper bounds it would be impossible to tell if adding a register containing a scalar value to one containing a pointer would result in an out-of-bounds pointer. </p>
<p>For tracking the range of possible values of each register, the verifier keeps track of three separate bounds:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1- <code>umin</code> and <code>umax</code> track the minimum and maximum value that the register can contain when interpreted as an unsigned integer.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2-    <code>smin</code> and <code>smax</code> track the minimum and maximum value that the register can contain when interpreted as a signed integer.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3-    <code>var_off</code> contains information about certain bits that are known to be 0 or 1. The type of <code>var_off</code> is a structure known as <code>tnum</code>, which is short for “tracked number” or “tristate number”. A <code>tnum</code> has two fields. One field, named <code>value</code>, has all bits set that are known to be 1 in the register under consideration. The other field, named <code>mask</code>, has all bits set where the corresponding bit in the register is unknown. For example, if <code>value</code> is binary <code>010</code> and <code>mask</code> is binary <code>100</code>, then the register could contain either binary <code>010</code> or binary <code>110</code>. </p>
<p>To see why 1 and 2 are both necessary, consider a register whose signed bounds are -1 and 0. Interpreted as an unsigned integer, those values can range from 0 to 2ˆ64-1, which has the same representation as signed -1. On the other hand, the unsigned range from 2ˆ63-1 to 2ˆ63 includes both the smallest and largest possible signed values.</p>
<p>All of these bounds are regularly used to update each other. For example, if <code>umax</code> is below 2ˆ63, then <code>smin</code> is set to 0 (if it was negative before), as all such numbers are positive. Similarly, if <code>var_off</code> indicates that all except the last three bits are 0, then <code>umax</code> can be safely set to 7.</p>
<p>The verifier checks each possible execution path, meaning that at each branch, both outcomes are checked separately. For the two branches of a conditional jump, some additional information can be learned. For example, consider: </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code>BPF_JMP_IMM(BPF_JGE, BPF_REG_5, 8, 3)</code></p>
<p>which takes the branch if register 5 is greater or equal than 8 in an unsigned comparison. While analyzing the false-branch, the verifier is able to set <code>umax</code> of register 5 to 7, because any higher unsigned value would have resulted in taking the other branch. </p>
<p><b data-preserve-html-node="true">ALU Sanitation</b></p>
<p>In response to a large number of security vulnerabilities that were due to bugs in the verifier, a feature called “ALU sanitation” was introduced. The idea is to supplement the verifier’s static range checks with runtime checks on the actual values being processed by the program. Recall that the only permitted calculations with pointers are to add or subtract a scalar. For every arithmetic operation that involves a pointer and a scalar register (as opposed to an immediate), an <code>alu_limit</code> is determined as the maximal absolute value that can safely be added to or subtracted from to the pointer without exceeding the allowable range. </p>
<p>Pointer arithmetic where the sign of the scalar operand is unknown is disallowed. For the rest of this subsection, assume that each scalar is treated as positive; the negative case is analogous. </p>
<p>Before each arithmetic instruction that has an <code>alu_limit</code>, the following sequence of instructions is added. Note that <code>off_reg</code> is the register containing the scalar value, and <code>BPF_REG_AX</code> is an auxiliary register. </p>
<p><code>BPF_MOV32_IMM(BPF_REG_AX, aux-&gt;alu_limit - 1)</code>
<code>BPF_ALU64_REG(BPF_SUB, BPF_REG_AX, off_reg)</code>
<code>BPF_ALU64_REG(BPF_OR, BPF_REG_AX, off_reg)</code>
<code>BPF_ALU64_IMM(BPF_NEG, BPF_REG_AX, 0)</code>
<code>BPF_ALU64_IMM(BPF_ARSH, BPF_REG_AX, 63)</code>
<code>BPF_ALU64_REG(BPF_AND, off_reg, BPF_REG_AX)</code></p>
<p>If the scalar exceeds <code>alu_limit</code>, then the first subtraction will be negative, so that the leftmost bit of <code>BPF_REG_AX</code> will be set. Similarly, if the scalar that is supposed to be positive is in fact negative, the <code>BPF_OR</code> instruction will set the leftmost bit of <code>BPF_REG_AX</code>. The negation followed by the arithmetic shift will then fill <code>BPF_REG_AX</code> with all 0s, so that the <code>BPF_AND</code> will force <code>off_reg</code> to zero, replacing the offending scalar. On the other hand, if the scalar falls within the appropriate range <code>0 &lt;= off_reg &lt;= alu_limit</code>, the arithmetic shift will fill <code>BPF_REG_AX</code> with all 1s, so that the <code>BPF_AND</code> will leave the scalar register unchanged.</p>
<p>To make sure that setting the register to 0 does not itself introduce a new out-of-bounds condition, the verifier will track an additional “speculative” branch where the operand is treated as 0.</p>
</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1586193049426_244683"><div class="sqs-block-content"><p class="" style="white-space:pre-wrap;"><strong>Exploiting the Verifier</strong></p><p class="" style="white-space:pre-wrap;"><strong>Breaking Range Tracking</strong></p></div></div><div class="sqs-block markdown-block sqs-block-markdown" data-block-type="44" id="block-yui_3_17_2_1_1586193049426_245188"><div class="sqs-block-content"><p>As mentioned, jump conditionals also exist in a 32-bit variant. However, because all bounds are tracked exclusively for the full 64-bit-wide registers, there is no straightforward way to use 32-bit branches to update register bounds, as can be done for 64-bit branches as detailed above. Because this resulted in improperly rejected programs, for every 32-bit branching jump an additional function call was added, in an attempt to maximize the bounds information that can be gleaned. The idea is to use <code>umin</code> and <code>umax</code> to narrow down the last 32 bits in <code>var_off</code>. The code is as follows, found in <code>kernel/bpf/verifier.c</code>: </p>
</div></div><div class="sqs-block image-block sqs-block-image sqs-text-ready" data-block-type="5" id="block-yui_3_17_2_1_1586193049426_246104"><div class="sqs-block-content" id="yui_3_17_2_1_1638469490801_112">













  

    
  
    <div class="
          image-block-outer-wrapper
          layout-caption-hidden
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        " data-test="image-block-inline-outer-wrapper" id="yui_3_17_2_1_1638469490801_111">

      

      
        <figure class="
              sqs-block-image-figure
              intrinsic
            " style="max-width:800px;" id="yui_3_17_2_1_1638469490801_110">
          
        
        

        
          
            
          <div class="image-block-wrapper" data-animation-role="image" id="yui_3_17_2_1_1638469490801_109">
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:30.375%;
                
                
  overflow: hidden;
  
    
    
    
    
  

              " id="yui_3_17_2_1_1638469490801_108">
              <noscript><img src="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1586377358072-XA3HANULXSNTUUPG790N/Picture1.png" alt="Picture1.png" /></noscript><img class="thumb-image loaded" data-src="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1586377358072-XA3HANULXSNTUUPG790N/Picture1.png" data-image="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1586377358072-XA3HANULXSNTUUPG790N/Picture1.png" data-image-dimensions="800x243" data-image-focal-point="0.5,0.5" data-load="false" data-image-id="5e8e328dc075e30bd0f400f4" data-type="image" style="left: -0.0881834%; top: 0%; width: 100.176%; height: 100%; position: absolute;" alt="Picture1.png" data-image-resolution="1000w" src="./2020 - CVE-2020-8835 Linux Kernel Privilege Escalation via Improper eBPF Program Verification_files/Picture1.png">
            </div>
          </div>
        
          
        

        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block markdown-block sqs-block-markdown" data-block-type="44" id="block-yui_3_17_2_1_1586193049426_250144"><div class="sqs-block-content"><p>To understand this code, we must first explain the purpose of several functions used here. </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <code>tnum_range</code> is a function that generates a <code>tnum</code> corresponding to the possible values in a given range of unsigned integers.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <code>tnum_cast</code> creates a new <code>tnum</code> based on the lowermost bits of an existing <code>tnum</code>. Here, it is used to return the lower 32 bits of <code>reg-&gt;var_off</code>.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <code>tnum_lshift</code> / <code>tnum_rshift</code> perform shifts on <code>tnum</code>s. Here, they are used together to clear the lower 32 bits of a <code>tnum</code>.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <code>tnum_intersect</code> takes two <code>tnum</code> arguments both pertaining to a single value, and returns a single <code>tnum</code> that synthesizes all knowledge conveyed by the arguments.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <code>tnum_or</code> returns a <code>tnum</code> indicating our knowledge of the bitwise OR of two operands, where the two arguments indicate our knowledge of the two operands.</p>
<p>Now consider a register with <code>umin_value = 1</code> and <code>umax_value = 2ˆ32+1</code>, and <code>var_off</code> otherwise unconstrained. Then <code>reg-&gt;umin_value &amp; mask</code> and <code>reg-&gt;umax_value &amp; mask</code> will both be 1. Thus, the resulting <code>tnum_range</code> will indicate that the lowest bit is known to be 1, and that all other bits are known to be 0. <code>tnum_intersect</code> will preserve this information and mark all lower 32 bits as known in its output. Finally, <code>tnum_or</code> will reintroduce uncertainty in the upper 32 bits, but because <code>hi32</code> indicates that the lower 32 bits are known zeros, the lower 32 bits from the <code>tnum_intersect</code> will be preserved. This means that after this function finishes, the lower half of <code>var_off</code> will be marked as known binary <code>00...01</code>. </p>
<p>However, this conclusion is not justified. Just because <code>umin</code> and <code>umax</code> both end in binary <code>00...01</code> doesn’t mean that each value in between also does. For example, the register’s true value could easily have been 2. As we will see, this initial incorrect assumption made by the verifier can be used to break further assumptions.</p>
<p><b data-preserve-html-node="true">Triggering the Bug</b> </p>
<p>To actually trigger the described bug, we need to have a register that fulfills the following conditions: </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- During execution, the actual value in the register is 2.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- The register’s <code>umin_val</code> is set to 1, and <code>umax_val</code> is set to 2ˆ32+1.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- A conditional jump with a 32-bit comparison on this register is executed.  </p>
<p>We cannot directly load the value 2 into the register with a <code>mov</code>, as the verifier would then know that <code>umin_val=umax_val=2</code>. However, there is an easy workaround. If we load the register from a map (we’ll use our input map <code>inmap</code>), then the verifier will have no information about its value, as map values can be changed during runtime.</p>
<p>To set <code>umin_val</code> and <code>umax_val</code> we can use the verifier’s jump branch logic: </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code>BPF_JMP_IMM(BPF_JGE, BPF_REG_2, 1, 1)</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code>BPF_RAW_INSN(BPF_JMP | BPF_EXIT, 0, 0, 0, 0)</code></p>
<p>The conditional jump will result in two branches. In the one where the branch is taken, the verifier knows that <code>BPF_REG_2 &gt;= 1</code>, while the other branch ends with the exit instruction and is discarded. Thus, for all further instructions the <code>umin_val</code> of register 2 will be 1. </p>
<p>Analogously, another conditional jump can be used to set <code>umax_val</code> to <code>2ˆ32+1</code>. However, here we need to compare against a register, because only 32-bit immediate values are supported. After this, we have <code>umin_val</code> and <code>umax_val</code> set as we wanted. </p>
<p>Now, any conditional 32-bit jump can be used to trigger the bug: </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code>BPF_JMP32_IMM(BPF_JNE, BPF_REG_2, 5, 1),</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code>BPF_RAW_INSN(BPF_JMP | BPF_EXIT, 0, 0, 0, 0),</code></p>
<p>The verifier now thinks that the last 32 bits of register 2 are binary <code>00...01</code> when in reality they are binary <code>00...10</code>. After two additional instructions: </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code>BPF_ALU64_IMM(BPF_AND, BPF_REG_2, 2),</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code>BPF_ALU64_IMM(BPF_RSH, BPF_REG_2, 1),</code></p>
<p>The verifier now assumes that register 2 has to be 0 because the <code>AND</code> instruction necessarily has to result in 0 if the second-last bit of the register 2 was 0, but in reality it is <code>(2&amp;2)&gt;&gt;1 = 1</code>. This is a very useful primitive, as we can now multiply register 2 with any number to create an arbitrary value that the verifier believes to be 0. </p>
</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1586193049426_260614"><div class="sqs-block-content"><p class="" style="white-space:pre-wrap;"><strong>Bypassing ALU Sanitation</strong></p><p class="" style="white-space:pre-wrap;">While rechecking all pointer arithmetic in runtime seems like a good idea, the implementation is severely lacking. The main problem seems to be that the values aren’t actually limited to the range that the static portion of the verifier assumes them to be in, but rather to a larger limit that seems safe <em>at that moment </em>but isn’t necessarily so with respect to the future. To understand the distinction, consider the following example:</p></div></div><div class="sqs-block markdown-block sqs-block-markdown" data-block-type="44" id="block-yui_3_17_2_1_1586193049426_275546"><div class="sqs-block-content"><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- Register 1 contains a pointer p to the beginning of 4000 bytes of safe memory. Assume that the type of <code>*p</code> is just one byte in size. This means that adding 3999 to <code>p</code> is perfectly fine but adding 4000 would leave the bounds.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- Register 2 contains a scalar <code>a</code>, which the static verifier believes to be 1000.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- Now, add register 2 to register 1. The static verifier has no problem with this, as <code>p+1000</code> is still within the bounds of the memory region. Because this is arithmetic involving a pointer, the ALU sanitizer will set an <code>alu_limit</code>. However, even though the verifier believes that <code>a</code> is no larger than 1000, the limit is not set to 1000, but rather to 3999, because this is the largest value still believed to be safe.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- Add register 2 to register 1 again. This time, the static part of the verifier believes that <code>p</code> points to position 1000 in the 4000 byte memory block. The <code>alu_limit</code> will now be set to 2999, because this is the largest legal value that can still be added.   </p>
<p>Now consider what happens if we have used a bug in the static analysis to trick the verifier into believing that <code>a = 1000</code>, while in reality we set <code>a = 2500</code>. The value will still pass both runtime checks without being forced to 0, because 2500 is less than both 3999 and 2999. However, in total we have added 5000 to the pointer <code>p</code>, resulting in an address well outside the safe memory range. While each <code>alu_limit</code> is sufficiently low individually, in combination they are insufficient. The second limit calculation only catches errors that the static analysis makes about the second addition, while assuming that it was completely correct about the first one. </p>
<p><b data-preserve-html-node="true">Achieving OOB Read &amp; Write</b></p>
<p>Now achieving OOB memory access is just a matter of combining the pieces. First, we use the <code>JMP32</code> bug to set a register to 1, while the verifier believes it has to be 0. Assume that we have a pointer <code>p</code> to a map of size 8000 bytes (the exploit uses slightly different values). For the purpose of the exploit, it’s most convenient to get OOB access before the beginning of the map, not after the end, so the first step is to add a large value like 6000 to <code>p</code> so that we can “mirror” the ALU sanitation bypass described above. </p>
<p>Next, we manufacture a register that has an actual value of 6000 while the verifier thinks it contains 0. We do this by multiplying our original “fake” register with 6000. Now we can subtract that from <code>p</code>. This works because the <code>alu_limit</code> will be set to 6000, the largest legal amount we can subtract. However, the static part of the verifier will still assume that <code>p</code> points to position 6000 in our map. Thus, we can now subtract any value up to 6000 from <code>p</code>, while <code>p</code> in reality points to the start of the map. </p>
<p>We now have a pointer up to 6000 bytes before the start of the map’s contents. Because the verifier still believes this pointer to be inside the map’s boundaries, it now allows us to read from and write to this address. For convenience, we can even make the operation and offset (and for writes, the value written) depend on parameters in our input map <code>inmap</code>. For an OOB read, the read value is written to <code>outmap</code>. As maps can be read and modified from user space through the <code>bpf</code> syscall, we can now load this program just once and then repeatedly trigger it with different parameters for an arbitrary OOB read/write gadget.</p>
<p><b data-preserve-html-node="true">Escalating Privileges</b></p><b data-preserve-html-node="true">
</b><p><b data-preserve-html-node="true">Leaking KASLR </b></p>
<p>Conveniently for us, the map’s contents are not stored in a heap chunk by itself, but rather they are placed at the end of a larger struct called struct <code>bpf_map</code> (defined in <code>include/linux/bpf.h</code>). This struct contains some useful members: </p>
</div></div><div class="sqs-block image-block sqs-block-image sqs-text-ready" data-block-type="5" id="block-yui_3_17_2_1_1586193049426_281708"><div class="sqs-block-content" id="yui_3_17_2_1_1638469490801_140">













  

    
  
    <div class="
          image-block-outer-wrapper
          layout-caption-hidden
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        " data-test="image-block-inline-outer-wrapper" id="yui_3_17_2_1_1638469490801_139">

      

      
        <figure class="
              sqs-block-image-figure
              intrinsic
            " style="max-width:867px;" id="yui_3_17_2_1_1638469490801_138">
          
        
        

        
          
            <button class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                " data-description="" data-lightbox-theme="dark" id="yui_3_17_2_1_1638469490801_137">
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div class="image-block-wrapper" data-animation-role="image" id="yui_3_17_2_1_1638469490801_136">
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:47.86620330810547%;
                
                
  overflow: hidden;
  
    
    
    
    
  

              " id="yui_3_17_2_1_1638469490801_135">
              <noscript><img src="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1586377725025-QVM2EOEFSN9QTMZGIS09/Picture2.png" alt="Picture2.png" /></noscript><img class="thumb-image loaded" data-src="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1586377725025-QVM2EOEFSN9QTMZGIS09/Picture2.png" data-image="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1586377725025-QVM2EOEFSN9QTMZGIS09/Picture2.png" data-image-dimensions="867x415" data-image-focal-point="0.5,0.5" data-load="false" data-image-id="5e8e33fc88635272ce05b731" data-type="image" style="left: 0%; top: -0.00946823%; width: 100%; height: 100.019%; position: absolute;" alt="Picture2.png" data-image-resolution="1000w" src="./2020 - CVE-2020-8835 Linux Kernel Privilege Escalation via Improper eBPF Program Verification_files/Picture2.png">
            </div>
          </div>
        
            </button>
          
        

        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block markdown-block sqs-block-markdown" data-block-type="44" id="block-yui_3_17_2_1_1586193049426_285673"><div class="sqs-block-content"><p>Particularly useful is the pointer <code>ops</code> which points to a vtable of functions, depending on the map type. In this case, as the map is an <code>arraymap</code>, it points to <code>array_map_ops</code>. As this is a constant struct at a fixed location in <code>rodata</code> (it’s even an exported symbol), reading this can be used to directly bypass KASLR. </p>
<p><b data-preserve-html-node="true">Arbitrary Read </b></p>
<p>Also useful in the struct is the pointer struct <code>btf *btf</code>, which points to an additional struct containing debug info. This pointer is normally unused (and set to NULL), which makes it a good target to overwrite without messing things up too much. </p>
<p>It turns out that this pointer can be conveniently accessed through the <code>bpf_map_get_info_by_fd-function</code>, which in turn is called by the <code>BPF_OBJ_GET_INFO_BY_FD</code> command of the <code>bpf</code> syscall if the file descriptor of the map is provided. This function effectively performs the following (the full function is found in <code>kernel/bpf/syscall.c</code>):</p>
</div></div><div class="sqs-block image-block sqs-block-image sqs-text-ready" data-block-type="5" id="block-yui_3_17_2_1_1586193049426_286969"><div class="sqs-block-content" id="yui_3_17_2_1_1638469490801_166">













  

    
  
    <div class="
          image-block-outer-wrapper
          layout-caption-hidden
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        " data-test="image-block-inline-outer-wrapper" id="yui_3_17_2_1_1638469490801_165">

      

      
        <figure class="
              sqs-block-image-figure
              intrinsic
            " style="max-width:775px;" id="yui_3_17_2_1_1638469490801_164">
          
        
        

        
          
            <button class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                " data-description="" data-lightbox-theme="dark" id="yui_3_17_2_1_1638469490801_163">
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div class="image-block-wrapper" data-animation-role="image" id="yui_3_17_2_1_1638469490801_162">
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:16.516130447387695%;
                
                
  overflow: hidden;
  
    
    
    
    
  

              " id="yui_3_17_2_1_1638469490801_161">
              <noscript><img src="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1586377772455-H6ME2BDSABZGASODQ4FQ/Picture3.png" alt="Picture3.png" /></noscript><img class="thumb-image loaded" data-src="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1586377772455-H6ME2BDSABZGASODQ4FQ/Picture3.png" data-image="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1586377772455-H6ME2BDSABZGASODQ4FQ/Picture3.png" data-image-dimensions="775x128" data-image-focal-point="0.5,0.5" data-load="false" data-image-id="5e8e342ced5d93611ed29b00" data-type="image" style="left: -0.167411%; top: 0%; width: 100.335%; height: 100%; position: absolute;" alt="Picture3.png" data-image-resolution="1000w" src="./2020 - CVE-2020-8835 Linux Kernel Privilege Escalation via Improper eBPF Program Verification_files/Picture3.png">
            </div>
          </div>
        
            </button>
          
        

        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block markdown-block sqs-block-markdown" data-block-type="44" id="block-yui_3_17_2_1_1586193049426_290899"><div class="sqs-block-content"><p>This means that if we use our OOB-write primitive to <code>set map-&gt;btf</code> to <code>someaddr - offsetof(struct btf, id)</code>, then <code>BPF_OBJ_GET_INFO_BY_FD</code> returns <code>*someaddr</code> in <code>info.btf_id</code>. Since the id field of <code>struct btf</code> is a u32, this primitive can be used to read 4 bytes at a time from an arbitrary address. </p>
<p><b data-preserve-html-node="true">Finding process structs</b> </p>
<p>To find the <code>cred</code> and <code>files</code> structs of the process, we first search for <code>init_pid_ns</code>, the default process namespace (if running in a container, we would need to find the corresponding namespace first). This might not be the quickest way, but it works.</p>
<p>There are two ways to find <code>init_pid_ns</code>: </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- If we know the offset between <code>array_map_ops</code> and <code>init_pid_ns</code>, we can simply add it to the address of <code>array_map_ops</code>, which we already know. This offset does not depend on KASLR, but it isn’t stable across kernel updates.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- Instead, we can find <code>init_pid_ns</code> in the <code>ksymtab</code> and <code>kstrtab</code> segments. To do this, we first find the beginning of <code>kstrtab</code> by iterative search beginning at <code>array_map_ops</code>. Then, we find the null-terminated string “init_pid_ns” in <code>kstrtab</code>, again by a simple iterative search. A final iteration over <code>ksymtab</code> finds the symbol entry that references the <code>kstrtab</code> entry, and also contains the relative address of <code>init_pid_ns</code>.</p>
<p>Once <code>init_pid_ns</code> is found, its radix tree can be iterated to find a pointer into the <code>task</code> struct that corresponds to the pid of the exploit process. In fact, this is exactly the mechanism the kernel itself uses to find a <code>task</code> by its pid. </p>
<p>Using the tasks struct, both the <code>cred</code> struct containing the user privileges and an array of open file descriptors can be found. The latter can be indexed by the file descriptor of the loaded <code>explmap</code> to obtain the corresponding struct file of the map. In turn, the <code>private_data</code> of this structure points to the struct <code>bpf_map</code>. This means now we also know the address of the contents of <code>explmap</code>.</p>
<p><b data-preserve-html-node="true">Arbitrary Write </b></p>
<p>Note that by overwriting <code>ops</code> using OOB-write we can control RIP to any function to which we have a pointer. However, the first argument in RDI will always be set to the <code>bpf_map-struct</code>, which rules out a lot of existing functions. Thus, it seems natural to overwrite certain elements of <code>array_map_ops</code> to different map operations, which can at least handle the first argument correctly.</p>
<p>To do this, we first load a complete copy of the <code>array_map_ops</code> table into the data of <code>explmap</code> using the arbitrary read primitive as well as the <code>bpf</code> syscall with <code>BPF_MAP_UPDATE_ELEM</code>. The only modification to this copy is that the <code>map_push_elem</code> member, normally unused in <code>arraymaps</code>, is overwritten with the <code>map_get_next_key</code> operation. </p>
<p>The <code>arraymap</code> implementation of <code>map_get_next_key</code> is as follows (from <code>kernel/bpf/arraymap.c</code>):</p>
</div></div><div class="sqs-block image-block sqs-block-image sqs-text-ready" data-block-type="5" id="block-yui_3_17_2_1_1586193049426_297650"><div class="sqs-block-content" id="yui_3_17_2_1_1638469490801_192">













  

    
  
    <div class="
          image-block-outer-wrapper
          layout-caption-hidden
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        " data-test="image-block-inline-outer-wrapper" id="yui_3_17_2_1_1638469490801_191">

      

      
        <figure class="
              sqs-block-image-figure
              intrinsic
            " style="max-width:801px;" id="yui_3_17_2_1_1638469490801_190">
          
        
        

        
          
            <button class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                " data-description="" data-lightbox-theme="dark" id="yui_3_17_2_1_1638469490801_189">
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div class="image-block-wrapper" data-animation-role="image" id="yui_3_17_2_1_1638469490801_188">
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:48.68914031982422%;
                
                
  overflow: hidden;
  
    
    
    
    
  

              " id="yui_3_17_2_1_1638469490801_187">
              <noscript><img src="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1586377897420-M2747K3G6VC6GD42Z5WC/Picture4.png" alt="Picture4.png" /></noscript><img class="thumb-image loaded" data-src="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1586377897420-M2747K3G6VC6GD42Z5WC/Picture4.png" data-image="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1586377897420-M2747K3G6VC6GD42Z5WC/Picture4.png" data-image-dimensions="801x390" data-image-focal-point="0.5,0.5" data-load="false" data-image-id="5e8e34a9588ef470ee81342b" data-type="image" style="left: -0.0258242%; top: 0%; width: 100.052%; height: 100%; position: absolute;" alt="Picture4.png" data-image-resolution="1000w" src="./2020 - CVE-2020-8835 Linux Kernel Privilege Escalation via Improper eBPF Program Verification_files/Picture4.png">
            </div>
          </div>
        
            </button>
          
        

        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block markdown-block sqs-block-markdown" data-block-type="44" id="block-yui_3_17_2_1_1586193049426_301581"><div class="sqs-block-content"><p>If we control <code>next_key</code> and <code>key</code>, then <code>*next = index + 1;</code> can be used as an arbitrary write primitive under the condition that <code>index &lt; array-&gt;map.max_entries</code>. If <code>map-&gt;max_entries</code> can be set to <code>0xffffffff</code>, this check will always pass (except for <code>index=0xffffffff</code>, which is actually what we are going to use, but this is fine as <code>*next</code> is still set to <code>0=index+1</code>).</p>
<p>Because we already obtained a pointer to the data of <code>explmap</code>, we can now overwrite <code>explmap-&gt;array_map_ops</code> to point to our modified operations table. </p>
<p>Note that the signature of <code>map_push_elem</code>, which we have overwritten with <code>map_get_next_key</code>, is: </p>
</div></div><div class="sqs-block image-block sqs-block-image sqs-text-ready" data-block-type="5" id="block-yui_3_17_2_1_1586193049426_302599"><div class="sqs-block-content" id="yui_3_17_2_1_1638469490801_218">













  

    
  
    <div class="
          image-block-outer-wrapper
          layout-caption-hidden
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        " data-test="image-block-inline-outer-wrapper" id="yui_3_17_2_1_1638469490801_217">

      

      
        <figure class="
              sqs-block-image-figure
              intrinsic
            " style="max-width:744px;" id="yui_3_17_2_1_1638469490801_216">
          
        
        

        
          
            <button class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                " data-description="" data-lightbox-theme="dark" id="yui_3_17_2_1_1638469490801_215">
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div class="image-block-wrapper" data-animation-role="image" id="yui_3_17_2_1_1638469490801_214">
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:10.21505355834961%;
                
                
  overflow: hidden;
  
    
    
    
    
  

              " id="yui_3_17_2_1_1638469490801_213">
              <noscript><img src="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1586377929929-U58YTZ7E0MVZDY4D74OX/Picture5.png" alt="Picture5.png" /></noscript><img class="thumb-image loaded" data-src="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1586377929929-U58YTZ7E0MVZDY4D74OX/Picture5.png" data-image="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1586377929929-U58YTZ7E0MVZDY4D74OX/Picture5.png" data-image-dimensions="744x76" data-image-focal-point="0.5,0.5" data-load="false" data-image-id="5e8e34c9425a9928fbdf4808" data-type="image" style="left: 0%; top: -0.355899%; width: 100%; height: 100.712%; position: absolute;" alt="Picture5.png" data-image-resolution="1000w" src="./2020 - CVE-2020-8835 Linux Kernel Privilege Escalation via Improper eBPF Program Verification_files/Picture5.png">
            </div>
          </div>
        
            </button>
          
        

        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block markdown-block sqs-block-markdown" data-block-type="44" id="block-yui_3_17_2_1_1586193049426_306561"><div class="sqs-block-content"><p>However, <code>map_push_elem</code> is called by the <code>BPF_MAP_UPDATE_ELEM</code> command only if the map has type <code>BPF_MAP_TYPE_STACK</code> or <code>BPF_MAP_TYPE_QUEUE</code>. But if this is the case, we can directly control the <code>flags</code> argument, which will be interpreted as <code>next_key</code>, as well as the <code>value</code> argument. </p>
<p>To trigger the arbitrary write gadget, we have to perform the following OOB writes in sequence: </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- Set <code>ops</code> to our fake vtable inside the <code>explmap</code> buffer.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- Set <code>explmap-&gt;spin_lock_off</code> to 0 to pass some additional checks.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- Set <code>explmap-&gt;max_entries</code> to <code>0xffffffff</code> to pass the check in <code>array_map_get_next_key</code>.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- Set <code>explmap-&gt;map_type</code> to <code>BPF_MAP_TYPE_STACK</code> to be able to reach <code>map_push_elem</code>.  </p>
<p>The arbitrary 32-bit write can now be triggered by passing appropriate arguments to <code>BPF_MAP_UPDATE_ELEM</code>. After all writes are performed, the fields should be reset to their original values to prevent crashes on cleanup. </p>
<p><b data-preserve-html-node="true">Getting root privileges</b></p>
<p>Getting root is now trivial: We just need to set the <code>uid</code> to 0 in the <code>cred</code> struct of the process. Now we can execute arbitrary privileged commands or drop into an interactive shell. </p>
</div></div><div class="sqs-block horizontalrule-block sqs-block-horizontalrule" data-block-type="47" id="block-yui_3_17_2_1_1586193049426_312048"><div class="sqs-block-content"><hr></div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1586193049426_312400"><div class="sqs-block-content"><p class="" style="white-space:pre-wrap;"><em>Thanks again to Manfred for such a thorough write-up of this local privilege escalation. This was Manfred’s first time at Pwn2Own, and we hope to see more of his work in the future. Until then, follow the&nbsp;</em><a href="https://twitter.com/thezdi"><em>team</em></a><em>&nbsp;for the latest in exploit techniques and security patches.</em></p></div></div></div></div></div>
                      </div>

                       
                        <ul class="blog-tags">
                          
                            <!--TAGS-->
                            
                              <li><a class="tag" href="https://www.zerodayinitiative.com/blog?tag=Linux">Linux</a></li>
                            
                              <li><a class="tag" href="https://www.zerodayinitiative.com/blog?tag=Pwn2Own">Pwn2Own</a></li>
                            
                              <li><a class="tag" href="https://www.zerodayinitiative.com/blog?tag=Exploit">Exploit</a></li>
                            
                              <li><a class="tag" href="https://www.zerodayinitiative.com/blog?tag=LPE">LPE</a>
                          
                        </li></ul>
                      
                   
                    
                </div>
                <div class="contentBlockImage">
                    <div class="blog-actions">
                        <a href="https://www.zerodayinitiative.com/blog" class="btn mediumButton back-btn">BACK TO THE BLOG</a>
                        <ul class="social-share">
                            <a class="icon-heart" title="Like this">
  <span class="sqs-simple-like" data-item-id="" data-like-count="">
    <span class="like-icon"></span>
    <span class="like-count"></span>
  </span>
</a>
                            <a class="icon-share" title="Share"><span class="squarespace-social-buttons inline-style" data-system-data-id="" data-asset-url="" data-record-type="" data-full-url="" data-title=""><div id="social-yui_3_17_2_1_1638469490801_267" class="yui3-widget yui3-socialbutton"><div id="yui_3_17_2_1_1638469490801_272" class="yui3-socialbutton-content"><div class="ss-social-button-wrapper"><div class="ss-social-button"><span class="ss-social-button-icon"></span>Share</div></div><div class="ss-social-list-wrapper"><div class="ss-social-button-list"></div></div></div></div></span></a>

                            <!-- <li><a href="#" class="twitter-share"><img src="/assets/twitterIcon.svg" alt="Twitter" /></a></li>
                            <li><a href="#" class="facebook-share"><img src="/assets/facebookIcon.svg" alt="Facebook" /></a></li>
                            <li><a href="#" class="linkedin-share"><img src="/assets/linkedinIcon.svg" alt="Linkedin" /></a></li> -->
                        </ul>
                    </div>  
                </div>
            </div><!-- /. contentBlock -->
        </div>

        <div class="section blog-listing-details">
            <div class="threeCols">

                <!-- get recent blog post -->
                  

                      <div class="column">
                        <div class="content">
                          <div class="thumb">
                              
                                
                                    <a href="https://www.zerodayinitiative.com/blog/2021/11/17/mindshare-using-io-ninja-to-analyze-npfs" style="background: url(&#39;https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1637178187892-UJSEMAP2T6RTXUHWUOQM/MindshaRE.jpg&#39;) no-repeat;"></a>
                                

                              
                          </div>
                        </div>
                        <h3 class="title" data-content-field="title">
                          
                            <a href="https://www.zerodayinitiative.com/blog/2021/11/17/mindshare-using-io-ninja-to-analyze-npfs">MindShaRE: Using IO Ninja to Analyze NPFS </a>
                          
                        </h3>
                         
                          <div class="listing-tags">
                            
                              <!--TAGS-->
                              
                                <a class="tag" href="https://www.zerodayinitiative.com/?tag=MindshaRE">MindshaRE</a>,
                              
                                <a class="tag" href="https://www.zerodayinitiative.com/?tag=IO+Ninja">IO Ninja</a>
                            
                          </div>
                        
                      </div>

                  

                      <div class="column">
                        <div class="content">
                          <div class="thumb">
                              
                                
                                    <a href="https://www.zerodayinitiative.com/blog/2021/11/9/the-november-2021-security-update-review" style="background: url(&#39;https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1636477385395-H64L80OUYGZUIXPDTB21/TitleCard.png&#39;) no-repeat;"></a>
                                

                              
                          </div>
                        </div>
                        <h3 class="title" data-content-field="title">
                          
                            <a href="https://www.zerodayinitiative.com/blog/2021/11/9/the-november-2021-security-update-review">The November 2021 Security Update Review</a>
                          
                        </h3>
                         
                          <div class="listing-tags">
                            
                              <!--TAGS-->
                              
                                <a class="tag" href="https://www.zerodayinitiative.com/?tag=Adobe">Adobe</a>,
                              
                                <a class="tag" href="https://www.zerodayinitiative.com/?tag=Microsoft">Microsoft</a>,
                              
                                <a class="tag" href="https://www.zerodayinitiative.com/?tag=Security+Patch">Security Patch</a>
                            
                          </div>
                        
                      </div>

                  

                      <div class="column">
                        <div class="content">
                          <div class="thumb">
                              
                                
                                    <a href="https://www.zerodayinitiative.com/blog/2021/11/1/pwn2ownaustin" style="background: url(&#39;https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1635624582038-MC1P37R1DIBYBG6TQ1WA/P2OAustin-02.jpg&#39;) no-repeat;"></a>
                                

                              
                          </div>
                        </div>
                        <h3 class="title" data-content-field="title">
                          
                            <a href="https://www.zerodayinitiative.com/blog/2021/11/1/pwn2ownaustin">Pwn2Own Austin 2021 - Schedule and Live Results</a>
                          
                        </h3>
                         
                          <div class="listing-tags">
                            
                              <!--TAGS-->
                              
                                <a class="tag" href="https://www.zerodayinitiative.com/?tag=Pwn2Own">Pwn2Own</a>,
                              
                                <a class="tag" href="https://www.zerodayinitiative.com/?tag=Western+Digital">Western Digital</a>,
                              
                                <a class="tag" href="https://www.zerodayinitiative.com/?tag=Synology">Synology</a>,
                              
                                <a class="tag" href="https://www.zerodayinitiative.com/?tag=Cisco">Cisco</a>,
                              
                                <a class="tag" href="https://www.zerodayinitiative.com/?tag=TPLink">TPLink</a>,
                              
                                <a class="tag" href="https://www.zerodayinitiative.com/?tag=NETGEAR">NETGEAR</a>,
                              
                                <a class="tag" href="https://www.zerodayinitiative.com/?tag=Samsung">Samsung</a>
                            
                          </div>
                        
                      </div>

                  

            </div>
        </div>
    </div><!-- /. blog-listing -->
</div>
          </div>
        </section>

        
        
        

        

        <!--FOOTER WITH OPEN BLOCK FIELD-->
        <footer id="footer">
          <div id="footerContact">
    <div class="content">
        <div class="footerContactBox">
            <h3>General Inquiries</h3>
            <a href="mailto:zdi@trendmicro.com">zdi@trendmicro.com</a>
        </div>
        <div class="footerContactBox">
            <h3>Find us on Twitter</h3>
            <a href="https://twitter.com/thezdi" target="_blank">@thezdi</a>
        </div>
        <div class="footerContactBox">
            <h3>Media Inquiries</h3>
            <a href="mailto:media_relations@trendmicro.com">media_relations@trendmicro.com</a>
        </div>
        <div class="footerContactBox">
            <h3>Sensitive Email Communications</h3>
            <a href="https://www.zerodayinitiative.com/documents/zdi-pgp-key.asc" target="_blank">PGP Key</a>
        </div>
    </div>
</div>

<div id="footerMenu">
    <div id="footerMiddleSection" class="group">
        <div id="footerLinks">
            <div class="content">
                <div class="footerLinkBox">
                            <a href="https://www.zerodayinitiative.com/about" class="footerTitleLink">WHO WE ARE</a>
                            <ul>
                                <li><a href="https://www.zerodayinitiative.com/about">Our Mission</a></li>
                                <li><a href="https://www.trendmicro.com/">Trend Micro</a></li>
                                <li><a href="https://www.trendmicro.com/en_us/business/products/network/integrated-atp/next-gen-intrusion-prevention-system.html">TippingPoint IPS</a></li>
                            </ul>
                        </div>
                        <div class="footerLinkBox">
                            <a href="https://www.zerodayinitiative.com/about/benefits" class="footerTitleLink">HOW IT WORKS</a>
                            <ul>
                                <li><a href="https://www.zerodayinitiative.com/about/benefits#process">Process</a></li>
                                <li><a href="https://www.zerodayinitiative.com/about/benefits#researcher-rewards">Researcher Rewards</a></li>
                                <li><a href="https://www.zerodayinitiative.com/about/faq">FAQS</a></li>
                                <li><a href="https://www.trendmicro.com/privacy">Privacy</a></li>
                            </ul>
                        </div>
                        <div class="footerLinkBox">
                            <a href="https://www.zerodayinitiative.com/advisories" class="footerTitleLink">ADVISORIES</a>
                            <ul>
                                <li><a href="https://www.zerodayinitiative.com/advisories/published">Published Advisories</a></li>
                                <li><a href="https://www.zerodayinitiative.com/advisories/upcoming">Upcoming Advisories</a></li>
                                <li><a href="https://www.zerodayinitiative.com/rss">RSS Feeds</a></li>
                            </ul>
                        </div>
                        <div class="footerLinkBox">
                            <a href="https://www.zerodayinitiative.com/blog" class="footerTitleLink">BLOG</a>
                        </div>

                        <div class="footerLogo">
                            <a href="https://www.zerodayinitiative.com/"><img src="./2020 - CVE-2020-8835 Linux Kernel Privilege Escalation via Improper eBPF Program Verification_files/logo-footer.svg" alt="thezdi"></a>
                        </div>
            </div>
        </div>
    </div>
</div>
        </footer>

        

    <!--INJECTION POINT FOR TRACKING SCRIPTS AND USER CONTENT FROM THE CODE INJECTION TAB-->

    <script type="text/javascript" data-sqs-type="imageloader-bootstrapper">(function() {if(window.ImageLoader) { window.ImageLoader.bootstrap({}, document); }})();</script><script>Squarespace.afterBodyLoad(Y);</script><svg xmlns="http://www.w3.org/2000/svg" version="1.1" style="display:none" data-usage="social-icons-svg"><symbol id="twitter-icon" viewBox="0 0 64 64"><path d="M48,22.1c-1.2,0.5-2.4,0.9-3.8,1c1.4-0.8,2.4-2.1,2.9-3.6c-1.3,0.8-2.7,1.3-4.2,1.6 C41.7,19.8,40,19,38.2,19c-3.6,0-6.6,2.9-6.6,6.6c0,0.5,0.1,1,0.2,1.5c-5.5-0.3-10.3-2.9-13.5-6.9c-0.6,1-0.9,2.1-0.9,3.3 c0,2.3,1.2,4.3,2.9,5.5c-1.1,0-2.1-0.3-3-0.8c0,0,0,0.1,0,0.1c0,3.2,2.3,5.8,5.3,6.4c-0.6,0.1-1.1,0.2-1.7,0.2c-0.4,0-0.8,0-1.2-0.1 c0.8,2.6,3.3,4.5,6.1,4.6c-2.2,1.8-5.1,2.8-8.2,2.8c-0.5,0-1.1,0-1.6-0.1c2.9,1.9,6.4,2.9,10.1,2.9c12.1,0,18.7-10,18.7-18.7 c0-0.3,0-0.6,0-0.8C46,24.5,47.1,23.4,48,22.1z"></path></symbol><symbol id="twitter-mask" viewBox="0 0 64 64"><path d="M0,0v64h64V0H0z M44.7,25.5c0,0.3,0,0.6,0,0.8C44.7,35,38.1,45,26.1,45c-3.7,0-7.2-1.1-10.1-2.9 c0.5,0.1,1,0.1,1.6,0.1c3.1,0,5.9-1,8.2-2.8c-2.9-0.1-5.3-2-6.1-4.6c0.4,0.1,0.8,0.1,1.2,0.1c0.6,0,1.2-0.1,1.7-0.2 c-3-0.6-5.3-3.3-5.3-6.4c0,0,0-0.1,0-0.1c0.9,0.5,1.9,0.8,3,0.8c-1.8-1.2-2.9-3.2-2.9-5.5c0-1.2,0.3-2.3,0.9-3.3 c3.2,4,8.1,6.6,13.5,6.9c-0.1-0.5-0.2-1-0.2-1.5c0-3.6,2.9-6.6,6.6-6.6c1.9,0,3.6,0.8,4.8,2.1c1.5-0.3,2.9-0.8,4.2-1.6 c-0.5,1.5-1.5,2.8-2.9,3.6c1.3-0.2,2.6-0.5,3.8-1C47.1,23.4,46,24.5,44.7,25.5z"></path></symbol><symbol id="youtube-icon" viewBox="0 0 64 64"><path d="M46.7,26c0,0-0.3-2.1-1.2-3c-1.1-1.2-2.4-1.2-3-1.3C38.3,21.4,32,21.4,32,21.4h0 c0,0-6.3,0-10.5,0.3c-0.6,0.1-1.9,0.1-3,1.3c-0.9,0.9-1.2,3-1.2,3S17,28.4,17,30.9v2.3c0,2.4,0.3,4.9,0.3,4.9s0.3,2.1,1.2,3 c1.1,1.2,2.6,1.2,3.3,1.3c2.4,0.2,10.2,0.3,10.2,0.3s6.3,0,10.5-0.3c0.6-0.1,1.9-0.1,3-1.3c0.9-0.9,1.2-3,1.2-3s0.3-2.4,0.3-4.9 v-2.3C47,28.4,46.7,26,46.7,26z M28.9,35.9l0-8.4l8.1,4.2L28.9,35.9z"></path></symbol><symbol id="youtube-mask" viewBox="0 0 64 64"><path d="M0,0v64h64V0H0z M47,33.1c0,2.4-0.3,4.9-0.3,4.9s-0.3,2.1-1.2,3c-1.1,1.2-2.4,1.2-3,1.3 C38.3,42.5,32,42.6,32,42.6s-7.8-0.1-10.2-0.3c-0.7-0.1-2.2-0.1-3.3-1.3c-0.9-0.9-1.2-3-1.2-3S17,35.6,17,33.1v-2.3 c0-2.4,0.3-4.9,0.3-4.9s0.3-2.1,1.2-3c1.1-1.2,2.4-1.2,3-1.3c4.2-0.3,10.5-0.3,10.5-0.3h0c0,0,6.3,0,10.5,0.3c0.6,0.1,1.9,0.1,3,1.3 c0.9,0.9,1.2,3,1.2,3s0.3,2.4,0.3,4.9V33.1z M28.9,35.9l8.1-4.2l-8.1-4.2L28.9,35.9z"></path></symbol></svg>
    </div> <!-- end #innerWrapper -->
    </div> <!-- end #outerWrapper -->
    <script src="./2020 - CVE-2020-8835 Linux Kernel Privilege Escalation via Improper eBPF Program Verification_files/main.js.下載">
  </body>

</html>
</script></body></html>