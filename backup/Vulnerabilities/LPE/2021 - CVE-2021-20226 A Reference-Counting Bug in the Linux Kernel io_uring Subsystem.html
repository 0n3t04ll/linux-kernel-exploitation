<!DOCTYPE html>
<!-- saved from url=(0126)https://www.zerodayinitiative.com/blog/2021/4/22/cve-2021-20226-a-reference-counting-bug-in-the-linux-kernel-iouring-subsystem -->
<html xmlns:og="http://opengraphprotocol.org/schema/" xmlns:fb="http://www.facebook.com/2008/fbml" lang="en-US" class="yui3-js-enabled js flexbox canvas canvastext webgl no-touch hashchange history draganddrop rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients cssreflections csstransforms no-csstransforms3d csstransitions video audio svg inlinesvg svgclippaths" style="" id="yui_3_17_2_1_1638470304756_85"><div id="yui3-css-stamp" style="position: absolute !important; visibility: hidden !important"></div><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <meta name="viewport" content="width=device-width,initial-scale=1">
    

    <link href="./2021 - CVE-2021-20226 A Reference-Counting Bug in the Linux Kernel io_uring Subsystem_files/css" rel="stylesheet"> 
    <link href="./2021 - CVE-2021-20226 A Reference-Counting Bug in the Linux Kernel io_uring Subsystem_files/icon" rel="stylesheet">

    <!--INCLUDE SQS SCRIPTS, META TAGS AND USER CONTENT FROM THE CODE INJECTION TAB-->

    <!-- This is Squarespace. --><!-- brian-gorenc -->
<link charset="utf-8" rel="stylesheet" id="yui_3_17_2_1_1638470304756_121" href="./2021 - CVE-2021-20226 A Reference-Counting Bug in the Linux Kernel io_uring Subsystem_files/simple-liking-47606e375db2b296c3464-min.en-US.css"><script charset="utf-8" id="yui_3_17_2_1_1638470304756_120" src="./2021 - CVE-2021-20226 A Reference-Counting Bug in the Linux Kernel io_uring Subsystem_files/simple-liking-84b2629024662e9fb2c97-min.en-US.js.下載"></script><link charset="utf-8" rel="stylesheet" id="yui_3_17_2_1_1638470304756_125" href="./2021 - CVE-2021-20226 A Reference-Counting Bug in the Linux Kernel io_uring Subsystem_files/social-buttons-b186d09e02921fd7f8e00-min.en-US.css"><script charset="utf-8" id="yui_3_17_2_1_1638470304756_124" src="./2021 - CVE-2021-20226 A Reference-Counting Bug in the Linux Kernel io_uring Subsystem_files/social-buttons-b1c03a6501dfedc48861a-min.en-US.js.下載"></script><!--<base href="">--><base href=".">

<title>Zero Day Initiative — CVE-2021-20226: A Reference-Counting Bug in the Linux Kernel io_uring Subsystem</title>
<link rel="shortcut icon" type="image/x-icon" href="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1487670157237-HOXHMI54TA0SZP21OY7C/favicon.ico">
<link rel="canonical" href="https://www.thezdi.com/blog/2021/4/22/cve-2021-20226-a-reference-counting-bug-in-the-linux-kernel-iouring-subsystem">
<meta property="og:site_name" content="Zero Day Initiative">
<meta property="og:title" content="Zero Day Initiative — CVE-2021-20226: A Reference-Counting Bug in the Linux Kernel io_uring Subsystem">
<meta property="og:latitude" content="40.7207559">
<meta property="og:longitude" content="-74.0007613">
<meta property="og:locality" content="">
<meta property="og:url" content="https://www.thezdi.com/blog/2021/4/22/cve-2021-20226-a-reference-counting-bug-in-the-linux-kernel-iouring-subsystem">
<meta property="og:type" content="article">
<meta property="og:description" content="Conclusion   New features mean new attack surfaces, and new attack surfaces often lead to new bugs being discovered. It will be interesting to see if any other vulnerabilities are found in this subsystem. Regardless, it was a great find by Ryota, and we appreciate his submission. If that name sounds">
<meta property="og:image" content="http://static1.squarespace.com/static/5894c269e4fcb5e65a1ed623/58a5b38cb3db2bd67b608658/60819c79ccd1f642ffcfecd6/1619108844046/computer-technology-car-vintage-retro-number-753544-pxhere.com.jpg?format=1500w">
<meta property="og:image:width" content="1280">
<meta property="og:image:height" content="850">
<meta itemprop="name" content="Zero Day Initiative — CVE-2021-20226: A Reference-Counting Bug in the Linux Kernel io_uring Subsystem">
<meta itemprop="url" content="https://www.thezdi.com/blog/2021/4/22/cve-2021-20226-a-reference-counting-bug-in-the-linux-kernel-iouring-subsystem">
<meta itemprop="description" content="Conclusion   New features mean new attack surfaces, and new attack surfaces often lead to new bugs being discovered. It will be interesting to see if any other vulnerabilities are found in this subsystem. Regardless, it was a great find by Ryota, and we appreciate his submission. If that name sounds">
<meta itemprop="thumbnailUrl" content="http://static1.squarespace.com/static/5894c269e4fcb5e65a1ed623/58a5b38cb3db2bd67b608658/60819c79ccd1f642ffcfecd6/1619108844046/computer-technology-car-vintage-retro-number-753544-pxhere.com.jpg?format=1500w">
<link rel="image_src" href="http://static1.squarespace.com/static/5894c269e4fcb5e65a1ed623/58a5b38cb3db2bd67b608658/60819c79ccd1f642ffcfecd6/1619108844046/computer-technology-car-vintage-retro-number-753544-pxhere.com.jpg?format=1500w">
<meta itemprop="image" content="http://static1.squarespace.com/static/5894c269e4fcb5e65a1ed623/58a5b38cb3db2bd67b608658/60819c79ccd1f642ffcfecd6/1619108844046/computer-technology-car-vintage-retro-number-753544-pxhere.com.jpg?format=1500w">
<meta itemprop="author" content="Lucas Leong">
<meta itemprop="datePublished" content="2021-04-22T11:27:23-0500">
<meta itemprop="dateModified" content="2021-04-22T11:27:24-0500">
<meta itemprop="headline" content="CVE-2021-20226: A Reference-Counting Bug in the Linux Kernel io_uring Subsystem">
<meta itemprop="publisher" content="Zero Day Initiative">
<meta name="twitter:title" content="Zero Day Initiative — CVE-2021-20226: A Reference-Counting Bug in the Linux Kernel io_uring Subsystem">
<meta name="twitter:image" content="http://static1.squarespace.com/static/5894c269e4fcb5e65a1ed623/58a5b38cb3db2bd67b608658/60819c79ccd1f642ffcfecd6/1619108844046/computer-technology-car-vintage-retro-number-753544-pxhere.com.jpg?format=1500w">
<meta name="twitter:url" content="https://www.thezdi.com/blog/2021/4/22/cve-2021-20226-a-reference-counting-bug-in-the-linux-kernel-iouring-subsystem">
<meta name="twitter:card" content="summary">
<meta name="twitter:description" content="Conclusion   New features mean new attack surfaces, and new attack surfaces often lead to new bugs being discovered. It will be interesting to see if any other vulnerabilities are found in this subsystem. Regardless, it was a great find by Ryota, and we appreciate his submission. If that name sounds">
<meta name="description" content="">
<link rel="preconnect" href="https://images.squarespace-cdn.com/">
<link rel="stylesheet" type="text/css" href="./2021 - CVE-2021-20226 A Reference-Counting Bug in the Linux Kernel io_uring Subsystem_files/css2">
<script async="" src="./2021 - CVE-2021-20226 A Reference-Counting Bug in the Linux Kernel io_uring Subsystem_files/analytics.js.下載"></script><script type="text/javascript" crossorigin="anonymous" nomodule="nomodule" src="./2021 - CVE-2021-20226 A Reference-Counting Bug in the Linux Kernel io_uring Subsystem_files/legacy.js.下載"></script>
<script type="text/javascript" crossorigin="anonymous" src="./2021 - CVE-2021-20226 A Reference-Counting Bug in the Linux Kernel io_uring Subsystem_files/modern.js.下載"></script>
<script type="text/javascript">SQUARESPACE_ROLLUPS = {};</script>
<script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/moment-js-vendor-26ddeab7fa5f90b6c8cb3-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-moment_js_vendor');</script>
<script crossorigin="anonymous" src="./2021 - CVE-2021-20226 A Reference-Counting Bug in the Linux Kernel io_uring Subsystem_files/moment-js-vendor-26ddeab7fa5f90b6c8cb3-min.en-US.js.下載"></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/cldr-resource-pack-be81d1ce004cbca505842-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-cldr_resource_pack');</script>
<script crossorigin="anonymous" src="./2021 - CVE-2021-20226 A Reference-Counting Bug in the Linux Kernel io_uring Subsystem_files/cldr-resource-pack-be81d1ce004cbca505842-min.en-US.js.下載"></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/common-vendors-stable-5f58a0e5b599c258afba7-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-common_vendors_stable');</script>
<script crossorigin="anonymous" src="./2021 - CVE-2021-20226 A Reference-Counting Bug in the Linux Kernel io_uring Subsystem_files/common-vendors-stable-5f58a0e5b599c258afba7-min.en-US.js.下載"></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/common-vendors-2b8d103c58c279879debb-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-common_vendors');</script>
<script crossorigin="anonymous" src="./2021 - CVE-2021-20226 A Reference-Counting Bug in the Linux Kernel io_uring Subsystem_files/common-vendors-2b8d103c58c279879debb-min.en-US.js.下載"></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/common-4e8968d09e387393951e6-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-common');</script>
<script crossorigin="anonymous" src="./2021 - CVE-2021-20226 A Reference-Counting Bug in the Linux Kernel io_uring Subsystem_files/common-4e8968d09e387393951e6-min.en-US.js.下載"></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/performance-bc3576cf7eca79df62e49-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-performance');</script>
<script crossorigin="anonymous" src="./2021 - CVE-2021-20226 A Reference-Counting Bug in the Linux Kernel io_uring Subsystem_files/performance-bc3576cf7eca79df62e49-min.en-US.js.下載" defer=""></script><script data-name="static-context">Static = window.Static || {}; Static.SQUARESPACE_CONTEXT = {"facebookAppId":"314192535267336","facebookApiVersion":"v6.0","rollups":{"squarespace-announcement-bar":{"js":"//assets.squarespace.com/universal/scripts-compressed/announcement-bar-2f7261bafe0cccffc79c1-min.en-US.js"},"squarespace-audio-player":{"css":"//assets.squarespace.com/universal/styles-compressed/audio-player-7273d8fcec67906942b35-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/audio-player-bf3733dc1a7a1a312f00b-min.en-US.js"},"squarespace-blog-collection-list":{"css":"//assets.squarespace.com/universal/styles-compressed/blog-collection-list-3d55c64c25996c7633fc2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/blog-collection-list-41fb020c05858537c749a-min.en-US.js"},"squarespace-calendar-block-renderer":{"css":"//assets.squarespace.com/universal/styles-compressed/calendar-block-renderer-5668de53c0ce16e20cc01-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/calendar-block-renderer-8e106d6ff1e1b025652e1-min.en-US.js"},"squarespace-chartjs-helpers":{"css":"//assets.squarespace.com/universal/styles-compressed/chartjs-helpers-58ae73137091cd0a61360-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/chartjs-helpers-f7fcba491a8523ac88fff-min.en-US.js"},"squarespace-comments":{"css":"//assets.squarespace.com/universal/styles-compressed/comments-eeb99f32a31032af774cb-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/comments-6f87194ca559fd42b7649-min.en-US.js"},"squarespace-commerce-cart":{"js":"//assets.squarespace.com/universal/scripts-compressed/commerce-cart-1bf72f78bcd6ff67a17f4-min.en-US.js"},"squarespace-dialog":{"css":"//assets.squarespace.com/universal/styles-compressed/dialog-7b3fdec47b80fd63e5e6f-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/dialog-cbcfce3803b0c7c3a195c-min.en-US.js"},"squarespace-events-collection":{"css":"//assets.squarespace.com/universal/styles-compressed/events-collection-5668de53c0ce16e20cc01-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/events-collection-32833edadee64550abcb4-min.en-US.js"},"squarespace-form-rendering-utils":{"js":"//assets.squarespace.com/universal/scripts-compressed/form-rendering-utils-bb354724a3757df74ec71-min.en-US.js"},"squarespace-forms":{"css":"//assets.squarespace.com/universal/styles-compressed/forms-1cc007b21ede0b73086c9-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/forms-40e56e15ffcec85859b95-min.en-US.js"},"squarespace-gallery-collection-list":{"css":"//assets.squarespace.com/universal/styles-compressed/gallery-collection-list-3d55c64c25996c7633fc2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/gallery-collection-list-cd5d8e548068a3a2586f7-min.en-US.js"},"squarespace-image-zoom":{"css":"//assets.squarespace.com/universal/styles-compressed/image-zoom-60e14b9bac69739c96fa7-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/image-zoom-fa19933bfc5ac12f6e17f-min.en-US.js"},"squarespace-pinterest":{"css":"//assets.squarespace.com/universal/styles-compressed/pinterest-3d55c64c25996c7633fc2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/pinterest-94a487a04e13fea79ec08-min.en-US.js"},"squarespace-popup-overlay":{"css":"//assets.squarespace.com/universal/styles-compressed/popup-overlay-e4ea05bd2ae9c1568e432-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/popup-overlay-b061b4158487e7ae7e527-min.en-US.js"},"squarespace-product-quick-view":{"css":"//assets.squarespace.com/universal/styles-compressed/product-quick-view-663fb8b8c08febe7303f1-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/product-quick-view-d8b0257186afe8865af43-min.en-US.js"},"squarespace-products-collection-item-v2":{"css":"//assets.squarespace.com/universal/styles-compressed/products-collection-item-v2-60e14b9bac69739c96fa7-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/products-collection-item-v2-dbbb091f4df62f531003e-min.en-US.js"},"squarespace-products-collection-list-v2":{"css":"//assets.squarespace.com/universal/styles-compressed/products-collection-list-v2-60e14b9bac69739c96fa7-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/products-collection-list-v2-49760745a9d44239d49d0-min.en-US.js"},"squarespace-search-page":{"css":"//assets.squarespace.com/universal/styles-compressed/search-page-568ad8f2a40e76c0175c8-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/search-page-c5f76c478bd25aaf2e466-min.en-US.js"},"squarespace-search-preview":{"js":"//assets.squarespace.com/universal/scripts-compressed/search-preview-6766a2def97ff8ef1ecfb-min.en-US.js"},"squarespace-share-buttons":{"js":"//assets.squarespace.com/universal/scripts-compressed/share-buttons-b677b0661ada7b7447f04-min.en-US.js"},"squarespace-simple-liking":{"css":"//assets.squarespace.com/universal/styles-compressed/simple-liking-47606e375db2b296c3464-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/simple-liking-84b2629024662e9fb2c97-min.en-US.js"},"squarespace-social-buttons":{"css":"//assets.squarespace.com/universal/styles-compressed/social-buttons-b186d09e02921fd7f8e00-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/social-buttons-b1c03a6501dfedc48861a-min.en-US.js"},"squarespace-tourdates":{"css":"//assets.squarespace.com/universal/styles-compressed/tourdates-3d55c64c25996c7633fc2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/tourdates-63b620d61e3da5004abf0-min.en-US.js"},"squarespace-website-overlays-manager":{"css":"//assets.squarespace.com/universal/styles-compressed/website-overlays-manager-5c2f030f6ee94f066dc3d-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/website-overlays-manager-c7281d57b648e036b6739-min.en-US.js"}},"pageType":50,"website":{"id":"5894c269e4fcb5e65a1ed623","identifier":"brian-gorenc","websiteType":1,"contentModifiedOn":1635895979747,"cloneable":false,"hasBeenCloneable":false,"developerMode":true,"siteStatus":{},"language":"en-US","timeZone":"America/Chicago","machineTimeZoneOffset":-21600000,"timeZoneOffset":-21600000,"timeZoneAbbr":"CST","siteTitle":"Zero Day Initiative","fullSiteTitle":"Zero Day Initiative \u2014 CVE-2021-20226: A Reference-Counting Bug in the Linux Kernel io_uring Subsystem","siteDescription":"","shareButtonOptions":{"2":true,"1":true,"3":true,"6":true,"4":true},"authenticUrl":"https://www.thezdi.com","internalUrl":"https://brian-gorenc.squarespace.com","baseUrl":"https://www.thezdi.com","primaryDomain":"www.thezdi.com","sslSetting":3,"socialAccounts":[{"serviceId":4,"userId":"86973588","userName":"thezdi","screenname":"Zero Day Initiative","addedOn":1492718968086,"profileUrl":"https://twitter.com/thezdi","iconUrl":"http://pbs.twimg.com/profile_images/626740860508442632/dC1lsJPl_normal.png","collectionId":"58f91578e58c6231c1daf261","iconEnabled":true,"serviceName":"twitter"},{"serviceId":11,"userId":"UChbH7B5YhXANmlMYJRHpw0g","screenname":"TippingPoint Zero Day Initiative","addedOn":1492722141068,"profileUrl":"https://www.youtube.com/channel/UChbH7B5YhXANmlMYJRHpw0g","iconUrl":"https://yt3.ggpht.com/-5tyoeQlg_Jk/AAAAAAAAAAI/AAAAAAAAAAA/lrjg7w8bQgA/s88-c-k-no-mo-rj-c0xffffff/photo.jpg","iconEnabled":true,"serviceName":"youtube"}],"typekitId":"","statsMigrated":false,"imageMetadataProcessingEnabled":false,"screenshotId":"a0a901f81f08cc6c7c9e5108d43c513fa4847e74de2b39c335909e3f8dd88d34","showOwnerLogin":false},"websiteSettings":{"id":"5894c269e4fcb5e65a1ed625","websiteId":"5894c269e4fcb5e65a1ed623","subjects":[],"country":"US","state":"TX","simpleLikingEnabled":true,"mobileInfoBarSettings":{"isContactEmailEnabled":false,"isContactPhoneNumberEnabled":false,"isLocationEnabled":false,"isBusinessHoursEnabled":false},"commentLikesAllowed":true,"commentAnonAllowed":true,"commentThreaded":true,"commentApprovalRequired":false,"commentAvatarsOn":true,"commentSortType":2,"commentFlagThreshold":0,"commentFlagsAllowed":true,"commentEnableByDefault":true,"commentDisableAfterDaysDefault":0,"disqusShortname":"","commentsEnabled":false,"contactPhoneNumber":"","storeSettings":{"returnPolicy":null,"termsOfService":null,"privacyPolicy":null,"expressCheckout":false,"continueShoppingLinkUrl":"/","useLightCart":false,"showNoteField":false,"shippingCountryDefaultValue":"US","billToShippingDefaultValue":false,"showShippingPhoneNumber":true,"isShippingPhoneRequired":false,"showBillingPhoneNumber":true,"isBillingPhoneRequired":false,"currenciesSupported":["CHF","HKD","MXN","EUR","DKK","USD","CAD","MYR","NOK","THB","AUD","SGD","ILS","PLN","GBP","CZK","SEK","NZD","PHP","RUB"],"defaultCurrency":"USD","selectedCurrency":"USD","measurementStandard":1,"showCustomCheckoutForm":false,"checkoutPageMarketingOptInEnabled":false,"enableMailingListOptInByDefault":false,"sameAsRetailLocation":false,"merchandisingSettings":{"scarcityEnabledOnProductItems":false,"scarcityEnabledOnProductBlocks":false,"scarcityMessageType":"DEFAULT_SCARCITY_MESSAGE","scarcityThreshold":10,"multipleQuantityAllowedForServices":true,"restockNotificationsEnabled":false,"restockNotificationsMailingListSignUpEnabled":false,"relatedProductsEnabled":false,"relatedProductsOrdering":"random","soldOutVariantsDropdownDisabled":false,"productComposerOptedIn":false,"productComposerABTestOptedOut":false,"productReviewsEnabled":false},"isLive":false,"multipleQuantityAllowedForServices":true},"useEscapeKeyToLogin":true,"ssBadgeType":1,"ssBadgePosition":4,"ssBadgeVisibility":1,"ssBadgeDevices":1,"pinterestOverlayOptions":{"mode":"disabled"},"ampEnabled":false},"cookieSettings":{"isCookieBannerEnabled":false,"isRestrictiveCookiePolicyEnabled":false,"isRestrictiveCookiePolicyAbsolute":false,"cookieBannerText":"","cookieBannerTheme":"","cookieBannerVariant":"","cookieBannerPosition":"","cookieBannerCtaVariant":"","cookieBannerCtaText":"","cookieBannerAcceptType":"OPT_IN","cookieBannerOptOutCtaText":""},"websiteCloneable":false,"collection":{"title":"Blog","id":"58a5b38cb3db2bd67b608658","fullUrl":"/blog","type":1,"permissionType":1},"item":{"title":"CVE-2021-20226: A Reference-Counting Bug in the Linux Kernel io_uring Subsystem","id":"60819c79ccd1f642ffcfecd6","fullUrl":"/blog/2021/4/22/cve-2021-20226-a-reference-counting-bug-in-the-linux-kernel-iouring-subsystem","publicCommentCount":0,"commentState":2,"recordType":1},"subscribed":false,"appDomain":"squarespace.com","templateTweakable":false,"tweakJSON":{"aspect-ratio":"Auto","gallery-arrow-style":"No Background","gallery-aspect-ratio":"3:2 Standard","gallery-auto-crop":"true","gallery-autoplay":"false","gallery-design":"Slideshow","gallery-info-overlay":"Show on Hover","gallery-loop":"false","gallery-navigation":"Bullets","gallery-show-arrows":"true","gallery-transitions":"Fade","galleryArrowBackground":"rgba(34,34,34,1)","galleryArrowColor":"rgba(255,255,255,1)","galleryAutoplaySpeed":"3","galleryCircleColor":"rgba(255,255,255,1)","galleryInfoBackground":"rgba(0, 0, 0, .7)","galleryThumbnailSize":"100px","gridSize":"350px","gridSpacing":"20px","product-gallery-auto-crop":"true","product-image-auto-crop":"true","tweak-v1-related-products-title-spacing":"50px"},"templateId":"58a5cc48579fb3f464465a0c","templateVersion":"7","pageFeatures":[1,2,4],"gmRenderKey":"QUl6YVN5Q0JUUk9xNkx1dkZfSUUxcjQ2LVQ0QWVUU1YtMGQ3bXk4","templateScriptsRootUrl":"https://static1.squarespace.com/static/ta/5894c269e4fcb5e65a1ed623/26/scripts/","betaFeatureFlags":["tock_block","campaigns_show_apply_website_styles_button","commerce_product_composer_ab_test_all_users","campaigns_thumbnail_layout","campaigns_hide_deleted_automations_panel","commerce_category_id_discounts_enabled","member_areas_schedule_interview","member_areas_annual_subscriptions","category-delete-product-service-enabled","commerce_multiple_product_reviews","campaigns_banner_reduce_size","uas_swagger_site_user_account_client","startup_checklist","commerce_restock_notifications","campaigns_global_uc_ab","transactional_email_pipeline_v2_enabled","campaigns_audience_card","reduce_general_search_api_traffic","customer_account_creation_recaptcha","campaigns_new_subscriber_search","campaigns_section_reorder_arrows","commerce_pdp_survey_modal","commerce_onboarding_tools_screen_test","uas_swagger_session_client","commerce_etsy_product_import","commerce_checkout_marketing_opt_in","background_art_onboarding","commerce_instagram_product_checkout_links","commerce_afterpay_pdp","commerce_product_branching","commerce_native_product_reviews","viewer-role-contributor-invites","commerce_pdp_layouts","commerce_site_visitor_metrics","member_areas_billing_state_migration","commerce_activation_experiment_add_payment_processor_card","commerce_product_review_etsy_import","uas_swagger_token_client","uas_swagger_unauthenticated_session_client","product_composer_feedback_form_on_save","campaigns_blog_product_image_editor","commerce_product_review_import_ga","commerce_etsy_shipping_import","nested_categories_migration_enabled"],"impersonatedSession":false,"tzData":{"zones":[[-360,"US","C%sT",null]],"rules":{"US":[[1967,2006,null,"Oct","lastSun","2:00","0","S"],[1987,2006,null,"Apr","Sun>=1","2:00","1:00","D"],[2007,"max",null,"Mar","Sun>=8","2:00","1:00","D"],[2007,"max",null,"Nov","Sun>=1","2:00","0","S"]]}},"showAnnouncementBar":false};</script><script type="text/javascript"> SquarespaceFonts.loadViaContext(); Squarespace.load(window);</script><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="https://www.thezdi.com/blog?format=rss">
<script type="application/ld+json">{"url":"https://www.thezdi.com","name":"Zero Day Initiative","description":"","@context":"http://schema.org","@type":"WebSite"}</script><script type="application/ld+json">{"name":"Zero Day Initiative \u2014 CVE-2021-20226: A Reference-Counting Bug in the Linux Kernel io_uring Subsystem","url":"https://www.thezdi.com/blog/2021/4/22/cve-2021-20226-a-reference-counting-bug-in-the-linux-kernel-iouring-subsystem","datePublished":"2021-04-22T11:27:23-0500","dateModified":"2021-04-22T11:27:24-0500","headline":"CVE-2021-20226: A Reference-Counting Bug in the Linux Kernel io_uring Subsystem","author":"Lucas Leong","publisher":{"name":"Zero Day Initiative","logo":{"@type":"ImageObject"},"@context":"http://schema.org","@type":"Organization"},"image":"http://static1.squarespace.com/static/5894c269e4fcb5e65a1ed623/58a5b38cb3db2bd67b608658/60819c79ccd1f642ffcfecd6/1619108844046/computer-technology-car-vintage-retro-number-753544-pxhere.com.jpg?format=1500w","@context":"http://schema.org","@type":"Article"}</script><link rel="stylesheet" type="text/css" href="./2021 - CVE-2021-20226 A Reference-Counting Bug in the Linux Kernel io_uring Subsystem_files/site.css"><script>
if (window.location.host == "www.thezdi.com") {window.location = "https://www.zerodayinitiative.com" + window.location.pathname}</script><script>Static.COOKIE_BANNER_CAPABLE = true;</script>
<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create', 'UA-93169700-1', 'auto');ga('send', 'pageview');</script><!-- End of Squarespace Headers -->
    <link rel="stylesheet" href="./2021 - CVE-2021-20226 A Reference-Counting Bug in the Linux Kernel io_uring Subsystem_files/main.css">


  </head>

  <body id="item-60819c79ccd1f642ffcfecd6" class="event-show-past-events event-thumbnails event-thumbnail-size-32-standard event-date-label  event-list-show-cats event-list-date event-list-time event-list-address   event-icalgcal-links  event-excerpts      gallery-design-slideshow aspect-ratio-auto lightbox-style-dark gallery-navigation-bullets gallery-info-overlay-show-on-hover gallery-aspect-ratio-32-standard gallery-arrow-style-no-background gallery-transitions-fade gallery-show-arrows gallery-auto-crop   product-list-titles-under product-list-alignment-left product-item-size-11-square product-image-auto-crop product-gallery-size-11-square product-gallery-auto-crop show-product-price show-product-item-nav product-social-sharing tweak-v1-related-products-image-aspect-ratio-11-square tweak-v1-related-products-details-alignment-center newsletter-style-dark hide-opentable-icons opentable-style-dark small-button-style-solid small-button-shape-square medium-button-style-solid medium-button-shape-square large-button-style-solid large-button-shape-square image-block-poster-text-alignment-center image-block-card-dynamic-font-sizing image-block-card-content-position-center image-block-card-text-alignment-left image-block-overlap-dynamic-font-sizing image-block-overlap-content-position-center image-block-overlap-text-alignment-left image-block-collage-dynamic-font-sizing image-block-collage-content-position-top image-block-collage-text-alignment-left image-block-stack-dynamic-font-sizing image-block-stack-text-alignment-left button-style-solid button-corner-style-square tweak-product-quick-view-button-style-floating tweak-product-quick-view-button-position-bottom tweak-product-quick-view-lightbox-excerpt-display-truncate tweak-product-quick-view-lightbox-show-arrows tweak-product-quick-view-lightbox-show-close-button tweak-product-quick-view-lightbox-controls-weight-light native-currency-code-usd collection-58a5b38cb3db2bd67b608658 view-item collection-type-blog collection-layout-default mobile-style-available">

    <div id="outerWrapper">

      <div id="bgOverlay"></div>

      <!--HEADER-->

      <header id="header">

        <!--MAIN NAVIGATION-->
            <!-- Begin Off Canvas Menu-->
    <div class="off-canvas">
        <nav class="off-canvas__list" role="main-navigation2">
            <div class="js-mobile-nav-toggle">Menu</div>
            <ul class="topMenu">
                <li class="nav__tier1"><a href="https://www.trendmicro.com/privacy">PRIVACY</a></li>
                <li class="nav__tier1"><a href="https://www.zerodayinitiative.com/about">WHO WE ARE</a></li>
                <li class="nav__tier1"><a href="https://www.zerodayinitiative.com/about/benefits">HOW IT WORKS</a></li>
                <li class="nav__tier1"><a href="https://www.zerodayinitiative.com/blog">BLOG</a></li>
                <li class="nav__tier1"><a href="https://www.zerodayinitiative.com/advisories">ADVISORIES</a></li>
                <li class="nav__tier1"><a class="sign-in" href="https://www.zerodayinitiative.com/portal">LOG IN</a></li>
                <li class="nav__tier1"><a class="sign-in" href="https://www.zerodayinitiative.com/portal/register">SIGN UP</a></li>
            </ul>
            <ul class="bottomMenu">
                <li class="nav__tier1 logo"><a href="https://www.zerodayinitiative.com/"><img src="./2021 - CVE-2021-20226 A Reference-Counting Bug in the Linux Kernel io_uring Subsystem_files/logo.svg" width="125" height="37" alt="thezdi"></a></li>
                <li class="nav__tier1"><a href="https://www.trendmicro.com/">Trend Micro</a></li>
            </ul>
        </nav>
    </div>
    <!-- End Off Canvas Menu -->
            <div id="nav" class="group">
        <div id="navContent">
            <div class="nav__container">
                <div class="nav__header">
                    <div class="global-header__logo">
                        <a href="https://www.zerodayinitiative.com/"><img src="./2021 - CVE-2021-20226 A Reference-Counting Bug in the Linux Kernel io_uring Subsystem_files/logo.svg" alt="thezdi"></a>
                    </div>
                    <div id="mobileNavIcon" class="js-mobile-nav-toggle">Menu</div>
                    <div id="mobileOverlay"></div>
                </div>
                <nav class="nav__list" role="main-navigation">
                    <ul class="list-no-bullets">
                        <li class="nav__tier1"><a href="https://www.trendmicro.com/privacy">PRIVACY</a></li>
                        <li class="nav__tier1"><a href="https://www.zerodayinitiative.com/about">WHO WE ARE</a></li>
                        <li class="nav__tier1"><a href="https://www.zerodayinitiative.com/about/benefits">HOW IT WORKS</a></li>
                        <li class="nav__tier1"><a href="https://www.zerodayinitiative.com/blog">BLOG</a></li>
                        <li class="nav__tier1"><a href="https://www.zerodayinitiative.com/advisories">ADVISORIES</a></li>
                        <li class="nav__tier1 userActions">
                            <a href="https://www.zerodayinitiative.com/portal/">LOG IN</a>
                            <a href="https://www.zerodayinitiative.com/portal/register">SIGN UP</a>
                            </li><li>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>
    </div>


      </header>

      <!--SITE TITLE OR LOGO-->
      <div id="innerWrapper">

      <!--CONTENT INJECTION POINT-->
        <section id="content">
          <div class="main-content-wrapper cf" data-content-field="main-content" id="yui_3_17_2_1_1638470304756_84">
            <!-- CATEGORY NAV -->
            
            <div id="mainContent" class="blogDetails group subscribeAbs">
    <div id="imageMasthead" class="smaller">
        <div class="content">
            
                <h1 class="title" data-content-field="title">
                  
                    CVE-2021-20226: A Reference-Counting Bug in the Linux Kernel io_uring Subsystem
                  
                </h1>
                <data>April 22, 2021  |  Lucas Leong</data>
            
        </div>
    </div>

    <div class="blog-listing blog-details" id="yui_3_17_2_1_1638470304756_83">
        <div class="subscribe-container">
            <a href="https://www.zerodayinitiative.com/rss/" class="btn subscribe rounded">SUBSCRIBE</a>
        </div>
        <div class="section" id="yui_3_17_2_1_1638470304756_82">
            <div class="contentBlock" id="yui_3_17_2_1_1638470304756_81">
                <div class="contentBlockCopy" id="yui_3_17_2_1_1638470304756_80">
                    
                      <div class="group" id="yui_3_17_2_1_1638470304756_79">
                        <div class="sqs-layout sqs-grid-12 columns-12" data-layout-label="Post Body" data-type="item" data-updated-on="1619107026321" id="item-60819c79ccd1f642ffcfecd6"><div class="row sqs-row" id="yui_3_17_2_1_1638470304756_78"><div class="col sqs-col-12 span-12" id="yui_3_17_2_1_1638470304756_77"><div class="sqs-block markdown-block sqs-block-markdown" data-block-type="44" id="block-yui_3_17_2_1_1618514307044_11720"><div class="sqs-block-content"><p>In June 2020, we received a Linux kernel submission detailing a reference-counting bug in the recently introduced io_uring subsystem. The bug leads to a use-after-free on any <code>file</code> structure, which can be leveraged for privilege escalation in the kernel. This bug was submitted by Ryota Shiga (<a href="https://twitter.com/ga_ryo_">@Ga_ryo_</a>) of Flatt Security.</p>
<p>We believe that the vulnerability affected the Linux kernel from version 5.6 to 5.7 inclusive. The vulnerability has been assigned identifiers <a href="https://www.zerodayinitiative.com/advisories/ZDI-21-001/">ZDI-21-001</a> and <a href="https://bugzilla.redhat.com/show_bug.cgi?id=1873476">CVE-2021-20226</a>.</p>
<p><b data-preserve-html-node="true">The Vulnerability</b></p>
<p>Linux kernel 5.1 introduced a new asynchronous I/O feature called <a href="https://lwn.net/Articles/810414/">io_uring</a>. This subsystem operates by batching I/O operation system calls, so that multiple I/O operations can be performed in one system call.</p>
<p>Linux kernel 5.6 has a flawed implementation of the <code>IORING_OP_CLOSE</code> operation. When a system call passes a <code>files_struct</code> to a kernel thread, <code>io_grab_files()</code> doesn’t increment the reference counter at (1). This can lead to a later access of the freed file structure.</p>
</div></div><div class="sqs-block embed-block sqs-block-embed" data-block-json="{&quot;hSize&quot;:null,&quot;floatDir&quot;:null,&quot;html&quot;:&quot;&lt;script src=\&quot;https://gist.github.com/2694f0adc298fdd35c3c1061f3af53f1.js\&quot;&gt;&lt;/script&gt;&quot;,&quot;resolvedBy&quot;:&quot;manual&quot;,&quot;resolved&quot;:true}" data-block-type="22" id="block-yui_3_17_2_1_1618514307044_25947"><div class="sqs-block-content" id="yui_3_17_2_1_1638470304756_66" style="visibility: visible; opacity: 1; height: auto;"><script src="./2021 - CVE-2021-20226 A Reference-Counting Bug in the Linux Kernel io_uring Subsystem_files/2694f0adc298fdd35c3c1061f3af53f1.js.下載"></script><link rel="stylesheet" href="./2021 - CVE-2021-20226 A Reference-Counting Bug in the Linux Kernel io_uring Subsystem_files/gist-embed-ff75a167df5efbfedb0e388793ca9fe7.css"><div id="gist109118516" class="gist">
    <div class="gist-file" translate="no">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-cve-2021-20226-snippet-1-cpp" class="file my-2">
    
  <div itemprop="text" class="Box-body p-0 blob-wrapper data type-c  ">

      
<div class="js-check-bidi blob-code-content">
  <template class="js-file-alert-template"></template>
<template class="js-line-alert-template"></template>

  <table class="highlight tab-size js-file-line-container js-code-nav-container js-tagsearch-file" data-tab-size="8" data-paste-markdown-skip="" data-tagsearch-lang="C++" data-tagsearch-path="CVE-2021-20226-snippet-1.cpp">
        <tbody><tr>
          <td id="file-cve-2021-20226-snippet-1-cpp-L1" class="blob-num js-line-number js-code-nav-line-number" data-line-number="1"></td>
          <td id="file-cve-2021-20226-snippet-1-cpp-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">static</span> <span class="pl-k">int</span> <span class="pl-en">io_grab_files</span>(<span class="pl-k">struct</span> <span class="pl-en">io_kiocb</span> *req) </td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-1-cpp-L2" class="blob-num js-line-number js-code-nav-line-number" data-line-number="2"></td>
          <td id="file-cve-2021-20226-snippet-1-cpp-LC2" class="blob-code blob-code-inner js-file-line">{ </td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-1-cpp-L3" class="blob-num js-line-number js-code-nav-line-number" data-line-number="3"></td>
          <td id="file-cve-2021-20226-snippet-1-cpp-LC3" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">//</span> ... </span></td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-1-cpp-L4" class="blob-num js-line-number js-code-nav-line-number" data-line-number="4"></td>
          <td id="file-cve-2021-20226-snippet-1-cpp-LC4" class="blob-code blob-code-inner js-file-line"> </td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-1-cpp-L5" class="blob-num js-line-number js-code-nav-line-number" data-line-number="5"></td>
          <td id="file-cve-2021-20226-snippet-1-cpp-LC5" class="blob-code blob-code-inner js-file-line">    <span class="pl-c1">rcu_read_lock</span>(); </td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-1-cpp-L6" class="blob-num js-line-number js-code-nav-line-number" data-line-number="6"></td>
          <td id="file-cve-2021-20226-snippet-1-cpp-LC6" class="blob-code blob-code-inner js-file-line">    <span class="pl-c1">spin_lock_irq</span>(&amp;ctx-&gt;<span class="pl-smi">inflight_lock</span>);<span class="pl-c1">spin_lock_irq</span>(&amp;ctx-&gt;<span class="pl-smi">inflight_lock</span>); </td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-1-cpp-L7" class="blob-num js-line-number js-code-nav-line-number" data-line-number="7"></td>
          <td id="file-cve-2021-20226-snippet-1-cpp-LC7" class="blob-code blob-code-inner js-file-line"> </td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-1-cpp-L8" class="blob-num js-line-number js-code-nav-line-number" data-line-number="8"></td>
          <td id="file-cve-2021-20226-snippet-1-cpp-LC8" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">if</span> (<span class="pl-c1">fcheck</span>(ctx-&gt;<span class="pl-smi">ring_fd</span>) == ctx-&gt;<span class="pl-smi">ring_file</span>) { </td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-1-cpp-L9" class="blob-num js-line-number js-code-nav-line-number" data-line-number="9"></td>
          <td id="file-cve-2021-20226-snippet-1-cpp-LC9" class="blob-code blob-code-inner js-file-line">        <span class="pl-c1">list_add</span>(&amp;req-&gt;<span class="pl-smi">inflight_entry</span>, &amp;ctx-&gt;<span class="pl-smi">inflight_list</span>); </td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-1-cpp-L10" class="blob-num js-line-number js-code-nav-line-number" data-line-number="10"></td>
          <td id="file-cve-2021-20226-snippet-1-cpp-LC10" class="blob-code blob-code-inner js-file-line">        req-&gt;<span class="pl-smi">flags</span> |= REQ_F_INFLIGHT; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-1-cpp-L11" class="blob-num js-line-number js-code-nav-line-number" data-line-number="11"></td>
          <td id="file-cve-2021-20226-snippet-1-cpp-LC11" class="blob-code blob-code-inner js-file-line">        req-&gt;<span class="pl-smi">work</span>.<span class="pl-smi">files</span> = current-&gt;<span class="pl-smi">files</span>;  <span class="pl-c"><span class="pl-c">//</span> &lt;-- (1) </span></td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-1-cpp-L12" class="blob-num js-line-number js-code-nav-line-number" data-line-number="12"></td>
          <td id="file-cve-2021-20226-snippet-1-cpp-LC12" class="blob-code blob-code-inner js-file-line">        ret = <span class="pl-c1">0</span>; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-1-cpp-L13" class="blob-num js-line-number js-code-nav-line-number" data-line-number="13"></td>
          <td id="file-cve-2021-20226-snippet-1-cpp-LC13" class="blob-code blob-code-inner js-file-line">    } </td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-1-cpp-L14" class="blob-num js-line-number js-code-nav-line-number" data-line-number="14"></td>
          <td id="file-cve-2021-20226-snippet-1-cpp-LC14" class="blob-code blob-code-inner js-file-line">    <span class="pl-c1">spin_unlock_irq</span>(&amp;ctx-&gt;<span class="pl-smi">inflight_lock</span>); </td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-1-cpp-L15" class="blob-num js-line-number js-code-nav-line-number" data-line-number="15"></td>
          <td id="file-cve-2021-20226-snippet-1-cpp-LC15" class="blob-code blob-code-inner js-file-line">    <span class="pl-c1">rcu_read_unlock</span>(); </td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-1-cpp-L16" class="blob-num js-line-number js-code-nav-line-number" data-line-number="16"></td>
          <td id="file-cve-2021-20226-snippet-1-cpp-LC16" class="blob-code blob-code-inner js-file-line"> </td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-1-cpp-L17" class="blob-num js-line-number js-code-nav-line-number" data-line-number="17"></td>
          <td id="file-cve-2021-20226-snippet-1-cpp-LC17" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">return</span> ret; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-1-cpp-L18" class="blob-num js-line-number js-code-nav-line-number" data-line-number="18"></td>
          <td id="file-cve-2021-20226-snippet-1-cpp-LC18" class="blob-code blob-code-inner js-file-line">}</td>
        </tr>
  </tbody></table>
</div>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/zdi-team/2694f0adc298fdd35c3c1061f3af53f1/raw/a5e9d6a812f338c7fce25c4ae57d3df01c756568/CVE-2021-20226-snippet-1.cpp" style="float:right">view raw</a>
        <a href="https://gist.github.com/zdi-team/2694f0adc298fdd35c3c1061f3af53f1#file-cve-2021-20226-snippet-1-cpp">
          CVE-2021-20226-snippet-1.cpp
        </a>
        hosted with ❤ by <a href="https://github.com/">GitHub</a>
      </div>
    </div>
</div>
</div></div><div class="sqs-block markdown-block sqs-block-markdown" data-block-type="44" id="block-yui_3_17_2_1_1618514307044_27063"><div class="sqs-block-content"><p><b data-preserve-html-node="true">Exploitation</b></p>
<p>The <code>map_lookup_elem()</code> and <code>map_update_elem()</code> functions are good candidates for use in exploiting this bug.</p>
</div></div><div class="sqs-block embed-block sqs-block-embed" data-block-json="{&quot;hSize&quot;:null,&quot;floatDir&quot;:null,&quot;html&quot;:&quot;&lt;script src=\&quot;https://gist.github.com/0111b87efd37ae82be62ce8ffafa3fed.js\&quot;&gt;&lt;/script&gt;&quot;,&quot;resolvedBy&quot;:&quot;manual&quot;,&quot;resolved&quot;:true}" data-block-type="22" id="block-yui_3_17_2_1_1618514307044_28736"><div class="sqs-block-content" id="yui_3_17_2_1_1638470304756_69" style="visibility: visible; opacity: 1; height: auto;"><script src="./2021 - CVE-2021-20226 A Reference-Counting Bug in the Linux Kernel io_uring Subsystem_files/0111b87efd37ae82be62ce8ffafa3fed.js.下載"></script><link rel="stylesheet" href="./2021 - CVE-2021-20226 A Reference-Counting Bug in the Linux Kernel io_uring Subsystem_files/gist-embed-ff75a167df5efbfedb0e388793ca9fe7.css"><div id="gist109118581" class="gist">
    <div class="gist-file" translate="no">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-cve-2021-20226-snippet-2-cpp" class="file my-2">
    
  <div itemprop="text" class="Box-body p-0 blob-wrapper data type-c  ">

      
<div class="js-check-bidi blob-code-content">
  <template class="js-file-alert-template"></template>
<template class="js-line-alert-template"></template>

  <table class="highlight tab-size js-file-line-container js-code-nav-container js-tagsearch-file" data-tab-size="8" data-paste-markdown-skip="" data-tagsearch-lang="C++" data-tagsearch-path="CVE-2021-20226-snippet-2.cpp">
        <tbody><tr>
          <td id="file-cve-2021-20226-snippet-2-cpp-L1" class="blob-num js-line-number js-code-nav-line-number" data-line-number="1"></td>
          <td id="file-cve-2021-20226-snippet-2-cpp-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">static</span> <span class="pl-k">int</span> <span class="pl-en">map_lookup_elem</span>(<span class="pl-k">union</span> bpf_attr *attr) </td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-2-cpp-L2" class="blob-num js-line-number js-code-nav-line-number" data-line-number="2"></td>
          <td id="file-cve-2021-20226-snippet-2-cpp-LC2" class="blob-code blob-code-inner js-file-line">{ </td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-2-cpp-L3" class="blob-num js-line-number js-code-nav-line-number" data-line-number="3"></td>
          <td id="file-cve-2021-20226-snippet-2-cpp-LC3" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">void</span> __user *ukey = <span class="pl-c1">u64_to_user_ptr</span>(attr-&gt;<span class="pl-smi">key</span>); </td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-2-cpp-L4" class="blob-num js-line-number js-code-nav-line-number" data-line-number="4"></td>
          <td id="file-cve-2021-20226-snippet-2-cpp-LC4" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">int</span> ufd = attr-&gt;<span class="pl-smi">map_fd</span>; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-2-cpp-L5" class="blob-num js-line-number js-code-nav-line-number" data-line-number="5"></td>
          <td id="file-cve-2021-20226-snippet-2-cpp-LC5" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">//</span> ... </span></td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-2-cpp-L6" class="blob-num js-line-number js-code-nav-line-number" data-line-number="6"></td>
          <td id="file-cve-2021-20226-snippet-2-cpp-LC6" class="blob-code blob-code-inner js-file-line">    f = <span class="pl-c1">fdget</span>(ufd);          <span class="pl-c"><span class="pl-c">//</span> &lt;-- (2) </span></td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-2-cpp-L7" class="blob-num js-line-number js-code-nav-line-number" data-line-number="7"></td>
          <td id="file-cve-2021-20226-snippet-2-cpp-LC7" class="blob-code blob-code-inner js-file-line">    map = <span class="pl-c1">__bpf_map_get</span>(f); </td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-2-cpp-L8" class="blob-num js-line-number js-code-nav-line-number" data-line-number="8"></td>
          <td id="file-cve-2021-20226-snippet-2-cpp-LC8" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">//</span> ... </span></td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-2-cpp-L9" class="blob-num js-line-number js-code-nav-line-number" data-line-number="9"></td>
          <td id="file-cve-2021-20226-snippet-2-cpp-LC9" class="blob-code blob-code-inner js-file-line">    key = <span class="pl-c1">__bpf_copy_key</span>(ukey, map-&gt;<span class="pl-smi">key_size</span>); key = <span class="pl-c1">__bpf_copy_key</span>(ukey, map-&gt;<span class="pl-smi">key_size</span>); <span class="pl-c"><span class="pl-c">//</span> &lt;-- (3) </span></td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-2-cpp-L10" class="blob-num js-line-number js-code-nav-line-number" data-line-number="10"></td>
          <td id="file-cve-2021-20226-snippet-2-cpp-LC10" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">if</span> (<span class="pl-c1">IS_ERR</span>(key)) { </td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-2-cpp-L11" class="blob-num js-line-number js-code-nav-line-number" data-line-number="11"></td>
          <td id="file-cve-2021-20226-snippet-2-cpp-LC11" class="blob-code blob-code-inner js-file-line">        err = <span class="pl-c1">PTR_ERR</span>(key); </td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-2-cpp-L12" class="blob-num js-line-number js-code-nav-line-number" data-line-number="12"></td>
          <td id="file-cve-2021-20226-snippet-2-cpp-LC12" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">goto</span> err_put; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-2-cpp-L13" class="blob-num js-line-number js-code-nav-line-number" data-line-number="13"></td>
          <td id="file-cve-2021-20226-snippet-2-cpp-LC13" class="blob-code blob-code-inner js-file-line">    } </td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-2-cpp-L14" class="blob-num js-line-number js-code-nav-line-number" data-line-number="14"></td>
          <td id="file-cve-2021-20226-snippet-2-cpp-LC14" class="blob-code blob-code-inner js-file-line"> </td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-2-cpp-L15" class="blob-num js-line-number js-code-nav-line-number" data-line-number="15"></td>
          <td id="file-cve-2021-20226-snippet-2-cpp-LC15" class="blob-code blob-code-inner js-file-line">    value_size = <span class="pl-c1">bpf_map_value_size</span>(map);  <span class="pl-c"><span class="pl-c">//</span> &lt;-- (4) </span></td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-2-cpp-L16" class="blob-num js-line-number js-code-nav-line-number" data-line-number="16"></td>
          <td id="file-cve-2021-20226-snippet-2-cpp-LC16" class="blob-code blob-code-inner js-file-line"> </td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-2-cpp-L17" class="blob-num js-line-number js-code-nav-line-number" data-line-number="17"></td>
          <td id="file-cve-2021-20226-snippet-2-cpp-LC17" class="blob-code blob-code-inner js-file-line">    err = -ENOMEM; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-2-cpp-L18" class="blob-num js-line-number js-code-nav-line-number" data-line-number="18"></td>
          <td id="file-cve-2021-20226-snippet-2-cpp-LC18" class="blob-code blob-code-inner js-file-line">    value = <span class="pl-c1">kmalloc</span>(value_size, GFP_USER | __GFP_NOWARN); </td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-2-cpp-L19" class="blob-num js-line-number js-code-nav-line-number" data-line-number="19"></td>
          <td id="file-cve-2021-20226-snippet-2-cpp-LC19" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">if</span> (!value) </td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-2-cpp-L20" class="blob-num js-line-number js-code-nav-line-number" data-line-number="20"></td>
          <td id="file-cve-2021-20226-snippet-2-cpp-LC20" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">goto</span> free_key; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-2-cpp-L21" class="blob-num js-line-number js-code-nav-line-number" data-line-number="21"></td>
          <td id="file-cve-2021-20226-snippet-2-cpp-LC21" class="blob-code blob-code-inner js-file-line"> </td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-2-cpp-L22" class="blob-num js-line-number js-code-nav-line-number" data-line-number="22"></td>
          <td id="file-cve-2021-20226-snippet-2-cpp-LC22" class="blob-code blob-code-inner js-file-line">    err = <span class="pl-c1">bpf_map_copy_value</span>(map, key, value, attr-&gt;<span class="pl-smi">flags</span>); <span class="pl-c"><span class="pl-c">//</span> &lt;-- (5) </span></td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-2-cpp-L23" class="blob-num js-line-number js-code-nav-line-number" data-line-number="23"></td>
          <td id="file-cve-2021-20226-snippet-2-cpp-LC23" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">if</span> (err) </td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-2-cpp-L24" class="blob-num js-line-number js-code-nav-line-number" data-line-number="24"></td>
          <td id="file-cve-2021-20226-snippet-2-cpp-LC24" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">goto</span> free_value; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-2-cpp-L25" class="blob-num js-line-number js-code-nav-line-number" data-line-number="25"></td>
          <td id="file-cve-2021-20226-snippet-2-cpp-LC25" class="blob-code blob-code-inner js-file-line"> </td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-2-cpp-L26" class="blob-num js-line-number js-code-nav-line-number" data-line-number="26"></td>
          <td id="file-cve-2021-20226-snippet-2-cpp-LC26" class="blob-code blob-code-inner js-file-line">    err = -EFAULT; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-2-cpp-L27" class="blob-num js-line-number js-code-nav-line-number" data-line-number="27"></td>
          <td id="file-cve-2021-20226-snippet-2-cpp-LC27" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">if</span> (<span class="pl-c1">copy_to_user</span>(uvalue, value, value_size) != <span class="pl-c1">0</span>) <span class="pl-c"><span class="pl-c">//</span> &lt;-- (6) </span></td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-2-cpp-L28" class="blob-num js-line-number js-code-nav-line-number" data-line-number="28"></td>
          <td id="file-cve-2021-20226-snippet-2-cpp-LC28" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">goto</span> free_value; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-2-cpp-L29" class="blob-num js-line-number js-code-nav-line-number" data-line-number="29"></td>
          <td id="file-cve-2021-20226-snippet-2-cpp-LC29" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">//</span> ... </span></td>
        </tr>
        <tr>
          <td id="file-cve-2021-20226-snippet-2-cpp-L30" class="blob-num js-line-number js-code-nav-line-number" data-line-number="30"></td>
          <td id="file-cve-2021-20226-snippet-2-cpp-LC30" class="blob-code blob-code-inner js-file-line">}</td>
        </tr>
  </tbody></table>
</div>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/zdi-team/0111b87efd37ae82be62ce8ffafa3fed/raw/f46a53bbab5e06c0e14c74007ff4ef930276ca4c/CVE-2021-20226-snippet-2.cpp" style="float:right">view raw</a>
        <a href="https://gist.github.com/zdi-team/0111b87efd37ae82be62ce8ffafa3fed#file-cve-2021-20226-snippet-2-cpp">
          CVE-2021-20226-snippet-2.cpp
        </a>
        hosted with ❤ by <a href="https://github.com/">GitHub</a>
      </div>
    </div>
</div>
</div></div><div class="sqs-block markdown-block sqs-block-markdown" data-block-type="44" id="block-yui_3_17_2_1_1618514307044_29829"><div class="sqs-block-content"><p>The <code>fdget()</code> at (2) is an optimized function that doesn't increase the reference count if the current task is <a href="https://elixir.bootlin.com/linux/v5.6.17/source/fs/file.c#L795">single-thread</a>. The returned <code>file</code> structure, <code>f</code>, can be freed by a later <code>IORING_OP_CLOSE</code>. The <code>__bpf_copy_key()</code> syscall at (3) is actually a wrapper for <code>copy_from_user()</code>. This provides an opportunity to produce a race condition by using <a href="https://www.kernel.org/doc/html/latest/admin-guide/mm/userfaultfd.html">userfaultfd</a> and triggering the vulnerability. At this point, file structure <code>f</code> and its corresponding <code>map</code> are freed. The memory of the <code>map</code> can be reallocated with fake data at (4) and (5). Finally, we can read arbitrary memory at (6) and disclose to usermode.</p>
<p>Here is an overview for the exploit timeline:</p>
</div></div><div class="sqs-block image-block sqs-block-image sqs-text-ready" data-block-type="5" id="block-yui_3_17_2_1_1618514307044_32073"><div class="sqs-block-content" id="yui_3_17_2_1_1638470304756_76">













  

    
  
    <div class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        " data-test="image-block-inline-outer-wrapper" id="yui_3_17_2_1_1638470304756_75">

      

      
        <figure class="
              sqs-block-image-figure
              intrinsic
            " style="max-width:1516px;" id="yui_3_17_2_1_1638470304756_74">
          
        
        

        
          
            <button class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                " data-description="&lt;p class=&quot;&quot; style=&quot;white-space:pre-wrap;&quot;&gt;&lt;em&gt;Figure 1 - The Exploit Timeline&lt;/em&gt;&lt;/p&gt;" data-lightbox-theme="dark" id="yui_3_17_2_1_1638470304756_73">
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div class="image-block-wrapper" data-animation-role="image" id="yui_3_17_2_1_1638470304756_72">
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:78.23218536376953%;
                
                
  overflow: hidden;
  
    
    
    
    
  

              " id="yui_3_17_2_1_1638470304756_71">
              <noscript><img src="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1619107238209-YBRE5GXE7VL5A1RXZWW7/picture1.png" alt="Figure 1 - The Exploit Timeline" /></noscript><img class="thumb-image loaded" data-src="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1619107238209-YBRE5GXE7VL5A1RXZWW7/picture1.png" data-image="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1619107238209-YBRE5GXE7VL5A1RXZWW7/picture1.png" data-image-dimensions="1516x1186" data-image-focal-point="0.5,0.5" data-load="false" data-image-id="60819da6951a507ee2ccea28" data-type="image" style="left: -0.0342086%; top: 0%; width: 100.068%; height: 100%; position: absolute;" alt="Figure 1 - The Exploit Timeline" data-image-resolution="1000w" src="./2021 - CVE-2021-20226 A Reference-Counting Bug in the Linux Kernel io_uring Subsystem_files/picture1.png">
            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><em>Figure 1 - The Exploit Timeline</em></p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block markdown-block sqs-block-markdown" data-block-type="44" id="block-yui_3_17_2_1_1618514307044_33980"><div class="sqs-block-content"><p>The <code>recvmsg()</code> function is for timing control. The freed <code>bpf_map</code> can be faked by spraying with <code>setxattr()</code>. The arbitrary write can be achieved by <code>map_update_elem()</code>. This exploit method is restricted to a single-core environment due to the condition of <code>fdget()</code>.</p>
</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1618514307044_35011"><div class="sqs-block-content"><p class="" style="white-space:pre-wrap;"><strong>Conclusion</strong></p><p class="" style="white-space:pre-wrap;">New features mean new attack surfaces, and new attack surfaces often lead to new bugs being discovered. It will be interesting to see if any other vulnerabilities are found in this subsystem. Regardless, it was a great find by Ryota, and we appreciate his submission. If that name sounds familiar at all, Ryota also competed in the most recent <a href="https://www.zerodayinitiative.com/blog/2021/4/2/pwn2own-2021-schedule-and-live-results">Pwn2Own</a> and won $30,000 demonstrating a different privilege escalation bug on Ubuntu. We look forward to seeing more from him in the future. </p><p class="" style="white-space:pre-wrap;">You can find me on Twitter&nbsp;<a href="https://twitter.com/_wmliang_">@_wmliang_</a>, and follow the&nbsp;<a href="https://twitter.com/thezdi">team</a>&nbsp;for the latest in exploit techniques and security patches.</p></div></div></div></div></div>
                      </div>

                       
                        <ul class="blog-tags">
                          
                            <!--TAGS-->
                            
                              <li><a class="tag" href="https://www.zerodayinitiative.com/blog?tag=Linux">Linux</a></li>
                            
                              <li><a class="tag" href="https://www.zerodayinitiative.com/blog?tag=Research">Research</a>
                          
                        </li></ul>
                      
                   
                    
                </div>
                <div class="contentBlockImage">
                    <div class="blog-actions">
                        <a href="https://www.zerodayinitiative.com/blog" class="btn mediumButton back-btn">BACK TO THE BLOG</a>
                        <ul class="social-share">
                            <a class="icon-heart" title="Like this">
  <span class="sqs-simple-like" data-item-id="" data-like-count="">
    <span class="like-icon"></span>
    <span class="like-count"></span>
  </span>
</a>
                            <a class="icon-share" title="Share"><span class="squarespace-social-buttons inline-style" data-system-data-id="" data-asset-url="" data-record-type="" data-full-url="" data-title=""><div id="social-yui_3_17_2_1_1638470304756_135" class="yui3-widget yui3-socialbutton"><div id="yui_3_17_2_1_1638470304756_140" class="yui3-socialbutton-content"><div class="ss-social-button-wrapper"><div class="ss-social-button"><span class="ss-social-button-icon"></span>Share</div></div><div class="ss-social-list-wrapper"><div class="ss-social-button-list"></div></div></div></div></span></a>

                            <!-- <li><a href="#" class="twitter-share"><img src="/assets/twitterIcon.svg" alt="Twitter" /></a></li>
                            <li><a href="#" class="facebook-share"><img src="/assets/facebookIcon.svg" alt="Facebook" /></a></li>
                            <li><a href="#" class="linkedin-share"><img src="/assets/linkedinIcon.svg" alt="Linkedin" /></a></li> -->
                        </ul>
                    </div>  
                </div>
            </div><!-- /. contentBlock -->
        </div>

        <div class="section blog-listing-details">
            <div class="threeCols">

                <!-- get recent blog post -->
                  

                      <div class="column">
                        <div class="content">
                          <div class="thumb">
                              
                                
                                    <a href="https://www.zerodayinitiative.com/blog/2021/11/17/mindshare-using-io-ninja-to-analyze-npfs" style="background: url(&#39;https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1637178187892-UJSEMAP2T6RTXUHWUOQM/MindshaRE.jpg&#39;) no-repeat;"></a>
                                

                              
                          </div>
                        </div>
                        <h3 class="title" data-content-field="title">
                          
                            <a href="https://www.zerodayinitiative.com/blog/2021/11/17/mindshare-using-io-ninja-to-analyze-npfs">MindShaRE: Using IO Ninja to Analyze NPFS </a>
                          
                        </h3>
                         
                          <div class="listing-tags">
                            
                              <!--TAGS-->
                              
                                <a class="tag" href="https://www.zerodayinitiative.com/?tag=MindshaRE">MindshaRE</a>,
                              
                                <a class="tag" href="https://www.zerodayinitiative.com/?tag=IO+Ninja">IO Ninja</a>
                            
                          </div>
                        
                      </div>

                  

                      <div class="column">
                        <div class="content">
                          <div class="thumb">
                              
                                
                                    <a href="https://www.zerodayinitiative.com/blog/2021/11/9/the-november-2021-security-update-review" style="background: url(&#39;https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1636477385395-H64L80OUYGZUIXPDTB21/TitleCard.png&#39;) no-repeat;"></a>
                                

                              
                          </div>
                        </div>
                        <h3 class="title" data-content-field="title">
                          
                            <a href="https://www.zerodayinitiative.com/blog/2021/11/9/the-november-2021-security-update-review">The November 2021 Security Update Review</a>
                          
                        </h3>
                         
                          <div class="listing-tags">
                            
                              <!--TAGS-->
                              
                                <a class="tag" href="https://www.zerodayinitiative.com/?tag=Adobe">Adobe</a>,
                              
                                <a class="tag" href="https://www.zerodayinitiative.com/?tag=Microsoft">Microsoft</a>,
                              
                                <a class="tag" href="https://www.zerodayinitiative.com/?tag=Security+Patch">Security Patch</a>
                            
                          </div>
                        
                      </div>

                  

                      <div class="column">
                        <div class="content">
                          <div class="thumb">
                              
                                
                                    <a href="https://www.zerodayinitiative.com/blog/2021/11/1/pwn2ownaustin" style="background: url(&#39;https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1635624582038-MC1P37R1DIBYBG6TQ1WA/P2OAustin-02.jpg&#39;) no-repeat;"></a>
                                

                              
                          </div>
                        </div>
                        <h3 class="title" data-content-field="title">
                          
                            <a href="https://www.zerodayinitiative.com/blog/2021/11/1/pwn2ownaustin">Pwn2Own Austin 2021 - Schedule and Live Results</a>
                          
                        </h3>
                         
                          <div class="listing-tags">
                            
                              <!--TAGS-->
                              
                                <a class="tag" href="https://www.zerodayinitiative.com/?tag=Pwn2Own">Pwn2Own</a>,
                              
                                <a class="tag" href="https://www.zerodayinitiative.com/?tag=Western+Digital">Western Digital</a>,
                              
                                <a class="tag" href="https://www.zerodayinitiative.com/?tag=Synology">Synology</a>,
                              
                                <a class="tag" href="https://www.zerodayinitiative.com/?tag=Cisco">Cisco</a>,
                              
                                <a class="tag" href="https://www.zerodayinitiative.com/?tag=TPLink">TPLink</a>,
                              
                                <a class="tag" href="https://www.zerodayinitiative.com/?tag=NETGEAR">NETGEAR</a>,
                              
                                <a class="tag" href="https://www.zerodayinitiative.com/?tag=Samsung">Samsung</a>
                            
                          </div>
                        
                      </div>

                  

            </div>
        </div>
    </div><!-- /. blog-listing -->
</div>
          </div>
        </section>

        
        
        

        

        <!--FOOTER WITH OPEN BLOCK FIELD-->
        <footer id="footer">
          <div id="footerContact">
    <div class="content">
        <div class="footerContactBox">
            <h3>General Inquiries</h3>
            <a href="mailto:zdi@trendmicro.com">zdi@trendmicro.com</a>
        </div>
        <div class="footerContactBox">
            <h3>Find us on Twitter</h3>
            <a href="https://twitter.com/thezdi" target="_blank">@thezdi</a>
        </div>
        <div class="footerContactBox">
            <h3>Media Inquiries</h3>
            <a href="mailto:media_relations@trendmicro.com">media_relations@trendmicro.com</a>
        </div>
        <div class="footerContactBox">
            <h3>Sensitive Email Communications</h3>
            <a href="https://www.zerodayinitiative.com/documents/zdi-pgp-key.asc" target="_blank">PGP Key</a>
        </div>
    </div>
</div>

<div id="footerMenu">
    <div id="footerMiddleSection" class="group">
        <div id="footerLinks">
            <div class="content">
                <div class="footerLinkBox">
                            <a href="https://www.zerodayinitiative.com/about" class="footerTitleLink">WHO WE ARE</a>
                            <ul>
                                <li><a href="https://www.zerodayinitiative.com/about">Our Mission</a></li>
                                <li><a href="https://www.trendmicro.com/">Trend Micro</a></li>
                                <li><a href="https://www.trendmicro.com/en_us/business/products/network/integrated-atp/next-gen-intrusion-prevention-system.html">TippingPoint IPS</a></li>
                            </ul>
                        </div>
                        <div class="footerLinkBox">
                            <a href="https://www.zerodayinitiative.com/about/benefits" class="footerTitleLink">HOW IT WORKS</a>
                            <ul>
                                <li><a href="https://www.zerodayinitiative.com/about/benefits#process">Process</a></li>
                                <li><a href="https://www.zerodayinitiative.com/about/benefits#researcher-rewards">Researcher Rewards</a></li>
                                <li><a href="https://www.zerodayinitiative.com/about/faq">FAQS</a></li>
                                <li><a href="https://www.trendmicro.com/privacy">Privacy</a></li>
                            </ul>
                        </div>
                        <div class="footerLinkBox">
                            <a href="https://www.zerodayinitiative.com/advisories" class="footerTitleLink">ADVISORIES</a>
                            <ul>
                                <li><a href="https://www.zerodayinitiative.com/advisories/published">Published Advisories</a></li>
                                <li><a href="https://www.zerodayinitiative.com/advisories/upcoming">Upcoming Advisories</a></li>
                                <li><a href="https://www.zerodayinitiative.com/rss">RSS Feeds</a></li>
                            </ul>
                        </div>
                        <div class="footerLinkBox">
                            <a href="https://www.zerodayinitiative.com/blog" class="footerTitleLink">BLOG</a>
                        </div>

                        <div class="footerLogo">
                            <a href="https://www.zerodayinitiative.com/"><img src="./2021 - CVE-2021-20226 A Reference-Counting Bug in the Linux Kernel io_uring Subsystem_files/logo-footer.svg" alt="thezdi"></a>
                        </div>
            </div>
        </div>
    </div>
</div>
        </footer>

        

    <!--INJECTION POINT FOR TRACKING SCRIPTS AND USER CONTENT FROM THE CODE INJECTION TAB-->

    <script type="text/javascript" data-sqs-type="imageloader-bootstrapper">(function() {if(window.ImageLoader) { window.ImageLoader.bootstrap({}, document); }})();</script><script>Squarespace.afterBodyLoad(Y);</script><svg xmlns="http://www.w3.org/2000/svg" version="1.1" style="display:none" data-usage="social-icons-svg"><symbol id="twitter-icon" viewBox="0 0 64 64"><path d="M48,22.1c-1.2,0.5-2.4,0.9-3.8,1c1.4-0.8,2.4-2.1,2.9-3.6c-1.3,0.8-2.7,1.3-4.2,1.6 C41.7,19.8,40,19,38.2,19c-3.6,0-6.6,2.9-6.6,6.6c0,0.5,0.1,1,0.2,1.5c-5.5-0.3-10.3-2.9-13.5-6.9c-0.6,1-0.9,2.1-0.9,3.3 c0,2.3,1.2,4.3,2.9,5.5c-1.1,0-2.1-0.3-3-0.8c0,0,0,0.1,0,0.1c0,3.2,2.3,5.8,5.3,6.4c-0.6,0.1-1.1,0.2-1.7,0.2c-0.4,0-0.8,0-1.2-0.1 c0.8,2.6,3.3,4.5,6.1,4.6c-2.2,1.8-5.1,2.8-8.2,2.8c-0.5,0-1.1,0-1.6-0.1c2.9,1.9,6.4,2.9,10.1,2.9c12.1,0,18.7-10,18.7-18.7 c0-0.3,0-0.6,0-0.8C46,24.5,47.1,23.4,48,22.1z"></path></symbol><symbol id="twitter-mask" viewBox="0 0 64 64"><path d="M0,0v64h64V0H0z M44.7,25.5c0,0.3,0,0.6,0,0.8C44.7,35,38.1,45,26.1,45c-3.7,0-7.2-1.1-10.1-2.9 c0.5,0.1,1,0.1,1.6,0.1c3.1,0,5.9-1,8.2-2.8c-2.9-0.1-5.3-2-6.1-4.6c0.4,0.1,0.8,0.1,1.2,0.1c0.6,0,1.2-0.1,1.7-0.2 c-3-0.6-5.3-3.3-5.3-6.4c0,0,0-0.1,0-0.1c0.9,0.5,1.9,0.8,3,0.8c-1.8-1.2-2.9-3.2-2.9-5.5c0-1.2,0.3-2.3,0.9-3.3 c3.2,4,8.1,6.6,13.5,6.9c-0.1-0.5-0.2-1-0.2-1.5c0-3.6,2.9-6.6,6.6-6.6c1.9,0,3.6,0.8,4.8,2.1c1.5-0.3,2.9-0.8,4.2-1.6 c-0.5,1.5-1.5,2.8-2.9,3.6c1.3-0.2,2.6-0.5,3.8-1C47.1,23.4,46,24.5,44.7,25.5z"></path></symbol><symbol id="youtube-icon" viewBox="0 0 64 64"><path d="M46.7,26c0,0-0.3-2.1-1.2-3c-1.1-1.2-2.4-1.2-3-1.3C38.3,21.4,32,21.4,32,21.4h0 c0,0-6.3,0-10.5,0.3c-0.6,0.1-1.9,0.1-3,1.3c-0.9,0.9-1.2,3-1.2,3S17,28.4,17,30.9v2.3c0,2.4,0.3,4.9,0.3,4.9s0.3,2.1,1.2,3 c1.1,1.2,2.6,1.2,3.3,1.3c2.4,0.2,10.2,0.3,10.2,0.3s6.3,0,10.5-0.3c0.6-0.1,1.9-0.1,3-1.3c0.9-0.9,1.2-3,1.2-3s0.3-2.4,0.3-4.9 v-2.3C47,28.4,46.7,26,46.7,26z M28.9,35.9l0-8.4l8.1,4.2L28.9,35.9z"></path></symbol><symbol id="youtube-mask" viewBox="0 0 64 64"><path d="M0,0v64h64V0H0z M47,33.1c0,2.4-0.3,4.9-0.3,4.9s-0.3,2.1-1.2,3c-1.1,1.2-2.4,1.2-3,1.3 C38.3,42.5,32,42.6,32,42.6s-7.8-0.1-10.2-0.3c-0.7-0.1-2.2-0.1-3.3-1.3c-0.9-0.9-1.2-3-1.2-3S17,35.6,17,33.1v-2.3 c0-2.4,0.3-4.9,0.3-4.9s0.3-2.1,1.2-3c1.1-1.2,2.4-1.2,3-1.3c4.2-0.3,10.5-0.3,10.5-0.3h0c0,0,6.3,0,10.5,0.3c0.6,0.1,1.9,0.1,3,1.3 c0.9,0.9,1.2,3,1.2,3s0.3,2.4,0.3,4.9V33.1z M28.9,35.9l8.1-4.2l-8.1-4.2L28.9,35.9z"></path></symbol></svg>
    </div> <!-- end #innerWrapper -->
    </div> <!-- end #outerWrapper -->
    <script src="./2021 - CVE-2021-20226 A Reference-Counting Bug in the Linux Kernel io_uring Subsystem_files/main.js.下載">
  </body>

</html>
</script></body></html>