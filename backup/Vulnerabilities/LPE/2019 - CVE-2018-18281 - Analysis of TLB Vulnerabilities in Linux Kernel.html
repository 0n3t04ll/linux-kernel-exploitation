<!DOCTYPE html>
<!-- saved from url=(0028)https://xz.aliyun.com/t/4005 -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <title>CVE-2018-18281—linux内核中关于TLB漏洞的分析 - 先知社区</title>
    <meta name="description" content="先知社区，先知安全技术社区">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <link rel="icon" href="https://xz.aliyun.com/static/icon/favicon.ico" type="image/x-icon">
    <link href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/editormd.min.css">
    <link rel="stylesheet" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/tango.css">
    <link href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/bootstrap-responsive.min.css" rel="stylesheet">
    <!-- Le styles -->
    <link rel="stylesheet" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/OverlayStyle.css">
    <link rel="stylesheet" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/topic.css">
    <link rel="stylesheet" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/beautify.css">
    
    <link rel="stylesheet" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/editormd.css">
    <link rel="stylesheet" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/tango.css">
    <link rel="stylesheet" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/jquery.fancybox.min.css">

    <script src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/antidomxss_v640.js.下載"></script><script src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/interfaceacting210923.js.下載"></script><!--[if lte IE 8]>
        <script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
    <![endif]-->
    
    

    <!--[if !IE]> -->
    <script type="text/javascript" src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/jquery-2.1.3.min.js.下載"></script>
    
    
    <script src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/jquery.fancybox.min.js.下載"></script>

    <!-- <![endif]-->
<style type="text/css">#waf_nc_block {position: fixed;_position: absolute;width: 100%;height: 100%;top: 0;bottom: 0;left: 0;z-index: 99999;}.waf-nc-mask {background: #f8f8f8;opacity: 0.5;filter:alpha(opacity=50); width: 100%;height: 100%;} .waf-nc-wrapper {width:480px; height:254px; position: absolute; top: 50%; left: 50%; margin-top: -127px; margin-left: -240px; margin-bottom: 16px; background:#ffffff; border:3px solid #00A2CA;} .waf-nc-icon {position: absolute;top: 60px;left: 20px;} .waf-nc-title {margin-top: 23px; margin-left: 47px; font-size:16px; color:#333333; line-height:10px; text-align:left;} .waf-nc-splitter {margin-left: 26px; margin-top: 5px; width:430px; height:0px; border:1px solid #f4f4f4; } .waf-nc-description { margin-top: 70px; margin-left: 170px; font-size:12px; color:#333333; text-align: left; } #nocaptcha { margin-top: 40px; margin-left: 150px; width:300px; height36px;}</style><script src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/nc.js.下載"></script><style>@charset "utf-8";
@font-face{font-family:'nc_iconfont';src:url("//at.alicdn.com/t/font_1465353706_4784257.eot");src:url("//at.alicdn.com/t/font_1465353706_4784257.eot?#iefix") format('embedded-opentype'),url("//at.alicdn.com/t/font_1465353706_4784257.woff") format('woff'),url("//at.alicdn.com/t/font_1465353706_4784257.ttf") format('truetype'),url("//at.alicdn.com/t/font_1465353706_4784257.svg#iconfont") format('svg')}@font-face{font-family:'ncpc_iconfont';src:url("//at.alicdn.com/t/font_384029_rhzpmteb25oecdi.eot");src:url("//at.alicdn.com/t/font_384029_rhzpmteb25oecdi.eot?#iefix") format('embedded-opentype'),url("//at.alicdn.com/t/font_384029_rhzpmteb25oecdi.woff") format('woff'),url("//at.alicdn.com/t/font_384029_rhzpmteb25oecdi.ttf") format('truetype'),url("//at.alicdn.com/t/font_384029_rhzpmteb25oecdi.svg#ncpc_iconfont") format('svg')}.nc-container div#nc-loading-circle{background:transparent;width:20px;height:20px;display:inline-block;position:relative;vertical-align:middle}.nc-container div#nc-loading-circle .sk-circle{background:transparent;width:100%;height:100%;position:absolute;left:0;top:0}.nc-container #nc-loading-circle .sk-circle:before{content:'';display:block;margin:0 auto;width:15%;height:15%;background-color:#818181;border-radius:100%;-webkit-animation:sk-circleFadeDelay 1.2s infinite ease-in-out both;animation:sk-circleFadeDelay 1.2s infinite ease-in-out both}.nc-container #nc-loading-circle .sk-circle2{-webkit-transform:rotate(30deg);-ms-transform:rotate(30deg);transform:rotate(30deg)}.nc-container #nc-loading-circle .sk-circle3{-webkit-transform:rotate(60deg);-ms-transform:rotate(60deg);transform:rotate(60deg)}.nc-container #nc-loading-circle .sk-circle4{-webkit-transform:rotate(90deg);-ms-transform:rotate(90deg);transform:rotate(90deg)}.nc-container #nc-loading-circle .sk-circle5{-webkit-transform:rotate(120deg);-ms-transform:rotate(120deg);transform:rotate(120deg)}.nc-container #nc-loading-circle .sk-circle6{-webkit-transform:rotate(150deg);-ms-transform:rotate(150deg);transform:rotate(150deg)}.nc-container #nc-loading-circle .sk-circle7{-webkit-transform:rotate(180deg);-ms-transform:rotate(180deg);transform:rotate(180deg)}.nc-container #nc-loading-circle .sk-circle8{-webkit-transform:rotate(210deg);-ms-transform:rotate(210deg);transform:rotate(210deg)}.nc-container #nc-loading-circle .sk-circle9{-webkit-transform:rotate(240deg);-ms-transform:rotate(240deg);transform:rotate(240deg)}.nc-container #nc-loading-circle .sk-circle10{-webkit-transform:rotate(270deg);-ms-transform:rotate(270deg);transform:rotate(270deg)}.nc-container #nc-loading-circle .sk-circle11{-webkit-transform:rotate(300deg);-ms-transform:rotate(300deg);transform:rotate(300deg)}.nc-container #nc-loading-circle .sk-circle12{-webkit-transform:rotate(330deg);-ms-transform:rotate(330deg);transform:rotate(330deg)}.nc-container #nc-loading-circle .sk-circle2:before{-webkit-animation-delay:-1.1s;animation-delay:-1.1s}.nc-container #nc-loading-circle .sk-circle3:before{-webkit-animation-delay:-1s;animation-delay:-1s}.nc-container #nc-loading-circle .sk-circle4:before{-webkit-animation-delay:-.9s;animation-delay:-.9s}.nc-container #nc-loading-circle .sk-circle5:before{-webkit-animation-delay:-.8s;animation-delay:-.8s}.nc-container #nc-loading-circle .sk-circle6:before{-webkit-animation-delay:-.7s;animation-delay:-.7s}.nc-container #nc-loading-circle .sk-circle7:before{-webkit-animation-delay:-.6s;animation-delay:-.6s}.nc-container #nc-loading-circle .sk-circle8:before{-webkit-animation-delay:-.5s;animation-delay:-.5s}.nc-container #nc-loading-circle .sk-circle9:before{-webkit-animation-delay:-.4s;animation-delay:-.4s}.nc-container #nc-loading-circle .sk-circle10:before{-webkit-animation-delay:-.3s;animation-delay:-.3s}.nc-container #nc-loading-circle .sk-circle11:before{-webkit-animation-delay:-.2s;animation-delay:-.2s}.nc-container #nc-loading-circle .sk-circle12:before{-webkit-animation-delay:-.1s;animation-delay:-.1s}@-webkit-keyframes sk-circleFadeDelay{0%,39%,100%{opacity:0}40%{opacity:1}}@-webkit-keyframes sk-circleFadeDelay{0%,39%,100%{opacity:0}40%{opacity:1}}@keyframes sk-circleFadeDelay{0%,39%,100%{opacity:0}40%{opacity:1}}.nc-container .scale_text2 #nc-loading-circle .sk-circle:before{background-color:#fff}.nc_iconfont{font-family:"nc_iconfont";color:#ff3f08;font-size:16px;font-style:normal}.ncpc_iconfont{font-family:"ncpc_iconfont";color:#ff3f08;font-size:16px;font-style:normal}.captcha-error .icon_ban{float:left;font-size:16px;padding-right:5px;line-height:14px}.clickCaptcha_text .btn_refresh{font-style:normal;cursor:pointer;background:#fff;color:#737383}.imgCaptcha .btn_refresh{font-size:20px;cursor:pointer;background:#fff;color:#737383}.nc_voice{display:none;position:relative;margin-top:-34px;z-index:99;width:auto;height:34px;background:#fff}.omeo-code-img,.omeo-code-audio{font-size:0;text-align:left}.omeo-code-audiobox,.omeo-code-img a,.omeo-code-audio a,.omeo-code-state{display:inline-block;*display:inline;zoom:1;height:32px;vertical-align:top;font-size:12px}.omeo-code .omeo-code-refresh{background:transparent;width:32px;height:32px;font-size:20px;color:#888;text-align:center;text-decoration:none;padding-left:4px;line-height:32px}.omeo-code .omeo-switch{display:none;width:32px;height:32px;border-left:1px solid #e1e1e1;background-image:url("//g.alicdn.com/sd/ncpc/images/checkcode.png");background-repeat:no-repeat}.omeo-img-active .omeo-code-img{display:block}.omeo-img-active .omeo-code-audio{display:none}.omeo-code-img img{border:1px solid #cdcdcd;cursor:pointer}.omeo-code-img .omeo-switch{background-position:9px -41px}.omeo-audio-active .omeo-code-audio{display:block}.omeo-audio-active .omeo-code-img{display:none}.omeo-code-refresh{position:relative;left:95px}.omeo-code-audiobox{position:relative;height:30px;line-height:32px;border:1px solid #e1e1e1;text-align:center;overflow:hidden;left:100px;top:1px;width:45%;min-width:80px;background-color:#eee}.omeo-code-audiobox a{display:block;text-decoration:none;color:#06c}.omeo-code-audiobox-playing a{visibility:hidden}.omeo-code-audiobox span,.omeo-code-audiobox b{visibility:hidden;position:absolute;top:0;left:0;height:30px;font-weight:100;overflow:hidden}.omeo-code-audiobox-playing span,.omeo-code-audiobox-playing b{visibility:visible}.omeo-code-audiobox span{z-index:0;width:0;background:#186bca}.omeo-code-audiobox b{width:100%;z-index:1;text-align:left;text-indent:30px;color:#999;background:url("//g.alicdn.com/sd/ncpc/images/checkcode.png") no-repeat 14px -89px}.omeo-code-audio .omeo-switch{background-position:5px 10px}input[type=text]::-ms-clear{display:none}.omeo-box{position:relative;background-color:#fff}.omeo-code-echo{position:absolute;top:2px;left:2px}.omeo-code-echo input{padding:5px;height:18px;line-height:18px;border:1px solid #ddd;width:80px;outline:0}.omeo-code-state{height:30px;line-height:30px;text-indent:25px;white-space:nowrap;background-image:url("//g.alicdn.com/sd/ncpc/images/checkcode.png");background-repeat:no-repeat;background-position:100px 100px}.omeo-code-echo .omeo-code-state-error{width:auto;background-position:7px -193px}.omeo-code-echo .omeo-code-state-success{position:absolute;width:30px;background-position:7px -243px}.omeo-code-state{position:absolute;left:0;top:28px}.nc_voice_close{display:inline-block;position:relative;cursor:pointer;left:95px;top:0;border-left:#ddd 2px solid;padding:0 0 0 7px;background-color:#fff;font-size:20px;color:#888;line-height:32px}.nc_help{position:absolute;width:100%;height:100%;left:0;top:0;z-index:99999}.nc_help .mask{background-color:#000;opacity:.5;filter:alpha(opacity=50);width:100%;height:100%;top:0;left:0}.nc_btn_close{position:absolute;height:20px;left:500px;border-radius:20px;padding:10px 30px;background-color:#aaa;color:#fff;cursor:pointer;z-index:10}.nc_btn_close:hover{background-color:#afafaf}.nc_hand{position:absolute;width:68px;height:53px;background-image:url("//g.alicdn.com/sd/ncpc/images/hand.png");z-index:3}.nc_slide_bg{z-index:3;font-size:12px;text-align:center;color:#fff;line-height:34px}.nc_voicebtn{position:absolute;padding:0;right:-25px;font-size:23px;color:#888;cursor:pointer;line-height:34px}.nc_helpbtn{position:absolute;cursor:pointer;right:-95px;top:4px;font-size:12px;background-color:#ffb668;color:#fff;padding:4px;border-radius:2px;line-height:18px;display:none}.nc_helpbtn:before{width:0;height:0;content:"";position:absolute;left:-2px;top:6px;border-top:4px solid transparent;border-bottom:4px solid transparent;border-right:4px solid #ffb668}.nc-container .errloading{border:#faf1d5 1px solid;text-indent:3px;background-image:none;font-size:12px;width:290px;line-height:20px;padding:7px 5px 8px 5px;color:#ef9f06;}.nc-container .errloading a{color:#30a7fc}.nc_captcha_text .nc_err{float:left;text-indent:0}.button_move{transition:left .5s;-moz-transition:left .5s;-webkit-transition:left .5s;-o-transition:left .5s}.bg_move{transition:width .5s;-moz-transition:width .5s;-webkit-transition:width .5s;-o-transition:width .5s}.nc_slide_box{position:absolute}.nc_captcha_text{height:auto;line-height:20px;visibility:hidden;font-size:12px;color:#999;font-weight:normal}.nc-container .nc_captcha_img_text{width:auto;height:auto;line-height:20px;visibility:hidden;font-size:12px;color:#999;font-weight:normal;display:none;padding:0 0 10px 0;background-position:0 0;}.nc-container .nc_captcha_img_text span.nc-lang-cnt{line-height:inherit}.nc-container .imgCaptcha .nc_captcha_img_text{width:auto}.nc_captcha_img_text{height:auto;line-height:20px;visibility:hidden;font-size:12px;color:#999;font-weight:normal;display:none;padding:0 0 10px 3px;background-position:0 0}.nc-container .nc_wrapper{width:auto}.nc_scale{width:auto;height:34px;background:#e8e8e8;position:relative;margin:0;padding:0}.nc_scale.is_audio{margin-right:25px}.nc-container .nc_scale div{height:auto}.nc-container .nc_scale ul{list-style:none}.nc-container .nc_scale .btn_slide{color:#737383;background-image:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.nc-container .nc_scale span{text-align:center;width:40px;height:32px;line-height:32px;border:1px solid #ccc;position:absolute;left:0;cursor:move;background:#fff;z-index:2}.nc-container .nc_scale span.nc-lang-cnt{*line-height:34px;float:none;width:auto;height:auto;*height:34px;border:none;position:static;cursor:inherit;background:none;z-index:0;display:inline}.nc_slide_button{width:40px;height:32px;border:1px solid #ccc;position:absolute;left:0;cursor:move;background:#fff url("//g.alicdn.com/sd/ncpc/images/rt.png") no-repeat center;z-index:2}@media screen and (-ms-high-contrast:active),(-ms-high-contrast:none){.nc_scale span{height:32px}}.nc-container .nc_scale .btnok{cursor:default;background:#fff url("//g.alicdn.com/sd/ncpc/images/yes.png") no-repeat center;z-index:3}.nc-container .nc_scale .btnok2{cursor:default;font-size:20px;background:#fff url("//g.alicdn.com/sd/ncpc/images/no.png") no-repeat center;z-index:3}.nc-container .nc_scale .btn_warn{cursor:default;color:#ff3f08;line-height:34px;text-align:center;font-size:20px;background:#fff;z-index:3}.nc-container .clickCaptcha_text .btn_refresh{font-size:20px}.nc-container .clickCaptcha_text .icon_close{line-height:30px;margin-left:8px;cursor:default;color:#ff3f08;font-size:16px;float:left;margin-right:2px;background:transparent;z-index:3}.nc-container .nc_captcha_img_text .icon_close{cursor:default;color:#ff3f08;font-size:16px;float:left;margin-right:4px;background:transparent;z-index:3;line-height:18px}.nc-container .errloading .icon_warn{cursor:default;color:#ff3f08;font-size:18px;float:left;background:transparent;z-index:3}.nc-container .nc_scale .btn_ok{cursor:default;line-height:34px;text-align:center;font-size:20px;background:#fff;z-index:3;color:#76c61d}.nc-container .nc_scale .nc_ok,.nc-container .nc_scale .nc_bg{background:#7ac23c}.nc-container .nc_scale .nc_bg{position:absolute;height:100%;_height:34px;left:0;width:10px}.nc-container .nc_scale div.redbar{background:#fc461e;opacity:.5;filter:alpha(opacity=50)}.nc-container .nc_scale div.orange{background:#f00}.nc-container .nc_scale .scale_text{width:100%;height:100%;text-align:center;position:absolute;z-index:1;background:transparent;color:#9c9c9c;line-height:34px;font-size:12px;cursor:pointer}.nc-container .nc_scale .scale_text2{text-align:left;color:#fff;font-size:12px;text-indent:10px}.nc-container .nc_scale .scale_text2 b{padding-left:0;font-weight:normal}.nc-container .nc_scale .scale_text.scale_loading_text{text-align:center}.nc-container .nc_scale .imgCaptcha,.nc-container .nc_scale .clickCaptcha{display:none;overflow:hidden;border:1px solid #ccc;background:#fff;z-index:20000;}.nc-container .nc_scale .imgCaptcha p.error span,.nc-container .nc_scale .clickCaptcha p.error span{line-height:normal}.nc-container .nc_scale .imgCaptcha{height:auto}.nc-container .nc_scale .clickCaptcha{position:absolute;left:0;top:35px;height:270px;background:#fff;display:none;}.nc-container .nc_scale .clickCaptcha p.error i{color:#ff3f08;font-style:normal}.nc-container .nc_scale .clickCaptcha div{position:static;clear:both;width:100%;background:#fff;height:auto}.nc-container .nc_scale .clickCaptcha .clickCaptcha_text{height:30px;line-height:30px;font-size:12px;color:#999;}.nc-container .nc_scale .clickCaptcha .clickCaptcha_text b{font-weight:normal}.nc_btn_2{position:absolute;right:0;top:0;cursor:pointer;margin:2px 9px 0 0}.nc_iconfont.nc_btn_2{position:absolute;right:0;top:0;cursor:pointer}.nc_iconfont.nc_btn_1{position:absolute;top:10px;right:5px}.nc_btn_1{top:10px;right:10px}.scale_text i{font-style:normal;border:none;position:static;cursor:default;color:#fffc00;background:none;display:inline;width:100%}.nc-container .clickCaptcha .clickCaptcha_img{margin:0 auto;clear:both;position:relative;}.nc-container .clickCaptcha .clickCaptcha_img img{width:230px;height:230px;margin-left:10px;margin-top:5px}.nc-container .clickCaptcha .clickCaptcha_btn{margin:10px 0 0 15px;position:relative;text-align:left;}.nc-container .clickCaptcha .clickCaptcha_btn img{cursor:pointer}.nc-container .imgCaptcha{position:absolute;left:0;top:35px;height:auto;padding-bottom:15px;border:1px solid #ccc;background:#fff;}.nc-container .imgCaptcha div{position:static;width:90%;background-color:#fff}.nc-container .imgCaptcha,.nc-container .clickCaptcha{text-align:left;}.nc-container .imgCaptcha a,.nc-container .clickCaptcha a{color:#ff3f08}.nc-container .imgCaptcha .imgCaptcha_text{height:42px;line-height:42px;width:120px;background:#fff;font-size:14px;text-align:left;color:#747474;float:left;margin-left:10px;}.nc-container .imgCaptcha .imgCaptcha_text input{margin-top:5px;height:30px;line-height:30px;font-size:14px;width:90px;background:#fff}.nc-container .imgCaptcha .imgCaptcha_text input:focus{outline:none;color:#bbb}.nc-container .imgCaptcha .imgCaptcha_btn{margin:0 0 0 12px;*margin-left:0;clear:both;padding-top:5px;width:90%;}.nc-container .imgCaptcha .imgCaptcha_btn img{cursor:pointer}.nc-container .imgCaptcha .nc_scale_submit{margin:0 auto;cursor:pointer;background-color:#fc461e;width:120px;height:32px;line-height:32px;color:#fff;text-align:center}.nc-container .imgCaptcha .imgCaptcha_img{margin:4px 0 0 100px;height:40px;width:130px;overflow:hidden;cursor:pointer;}.nc-container .imgCaptcha .imgCaptcha_img img{width:130px}.nc-container .imgCaptcha .imgCaptcha_img input{border:solid 1px #ccc}.nc-lang-ar_MA,.nc-lang-ar_SA,.nc-lang-iw_HE,.nc-lang-iw_IL{text-align:right;*text-align:left;}.nc-lang-ar_MA .nc_scale .scale_text2,.nc-lang-ar_SA .nc_scale .scale_text2,.nc-lang-iw_HE .nc_scale .scale_text2,.nc-lang-iw_IL .nc_scale .scale_text2{text-align:right;}.nc-lang-ar_MA .nc_scale .scale_text2 span,.nc-lang-ar_SA .nc_scale .scale_text2 span,.nc-lang-iw_HE .nc_scale .scale_text2 span,.nc-lang-iw_IL .nc_scale .scale_text2 span{*display:inline-block;padding:0 56px 0 0}.nc-lang-ar_MA .nc_captcha_img_text,.nc-lang-ar_SA .nc_captcha_img_text,.nc-lang-iw_HE .nc_captcha_img_text,.nc-lang-iw_IL .nc_captcha_img_text{*text-align:right}.nc-lang-ar_MA span.nc-lang-cnt,.nc-lang-ar_SA span.nc-lang-cnt,.nc-lang-iw_HE span.nc-lang-cnt,.nc-lang-iw_IL span.nc-lang-cnt{text-align:right;direction:rtl}.nocaptcha span.nc-lang-cnt{float:none;height:auto;line-height:30px}.nc-container{font-size:12px;-ms-touch-action:none;touch-action:none;}.nc-container p{margin:0;padding:0;display:inline}.nc-container .scale_text.scale_text span[data-nc-lang="_startTEXT"]{display:inline-block;width:100%}.nc-container .scale_text.scale_text.slidetounlock span[data-nc-lang="_startTEXT"]{background:-webkit-gradient(linear,left top,right top,color-stop(0,#4d4d4d),color-stop(.4,#4d4d4d),color-stop(.5,#fff),color-stop(.6,#4d4d4d),color-stop(1,#4d4d4d));-webkit-background-clip:text;-webkit-text-fill-color:transparent;-webkit-animation:slidetounlock 3s infinite;-webkit-text-size-adjust:none}.nc-container .nc_scale .nc-align-center.scale_text2{text-align:center;text-indent:-42px}@-webkit-keyframes slidetounlock{0%{background-position:-200px 0}100%{background-position:200px 0}}.nc-container.tb-login .clickCaptcha_text .icon_close{line-height:30px;margin-left:0;cursor:default;color:#ff3f08;font-size:16px;float:left;margin-right:0;background:transparent;z-index:3}.nc-container.tb-login{position:relative;margin-top:20px;display:none;}.nc-container.tb-login .nc_scale{width:auto;}.nc-container.tb-login .nc_scale .scale_text2{text-indent:-42px;text-align:center;}.nc-container.tb-login .nc_scale .scale_text2 b{padding:0}.nc-container.tb-login .nc_scale.nc_err div.scale_text{background:#f79977}.nc-container.tb-login .errloading{width:auto}.nc-container.tb-login .imgCaptcha,.nc-container.tb-login .clickCaptcha{width:252px;*width:256px;border:0;*height:300px;min-height:300px;max-height:inherit !important;}.nc-container.tb-login .imgCaptcha div.login-msg.error,.nc-container.tb-login .clickCaptcha div.login-msg.error{background:#fff2f2}.nc-container.tb-login .imgCaptcha .captcha-error,.nc-container.tb-login .clickCaptcha .captcha-error{position:absolute;top:0;width:244px;height:auto;margin-bottom:15px;padding:3px;border:solid 1px #ff8e8e;line-height:18px}.nc-container.tb-login .imgCaptcha .captcha-inform,.nc-container.tb-login .clickCaptcha .captcha-inform{font-size:110%;margin-left:20px}.nc-container.tb-login .imgCaptcha{padding-top:66px;}.nc-container.tb-login .imgCaptcha .imgCaptcha_text{width:100px;margin-left:0;}.nc-container.tb-login .imgCaptcha .imgCaptcha_text input:focus{color:#000}.nc-container.tb-login .imgCaptcha .imgCaptcha_img{width:120px;_width:100px}.nc-container.tb-login .imgCaptcha .imgCaptcha_btn{width:100%;margin-left:0}.nc-container.tb-login .imgCaptcha .nc_scale_submit{width:100%;height:36px;line-height:36px;margin-top:20px;margin-left:0;border-radius:3px;font-size:16px;font-family:Tahoma,Helvetica,Arial,sans-serif;background:#ff3f08}.nc-container.tb-login .clickCaptcha{padding-top:40px;}.nc-container.tb-login .clickCaptcha .clickCaptcha_text{text-indent:4px}.nc-container.tb-login .clickCaptcha .clickCaptcha_img img{margin-left:10px}.nc-container.tb-login .nc_btn_1{top:77px;_top:57px}.nc-container.tb-login .nc_btn_2{top:36px}.login .nc-container.tb-login .login-msg p,.login-box .nc-container.tb-login .login-msg p{width:auto;float:left}.nc-container.tb-login.nc-old-login{margin:20px 0 10px 0;width:250px;}.nc-container.tb-login.nc-old-login .nc_wrapper{width:250px}.nc-container.tb-login.nc-old-login .imgCaptcha,.nc-container.tb-login.nc-old-login .clickCaptcha{width:250px;min-height:auto;}.nc-container.tb-login.nc-old-login .imgCaptcha .captcha-error,.nc-container.tb-login.nc-old-login .clickCaptcha .captcha-error{line-height:16px}.nc-container.tb-login.nc-old-login .clickCaptcha{padding-top:28px;}.nc-container.tb-login.nc-old-login .clickCaptcha .clickCaptcha_img img{width:200px;height:200px}.nc-container.nc-old-login.show-click-captcha{padding-bottom:60px}.nc-container.nc-old-login.show-click-captcha.nc-tm-min-fix{padding-bottom:40px}.nc-container.tb-login.nc-tm-min-fix .clickCaptcha{max-height:340px !important}#content .login-box .bd .nc-container.tb-login .login-msg{margin:10px auto 15px auto}#content .login-box .bd .nc-container.tb-login.nc-old-login.show-click-captcha .login-msg{margin:2px 0 0 0}.nc-container .nc_scale .nc-cc{display:none;position:absolute;left:0;top:35px;z-index:20000;width:360px;height:570px;border:1px solid #5eaef1;border-radius:4px;background:#fff;font-size:14px;line-height:18px;color:#333;}.nc-container .nc_scale .nc-cc.nc-cc-status-loading .nc-cc-btn,.nc-container .nc_scale .nc-cc.nc-cc-status-verifing .nc-cc-btn{background-color:#90c1eb}.nc-container .nc_scale .nc-cc.nc-cc-status-loading .nc-cc-btn,.nc-container .nc_scale .nc-cc.nc-cc-status-verifing .nc-cc-btn,.nc-container .nc_scale .nc-cc.nc-cc-status-loading .nc-cc-refresh,.nc-container .nc_scale .nc-cc.nc-cc-status-verifing .nc-cc-refresh{cursor:default}.nc-container .nc_scale .nc-cc.nc-cc-status-loading .nc-cc-refresh,.nc-container .nc_scale .nc-cc.nc-cc-status-verifing .nc-cc-refresh{color:#999}.nc-container .nc_scale .nc-cc a{color:#3199f4;text-decoration:none}.nc-container .nc_scale .nc-cc .nc_iconfont{vertical-align:top;margin-right:8px}.nc-container .nc_scale .nc-cc-btn{display:inline-block;*display:inline;*zoom:1;vertical-align:top;letter-spacing:normal;word-spacing:normal;width:100px;line-height:30px;text-align:center;background-color:#3199f4;color:#fff;border-radius:4px;cursor:pointer;}.nc-container .nc_scale .nc-cc-btn.nc-cc-disabled{background-color:#90c1eb;cursor:default}.nc-container .nc_scale .nc-cc-btn .nc-lang-cnt{line-height:18px}.nc-container .nc_scale .nc-cc-header{padding:20px 20px 19px 20px;height:100px;background:#f4f8fa;border-bottom:1px solid #ccc}.nc-container .nc_scale .nc-cc-img1-box{float:left;width:100px;height:100px;margin-right:16px}.nc-container .nc_scale .nc-cc-txt{overflow:hidden;*zoom:1;line-height:30px;padding-top:11px}.nc-container .nc_scale .nc-cc-img2-box{position:relative;padding:0 20px;margin-top:20px}.nc-container .nc_scale .nc-cc-items{position:absolute;left:20px;_left:0;top:0;width:320px;overflow:hidden}.nc-container .nc_scale .nc-cc-items-inner{margin-right:-20px}.nc-container .nc_scale .nc-cc-item{position:relative;display:inline-block;*display:inline;*zoom:1;vertical-align:top;letter-spacing:normal;word-spacing:normal;margin-right:10px;margin-bottom:10px;border:1px solid #ccc;width:98px;height:98px;background:url("//gtms02.alicdn.com/tps/i2/T1ty2QFNNXXXc6Yc2r-1-1.gif");}.nc-container .nc_scale .nc-cc-item:hover{border-color:#3199f4}.nc-container .nc_scale .nc-cc-item .nc_iconfont{display:none;position:absolute;right:0;bottom:0;color:#3199f4;font-size:22px;margin-right:0}.nc-container .nc_scale .nc-cc-item.nc-cc-selected .nc_iconfont{display:block}.nc-container .nc_scale .nc-cc-tip{display:none;position:absolute;left:0;bottom:60px;width:360px;line-height:18px;text-align:center;color:#eb4f38;}.nc-container .nc_scale .nc-cc-tip span{line-height:normal}.nc-container .nc_scale .nc-cc-footer{position:absolute;left:0;bottom:20px;width:360px;height:30px;line-height:30px;text-align:center;}.nc-container .nc_scale .nc-cc-footer .nc_iconfont{color:#c4cbd0}.nc-container .nc_scale .nc-cc-refresh,.nc-container .nc_scale .nc-cc-wait{position:absolute;left:20px;top:0;color:#3199f4;cursor:pointer}.nc-container .nc_scale .nc-cc-wait{display:none}.nc-container .nc_scale .nc-cc-cancel{position:absolute;right:20px;top:0;color:#3199f4;cursor:pointer;}.nc-container .nc_scale .nc-cc-cancel .nc_iconfont{position:relative;top:-1px}.nc-container .nc_scale .nc-cc-loading{margin-top:247px;text-align:center;line-height:14px}.nc-container .nc_scale .nc-cc-loading-img{display:inline-block;*display:inline;*zoom:1;vertical-align:top;letter-spacing:normal;word-spacing:normal;vertical-align:middle;background:url("//img.alicdn.com/tps/TB1OdxsKpXXXXcgXFXXXXXXXXXX-14-14.gif") no-repeat;width:14px;height:14px;position:relative;top:-1px;margin-right:9px}.nc-container .nc_scale .nc-cc-fail{position:absolute;left:50%;top:50%;width:320px;height:180px;margin-left:-160px;margin-top:-90px;background:#fff;border-radius:4px}.nc-container .nc_scale .nc-cc-fail-inner{text-align:center;padding:55px 10px 10px}.nc-container .nc_scale .nc-cc-fail-action{margin:28px 0 18px;}.nc-container .nc_scale .nc-cc-fail-action a{display:inline-block;*display:inline;*zoom:1;vertical-align:top;letter-spacing:normal;word-spacing:normal;line-height:30px;margin-left:16px}.nc-container .nc_scale .nc-cc-contact{text-align:right;color:#666;padding-right:9px}.nc-container .nc_scale .nc-cc-mask{display:none;position:absolute;left:0;top:0;width:360px;height:570px;background:rgba(0,0,0,0.3);filter:progid:DXImageTransform.Microsoft.gradient(enabled='true',startColorstr='#4C000000', endColorstr='#4C000000');}:root .nc-container .nc_scale .nc-cc-mask{-webkit-filter:none;filter:none}.nc-container .nc_scale .nc-cc-arrow-1,.nc-container .nc_scale .nc-cc-arrow-2{display:none;position:absolute;top:340px;border:solid transparent;height:0;width:0}.nc-container .nc_scale .nc-cc-arrow-1{border-width:16px;margin-top:-1px}.nc-container .nc_scale .nc-cc-arrow-2{border-width:15px}.nc-container .nc_scale .nc-cc-right .nc-cc-arrow-1,.nc-container .nc_scale .nc-cc-left .nc-cc-arrow-1,.nc-container .nc_scale .nc-cc-right .nc-cc-arrow-2,.nc-container .nc_scale .nc-cc-left .nc-cc-arrow-2{display:block;_display:none}.nc-container .nc_scale .nc-cc-right{left:180px;top:-339px;}.nc-container .nc_scale .nc-cc-right .nc-cc-arrow-1{border-right-color:#5eaef1;left:-32px}.nc-container .nc_scale .nc-cc-right .nc-cc-arrow-2{border-right-color:#fff;left:-30px}.nc-container .nc_scale .nc-cc-left{left:-335px;top:-339px;}.nc-container .nc_scale .nc-cc-left .nc-cc-arrow-1{border-left-color:#5eaef1;right:-32px}.nc-container .nc_scale .nc-cc-left .nc-cc-arrow-2{border-left-color:#fff;right:-30px}</style></head>
<body>
<!-- navbar begin -->
<div class="navbar navbar-default">
    <div class="navbar-inner">
        <div class="container" style="text-align: center; position:relative;">
            <!--[if lte IE 8]>
            <span style="display:inline-block;margin:0 auto;color:red;">为了更好的体验，请使用IE10及以上版本</span>
            <![endif]-->
            <div class="brand-box">
                <a class="brand" href="https://xz.aliyun.com/"></a>
            </div>
            
                <a href="https://account.aliyun.com/login/login.htm?oauth_callback=https%3A%2F%2Fxz.aliyun.com%2Ft%2F4005&amp;from_type=xianzhi" class="pull-right anonymous-user hh_loding">
                    登录</a>
            
            <div class="nav-collapse collapse">
                <div class="search d1 text-right">
                    <form method="get" action="https://xz.aliyun.com/search">
                        <input type="text" placeholder="搜索" name="keyword">
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- navbar end -->
<!-- main content begin -->
<div id="Wrapper" class="container">
    
    
    <div class="row2">
        <div class="span10">
            
    



    <script src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/jquery.toc.min.js.下載"></script>
    <script src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/toc.min.js.下載"></script>
    <script src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/dt.js.下載"></script>
    


<div class="row box content">
    
    <div class="box-container">
        <div class="main-topic">
            <div class="clearfix user-info topic-list">
                <p><span class="content-title ">CVE-2018-18281—linux内核中关于TLB漏洞的分析</span>
                </p>
                <div class="topic-info">
                <span class="info-left">
                    <a href="https://xz.aliyun.com/u/4572">
                        <span class="username cell"> houjingyi</span></a> <span class="i-seprator"> / </span>
                    <span> 2019-02-04 11:00:00</span><span class="i-seprator"> / </span>
                    <span>浏览数 5720</span>
                    
                    
                    <span class="content-node">
                    
                        <span class="label label-default label-node-first">
                            <a href="https://xz.aliyun.com/tab/1">安全技术</a></span>
                        <span class="label label-default">
                            <a href="https://xz.aliyun.com/node/23">二进制安全</a></span>
                    
                    </span>
                </span>
                    <span class="pull-right t-vote cell info-right"><a class="vote vote-up" href="javascript:" onclick="voteUp(4005);">
             顶(0)</a>
             <a class="vote vote-down" href="javascript:" onclick="voteDown(4005);">
             踩(0)</a></span>
                </div>
            </div>
            <hr>
            <div id="topic_content" class="topic-content markdown-body">
                <h2 id="toc-0">前言</h2>
<p>2019年1月17日，Project Zero的Jann Horn发表了一篇文章[4]，描述了他发现的一个linux内核中关于TLB(Translation Lookaside Buffer)的漏洞。本文为对这个漏洞的详细分析。作者水平有限，如有不当还请指正。</p>
<h2 id="toc-1">基础知识</h2>
<h3 id="toc-2">锁定和抢占</h3>
<p>linux内核支持三种不同的抢占模型，必须在build时选择其中一种。</p>
<ul>
<li>CONFIG_PREEMPT_NONE(无强迫抢占(服务器))</li>
<li>CONFIG_PREEMPT_VOLUNTARY(自愿内核抢占(桌面))</li>
<li>CONFIG_PREEMPT(内核可抢占(低延迟桌面))</li>
</ul>
<p>抢占模型确定当内核希望中断当前正在运行内核代码的进程时的操作：例如，较高优先级的进程已变为可运行且正在等待调度。Pixel 2使用配置了CONFIG_PREEMPT的内核。这意味着默认情况下，内核代码可以在执行期间的任何时候中断，甚至包括进程持有互斥锁、信号量和它位于RCU读端临界区时(取决于内核配置)。只有像自旋锁这样的东西才能抑制抢占。对于攻击者来说，如果利用的漏洞需要时间差的话内核是可抢占的是非常有用的。攻击者可能会让调度程序在竞争窗口中将进程从CPU核心中移除，然后让进程远离CPU一段时间。<br>
sched_setaffinity函数设置进程在哪个或者哪几个CPU核心上运行，通常它的用法如下。<br>
<a id="img0" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129154320-8cb0a08e-2399-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129154320-8cb0a08e-2399-1.png"></a><br>
sched_setscheduler函数为指定的pid设置调度策略policy和参数param。如果pid为0，则设置调用线程的调度策略和参数。param是一个指向sched_param结构体的指针。<br>
<a id="img1" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129154407-a89d2df8-2399-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129154407-a89d2df8-2399-1.png"></a><br>
<a id="img2" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129154432-b79e453a-2399-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129154432-b79e453a-2399-1.png"></a><br>
目前这个结构体仅仅包含sched_priority这一个成员。对于param的解释取决于policy。linux中的policy分为普通调度策略(normal scheduling policies)和实时调度策略(real time scheduling policies)。</p>
<ul>
<li>SCHED_NORMAL和SCHED_BATCH调度普通的非实时进程</li>
<li>SCHED_FIFO和SCHED_RR和SCHED_DEADLINE则采用不同的调度策略调度实时进程</li>
<li>SCHED_IDLE则在系统空闲时调用idle进程</li>
</ul>
<p>如果设置具有不同优先级的多个进程运行在一个CPU核心上，那么唤醒优先级较高的进程将会抢占优先级较低的进程。</p>
<h3 id="toc-3">页分配器</h3>
<p>linux页分配器基于buddy分配器，在mm/page_alloc.c中实现。空闲列表(freelist)不仅仅是按order区分的，在android上还与区域(zone)和迁移类型(migration type)有关。</p>
<h4>区域</h4>
<p>区域指定页面可以使用的方式。Pixel 2上存在以下区域。</p>
<ul>
<li>ZONE_DMA：当有设备不能通过DMA(Direct Memory Access)访问整个可寻址内存(ZONE_NORMAL)的情况下为这些设备专门开辟出一段内存，通常是低端内存区域(arm64在4.16之前使用)</li>
<li>ZONE_NORMAL：该部分的内存由内核直接映射到线性地址空间的较高部分</li>
</ul>
<h4>迁移类型</h4>
<p>页面的迁移类型指定页面当前正在使用哪种分配(如果页面当前正在使用中)或者页面应该优先使用哪种分配(如果页面是空闲的)。它的目的是通过将内核可以回收的页面的内容移动到一起以允许内核稍后通过移动数据来创建更大order的空闲页面。下面是比较重要的几个迁移类型。</p>
<ul>
<li>MIGRATE_UNMOVABLE：用于不可移动的分配(例如正常kmalloc的分配)</li>
<li>MIGRATE_MOVABLE：用于内核可以将其移动到另一个物理页面的分配(例如用户空间内存)</li>
<li>MIGRATE_RECLAIMABLE：用于内核不能简单地移动到不同地址的分配，但内核可以在需要释放一些内存时将其释放</li>
<li>MIGRATE_CMA：为DMA的连续内存预留的专用内存，只能用于特定的DMA分配和可移动页的分配</li>
</ul>
<p>在页分配器中引入了冷热页的概念。冷页表示该空闲页已经不再高速缓存中了，热页表示该空闲页仍然在高速缓存中。冷热页是针对于每CPU的。每个zone中都会针对于所有的CPU初始化一个冷热页的per-cpu-pageset(pcp)。冷热页机制只处理单页分配的情况。<br>
<a id="img3" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129162658-a53416e4-239f-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129162658-a53416e4-239f-1.png"></a><br>
首先通过快速路径分配，如果快速路径无法分配再通过慢速路径分配。在进入慢速路径之前，通过get_page_from_freelist函数分配页面的算法大致如下(忽略NUMA和原子/实时分配之类的东西)。</p>
<ol>
<li><p>对于每个区域(从最优选的区域到最不优选的区域，在Pixel 2上，当分配非DMA内存时，首先是ZONE_NORMAL，然后是ZONE_DMA)，当get_page_from_freelist函数走到try_this_zone时说明选定的区域中有空闲内存。<br>
<a id="img4" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129161146-8531170e-239d-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129161146-8531170e-239d-1.png"></a></p>
</li>
<li><p>在rmqueue函数中有下面这几种情况。<br>
<a id="img5" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129162021-b87522b2-239e-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129162021-b87522b2-239e-1.png"></a></p>
</li>
<li><p>对于order为0也就是单页分配的情况，继续进入rmqueue_pcplist函数。<br>
<a id="img6" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129162823-d7ac7a94-239f-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129162823-d7ac7a94-239f-1.png"></a></p>
</li>
<li><p>在__rmqueue_pcplist函数中调用了rmqueue_bulk函数从buddy分配系统中分配页。<br>
<a id="img7" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129162955-0ea6ebe2-23a0-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129162955-0ea6ebe2-23a0-1.png"></a></p>
</li>
<li><p>在rmqueue_bulk函数中调用了__rmqueue函数。<br>
<a id="img8" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129163151-53632368-23a0-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129163151-53632368-23a0-1.png"></a></p>
</li>
<li><p>__rmqueue函数首先调用__rmqueue_smallest函数从指定迁移类型去分配order阶的页，如果order阶对应的链表没有空闲页块就从更大阶的链表中去分配，然后将得到的页块拆解，剩余部分挂到对应order的链表中去。<br>
<a id="img9" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129164636-63318904-23a2-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129164636-63318904-23a2-1.png"></a></p>
</li>
<li><p>如果我们想要一个可移动的页，则从MIGRATE_CMA中分配。否则，调用__rmqueue_fallback函数分配。<br>
<a id="img10" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129170517-ff306f80-23a4-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129170517-ff306f80-23a4-1.png"></a></p>
</li>
<li><p>__rmqueue_fallback函数尝试从具有不同迁移类型的空闲列表中获取最大order的页，然后可能会将它的迁移类型更改为所需的。<br>
<a id="img11" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129170722-49a8a334-23a5-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129170722-49a8a334-23a5-1.png"></a></p>
</li>
</ol>
<p>下面是几张帮助理解的示意图。<br>
<a id="img12" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129170838-774b9328-23a5-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129170838-774b9328-23a5-1.png"></a><br>
<a id="img13" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129170846-7bcca46e-23a5-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129170846-7bcca46e-23a5-1.png"></a><br>
<a id="img14" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129170854-80697402-23a5-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129170854-80697402-23a5-1.png"></a><br>
<a id="img15" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129170901-84c43618-23a5-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129170901-84c43618-23a5-1.png"></a><br>
当试图利用物理页的UAF漏洞时需要记住页分配器将尽量避免改变页的迁移类型，所以通常可移动页(匿名用户空间内存和页缓存)将被重用为可移动页，不可移动页(正常的内核内存)将被重用为不可移动页。</p>
<h3 id="toc-4">TLB和分页结构缓存</h3>
<p>页表包含有关虚拟地址如何映射到物理地址的信息。页表存储在内存中，因此访问速度相对较慢。为了快速进行地址转换，CPU使用TLB(Translation Lookaside Buffers)缓存这个映射。换句话说，它们几乎缓存最后一级页表条目。现代CPU通常有许多不同用途的TLB：比如Intel CPU有指令TLB，数据TLB和共享L2 TLB。<br>
分页结构缓存的文档比较少，但是还是有官方文件记载它们的存在和处理它们时必须采取的措施。Intel把它们叫做分页结构缓存(Paging-Structure Caches)，arm把它们叫做中间表遍历缓存(Intermediate table walk caches)，AMD的文档中把它们作为L2数据TLB的一部分。分页结构缓存存储非最后一级页表条目的副本，当访问没有对应TLB条目的虚拟地址时将使用它们以减少遍历页表的次数。<br>
处理器可以随时清除和创建TLB和分页结构缓存中的条目。不同的处理器体系结构使它们无效的机制也并不相同。X86架构中提供了使当前逻辑CPU内核的单个TLB条目或整个TLB(无论有没有全局条目)无效的指令。在Intel的手册中提到使虚拟地址的TLB条目无效还至少意味着可以用于转换该虚拟地址的任何分页结构缓存条目无效。要跨逻辑CPU内核使得TLB失效，操作系统必须手动运行使每个逻辑CPU内核上的TLB条目无效的代码，这通常是通过APIC(Advanced Programmable Interrupt Controller)将IPI(Inter-Processor Interrupt)从希望执行TLB失效的处理器发送到可能具有相关过期TLB或分页结构缓存条目的所有其它处理器来实现的。ARM架构提供了可以执行跨核心TLB失效的指令，但是如果还需要同步软件(如linux内核)中实现的页表遍历，可能还是必须发送IPI(取决于用于页表遍历的同步机制)。<br>
用于为页表条目执行缓存失效的通用模式如下。<br>
1.从页表中删除一个条目，但保持对它指向的物理页面的引用。<br>
2.对可能使用与当前线程相同的页表的所有CPU核心执行TLB刷新(针对特定地址或整个地址空间)。<br>
3.删除物理页面上保留的引用(可能会释放它)。<br>
在取消映射普通数据页和删除页表时，这个过程都是相同的。通常可以进行批处理以获得更好的性能：首先删除多个页表条目，然后跨内核执行一次TLB刷新，最后删除所有页面引用。在X86上(ARM64类似)，最后一级PTE(Page Table Entry)中有两个位，CPU可以将其作为地址转换的一部分写入：Accessed位指定CPU是否曾使用页表条目进行地址转换，换句话说，如果未设置Accessed位，则自上次软件写入PTE以来TLB尚未缓存页表条目的值。Dirty位指定CPU是否曾经用页表条目进行写内存访问，换句话说，如果未设置Dirty位，则自上次软件写入PTE以来没有创建可用于写入物理页面的TLB条目。</p>
<h2 id="toc-5">漏洞解析</h2>
<h3 id="toc-6">漏洞原理</h3>
<p>在linux系统中进程的内存管理数据结构受到多个锁的保护：mm_struct结构体中的读/写信号量mmap_sem用来保护VMA(Virtual Memory Area)，页表锁用于保护对页表的访问。例如mmap/mremap/munmap以及用于页面错误处理的函数同时使用mmap_sem和页表锁。但是一些其它类型的页表访问(例如在系统中映射给定文件的所有位置上的操作，如缩小文件并释放超出文件新的末尾的页表的ftruncate函数)不会保留mmap_sem，只用页表锁。<br>
mremap函数允许用户空间移动VMA及其关联的页表条目，它通过mremap_to-&gt;move_vma-&gt;move_page_tables-&gt;move_ptes移动页表。<br>
<a id="img16" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129173722-7a98ec8e-23a9-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129173722-7a98ec8e-23a9-1.png"></a><br>
move_ptes函数用于移动2个L1页表之间的条目(只有mmap_sem)的大致逻辑如下。<br>
1.如果设置了need_rmap_locks标志(新的VMA已合并到相邻的VMA中)，则调用take_rmap_locks函数。<br>
<a id="img17" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129174017-e31fa522-23a9-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129174017-e31fa522-23a9-1.png"></a><br>
<a id="img18" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129174029-ea0d583e-23a9-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129174029-ea0d583e-23a9-1.png"></a><br>
2.获取旧页表和新页表上的页表锁。<br>
<a id="img19" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129174107-00ae0a5c-23aa-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129174107-00ae0a5c-23aa-1.png"></a><br>
3.调用了flush_tlb_batched_pending函数，刷新由于并行回收竞争留下的旧的TLB条目。<br>
<a id="img20" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129174156-1dfc24fe-23aa-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129174156-1dfc24fe-23aa-1.png"></a><br>
4.对于当前页表的范围中的每个非空条目：<br>
4.1.调用ptep_get_and_clear函数，原子性地读取页表条目的当前值并清除它。<br>
<a id="img21" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129174235-3509b134-23aa-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129174235-3509b134-23aa-1.png"></a><br>
4.2.如果读取的页表条目为Dirty，则将force_flush标志设置为true。<br>
<a id="img22" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129174337-59f3f1f8-23aa-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129174337-59f3f1f8-23aa-1.png"></a><br>
4.3.把读取的页表条目写入页表以获取新映射。<br>
<a id="img23" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129174429-79135308-23aa-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129174429-79135308-23aa-1.png"></a><br>
5.解锁新的页表。<br>
6.如果设置了force_flush标志，则对在步骤4中访问的旧页表条目执行TLB刷新；如果未设置force_flush标志，则向调用者move_page_tables函数发出需要TLB刷新的信号。<br>
7.解锁旧的页表。<br>
8.如果设置了need_rmap_locks标志，则调用drop_rmap_locks函数。<br>
<a id="img24" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129174514-940a1732-23aa-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129174514-940a1732-23aa-1.png"></a><br>
稍后，在遍历多个页表之后，move_page_tables函数会在请求时对旧地址范围执行TLB刷新。<br>
move_ptes函数需要确保在释放旧页表的引用时不再有过时的TLB条目。move_ptes函数中没有删除引用，但move_ptes函数将引用移动到新的页表条目中。当持有新页表上的页表锁时，同时运行的其它进程仍然无法删除新的页表条目并删除其引用，因此在步骤4.3之后一切仍然正常：页无法释放。但是在第5步之后，另一个进程理论上可以与mremap函数竞争并删除页。这远远早于move_page_tables函数对旧地址范围执行TLB刷新的时间。</p>
<h3 id="toc-7">漏洞利用</h3>
<p>为了利用该漏洞，我们希望快速地从页面缓存中重新分配释放的可移动页。可以通过pcp的空闲列表来实现这一点，因为将本来就可移动的页重新分配为一个可移动的页比强制更改迁移类型更容易。使用这种策略，我们不能攻击普通内核内存分配或页表，但是可以攻击页缓存和匿名用户空间内存。EXP中是攻击的页缓存，这样可以在攻击的关键时间路径中避免其它用户空间进程的干扰。大致攻击步骤如下。<br>
1.从页缓存中删除目标页。<br>
首先需要挑选作为攻击目标的页。EXP利用/system/lib64/libandroid_runtime.so中包含com_android_internal_os_Zygote_nativeForkAndSpecialize函数的页。每当需要启动应用程序进程时，此函数在zygote进程的上下文中执行，换句话说，它不会经常在空闲设备上运行，这意味着我们可以删除它然后有时间触发漏洞。可以通过启动隔离服务来触发它的执行，因此能够在成功触发漏洞后立即执行它。zygote进程具有CAP_SYS_ADMIN功能(并且允许使用它)，并且因为它的作用是fork出app进程和system_server的进程，所以它可以访问system_server和每个app的上下文。注入到zygote中的shellcode会读取自己的SELinux上下文，然后使用调用sethostname函数得到的字符串覆盖主机名。shellcode在arm_shellcode.s中。<br>
<a id="img25" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129180320-1b1b1986-23ad-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129180320-1b1b1986-23ad-1.png"></a><br>
(系统调用表可以参考retme7大神的[2])<br>
在EXP具体的删除操作是在eviction.c中实现的。在[3]中提到：A fundamental observation we made is that the replacement algorithm of the Linux page cache prioritizes eviction of nonexecutable pages over executable pages.在mm/vmscan.c的shrink_active_list函数和page_check_references函数中可以看到确实对有文件背景的页面有特殊处理，它们在内存中驻留的机会更大。<br>
<a id="img26" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129180438-4992847a-23ad-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129180438-4992847a-23ad-1.png"></a><br>
<a id="img27" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129180445-4db170fc-23ad-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129180445-4db170fc-23ad-1.png"></a><br>
在eviction.c中通过fallocate函数利用可执行的具有文件背景的页面造成内存压力从而从页缓存中删除目标页。<br>
<a id="img28" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129180517-61292044-23ad-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129180517-61292044-23ad-1.png"></a><br>
通过mincore函数检查指定的页是否在页缓存中。<br>
<a id="img29" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129180546-727d8236-23ad-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129180546-727d8236-23ad-1.png"></a><br>
<a id="img30" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129180554-771e7bc4-23ad-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129180554-771e7bc4-23ad-1.png"></a><br>
最好的情况是目标页一旦被删除，在下一次访问之前不会从磁盘重新加载。但情况并非总是如此：内核具有一些提前读取的逻辑，根据观察到的内存访问模式，这些逻辑可能从磁盘上读取页面错误周围的大量数据(最多VM_MAX_READAHEAD，即128KiB)。这是通过在filemap_fault函数中调用do_async_mmap_readahead函数/do_sync_mmap_readahead函数实现的。攻击进程可以在进行自己的访问时不使用它，但是对于来自其它进程的访问(这些进程可能正在执行来自目标文件中其它页面的代码)，也应该禁止这种行为。由于这个原因，EXP通过fallocate函数删除目标页之前通过MADV_RANDOM映射访问目标文件中的所有其它页，以降低访问它们触发提前读取逻辑的概率：当RAM中存在被访问的页时，不会发生同步提前读取；如果访问的页有一个小错误(即页存在于页缓存中但还不存在相应的页表条目)而没有标记为PG_readahead，异步提前读取也不会发生。<br>
2.分配具有文件背景的页(例如通过memfd)，并将它们映射为映射1。<br>
<a id="img31" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129180626-89e68c4c-23ad-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129180626-89e68c4c-23ad-1.png"></a><br>
3.触发mremap/ftruncatrace竞争释放具有文件背景的页，而不删除映射1的对应TLB条目。<br>
给运行mremap函数的进程设置SCHED_IDLE优先级，并且让它与具有正常优先级的由于read函数阻塞在管道上的进程运行在一个CPU核心上，然后在正确的时刻写入该管道的另一端，这样就可以抢占mremap函数了。<br>
<a id="img32" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129180722-ab46d86a-23ad-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129180722-ab46d86a-23ad-1.png"></a><br>
<a id="img33" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129180732-b17ef41a-23ad-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129180732-b17ef41a-23ad-1.png"></a><br>
在<code>/proc/&lt;pid&gt;/status</code>中包含进程使用的内存的情况，其中VmPTE字段显示进程页表占用的内存量。通过监视该字段可以检测由mremap函数执行的页表分配以确定在管道另一端调用write函数的正确时机。<br>
<a id="img34" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129180839-d9807cb8-23ad-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129180839-d9807cb8-23ad-1.png"></a><br>
在main函数中调用write函数写入管道的另一端。<br>
<a id="img35" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129180922-f32547f2-23ad-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129180922-f32547f2-23ad-1.png"></a><br>
4.从目标页开始读取，导致内核重新分配一个已释放的页作为目标页的页缓存。<br>
<a id="img36" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129180948-02545be6-23ae-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129180948-02545be6-23ae-1.png"></a><br>
5.在映射1(通过旧的TLB)中轮询页的内容，直到其中一个包含目标页。如果在此之前发生了页面错误，返回第一步。<br>
<a id="img37" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129181023-1776b0fa-23ae-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129181023-1776b0fa-23ae-1.png"></a><br>
<a id="img38" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129181031-1c3fa2cc-23ae-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129181031-1c3fa2cc-23ae-1.png"></a><br>
下载对应版本的OTA包：<a href="https://dl.google.com/dl/android/aosp/walleye-ota-pq1a.181105.017.a1-075d9b58.zip" target="_blank">https://dl.google.com/dl/android/aosp/walleye-ota-pq1a.181105.017.a1-075d9b58.zip</a><br>
解压，使用payload_dumper提取出payload.bin中的system.img，解压system.img得到/system/lib64/libandroid_runtime.so。<br>
<a id="img39" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129181104-2fa36af6-23ae-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129181104-2fa36af6-23ae-1.png"></a><br>
起始地址是0x36000，所以0x36000+0x157000=0x18D000，刚好是0xeb08005f91007108。<br>
<a id="img40" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129181126-3d0285b0-23ae-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129181126-3d0285b0-23ae-1.png"></a><br>
6.此时，我们有一个旧的TLB将旧的映射1转换为目标页。因此，我们现在可以通过映射1来反复覆盖目标页。<br>
<a id="img41" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129181149-4aa31b80-23ae-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129181149-4aa31b80-23ae-1.png"></a><br>
漏洞利用的效果如下(我因为没有相关设备所以没有自己测试)。<br>
<a id="img42" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129185107-c82f0cf8-23b3-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129185107-c82f0cf8-23b3-1.png"></a><br>
<a id="img43" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129185117-ce2e07bc-23b3-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129185117-ce2e07bc-23b3-1.png"></a><br>
<a id="img44" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129185127-d448952c-23b3-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129185127-d448952c-23b3-1.png"></a></p>
<h3 id="toc-8">补丁情况</h3>
<p>最重要的一处修改就是把对flush_tlb_range函数的调用放到了新的页表解锁之前。<br>
<a id="img45" href="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129181322-81eff5cc-23ae-1.png"><img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20190129181322-81eff5cc-23ae-1.png"></a></p>
<h2 id="toc-9">参考资料</h2>
<p>1.<a href="https://d3s.mff.cuni.cz/legacy/teaching/advanced_operating_systems/slides/10_huge_pages.pdf" target="_blank" title="Memory Management with Huge Pages">Memory Management with Huge Pages</a><br>
2.<a href="https://github.com/retme7/arm64_syscall_nr" target="_blank">https://github.com/retme7/arm64_syscall_nr</a><br>
3.<a href="https://arxiv.org/pdf/1710.00551.pdf" target="_blank" title="Another Flip in the Wall of Rowhammer Defenses">Another Flip in the Wall of Rowhammer Defenses</a><br>
4.<a href="https://googleprojectzero.blogspot.com/2019/01/taking-page-from-kernels-book-tlb-issue.html" target="_blank" title="Taking a page from the kernel&#39;s book: A TLB issue in mremap()">Taking a page from the kernel's book: A TLB issue in mremap()</a></p>

            </div>
            

            <div class="post-user-action" style="margin-top: 34px;">
                <span class="btn btn-default pull-right" id="mark" data-action="topic" data-pk="4005">
                    <span id="mark-text">点击收藏 </span><span class="i-seprator"> | </span><span id="mark-count">0</span>
                </span>
                
                    <span class="btn btn-default pull-right" id="follow_topic" data-pk="4005">
                     <span>关注</span><span class="i-seprator"> | </span><span id="follow-count">1</span>
                    </span>
                
                <div class="clearfix"></div>
            </div>
            
                <div class="related-section">
                    <div class="related-box">
                        
                            <span><a class="pull-left" href="https://xz.aliyun.com/t/4021" title="复杂的 Drupal POP 利用链: 实现和Drupalgeddon 2相同效果"><span class="related-label" style="padding: 3px 4px;margin-right: 3px;">上一篇：</span>复杂的 Drupal POP 利用...</a></span>
                        
                        
                            <span><a class="pull-left" href="https://xz.aliyun.com/t/3997" title="某CMS-5.0.190111后台代码执行（CVE-2019-7580）"><span class="related-label" style="">下一篇：</span>某CMS-5.0.190111后台...</a></span>
                        
                    </div>
                </div>
            
        </div>
    </div>
</div>

    <!-- topic & appendix -->
    



<div class="row box">
    <ol class="breadcrumb">
        <li class="active">0 条回复</li>
    </ol>
    <div class="box-container post-container">
        
            <ul>
                <li style="min-height: 50px;line-height: 60px;margin-left: 15px"><strong>动动手指，沙发就是你的了！</strong></li>
            </ul>
        
    </div>
</div>


    <!-- posts of topic -->
    
        <div class="row box" id="reply-box">
            
            <div class="box-container clearfix">
                
                    <div class="reminder">
                        <a href="https://account.aliyun.com/login/login.htm?oauth_callback=https%3A%2F%2Fxz.aliyun.com%2Ft%2F4005&amp;from_type=xianzhi"><strong>登录</strong></a> 后跟帖
                    </div>
                
            </div>
        </div>
    
    <!-- editor for post -->
    

        </div>
        <div class="span3 pull-right offset sidebar">
            


    <div class="box">
        <div class="info-panel">
            <p><strong>先知社区</strong></p>
            <hr>
            <p class="text-center login-btn">
                <a href="https://account.aliyun.com/login/login.htm?oauth_callback=https%3A%2F%2Fxz.aliyun.com%2Ft%2F4005&amp;from_type=xianzhi" class="btn">现在登录</a>
            </p>
        </div>
    </div>


<div class="box">
    <div class="hot-node notice">
        <div class="info-body" style="padding: 15px;">
            <a href="https://xz.aliyun.com/t/7739" target="_blank">
            <img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/20200508094357-62057bf0-90cd-1.jpg" style="border-radius: 2px;" alt="阿里云情报奖励X计划">
            </a>
        </div>
    </div>
</div>


    <div class="box">
        <div class="hot-node notice">
            <div class="info-body">
                <a href="https://xz.aliyun.com/notice" style="padding: 4px 10px 4px 10px;">社区小黑板</a>
            </div>
        </div>
    </div>


<div class="box">
    <div class="global-charts">
        <div id="chart-header">
            <div class="col-sm-4 text-center charts" data-type="year">
                年度贡献榜
            </div>
            <div class="text-center charts active" data-type="month">
                月度贡献榜
            </div>
            <div class="clearfix"></div>
        </div>
        <div id="chart_body">
            <div class="info-body" data-type="year">

                
                    <div class="member">
                        <div class="pull-left chart-avatar">
                            
                                <img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/12258_890ed8f20bc8ce34d7.png">
                            
                        </div>
                        <div class="chart-name">
                            <a class="nickname" href="https://xz.aliyun.com/u/12258" title="Y4er">Y4er</a>
                            <span class="num-box">
                                <span class="badge badge-important">20</span>
                            </span>
                        </div>

                    </div>
                
                    <div class="member">
                        <div class="pull-left chart-avatar">
                            
                                <img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/31688_7fde7d5cec75cd84ff.png">
                            
                        </div>
                        <div class="chart-name">
                            <a class="nickname" href="https://xz.aliyun.com/u/31688" title="WHOAMIBunny">WHOAMIBunny</a>
                            <span class="num-box">
                                <span class="badge badge-important">19</span>
                            </span>
                        </div>

                    </div>
                
                    <div class="member">
                        <div class="pull-left chart-avatar">
                            
                                <img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/default_avatar.png">
                            
                        </div>
                        <div class="chart-name">
                            <a class="nickname" href="https://xz.aliyun.com/u/3819" title="xq17">xq17</a>
                            <span class="num-box">
                                <span class="badge badge-important">16</span>
                            </span>
                        </div>

                    </div>
                
                    <div class="member">
                        <div class="pull-left chart-avatar">
                            
                                <img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/46958_c5e127fea01d28ebaf.png">
                            
                        </div>
                        <div class="chart-name">
                            <a class="nickname" href="https://xz.aliyun.com/u/46958" title="j1ang">j1ang</a>
                            <span class="num-box">
                                <span class="badge badge-important">15</span>
                            </span>
                        </div>

                    </div>
                
                    <div class="member">
                        <div class="pull-left chart-avatar">
                            
                                <img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/5791_412c2e534e4220d76c.png">
                            
                        </div>
                        <div class="chart-name">
                            <a class="nickname" href="https://xz.aliyun.com/u/5791" title="深信服千里目安全实验室">深信服千里目安全实验室</a>
                            <span class="num-box">
                                <span class="badge badge-important">13</span>
                            </span>
                        </div>

                    </div>
                
            </div>
            <div class="info-body" data-type="month">
                
                     <div class="member">
                        <div class="pull-left chart-avatar">
                            
                                <img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/default_avatar.png">
                            
                        </div>
                        <div class="chart-name">
                            <a class="nickname" href="https://xz.aliyun.com/u/35272" title="changeServer" style="">changeServer</a>
                            <span class="num-box">
                                <span class="badge badge-important">1</span>
                            </span>
                        </div>
                    </div>
                
                     <div class="member">
                        <div class="pull-left chart-avatar">
                            
                                <img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/47531_3e9cdd3901c1aac924.png">
                            
                        </div>
                        <div class="chart-name">
                            <a class="nickname" href="https://xz.aliyun.com/u/47531" title="dawntown" style="">dawntown</a>
                            <span class="num-box">
                                <span class="badge badge-important">1</span>
                            </span>
                        </div>
                    </div>
                
                     <div class="member">
                        <div class="pull-left chart-avatar">
                            
                                <img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/default_avatar.png">
                            
                        </div>
                        <div class="chart-name">
                            <a class="nickname" href="https://xz.aliyun.com/u/38774" title="H3rmesk1t" style="">H3rmesk1t</a>
                            <span class="num-box">
                                <span class="badge badge-important">1</span>
                            </span>
                        </div>
                    </div>
                
                     <div class="member">
                        <div class="pull-left chart-avatar">
                            
                                <img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/default_avatar.png">
                            
                        </div>
                        <div class="chart-name">
                            <a class="nickname" href="https://xz.aliyun.com/u/48395" title="mingyeqf" style="">mingyeqf</a>
                            <span class="num-box">
                                <span class="badge badge-important">1</span>
                            </span>
                        </div>
                    </div>
                
                     <div class="member">
                        <div class="pull-left chart-avatar">
                            
                                <img src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/default_avatar.png">
                            
                        </div>
                        <div class="chart-name">
                            <a class="nickname" href="https://xz.aliyun.com/u/50951" title="是juju呀" style="">是juju呀</a>
                            <span class="num-box">
                                <span class="badge badge-important">1</span>
                            </span>
                        </div>
                    </div>
                
            </div>
        </div>

    </div>
</div>

    <div class="box" id="toc-container" style="width: 270px;">
        <div class="panel-info">
            <div class="panel-heading">
                <h4>目录</h4>
            </div>
            <div id="toc">
                <div class="high-light" style="display: block;background-color: #f3f3f3;position: absolute;"></div>
            <ol><li><a href="https://xz.aliyun.com/t/4005#toc-0">前言</a></li><li><a href="https://xz.aliyun.com/t/4005#toc-1">基础知识</a><ol><li><a href="https://xz.aliyun.com/t/4005#toc-2">锁定和抢占</a></li><li><a href="https://xz.aliyun.com/t/4005#toc-3">页分配器</a></li><li><a href="https://xz.aliyun.com/t/4005#toc-4">TLB和分页结构缓存</a></li></ol></li><li><a href="https://xz.aliyun.com/t/4005#toc-5">漏洞解析</a><ol><li><a href="https://xz.aliyun.com/t/4005#toc-6">漏洞原理</a></li><li><a href="https://xz.aliyun.com/t/4005#toc-7">漏洞利用</a></li><li><a href="https://xz.aliyun.com/t/4005#toc-8">补丁情况</a></li></ol></li><li><a href="https://xz.aliyun.com/t/4005#toc-9">参考资料</a></li></ol></div>
        </div>
    </div>
    <div style="clear: both;"></div>


    <script type="text/javascript">
        $(function () {
            $(".charts").click(switchChart)

            function switchChart() {
                let _this = $(this);
                let idx = _this.attr("data-type")
                let content = $(`#chart_body>.info-body[data-type='${idx}']`)
                if (!_this.hasClass("active")) {
                    _this.addClass("active").siblings().removeClass("active")
                    content.show().siblings().hide()
                }
            }
        })
    </script>


    <style>

    </style>

        </div>
    </div>


</div>
<footer class="bs-docs-footer">
    <div class="container text-center">
        <div class="links">
            <a href="https://xz.aliyun.com/feed" target="_blank">RSS</a>
            <a href="https://xz.aliyun.com/about" target="_blank"><span>关于社区</span></a>
            <a href="https://xz.aliyun.com/partner" target="_blank"><span>友情链接</span></a>
            <a href="https://xz.aliyun.com/notice">社区小黑板</a>
        </div>
    </div>
</footer>

<script src="https://xz.aliyun.com/static/js/bootstrap.min.js"></script>
<script src="https://xz.aliyun.com/static/js/xz.js"></script>


    
    <script type="text/javascript">
        $(document).ready(function () {
            voteUp = function (topicPk) {
                if (topicPk) {
                    $.ajax({
                        url: '/forum/topic/up/',
                        data: {'pk': topicPk},
                        type: 'post',
                        dataType: 'json',
                        success: function (data) {
                            if (data.not_authenticated) {
                                window.location.href = 'https://account.aliyun.com/login/login.htm?oauth_callback=https%3A%2F%2Fxz.aliyun.com%2Ft%2F4005&amp;from_type=xianzhi'
                            } else {
                                if (data.success) {
                                    $('.t-vote > .vote-up').html(data.html);
                                }
                            }
                        }
                    });
                }
            };
            voteDown = function (topicPk) {
                if (topicPk) {
                    $.ajax({
                        url: '/forum/topic/down/',
                        data: {'pk': topicPk},
                        type: 'post',
                        dataType: 'json',
                        success: function (data) {
                            if (data.not_authenticated) {
                                window.location.href = 'https://account.aliyun.com/login/login.htm?oauth_callback=https%3A%2F%2Fxz.aliyun.com%2Ft%2F4005&amp;from_type=xianzhi'
                            } else {
                                if (data.success) {
                                    $('.t-vote > .vote-down').html(data.html);
                                }
                            }

                        }
                    });
                }
            };
            
        });
    </script>


    <script src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/z_stat.php"></script><script src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/core.php" charset="utf-8" type="text/javascript"></script><a href="https://www.cnzz.com/stat/website.php?web_id=1260716569" target="_blank" title="站长统计">站长统计</a>


<div id="waf_nc_block" style="display: none;"><div class="waf-nc-mask"></div><div id="WAF_NC_WRAPPER" class="waf-nc-wrapper"><img class="waf-nc-icon" src="./2019 - CVE-2018-18281 - Analysis of TLB Vulnerabilities in Linux Kernel_files/robot.png" alt="" height="111" width="150"><p class="waf-nc-description">为保证您的正常访问，请进行如下验证：</p><div id="nocaptcha"></div></div></div></body></html>