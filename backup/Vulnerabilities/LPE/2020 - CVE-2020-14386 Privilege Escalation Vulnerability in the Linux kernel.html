<!DOCTYPE html>
<!-- saved from url=(0051)https://unit42.paloaltonetworks.com/cve-2020-14386/ -->
<html lang="en-US" style="opacity: 1;"><head class="at-element-marker"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style type="text/css">@keyframes atNodeInserted7 {from {opacity:0.99} to {opacity:1} }
body{animation-duration:0.001s;animation-name:atNodeInserted7;visibility:hidden}</style>
  
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v5/favicon/icon-Unit42-180x180.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v5/favicon/icon-Unit42-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v5/favicon/icon-Unit42-16x16.png">
	<link rel="manifest" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v5/favicon/site.webmanifest">
	<link rel="mask-icon" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v5/favicon/safari-pinned-tab.svg" color="#000000">
	<meta name="msapplication-TileColor" content="#000000">
	<meta name="theme-color" content="#000">
        <script async="" src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/fbevents.js.下載"></script><script type="text/javascript" async="" src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/xdc.js.下載"></script><script type="text/javascript" async="" src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/munchkin.js.下載"></script><script type="text/javascript" async="" src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/tracking.js.下載"></script><script type="text/javascript" async="" src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/w.js.下載"></script><script async="" src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/qevents.js.下載"></script><script type="text/javascript" async="" src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/insight.min.js.下載"></script><script async="" id="demandbase_js_lib" src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/e78feef73ff94c88.min.js.下載"></script><script type="text/javascript" id="www-widgetapi-script" src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/www-widgetapi.js.下載" async=""></script><script type="text/javascript" async="" src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/analytics.js.下載"></script><script src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/iframe_api"></script><script type="text/javascript" async="" src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/ga.js.下載"></script><script type="text/javascript" async="" src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/recaptcha__zh_tw.js.下載" crossorigin="anonymous" integrity="sha384-hR3VRaqfxKhcqcNEbDZ8Pxj7CCkilFkn9ncTAW+JsyYR9gpOPsTcFdzSznYj1sSs"></script><script type="text/javascript">
var main_site_url = 'https://www.paloaltonetworks.com';
</script>
<style type="text/css">
@font-face{font-family:'Merriweather';font-style:normal;font-weight:300;font-display:swap;src:url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-300.eot');src:local('Merriweather Light'),local('Merriweather-Light'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-300.eot?#iefix') format('embedded-opentype'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-300.woff2') format('woff2'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-300.woff') format('woff'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-300.ttf') format('truetype'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-300.svg#Merriweather') format('svg')}
@font-face{font-family:'Merriweather';font-style:italic;font-weight:300;font-display:swap;src:url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-300italic.eot');src:local('Merriweather Light Italic'),local('Merriweather-LightItalic'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-300italic.eot?#iefix') format('embedded-opentype'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-300italic.woff2') format('woff2'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-300italic.woff') format('woff'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-300italic.ttf') format('truetype'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-300italic.svg#Merriweather') format('svg')}
@font-face{font-family:'Merriweather';font-style:normal;font-weight:400;font-display:swap;src:url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-regular.eot');src:local('Merriweather Regular'),local('Merriweather-Regular'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-regular.eot?#iefix') format('embedded-opentype'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-regular.woff2') format('woff2'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-regular.woff') format('woff'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-regular.ttf') format('truetype'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-regular.svg#Merriweather') format('svg')}
@font-face{font-family:'Merriweather';font-style:italic;font-weight:400;font-display:swap;src:url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-italic.eot');src:local('Merriweather Italic'),local('Merriweather-Italic'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-italic.eot?#iefix') format('embedded-opentype'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-italic.woff2') format('woff2'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-italic.woff') format('woff'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-italic.ttf') format('truetype'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-italic.svg#Merriweather') format('svg')}
@font-face{font-family:'Merriweather';font-style:normal;font-weight:700;font-display:swap;src:url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-700.eot');src:local('Merriweather Bold'),local('Merriweather-Bold'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-700.eot?#iefix') format('embedded-opentype'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-700.woff2') format('woff2'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-700.woff') format('woff'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-700.ttf') format('truetype'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-700.svg#Merriweather') format('svg')}
@font-face{font-family:'Merriweather';font-style:italic;font-weight:700;font-display:swap;src:url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-700italic.eot');src:local('Merriweather Bold Italic'),local('Merriweather-BoldItalic'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-700italic.eot?#iefix') format('embedded-opentype'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-700italic.woff2') format('woff2'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-700italic.woff') format('woff'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-700italic.ttf') format('truetype'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/merriweather/merriweather-v21-latin-700italic.svg#Merriweather') format('svg')}


@font-face{font-family:'Decimal';font-style:normal;font-weight:500;font-display:swap;src:local('Decimal Medium'),local('Decimal-Medium'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/decimal/Decimal-Medium-Pro_Web.woff2') format('woff2'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/decimal/Decimal-Medium-Pro_Web.woff') format('woff'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/decimal/Decimal-Medium-Pro.otf') format('opentype')}
@font-face{font-family:'Decimal';font-style:italic;font-weight:500;font-display:swap;src:local('Decimal Medium'),local('Decimal-Medium'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/decimal/Decimal-MediumItalic-Pro_Web.woff2') format('woff2'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/decimal/Decimal-MediumItalic-Pro_Web.woff') format('woff'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/decimal/Decimal-MediumItalic-Pro.otf') format('opentype')}
@font-face{font-family:'Decimal';font-style:normal;font-weight:600;font-display:swap;src:local('Decimal SemiBold'),local('Decimal-SemiBold'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/decimal/Decimal-Semibold-Pro_Web.woff2') format('woff2'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/decimal/Decimal-Semibold-Pro_Web.woff') format('woff'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/decimal/Decimal-Semibold-Pro.otf') format('opentype')}
@font-face{font-family:'Decimal';font-style:italic;font-weight:600;font-display:swap;src:local('Decimal SemiBold'),local('Decimal-SemiBold'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/decimal/Decimal-SemiboldItalic-Pro_Web.woff2') format('woff2'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/decimal/Decimal-SemiboldItalic-Pro_Web.woff') format('woff'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/decimal/Decimal-SemiboldItalic-Pro.otf') format('opentype')}
@font-face{font-family:'Decimal';font-style:normal;font-weight:700;font-display:swap;src:local('Decimal Bold'),local('Decimal-Bold'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/decimal/Decimal-Bold-Pro_Web.woff2') format('woff2'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/decimal/Decimal-Bold-Pro_Web.woff') format('woff'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/decimal/Decimal-Bold-Pro.otf') format('opentype')}
@font-face{font-family:'Decimal';font-style:italic;font-weight:700;font-display:swap;src:local('Decimal Bold'),local('Decimal-Bold'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/decimal/Decimal-BoldItalic-Pro_Web.woff2') format('woff2'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/decimal/Decimal-BoldItalic-Pro_Web.woff') format('woff'),url('https://www.paloaltonetworks.com/etc/clientlibs/clean/dependencies/fonts/decimal/Decimal-BoldItalic-Pro.otf') format('opentype')}    

.nav {
    display: flex;
    flex-wrap: wrap;
    padding-left: 0;
    margin-bottom: 0;
    list-style: none;
}
dl, ol, ul {
    margin-top: 0;
    margin-bottom: 1rem;
}
.nav-link {
    display: block;
    padding: .5rem 1rem;
}
.productNav2021Component .btn {
    flex-grow: 0;
    flex-shrink: 0;
    display: inline-block;
    font-family: Decimal,Arial,"Helvetica Neue",Helvetica,sans-serif;
    font-weight: 600;
    color: #141414;
    text-align: center;
    vertical-align: middle;
    user-select: none;
    background-color: transparent;
    border: 2px solid transparent;
    border-radius: 50px;
    transition: box-shadow .15s ease-in-out;
}

.productNav2021Component .btn-primary{
    display: inline-flex;
    align-items: center;
    text-decoration: none;
    max-width: 100%;
    text-align: left;
    background-color: #fa582d;
    color: #141414;
    position: relative;
}
.productNav2021Component .btn-primary.focus,.productNav2021Component  .btn-primary:focus{
    color: #141414;
    border-color: #00c0e8;
}
.productNav2021Component .btn-primary:hover, .productNav2021Component .btn-primary-outline:hover,  .productNav2021Component .btn-black:hover, .productNav2021Component .btn-white:hover {
    background-color: #fb7652;
}
.productNav2021Component .btn{
    height:auto;
}
.productNav2021Component .btn:hover {
    color: #141414;
    text-decoration: none;
    border-color: transparent;
}
.productNav2021Component .btn-dark,.productNav2021Component .btn-outline-dark{
    display: inline-flex;
    align-items: center;
    text-decoration: none;
    max-width: 100%;
    text-align: left;
    background: 0;
    color: #fff;
    position: relative;
}
.productNav2021Component .btn-dark i, .productNav2021Component .btn-outline-dark i {
    width: 20px;
    height: 20px;
    margin-left: 15px;
    flex-grow: 0;
    flex-shrink: 0;
    display: inline-block;
    background-size: contain;
    background-position: center;
    background-repeat: no-repeat;
    background-image: url('https://www.paloaltonetworks.com/etc/clientlibs/clean/imgs/arrow-right-white.svg');
}
.productNav2021Component .btn-dark:hover{
    color: #999;
}
.productNav2021Component .btn-dark:not(:disabled):not(.disabled):active,.productNav2021Component .btn-dark:hover{
    background-color: transparent;
    border-color: transparent;
}
.productNav2021Component .btn-dark:not(:disabled):not(.disabled):active:focus{
    box-shadow: none;
}
.productNav2021Component .display-2{
    font-family: Merriweather,Georgia,serif;
    font-weight: 400;
    color: #5f5f5f;
    font-size: 14px;
    line-height: 24px;
} 
.panClean .ar-1-1 img,.panClean .ar-4-3 img,.panClean .ar-3-2 img,.panClean .ar-3-4 img,.panClean .ar-12-17 img,.panClean .ar-16-7 img,.panClean .ar-16-9 img{
    position:absolute;
    width:100%;
    height:100%;
    object-fit:contain;
    font-family:'object-fit: contain;'
}
.panClean .ar-3-2{padding-bottom:66.6666667%}
.panClean .ar-1-1,.panClean .ar-4-3,.panClean .ar-3-2,.panClean .ar-3-4,.panClean .ar-12-17,.panClean .ar-16-7,.panClean .ar-16-9{display:inline-block;width:100%;height:0;overflow:hidden;position:relative;margin:0}
.panClean .ar-16-9{padding-bottom:52.25%}
.panClean .ar-3-4{padding-bottom:133.3333333%}
.productNav2021Component .container,.productNav2021Component .container-fluid,.productNav2021Component .container-sm,.productNav2021Component .container-md,.productNav2021Component .container-lg,.productNav2021Component .container-xl{width:100%;padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto}

/** [Start] custom css, not copied from main site **/
.productNav2021Component a, button, input[type=reset], input[type=submit]{
    transition: none;
}
.panClean .productNav2021Component .prisma-2021-nav-main .btn.btn-primary {
    height: auto;
}
.pan-search-coveo-header .magic-box-clear{
    display: block!important;
}
.no-scroll{overflow:hidden !important}
/** [End] custom css, not copied from main site **/
@media (min-width: 576px){
.productNav2021Component .container-fluid {
    width: auto;
    margin-left: 7.14285714%;
    margin-right: 7.14285714%;
}
}
@media(min-width:768px){.productNav2021Component .btn{padding:13px 24px;font-size:16px;line-height:20px}}
@media(min-width:768px){.productNav2021Component .btn{padding:13px 24px;font-size:16px;line-height:20px}
.productNav2021Component .btn-light,.productNav2021Component .btn-dark{padding-left:0;padding-right:0}
.productNav2021Component .btn-link{padding:5px 0}
.productNav2021Component .btn-lg,.productNav2021Component .btn-group-lg>.btn{padding:20px 40px;font-size:18px}
.productNav2021Component .btn-sm,.productNav2021Component .btn-group-sm>.btn{padding:10px 20px;font-size:14px}
}
@media(max-width:767.98px){.productNav2021Component .btn{padding:10px 20px;font-size:14px;line-height:18px;}}
@media(max-width:767.98px){
    .productNav2021Component .btn-dark{padding-left:0;padding-right:0}
}    
</style>   
<link rel="stylesheet" href="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/criticalTop.min.css" type="text/css" media="all">
<link rel="stylesheet" href="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/defered.min.css" media="all">
<link rel="stylesheet" href="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/defered.min(1).css" media="all">
  <meta name="robots" content="max-image-preview:large">
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/cve-2020-14386/">
<link rel="alternate" hreflang="ja" href="https://unit42.paloaltonetworks.jp/cve-2020-14386/">

	<!-- This site is optimized with the Yoast SEO plugin v15.2.1 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>CVE-2020-14386: Privilege Escalation Vulnerability in the Linux kernel</title>
	<meta name="description" content="CVE-2020-14386 is a memory corruption vulnerability in the Linux kernel that can be used to escalate privileges to the root user on a Linux system.">
	<meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
	<link rel="canonical" href="https://unit42.paloaltonetworks.com/cve-2020-14386/">
	<meta property="og:locale" content="en_US">
	<meta property="og:type" content="article">
	<meta property="og:title" content="CVE-2020-14386: Privilege Escalation Vulnerability in the Linux kernel">
	<meta property="og:description" content="CVE-2020-14386 is a memory corruption vulnerability in the Linux kernel that can be used to escalate privileges to the root user on a Linux system.">
	<meta property="og:url" content="https://unit42.paloaltonetworks.com/cve-2020-14386/">
	<meta property="og:site_name" content="Unit42">
	<meta property="article:published_time" content="2020-10-10T00:00:11+00:00">
	<meta property="article:modified_time" content="2020-10-10T18:52:51+00:00">
	<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/10/Vulnerability-r3d2-1.png">
	<meta property="og:image:width" content="4168">
	<meta property="og:image:height" content="2084">
	<meta name="twitter:card" content="summary_large_image">
	<meta name="twitter:label1" content="Written by">
	<meta name="twitter:data1" content="Erica Naone">
	<meta name="twitter:label2" content="Est. reading time">
	<meta name="twitter:data2" content="9 minutes">
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"https://unit42.paloaltonetworks.com/#website","url":"https://unit42.paloaltonetworks.com/","name":"Unit42","description":"Palo Alto Networks","potentialAction":[{"@type":"SearchAction","target":"https://unit42.paloaltonetworks.com/?s={search_term_string}","query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","@id":"https://unit42.paloaltonetworks.com/cve-2020-14386/#primaryimage","inLanguage":"en-US","url":"https://unit42.paloaltonetworks.com/wp-content/uploads/2020/10/Vulnerability-r3d2-1.png","width":4168,"height":2084,"caption":"The image represents the concept of a vulnerability, such as CVE-2020-14386"},{"@type":"WebPage","@id":"https://unit42.paloaltonetworks.com/cve-2020-14386/#webpage","url":"https://unit42.paloaltonetworks.com/cve-2020-14386/","name":"CVE-2020-14386: Privilege Escalation Vulnerability in the Linux kernel","isPartOf":{"@id":"https://unit42.paloaltonetworks.com/#website"},"primaryImageOfPage":{"@id":"https://unit42.paloaltonetworks.com/cve-2020-14386/#primaryimage"},"datePublished":"2020-10-10T00:00:11+00:00","dateModified":"2020-10-10T18:52:51+00:00","author":{"@id":"https://unit42.paloaltonetworks.com/#/schema/person/487a0dfe3f7c86cdd7998e353de30032"},"description":"CVE-2020-14386 is a memory corruption vulnerability in the Linux kernel that can be used to escalate privileges to the root user on a Linux system.","inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://unit42.paloaltonetworks.com/cve-2020-14386/"]}]},{"@type":"Person","@id":"https://unit42.paloaltonetworks.com/#/schema/person/487a0dfe3f7c86cdd7998e353de30032","name":"Erica Naone","image":{"@type":"ImageObject","@id":"https://unit42.paloaltonetworks.com/#personlogo","inLanguage":"en-US","url":"https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg","caption":"Erica Naone"}}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel="dns-prefetch" href="https://www.google.com/">
<link rel="dns-prefetch" href="https://s.w.org/">
<link rel="alternate" type="application/rss+xml" title="Unit42 » CVE-2020-14386: Privilege Escalation Vulnerability in the Linux kernel Comments Feed" href="https://unit42.paloaltonetworks.com/cve-2020-14386/feed/">
<meta property="og:likes" content="25">
<meta property="og:readtime" content="8">
<meta property="og:views" content="41,792">
<meta property="og:date_created" content="October 9, 2020 at 5:00 PM">
<meta property="og:post_length" content="2293">
<meta property="og:category" content="Unit 42">
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/unit-42/">
<meta property="og:author" content="Or Cohen">
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/">
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg">
<meta property="og:post_image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/10/Vulnerability-r3d2-1.png">
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"CVE-2020-14386: Privilege Escalation Vulnerability in the Linux kernel","name":"CVE-2020-14386: Privilege Escalation Vulnerability in the Linux kernel","description":"CVE-2020-14386 is a memory corruption vulnerability in the Linux kernel that can be used to escalate privileges to the root user on a Linux system.","url":"https:\/\/unit42.paloaltonetworks.com\/cve-2020-14386\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/cve-2020-14386\/","datePublished":"October 9, 2020","articleBody":"Executive Summary\r\nLately, I\u2019ve been investing time into auditing packet sockets source code in the Linux kernel. This led me to the discovery of CVE-2020-14386, a memory corruption vulnerability in the Linux kernel. Such a vulnerability can be used to escalate privileges from an unprivileged user into the root user on a Linux system. In this blog, I will provide a technical walkthrough of the vulnerability, how it can be exploited and how Palo Alto Networks customers are protected.\r\n\r\nA few years ago, several vulnerabilities were discovered in packet sockets (CVE-2017-7308 and CVE-2016-8655), and there are some publications, such as this one in the Project Zero blog and this in Openwall, which give some overview of the main functionality.\r\n\r\nSpecifically, in order for the vulnerability to be triggerable, we need the kernel to have AF_PACKET sockets enabled (CONFIG_PACKET=y) and the CAP_NET_RAW privilege for the triggering process, which can be obtained in an unprivileged user namespace if user namespaces are enabled (CONFIG_USER_NS=y) and accessible to unprivileged users. Surprisingly, this long list of constraints is satisfied by default in some distributions, like Ubuntu.\r\n\r\nPalo Alto Networks Cortex XDR customers can prevent this bug with a combination of the Behavioral Threat Protection (BTP) feature and Local Privilege Escalation Protection module, which monitor malicious behaviors across a sequence of events, and immediately terminate the attack when it is detected.\r\nTechnical Details\r\n(All of the code figures on this section are from the 5.7 kernel sources.)\r\n\r\nDue to the fact that the implementation of AF_PACKET sockets was covered in-depth in the Project Zero blog, I will omit some details that were already described in that article (such as the relation between frames and blocks) and go directly into describing the vulnerability and its root cause.\r\n\r\nThe bug stems from an arithmetic issue that leads to memory corruption. The issue lies in the tpacket_rcv function, located in (net\/packet\/af_packet.c) .\r\n\r\nThe arithmetic bug was introduced on July 19, 2008, in the commit 8913336 (\u201cpacket: add PACKET_RESERVE sockopt\u201d). However, it became triggerable for memory corruption only in February 2016, in the commit 58d19b19cd99 (\"packet: vnet_hdr support for tpacket_rcv\"). There were some attempts to fix it, such as commit bcc536 (\u201cnet\/packet: fix overflow in check for tp_reserve\u201d) in May 2017 and commit edb58be (\u201cpacket: Don't write vnet header beyond end of buffer\u201d) in August 2017. However, those fixes were not enough to prevent memory corruption.\r\n\r\nLet\u2019s first have a look at the PACKET_RESERVE option:In order to trigger the vulnerability, a raw socket (AF_PACKET domain, SOCK_RAW type ) has to be created with a TPACKET_V2 ring buffer and a specific value for the PACKET_RESERVE option.\r\n\r\n[caption id=\"attachment_109090\" align=\"aligncenter\" width=\"900\"] (from https:\/\/man7.org\/linux\/man-pages\/man7\/packet.7.html)[\/caption]\r\n\r\nThe headroom that is mentioned in the manual is simply a buffer with size specified by the user, which will be allocated before the actual data of every packet received on the ring buffer. This value can be set from user-space via the setsockopt system call.\r\n\r\n\r\n\r\ncase PACKET_RESERVE:\r\n{\r\nunsigned int val;\r\nif (optlen != sizeof(val))\r\nreturn -EINVAL;\r\nif (copy_from_user(&amp;val, optval, sizeof(val)))\r\nreturn -EFAULT;\r\nif (val &gt; INT_MAX) \r\nreturn -EINVAL;\r\nlock_sock(sk);\r\n if (po-&gt;rx_ring.pg_vec || po-&gt;tx_ring.pg_vec) { \r\nret = -EBUSY;\r\n} else {\r\npo-&gt;tp_reserve = val;\r\nret = 0;\r\n}\r\nrelease_sock(sk);\r\nreturn ret;\r\n}\r\n\r\n\r\n\r\n\r\nFigure 1. Implementation of setsockopt \u2013 PACKET_RESERVE\r\nAs we can see in Figure 1, initially, there is a check that the value is smaller than INT_MAX. This check was added in this patch to prevent an overflow in the calculation of the minimum frame size in packet_set_ring. Later, it\u2019s verified that pages were not allocated for the receive\/transmit ring buffer. This is done to prevent inconsistency between the tp_reserve field and the ring buffer itself.\r\n\r\nAfter setting the value of tp_reserve, we can trigger allocation of the ring buffer itself via the setsockopt system call with optname of PACKET_RX_RING:\r\n\r\n\r\n\r\nCreate a memory-mapped ring buffer for asynchronous packet reception.\r\n\r\n\r\n\r\nFigure 2. From manual packet \u2013 PACKET_RX_RING option.\r\nThis is implemented in the packet_set_ring function. Initially, before the ring buffer is allocated, there are several arithmetic checks on the tpacket_req structure received from user-space:\r\n\r\n\r\n\r\nmin_frame_size = po-&gt;tp_hdrlen + po-&gt;tp_reserve;\r\n\r\n\u2026\r\n\r\n...\r\n\r\nif (unlikely(req-&gt;tp_frame_size &lt; min_frame_size))\r\ngoto out;\r\n\r\n\r\n\r\n\r\nFigure 3. Part of the sanity checks in the packet_set_ring function.\r\nAs we can see in Figure 3, first, the minimum frame size is calculated, and then it is verified versus the value received from user-space. This check ensures that there is space in each frame for the tpacket header structure (for its corresponding version) and tp_reserve number of bytes.\r\n\r\nLater, after doing all the sanity checks, the ring buffer itself is allocated via a call to alloc_pg_vec:\r\n\r\n\r\n\r\norder = get_order(req-&gt;tp_block_size);\r\n\r\npg_vec = alloc_pg_vec(req, order);\r\n\r\n\r\n\r\nFigure 4. Calling the ring buffer allocation function in the packet_set_ring function. \r\nAs we can see from the figure above, the block size is controlled from user-space. The alloc_pg_vec function allocates the pg_vec array and then allocates each block via the alloc_one_pg_vec_page function:\r\n\r\n\r\n\r\nstatic struct pgv *alloc_pg_vec(struct tpacket_req *req, int order)\r\n{\r\nunsigned int block_nr = req-&gt;tp_block_nr;\r\nstruct pgv *pg_vec;\r\nint i;\r\npg_vec = kcalloc(block_nr, sizeof(struct pgv), GFP_KERNEL | __GFP_NOWARN);\r\nif (unlikely(!pg_vec))\r\ngoto out;\r\nfor (i = 0; i &lt; block_nr; i++) {\r\npg_vec[i].buffer = alloc_one_pg_vec_page(order);\r\n\r\n\r\n\r\n\r\nFigure 5. alloc_pg_vec implementation.\r\nThe alloc_one_pg_vec_page function uses __get_free_pages in order to allocate the block pages:\r\n\r\n\r\n\r\nstatic char *alloc_one_pg_vec_page(unsigned long order)\r\n{\r\nchar *buffer;\r\ngfp_t gfp_flags = GFP_KERNEL | __GFP_COMP |\r\n__GFP_ZERO | __GFP_NOWARN | __GFP_NORETRY;\r\nbuffer = (char *) __get_free_pages(gfp_flags, order);\r\nif (buffer)\r\nreturn buffer;\r\n\r\n\r\n\r\n\r\nFigure 6. alloc_one_pg_vec_page implementation.\r\nAfter the blocks allocation, the pg_vec array is saved in the packet_ring_buffer structure embedded in the packet_sock structure representing the socket.\r\n\r\nWhen a packet is received on the interface, the socket bound to the tpacket_rcv function will be called and the packet data, along with the TPACKET metadata, will be written into the ring buffer. In a real application, such as tcpdump, this buffer is mmap\u2019d to the user-space and packet data can be read from it.\r\nThe Bug\r\nNow let\u2019s dive into the implementation of the tpacket_rcv function (Figure 7). First, skb_network_offset is called in order to extract the offset of the network header in the received packet into maclen. In our case, this size is 14 bytes, which is the size of an ethernet header. After that, netoff (which represents the offset of the network header in the frame) is calculated, taking into account the TPACKET header (fixed per version), the maclen and the tp_reserve value (controlled by the user).\r\n\r\nHowever, this calculation can overflow, as the type of tp_reserve is unsigned int and the type of netoff is unsigned short, and the only constraint (as we saw earlier) on the value of tp_reserve is to be smaller than INT_MAX.\r\n\r\n\r\n\r\nif (sk-&gt;sk_type == SOCK_DGRAM) {\r\n\r\n...\r\n\r\nelse {\r\nunsigned int maclen = skb_network_offset(skb);\r\nnetoff = TPACKET_ALIGN(po-&gt;tp_hdrlen +\r\n(maclen &lt; 16 ? 16 : maclen)) +\r\npo-&gt;tp_reserve;\r\nif (po-&gt;has_vnet_hdr) {\r\nnetoff += sizeof(struct virtio_net_hdr);\r\ndo_vnet = true;\r\n}\r\nmacoff = netoff - maclen;\r\n}\r\n\r\n\r\n\r\nFigure 7. The arithmetic calculation in tpacket_rcv\r\nAlso shown in Figure 7, if the PACKET_VNET_HDR option is set on the socket, sizeof(struct virtio_net_hdr) is added to it in order to account for the virtio_net_hdr structure, which should be right beyond the ethernet header. And finally, the offset of the ethernet header is calculated and saved into macoff.\r\n\r\nLater in that function, seen in Figure 8 below, the virtio_net_hdr structure is written into the ring buffer using the virtio_net_hdr_from_skb function. In Figure 8, h.raw points into the currently free frame in the ring buffer (which was allocated in alloc_pg_vec).\r\n\r\n\r\n\r\nif (do_vnet &amp;&amp;\r\nvirtio_net_hdr_from_skb(skb, h.raw + macoff -\r\nsizeof(struct virtio_net_hdr),\r\nvio_le(), true, 0))\r\ngoto drop_n_account;\r\n\r\n\r\n\r\n\r\nFigure 8. Call to virtio_net_hdr_from_skb function in tpacket_rcv\r\nInitially, I thought it might be possible to use the overflow in order to make netoff a small value, so macoff could receive a larger value (from the underflow) than the size of a block and write beyond the bounds of the buffer.\r\n\r\nHowever, this is prevented by the following check:\r\n\r\n\r\n\r\nif (po-&gt;tp_version &lt;= TPACKET_V2) {\r\nif (macoff + snaplen &gt; po-&gt;rx_ring.frame_size) {\r\n...\r\n...\r\nsnaplen = po-&gt;rx_ring.frame_size - macoff;\r\nif ((int)snaplen &lt; 0) {\r\nsnaplen = 0;\r\ndo_vnet = false;\r\n}\r\n}\r\n\r\n\r\n\r\nFigure 9. Another arithmetic check in the tpacket_rcv function.\r\nThis check is not sufficient to prevent memory corruption, as we can still make macoff a small integer value by overflowing netoff. Specifically, we can make macoff smaller than sizeof(struct virtio_net_hdr), which is 10 bytes, and write behind the bounds of the buffer using virtio_net_hdr_from_skb.\r\nThe Primitive\r\nBy controlling the value of macoff, we can initialize the virtio_net_hdr structure in a controlled offset of up to 10 bytes behind the ring buffer. The virtio_net_hdr_from_skb function starts by zeroing out the entire struct and then initializing some fields within the struct based on the skb structure.\r\n\r\n\r\n\r\nstatic inline int virtio_net_hdr_from_skb(const struct sk_buff *skb,\r\nstruct virtio_net_hdr *hdr,\r\nbool little_endian,\r\nbool has_data_valid,\r\nint vlan_hlen)\r\n{\r\n\r\nmemset(hdr, 0, sizeof(*hdr)); \/* no info leak *\/\r\n\r\nif (skb_is_gso(skb)) {\r\n\r\n...\r\n\r\nif (skb-&gt;ip_summed == CHECKSUM_PARTIAL) {\r\n\r\n\u2026\r\n\r\n\r\n\r\nFigure 10. Implementation of the virtio_net_hdr_from_skb function.\r\nHowever, we can set up the skb so only zeros will be written into the structure. This leaves us with the ability to zero 1-10 bytes behind a __get_free_pages allocation. Without doing any heap manipulation tactics, an immediate kernel crash will occur.\r\nPOC\r\nA POC code for triggering the vulnerability can be found in the following Openwall thread.\r\nPatch\r\nI submitted the following patch in order to fix the bug.\r\n\r\n\r\nFigure 11. My proposed patch for the bug.\r\nThe idea is that if we change the type of netoff from unsigned short to unsigned int, we can check whether it exceeds USHRT_MAX, and if so, drop the packet and prevent further processing.\r\nIdea for Exploitation\r\nOur idea for exploitation is to convert the primitive to a use-after-free. For this, we thought about decrementing a reference count of some object. For example, if an object has a refcount value of 0x10001, the corruption would look as follows:\r\n\r\n\r\nFigure 12. Zeroing out a byte in an object refcount.\r\nAs we can see in Figure 13 below, after corruption, the refcount will have a value of 0x1, so after releasing one reference, the object will be freed.\r\n\r\nHowever, in order to make this happen, the following constraints have to be satisfied:\r\n\r\n \tThe refcount has to be located in the last 1-10 bytes of the object.\r\n \tWe need to be able to allocate the object at the end of a page.\r\n\r\n \tThis is because get_free_pages returns a page-aligned address.\r\n\r\n\r\n\r\nWe used some grep expressions along with some manual analysis of code, and we came out with the following object:\r\n\r\n\r\n\r\nstruct sctp_shared_key {\r\nstruct list_head key_list;\r\nstruct sctp_auth_bytes *key;\r\nrefcount_t refcnt;\r\n__u16 key_id;\r\n__u8 deactivated;\r\n};\r\n\r\n\r\n\r\nFigure 13. Definition of the sctp_shared_key structure.\r\nIt seems like this object satisfies our constraints:\r\n\r\n \tWe can create an sctp server and a client from an unprivileged user context.\r\n\r\n \tSpecifically, the object is allocated in the sctp_auth_shkey_create function.\r\n\r\n\r\n \tWe can allocate the object at the end of a page.\r\n\r\n \tThe size of the object is 32 bytes and it is allocated via kmalloc. This means the object is allocated in the kmalloc-32 cache.\r\n \tWe were able to verify that we can allocate a kmalloc-32 slab cache page behind our get_free_pages allocation. So we will be able to corrupt the last object in that slab cache page.\r\n\r\n \tBecause of the reason 4096 % 32 = 0, there is no spare space in the end of the slab page, and the last object is allocated right behind our allocation. Other slab cache sizes may not be good for us, such as 96 bytes, because 4096 % 96 != 0.\r\n\r\n\r\n\r\n\r\n \tWe can corrupt the highest 2 bytes of the refcnt field.\r\n\r\n \tAfter compilation, the size of key_id and deactivated is 4 bytes each.\r\n \tIf we use the bug to corrupt 9-10 bytes, we will corrupt the 1-2 most significant bytes of the refcnt field.\r\n\r\n\r\n\r\nConclusion\r\nI was surprised that such simple arithmetic security issues still exist in the Linux kernel and haven\u2019t been previously discovered. Also, unprivileged user namespaces expose a huge attack surface for local privilege escalation, so distributions should consider whether they should enable them or not.\r\n\r\nPalo Alto Networks Cortex XDR stops threats on endpoints and coordinates enforcement with network and cloud security to prevent successful cyber attacks. To prevent the exploitation of this bug, the Behavioral Threat Protection (BTP) feature and Local Privilege Escalation Protection module in Cortex XDR would monitor malicious behaviors across a sequence of events and immediately terminate the attack when detected.","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/uploads\/2020\/10\/Vulnerability-r3d2-1.png","width":150,"height":75},"author":[{"@type":"Person","name":"Or Cohen"}]}</script><link rel="stylesheet" id="crayon-css" href="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/crayon.min.css" type="text/css" media="all">
<link rel="stylesheet" id="wp-block-library-css" href="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/style.min.css" type="text/css" media="all">
<link rel="stylesheet" id="dashicons-css" href="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/dashicons.min.css" type="text/css" media="all">
<link rel="stylesheet" id="post-views-counter-frontend-css" href="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/frontend.css" type="text/css" media="all">
<link rel="stylesheet" id="ppress-frontend-css" href="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/frontend.min.css" type="text/css" media="all">
<link rel="stylesheet" id="ppress-flatpickr-css" href="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/flatpickr.min.css" type="text/css" media="all">
<link rel="stylesheet" id="ppress-select2-css" href="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/select2.min.css" type="text/css" media="all">
<link rel="stylesheet" id="wpml-legacy-horizontal-list-0-css" href="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/style.min(1).css" type="text/css" media="all">
<link rel="stylesheet" id="wpml-legacy-post-translations-0-css" href="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/style.min(2).css" type="text/css" media="all">
<link rel="stylesheet" id="wordpress-popular-posts-css-css" href="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/wpp.css" type="text/css" media="all">
<link rel="stylesheet" id="unit42/css-css" href="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/main.css" type="text/css" media="all">
<script type="text/javascript" src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/jquery.min.js.下載" id="jquery-core-js"></script>
<script type="text/javascript" src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/jquery-migrate.min.js.下載" id="jquery-migrate-js"></script>
<script type="text/javascript" id="crayon_js-js-extra">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type="text/javascript" src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/crayon.min.js.下載" id="crayon_js-js"></script>
<script type="text/javascript" src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/flatpickr.min.js.下載" id="ppress-flatpickr-js"></script>
<script type="text/javascript" src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/select2.min.js.下載" id="ppress-select2-js"></script>
<script type="application/json" id="wpp-json">
{"sampling_active":0,"sampling_rate":100,"ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","ID":109087,"token":"35355e15f8","lang":0,"debug":0}
</script>
<script type="text/javascript" src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/wpp.min.js.下載" id="wpp-js-js"></script>
<script type="text/javascript" id="wpml-xdomain-data-js-extra">
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script type="text/javascript" src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/xdomain-data.js.下載" id="wpml-xdomain-data-js"></script>
<link rel="https://api.w.org/" href="https://unit42.paloaltonetworks.com/wp-json/"><link rel="alternate" type="application/json" href="https://unit42.paloaltonetworks.com/wp-json/wp/v2/posts/109087"><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://unit42.paloaltonetworks.com/wp-includes/wlwmanifest.xml"> 
<meta name="generator" content="WordPress 5.8.1">
<link rel="shortlink" href="https://unit42.paloaltonetworks.com/?p=109087">
<link rel="alternate" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fcve-2020-14386%2F">
<link rel="alternate" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fcve-2020-14386%2F&amp;format=xml">
<meta name="generator" content="WPML ver:4.4.10 stt:1,28;">
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40"><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
			padding-top:0px;
			padding-bottom:0px;
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>              <style>
            @-webkit-keyframes bgslide {
                from {
                    background-position-x: 0;
                }
                to {
                    background-position-x: -200%;
                }
            }

            @keyframes bgslide {
                    from {
                        background-position-x: 0;
                    }
                    to {
                        background-position-x: -200%;
                    }
            }

            .wpp-widget-placeholder {
                margin: 0 auto;
                width: 60px;
                height: 3px;
                background: #dd3737;
                background: -webkit-gradient(linear, left top, right top, from(#dd3737), color-stop(10%, #571313), to(#dd3737));
                background: linear-gradient(90deg, #dd3737 0%, #571313 10%, #dd3737 100%);
                background-size: 200% auto;
                border-radius: 3px;
                -webkit-animation: bgslide 1s infinite linear;
                animation: bgslide 1s infinite linear;
            }
        </style>
        
			<style type="text/css">
				#wp-admin-bar-pvc-post-views .pvc-graph-container { padding-top: 6px; padding-bottom: 6px; position: relative; display: block; height: 100%; box-sizing: border-box; }
				#wp-admin-bar-pvc-post-views .pvc-line-graph {
					display: inline-block;
					width: 1px;
					margin-right: 1px;
					background-color: #ccc;
					vertical-align: baseline;
				}
				#wp-admin-bar-pvc-post-views .pvc-line-graph:hover { background-color: #eee; }
				#wp-admin-bar-pvc-post-views .pvc-line-graph-0 { height: 1% }
				#wp-admin-bar-pvc-post-views .pvc-line-graph-1 { height: 5% }
				#wp-admin-bar-pvc-post-views .pvc-line-graph-2 { height: 10% }
				#wp-admin-bar-pvc-post-views .pvc-line-graph-3 { height: 15% }
				#wp-admin-bar-pvc-post-views .pvc-line-graph-4 { height: 20% }
				#wp-admin-bar-pvc-post-views .pvc-line-graph-5 { height: 25% }
				#wp-admin-bar-pvc-post-views .pvc-line-graph-6 { height: 30% }
				#wp-admin-bar-pvc-post-views .pvc-line-graph-7 { height: 35% }
				#wp-admin-bar-pvc-post-views .pvc-line-graph-8 { height: 40% }
				#wp-admin-bar-pvc-post-views .pvc-line-graph-9 { height: 45% }
				#wp-admin-bar-pvc-post-views .pvc-line-graph-10 { height: 50% }
				#wp-admin-bar-pvc-post-views .pvc-line-graph-11 { height: 55% }
				#wp-admin-bar-pvc-post-views .pvc-line-graph-12 { height: 60% }
				#wp-admin-bar-pvc-post-views .pvc-line-graph-13 { height: 65% }
				#wp-admin-bar-pvc-post-views .pvc-line-graph-14 { height: 70% }
				#wp-admin-bar-pvc-post-views .pvc-line-graph-15 { height: 75% }
				#wp-admin-bar-pvc-post-views .pvc-line-graph-16 { height: 80% }
				#wp-admin-bar-pvc-post-views .pvc-line-graph-17 { height: 85% }
				#wp-admin-bar-pvc-post-views .pvc-line-graph-18 { height: 90% }
				#wp-admin-bar-pvc-post-views .pvc-line-graph-19 { height: 95% }
				#wp-admin-bar-pvc-post-views .pvc-line-graph-20 { height: 100% }
			</style>  <script>var $ = jQuery;</script>
  
  
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {visibility:hidden !important}", 3000));
</script>

<script src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/launch-425c423d843b.min.js.下載" async=""></script>
<script type="text/javascript" src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/attribution.js.下載"></script>
  

<script type="text/javascript">
    var isIE11 = !!navigator.userAgent.match(/Trident.*rv\:11\./);
if(isIE11){
    var polyfill = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v5/dist/scripts/polyfill.min.js';
    document.write('<script type="text/javascript" src="'+polyfill+'">\x3C/script>');

}
    /**
 * String.prototype.replaceAll() polyfill
 * https://gomakethings.com/how-to-replace-a-section-of-a-string-with-another-one-with-vanilla-js/
 * @author Chris Ferdinandi
 * @license MIT
 */
if (!String.prototype.replaceAll) {
	String.prototype.replaceAll = function(str, newStr){

		// If a regex pattern
		if (Object.prototype.toString.call(str).toLowerCase() === '[object regexp]') {
			return this.replace(str, newStr);
		}

		// If a string
		return this.replace(new RegExp(str, 'g'), newStr);

	};
}


    /*! lozad.js - v1.16.0 - 2020-09-06 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.lozad=e()}(this,function(){"use strict";
/**
   * Detect IE browser
   * @const {boolean}
   * @private
   */var g="undefined"!=typeof document&&document.documentMode,f={rootMargin:"0px",threshold:0,load:function(t){if("picture"===t.nodeName.toLowerCase()){var e=t.querySelector("img"),r=!1;null===e&&(e=document.createElement("img"),r=!0),g&&t.getAttribute("data-iesrc")&&(e.src=t.getAttribute("data-iesrc")),t.getAttribute("data-alt")&&(e.alt=t.getAttribute("data-alt")),r&&t.append(e)}if("video"===t.nodeName.toLowerCase()&&!t.getAttribute("data-src")&&t.children){for(var a=t.children,o=void 0,i=0;i<=a.length-1;i++)(o=a[i].getAttribute("data-src"))&&(a[i].src=o);t.load()}t.getAttribute("data-poster")&&(t.poster=t.getAttribute("data-poster")),t.getAttribute("data-src")&&(t.src=t.getAttribute("data-src")),t.getAttribute("data-srcset")&&t.setAttribute("srcset",t.getAttribute("data-srcset"));var n=",";if(t.getAttribute("data-background-delimiter")&&(n=t.getAttribute("data-background-delimiter")),t.getAttribute("data-background-image"))t.style.backgroundImage="url('"+t.getAttribute("data-background-image").split(n).join("'),url('")+"')";else if(t.getAttribute("data-background-image-set")){var d=t.getAttribute("data-background-image-set").split(n),u=d[0].substr(0,d[0].indexOf(" "))||d[0];// Substring before ... 1x
u=-1===u.indexOf("url(")?"url("+u+")":u,1===d.length?t.style.backgroundImage=u:t.setAttribute("style",(t.getAttribute("style")||"")+"background-image: "+u+"; background-image: -webkit-image-set("+d+"); background-image: image-set("+d+")")}t.getAttribute("data-toggle-class")&&t.classList.toggle(t.getAttribute("data-toggle-class"))},loaded:function(){}};function A(t){t.setAttribute("data-loaded",!0)}var m=function(t){return"true"===t.getAttribute("data-loaded")},v=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:document;return t instanceof Element?[t]:t instanceof NodeList?t:e.querySelectorAll(t)};return function(){var r,a,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:".lozad",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},e=Object.assign({},f,t),i=e.root,n=e.rootMargin,d=e.threshold,u=e.load,g=e.loaded,s=void 0;"undefined"!=typeof window&&window.IntersectionObserver&&(s=new IntersectionObserver((r=u,a=g,function(t,e){t.forEach(function(t){(0<t.intersectionRatio||t.isIntersecting)&&(e.unobserve(t.target),m(t.target)||(r(t.target),A(t.target),a(t.target)))})}),{root:i,rootMargin:n,threshold:d}));for(var c,l=v(o,i),b=0;b<l.length;b++)(c=l[b]).getAttribute("data-placeholder-background")&&(c.style.background=c.getAttribute("data-placeholder-background"));return{observe:function(){for(var t=v(o,i),e=0;e<t.length;e++)m(t[e])||(s?s.observe(t[e]):(u(t[e]),A(t[e]),g(t[e])))},triggerLoad:function(t){m(t)||(u(t),A(t),g(t))},observer:s}}});

</script>
<script type="text/javascript">
  
var webData =

{ 

   channel : "unit42", //Place the site section the user is in

   property : "unit42.paloaltonetworks.com", //Place domain or sub-domain

   pageType : "blogs",

   language : "en_us",

   pageName : "unit42:CVE-2020-14386: Privilege Escalation Vulnerability in the Linux kernel", //Place the page name the user is viewing - every page needs a unique page name

   pageURL : "https://unit42.paloaltonetworks.com/cve-2020-14386/" //Place the url the user is viewing with no parameters

}
if(sessionStorage.getItem("container") && webData){
	webData.container=sessionStorage.getItem("container");
}

</script>
<script src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/AppMeasurement.min.js.下載" async=""></script><script src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/AppMeasurement_Module_ActivityMap.min.js.下載" async=""></script><script src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/analytics.js.下載" async=""></script><script src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/uwt.js.下載" async=""></script><script src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/js" async=""></script><style id="at-makers-style" class="at-flicker-control">
.mboxDefault {visibility: hidden;}
</style><style>
    .tt_flyout_container{
        z-index: 110000;
        display: flex;
        position: fixed;
        background-color: rgb(244, 244, 244);
        box-shadow: rgb(0 0 0 / 20%) 0px 2px 6px;
        top: 100px;
        right: 0;
        transition: right 0.2s ease-in-out 0s;
        border-top-left-radius: 4px;
        border-bottom-left-radius: 4px;
        width: 320px;
        height: 360px;
    }
    .tt_flyout_container .tt_expand_btn{
        display: flex;
        border: none;
        -webkit-box-align: center;
        align-items: center;
        -webkit-box-pack: center;
        justify-content: center;
        background-color: #fa582d;
        cursor: pointer;
        animation: 0.5s ease 0s 1 normal none running aKSUE;
        padding: 20px 14px;
        border-top-left-radius: 4px;
        border-bottom-left-radius: 4px;
    }
    .tt_flyout_container .tt_expand_txt{
        display: flex;
        font-size: 15px;
        color: rgb(255, 255, 255);
        font-weight: bold;
        font-family: BrownProBold;
        -webkit-writing-mode: vertical-lr;
        writing-mode: vertical-lr;
        transform: rotate(180deg);
        width: 22px;
    }
    .tt_flyout_container .tt_expand_rec_txt{
        font-family: Decimal,Arial,'Helvetica Neue',Helvetica,sans-serif;
    }
    .tt_flyout_container .card-flex.bg{
        border-bottom: 1px solid #dbdada;
        padding-bottom: 10px;
        padding-top: 8px;
    }
    .tt_flyout_container .card-heading{
        font: normal 600 20px/24px Decimal,Arial,'Helvetica Neue',Helvetica,sans-serif;
		color: rgb(0, 0, 0);
    }
    .tt_flyout_container .card-content p{
        overflow: hidden;
        text-overflow: ellipsis;
        display: -webkit-box;
        -webkit-line-clamp: 3;
        -webkit-box-orient: vertical;
        font: normal 400 12px/21px Merriweather,Georgia,serif;
        color: #5f5f5f;
        margin-bottom: 0;
    }
    .tt_see_how_it_work i {
        width: 20px;
        height: 20px;
        margin-left: 5px;
        margin-top: -2px;
        flex-grow: 0;
        flex-shrink: 0;
        display: inline-block;
        background-size: contain;
        background-position: center;
        background-repeat: no-repeat;
        background-image: url(https://www.paloaltonetworks.com/etc/clientlibs/clean/imgs/video-play-black.svg);
    }
    .tt_see_how_it_work{
        /*font: normal 600 12px/18px Decimal, Arial, 'Helvetica Neue', Helvetica, sans-serif;*/
		font: normal 600 20px/24px Decimal,Arial,'Helvetica Neue',Helvetica,sans-serif;
        color: #141414 !important;
        text-align: left;
        padding: 7px 0 !important;
        font-size: 12px !important;
    }
    .tt_flyout_container .card-content a{
        color: black;
    }
    .tt_flyout_container .tt_expand_txt i{
        margin: 3px;
    }
    .tt_flyout_container .tt_content{
        padding: 10px;
    }
    .tt_close_flyout{
        width: 50px;
        transition: width 0.3s ease 0s;
    }
    .tt_open_flyout{
        width: 320px;
        transition: width 0.3s ease 0s;
    }
    .tt_arrow_reverse{
        transform: rotate(180deg);
    }
    .tt_flyout_container .tt_expand_btn:focus{
        border: 0 !important;
    }
    </style><script>
      console.log("Activity Entered");
        Flickerlessly = window.Flickerlessly || {};
        !function (A) {
          "use strict";
          var init = function (id, sel, callback, persist) {
            var animationName = 'atNodeInserted' + id;
            var cssStr = '@keyframes ' + animationName + ' {from {opacity:0.99} to {opacity:1} }\n';
            cssStr += sel + '{animation-duration:0.001s;animation-name:' + animationName + ';visibility:hidden}';
            var head = document.getElementsByTagName("head")[0];
            if (head) {
              var style = document.createElement("style");
              style.setAttribute("type", "text/css");
              if (style.styleSheet)
                style.styleSheet.cssText = cssStr;
              else
                style.appendChild(document.createTextNode(cssStr));
              head.insertBefore(style, head.firstChild)
            };
            var _insertListener = function (event) {
              if (event.animationName === animationName && typeof event.target === 'object') {
                var isExecute = ((persist === true) || (persist === false && event.target.getAttribute('data-flk-success') === null)) ? true : false;
                if (console && console.info) console.info("Node " + sel + " ready! Execute: " + isExecute, event.target);
                if (typeof callback === 'function' && isExecute) {
                  callback(event.target);
                  event.target.setAttribute('data-flk-success', animationName);
                }
                event.target.style.visibility = 'visible';
              }
            };
            ['animationstart', 'MSAnimationStart', 'webkitAnimationStart'].forEach(function (item, index) {
              document.addEventListener(item, _insertListener, false);
            });
          };
          A.onReady = function () {
            for (var i = 0; i < arguments.length; i++) {
              var obj = arguments[i];
              var selector = obj.selector;
              var success = obj.success || null;
              var persist = obj.persist || false;
              var rand = Math.floor((Math.random() * 100) + 1);
              init(rand, selector, success, persist);
            };
          };
        }(Flickerlessly);
        Flickerlessly.onReady({
            selector: 'body',
            persist: false,
            success: function (el) {
                jQuery('body').append('<div class="tt_flyout_container tt_close_flyout"><button class="tt_expand_btn" data-page-track="true" data-page-track-value="rec:toggle:expand"><div class="tt_expand_txt"><div tabindex="0" class="tt_expand_rec_txt">Recommended For You</div><i tabindex="0" class="fa fa-angle-right"></i></div></button><div class="tt_content"><div class="card-flex bg"><div class="card-content"><a target="_blank" href="https://www.paloaltonetworks.com/ransomware-readiness-assessment" data-page-track="true" data-page-track-value="rec:title::Ransomware is always evolving:Get an assessment"><h2 class="card-heading">Ransomware is always evolving. So should you.</h2></a><p> Defending against ransomware attacks starts with having a plan.</p></div><div class="action"><a target="_blank" href="https://www.paloaltonetworks.com/ransomware-readiness-assessment" class="btn btn-link light tt_see_how_it_work" data-page-track="true" data-page-track-value="rec:cta::Ransomware is always evolving:Request an assessment">Request an assessment<i></i></a></div></div><div class="card-flex bg"><div class="card-content"><a href="https://www.paloaltonetworks.com/unit42" data-page-track="true" data-page-track-value="rec:title:Why Unit42?"><h2 class="card-heading"> Why Unit 42? </h2></a><p>As threats escalate, you need a partner to advise you on the latest risks and help you recover when the worst occurs.</p></div><div class="action"><a href="https://www.paloaltonetworks.com/unit42" class="btn btn-link light tt_see_how_it_work" data-page-track="true" data-page-track-value="rec:cta:Why Unit42?">Learn more<i></i></a></div></div></div></div>');
                
                jQuery('.tt_expand_btn').bind('click', function(){
                    if(jQuery('.tt_flyout_container').hasClass('tt_close_flyout')){
                        jQuery('.tt_flyout_container').addClass('tt_open_flyout');
                        jQuery('.tt_flyout_container').removeClass('tt_close_flyout');
                        jQuery('.tt_expand_txt i').addClass('tt_arrow_reverse');
                        jQuery('.tt_expand_btn').attr('data-page-track-value','rec:toggle:collapse');
                        setTimeout( function(){
                            jQuery('.tt_content').show();
                        }, 200);
                    }else{
                        jQuery('.tt_content').hide();
                        jQuery('.tt_flyout_container').addClass('tt_close_flyout');
                        jQuery('.tt_flyout_container').removeClass('tt_open_flyout');
                        jQuery('.tt_expand_txt i').removeClass('tt_arrow_reverse');
                        jQuery('.tt_expand_btn').attr('data-page-track-value','rec:toggle:expand');
                    }
                });
				var runFlag = true;
               jQuery(window).scroll(function() {
				var hT = $('.py-25').offset().top,
				   wS = $(this).scrollTop();
				if (runFlag && wS > hT){
				   jQuery('.tt_expand_btn').click();
				   runFlag = false;
				}
				}); 
            }
        });
    </script><script type="text/javascript">
/*T&T Metadata v3 ==>Response Plugin*/
window.ttMETA=(typeof(window.ttMETA)!="undefined")?window.ttMETA:[];window.ttMETA.push({"CampaignName":"Unit42 Flyout - 11\/25","CampaignId":"427852","RecipeName":"Desktop excluding IE","RecipeId":"0","OfferId":"6894","OfferName":"Default Content","MboxName":"target-global-mbox"});
</script><script src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/munchkin.js(1).下載" async=""></script><script src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/bat.js.下載" async=""></script><link type="text/css" href="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/optanon.css" rel="stylesheet"><style>#optanon ul#optanon-menu li { background-color:  !important }#optanon ul#optanon-menu li.menu-item-selected { background-color:  !important }#optanon #optanon-popup-wrapper .optanon-white-button-middle { background-color:  !important }.optanon-alert-box-wrapper .optanon-alert-box-button-middle { background-color:  !important; border-color:  !important; }#optanon #optanon-popup-wrapper .optanon-white-button-middle button { color:  !important }.optanon-alert-box-wrapper .optanon-alert-box-button-middle button { color:  !important }#optanon #optanon-popup-bottom { background-color: #F2F2F2 !important }#optanon.modern #optanon-popup-top, #optanon.modern #optanon-popup-body-left-shading { background-color: #F2F2F2 !important }.optanon-alert-box-wrapper { background-color:#141414 !important }.optanon-alert-box-wrapper .optanon-alert-box-bg p { color: !important }.optanon-alert-box-wrapper .optanon-alert-box-corner-close {
    height: 22px !important;
	width: 22px !important;
    top: 0px !important;
	left: 0px !important;
	right: auto !important;
    margin-top: auto !important;
	position: relative !important;
}

#optanon .optanon-close, .optanon-alert-box-wrapper .optanon-alert-box-corner-close button {
    float: none;
    right: auto !important;
    top: auto !important;
}

.optanon-alert-box-wrapper .optanon-alert-box-bg p {
    font-size: 10pt !important;
    line-height: 14pt !important;
}
#optanon #optanon-popup-body-left-shading {
    background-color: #3b99d7;
}

#optanon #optanon-branding-top-logo {
    height: 80px;
    width: 140px;
    top: -81px;
    left: 10px;
}

.optanon-alert-box-wrapper a {
    color: white;
}</style><script src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/RC15a6baa2103d476c9bf970ed3b09310c-source.min.js.下載" async=""></script><script src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/5151604.js.下載" type="text/javascript" async="" data-ueto="ueto_090224562a"></script><script src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/RC5a09b4a33dab48c99f391654719b1de8-source.min.js.下載" async=""></script><script src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/RC644f61c57b4a405b9ccb7601808463e8-source.min.js.下載" async=""></script><script type="text/javascript">
/*T&T Metadata v3 ==>Response Plugin*/
window.ttMETA=(typeof(window.ttMETA)!="undefined")?window.ttMETA:[];window.ttMETA.push({"CampaignName":"","CampaignId":"","RecipeName":"","RecipeId":"","OfferId":"","OfferName":"","MboxName":"demandbase_mbox"});
</script><link rel="stylesheet" type="text/css" media="all" href="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/reset.css"></head>
  <body class="post-template-default single single-post postid-109087 single-format-standard" data-flk-success="atNodeInserted7" style="visibility: visible;"><div class="optanon-alert-box-wrapper hide-accept-button " role="alertdialog" aria-labelledby="alert-box-title" aria-describedby="alert-box-message" style="bottom: 0px;"><div class="optanon-alert-box-bottom-top"><div class="optanon-alert-box-corner-close"><button class="optanon-alert-box-close banner-close-button" aria-label="Close" title="Close" onclick="Optanon.TriggerGoogleAnalyticsEvent(&#39;OneTrust Cookie Consent&#39;, &#39;Banner Close Button&#39;);" tabindex="3"></button></div></div><div class="optanon-alert-box-bg"><div class="optanon-alert-box-logo"> </div><div class="optanon-alert-box-body"><p class="optanon-alert-box-title legacy-banner-title sr-only" id="alert-box-title" role="heading" aria-level="2">Cookie Notice</p><p class="banner-content" id="alert-box-message">This site uses cookies essential to its operation, for analytics, and for personalized content and ads. By continuing to browse this site, you acknowledge the use of cookies.                     <a href="https://www.paloaltonetworks.com/legal-notices/privacy" class="banner-policy-link" tabindex="1" aria-label="Privacy statement">Privacy statement</a></p></div><div class="optanon-clearfix"></div><div class="optanon-alert-box-button-container"><div class="optanon-alert-box-button optanon-button-close"><div class="optanon-alert-box-button-middle"><button class="optanon-alert-box-close" aria-label="Close">Close</button></div></div><div class="optanon-alert-box-button optanon-button-more"><div class="optanon-alert-box-button-middle"><button class="optanon-toggle-display cookie-settings-button" title="Cookie Settings" aria-label="Cookie Settings" onclick="Optanon.TriggerGoogleAnalyticsEvent(&#39;OneTrust Cookie Consent&#39;, &#39;Banner Open Preferences&#39;);" tabindex="2">Cookie Settings</button></div></div></div><div class="optanon-clearfix optanon-alert-box-bottom-padding"></div></div></div><div id="optanon" class="modern"><div id="optanon-popup-bg"></div><div id="optanon-popup-wrapper" role="dialog" aria-modal="true" tabindex="-1" lang="en-US"><div id="optanon-popup-top"><button onclick="Optanon.TriggerGoogleAnalyticsEvent(&#39;OneTrust Cookie Consent&#39;, &#39;Preferences Close Button&#39;);" aria-label="Close" class="optanon-close-link optanon-close optanon-close-ui" title="Close"><div id="optanon-close" style="background: url(https://cdn.cookielaw.org/skins/6.22.0/default_flat_bottom_two_button_black/v2/images/optanon-pop-up-close.png);width:34px;height:34px;"></div></button></div><div id="optanon-popup-body"><div id="optanon-popup-body-left"><div id="optanon-popup-body-left-shading"></div><div id="optanon-branding-top-logo" style="background-image: url(&#39;https://cdn.cookielaw.org/logos/6445/6445:paloaltonetworks.com/LogoGrey.png&#39;) !important;"></div><ul id="optanon-menu" aria-label="Navigation Menu" role="tablist"><li class="menu-item-on menu-item-about" title="Your Privacy"><p class="preference-menu-item"><button role="tab" aria-selected="true" aria-controls="Your-Privacy" id="Your-Privacy">Your Privacy</button></p></li><li class="menu-item-necessary menu-item-on" title="Strictly Necessary Cookies"><p class="preference-menu-item"><button role="tab" aria-selected="false" aria-controls="Strictly-Necessary-Cookies" id="Strictly-Necessary">Strictly Necessary Cookies</button></p></li><li class="menu-item-on menu-item-performance" title="Performance Cookies"><p class="preference-menu-item"><button role="tab" aria-selected="false" aria-controls="Performance-Cookies" id="Performance-Cookies">Performance Cookies</button></p></li><li class="menu-item-on menu-item-functional" title="Functional Cookies"><p class="preference-menu-item"><button role="tab" aria-selected="false" aria-controls="Functional-Cookies" id="Functional-Cookies">Functional Cookies</button></p></li><li class="menu-item-on menu-item-advertising" title="Targeting Cookies"><p class="preference-menu-item"><button role="tab" aria-selected="false" aria-controls="Targeting-Cookies" id="Targeting-Cookies">Targeting Cookies</button></p></li><li class="menu-item-moreinfo menu-item-off" title="Privacy Statement"><p class="preference-menu-item"><a target="_blank" aria-label="Privacy Statement" href="https://www.paloaltonetworks.com/legal-notices/privacy" onclick="Optanon.TriggerGoogleAnalyticsEvent(&#39;OneTrust Cookie Consent&#39;, &#39;Preferences Cookie Policy&#39;);">Privacy Statement</a></p></li></ul></div><div><div id="optanon-popup-body-right"><p role="heading" aria-level="2" class="legacy-preference-banner-title h2" aria-label="Privacy Preference Center">Privacy Preference Center</p><div class="vendor-header-container"><p class="header-3" role="heading" aria-level="3"></p><div id="optanon-popup-more-info-bar"><div class="optanon-status"><div class="optanon-status-editable"><form __bizdiag="0" __biza="WJ__"><span class="fieldset"><p><input type="checkbox" value="check" id="chkMain" checked="checked" class="legacy-group-status optanon-status-checkbox"><label for="chkMain">Active</label></p></span></form></div><div class="optanon-status-always-active optanon-status-on"><p>Always Active</p></div></div></div></div><div class="optanon-main-info-text" role="tabpanel"></div></div><div class="optanon-bottom-spacer"></div></div></div><div id="optanon-popup-bottom"> <a href="https://onetrust.com/poweredbyonetrust" target="_blank" rel="noopener"><div id="optanon-popup-bottom-logo" alt="OneTrust Website" style="background: url(https://cdn.cookielaw.org/skins/6.22.0/default_flat_bottom_two_button_black/v2/images/cookie-collective-top-bottom.png);width:155px;height:35px;" title="powered by OneTrust"></div></a><div class="optanon-button-wrapper optanon-save-settings-button optanon-close optanon-close-consent"><div class="optanon-white-button-left"></div><div class="optanon-white-button-middle"><button title="Save Settings" aria-label="Save Settings" onclick="Optanon.TriggerGoogleAnalyticsEvent(&#39;OneTrust Cookie Consent&#39;, &#39;Preferences Save Settings&#39;);">Save Settings</button></div><div class="optanon-white-button-right"></div></div><div class="optanon-button-wrapper optanon-allow-all-button optanon-allow-all" style="display: none;"><div class="optanon-white-button-left"></div><div class="optanon-white-button-middle"><button title="Allow All" aria-label="Allow All" onclick="Optanon.TriggerGoogleAnalyticsEvent(&#39;OneTrust Cookie Consent&#39;, &#39;Preferences Allow All&#39;);">Allow All</button></div><div class="optanon-white-button-right"></div></div></div></div></div>
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <header class="haeder py-15 position-relative z-index-2">
  <div class="container px-sm-30 px-35">
    <div class="row">
      <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                  <a href="https://www.paloaltonetworks.com/">
<!--<img src="/wp-content/uploads/2019/07/paloaltonetwork.svg" class="attachment-full size-full" alt="" height="43" width="124" />-->
<img src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/PANW_Parent.png" width="140px" alt="Logo">

</a>

      </div>

      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/">
            <!--<img src="/wp-content/uploads/2019/07/unit42.svg" class="attachment-full size-full" alt="" height="35" width="105" />-->
            <img src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/unit42-logo-white.svg" class="attachment-full size-full" alt="Unit42 Logo" width="150" height="35">
        </a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <div class="xdsoft_autocomplete" style="display: inline-block; width: 294px;"><input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search xdsoft_input" value="" required="" autocomplete="off" style="font-size: 16px; background: transparent !important;"><div class="xdsoft_autocomplete_dropdown" style="left: 0px; top: 46px; margin-left: 0px; margin-right: 0px; width: 294px;"></div><input readonly="" class="xdsoft_autocomplete_hint" style="box-sizing: border-box; border-style: solid; border-collapse: separate; border-width: 0px; padding: 0px 10px 0px 50px; margin: 0px; max-height: none; min-height: 0px; max-width: none; min-width: 0px; width: 294px; letter-spacing: normal; line-height: 16px; outline-width: 0px; font-family: LatoLatinWeb, sans-serif; font-variant: normal; font-style: normal; font-size: 16px; font-weight: 400; flex: 0 1 auto; justify-content: normal; border-radius: 0px; box-shadow: none; height: 46px; position: absolute; z-index: 1; border-color: transparent; outline-color: transparent; left: 0px; top: 0px; background: url(&quot;https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v5/dist/images/svg/search.svg&quot;) 19px 50% / 18px 18px no-repeat scroll padding-box border-box rgb(38, 38, 38);"></div>
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-119884" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-119884"><a target="_blank" rel="noopener" href="https://www.paloaltonetworks.com/unit42">Security Consulting</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
</ul>  </div>
</nav>
<div class="panClean pan-template-home" id="main-nav-menu-cont" style="display:none;">
    <div class="cleanHeader mainNavigationComp baseComponent parbase">
        <div class="productNav2021Component dark" id="PAN_2021_NAV_ASYNC"></div>

  </div>
<div class="cleanTopHtml htmlComp baseComponent parbase"><div class="base-component-spacer spacer-none  "></div>
</div>


</div>
<script type="text/javascript">
	function getCookie(cname) {
	 	var name = cname + "=";
  		var decodedCookie = decodeURIComponent(document.cookie);
		var ca = decodedCookie.split(';');
  		for(var i = 0; i <ca.length; i++) {
    			var c = ca[i];
    			while (c.charAt(0) == ' ') {
     				 c = c.substring(1);
    			}
    			if (c.indexOf(name) == 0) {
    				 return c.substring(name.length, c.length);
    			}
  		}
  		return "";
	}

	var referer = "";//sessionStorage.container;
	var pcontainer = sessionStorage.getItem("container");
	var searchResultsPagePath = "";
	if(((pcontainer) && pcontainer.indexOf('Prisma')!=-1)){
	    referer = 'Prisma' ;
	}
        else if(((pcontainer) && pcontainer.indexOf('Cortex')!=-1)){
	    referer = 'Cortex' ;
	}
        else if(((pcontainer) && pcontainer.indexOf('Sase')!=-1)){
	    referer = 'Sase' ;
	}
        var fromRef = document.referrer;
	var nContainer = getCookie("navContainer");
        if(nContainer){//If user is coming from main site, we need to reset the container		
		if(fromRef  && fromRef.indexOf("prismacloud.io")!=-1){
                        referer = 'Prisma' ;
                        sessionStorage.setItem("container","Prisma");
                } else if(fromRef.indexOf("paloaltonetworks.com")!=-1 ){
                        if(nContainer.indexOf('Prisma') != -1){
                            referer = 'Prisma' ;
                            sessionStorage.setItem("container","Prisma");
                        }
                        if(nContainer.indexOf('Cortex') != -1){
                            referer = 'Cortex' ;
                            sessionStorage.setItem("container","Cortex");
                        }
			if(nContainer.indexOf('Sase') != -1){
                            referer = 'Sase' ;
                            sessionStorage.setItem("container","Sase");
                        }
			document.cookie = 'navContainer=; path=/; domain=.paloaltonetworks.com; expires=' + new Date(0).toUTCString();
		}
	}
    //var referer = "Prisma";//sessionStorage.container;
        console.log("referer"+referer);
        if(referer != "Prisma" && referer != "Cortex" && referer != "Sase"){
              document.getElementById('navigation').removeAttribute("style");
              document.getElementsByTagName("header")[0].removeAttribute("style");
        }
function callMainSitePrismaNavHTML(){
    
   //var menu_url = 'https://www.paloaltonetworks.com/_jcr_content/globals/cleanHeaderPrisma.prismaRenderer.html';
   if(referer == 'Prisma'){
        var menu_url = 'https://www.paloaltonetworks.com/_jcr_content/globals/cleanHeaderPrisma.prismaRenderer.html';
	searchResultsPagePath = "https://www.paloaltonetworks.com/search/prismasearch";
    }
    if(referer == 'Cortex'){
        var menu_url = 'https://www.paloaltonetworks.com/_jcr_content/globals/cleanHeaderCortex.cortexRenderer.html';
	searchResultsPagePath = "https://www.paloaltonetworks.com/search/cortexsearch";
    }
    if(referer == 'Sase'){
        var menu_url = 'https://www.paloaltonetworks.com/_jcr_content/globals/cleanHeaderSase.saseRenderer.html';
	searchResultsPagePath = "https://www.paloaltonetworks.com/search/sasesearch";
    }
    httpGet(menu_url,'menu_html');
    document.getElementById('main-nav-menu-cont').removeAttribute("style");
}
function addStyle(styles) {
              
    /* Create style document */
    var css = document.createElement('style');
    css.type = 'text/css';

    if (css.styleSheet) 
        css.styleSheet.cssText = styles;
    else 
        css.appendChild(document.createTextNode(styles));

    /* Append style to the tag name */
    document.getElementsByTagName("head")[0].appendChild(css);
}
    function httpGet(theUrl,req_type)
    {
        if (window.XMLHttpRequest)
        {// code for IE7+, Firefox, Chrome, Opera, Safari
            xmlhttp=new XMLHttpRequest();
        }
        else
        {// code for IE6, IE5
            xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
        }
        xmlhttp.onreadystatechange=function()
        {
            if (xmlhttp.readyState==4 && xmlhttp.status==200)
            {
                //console.log();
                //return xmlhttp.responseText;
                
                if(req_type == 'menu_html'){
                    var nav_text = xmlhttp.responseText.replaceAll('src="', 'src="'+main_site_url);
                    
                    document.getElementById("PAN_2021_NAV_ASYNC").innerHTML = nav_text.replaceAll('href="/', 'href="'+main_site_url+'/');
		    var lozad_back = document.getElementsByClassName('lozad-background');
		    Array.prototype.forEach.call(lozad_back, function(el) {
			// Do stuff here
			var el_back_img_path = el.getAttribute('data-background-image');
			var first_pos = el_back_img_path.indexOf("'");
			var last_pos = el_back_img_path.indexOf("'",first_pos+1);
			el_back_img_path = el_back_img_path.substring(first_pos+1,last_pos);
			el.setAttribute("data-background-image",main_site_url+el_back_img_path);
		    });
                }
                if(req_type == 'head_inline_css'){
                    addStyle(xmlhttp.responseText);
                }
                //document.getElementsByTagName("header")[1].removeAttribute("style");
                //document.getElementsByTagName("header")[1].classList.add("light");
            }
        }
        xmlhttp.open("GET", theUrl, false );
        xmlhttp.send();    
    }    
    
    if(referer == 'Prisma' || referer == 'Cortex' || referer == 'Sase'){        
        const article = document.querySelector('#PAN_2021_NAV_ASYNC');
        if(referer == 'Prisma'){
            article.dataset.type = 'prisma';
        }
        else if(referer == 'Cortex'){
            article.dataset.type = 'cortex';
        }
        else if(referer == 'Sase'){
            article.dataset.type = 'sase';
        }
        callMainSitePrismaNavHTML();        
    }
</script>


  <article class="article overflow-hidden">
    
<header class="article__header py-sm-25 pt-40 pb-25 bg-gray-700">
  <div class="container">
    
    <h1 class="article__header__title mb-sm-30 mb-40">CVE-2020-14386: Privilege Escalation Vulnerability in the Linux kernel</h1>

    <ul class="article__entry-meta d-flex flex-wrap align-items-center text-black">
      <li class="mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200"><div class="post-views post-109087 entry-meta">
				
				
				<span class="post-views-count">41,792</span>
			</div> <span class="ml-5">people reacted</span></li>
      <li class="d-sm-none col-12 p-0"></li>
      <li class="mr-10 mb-10 px-20 rounded-pill bg-gray-200"><span class="ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,&#39;109087&#39;,&#39;like&#39;)"><i class="ui ui-2"></i><span class="ml-5">25</span></span></li>
      <li class="mb-10 px-20 rounded-pill bg-gray-200"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 8</span> <span class="rt-label rt-postfix"></span></span> min. read</li>
    </ul>

    <div class="article__share position-relative">
      <div class="dropdown dropdown-right">
        <button type="button" class="px-25 text-black bg-white text-uppercase rounded-pill" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Share <i class="ui ui-6 ml-10 align-text-top"></i>
        </button>
        <div class="dropdown-menu rounded-pill" role="toolbar">
          <div class="share-dropdown px-20 py-10 text-black font-size-sm">
            <div class="row align-items-center flex-nowrap">
              <div class="col">
                <div class="d-flex align-items-center">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Fcve-2020-14386%2F" target="_blank"><i class="ui ui-7"></i></a>
                  <a href="https://twitter.com/home?status=https%3A%2F%2Funit42.paloaltonetworks.com%2Fcve-2020-14386%2F+-+CVE-2020-14386%3A+Privilege+Escalation+Vulnerability+in+the+Linux+kernel" target="_blank"><i class="ui ui-8"></i></a>
                  <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fcve-2020-14386%2F&amp;title=CVE-2020-14386%3A+Privilege+Escalation+Vulnerability+in+the+Linux+kernel&amp;summary=&amp;source=" target="_blank"><i class="ui ui-9"></i></a>
                  <a href="https://www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/cve-2020-14386/" target="_blank"><i class="ui ui-10"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>    <div class="article__summary py-25 text-gray-500 font-size-sm">
  <div class="container">
    <div class="row align-items-center no-gutters">
      <div class="col-sm-auto col-12 mb-sm-0 mb-35">
        <i class="ui ui-11 text-gray-700 mr-sm-20"></i>
      </div>
  
      <div class="col-sm col-12">
        <p>
          By <a href="https://unit42.paloaltonetworks.com/author/or-cohen/" title="Posts by Or Cohen" class="author url fn" rel="author">Or Cohen</a>        </p>
        <p><time datetime="2020-10-10T00:00:11+00:00">October 9, 2020 at 5:00 PM</time></p>
        <p>Category: <a href="https://unit42.paloaltonetworks.com/category/unit-42/" rel="category tag">Unit 42</a></p>
        <p>Tags: <a href="https://unit42.paloaltonetworks.com/tag/cve-2020-14386/" rel="tag">CVE-2020-14386</a>, <a href="https://unit42.paloaltonetworks.com/tag/linux/" rel="tag">Linux</a>, <a href="https://unit42.paloaltonetworks.com/tag/privilege-escalation/" rel="tag">privilege escalation</a>, <a href="https://unit42.paloaltonetworks.com/tag/vulnerability/" rel="tag">vulnerability</a></p>
      </div>
    </div>
  </div>
</div>    <div class="py-30 bg-white">
      <div class="container">
        <div class="article__content pb-30">
                      <figure class="mb-30 text-center">
              <img width="900" height="450" src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/Vulnerability-r3d2-1.png" class="attachment-single size-single" alt="The image represents the concept of a vulnerability, such as CVE-2020-14386" loading="lazy">            </figure>
                    <p class="wpml-ls-statics-post_translations wpml-ls">This post is also available in: 
    <span class="wpml-ls-slot-post_translations wpml-ls-item wpml-ls-item-ja wpml-ls-first-item wpml-ls-last-item wpml-ls-item-legacy-post-translations"><a href="https://unit42.paloaltonetworks.jp/cve-2020-14386/" class="wpml-ls-link"><span class="wpml-ls-native" lang="ja">日本語</span><span class="wpml-ls-display"><span class="wpml-ls-bracket"> (</span>Japanese<span class="wpml-ls-bracket">)</span></span></a></span></p><h2><a id="post-109087-_f8zz5wdou2h9"></a>Executive Summary</h2>
<p>Lately, I’ve been investing time into auditing packet sockets source code in the Linux kernel. This led me to the discovery of <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-14386">CVE-2020-14386</a>, a memory corruption vulnerability in the Linux kernel. Such a vulnerability can be used to escalate privileges from an unprivileged user into the root user on a Linux system. In this blog, I will provide a technical walkthrough of the vulnerability, how it can be exploited and how Palo Alto Networks customers are protected.</p>
<p>A few years ago, several vulnerabilities were discovered in packet sockets (<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-7308">CVE-2017-7308</a> and <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-8655">CVE-2016-8655</a>), and there are some publications, such as this one in the <a href="https://googleprojectzero.blogspot.com/2017/05/exploiting-linux-kernel-via-packet.html">Project Zero blog</a> and this in <a href="https://www.openwall.com/lists/oss-security/2016/12/07/3">Openwall</a>, which give some overview of the main functionality.</p>
<p>Specifically, in order for the vulnerability to be triggerable, we need the kernel to have <span style="font-family: &#39;courier new&#39;, courier, monospace;">AF_PACKET</span> sockets enabled (<span style="font-family: &#39;courier new&#39;, courier, monospace;">CONFIG_PACKET=y</span>) and the <span style="font-family: &#39;courier new&#39;, courier, monospace;">CAP_NET_RAW</span> privilege for the triggering process, which can be obtained in an unprivileged user namespace if user namespaces are enabled (<span style="font-family: &#39;courier new&#39;, courier, monospace;">CONFIG_USER_NS=y</span>) and accessible to unprivileged users. Surprisingly, this long list of constraints is satisfied by default in some distributions, like Ubuntu.</p>
<p>Palo Alto Networks Cortex XDR customers can prevent this bug with a combination of the <a href="https://www.paloaltonetworks.com/resources/whitepapers/5-requirements-for-effective-endpoint-protection">Behavioral Threat Protection</a> (BTP) feature and <a href="https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/endpoint-security/endpoint-security-concepts/endpoint-protection-modules.html">Local Privilege Escalation Protection</a> module, which monitor malicious behaviors across a sequence of events, and immediately terminate the attack when it is detected.</p>
<h2><a id="post-109087-_6xg1uo26gsk8"></a>Technical Details</h2>
<p>(All of the code figures on this section are from the 5.7 kernel sources.)</p>
<p>Due to the fact that the implementation of <span style="font-family: &#39;courier new&#39;, courier, monospace;">AF_PACKET</span> sockets was covered in-depth in the Project Zero blog, I will omit some details that were already described in that article (such as the relation between frames and blocks) and go directly into describing the vulnerability and its root cause.</p>
<p>The bug stems from an arithmetic issue that leads to memory corruption. The issue lies in the <span style="font-family: &#39;courier new&#39;, courier, monospace;">tpacket_rcv</span> function, located in (<span style="font-family: &#39;courier new&#39;, courier, monospace;">net/packet/af_packet.c</span>) .</p>
<p>The arithmetic bug was introduced on July 19, 2008, in the commit <a href="https://github.com/torvalds/linux/commit/8913336a7e8d56e984109a3137d6c0e3362596a4">8913336</a> (“<span style="font-family: &#39;courier new&#39;, courier, monospace;">packet: add PACKET_RESERVE sockopt</span>”). However, it became triggerable for memory corruption only in February 2016, in the commit 58d19b19cd99 ("<span style="font-family: &#39;courier new&#39;, courier, monospace;">packet: vnet_hdr </span><span style="font-family: &#39;courier new&#39;, courier, monospace;">support for tpacket_rcv</span>"). There were some attempts to fix it, such as commit bcc536 (“<span style="font-family: &#39;courier new&#39;, courier, monospace;">net/packet: fix overflow in check for tp_reserve</span>”) in May 2017 and commit edb58be (“<span style="font-family: &#39;courier new&#39;, courier, monospace;">packet: Don't write vnet header beyond end of buffer</span>”) in August 2017. However, those fixes were not enough to prevent memory corruption.</p>
<p>Let’s first have a look at the <span style="font-family: &#39;courier new&#39;, courier, monospace;">PACKET_RESERVE</span> option:In order to trigger the vulnerability, a raw socket (<span style="font-family: &#39;courier new&#39;, courier, monospace;">AF_PACKET</span> domain, <span style="font-family: &#39;courier new&#39;, courier, monospace;">SOCK_RAW</span> type ) has to be created with a <span style="font-family: &#39;courier new&#39;, courier, monospace;">TPACKET_V2</span> ring buffer and a specific value for the <span style="font-family: &#39;courier new&#39;, courier, monospace;">PACKET_RESERVE</span> option.</p>
<figure id="attachment_109090" aria-describedby="caption-attachment-109090" style="width: 900px" class="wp-caption aligncenter"><img loading="lazy" class="wp-image-109090" src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/word-image-24.png" alt="PACKET_RESERVE (with PACKET_RX_RING) - By default, a packet receive ring writes packets immediately following the metadata structure and alignment padding. This integer option reserves additional headroom. " width="900" height="108"><figcaption id="caption-attachment-109090" class="wp-caption-text">(from <a href="https://man7.org/linux/man-pages/man7/packet.7.html">https://man7.org/linux/man-pages/man7/packet.7.html</a>)</figcaption></figure>
<p>The headroom that is mentioned in the manual is simply a buffer with size specified by the user, which will be allocated before the actual data of every packet received on the ring buffer. This value can be set from user-space via the <span style="font-family: &#39;courier new&#39;, courier, monospace;">setsockopt</span> system call.</p>
<table style="width: 103.952%;">
<tbody>
<tr>
<td style="width: 100%;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">case PACKET_RESERVE:</span><p></p>
<p style="padding-left: 40px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">{</span></p>
<p style="padding-left: 80px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">unsigned int val;</span></p>
<p style="padding-left: 80px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">if (optlen != sizeof(val))</span></p>
<p style="padding-left: 120px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">return -EINVAL;</span></p>
<p style="padding-left: 80px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">if (copy_from_user(&amp;val, optval, sizeof(val)))</span></p>
<p style="padding-left: 120px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">return -EFAULT;</span></p>
<p style="padding-left: 80px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;"><strong>if (val &gt; INT_MAX) </strong></span></p>
<p style="padding-left: 120px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">return -EINVAL;</span></p>
<p style="padding-left: 80px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">lock_sock(sk);</span></p>
<p style="padding-left: 80px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;"><strong> if (po-&gt;rx_ring.pg_vec || po-&gt;tx_ring.pg_vec) { </strong></span></p>
<p style="padding-left: 120px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">ret = -EBUSY;</span></p>
<p style="padding-left: 80px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">} else {</span></p>
<p style="padding-left: 120px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">po-&gt;tp_reserve = val;</span></p>
<p style="padding-left: 120px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">ret = 0;</span></p>
<p style="padding-left: 80px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">}</span></p>
<p style="padding-left: 80px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">release_sock(sk);</span></p>
<p style="padding-left: 80px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">return ret;</span></p>
<p style="padding-left: 40px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">}</span></p>
</td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><em>Figure 1. Implementation of <span style="font-family: &#39;courier new&#39;, courier, monospace;">setsockopt – PACKET_RESERVE</span></em></p>
<p>As we can see in Figure 1, initially, there is a check that the value is smaller than <span style="font-family: &#39;courier new&#39;, courier, monospace;">INT_MAX</span>. This check was added in <a href="https://lore.kernel.org/patchwork/patch/784412/">this patch</a> to prevent an overflow in the calculation of the minimum frame size in <span style="font-family: &#39;courier new&#39;, courier, monospace;">packet_set_ring</span><strong>. </strong>Later, it’s verified that pages were not allocated for the receive/transmit ring buffer. This is done to prevent inconsistency between the <span style="font-family: &#39;courier new&#39;, courier, monospace;">tp_reserve</span> field and the ring buffer itself.</p>
<p>After setting the value of tp_reserve<strong>,</strong> we can trigger allocation of the ring buffer itself via the setsockopt system call with optname of <span style="font-family: &#39;courier new&#39;, courier, monospace;">PACKET_RX_RING</span>:</p>
<table style="width: 103.781%;">
<tbody>
<tr>
<td style="width: 100%;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">Create a memory-mapped ring buffer for asynchronous packet </span><span style="font-family: &#39;courier new&#39;, courier, monospace;">reception.</span></td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><em>Figure 2. From manual packet –<span style="font-family: &#39;courier new&#39;, courier, monospace;"> PACKET_RX_RING</span> option.</em></p>
<p>This is implemented in the <span style="font-family: &#39;courier new&#39;, courier, monospace;">packet_set_ring</span> function<strong>. </strong>Initially, before the ring buffer is allocated, there are several arithmetic checks on the <span style="font-family: &#39;courier new&#39;, courier, monospace;">tpacket_req</span> structure received from user-space:</p>
<table style="width: 103.22%;">
<tbody>
<tr>
<td style="width: 100%;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">min_frame_size = po-&gt;tp_hdrlen + po-&gt;tp_reserve;</span><p></p>
<p><span style="font-family: &#39;courier new&#39;, courier, monospace;">…</span></p>
<p><span style="font-family: &#39;courier new&#39;, courier, monospace;">...</span></p>
<p><span style="font-family: &#39;courier new&#39;, courier, monospace;">if (unlikely(req-&gt;tp_frame_size &lt; min_frame_size))</span></p>
<p style="padding-left: 120px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">goto out;</span></p>
</td>
</tr>
</tbody>
</table>
<p style="text-align: center; padding-left: 80px;"><em>Figure 3. Part of the sanity checks in the <span style="font-family: &#39;courier new&#39;, courier, monospace;">packet_set_ring</span> function.</em></p>
<p>As we can see in Figure 3, first, the minimum frame size is calculated, and then it is verified versus the value received from user-space. This check ensures that there is space in each frame for the <span style="font-family: &#39;courier new&#39;, courier, monospace;">tpacket</span> header structure (for its corresponding version) and <span style="font-family: &#39;courier new&#39;, courier, monospace;">tp_reserve</span> number of bytes.</p>
<p>Later, after doing all the sanity checks, the ring buffer itself is allocated via a call to <span style="font-family: &#39;courier new&#39;, courier, monospace;">alloc_pg_vec</span><strong>:</strong></p>
<table style="width: 102.555%;">
<tbody>
<tr>
<td style="width: 100%;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">order = get_order(req-&gt;tp_block_size);</span><p></p>
<p><span style="font-family: &#39;courier new&#39;, courier, monospace;">pg_vec = alloc_pg_vec(req, order);</span></p></td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><em>Figure 4. Calling the ring buffer allocation function in the <span style="font-family: &#39;courier new&#39;, courier, monospace;">packet_set_ring</span> function. </em></p>
<p>As we can see from the figure above, the block size is controlled from user-space. The <span style="font-family: &#39;courier new&#39;, courier, monospace;">alloc_pg_vec</span> function allocates the <span style="font-family: &#39;courier new&#39;, courier, monospace;">pg_vec</span> array and then allocates each block via the <span style="font-family: &#39;courier new&#39;, courier, monospace;">alloc_one_pg_vec_page</span> function:</p>
<table style="width: 102.65%;">
<tbody>
<tr>
<td style="width: 100%;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">static struct pgv *alloc_pg_vec(struct tpacket_req *req, int order)</span><p></p>
<p style="padding-left: 40px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">{</span></p>
<p style="padding-left: 80px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">unsigned int block_nr = req-&gt;tp_block_nr;</span></p>
<p style="padding-left: 80px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">struct pgv *pg_vec;</span></p>
<p style="padding-left: 80px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">int i;</span></p>
<p style="padding-left: 80px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">pg_vec = kcalloc(block_nr, sizeof(struct pgv), GFP_KERNEL | __GFP_NOWARN);</span></p>
<p style="padding-left: 80px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">if (unlikely(!pg_vec))</span></p>
<p style="padding-left: 120px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">goto out;</span></p>
<p style="padding-left: 80px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">for (i = 0; i &lt; block_nr; i++) {</span></p>
<p style="padding-left: 120px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">pg_vec[i].buffer = alloc_one_pg_vec_page(order);</span></p>
</td>
</tr>
</tbody>
</table>
<p style="text-align: center; padding-left: 40px;"><em>Figure 5. <span style="font-family: &#39;courier new&#39;, courier, monospace;">alloc_pg_vec</span> implementation.</em></p>
<p>The <span style="font-family: &#39;courier new&#39;, courier, monospace;">alloc_one_pg_vec_page</span> function uses <span style="font-family: &#39;courier new&#39;, courier, monospace;">__get_free_pages</span> in order to allocate the block pages:</p>
<table style="width: 102.454%;">
<tbody>
<tr>
<td style="width: 100%;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">static char *alloc_one_pg_vec_page(unsigned long order)</span><p></p>
<p style="padding-left: 40px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">{</span></p>
<p style="padding-left: 80px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">char *buffer;</span></p>
<p style="padding-left: 80px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">gfp_t gfp_flags = GFP_KERNEL | __GFP_COMP |</span></p>
<p style="padding-left: 160px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">__GFP_ZERO | __GFP_NOWARN | __GFP_NORETRY;</span></p>
<p style="padding-left: 80px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">buffer = (char *) __get_free_pages(gfp_flags, order);</span></p>
<p style="padding-left: 80px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">if (buffer)</span></p>
<p style="padding-left: 120px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">return buffer;</span></p>
</td>
</tr>
</tbody>
</table>
<p style="text-align: center; padding-left: 40px;"><em>Figure 6. <span style="font-family: &#39;courier new&#39;, courier, monospace;">alloc_one_pg_vec_page</span> implementation.</em></p>
<p>After the blocks allocation, the <span style="font-family: &#39;courier new&#39;, courier, monospace;">pg_vec</span> array is saved in the <span style="font-family: &#39;courier new&#39;, courier, monospace;">packet_ring_buffer</span> structure embedded in the <span style="font-family: &#39;courier new&#39;, courier, monospace;">packet_sock</span> structure representing the socket.</p>
<p>When a packet is received on the interface, the socket bound to the <span style="font-family: &#39;courier new&#39;, courier, monospace;">tpacket_rcv</span> function will be called and the packet data, along with the <span style="font-family: &#39;courier new&#39;, courier, monospace;">TPACKET</span> metadata, will be written into the ring buffer. In a real application, such as tcpdump, this buffer is mmap’d to the user-space and packet data can be read from it.</p>
<h2><a id="post-109087-_oikyq41mrdu7"></a>The Bug</h2>
<p>Now let’s dive into the implementation of the <span style="font-family: &#39;courier new&#39;, courier, monospace;">tpacket_rcv</span> function (Figure 7). First, <span style="font-family: &#39;courier new&#39;, courier, monospace;">skb_network_offset</span> is called in order to extract the offset of the network header in the received packet into <span style="font-family: &#39;courier new&#39;, courier, monospace;">maclen</span>. In our case, this size is 14 bytes, which is the size of an ethernet header. After that, netoff (which represents the offset of the network header in the frame) is calculated, taking into account the <span style="font-family: &#39;courier new&#39;, courier, monospace;">TPACKET</span> header (fixed per version), the <span style="font-family: &#39;courier new&#39;, courier, monospace;">maclen</span> and the <span style="font-family: &#39;courier new&#39;, courier, monospace;">tp_reserve</span> value (controlled by the user).</p>
<p>However, this calculation can overflow, as the type of <span style="font-family: &#39;courier new&#39;, courier, monospace;">tp_reserve</span> is <span style="font-family: &#39;courier new&#39;, courier, monospace;">unsigned</span> <span style="font-family: &#39;courier new&#39;, courier, monospace;">int</span> and the type of <span style="font-family: &#39;courier new&#39;, courier, monospace;">netoff</span> is <span style="font-family: &#39;courier new&#39;, courier, monospace;">unsigned</span> <span style="font-family: &#39;courier new&#39;, courier, monospace;">short</span>, and the only constraint (as we saw earlier) on the value of <span style="font-family: &#39;courier new&#39;, courier, monospace;">tp_reserve</span> is to be smaller than <span style="font-family: &#39;courier new&#39;, courier, monospace;">INT_MAX</span>.</p>
<table style="width: 102.487%;">
<tbody>
<tr>
<td style="width: 100%;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">if (sk-&gt;sk_type == SOCK_DGRAM) {</span><p></p>
<p><span style="font-family: &#39;courier new&#39;, courier, monospace;">...</span></p>
<p><span style="font-family: &#39;courier new&#39;, courier, monospace;">else {</span></p>
<p style="padding-left: 40px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">unsigned int maclen = skb_network_offset(skb);</span></p>
<p style="padding-left: 40px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">netoff = TPACKET_ALIGN(po-&gt;tp_hdrlen +</span></p>
<p style="padding-left: 240px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">(maclen &lt; 16 ? 16 : maclen)) +</span></p>
<p style="padding-left: 240px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">po-&gt;tp_reserve;</span></p>
<p style="padding-left: 40px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">if (po-&gt;has_vnet_hdr) {</span></p>
<p style="padding-left: 80px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">netoff += sizeof(struct virtio_net_hdr);</span></p>
<p style="padding-left: 80px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">do_vnet = true;</span></p>
<p style="padding-left: 40px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">}</span></p>
<p style="padding-left: 40px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">macoff = netoff - maclen;</span></p>
<p><span style="font-family: &#39;courier new&#39;, courier, monospace;">}</span></p></td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><em>Figure 7. The arithmetic calculation in <span style="font-family: &#39;courier new&#39;, courier, monospace;">tpacket_rcv</span></em></p>
<p>Also shown in Figure 7, if the <span style="font-family: &#39;courier new&#39;, courier, monospace;">PACKET_VNET_HDR</span> option is set on the socket, <span style="font-family: &#39;courier new&#39;, courier, monospace;">sizeof(struct virtio_net_hdr)</span> is added to it in order to account for the <span style="font-family: &#39;courier new&#39;, courier, monospace;">virtio_net_hdr</span> structure, which should be right beyond the ethernet header. And finally, the offset of the ethernet header is calculated and saved into <span style="font-family: &#39;courier new&#39;, courier, monospace;">macoff</span>.</p>
<p>Later in that function, seen in Figure 8 below, the <span style="font-family: &#39;courier new&#39;, courier, monospace;">virtio_net_hdr</span> structure is written into the ring buffer using the <span style="font-family: &#39;courier new&#39;, courier, monospace;">virtio_net_hdr_from_skb</span> function. In Figure 8, <span style="font-family: &#39;courier new&#39;, courier, monospace;">h.raw</span> points into the currently free frame in the ring buffer (which was allocated in <span style="font-family: &#39;courier new&#39;, courier, monospace;">alloc_pg_vec</span>).</p>
<table style="width: 102.1%;">
<tbody>
<tr>
<td style="width: 100%;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">if (do_vnet &amp;&amp;</span><p></p>
<p style="padding-left: 40px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">virtio_net_hdr_from_skb(skb, h.raw + macoff -</span></p>
<p style="padding-left: 160px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">sizeof(struct virtio_net_hdr),</span></p>
<p style="padding-left: 160px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">vio_le(), true, 0))</span></p>
<p style="padding-left: 40px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">goto drop_n_account;</span></p>
</td>
</tr>
</tbody>
</table>
<p style="padding-left: 40px; text-align: center;"><em>Figure 8. Call to <span style="font-family: &#39;courier new&#39;, courier, monospace;">virtio_net_hdr_from_skb</span> function in <span style="font-family: &#39;courier new&#39;, courier, monospace;">tpacket_rcv</span></em></p>
<p>Initially, I thought it might be possible to use the overflow in order to make <span style="font-family: &#39;courier new&#39;, courier, monospace;">netoff</span> a small value, so <span style="font-family: &#39;courier new&#39;, courier, monospace;">macoff</span> could receive a larger value (from the underflow) than the size of a block and write beyond the bounds of the buffer.</p>
<p>However, this is prevented by the following check:</p>
<table style="width: 102.315%;">
<tbody>
<tr>
<td style="width: 100%;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">if (po-&gt;tp_version &lt;= TPACKET_V2) {</span><p></p>
<p style="padding-left: 40px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">if (macoff + snaplen &gt; po-&gt;rx_ring.frame_size) {</span></p>
<p style="padding-left: 40px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">...</span></p>
<p style="padding-left: 40px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">...</span></p>
<p style="padding-left: 80px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">snaplen = po-&gt;rx_ring.frame_size - macoff;</span></p>
<p style="padding-left: 80px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">if ((int)snaplen &lt; 0) {</span></p>
<p style="padding-left: 120px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">snaplen = 0;</span></p>
<p style="padding-left: 120px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">do_vnet = false;</span></p>
<p style="padding-left: 80px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">}</span></p>
<p><span style="font-family: &#39;courier new&#39;, courier, monospace;">}</span></p></td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><em>Figure 9. Another arithmetic check in the <span style="font-family: &#39;courier new&#39;, courier, monospace;">tpacket_rcv</span> function.</em></p>
<p>This check is not sufficient to prevent memory corruption, as we can still make <span style="font-family: &#39;courier new&#39;, courier, monospace;">macoff</span> a small integer value by overflowing <span style="font-family: &#39;courier new&#39;, courier, monospace;">netoff</span>. Specifically, we can make <span style="font-family: &#39;courier new&#39;, courier, monospace;">macoff</span> smaller than <span style="font-family: &#39;courier new&#39;, courier, monospace;">sizeof(struct virtio_net_hdr)</span>, which is 10 bytes, and write behind the bounds of the buffer using <span style="font-family: &#39;courier new&#39;, courier, monospace;">virtio_net_hdr_from_skb</span><strong>.</strong></p>
<h4><a id="post-109087-_qwqsbr3ev794"></a><strong>The Primitive</strong></h4>
<p>By controlling the value of <span style="font-family: &#39;courier new&#39;, courier, monospace;">macoff</span>, we can initialize the <span style="font-family: &#39;courier new&#39;, courier, monospace;">virtio_net_hdr</span> structure in a controlled offset of up to 10 bytes behind the ring buffer. The <span style="font-family: &#39;courier new&#39;, courier, monospace;">virtio_net_hdr_from_skb</span> function starts by zeroing out the entire struct and then initializing some fields within the struct based on the <span style="font-family: &#39;courier new&#39;, courier, monospace;">skb</span> structure.</p>
<table style="width: 102.301%;">
<tbody>
<tr>
<td style="width: 100%;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">static inline int virtio_net_hdr_from_skb(const struct sk_buff *skb,</span><p></p>
<p style="padding-left: 200px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">struct virtio_net_hdr *hdr,</span></p>
<p style="padding-left: 200px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">bool little_endian,</span></p>
<p style="padding-left: 200px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">bool has_data_valid,</span></p>
<p style="padding-left: 200px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">int vlan_hlen)</span></p>
<p><span style="font-family: &#39;courier new&#39;, courier, monospace;">{</span></p>
<p><span style="font-family: &#39;courier new&#39;, courier, monospace;">memset(hdr, 0, sizeof(*hdr)); /* no info leak */</span></p>
<p><span style="font-family: &#39;courier new&#39;, courier, monospace;">if (skb_is_gso(skb)) {</span></p>
<p><span style="font-family: &#39;courier new&#39;, courier, monospace;">...</span></p>
<p><span style="font-family: &#39;courier new&#39;, courier, monospace;">if (skb-&gt;ip_summed == CHECKSUM_PARTIAL) {</span></p>
<p><span style="font-family: &#39;courier new&#39;, courier, monospace;">…</span></p></td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><em>Figure 10. Implementation of the <span style="font-family: &#39;courier new&#39;, courier, monospace;">virtio_net_hdr_from_skb</span> function.</em></p>
<p>However, we can set up the <span style="font-family: &#39;courier new&#39;, courier, monospace;">skb</span> so only zeros will be written into the structure. This leaves us with the ability to zero 1-10 bytes behind a <span style="font-family: &#39;courier new&#39;, courier, monospace;">__get_free_pages</span> allocation. Without doing any heap manipulation tactics, an immediate kernel crash will occur.</p>
<h4><a id="post-109087-_lnj1ectj3upb"></a><strong>POC</strong></h4>
<p>A POC code for triggering the vulnerability can be found in the following Openwall <a href="https://www.openwall.com/lists/oss-security/2020/09/03/3">thread</a>.</p>
<h4><a id="post-109087-_nvgnadx6spgk"></a><strong>Patch</strong></h4>
<p>I submitted the following <a href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=acf69c946233259ab4d64f8869d4037a198c7f06">patch</a> in order to fix the bug.</p>
<p><img loading="lazy" class="aligncenter wp-image-109092" src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/word-image-25.png" alt="The code shown represents the author&#39;s proposed patch for CVE-2020-14386. " width="900" height="416"></p>
<p style="text-align: center;"><em>Figure 11. My proposed patch for the bug.</em></p>
<p>The idea is that if we change the type of <span style="font-family: &#39;courier new&#39;, courier, monospace;">netoff</span> from <span style="font-family: &#39;courier new&#39;, courier, monospace;">unsigned short</span> to <span style="font-family: &#39;courier new&#39;, courier, monospace;">unsigned int</span>, we can check whether it exceeds <span style="font-family: &#39;courier new&#39;, courier, monospace;">USHRT_MAX</span>, and if so, drop the packet and prevent further processing.</p>
<h2><a id="post-109087-_tfmxioa1t0no"></a>Idea for Exploitation</h2>
<p>Our idea for exploitation is to convert the primitive to a use-after-free. For this, we thought about decrementing a reference count of some object. For example, if an object has a refcount value of 0x10001, the corruption would look as follows:</p>
<p><img loading="lazy" width="1" height="1" class="wp-image-109094" src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/word-image-26.png"><img loading="lazy" class="aligncenter wp-image-109096" src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/Screen-Shot-2020-10-09-at-5.16.27-PM.png" alt="This illustrates the process of zeroing out a byte in an object refcount, exploiting CVE-2020-14386. It shows the appearance before corruption, with an example refcount value of 0x10001, and after corruption, when the refcount = 0x1." width="500" height="307"></p>
<p style="text-align: center;"><em>Figure 12. Zeroing out a byte in an object refcount.</em></p>
<p>As we can see in Figure 13 below, after corruption, the refcount will have a value of 0x1, so after releasing one reference, the object will be freed.</p>
<p>However, in order to make this happen, the following constraints have to be satisfied:</p>
<ul>
<li>The refcount has to be located in the last 1-10 bytes of the object.</li>
<li>We need to be able to allocate the object at the end of a page.
<ul>
<li>This is because <span style="font-family: &#39;courier new&#39;, courier, monospace;">get_free_pages</span> returns a page-aligned address.</li>
</ul>
</li>
</ul>
<p>We used some grep expressions along with some manual analysis of code, and we came out with the following object:</p>
<table style="width: 102.177%;">
<tbody>
<tr>
<td style="width: 100%;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">struct sctp_shared_key {</span><p></p>
<p style="padding-left: 40px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">struct list_head key_list;</span></p>
<p style="padding-left: 40px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">struct sctp_auth_bytes *key;</span></p>
<p style="padding-left: 40px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">refcount_t refcnt;</span></p>
<p style="padding-left: 40px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">__u16 key_id;</span></p>
<p style="padding-left: 40px;"><span style="font-family: &#39;courier new&#39;, courier, monospace;">__u8 deactivated;</span></p>
<p><span style="font-family: &#39;courier new&#39;, courier, monospace;">};</span></p></td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><em>Figure 13. Definition of the <span style="font-family: &#39;courier new&#39;, courier, monospace;">sctp_shared_key</span> structure.</em></p>
<p>It seems like this object satisfies our constraints:</p>
<ul>
<li>We can create an sctp server and a client from an unprivileged user context.
<ul>
<li>Specifically, the object is allocated in the <span style="font-family: &#39;courier new&#39;, courier, monospace;">sctp_auth_shkey_create</span> function.</li>
</ul>
</li>
<li>We can allocate the object at the end of a page.
<ul>
<li>The size of the object is 32 bytes and it is allocated via kmalloc. This means the object is allocated in the <span style="font-family: &#39;courier new&#39;, courier, monospace;">kmalloc-32</span> cache.</li>
<li>We were able to verify that we can allocate a <span style="font-family: &#39;courier new&#39;, courier, monospace;">kmalloc-32</span> slab cache page behind our get_free_pages allocation. So we will be able to corrupt the last object in that slab cache page.
<ul>
<li>Because of the reason 4096 % 32 = 0, there is no spare space in the end of the slab page, and the last object is allocated right behind our allocation. Other slab cache sizes may not be good for us, such as 96 bytes, because 4096 % 96 != 0.</li>
</ul>
</li>
</ul>
</li>
<li>We can corrupt the highest 2 bytes of the <span style="font-family: &#39;courier new&#39;, courier, monospace;">refcnt</span> field.
<ul>
<li>After compilation, the size of <span style="font-family: &#39;courier new&#39;, courier, monospace;">key_id</span> and <span style="font-family: &#39;courier new&#39;, courier, monospace;">deactivated</span> is 4 bytes each.</li>
<li>If we use the bug to corrupt 9-10 bytes, we will corrupt the 1-2 most significant bytes of the <span style="font-family: &#39;courier new&#39;, courier, monospace;">refcnt</span> field.</li>
</ul>
</li>
</ul>
<h2><a id="post-109087-_568b25rqnm16"></a>Conclusion</h2>
<p>I was surprised that such simple arithmetic security issues still exist in the Linux kernel and haven’t been previously discovered. Also, unprivileged user namespaces expose a huge attack surface for local privilege escalation, so distributions should consider whether they should enable them or not.</p>
<p>Palo Alto Networks Cortex XDR stops threats on endpoints and coordinates enforcement with network and cloud security to prevent successful cyber attacks. To prevent the exploitation of this bug, the <a href="https://www.paloaltonetworks.com/resources/whitepapers/5-requirements-for-effective-endpoint-protection">Behavioral Threat Protection</a> (BTP) feature and <a href="https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/endpoint-security/endpoint-security-concepts/endpoint-protection-modules.html">Local Privilege Escalation Protection</a> module in Cortex XDR would monitor malicious behaviors across a sequence of events and immediately terminate the attack when detected.</p>
          <div class="article__subscribe mb-40 text-gray-400 bg-gray-200 rounded-lg">
  <h4 class="h3 mb-10 text-black">Get updates from <br class="d-sm-none"> Palo Alto<br class="d-sm-none"> Networks!</h4>
  <p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>
  <!-- <form action="https://app-guse4001.marketo.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe"> -->
  <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate="" class="subscribe-form py-25" name="Unit42_Subscribe" __bizdiag="-393093089" __biza="WJ__">
    <input type="hidden" name="emailFormMask" value="">
    <input type="hidden" value="1086" name="formid">
    <!-- <input type="hidden" value="818-CZC-273" name="munchkinId"> -->
    <input type="hidden" value="531-OCS-018" name="munchkinId">
    <input type="hidden" value="2141" name="lpId">
    <input type="hidden" value="1086" name="formVid">
    <input type="hidden" name="mkto_optinunit42" value="true">
    <input type="hidden" name="mkto_opt-in" value="true">
    <div class="row">
      <div class="col-sm col-12 mb-sm-0 mb-15">
        <input type="email" name="Email" placeholder="Email address" class="subscribe-field d-block w-100 px-sm-25 px-15 bg-white">
        <p class="error-mail d-none mt-15 text-danger" style="color: #dc3545">Please enter your email address!</p>
      </div>
      <div class="col-sm-auto col-12">
          <input type="submit" value="Subscribe" class="btn btn--black btn--sm w-100" disabled="disabled">
      </div>
    </div>

    <div class="google-recapth mt-15">
      <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK"><div style="width: 304px; height: 78px;"><div><iframe title="reCAPTCHA" src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/anchor.html" width="304" height="78" role="presentation" name="a-an7k9jwd63xb" frameborder="0" scrolling="no" sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-top-navigation allow-modals allow-popups-to-escape-sandbox"></iframe></div><textarea id="g-recaptcha-response" name="g-recaptcha-response" class="g-recaptcha-response" style="width: 250px; height: 40px; border: 1px solid rgb(193, 193, 193); margin: 10px 25px; padding: 0px; resize: none; display: none;"></textarea></div><iframe style="display: none;" src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/saved_resource(1).html"></iframe></div>
      <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Please mark, I'm not a robot!</p>
    </div>
  <input type="hidden" name="utm_source__c" value="github.com"><input type="hidden" name="utm_campaign__c" value="(referral)"><input type="hidden" name="utm_medium__c" value="referral"><input type="hidden" name="utm_content__c" value="%2F0n3t04ll%2Flinux-kernel-exploitation"></form>

  <div class="font-size-ex-sm col-sm-7 p-0">
    <p>By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>
  </div>
</div>


        </div>
      </div>
    </div>
  </article>
<footer class="site-footer px-sm-0 px-15">
  <div class="pt-40">
    <div class="container pt-sm-30">
      <div class="row justify-content-lg-center">
        <div class="col-lg-11 col-12">
          <div class="row">
            <div class="col-lg-4 col-sm-3 col-12 order-sm-2">
              <nav class="footer-socials mb-sm-0 mb-25 text-white text-sm-right">
                                                <a href="https://twitter.com/Unit42_Intel" target="_blank"><span class="ui ui-4"></span></a>
                <a href="https://github.com/pan-unit42" target="_blank"><span class="ui ui-5"></span></a>
              </nav>
            </div>

            <div class="col-lg-8 col-sm-9 col-12 order-sm-1">
              <div class="row">
                <div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Popular Resources</h4><div class="menu-footer-company-phase-container"><ul id="menu-footer-company-phase" class="menu"><li id="menu-item-97096" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97096"><a target="_blank" href="https://www.paloaltonetworks.com/resources">Resource Center</a></li>
<li id="menu-item-97097" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97097"><a target="_blank" href="https://researchcenter.paloaltonetworks.com/">Blog</a></li>
<li id="menu-item-97098" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97098"><a target="_blank" href="https://www.paloaltonetworks.com/communities">Communities</a></li>
<li id="menu-item-97099" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97099"><a target="_blank" href="https://docs.paloaltonetworks.com/">Tech Docs</a></li>
<li id="menu-item-97100" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-97100"><a href="https://unit42.paloaltonetworks.com/">Unit 42</a></li>
<li id="menu-item-97101" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97101"><a target="_blank" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Legal Notices</h4><div class="menu-footer-legal-notices-phase-container"><ul id="menu-footer-legal-notices-phase" class="menu"><li id="menu-item-97093" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97093"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a></li>
<li id="menu-item-97094" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97094"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a></li>
<li id="menu-item-97095" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97095"><a target="_blank" href="https://www.paloaltonetworks.com/legal">Documents</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Account</h4><div class="menu-footer-trending-topics-phase-container"><ul id="menu-footer-trending-topics-phase" class="menu"><li id="menu-item-97102" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97102"><a href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a></li>
<li id="menu-item-97103" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97103"><a href="https://unit42.paloaltonetworks.com/cve-2020-14386/#">&nbsp;</a></li>
<li id="menu-item-97104" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97104"><a href="https://www.paloaltonetworks.com/security-disclosure">Report a Vulnerability</a></li>
</ul></div></div>              </div>
            </div>
          </div>

          
            <div class="copyrights py-25 mt-40">
               <p>© 2021 Palo Alto Networks, Inc. All rights reserved.</p>
            </div>
          
        </div>
      </div>
    </div>
  </div>
</footer>
<script type="text/javascript">
    const observer_lozad = lozad('.lozad, .lozad-background'); // lazy loads elements with default selector as '.lozad'
      observer_lozad.observe();
        if(referer == "Prisma" || referer == "Cortex" || referer == "Sase"){
	var Coveo_organizationId = "paloaltonetworksintranet";        
        var techDocsPagePath = "https://docs.paloaltonetworks.com/search.html#hd=All%20Prisma%20Cloud%20Documentation&hq=%40panproductcategory%3D%3D(%22Prisma%20Cloud%22)&sort=relevancy&layout=card&numberOfResults=25";
        var languageFromPath="en_US";
        window.Granite = window.Granite || {};
	Granite.I18n = (function() {
		var self = {};
		self.setLocale = function(locale) { };
		self.get = function(text, snippets, note) {
        	var out = "";
        	if(text){
        		if(text ==="coveo.clear"){
        			out = "Clear";
        		}else if(text ==="coveo.noresultsfound"){
        			out = "No results found for this search term.";
        		}
        	}
        	return out;
        };
        return self
	}());
}
/*
    var Coveo_organizationId = "paloaltonetworksintranetsandbox1";
    var searchResultsPagePath = "https://www.paloaltonetworks.com/search/prismasearch";
    var techDocsPagePath = "https://docs.paloaltonetworks.com/search";
    var languageFromPath="en_US";
    */
    var main_site_critical_top = 'https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.js';
    var main_site_pan_hp_minimal = 'https://www.paloaltonetworks.com/etc/clientlibs/pan-hp-minimal.min.js';
    var main_site_defered = 'https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/defered.min.js';
    window.PAN_MainNavAsyncUrl = "https://www.paloaltonetworks.com/_jcr_content/globals/cleanHeaderPrisma.prismaRenderer.html";

function loadScript(url, defer){
        var script1 = document.createElement('script');
        script1.setAttribute('type', 'text/javascript');
        script1.setAttribute('src',url);
        if(defer == true){
            script1.setAttribute('defer','defer');
        }
        document.head.appendChild(script1);
}
function loadScript1(url, callback){

        var script = document.createElement("script")
        script.type = "text/javascript";

        if (script.readyState){  //IE
            script.onreadystatechange = function(){
                if (script.readyState == "loaded" || script.readyState == "complete"){
                    script.onreadystatechange = null;
                    callback();
                }
            };
        } else {  //Others
            script.onload = function(){
                callback();
            };
        }

        script.src = url;
        document.getElementsByTagName("head")[0].appendChild(script);
}
if(referer == "Prisma" || referer == "Cortex" || referer == "Sase"){
                    //loadScript(main_site_pan_hp_minimal, false);
                    loadScript1(main_site_critical_top, function(){
                            window.PAN_initializeProduct2021Nav();
                    });
                    loadScript(main_site_defered, false);
                }
</script>
    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
    <link rel="stylesheet" id="wpdevart_lightbox_front_end_css-css" href="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/wpdevart_lightbox_front.css" type="text/css" media="all">
<link rel="stylesheet" id="wpdevart_lightbox_effects-css" href="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/effects_lightbox.css" type="text/css" media="all">
<script type="text/javascript" id="ppress-frontend-script-js-extra">
/* <![CDATA[ */
var pp_ajax_form = {"ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","confirm_delete":"Are you sure?","deleting_text":"Deleting...","deleting_error":"An error occurred. Please try again.","nonce":"d950304f89","disable_ajax_form":"false"};
/* ]]> */
</script>
<script type="text/javascript" src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/frontend.min.js.下載" id="ppress-frontend-script-js"></script>
<script type="text/javascript" src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/api.js.下載" id="google/api-js"></script>
<script type="text/javascript" src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/main.js.下載" id="unit42/js-js"></script>
<script type="text/javascript" src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/wp-embed.min.js.下載" id="wp-embed-js"></script>
<script type="text/javascript" id="wpdevart_lightbox_front_end_js-js-extra">
/* <![CDATA[ */
var wpdevart_lb_variables = {"eneble_lightbox_content":"enable","overlay_transparency_prancent":"80","enable_video_popuping":"enable","popup_background_color":"#000000","popup_loading_image":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/popup_loading.png","popup_initial_width":"350","popup_initial_height":"300","popup_youtube_width":"640","popup_youtube_height":"410","popup_vimeo_width":"500","popup_vimeo_height":"410","popup_max_width":"5000","popup_max_height":"5000","popup_position":"5","popup_fixed_position":"true","popup_outside_margin":"0","popup_border_width":"2","popup_border_color":"#000000","popup_border_radius":"10","control_buttons_show":"true","control_buttons_show_in_content":"false","control_buttons_height":"30","control_buttons_line_bg_color":"#000000","control_button_prev_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev.png","control_button_prev_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev_hover.png","control_button_next_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next.png","control_button_next_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next_hover.png","control_button_download_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download.png","control_button_download_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download_hover.png","control_button_innewwindow_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow.png","control_button_innewwindow_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow_hover.png","control_button_fullwidth_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth.png","control_button_fullwidht_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth_hover.png","control_button_fullwidthrest_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset.png","control_button_fullwidhtrest_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset_hover.png","control_button_close_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close.png","control_button_close_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close_hover.png","information_panel_show":"false","information_panel_padding_top":"0","information_panel_padding_bottom":"0","information_panel_show_in_content":"false","information_panel_bg_color":"#000000","information_panel_default_transparency":"100","information_panel_hover_trancparency":"100","information_panel_count_image_after_text":"Image","information_panel_count_image_middle_text":"of","information_panel_count_padding_left":"15","information_panel_count_padding_right":"4","information_panel_count_font_size":"20","information_panel_desc_padding_left":"15","information_panel_desc_padding_right":"4","information_panel_desc_font_size":"20","information_panel_desc_show_if_not":"true","information_panel_text_for_no_caption":"No Caption","information_panel_title_padding_left":"5","information_panel_title_padding_right":"5","information_panel_title_font_size":"15","information_panel_title_show_if_not":"true","information_panel_text_for_no_title":"No Title","information_panel_ordering":"{\"count\":[1,\"count\"],\"title\":[0,\"title\"],\"caption\":[0,\"caption\"]}"};
/* ]]> */
</script>
<script type="text/javascript" src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/wpdevart_lightbox_front.js.下載" id="wpdevart_lightbox_front_end_js-js"></script>
          
  

<script type="text/javascript">
  //Logic to set the cookie domain
  var cookieDomainObject = ["paloaltonetworks.com.br", "paloaltonetworks.ca", "paloaltonetworks.cn", "paloaltonetworks.fr", "paloaltonetworks.de", "paloaltonetworks.in", "paloaltonetworks.it", "paloaltonetworks.jp", "paloaltonetworks.co.kr", "paloaltonetworks.lat", "paloaltonetworks.com.mx", "paloaltonetworks.sg", "paloaltonetworks.es", "paloaltonetworks.tw", "paloaltonetworks.co.uk", "paloaltonetworks.nl", "paloaltonetworks.ru"];
  var cookieDomainResult = cookieDomainObject.filter(function(domain){
    if(location.hostname.endsWith(domain)){
      return true;
    }
  });
  
  //Google Analytics Legacy Code
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-494959-2']);
  var isCom = false;
  try {
    var dName = window.location.hostname;
    var isCom = dName.endsWith(".com");
    if(isCom){
     _gaq.push(['_setDomainName', 'paloaltonetworks.com']);
    }else if(typeof cookieDomainResult !== "undefined"){
     _gaq.push(['_setDomainName', cookieDomainResult[0]]);
    }
  }
  catch(err) {
  }
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script><script>_satellite["_runScript1"](function(event, target, Promise) {
if(!window.webData) window.webData = {};
if(!window.crypto || !window.crypto.encrypt || !window.crypto.getParameterByName){
	if(!window.crypto) window.crypto = {};
	(function(e){function r(e){return h(l(v(e)))}function i(e){return p(l(v(e)))}function s(e,t){return d(l(v(e)),t)}function o(e,t){return h(c(v(e),v(t)))}function u(e,t){return p(c(v(e),v(t)))}function a(e,t,n){return d(c(v(e),v(t)),n)}function f(){return r("abc").toLowerCase()=="900150983cd24fb0d6963f7d28e17f72"}function l(e){return b(w(y(e),e.length*8))}function c(e,t){var n=y(e);if(n.length>16)n=w(n,e.length*8);var r=Array(16),i=Array(16);for(var s=0;s<16;s++){r[s]=n[s]^909522486;i[s]=n[s]^1549556828}var o=w(r.concat(y(t)),512+t.length*8);return b(w(i.concat(o),512+128))}function h(e){try{t}catch(n){t=0}var r=t?"0123456789ABCDEF":"0123456789abcdef";var i="";var s;for(var o=0;o<e.length;o++){s=e.charCodeAt(o);i+=r.charAt(s>>>4&15)+r.charAt(s&15)}return i}function p(e){try{n}catch(t){n=""}var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var i="";var s=e.length;for(var o=0;o<s;o+=3){var u=e.charCodeAt(o)<<16|(o+1<s?e.charCodeAt(o+1)<<8:0)|(o+2<s?e.charCodeAt(o+2):0);for(var a=0;a<4;a++){if(o*8+a*6>e.length*8)i+=n;else i+=r.charAt(u>>>6*(3-a)&63)}}return i}function d(e,t){var n=t.length;var r,i,s,o,u;var a=Array(Math.ceil(e.length/2));for(r=0;r<a.length;r++){a[r]=e.charCodeAt(r*2)<<8|e.charCodeAt(r*2+1)}var f=Math.ceil(e.length*8/(Math.log(t.length)/Math.log(2)));var l=Array(f);for(i=0;i<f;i++){u=Array();o=0;for(r=0;r<a.length;r++){o=(o<<16)+a[r];s=Math.floor(o/n);o-=s*n;if(u.length>0||s>0)u[u.length]=s}l[i]=o;a=u}var c="";for(r=l.length-1;r>=0;r--)c+=t.charAt(l[r]);return c}function v(e){var t="";var n=-1;var r,i;while(++n<e.length){r=e.charCodeAt(n);i=n+1<e.length?e.charCodeAt(n+1):0;if(55296<=r&&r<=56319&&56320<=i&&i<=57343){r=65536+((r&1023)<<10)+(i&1023);n++}if(r<=127)t+=String.fromCharCode(r);else if(r<=2047)t+=String.fromCharCode(192|r>>>6&31,128|r&63);else if(r<=65535)t+=String.fromCharCode(224|r>>>12&15,128|r>>>6&63,128|r&63);else if(r<=2097151)t+=String.fromCharCode(240|r>>>18&7,128|r>>>12&63,128|r>>>6&63,128|r&63)}return t}function m(e){var t="";for(var n=0;n<e.length;n++)t+=String.fromCharCode(e.charCodeAt(n)&255,e.charCodeAt(n)>>>8&255);return t}function g(e){var t="";for(var n=0;n<e.length;n++)t+=String.fromCharCode(e.charCodeAt(n)>>>8&255,e.charCodeAt(n)&255);return t}function y(e){var t=Array(e.length>>2);for(var n=0;n<t.length;n++)t[n]=0;for(var n=0;n<e.length*8;n+=8)t[n>>5]|=(e.charCodeAt(n/8)&255)<<n%32;return t}function b(e){var t="";for(var n=0;n<e.length*32;n+=8)t+=String.fromCharCode(e[n>>5]>>>n%32&255);return t}function w(e,t){e[t>>5]|=128<<t%32;e[(t+64>>>9<<4)+14]=t;var n=1732584193;var r=-271733879;var i=-1732584194;var s=271733878;for(var o=0;o<e.length;o+=16){var u=n;var a=r;var f=i;var l=s;n=S(n,r,i,s,e[o+0],7,-680876936);s=S(s,n,r,i,e[o+1],12,-389564586);i=S(i,s,n,r,e[o+2],17,606105819);r=S(r,i,s,n,e[o+3],22,-1044525330);n=S(n,r,i,s,e[o+4],7,-176418897);s=S(s,n,r,i,e[o+5],12,1200080426);i=S(i,s,n,r,e[o+6],17,-1473231341);r=S(r,i,s,n,e[o+7],22,-45705983);n=S(n,r,i,s,e[o+8],7,1770035416);s=S(s,n,r,i,e[o+9],12,-1958414417);i=S(i,s,n,r,e[o+10],17,-42063);r=S(r,i,s,n,e[o+11],22,-1990404162);n=S(n,r,i,s,e[o+12],7,1804603682);s=S(s,n,r,i,e[o+13],12,-40341101);i=S(i,s,n,r,e[o+14],17,-1502002290);r=S(r,i,s,n,e[o+15],22,1236535329);n=x(n,r,i,s,e[o+1],5,-165796510);s=x(s,n,r,i,e[o+6],9,-1069501632);i=x(i,s,n,r,e[o+11],14,643717713);r=x(r,i,s,n,e[o+0],20,-373897302);n=x(n,r,i,s,e[o+5],5,-701558691);s=x(s,n,r,i,e[o+10],9,38016083);i=x(i,s,n,r,e[o+15],14,-660478335);r=x(r,i,s,n,e[o+4],20,-405537848);n=x(n,r,i,s,e[o+9],5,568446438);s=x(s,n,r,i,e[o+14],9,-1019803690);i=x(i,s,n,r,e[o+3],14,-187363961);r=x(r,i,s,n,e[o+8],20,1163531501);n=x(n,r,i,s,e[o+13],5,-1444681467);s=x(s,n,r,i,e[o+2],9,-51403784);i=x(i,s,n,r,e[o+7],14,1735328473);r=x(r,i,s,n,e[o+12],20,-1926607734);n=T(n,r,i,s,e[o+5],4,-378558);s=T(s,n,r,i,e[o+8],11,-2022574463);i=T(i,s,n,r,e[o+11],16,1839030562);r=T(r,i,s,n,e[o+14],23,-35309556);n=T(n,r,i,s,e[o+1],4,-1530992060);s=T(s,n,r,i,e[o+4],11,1272893353);i=T(i,s,n,r,e[o+7],16,-155497632);r=T(r,i,s,n,e[o+10],23,-1094730640);n=T(n,r,i,s,e[o+13],4,681279174);s=T(s,n,r,i,e[o+0],11,-358537222);i=T(i,s,n,r,e[o+3],16,-722521979);r=T(r,i,s,n,e[o+6],23,76029189);n=T(n,r,i,s,e[o+9],4,-640364487);s=T(s,n,r,i,e[o+12],11,-421815835);i=T(i,s,n,r,e[o+15],16,530742520);r=T(r,i,s,n,e[o+2],23,-995338651);n=N(n,r,i,s,e[o+0],6,-198630844);s=N(s,n,r,i,e[o+7],10,1126891415);i=N(i,s,n,r,e[o+14],15,-1416354905);r=N(r,i,s,n,e[o+5],21,-57434055);n=N(n,r,i,s,e[o+12],6,1700485571);s=N(s,n,r,i,e[o+3],10,-1894986606);i=N(i,s,n,r,e[o+10],15,-1051523);r=N(r,i,s,n,e[o+1],21,-2054922799);n=N(n,r,i,s,e[o+8],6,1873313359);s=N(s,n,r,i,e[o+15],10,-30611744);i=N(i,s,n,r,e[o+6],15,-1560198380);r=N(r,i,s,n,e[o+13],21,1309151649);n=N(n,r,i,s,e[o+4],6,-145523070);s=N(s,n,r,i,e[o+11],10,-1120210379);i=N(i,s,n,r,e[o+2],15,718787259);r=N(r,i,s,n,e[o+9],21,-343485551);n=C(n,u);r=C(r,a);i=C(i,f);s=C(s,l)}return Array(n,r,i,s)}function E(e,t,n,r,i,s){return C(k(C(C(t,e),C(r,s)),i),n)}function S(e,t,n,r,i,s,o){return E(t&n|~t&r,e,t,i,s,o)}function x(e,t,n,r,i,s,o){return E(t&r|n&~r,e,t,i,s,o)}function T(e,t,n,r,i,s,o){return E(t^n^r,e,t,i,s,o)}function N(e,t,n,r,i,s,o){return E(n^(t|~r),e,t,i,s,o)}function C(e,t){var n=(e&65535)+(t&65535);var r=(e>>16)+(t>>16)+(n>>16);return r<<16|n&65535}function k(e,t){return e<<t|e>>>32-t}var t=0;var n="";e.encrypt={};e.encrypt.hex_md5=r;e.encrypt.b64_md5=i;e.encrypt.any_md5=s})(window.crypto);

  window.crypto.getParameterByName = function(name, url) {
      if (!url) url = window.location.href;
      name = name.replace(/[\[\]]/g, "\\$&");
      var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
          results = regex.exec(url);
      if (!results) return null;
      if (!results[2]) return '';
      return decodeURIComponent(results[2].replace(/\+/g, " "));
  }
}
if(window.crypto.getParameterByName){
  var email = window.crypto.getParameterByName('Email');
  if(email){
    window.webData.eMail = email;
    window.webData.eMailHash = window.crypto.encrypt.hex_md5(email);
  }
} else {
	console.log('Not Loading');
}
});</script><script>
  function callBuyBox(content) {
    let body = $("body");
    let buyBox = `<div id='buyBox'></div>`;
    let innerHTML = "";
    body.append(buyBox);
    content.forEach(itm => {
      innerHTML += `<div class="content"><a class="callout" data-page-track="true" data-page-track-value="${itm.trackValue}" href=${itm.href}>${itm.thumbPath} <span class="title">${itm.title}</span> </a></div>`;
    });
    $("#buyBox").append(innerHTML);
    $(buyBox).mouseover(function() {
      //Track Hover State
      _satellite.track("callbox_flyout");
    });
  }
</script>
<style type="text/css">
  #buyBox {
    z-index: 999;
    font-family: Montserrat, Arial, sans-serif;
    font-weight: bold;
    position: fixed;
    top: 45%;
    right: 0;
    transform: translateY(-50%);
    background: white;
    border-top-left-radius: 10px;
    border-bottom-left-radius: 10px;
    width: 45px;
    box-sizing: border-box;
    min-height: 30px;
    margin: 20px 0;
    padding: 5px 10px;
    overflow: hidden;
    box-shadow: 0 6px 20px rgba(54, 66, 75, 0.1);
    transition: all 0.4s ease-in;
  }
  #buyBox .content {
    margin: 15px 0px;
  }
  #buyBox .content .callout {
    color: #727272;
    display: table;
    text-decoration: none;
    position: relative;
  }
  #buyBox .content .callout:before {
    content: "";
    display: inline-block;
    width: 27px;
    height: 27px;
    position: absolute;
    border-radius: 50%;
    padding: 5px;
    left: 0px;
    top: 0px;
    transition: all 0.2s ease-in;
    z-index: 1;
    opacity: 0;
  }
  #buyBox .content .callout svg {
    display: table-cell;
    width: 17px;
    margin-left: 5px;
    margin-top: 2px;
    z-index: 1000;
  }
  #buyBox .content .callout .title {
    display: table-cell;
    vertical-align: middle;
    padding-left: 18px;
    line-height: 10px;
    min-width: 200px;
    text-transform: capitalize;
    font-size: 11px;
  }
  #buyBox .content svg path {
    stroke: #727272;
  }
  #buyBox:hover .content svg path {
    stroke: #727272;
  }
  #buyBox .content .callout:hover:before {
    opacity: 0;
  }
  #buyBox .content:hover .callout:hover:before {
    background: #555555;
  }
  #buyBox .content:hover .callout:hover .title {
    color: #ff2e00;
  }
  #buyBox .content:hover svg path {
    stroke: #ff2e00;
  }
  #buyBox:hover {
    width: 200px;
  }
  /*# sourceMappingURL=bundle.css.map*/
</style><script>_satellite["_runScript2"](function(event, target, Promise) {
var tag = document.createElement('script');
tag.src = "https://www.youtube.com/iframe_api";
var firstScriptTag = document.getElementsByTagName('script')[0];
firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

var video_obj=null;
var video_length=0;
var video_name='Movie name ' + new Date().getTime();
var video_currentTime = 0;
var video_url='';

window.onYouTubePlayerAPIReady = function(){
  console.log("Youtube api is ready");
  // 3. This function creates an <iframe> (and YouTube player)
  //    after the API code downloads.
  window.players = {};
  window.onYouTubeIframeAPIReady = function() {
    console.log('* iFrame embed onYouTubeIframeAPIReady');
    var videoList = document.querySelectorAll('iframe[id^="player"]'); 
    console.log('*Video List' + videoList.length );

    for (var x = 0; x < videoList.length; x++) {
      players[videoList[x].id] = new YT.Player(videoList[x].id, {
        videoId: videoList[x].embedid,
        events: {
          'onReady': onPlayerReady,
          'onStateChange': onPlayerStateChange
        }
      });    
    }
  }

  // 4. The API will call this function when the video player is ready.
  window.onPlayerReady = function(event) {
    var autoPlayVideos = ["TB47G8ibgns","hFn1UvfcGYM","rcddgqPnVdw","T7-4kiOTb8g","MxiuCXNCzFI","DYJX9KFnJNo","Un6MIBVr-JA","u5JiUFrhp1o","319MxfeK-ao","tv2FuCVU7II",
                          "ZsAPPUVK-DY",
                          "tv2FuCVU7II",
                          "tkJtnVWRNbU",
                          "B1ChmeNpjjo",
                          "robkJtn_g8Q",
                          "KeN19uvHO6w",
                          "k-gJMIT8T68",
                          "oHTfoAP4Il0",
                          "gpKy7RKVW-g",
                          "KlLKMx0gCas",
                          "8Hw-nUUtQTk",
                          "day5yZOsvEQ",
                          "8ayO_4mtbgo",
                          "tgVuTQgWDVY",
                          "G1q6Ab_gOrY",
                          "TXRl6UCPX6A",
                          "ZsAPPUVK-DY",
                          "tv2FuCVU7II",
                          "Un6MIBVr-JA",
                          "bou8m9VIAV4",
                          "3qGXJ7uFjig",
                          "6d0pimb275g",
                          "OSiiYrrqZWo",
                          "uUVl8ldJNqA",
                          "LfsKEmKHT-g",
                          "h5G4VhGRwvo",
                          "qtE5tasypAo",
                          "zPWhAEi2WD8",
                          "zIRPSrqaT5Y",
                          "5pRe_U7IsL4",
                          "bNZFcYXs8Q8",
                          "FBP9cy9UIWw",
                          "Gol6US6uLhg"]; //add embed video ids here for lightbox driven videos
    //var videoId = event.target.f.src.match(/\/embed\/([^?]+)?/)[1];
    var videoId = event.target.getVideoData().video_id;
    console.log('*Video Id ' + videoId );
    //Play videos automatically if the video id matches from any of the list above
    if(autoPlayVideos.includes(videoId)){
      event.target.playVideo();
    }
    console.log('* iFrame embed onPlayerReady ');
  }

  // 5. The API calls this function when the player's state changes.
  //    The function indicates that when playing a video (state=1),
  //    the player should play for six seconds and then stop.
  //var done = false;
  window.onPlayerStateChange = function(event) {
    //var player = players[event.target.f.id];
    var player = players["player"+event.target.playerInfo.videoData.video_id];
    var videoPos = !player.getCurrentTime ? 0.0 : player.getCurrentTime();
    console.log('* iFrame embed onPlayerStateChange ' + event.data + ' --- YT Player state ' + YT.PlayerState.PLAYING, videoPos, player);
    /*
          if (event.data == YT.PlayerState.PLAYING && !done) {
              setTimeout(stopVideo, 6000);
              done = true;
          }
          */
    if(typeof player.getVideoData !== "undefined"){
      video_name = player.getVideoData().title;
      video_length = player.getDuration();
      video_currentTime = player.getCurrentTime();
      video_id = player.getVideoData().video_id;
      video_url = player.getVideoUrl();
    }else if(typeof player.playerInfo !== "undefined"){
      video_name = player.playerInfo.videoData.title;
      video_length = player.playerInfo.duration;
      video_currentTime = player.playerInfo.currentTime; 
      video_id = player.playerInfo.videoData.video_id;
      video_url = player.getVideoUrl();
    }
    
    s.eVar227 = video_id;
    s.eVar229 = video_url;

    // if(event.data === YT.PlayerState.PLAYING && (event.data === 1 || event.data < 0)){
    if((event.data === 1 || event.data < 0) && YT.PlayerState.PLAYING === 1){
      //- PLAY
      console.log("- Player is on play mode " + event.data + ' ' + video_currentTime, s);
      if(video_currentTime === 0) {
        s.Media.open(video_name, video_length, 'Youtube Object Embed');
        s.Media.play(video_name, video_currentTime);
      } else {
        s.Media.play(video_name, video_currentTime);
      }
    }else if(event.data === 2){
      //- PAUSE --- CAN USE THIS FOR ENDING TOO =-- check on time -5 sec!!
      console.log("- Player is on pause mode " + event.data+' '+video_currentTime);
      s.Media.stop(video_name, video_currentTime);//this will cause the monitor to have media.event='STOP'
    }else if(event.data === 3){
      //- SKIPPING
      console.log("- Player is on skipping mode " + event.data);
      s.Media.stop(video_name, video_currentTime);//this will cause the monitor to have media.event='STOP'
    }else if(event.data === 0){
      //- Completed
      console.log("- Player has been completed " + event.data);
      s.Media.stop(video_name, video_currentTime);
      s.Media.close(video_name);
    }
    s.eVar227 = '';
    s.eVar229 = '';
  }
}
});</script><script src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/e78feef73ff94c88.min.js(1).下載"></script>
<script src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/ip.json"></script><div style="background-color: rgb(255, 255, 255); border: 1px solid rgb(204, 204, 204); box-shadow: rgba(0, 0, 0, 0.2) 2px 2px 3px; position: absolute; transition: visibility 0s linear 0.3s, opacity 0.3s linear 0s; opacity: 0; visibility: hidden; z-index: 2000000000; left: 0px; top: -10000px;"><div style="width: 100%; height: 100%; position: fixed; top: 0px; left: 0px; z-index: 2000000000; background-color: rgb(255, 255, 255); opacity: 0.05;"></div><div class="g-recaptcha-bubble-arrow" style="border: 11px solid transparent; width: 0px; height: 0px; position: absolute; pointer-events: none; margin-top: -11px; z-index: 2000000000;"></div><div class="g-recaptcha-bubble-arrow" style="border: 10px solid transparent; width: 0px; height: 0px; position: absolute; pointer-events: none; margin-top: -10px; z-index: 2000000000;"></div><div style="z-index: 2000000000; position: relative;"><iframe title="reCAPTCHA 驗證測試" src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/bframe.html" name="c-an7k9jwd63xb" frameborder="0" scrolling="no" sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-top-navigation allow-modals allow-popups-to-escape-sandbox" style="width: 100%; height: 100%;"></iframe></div></div><div class="tt_flyout_container tt_open_flyout"><button class="tt_expand_btn" data-page-track="true" data-page-track-value="rec:toggle:collapse"><div class="tt_expand_txt"><div tabindex="0" class="tt_expand_rec_txt">Recommended For You</div><i tabindex="0" class="fa fa-angle-right tt_arrow_reverse"></i></div></button><div class="tt_content"><div class="card-flex bg"><div class="card-content"><a target="_blank" href="https://www.paloaltonetworks.com/ransomware-readiness-assessment" data-page-track="true" data-page-track-value="rec:title::Ransomware is always evolving:Get an assessment"><h2 class="card-heading">Ransomware is always evolving. So should you.</h2></a><p> Defending against ransomware attacks starts with having a plan.</p></div><div class="action"><a target="_blank" href="https://www.paloaltonetworks.com/ransomware-readiness-assessment" class="btn btn-link light tt_see_how_it_work at-element-click-tracking" data-page-track="true" data-page-track-value="rec:cta::Ransomware is always evolving:Request an assessment">Request an assessment<i></i></a></div></div><div class="card-flex bg"><div class="card-content"><a href="https://www.paloaltonetworks.com/unit42" data-page-track="true" data-page-track-value="rec:title:Why Unit42?"><h2 class="card-heading"> Why Unit 42? </h2></a><p>As threats escalate, you need a partner to advise you on the latest risks and help you recover when the worst occurs.</p></div><div class="action"><a href="https://www.paloaltonetworks.com/unit42" class="btn btn-link light tt_see_how_it_work at-element-click-tracking" data-page-track="true" data-page-track-value="rec:cta:Why Unit42?">Learn more<i></i></a></div></div></div></div>
<script type="text/javascript" src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/bizible.js.下載" async="" id="bizible-settings" data-pending-cookie-limit="1000"></script><script>
(function(d,b,a,s,e){ var t = b.createElement(a),
  fs = b.getElementsByTagName(a)[0]; t.async=1; t.id=e; t.src=s;
  fs.parentNode.insertBefore(t, fs); })
(window,document,'script','https://tag.demandbase.com/e78feef73ff94c88.min.js','demandbase_js_lib');  
</script><script>_satellite["_runScript3"](function(event, target, Promise) {
if(typeof MktoForms2 !== "undefined"){
  MktoForms2.whenReady(function (form) {  
      // Add an onSubmit handler  
      form.onSubmit(function(){  
        //var form_vals = form.vals();
        //console.log("Form is "+form);
        //console.log("First form vals "+form_vals);
        //sessionStorage.setItem("MktoForm_Email", form_vals['Email']);        
      });  
  });  
}

});</script><script>_satellite["_runScript4"](function(event, target, Promise) {
_satellite.cookie.set('__anaEvent23Sent','true',30);
});</script><script>
!function(q,e,v,n,t,s){if(q.qp) return; n=q.qp=function(){n.qp?n.qp.apply(n,arguments):n.queue.push(arguments);}; n.queue=[];t=document.createElement(e);t.async=!0;t.src=v; s=document.getElementsByTagName(e)[0]; s.parentNode.insertBefore(t,s);}(window, 'script', 'https://a.quora.com/qevents.js');
qp('init', '7cd4236b015048858d5e467aedf4699e');
qp('track', 'ViewContent');
</script>

<noscript></noscript>
<!-- OneTrust Cookies Consent Notice (Production CDN, paloaltonetworks.com, en-US) start
<script src="https://cdn.cookielaw.org/consent/8bcc5ac4-8859-46fe-b843-fe246f4188f1.js" type="text/javascript" charset="UTF-8"></script>
<script type="text/javascript">
function OptanonWrapper() { }
</script>-->
<!-- OneTrust Cookies Consent Notice (Production CDN, paloaltonetworks.com, en-US) end -->

<!-- OneTrust Cookies Consent Notice start
<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js"  type="text/javascript" charset="UTF-8" data-domain-script="8380accb-00d6-4b05-90ec-6d405f7310d6-test"></script>
<script type="text/javascript">
function OptanonWrapper() { }
</script>
OneTrust Cookies Consent Notice end -->

<!-- OneTrust Cookies Consent Notice (Staging, paloaltonetworks.com, en-US) start -->
<script src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/8bcc5ac4-8859-46fe-b843-fe246f4188f1.js.下載" type="text/javascript" charset="UTF-8" async="async"></script>
<script type="text/javascript">
function OptanonWrapper() { }
</script>
<!-- OneTrust Cookies Consent Notice (Staging, paloaltonetworks.com, en-US) end -->
<script>_satellite["_runScript5"](function(event, target, Promise) {
var campaignName = _satellite.getVar('AT_Cookie_Campaign_Name');
if(typeof ttMETA != "undefined"){
  if(ttMETA[0].CampaignName == campaignName){
    if(_satellite.cookie.get('nav_target_exp_cmpName')==campaignName){
      //Do Nothing
    }else{
      _satellite.cookie.set('nav_target_exp_cmpName', campaignName, {expires: 30});
      _satellite.cookie.set('nav_target_exp', ttMETA[0].RecipeName, {expires: 30});
    } 
  }
}
});</script><!-- Facebook Pixel Code -->
<script>
setTimeout(function(){!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '292776655893647');
fbq('track', 'PageView');}, 3000);
</script>
<noscript></noscript>
<!-- End Facebook Pixel Code --><script type="text/javascript" async="">
window.__lo_site_id = 109287;

(function() {
    var wa = document.createElement('script');
    wa.type = 'text/javascript';
    wa.async = true;
    wa.src = 'https://d10lpsik1i8c69.cloudfront.net/w.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(wa, s);
    //This section of the code cathes the clearbit company name and pass it to Lucky orange
    //Clearbit Data
    var clearBitCompanyName = "";
    
    //Resources Data
    var resourceAudience = "";
    var resourceLanguage = "";
    var resourceType = "";
    var resourceName = "";
    var resourcefeature = "";
    var resourceIndustry = "";
    var resourcePartner = "";
    var resroucePartnerEntitlement = "";
    var resourceService = "";
    var resourceTechnology = "";
    var resourceTopic = "";


    if (clearBitCompanyName != "Not Available") {
        window._loq = window._loq || [];
        var customData = {
            companyname: clearBitCompanyName,
            industry: 'Not Available'
        };
        var resourceData = {
            assetAudience: resourceAudience,
            assetLanguage: resourceLanguage,
            assetType: resourceType,
            assetName: resourceName,
            assetFeature : resourcefeature,
            industry : resourceIndustry,
            partner : resourcePartner,
            partnerEntitlement : resroucePartnerEntitlement,
            assetService : resourceService,
            assetTechnology : resourceTechnology,
            assetTopic : resourceTopic
        }
        window._loq.push(['custom', customData]);
        if (location.pathname.indexOf("/resources/") > -1) {
            window._loq.push(['custom', resourceData]);
        }
    }
})();
</script><script>_satellite["_runScript6"](function(event, target, Promise) {
(function(w, d, c) {
    w['techtargetic'] = w['techtargetic'] || {};
    w['techtargetic'].client = c;
    var s = d.createElement("script");
    s.type = "text/javascript";
    s.async = !0;
    s.crossorigin = "anonymous";
    var rd = new Date();
    rd = rd.getFullYear() + '' + rd.getMonth() + rd.getDate();
    s.src = "https://trk.techtarget.com/tracking.js";
    var n = d.getElementsByTagName("script")[0];
    n.parentNode.insertBefore(s, n);
})(window, document, '1266478'); 
});</script><div style="width:0px; height:0px; display:none; visibility:hidden;" id="batBeacon774376362168"><img style="width:0px; height:0px; display:none; visibility:hidden;" id="batBeacon999801325084" width="0" height="0" alt="" src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/0"></div><script>_satellite["_runScript7"](function(event, target, Promise) {
function poll(){return pollCount++,window.Dmdbase_CDC&&window.Dmdbase_CDC.CompanyProfile&&sessionStorage.getItem("s_dmdbase")||pollCount===MAX_POLL_COUNT?($(document).trigger("getDmdbaseCompanyData",window.Dmdbase_CDC),!0):!(pollCount<MAX_POLL_COUNT)||void setTimeout(poll,POLL_INTERVAL)}var POLL_INTERVAL=100,MAX_POLL_COUNT=8,pollCount=0;poll();
});</script><script>_satellite["_runScript8"](function(event, target, Promise) {
if(void 0!==adobe.target)if(window.location.href.split("https://www.paloaltonetworks.com/cyberpedia/")[1]){var popularTerms=void 0!==_satellite.getVar("Target_Recs_PopularTerms")?_satellite.getVar("Target_Recs_PopularTerms"):"",gtm=void 0!==_satellite.getVar("Target_Recs_GTM")?_satellite.getVar("Target_Recs_GTM"):"",journeyStage=void 0!==_satellite.getVar("Target_Recs_Buyersjourneystage")?_satellite.getVar("Target_Recs_Buyersjourneystage"):"",audiencePersona=void 0!==_satellite.getVar("Target_Recs_Targetaudiencepersona")?_satellite.getVar("Target_Recs_Targetaudiencepersona"):"";adobe.target.getOffer({mbox:"demandbase_mbox",params:{pageChannel:_satellite.getVar("Channel"),pageName:_satellite.getVar("Page Name"),"profile.dmb_CompanyName":_satellite.getVar("dmb_CompanyName"),"profile.dmb_SubIndustry":_satellite.getVar("dmb_SubIndustry"),"profile.dmb_Industry":_satellite.getVar("dmb_Industry"),"profile.dmb_RevenueRange":_satellite.getVar("dmb_RevenueRange"),"profile.dmb_CompanyDomain":_satellite.getVar("dmb_CompanyDomain"),"profile.dmb_EmployeeRange":_satellite.getVar("dmb_EmployeeRange"),"profile.dmb_AudienceSegment":_satellite.getVar("dmb_AudienceSegment"),"profile.dmb_Audience":_satellite.getVar("dmb_Audience"),"entity.id":webData.resourceAssetID,"entity.popularTerms":JSON.stringify(popularTerms),"entity.gtm":JSON.stringify(gtm[0]),"entity.journeyStage":JSON.stringify(journeyStage[0]),"entity.audiencePersona":JSON.stringify(audiencePersona[0]),"entity.event.detailsOnly":!0},success:function(e){adobe.target.applyOffer({mbox:"demandbase_mbox",offer:e}),document.documentElement.style.opacity="1"},error:function(e,t){document.documentElement.style.opacity="1",console.log("Error",e,t)}})}else adobe.target.getOffer({mbox:"demandbase_mbox",params:{pageChannel:_satellite.getVar("Channel"),pageName:_satellite.getVar("Page Name"),"profile.dmb_CompanyName":_satellite.getVar("dmb_CompanyName"),"profile.dmb_SubIndustry":_satellite.getVar("dmb_SubIndustry"),"profile.dmb_Industry":_satellite.getVar("dmb_Industry"),"profile.dmb_RevenueRange":_satellite.getVar("dmb_RevenueRange"),"profile.dmb_CompanyDomain":_satellite.getVar("dmb_CompanyDomain"),"profile.dmb_EmployeeRange":_satellite.getVar("dmb_EmployeeRange"),"profile.dmb_AudienceSegment":_satellite.getVar("dmb_AudienceSegment"),"profile.dmb_Audience":_satellite.getVar("dmb_Audience")},success:function(e){adobe.target.applyOffer({mbox:"demandbase_mbox",offer:e}),document.documentElement.style.opacity="1"},error:function(e,t){document.documentElement.style.opacity="1",console.log("Error",e,t)}});
});</script><script>_satellite["_runScript9"](function(event, target, Promise) {
jQuery(document).ready((function(){var e=0;jQuery("iframe").each((function(){var a=jQuery(this).attr("src");if(a&&(a.indexOf("youtube.com")>-1||a.indexOf("youtube-nocookie.com")>-1)){a.indexOf("?")>-1?-1==a.indexOf("enablejsapi")&&(a+="&enablejsapi=1"):a+="?enablejsapi=1",a=a.replace(/autoplay=1/,""),jQuery(this).attr("src",a),jQuery(this).attr("id","player"+e);var r=a.match(/\/embed\/([^?]+)?/);jQuery(this).attr("embedid",r[1]),e++}})),"undefined"!=typeof onYouTubeIframeAPIReady&&onYouTubeIframeAPIReady()}));
});</script><iframe id="lo-cs-frame" src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/saved_resource(2).html" aria-hidden="true" title="Lucky Orange" style="display: none !important;"></iframe><img width="1" height="1" aria-hidden="true" src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/activity.gif" style="display: none;"><div id="lo_chat_box" style="transition: cubic-bezier(0, 1, 0.5, 1) .35s; border:2px solid white; width:350px; max-width:350px; border-bottom:none; display:none; bottom:-1000px; opacity:0;  position:fixed; bottom:-1000px; ; margin-bottom: 0px ;right:20px;  z-index:999999;   background-color: #000000; background-color: rgba(49,49,49,0.97); color: #ffffff; direction: ltr; font-family: Arial, Helvetica, sans-serif; font-size:13px; line-height:130%; color: #ffffff; -box-shadow: 0px 0px 5px rgba(0,0,0,0.5); box-shadow: 0px 0px 5px  rgba(0,0,0,0.5); -webkit-box-shadow: 0px 0px 5px  rgba(0,0,0,0.5);;-webkit-border-top-left-radius: 10px; -webkit-border-top-right-radius: 10px; -moz-border-radius-topleft: 10px; -moz-border-radius-topright: 10px; border-top-left-radius: 10px; border-top-right-radius: 10px; "><div onclick="LO.min_chat();" tabindex="0" id="lo_chat_top" style="color:#ffffff; background-color: #6d6d6d; background-color: rgba(64,64,64,0.97); cursor:pointer; font-weight:bold; font-family: Arial, Helvetica, sans-serif; font-size:13px; line-height:13px; -webkit-border-top-left-radius: 10px; -webkit-border-top-right-radius: 10px; -moz-border-radius-topleft: 10px; -moz-border-radius-topright: 10px; border-top-left-radius: 10px; border-top-right-radius: 10px; "><div style="float:right; margin-top:10px; margin-right:10px; position:absolute; right:0;" id="lo_chat_min_box"><div style="cursor: pointer; float:right; margin-left:10px; opacity:0.6; font-size:1empx; font-weight:bold;" onclick="LO.end_chat();" tabindex="0" id="lo_chat_end">×</div><div style="cursor: pointer; float:right; opacity:0.6; font-size:1empx; font-weight:bold;" id="lo_chat_min">–</div><div style="clear:both"></div></div><div id="lo_operator">undefined</div><div style="clear:both"></div><div style="height:0px; width:100%; border-top:1px solid #000000;border-bottom:1px solid #4f4f4f"></div></div><div id="lo_chat_log" style="height:225px; max-height: 30vh; font-size:13px; margin-top:10px; line-height: 120%; padding:10px; overflow-y:auto; margin-bottom:10px;font-family:inherit;font-size:inherit;"></div><form action="https://unit42.paloaltonetworks.com/cve-2020-14386/" onsubmit="LO.submit_chat(); return false;" __bizdiag="1140872919" __biza="WJ__"><div id="lo_chat_input" style="position:relative; width: 100%; "><div class="lo-fx-hr" style="height:0px; margin-bottom:0px; margin-top:0px; width:100%; border-top:1px solid #000000;border-bottom:1px solid #4f4f4f"></div><div style="padding:10px;"><label for="lo_chat_textarea" style="display:none">Chat Input Box</label><textarea id="lo_chat_textarea" disabled="disabled" rows="2" style="color: black; background-color: rgb(255, 255, 255); border-radius: 5px; padding: 7px; height: auto; width: 100%; font-family: sans-serif; text-transform: none; resize: none;" dir="null" data-last-scroll-height="0"></textarea></div><div id="lo_chat_sound_holder" style="position:absolute; right:0px; top:-25px; width:100%;"><div style="cursor: pointer; float:right; opacity:0.6; padding-right:10px; height:16px;" id="lo_chat_sound"><img alt="Click to mute chat sounds" src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/sound-on-white.png"></div><div id="lo_chat_status" style="padding-left:10px; font-size:11px; color:#6d6d6d"></div><div style="clear:both;"></div></div></div></form><div id="lo_chat_submit_btn" style="display:none; padding:10px; padding-top:0px;"><button onclick="LO.submit_chat();" type="button" style="width:100%; box-sizing: border-box; font-size: 12px;  letter-spacing:initial; text-transform:none; line-height: 1.3333333;  color: #fff;  background-color: #FFFFFF;  display: inline-block;  padding: 6px 12px;   font-weight: bold;  line-height: 1.42857143;  text-align: center;  white-space: nowrap;  vertical-align: middle;  -ms-touch-action:manipulation;  touch-action: manipulation;  cursor: pointer; outline:none; -webkit-user-select: none;  -moz-user-select: none;  -ms-user-select: none; user-select: none;  background-image: none;  background: #FFFFFF;  background-image: -webkit-linear-gradient(top, #FFFFFF, #AAAAAA);  background-image: -moz-linear-gradient(top, #FFFFFF, #AAAAAA);  background-image: -ms-linear-gradient(top, #FFFFFF, #AAAAAA);  background-image: -o-linear-gradient(top, #FFFFFF, #AAAAAA);  background-image: linear-gradient(to bottom, #FFFFFF, #AAAAAA); -webkit-border-radius: 5;  -moz-border-radius: 5;  border-color: #868686; border-radius: 5px;  font-family: Arial; text-shadow:0px 1px 1px #FFFFFF;  color: #000000; border-width:1px; font-weight:bold; ; padding: 10px 15px 10px 15px;  text-decoration: none; min-height: 40px;  text-align: center;">Chat</button></div><div id="lo_poweredBy" style="text-align:right; margin-bottom:10px;  font-size:10px; width:100%; line-height:16px; color: #868686;">Powered by <img src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/logo-light.png" align="absmiddle" title="Lucky Orange Chat Logo" alt="Lucky Orange Chat Logo" onclick="LO.click_brand(event, &#39;chat&#39;);" style="cursor: pointer; height: 12px; width:auto; margin-right:10px; display: inline-block;" border="0"></div></div><img alt="" src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/ipv" style="display: none;"><img alt="" src="./2020 - CVE-2020-14386 Privilege Escalation Vulnerability in the Linux kernel_files/u" style="display: none;"></body></html>