<!DOCTYPE html>
<!-- saved from url=(0071)https://blog.cr0.org/2009/08/linux-null-pointer-dereference-due-to.html -->
<html class="v2" dir="ltr" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link href="./2009 - Linux NULL pointer dereference due to incorrect proto_ops initializations (CVE-2009-2692)_files/1529571102-css_bundle_v2.css" rel="stylesheet" type="text/css">
<meta content="width=1100" name="viewport">

<meta content="blogger" name="generator">
<link href="https://blog.cr0.org/favicon.ico" rel="icon" type="image/x-icon">
<link href="https://blog.cr0.org/2009/08/linux-null-pointer-dereference-due-to.html" rel="canonical">
<link rel="alternate" type="application/atom+xml" title="cr0 blog - Atom" href="https://blog.cr0.org/feeds/posts/default">
<link rel="alternate" type="application/rss+xml" title="cr0 blog - RSS" href="https://blog.cr0.org/feeds/posts/default?alt=rss">
<link rel="service.post" type="application/atom+xml" title="cr0 blog - Atom" href="https://www.blogger.com/feeds/8992811497323121233/posts/default">

<link rel="alternate" type="application/atom+xml" title="cr0 blog - Atom" href="https://blog.cr0.org/feeds/4884559622868011417/comments/default">
<!--[if IE]><script type="text/javascript" src="https://www.blogger.com/static/v1/jsbin/1155466832-ieretrofit.js"></script>
<![endif]-->
<meta content="https://blog.cr0.org/2009/08/linux-null-pointer-dereference-due-to.html" property="og:url">
<meta content="Linux NULL pointer dereference due to incorrect proto_ops initializations (CVE-2009-2692)" property="og:title">
<meta content="EDIT2: Here  is RedHat&#39;s official mitigation recommendation  EDIT3: Brad Spengler  also wrote an exploit for this and published it . The bug..." property="og:description">
<!--[if IE]> <script> (function() { var html5 = ("abbr,article,aside,audio,canvas,datalist,details," + "figure,footer,header,hgroup,mark,menu,meter,nav,output," + "progress,section,time,video").split(','); for (var i = 0; i < html5.length; i++) { document.createElement(html5[i]); } try { document.execCommand('BackgroundImageCache', false, true); } catch(e) {} })(); </script> <![endif]-->
<title>cr0 blog: Linux NULL pointer dereference due to incorrect proto_ops initializations (CVE-2009-2692)</title>
<style id="page-skin-1" type="text/css"><!--
/*
-----------------------------------------------
Blogger Template Style
Name:     Simple
Designer: Blogger
URL:      www.blogger.com
----------------------------------------------- */
/* Content
----------------------------------------------- */
body {
font: normal normal 12px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #cccccc;
background: #292929 none repeat scroll top left;
padding: 0 40px 40px 40px;
}
html body .region-inner {
min-width: 0;
max-width: 100%;
width: auto;
}
h2 {
font-size: 22px;
}
a:link {
text-decoration:none;
color: #dd7700;
}
a:visited {
text-decoration:none;
color: #cc6600;
}
a:hover {
text-decoration:underline;
color: #cc6600;
}
.body-fauxcolumn-outer .fauxcolumn-inner {
background: transparent none repeat scroll top left;
_background-image: none;
}
.body-fauxcolumn-outer .cap-top {
position: absolute;
z-index: 1;
height: 400px;
width: 100%;
}
.body-fauxcolumn-outer .cap-top .cap-left {
width: 100%;
background: transparent none repeat-x scroll top left;
_background-image: none;
}
.content-outer {
-moz-box-shadow: 0 0 40px rgba(0, 0, 0, .15);
-webkit-box-shadow: 0 0 5px rgba(0, 0, 0, .15);
-goog-ms-box-shadow: 0 0 10px #333333;
box-shadow: 0 0 40px rgba(0, 0, 0, .15);
margin-bottom: 1px;
}
.content-inner {
padding: 10px 10px;
}
.content-inner {
background-color: #333333;
}
/* Header
----------------------------------------------- */
.header-outer {
background: transparent none repeat-x scroll 0 -400px;
_background-image: none;
}
.Header h1 {
font: normal normal 60px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #ffffff;
text-shadow: -1px -1px 1px rgba(0, 0, 0, .2);
}
.Header h1 a {
color: #ffffff;
}
.Header .description {
font-size: 140%;
color: #aaaaaa;
}
.header-inner .Header .titlewrapper {
padding: 22px 30px;
}
.header-inner .Header .descriptionwrapper {
padding: 0 30px;
}
/* Tabs
----------------------------------------------- */
.tabs-inner .section:first-child {
border-top: 1px solid #404040;
}
.tabs-inner .section:first-child ul {
margin-top: -1px;
border-top: 1px solid #404040;
border-left: 0 solid #404040;
border-right: 0 solid #404040;
}
.tabs-inner .widget ul {
background: #222222 none repeat-x scroll 0 -800px;
_background-image: none;
border-bottom: 1px solid #404040;
margin-top: 0;
margin-left: -30px;
margin-right: -30px;
}
.tabs-inner .widget li a {
display: inline-block;
padding: .6em 1em;
font: normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #999999;
border-left: 1px solid #333333;
border-right: 0 solid #404040;
}
.tabs-inner .widget li:first-child a {
border-left: none;
}
.tabs-inner .widget li.selected a, .tabs-inner .widget li a:hover {
color: #ffffff;
background-color: #000000;
text-decoration: none;
}
/* Columns
----------------------------------------------- */
.main-outer {
border-top: 0 solid #404040;
}
.fauxcolumn-left-outer .fauxcolumn-inner {
border-right: 1px solid #404040;
}
.fauxcolumn-right-outer .fauxcolumn-inner {
border-left: 1px solid #404040;
}
/* Headings
----------------------------------------------- */
div.widget > h2,
div.widget h2.title {
margin: 0 0 1em 0;
font: normal bold 11px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #ffffff;
}
/* Widgets
----------------------------------------------- */
.widget .zippy {
color: #999999;
text-shadow: 2px 2px 1px rgba(0, 0, 0, .1);
}
.widget .popular-posts ul {
list-style: none;
}
/* Posts
----------------------------------------------- */
h2.date-header {
font: normal bold 11px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
}
.date-header span {
background-color: transparent;
color: #cccccc;
padding: inherit;
letter-spacing: inherit;
margin: inherit;
}
.main-inner {
padding-top: 30px;
padding-bottom: 30px;
}
.main-inner .column-center-inner {
padding: 0 15px;
}
.main-inner .column-center-inner .section {
margin: 0 15px;
}
.post {
margin: 0 0 25px 0;
}
h3.post-title, .comments h4 {
font: normal normal 22px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
margin: .75em 0 0;
}
.post-body {
font-size: 110%;
line-height: 1.4;
position: relative;
}
.post-body img, .post-body .tr-caption-container, .Profile img, .Image img,
.BlogList .item-thumbnail img {
padding: 0;
background: #111111;
border: 1px solid #111111;
-moz-box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
-webkit-box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
}
.post-body img, .post-body .tr-caption-container {
padding: 1px;
}
.post-body .tr-caption-container {
color: #cccccc;
}
.post-body .tr-caption-container img {
padding: 0;
background: transparent;
border: none;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .1);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .1);
box-shadow: 0 0 0 rgba(0, 0, 0, .1);
}
.post-header {
margin: 0 0 1.5em;
line-height: 1.6;
font-size: 90%;
}
.post-footer {
margin: 20px -2px 0;
padding: 5px 10px;
color: #888888;
background-color: #303030;
border-bottom: 1px solid #444444;
line-height: 1.6;
font-size: 90%;
}
#comments .comment-author {
padding-top: 1.5em;
border-top: 1px solid #404040;
background-position: 0 1.5em;
}
#comments .comment-author:first-child {
padding-top: 0;
border-top: none;
}
.avatar-image-container {
margin: .2em 0 0;
}
#comments .avatar-image-container img {
border: 1px solid #111111;
}
/* Comments
----------------------------------------------- */
.comments .comments-content .icon.blog-author {
background-repeat: no-repeat;
background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEgAACxIB0t1+/AAAAAd0SU1FB9sLFwMeCjjhcOMAAAD+SURBVDjLtZSvTgNBEIe/WRRnm3U8RC1neQdsm1zSBIU9VVF1FkUguQQsD9ITmD7ECZIJSE4OZo9stoVjC/zc7ky+zH9hXwVwDpTAWWLrgS3QAe8AZgaAJI5zYAmc8r0G4AHYHQKVwII8PZrZFsBFkeRCABYiMh9BRUhnSkPTNCtVXYXURi1FpBDgArj8QU1eVXUzfnjv7yP7kwu1mYrkWlU33vs1QNu2qU8pwN0UpKoqokjWwCztrMuBhEhmh8bD5UDqur75asbcX0BGUB9/HAMB+r32hznJgXy2v0sGLBcyAJ1EK3LFcbo1s91JeLwAbwGYu7TP/3ZGfnXYPgAVNngtqatUNgAAAABJRU5ErkJggg==);
}
.comments .comments-content .loadmore a {
border-top: 1px solid #999999;
border-bottom: 1px solid #999999;
}
.comments .comment-thread.inline-thread {
background-color: #303030;
}
.comments .continue {
border-top: 2px solid #999999;
}
/* Accents
---------------------------------------------- */
.section-columns td.columns-cell {
border-left: 1px solid #404040;
}
.blog-pager {
background: transparent none no-repeat scroll top center;
}
.blog-pager-older-link, .home-link,
.blog-pager-newer-link {
background-color: #333333;
padding: 5px;
}
.footer-outer {
border-top: 0 dashed #bbbbbb;
}
/* Mobile
----------------------------------------------- */
body.mobile  {
background-size: auto;
}
.mobile .body-fauxcolumn-outer {
background: transparent none repeat scroll top left;
}
.mobile .body-fauxcolumn-outer .cap-top {
background-size: 100% auto;
}
.mobile .content-outer {
-webkit-box-shadow: 0 0 3px rgba(0, 0, 0, .15);
box-shadow: 0 0 3px rgba(0, 0, 0, .15);
}
.mobile .tabs-inner .widget ul {
margin-left: 0;
margin-right: 0;
}
.mobile .post {
margin: 0;
}
.mobile .main-inner .column-center-inner .section {
margin: 0;
}
.mobile .date-header span {
padding: 0.1em 10px;
margin: 0 -10px;
}
.mobile h3.post-title {
margin: 0;
}
.mobile .blog-pager {
background: transparent none no-repeat scroll top center;
}
.mobile .footer-outer {
border-top: none;
}
.mobile .main-inner, .mobile .footer-inner {
background-color: #333333;
}
.mobile-index-contents {
color: #cccccc;
}
.mobile-link-button {
background-color: #dd7700;
}
.mobile-link-button a:link, .mobile-link-button a:visited {
color: #ffffff;
}
.mobile .tabs-inner .section:first-child {
border-top: none;
}
.mobile .tabs-inner .PageList .widget-content {
background-color: #000000;
color: #ffffff;
border-top: 1px solid #404040;
border-bottom: 1px solid #404040;
}
.mobile .tabs-inner .PageList .widget-content .pagelist-arrow {
border-left: 1px solid #404040;
}

--></style>
<style id="template-skin-1" type="text/css"><!--
body {
min-width: 960px;
}
.content-outer, .content-fauxcolumn-outer, .region-inner {
min-width: 960px;
max-width: 960px;
_width: 960px;
}
.main-inner .columns {
padding-left: 0;
padding-right: 310px;
}
.main-inner .fauxcolumn-center-outer {
left: 0;
right: 310px;
/* IE6 does not respect left and right together */
_width: expression(this.parentNode.offsetWidth -
parseInt("0") -
parseInt("310px") + 'px');
}
.main-inner .fauxcolumn-left-outer {
width: 0;
}
.main-inner .fauxcolumn-right-outer {
width: 310px;
}
.main-inner .column-left-outer {
width: 0;
right: 100%;
margin-left: -0;
}
.main-inner .column-right-outer {
width: 310px;
margin-right: -310px;
}
#layout {
min-width: 0;
}
#layout .content-outer {
min-width: 0;
width: 800px;
}
#layout .region-inner {
min-width: 0;
width: auto;
}
body#layout div.add_widget {
padding: 8px;
}
body#layout div.add_widget a {
margin-left: 32px;
}
--></style>
<link href="./2009 - Linux NULL pointer dereference due to incorrect proto_ops initializations (CVE-2009-2692)_files/authorization.css" media="all" onload="if(media!=&#39;all&#39;)media=&#39;all&#39;" rel="stylesheet"><noscript><link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=8992811497323121233&amp;zx=bec4f5f9-5299-4aaf-b7e1-68de97c1f169' rel='stylesheet'/></noscript>
<meta name="google-adsense-platform-account" content="ca-host-pub-1556223355139109">
<meta name="google-adsense-platform-domain" content="blogspot.com">

</head>
<body class=" variant-dark">
<div class="navbar no-items section" id="navbar" name="Navbar">
</div>
<div class="body-fauxcolumns">
<div class="fauxcolumn-outer body-fauxcolumn-outer">
<div class="cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left">
<div class="fauxborder-right"></div>
<div class="fauxcolumn-inner">
</div>
</div>
<div class="cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
</div>
<div class="content">
<div class="content-fauxcolumns">
<div class="fauxcolumn-outer content-fauxcolumn-outer">
<div class="cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left">
<div class="fauxborder-right"></div>
<div class="fauxcolumn-inner">
</div>
</div>
<div class="cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
</div>
<div class="content-outer">
<div class="content-cap-top cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left content-fauxborder-left">
<div class="fauxborder-right content-fauxborder-right"></div>
<div class="content-inner">
<header>
<div class="header-outer">
<div class="header-cap-top cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left header-fauxborder-left">
<div class="fauxborder-right header-fauxborder-right"></div>
<div class="region-inner header-inner">
<div class="header section" id="header" name="Header"><div class="widget Header" data-version="1" id="Header1">
<div id="header-inner">
<div class="titlewrapper">
<h1 class="title">
<a href="https://blog.cr0.org/">
cr0 blog
</a>
</h1>
</div>
<div class="descriptionwrapper">
<p class="description"><span>a blog about IT security and other geek interests</span></p>
</div>
</div>
</div></div>
</div>
</div>
<div class="header-cap-bottom cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
</header>
<div class="tabs-outer">
<div class="tabs-cap-top cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left tabs-fauxborder-left">
<div class="fauxborder-right tabs-fauxborder-right"></div>
<div class="region-inner tabs-inner">
<div class="tabs no-items section" id="crosscol" name="Cross-Column"></div>
<div class="tabs no-items section" id="crosscol-overflow" name="Cross-Column 2"></div>
</div>
</div>
<div class="tabs-cap-bottom cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
<div class="main-outer">
<div class="main-cap-top cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left main-fauxborder-left">
<div class="fauxborder-right main-fauxborder-right"></div>
<div class="region-inner main-inner">
<div class="columns fauxcolumns">
<div class="fauxcolumn-outer fauxcolumn-center-outer">
<div class="cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left">
<div class="fauxborder-right"></div>
<div class="fauxcolumn-inner">
</div>
</div>
<div class="cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
<div class="fauxcolumn-outer fauxcolumn-left-outer">
<div class="cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left">
<div class="fauxborder-right"></div>
<div class="fauxcolumn-inner">
</div>
</div>
<div class="cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
<div class="fauxcolumn-outer fauxcolumn-right-outer">
<div class="cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left">
<div class="fauxborder-right"></div>
<div class="fauxcolumn-inner">
</div>
</div>
<div class="cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
<!-- corrects IE6 width calculation -->
<div class="columns-inner">
<div class="column-center-outer">
<div class="column-center-inner">
<div class="main section" id="main" name="Main"><div class="widget Blog" data-version="1" id="Blog1">
<div class="blog-posts hfeed">

          <div class="date-outer">
        
<h2 class="date-header"><span>Thursday, August 13, 2009</span></h2>

          <div class="date-posts">
        
<div class="post-outer">
<div class="post hentry uncustomized-post-template" itemprop="blogPost" itemscope="itemscope" itemtype="http://schema.org/BlogPosting">
<meta content="8992811497323121233" itemprop="blogId">
<meta content="4884559622868011417" itemprop="postId">
<a name="4884559622868011417"></a>
<h3 class="post-title entry-title" itemprop="name">
Linux NULL pointer dereference due to incorrect proto_ops initializations (CVE-2009-2692)
</h3>
<div class="post-header">
<div class="post-header-line-1"></div>
</div>
<div class="post-body entry-content" id="post-body-4884559622868011417" itemprop="description articleBody">
<span style="font-style: italic;">EDIT2: </span><a href="https://bugzilla.redhat.com/show_bug.cgi?id=516949#c10" style="font-style: italic;">Here</a><span style="font-style: italic;"> is RedHat's official mitigation recommendation</span><br>
<span style="font-style: italic;">EDIT3: </span><a href="http://www.grsecurity.net/" style="font-style: italic;">Brad Spengler</a><span style="font-style: italic;"> also wrote an exploit for this </span><a href="http://grsecurity.net/~spender/wunderbar_emporium.tgz" style="font-style: italic;">and published it</a><span style="font-style: italic;">. The bug triggering is based on our exploit which leaked to Brad though the private vendor-sec mailing list. He implements the </span><a href="http://blog.cr0.org/2009/06/bypassing-linux-null-pointer.html" style="font-style: italic;">personality trick</a><span style="font-style: italic;"> Tavis and I published in June to bypass mmap_min_addr and also makes use of a feature that allows any unconfined user to gain the right to </span><a href="http://danwalsh.livejournal.com/30084.html" style="font-style: italic;">map at address zero</a><span style="font-style: italic;"> in Redhat's default SELinux policy. He wrote a reliable shellcode for this one that should work pretty much anywhere on x86 and x86_64 machines.</span><br>
<span style="font-style: italic;">EDIT4: if you use Debian or Ubuntu on your machine, I have specifically updated the </span><a href="http://kernelsec.cr0.org/" style="font-style: italic;">kernelsec Debian/Ubuntu GrSecurity packages</a><span style="font-style: italic;"> to protect against this bug and others.</span><br>
<span style="font-style: italic;">EDIT5: Zinx wrote an </span><a href="http://milw0rm.com/sploits/android-root-20090816.tar.gz" style="font-style: italic;">ARM Android root exploit</a><br>
<span style="font-style: italic;">EDIT6: Ramon de Carvalho Valle wrote a </span><a href="http://www.risesecurity.org/entry/illustrating-linux-sock_sendpage-null-pointer/" style="font-style: italic;">PPC/PPC64/x86_64/i386 exploit</a><br>
<br>
Tavis Ormandy and myself have recently found and investigated a Linux kernel vulnerability (CVE-2009-2692). It affects all 2.4 and 2.6 kernels since 2001 on all architectures. We believe this is the public vulnerability affecting the greatest number of kernel versions.<br>
<br>
The issue lies in how Linux deals with unavailable operations for some protocols. <a href="http://lxr.linux.no/linux+v2.6.30.4/net/socket.c#L727">sock_sendpage</a> and others don't check for NULL pointers before dereferencing operations in the ops structure. Instead the kernel relies on correct initialization of those proto_ops structures with stubs (such as <a href="http://lxr.linux.no/linux+*/net/core/sock.c#L1651">sock_no_sendpage</a>) instead of NULL pointers.<br>
<br>
At first sight, the <a href="http://lxr.linux.no/linux+v2.6.30.4/net/ipx/af_ipx.c#L1935">code in af_ipx.c</a> looks correct and seems to initialize .sendpage properly. However, due to a bug in the <a href="http://lxr.linux.no/linux+v2.6.30.4/include/linux/net.h#L289">SOCKOPS_WRAP</a> macro, sock_sendpage will not be initialized. This code is very fragile and there are many other protocols where proto_ops are not correctly initialized at all (vulnerable even without the bug in SOCKOPS_WRAP), see <a href="http://lxr.linux.no/linux+v2.6.30.4/net/bluetooth/bnep/sock.c#L169">bluetooth for instance</a>.<br>
<br>
So it was decided that instead of patching all those protocols and continue to rely on this very fragile code, sock_sendpage would get patched to check against NULL. This was already the way <a href="http://lxr.linux.no/linux+v2.6.30.4/net/socket.c#L742">sock_splice_read</a> and others were handled.<br>
<br>
Since it leads to the kernel executing code at NULL, the vulnerability is as trivial as it can get to exploit (edit: that's for local privilege escalation and on Intel architectures): an attacker can just put code in the first page that will get executed with kernel privileges. Our exploit took a few minutes to adapt from a previous one:<br>
<br>
<span style="font-family: courier new; font-size: 85%;">$ ./leeches</span><span style="font-size: 85%;"><br></span><span style="font-family: courier new; font-size: 85%;">// ------------------------------------------------------</span><span style="font-size: 85%;"><br></span><br>
<div class="ii gt" id=":1jy" style="font-family: courier new;">
<span style="font-size: 85%;"> //  sendpage linux local ring0<br>// ---------------- <a href="mailto:taviso@sdf.lonestar.org">taviso@sdf.lonestar.org</a>, <a href="mailto:julien@cr0.org">julien@cr0.org</a><br>// leeches.c:Aug 11 2009<br>// GreetZ: LiquidK, lcamtuf, Spoonm, novocainated, asiraP, ScaryBeasts, spender, pipacs, stealth, jagger, redpig, Neel and all the other leeches we forgot to mention!<br>Enjoy some photography while at ring0 @ <a href="http://flickr.com/meder" target="_blank">http://flickr.com/meder</a><br>For our webapp friends, here is an XSS executing at ring 0: javascript:alert(1);<br>shellcode now executing chmod("/bin/sh", 04755), welcome to ring0<br>Killed<br>$ sh<br># id<br>uid=1000(julien) gid=1000(julien) euid=0(root)</span></div>
On x86/x86_64, this issue could be mitigated by three things:<br>
<ul>
<li>the recent mmap_min_addr feature. Note that this feature has <a href="http://blog.cr0.org/2009/06/bypassing-linux-null-pointer.html">known issues</a> until at least 2.6.30.2. See also this <a href="http://lwn.net/Articles/342330/">LWN article</a>.</li>
<li>on IA32 with <a href="http://www.grsecurity.net/">PaX/GrSecurity</a>, the KERNEXEC feature (x86 only)</li>
<li>not implementing affected protocols (a.k.a., reducing your attack surface by disabling what you don't need): PF_APPLETALK, PF_IPX, PF_IRDA, PF_X25, PF_AX25, PF_BLUETOOTH, PF_IUCV, IPPROTO_SCTP/PF_INET6, PF_PPPOX, PF_ISDN, but there may be more. (Update: See <a href="https://bugzilla.redhat.com/show_bug.cgi?id=516949#c10">RedHat's mitigation</a>)</li>
</ul>
<a href="http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git;a=commit;h=e694958388c50148389b0e9b9e9e8945cf0f1b98">This patch</a> should be applied to fix this issue.<br>
<br>
You can read our advisory <a href="http://www.cr0.org/misc/CVE-2009-2692.txt">here</a>.<br>
<br>
<span style="font-style: italic;">Note: this has been featured on </span><a href="http://linux.slashdot.org/story/09/08/13/2022212/Local-Privilege-Escalation-On-All-Linux-Kernels" style="font-style: italic;">Slashdot</a><span style="font-style: italic;">, </span><a href="http://www.osnews.com/story/21993/Eight_Years_of_Linux_Kernel_Vulnerable" style="font-style: italic;">OSNews</a><span style="font-style: italic;">, </span><a href="http://www.theregister.co.uk/2009/08/14/critical_linux_bug/" style="font-style: italic;">TheRegister</a><span style="font-style: italic;">, </span><a href="http://news.zdnet.co.uk/security/0,1000000189,39716623,00.htm" style="font-style: italic;">ZDNet</a><span style="font-style: italic;"> and others</span>
<div style="clear: both;"></div>
</div>
<div class="post-footer">
<div class="post-footer-line post-footer-line-1">
<span class="post-author vcard">
By
<span class="fn" itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person">
<span itemprop="name">Julien Tinnes</span>
</span>
</span>
<span class="post-timestamp">
-
<meta content="https://blog.cr0.org/2009/08/linux-null-pointer-dereference-due-to.html" itemprop="url">
<a class="timestamp-link" href="https://blog.cr0.org/2009/08/linux-null-pointer-dereference-due-to.html" rel="bookmark" title="permanent link"><abbr class="published" itemprop="datePublished" title="2009-08-13T10:41:00-07:00">August 13, 2009</abbr></a>
</span>
<span class="post-comment-link">
</span>
<span class="post-icons">
</span>
<div class="post-share-buttons goog-inline-block">
</div>
</div>
<div class="post-footer-line post-footer-line-2">
<span class="post-labels">
Labels:
<a href="https://blog.cr0.org/search/label/Linux" rel="tag">Linux</a>,
<a href="https://blog.cr0.org/search/label/Security" rel="tag">Security</a>,
<a href="https://blog.cr0.org/search/label/vulnerability" rel="tag">vulnerability</a>
</span>
</div>
<div class="post-footer-line post-footer-line-3">
<span class="post-location">
</span>
</div>
</div>
</div>
<div class="comments" id="comments">
<a name="comments"></a>
<h4>32 comments:</h4>
<div class="comments-content">
<script async="async" src="https://blog.cr0.org/2009/08/linux-null-pointer-dereference-due-to.html" type="text/javascript"></script>
<script type="text/javascript">
    (function() {
      var items = null;
      var msgs = null;
      var config = {};

// <![CDATA[
      var cursor = null;
      if (items && items.length > 0) {
        cursor = parseInt(items[items.length - 1].timestamp) + 1;
      }

      var bodyFromEntry = function(entry) {
        var text = (entry &&
                    ((entry.content && entry.content.$t) ||
                     (entry.summary && entry.summary.$t))) ||
            '';
        if (entry && entry.gd$extendedProperty) {
          for (var k in entry.gd$extendedProperty) {
            if (entry.gd$extendedProperty[k].name == 'blogger.contentRemoved') {
              return '<span class="deleted-comment">' + text + '</span>';
            }
          }
        }
        return text;
      }

      var parse = function(data) {
        cursor = null;
        var comments = [];
        if (data && data.feed && data.feed.entry) {
          for (var i = 0, entry; entry = data.feed.entry[i]; i++) {
            var comment = {};
            // comment ID, parsed out of the original id format
            var id = /blog-(\d+).post-(\d+)/.exec(entry.id.$t);
            comment.id = id ? id[2] : null;
            comment.body = bodyFromEntry(entry);
            comment.timestamp = Date.parse(entry.published.$t) + '';
            if (entry.author && entry.author.constructor === Array) {
              var auth = entry.author[0];
              if (auth) {
                comment.author = {
                  name: (auth.name ? auth.name.$t : undefined),
                  profileUrl: (auth.uri ? auth.uri.$t : undefined),
                  avatarUrl: (auth.gd$image ? auth.gd$image.src : undefined)
                };
              }
            }
            if (entry.link) {
              if (entry.link[2]) {
                comment.link = comment.permalink = entry.link[2].href;
              }
              if (entry.link[3]) {
                var pid = /.*comments\/default\/(\d+)\?.*/.exec(entry.link[3].href);
                if (pid && pid[1]) {
                  comment.parentId = pid[1];
                }
              }
            }
            comment.deleteclass = 'item-control blog-admin';
            if (entry.gd$extendedProperty) {
              for (var k in entry.gd$extendedProperty) {
                if (entry.gd$extendedProperty[k].name == 'blogger.itemClass') {
                  comment.deleteclass += ' ' + entry.gd$extendedProperty[k].value;
                } else if (entry.gd$extendedProperty[k].name == 'blogger.displayTime') {
                  comment.displayTime = entry.gd$extendedProperty[k].value;
                }
              }
            }
            comments.push(comment);
          }
        }
        return comments;
      };

      var paginator = function(callback) {
        if (hasMore()) {
          var url = config.feed + '?alt=json&v=2&orderby=published&reverse=false&max-results=50';
          if (cursor) {
            url += '&published-min=' + new Date(cursor).toISOString();
          }
          window.bloggercomments = function(data) {
            var parsed = parse(data);
            cursor = parsed.length < 50 ? null
                : parseInt(parsed[parsed.length - 1].timestamp) + 1
            callback(parsed);
            window.bloggercomments = null;
          }
          url += '&callback=bloggercomments';
          var script = document.createElement('script');
          script.type = 'text/javascript';
          script.src = url;
          document.getElementsByTagName('head')[0].appendChild(script);
        }
      };
      var hasMore = function() {
        return !!cursor;
      };
      var getMeta = function(key, comment) {
        if ('iswriter' == key) {
          var matches = !!comment.author
              && comment.author.name == config.authorName
              && comment.author.profileUrl == config.authorUrl;
          return matches ? 'true' : '';
        } else if ('deletelink' == key) {
          return config.baseUri + '/delete-comment.g?blogID='
               + config.blogId + '&postID=' + comment.id;
        } else if ('deleteclass' == key) {
          return comment.deleteclass;
        }
        return '';
      };

      var replybox = null;
      var replyUrlParts = null;
      var replyParent = undefined;

      var onReply = function(commentId, domId) {
        if (replybox == null) {
          // lazily cache replybox, and adjust to suit this style:
          replybox = document.getElementById('comment-editor');
          if (replybox != null) {
            replybox.height = '250px';
            replybox.style.display = 'block';
            replyUrlParts = replybox.src.split('#');
          }
        }
        if (replybox && (commentId !== replyParent)) {
          replybox.src = '';
          document.getElementById(domId).insertBefore(replybox, null);
          replybox.src = replyUrlParts[0]
              + (commentId ? '&parentID=' + commentId : '')
              + '#' + replyUrlParts[1];
          replyParent = commentId;
        }
      };

      var hash = (window.location.hash || '#').substring(1);
      var startThread, targetComment;
      if (/^comment-form_/.test(hash)) {
        startThread = hash.substring('comment-form_'.length);
      } else if (/^c[0-9]+$/.test(hash)) {
        targetComment = hash.substring(1);
      }

      // Configure commenting API:
      var configJso = {
        'maxDepth': config.maxThreadDepth
      };
      var provider = {
        'id': config.postId,
        'data': items,
        'loadNext': paginator,
        'hasMore': hasMore,
        'getMeta': getMeta,
        'onReply': onReply,
        'rendered': true,
        'initComment': targetComment,
        'initReplyThread': startThread,
        'config': configJso,
        'messages': msgs
      };

      var render = function() {
        if (window.goog && window.goog.comments) {
          var holder = document.getElementById('comment-holder');
          window.goog.comments.render(holder, provider);
        }
      };

      // render now, or queue to render when library loads:
      if (window.goog && window.goog.comments) {
        render();
      } else {
        window.goog = window.goog || {};
        window.goog.comments = window.goog.comments || {};
        window.goog.comments.loadQueue = window.goog.comments.loadQueue || [];
        window.goog.comments.loadQueue.push(render);
      }
    })();
// ]]>
  </script>
<div id="comment-holder">
<div class="comment-thread toplevel-thread"><ol id="top-ra"><li class="comment" id="c8824675347011340947"><div class="avatar-image-container"><img src="./2009 - Linux NULL pointer dereference due to incorrect proto_ops initializations (CVE-2009-2692)_files/blank.gif" alt=""></div><div class="comment-block"><div class="comment-header"><cite class="user">Anonymous</cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.cr0.org/2009/08/linux-null-pointer-dereference-due-to.html?showComment=1250193392780#c8824675347011340947">August 13, 2009 at 12:56 PM</a></span></div><p class="comment-content">It's not exploitable for code execution on all architectures.  My sparc server for instance is safe ;)</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="8824675347011340947" href="javascript:;">Reply</a><span class="item-control blog-admin blog-admin pid-818206072"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=8992811497323121233&amp;postID=8824675347011340947">Delete</a></span></span></div><div class="comment-replies"><div id="c8824675347011340947-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self" href="javascript:;">Replies</a></span></span><ol id="c8824675347011340947-ra" class="thread-chrome thread-expanded"><div></div><div id="c8824675347011340947-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="8824675347011340947" href="javascript:;">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c8824675347011340947-ce"></div></li><li class="comment" id="c1762909115239176669"><div class="avatar-image-container"><img src="./2009 - Linux NULL pointer dereference due to incorrect proto_ops initializations (CVE-2009-2692)_files/blank.gif" alt=""></div><div class="comment-block"><div class="comment-header"><cite class="user">Anonymous</cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.cr0.org/2009/08/linux-null-pointer-dereference-due-to.html?showComment=1250197452618#c1762909115239176669">August 13, 2009 at 2:04 PM</a></span></div><p class="comment-content">It's already been patched, just make sure you've run the update.</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="1762909115239176669" href="javascript:;">Reply</a><span class="item-control blog-admin blog-admin pid-818206072"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=8992811497323121233&amp;postID=1762909115239176669">Delete</a></span></span></div><div class="comment-replies"><div id="c1762909115239176669-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self" href="javascript:;">Replies</a></span></span><ol id="c1762909115239176669-ra" class="thread-chrome thread-expanded"><div></div><div id="c1762909115239176669-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="1762909115239176669" href="javascript:;">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c1762909115239176669-ce"></div></li><li class="comment" id="c7591804216871049983"><div class="avatar-image-container"><img src="./2009 - Linux NULL pointer dereference due to incorrect proto_ops initializations (CVE-2009-2692)_files/blank.gif" alt=""></div><div class="comment-block"><div class="comment-header"><cite class="user">Anonymous</cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.cr0.org/2009/08/linux-null-pointer-dereference-due-to.html?showComment=1250197599550#c7591804216871049983">August 13, 2009 at 2:06 PM</a></span></div><p class="comment-content">I'm safe, I run Windows</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="7591804216871049983" href="javascript:;">Reply</a><span class="item-control blog-admin blog-admin pid-818206072"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=8992811497323121233&amp;postID=7591804216871049983">Delete</a></span></span></div><div class="comment-replies"><div id="c7591804216871049983-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self" href="javascript:;">Replies</a></span></span><ol id="c7591804216871049983-ra" class="thread-chrome thread-expanded"><div></div><div id="c7591804216871049983-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="7591804216871049983" href="javascript:;">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c7591804216871049983-ce"></div></li><li class="comment" id="c6877857194464987923"><div class="avatar-image-container"><img src="./2009 - Linux NULL pointer dereference due to incorrect proto_ops initializations (CVE-2009-2692)_files/blank.gif" alt=""></div><div class="comment-block"><div class="comment-header"><cite class="user">Anonymous</cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.cr0.org/2009/08/linux-null-pointer-dereference-due-to.html?showComment=1250198488319#c6877857194464987923">August 13, 2009 at 2:21 PM</a></span></div><p class="comment-content">One more reason I'm glad to have PaX and GrSecurity.</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="6877857194464987923" href="javascript:;">Reply</a><span class="item-control blog-admin blog-admin pid-818206072"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=8992811497323121233&amp;postID=6877857194464987923">Delete</a></span></span></div><div class="comment-replies"><div id="c6877857194464987923-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self" href="javascript:;">Replies</a></span></span><ol id="c6877857194464987923-ra" class="thread-chrome thread-expanded"><div></div><div id="c6877857194464987923-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="6877857194464987923" href="javascript:;">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c6877857194464987923-ce"></div></li><li class="comment" id="c2953952478220862221"><div class="avatar-image-container"><img src="./2009 - Linux NULL pointer dereference due to incorrect proto_ops initializations (CVE-2009-2692)_files/blank.gif" alt=""></div><div class="comment-block"><div class="comment-header"><cite class="user">Anonymous</cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.cr0.org/2009/08/linux-null-pointer-dereference-due-to.html?showComment=1250198573512#c2953952478220862221">August 13, 2009 at 2:22 PM</a></span></div><p class="comment-content">good thing i run plan9</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="2953952478220862221" href="javascript:;">Reply</a><span class="item-control blog-admin blog-admin pid-818206072"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=8992811497323121233&amp;postID=2953952478220862221">Delete</a></span></span></div><div class="comment-replies"><div id="c2953952478220862221-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self" href="javascript:;">Replies</a></span></span><ol id="c2953952478220862221-ra" class="thread-chrome thread-expanded"><div></div><div id="c2953952478220862221-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="2953952478220862221" href="javascript:;">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c2953952478220862221-ce"></div></li><li class="comment" id="c34757445332898985"><div class="avatar-image-container"><img src="./2009 - Linux NULL pointer dereference due to incorrect proto_ops initializations (CVE-2009-2692)_files/blank.gif" alt=""></div><div class="comment-block"><div class="comment-header"><cite class="user">Anonymous</cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.cr0.org/2009/08/linux-null-pointer-dereference-due-to.html?showComment=1250199109315#c34757445332898985">August 13, 2009 at 2:31 PM</a></span></div><p class="comment-content">How about some exploit code??<br>First person to release c0de gets a beer on me!</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="34757445332898985" href="javascript:;">Reply</a><span class="item-control blog-admin blog-admin pid-818206072"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=8992811497323121233&amp;postID=34757445332898985">Delete</a></span></span></div><div class="comment-replies"><div id="c34757445332898985-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self" href="javascript:;">Replies</a></span></span><ol id="c34757445332898985-ra" class="thread-chrome thread-expanded"><div></div><div id="c34757445332898985-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="34757445332898985" href="javascript:;">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c34757445332898985-ce"></div></li><li class="comment" id="c9037599788363731697"><div class="avatar-image-container"><img src="./2009 - Linux NULL pointer dereference due to incorrect proto_ops initializations (CVE-2009-2692)_files/blank.gif" alt=""></div><div class="comment-block"><div class="comment-header"><cite class="user">Anonymous</cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.cr0.org/2009/08/linux-null-pointer-dereference-due-to.html?showComment=1250200557649#c9037599788363731697">August 13, 2009 at 2:55 PM</a></span></div><p class="comment-content">What if you have IPX completely disabled in your kernel? Looking at your discovery, I can see how this would be a problem for people with very modular kernels/</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="9037599788363731697" href="javascript:;">Reply</a><span class="item-control blog-admin blog-admin pid-818206072"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=8992811497323121233&amp;postID=9037599788363731697">Delete</a></span></span></div><div class="comment-replies"><div id="c9037599788363731697-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self" href="javascript:;">Replies</a></span></span><ol id="c9037599788363731697-ra" class="thread-chrome thread-expanded"><div></div><div id="c9037599788363731697-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="9037599788363731697" href="javascript:;">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c9037599788363731697-ce"></div></li><li class="comment" id="c1351693715162811842"><div class="avatar-image-container"><img src="./2009 - Linux NULL pointer dereference due to incorrect proto_ops initializations (CVE-2009-2692)_files/blank.gif" alt=""></div><div class="comment-block"><div class="comment-header"><cite class="user">Anonymous</cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.cr0.org/2009/08/linux-null-pointer-dereference-due-to.html?showComment=1250200578788#c1351693715162811842">August 13, 2009 at 2:56 PM</a></span></div><p class="comment-content">http://www.securityfocus.com/bid/36038/exploit<br>beer please now</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="1351693715162811842" href="javascript:;">Reply</a><span class="item-control blog-admin blog-admin pid-818206072"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=8992811497323121233&amp;postID=1351693715162811842">Delete</a></span></span></div><div class="comment-replies"><div id="c1351693715162811842-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self" href="javascript:;">Replies</a></span></span><ol id="c1351693715162811842-ra" class="thread-chrome thread-expanded"><div></div><div id="c1351693715162811842-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="1351693715162811842" href="javascript:;">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c1351693715162811842-ce"></div></li><li class="comment" id="c4665788823320262693"><div class="avatar-image-container"><img src="./2009 - Linux NULL pointer dereference due to incorrect proto_ops initializations (CVE-2009-2692)_files/blank.gif" alt=""></div><div class="comment-block"><div class="comment-header"><cite class="user">Anonymous</cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.cr0.org/2009/08/linux-null-pointer-dereference-due-to.html?showComment=1250204356515#c4665788823320262693">August 13, 2009 at 3:59 PM</a></span></div><p class="comment-content">This is one reason so many 64b systems (Tru64 on Alpha being a good example) prevent mapping the first 32 bits of address space. Surprising that Linux doesn't do the same.</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="4665788823320262693" href="javascript:;">Reply</a><span class="item-control blog-admin blog-admin pid-818206072"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=8992811497323121233&amp;postID=4665788823320262693">Delete</a></span></span></div><div class="comment-replies"><div id="c4665788823320262693-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self" href="javascript:;">Replies</a></span></span><ol id="c4665788823320262693-ra" class="thread-chrome thread-expanded"><div></div><div id="c4665788823320262693-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="4665788823320262693" href="javascript:;">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c4665788823320262693-ce"></div></li><li class="comment" id="c8851909123986181383"><div class="avatar-image-container"><img src="./2009 - Linux NULL pointer dereference due to incorrect proto_ops initializations (CVE-2009-2692)_files/blank.gif" alt=""></div><div class="comment-block"><div class="comment-header"><cite class="user">Anonymous</cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.cr0.org/2009/08/linux-null-pointer-dereference-due-to.html?showComment=1250211892123#c8851909123986181383">August 13, 2009 at 6:04 PM</a></span></div><p class="comment-content">&gt; This is one reason so many 64b systems<br>&gt; (Tru64 on Alpha being a good example<br>&gt; prevent mapping the first 32 bits of<br>&gt; address space. Surprising that Linux<br>&gt; doesn't do the same.<br><br>?? First of all - the whole problem has nothing to do with architecture of the used CPU (intel, non-intel, 32bit, 64bit).<br><br>Secondly - Linux also offers such protection, but it was somehow flawed until one of the kernel versions<br><br>3rdly - It is guaranteed on some systems (SVR4) that the fisrt page is always mapped (PROT_READ afair), so linux tries to emulate that behavior via the personality mechanism - http://linux.die.net/man/2/personality - and that is where the bug lied (the one with mapping zero page).</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="8851909123986181383" href="javascript:;">Reply</a><span class="item-control blog-admin blog-admin pid-818206072"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=8992811497323121233&amp;postID=8851909123986181383">Delete</a></span></span></div><div class="comment-replies"><div id="c8851909123986181383-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self" href="javascript:;">Replies</a></span></span><ol id="c8851909123986181383-ra" class="thread-chrome thread-expanded"><div></div><div id="c8851909123986181383-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="8851909123986181383" href="javascript:;">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c8851909123986181383-ce"></div></li><li class="comment" id="c1865853825923569247"><div class="avatar-image-container"><img src="./2009 - Linux NULL pointer dereference due to incorrect proto_ops initializations (CVE-2009-2692)_files/blank.gif" alt=""></div><div class="comment-block"><div class="comment-header"><cite class="user"><a href="http://sdf.lonestar.org/" rel="nofollow">nojoy</a></cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.cr0.org/2009/08/linux-null-pointer-dereference-due-to.html?showComment=1250216604738#c1865853825923569247">August 13, 2009 at 7:23 PM</a></span></div><p class="comment-content">Good find, great work.</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="1865853825923569247" href="javascript:;">Reply</a><span class="item-control blog-admin blog-admin pid-818206072"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=8992811497323121233&amp;postID=1865853825923569247">Delete</a></span></span></div><div class="comment-replies"><div id="c1865853825923569247-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self" href="javascript:;">Replies</a></span></span><ol id="c1865853825923569247-ra" class="thread-chrome thread-expanded"><div></div><div id="c1865853825923569247-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="1865853825923569247" href="javascript:;">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c1865853825923569247-ce"></div></li><li class="comment" id="c5831902960335175321"><div class="avatar-image-container"><img src="./2009 - Linux NULL pointer dereference due to incorrect proto_ops initializations (CVE-2009-2692)_files/blank.gif" alt=""></div><div class="comment-block"><div class="comment-header"><cite class="user">Anonymous</cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.cr0.org/2009/08/linux-null-pointer-dereference-due-to.html?showComment=1250224790614#c5831902960335175321">August 13, 2009 at 9:39 PM</a></span></div><p class="comment-content">Exploit code has been available at http://grsecurity.net/~spender/wunderbar_emporium.tgz<br><br>Works on all affected kernels: both x86 and x64, 4k stacks or 8k stacks, cred framework or not.  Disables SELinux, AppArmor, LSM, and auditing.  Also plays an embedded movie if the host is up to it.<br><br>-Brad</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="5831902960335175321" href="javascript:;">Reply</a><span class="item-control blog-admin blog-admin pid-818206072"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=8992811497323121233&amp;postID=5831902960335175321">Delete</a></span></span></div><div class="comment-replies"><div id="c5831902960335175321-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self" href="javascript:;">Replies</a></span></span><ol id="c5831902960335175321-ra" class="thread-chrome thread-expanded"><div></div><div id="c5831902960335175321-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="5831902960335175321" href="javascript:;">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c5831902960335175321-ce"></div></li><li class="comment" id="c8414909420471404734"><div class="avatar-image-container"><img src="./2009 - Linux NULL pointer dereference due to incorrect proto_ops initializations (CVE-2009-2692)_files/blank.gif" alt=""></div><div class="comment-block"><div class="comment-header"><cite class="user">Anonymous</cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.cr0.org/2009/08/linux-null-pointer-dereference-due-to.html?showComment=1250237537499#c8414909420471404734">August 14, 2009 at 1:12 AM</a></span></div><p class="comment-content">Can anybody explain why http://www.securityfocus.com/bid/36038/exploit only works once?</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="8414909420471404734" href="javascript:;">Reply</a><span class="item-control blog-admin blog-admin pid-818206072"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=8992811497323121233&amp;postID=8414909420471404734">Delete</a></span></span></div><div class="comment-replies"><div id="c8414909420471404734-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self" href="javascript:;">Replies</a></span></span><ol id="c8414909420471404734-ra" class="thread-chrome thread-expanded"><div></div><div id="c8414909420471404734-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="8414909420471404734" href="javascript:;">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c8414909420471404734-ce"></div></li><li class="comment" id="c5525446194641169446"><div class="avatar-image-container"><img src="./2009 - Linux NULL pointer dereference due to incorrect proto_ops initializations (CVE-2009-2692)_files/far_scalaio.png" alt=""></div><div class="comment-block"><div class="comment-header"><cite class="user"><a href="https://www.blogger.com/profile/10948445494945956846" rel="nofollow">Fanf</a></cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.cr0.org/2009/08/linux-null-pointer-dereference-due-to.html?showComment=1250238042120#c5525446194641169446">August 14, 2009 at 1:20 AM</a></span></div><p class="comment-content">Congrats  for the discover !</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="5525446194641169446" href="javascript:;">Reply</a><span class="item-control blog-admin blog-admin pid-565016656"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=8992811497323121233&amp;postID=5525446194641169446">Delete</a></span></span></div><div class="comment-replies"><div id="c5525446194641169446-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self" href="javascript:;">Replies</a></span></span><ol id="c5525446194641169446-ra" class="thread-chrome thread-expanded"><div></div><div id="c5525446194641169446-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="5525446194641169446" href="javascript:;">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c5525446194641169446-ce"></div></li><li class="comment" id="c6529838529876524164"><div class="avatar-image-container"><img src="./2009 - Linux NULL pointer dereference due to incorrect proto_ops initializations (CVE-2009-2692)_files/blank.gif" alt=""></div><div class="comment-block"><div class="comment-header"><cite class="user">Anonymous</cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.cr0.org/2009/08/linux-null-pointer-dereference-due-to.html?showComment=1250246552834#c6529838529876524164">August 14, 2009 at 3:42 AM</a></span></div><p class="comment-content">Yet another reason to use some alternative with better track record wrt security, like Solaris or *BSD.</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="6529838529876524164" href="javascript:;">Reply</a><span class="item-control blog-admin blog-admin pid-818206072"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=8992811497323121233&amp;postID=6529838529876524164">Delete</a></span></span></div><div class="comment-replies"><div id="c6529838529876524164-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self" href="javascript:;">Replies</a></span></span><ol id="c6529838529876524164-ra" class="thread-chrome thread-expanded"><div></div><div id="c6529838529876524164-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="6529838529876524164" href="javascript:;">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c6529838529876524164-ce"></div></li><li class="comment" id="c7098827952321881895"><div class="avatar-image-container"><img src="./2009 - Linux NULL pointer dereference due to incorrect proto_ops initializations (CVE-2009-2692)_files/blank.gif" alt=""></div><div class="comment-block"><div class="comment-header"><cite class="user">Anonymous</cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.cr0.org/2009/08/linux-null-pointer-dereference-due-to.html?showComment=1250259230390#c7098827952321881895">August 14, 2009 at 7:13 AM</a></span></div><p class="comment-content">Looks like it's finally kernel upgrade time!<br>Goodbye Linux_2.6.19, I'll miss you.<br><br>Codifex</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="7098827952321881895" href="javascript:;">Reply</a><span class="item-control blog-admin blog-admin pid-818206072"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=8992811497323121233&amp;postID=7098827952321881895">Delete</a></span></span></div><div class="comment-replies"><div id="c7098827952321881895-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self" href="javascript:;">Replies</a></span></span><ol id="c7098827952321881895-ra" class="thread-chrome thread-expanded"><div></div><div id="c7098827952321881895-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="7098827952321881895" href="javascript:;">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c7098827952321881895-ce"></div></li><li class="comment" id="c9122396991265219240"><div class="avatar-image-container"><img src="./2009 - Linux NULL pointer dereference due to incorrect proto_ops initializations (CVE-2009-2692)_files/blank.gif" alt=""></div><div class="comment-block"><div class="comment-header"><cite class="user">Anonymous</cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.cr0.org/2009/08/linux-null-pointer-dereference-due-to.html?showComment=1250263938250#c9122396991265219240">August 14, 2009 at 8:32 AM</a></span></div><p class="comment-content">Don't use the one from securityfocus, they have an old version of the exploit.</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="9122396991265219240" href="javascript:;">Reply</a><span class="item-control blog-admin blog-admin pid-818206072"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=8992811497323121233&amp;postID=9122396991265219240">Delete</a></span></span></div><div class="comment-replies"><div id="c9122396991265219240-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self" href="javascript:;">Replies</a></span></span><ol id="c9122396991265219240-ra" class="thread-chrome thread-expanded"><div></div><div id="c9122396991265219240-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="9122396991265219240" href="javascript:;">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c9122396991265219240-ce"></div></li><li class="comment" id="c3374864548516784195"><div class="avatar-image-container"><img src="./2009 - Linux NULL pointer dereference due to incorrect proto_ops initializations (CVE-2009-2692)_files/blank.gif" alt=""></div><div class="comment-block"><div class="comment-header"><cite class="user">Anonymous</cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.cr0.org/2009/08/linux-null-pointer-dereference-due-to.html?showComment=1250276652233#c3374864548516784195">August 14, 2009 at 12:04 PM</a></span></div><p class="comment-content">UNABLE TO MAP ZERO PAGE! on up to date Fedora with SELinux. Problem addressed by Red Hat when fixing CVE-2009-1895 recently?</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="3374864548516784195" href="javascript:;">Reply</a><span class="item-control blog-admin blog-admin pid-818206072"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=8992811497323121233&amp;postID=3374864548516784195">Delete</a></span></span></div><div class="comment-replies"><div id="c3374864548516784195-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self" href="javascript:;">Replies</a></span></span><ol id="c3374864548516784195-ra" class="thread-chrome thread-expanded"><div></div><div id="c3374864548516784195-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="3374864548516784195" href="javascript:;">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c3374864548516784195-ce"></div></li><li class="comment" id="c7751784777938742926"><div class="avatar-image-container"><img src="./2009 - Linux NULL pointer dereference due to incorrect proto_ops initializations (CVE-2009-2692)_files/blank.gif" alt=""></div><div class="comment-block"><div class="comment-header"><cite class="user">Anonymous</cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.cr0.org/2009/08/linux-null-pointer-dereference-due-to.html?showComment=1250278158170#c7751784777938742926">August 14, 2009 at 12:29 PM</a></span></div><p class="comment-content">Why can't the kernel track the process that map page zero and does extra stuff when switching from user mode to kernel mode (update mmu to make it not excecutable, ...)<br><br>Of course this will slowdown these processes but are there performance program that depend of that  ?<br>Wine ?</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="7751784777938742926" href="javascript:;">Reply</a><span class="item-control blog-admin blog-admin pid-818206072"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=8992811497323121233&amp;postID=7751784777938742926">Delete</a></span></span></div><div class="comment-replies"><div id="c7751784777938742926-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self" href="javascript:;">Replies</a></span></span><ol id="c7751784777938742926-ra" class="thread-chrome thread-expanded"><div></div><div id="c7751784777938742926-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="7751784777938742926" href="javascript:;">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c7751784777938742926-ce"></div></li><li class="comment" id="c3426019353959305844"><div class="avatar-image-container"><img src="./2009 - Linux NULL pointer dereference due to incorrect proto_ops initializations (CVE-2009-2692)_files/blank.gif" alt=""></div><div class="comment-block"><div class="comment-header"><cite class="user"><a href="http://www.christoph-wickert.de/" rel="nofollow">Christoph</a></cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.cr0.org/2009/08/linux-null-pointer-dereference-due-to.html?showComment=1250279198877#c3426019353959305844">August 14, 2009 at 12:46 PM</a></span></div><p class="comment-content">Looks like you where to fast when you thanked Dan, because SELinux does indeed stop this:<br><br>$ LANG=C sh wunderbar_emporium.sh <br>runcon: invalid context:<br>unconfined_u:unconfined_r:initrc_t:s0-s0:c0.c1023: Invalid argument<br>UNABLE TO MAP ZERO PAGE!</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="3426019353959305844" href="javascript:;">Reply</a><span class="item-control blog-admin blog-admin pid-818206072"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=8992811497323121233&amp;postID=3426019353959305844">Delete</a></span></span></div><div class="comment-replies"><div id="c3426019353959305844-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self" href="javascript:;">Replies</a></span></span><ol id="c3426019353959305844-ra" class="thread-chrome thread-expanded"><div></div><div id="c3426019353959305844-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="3426019353959305844" href="javascript:;">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c3426019353959305844-ce"></div></li><li class="comment" id="c6626051252715677257"><div class="avatar-image-container"><img src="./2009 - Linux NULL pointer dereference due to incorrect proto_ops initializations (CVE-2009-2692)_files/blank.gif" alt=""></div><div class="comment-block"><div class="comment-header"><cite class="user"><a href="http://www.christoph-wickert.de/" rel="nofollow">Christoph</a></cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.cr0.org/2009/08/linux-null-pointer-dereference-due-to.html?showComment=1250282596343#c6626051252715677257">August 14, 2009 at 1:43 PM</a></span></div><p class="comment-content">Doesn't work with SELinux, although you claim the opposite in the source:<br><br>sh wunderbar_emporium.sh <br>runcon: invalid context:<br>unconfined_u:unconfined_r:initrc_t:s0-s0:c0.c1023: Invalid argument<br>UNABLE TO MAP ZERO PAGE!<br><br>and the raw audit message for this:<br>localhost.localdomain type=AVC msg=audit(1250278420.753:27501): avc: denied { mmap_zero } for pid=16933 comm="exploit" scontext=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 tcontext=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 tclass=memprotect<br><br>So obviously you were to fast when you thanked Dan for "great SELinux bypass".</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="6626051252715677257" href="javascript:;">Reply</a><span class="item-control blog-admin blog-admin pid-818206072"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=8992811497323121233&amp;postID=6626051252715677257">Delete</a></span></span></div><div class="comment-replies"><div id="c6626051252715677257-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self" href="javascript:;">Replies</a></span></span><ol id="c6626051252715677257-ra" class="thread-chrome thread-expanded"><div></div><div id="c6626051252715677257-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="6626051252715677257" href="javascript:;">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c6626051252715677257-ce"></div></li><li class="comment" id="c6619958040596280757"><div class="avatar-image-container"><img src="./2009 - Linux NULL pointer dereference due to incorrect proto_ops initializations (CVE-2009-2692)_files/blank.gif" alt=""></div><div class="comment-block"><div class="comment-header"><cite class="user"><a href="http://lac.pl/" rel="nofollow">Lam</a></cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.cr0.org/2009/08/linux-null-pointer-dereference-due-to.html?showComment=1250330453346#c6619958040596280757">August 15, 2009 at 3:00 AM</a></span></div><p class="comment-content">Fedora's SELinux policy (asuuming you leave it enforcing) protects from the exploit (runcon can't change the type).</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="6619958040596280757" href="javascript:;">Reply</a><span class="item-control blog-admin blog-admin pid-818206072"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=8992811497323121233&amp;postID=6619958040596280757">Delete</a></span></span></div><div class="comment-replies"><div id="c6619958040596280757-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self" href="javascript:;">Replies</a></span></span><ol id="c6619958040596280757-ra" class="thread-chrome thread-expanded"><div></div><div id="c6619958040596280757-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="6619958040596280757" href="javascript:;">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c6619958040596280757-ce"></div></li><li class="comment" id="c4593122475151228107"><div class="avatar-image-container"><img src="./2009 - Linux NULL pointer dereference due to incorrect proto_ops initializations (CVE-2009-2692)_files/blank.gif" alt=""></div><div class="comment-block"><div class="comment-header"><cite class="user">Emsi</cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.cr0.org/2009/08/linux-null-pointer-dereference-due-to.html?showComment=1250348785221#c4593122475151228107">August 15, 2009 at 8:06 AM</a></span></div><p class="comment-content">So there's actually two bugs. One is NULL pointer dereference and the other is allowing to mmap (presumably unmmapable) memory at 0x0 location (even if /proc/sys/vm/mmap_min_addr &gt; 0).</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="4593122475151228107" href="javascript:;">Reply</a><span class="item-control blog-admin blog-admin pid-818206072"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=8992811497323121233&amp;postID=4593122475151228107">Delete</a></span></span></div><div class="comment-replies"><div id="c4593122475151228107-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self" href="javascript:;">Replies</a></span></span><ol id="c4593122475151228107-ra" class="thread-chrome thread-expanded"><div></div><div id="c4593122475151228107-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="4593122475151228107" href="javascript:;">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c4593122475151228107-ce"></div></li><li class="comment" id="c2047105915716281797"><div class="avatar-image-container"><img src="./2009 - Linux NULL pointer dereference due to incorrect proto_ops initializations (CVE-2009-2692)_files/blogger_logo_round_35.png" alt=""></div><div class="comment-block"><div class="comment-header"><cite class="user"><a href="https://www.blogger.com/profile/05636781178145883012" rel="nofollow">Julien Tinnes</a></cite><span class="icon user blog-author"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.cr0.org/2009/08/linux-null-pointer-dereference-due-to.html?showComment=1250352787778#c2047105915716281797">August 15, 2009 at 9:13 AM</a></span></div><p class="comment-content">Here's a reply to some of the comments (not all, sorry):<br><br>- @Anonymous: you're correct, about SPARC. Interestingly, IA32 could also be safe but is not for performances reasons (unless you use Linux 2.0 or PaX KERNEXEC/UDEREF). x86_64 however killed segmentation :(<br>- About mapping to Null. This should be protected by mmap_min_addr since Linux 2.6.23. Last month, <a href="http://blog.cr0.org/2009/06/bypassing-linux-null-pointer.html" rel="nofollow">Tavis and I published a way to bypass it by using personalities</a> and Pulseaudio. Brad Spengler then implemented this technique in an exploit and noticed that it worked even without the Pulseaudio trick. The reason was the default SELinux policy allowing unconfined users to mmap at address zero.</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="2047105915716281797" href="javascript:;">Reply</a><span class="item-control blog-admin blog-admin pid-2062996147"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=8992811497323121233&amp;postID=2047105915716281797">Delete</a></span></span></div><div class="comment-replies"><div id="c2047105915716281797-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self" href="javascript:;">Replies</a></span></span><ol id="c2047105915716281797-ra" class="thread-chrome thread-expanded"><div></div><div id="c2047105915716281797-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="2047105915716281797" href="javascript:;">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c2047105915716281797-ce"></div></li><li class="comment" id="c4245656617461373578"><div class="avatar-image-container"><img src="./2009 - Linux NULL pointer dereference due to incorrect proto_ops initializations (CVE-2009-2692)_files/blank.gif" alt=""></div><div class="comment-block"><div class="comment-header"><cite class="user">Anonymous</cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.cr0.org/2009/08/linux-null-pointer-dereference-due-to.html?showComment=1250405021435#c4245656617461373578">August 15, 2009 at 11:43 PM</a></span></div><p class="comment-content">This definetly does not work on fedora with selinux enforcing.</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="4245656617461373578" href="javascript:;">Reply</a><span class="item-control blog-admin blog-admin pid-818206072"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=8992811497323121233&amp;postID=4245656617461373578">Delete</a></span></span></div><div class="comment-replies"><div id="c4245656617461373578-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self" href="javascript:;">Replies</a></span></span><ol id="c4245656617461373578-ra" class="thread-chrome thread-expanded"><div></div><div id="c4245656617461373578-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="4245656617461373578" href="javascript:;">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c4245656617461373578-ce"></div></li><li class="comment" id="c4795679951104962653"><div class="avatar-image-container"><img src="./2009 - Linux NULL pointer dereference due to incorrect proto_ops initializations (CVE-2009-2692)_files/blank.gif" alt=""></div><div class="comment-block"><div class="comment-header"><cite class="user">Anonymous</cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.cr0.org/2009/08/linux-null-pointer-dereference-due-to.html?showComment=1250415029104#c4795679951104962653">August 16, 2009 at 2:30 AM</a></span></div><p class="comment-content">my fedora 11 with SELinux enforcing is also safe, the exploit doesnt work or did i miss something?</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="4795679951104962653" href="javascript:;">Reply</a><span class="item-control blog-admin blog-admin pid-818206072"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=8992811497323121233&amp;postID=4795679951104962653">Delete</a></span></span></div><div class="comment-replies"><div id="c4795679951104962653-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self" href="javascript:;">Replies</a></span></span><ol id="c4795679951104962653-ra" class="thread-chrome thread-expanded"><div></div><div id="c4795679951104962653-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="4795679951104962653" href="javascript:;">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c4795679951104962653-ce"></div></li><li class="comment" id="c1614731260664037698"><div class="avatar-image-container"><img src="./2009 - Linux NULL pointer dereference due to incorrect proto_ops initializations (CVE-2009-2692)_files/blank.gif" alt=""></div><div class="comment-block"><div class="comment-header"><cite class="user">Anonymous</cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.cr0.org/2009/08/linux-null-pointer-dereference-due-to.html?showComment=1250468581449#c1614731260664037698">August 16, 2009 at 5:23 PM</a></span></div><p class="comment-content">It did exploit Fedora SELinux up until August 13, then was patched. I successfully exploited Kernel 2.6.29.6-213.fc11.i586 with this mechanism.</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="1614731260664037698" href="javascript:;">Reply</a><span class="item-control blog-admin blog-admin pid-818206072"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=8992811497323121233&amp;postID=1614731260664037698">Delete</a></span></span></div><div class="comment-replies"><div id="c1614731260664037698-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self" href="javascript:;">Replies</a></span></span><ol id="c1614731260664037698-ra" class="thread-chrome thread-expanded"><div></div><div id="c1614731260664037698-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="1614731260664037698" href="javascript:;">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c1614731260664037698-ce"></div></li><li class="comment" id="c7640836854325901200"><div class="avatar-image-container"><img src="./2009 - Linux NULL pointer dereference due to incorrect proto_ops initializations (CVE-2009-2692)_files/blank.gif" alt=""></div><div class="comment-block"><div class="comment-header"><cite class="user">Anonymous</cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.cr0.org/2009/08/linux-null-pointer-dereference-due-to.html?showComment=1251369181888#c7640836854325901200">August 27, 2009 at 3:33 AM</a></span></div><p class="comment-content">http://www.doecirc.energy.gov/bulletins/t-217.shtml<br>Julien can u give more info about this vuln and how to trigger it. <br>thanks</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="7640836854325901200" href="javascript:;">Reply</a><span class="item-control blog-admin blog-admin pid-818206072"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=8992811497323121233&amp;postID=7640836854325901200">Delete</a></span></span></div><div class="comment-replies"><div id="c7640836854325901200-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self" href="javascript:;">Replies</a></span></span><ol id="c7640836854325901200-ra" class="thread-chrome thread-expanded"><div></div><div id="c7640836854325901200-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="7640836854325901200" href="javascript:;">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c7640836854325901200-ce"></div></li><li class="comment" id="c7863082871110836991"><div class="avatar-image-container"><img src="./2009 - Linux NULL pointer dereference due to incorrect proto_ops initializations (CVE-2009-2692)_files/blank.gif" alt=""></div><div class="comment-block"><div class="comment-header"><cite class="user"><a href="http://yenimoda.blogspot.com/" rel="nofollow">yenimoda</a></cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.cr0.org/2009/08/linux-null-pointer-dereference-due-to.html?showComment=1252358124640#c7863082871110836991">September 7, 2009 at 2:15 PM</a></span></div><p class="comment-content">oo thanx bro. good bilgi..</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="7863082871110836991" href="javascript:;">Reply</a><span class="item-control blog-admin blog-admin pid-818206072"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=8992811497323121233&amp;postID=7863082871110836991">Delete</a></span></span></div><div class="comment-replies"><div id="c7863082871110836991-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self" href="javascript:;">Replies</a></span></span><ol id="c7863082871110836991-ra" class="thread-chrome thread-expanded"><div></div><div id="c7863082871110836991-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="7863082871110836991" href="javascript:;">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c7863082871110836991-ce"></div></li><li class="comment" id="c4790640481199618502"><div class="avatar-image-container"><img src="./2009 - Linux NULL pointer dereference due to incorrect proto_ops initializations (CVE-2009-2692)_files/blogger_logo_round_35.png" alt=""></div><div class="comment-block"><div class="comment-header"><cite class="user"><a href="https://www.blogger.com/profile/06524239861768487132" rel="nofollow">Unknown</a></cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.cr0.org/2009/08/linux-null-pointer-dereference-due-to.html?showComment=1254002375565#c4790640481199618502">September 26, 2009 at 2:59 PM</a></span></div><p class="comment-content">Is it not normal procedure to inform the Kernel maintainers before publishing an exploit to the world? It took until 13th August for a patch to be released.</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="4790640481199618502" href="javascript:;">Reply</a><span class="item-control blog-admin blog-admin pid-569658840"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=8992811497323121233&amp;postID=4790640481199618502">Delete</a></span></span></div><div class="comment-replies"><div id="c4790640481199618502-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self" href="javascript:;">Replies</a></span></span><ol id="c4790640481199618502-ra" class="thread-chrome thread-expanded"><div></div><div id="c4790640481199618502-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="4790640481199618502" href="javascript:;">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c4790640481199618502-ce"></div></li><li class="comment" id="c8022891614627979357"><div class="avatar-image-container"><img src="./2009 - Linux NULL pointer dereference due to incorrect proto_ops initializations (CVE-2009-2692)_files/blogger_logo_round_35.png" alt=""></div><div class="comment-block"><div class="comment-header"><cite class="user"><a href="https://www.blogger.com/profile/05636781178145883012" rel="nofollow">Julien Tinnes</a></cite><span class="icon user blog-author"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.cr0.org/2009/08/linux-null-pointer-dereference-due-to.html?showComment=1254080501973#c8022891614627979357">September 27, 2009 at 12:41 PM</a></span></div><p class="comment-content">@John: I have no idea what you're talking about. We also worked on the patch, which was released even before the advisory.<br><br>I even link to it from the blog post.</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="8022891614627979357" href="javascript:;">Reply</a><span class="item-control blog-admin blog-admin pid-2062996147"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=8992811497323121233&amp;postID=8022891614627979357">Delete</a></span></span></div><div class="comment-replies"><div id="c8022891614627979357-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self" href="javascript:;">Replies</a></span></span><ol id="c8022891614627979357-ra" class="thread-chrome thread-expanded"><div></div><div id="c8022891614627979357-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="8022891614627979357" href="javascript:;">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c8022891614627979357-ce"></div></li><li class="comment" id="c4191701517809910736"><div class="avatar-image-container"><img src="./2009 - Linux NULL pointer dereference due to incorrect proto_ops initializations (CVE-2009-2692)_files/blank.gif" alt=""></div><div class="comment-block"><div class="comment-header"><cite class="user"><a href="http://my2blog.com/" rel="nofollow">saksit</a></cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.cr0.org/2009/08/linux-null-pointer-dereference-due-to.html?showComment=1259605685134#c4191701517809910736">November 30, 2009 at 10:28 AM</a></span></div><p class="comment-content">I have no idea</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="4191701517809910736" href="javascript:;">Reply</a><span class="item-control blog-admin blog-admin pid-818206072"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=8992811497323121233&amp;postID=4191701517809910736">Delete</a></span></span></div><div class="comment-replies"><div id="c4191701517809910736-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self" href="javascript:;">Replies</a></span></span><ol id="c4191701517809910736-ra" class="thread-chrome thread-expanded"><div></div><div id="c4191701517809910736-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="4191701517809910736" href="javascript:;">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c4191701517809910736-ce"></div></li></ol><div id="top-continue" class="continue"><a class="comment-reply" target="_self" href="javascript:;">Add comment</a></div><div class="comment-replybox-thread" id="top-ce"></div><div class="loadmore hidden" data-post-id="4884559622868011417"><a target="_self">Load more...</a></div></div>
</div>
</div>
<p class="comment-footer">
New comments are not allowed.
</p>
<div id="backlinks-container">
<div id="Blog1_backlinks-container">
</div>
</div>
</div>
</div>

        </div></div>
      
</div>
<div class="blog-pager" id="blog-pager">
<span id="blog-pager-newer-link">
<a class="blog-pager-newer-link" href="https://blog.cr0.org/2009/08/cve-2009-2698-udpsendmsg-vulnerability.html" id="Blog1_blog-pager-newer-link" title="Newer Post">Newer Post</a>
</span>
<span id="blog-pager-older-link">
<a class="blog-pager-older-link" href="https://blog.cr0.org/2009/07/old-school-local-root-vulnerability-in.html" id="Blog1_blog-pager-older-link" title="Older Post">Older Post</a>
</span>
<a class="home-link" href="https://blog.cr0.org/">Home</a>
</div>
<div class="clear"></div>
<div class="post-feeds">
<div class="feed-links">
Subscribe to:
<a class="feed-link" href="https://blog.cr0.org/feeds/4884559622868011417/comments/default" target="_blank" type="application/atom+xml">Post Comments (Atom)</a>
</div>
</div>
</div></div>
</div>
</div>
<div class="column-left-outer">
<div class="column-left-inner">
<aside>
</aside>
</div>
</div>
<div class="column-right-outer">
<div class="column-right-inner">
<aside>
<div class="sidebar section" id="sidebar-right-1"><div class="widget PageList" data-version="1" id="PageList1">
<div class="widget-content">
<ul>
<li>
<a href="https://blog.cr0.org/">Home</a>
</li>
</ul>
<div class="clear"></div>
</div>
</div><div class="widget BlogArchive" data-version="1" id="BlogArchive1">
<h2>Blog Archive</h2>
<div class="widget-content">
<div id="ArchiveList">
<div id="BlogArchive1_ArchiveList">
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://blog.cr0.org/2021/">
2021
</a>
<span class="post-count" dir="ltr">(1)</span>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://blog.cr0.org/2021/06/">
June
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://blog.cr0.org/2012/">
2012
</a>
<span class="post-count" dir="ltr">(1)</span>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://blog.cr0.org/2012/09/">
September
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://blog.cr0.org/2010/">
2010
</a>
<span class="post-count" dir="ltr">(3)</span>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://blog.cr0.org/2010/04/">
April
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://blog.cr0.org/2010/03/">
March
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://blog.cr0.org/2010/01/">
January
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate expanded">
<a class="toggle" href="javascript:void(0)">
<span class="zippy toggle-open">

        ▼&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://blog.cr0.org/2009/">
2009
</a>
<span class="post-count" dir="ltr">(16)</span>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://blog.cr0.org/2009/11/">
November
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://blog.cr0.org/2009/10/">
October
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://blog.cr0.org/2009/09/">
September
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate expanded">
<a class="toggle" href="javascript:void(0)">
<span class="zippy toggle-open">

        ▼&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://blog.cr0.org/2009/08/">
August
</a>
<span class="post-count" dir="ltr">(2)</span>
<ul class="posts">
<li><a href="https://blog.cr0.org/2009/08/cve-2009-2698-udpsendmsg-vulnerability.html">CVE-2009-2698: udp_sendmsg() vulnerability</a></li>
<li><a href="https://blog.cr0.org/2009/08/linux-null-pointer-dereference-due-to.html">Linux NULL pointer dereference due to incorrect pr...</a></li>
</ul>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://blog.cr0.org/2009/07/">
July
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://blog.cr0.org/2009/06/">
June
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://blog.cr0.org/2009/05/">
May
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://blog.cr0.org/2009/04/">
April
</a>
<span class="post-count" dir="ltr">(4)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://blog.cr0.org/2009/03/">
March
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="clear"></div>
</div>
</div></div>
<table border="0" cellpadding="0" cellspacing="0" class="section-columns columns-2">
<tbody>
<tr>
<td class="first columns-cell">
<div class="sidebar section" id="sidebar-right-2-1"><div class="widget HTML" data-version="1" id="HTML1">
<h2 class="title">Julien Tinnes</h2>
<div class="widget-content">
<a href="https://www.linkedin.com/in/julientinnes/">LinkedIn</a><br>
<a href="https://www.cr0.org/">www.cr0.org</a><br>
<a href="https://keybase.io/jln">Keybase</a><br>
<a href="mailto:julien+blog@cr0.org">Contact me</a>
</div>
<div class="clear"></div>
</div></div>
</td>
<td class="columns-cell">
<div class="sidebar no-items section" id="sidebar-right-2-2"></div>
</td>
</tr>
</tbody>
</table>
<div class="sidebar no-items section" id="sidebar-right-3"></div>
</aside>
</div>
</div>
</div>
<div style="clear: both"></div>
<!-- columns -->
</div>
<!-- main -->
</div>
</div>
<div class="main-cap-bottom cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
<footer>
<div class="footer-outer">
<div class="footer-cap-top cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left footer-fauxborder-left">
<div class="fauxborder-right footer-fauxborder-right"></div>
<div class="region-inner footer-inner">
<div class="foot no-items section" id="footer-1"></div>
<table border="0" cellpadding="0" cellspacing="0" class="section-columns columns-2">
<tbody>
<tr>
<td class="first columns-cell">
<div class="foot no-items section" id="footer-2-1"></div>
</td>
<td class="columns-cell">
<div class="foot no-items section" id="footer-2-2"></div>
</td>
</tr>
</tbody>
</table>
<!-- outside of the include in order to lock Attribution widget -->
<div class="foot section" id="footer-3" name="Footer"><div class="widget Attribution" data-version="1" id="Attribution1">
<div class="widget-content" style="text-align: center;">
Simple theme. Powered by <a href="https://www.blogger.com/" target="_blank">Blogger</a>.
</div>
<div class="clear"></div>
</div></div>
</div>
</div>
<div class="footer-cap-bottom cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
</footer>
<!-- content -->
</div>
</div>
<div class="content-cap-bottom cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
</div>
<script type="text/javascript">
    window.setTimeout(function() {
        document.body.className = document.body.className.replace('loading', '');
      }, 10);
  </script>

<script type="text/javascript" src="./2009 - Linux NULL pointer dereference due to incorrect proto_ops initializations (CVE-2009-2692)_files/3630122430-widgets.js.下載"></script>
<script type="text/javascript">
window['__wavt'] = 'AOuZoY40DCHUrBYBMcbAJpuhooK2Yxf_WA:1638465361570';_WidgetManager._Init('//www.blogger.com/rearrange?blogID\x3d8992811497323121233','//blog.cr0.org/2009/08/linux-null-pointer-dereference-due-to.html','8992811497323121233');
_WidgetManager._SetDataContext([{'name': 'blog', 'data': {'blogId': '8992811497323121233', 'title': 'cr0 blog', 'url': 'https://blog.cr0.org/2009/08/linux-null-pointer-dereference-due-to.html', 'canonicalUrl': 'https://blog.cr0.org/2009/08/linux-null-pointer-dereference-due-to.html', 'homepageUrl': 'https://blog.cr0.org/', 'searchUrl': 'https://blog.cr0.org/search', 'canonicalHomepageUrl': 'https://blog.cr0.org/', 'blogspotFaviconUrl': 'https://blog.cr0.org/favicon.ico', 'bloggerUrl': 'https://www.blogger.com', 'hasCustomDomain': true, 'httpsEnabled': true, 'enabledCommentProfileImages': true, 'gPlusViewType': 'FILTERED_POSTMOD', 'adultContent': false, 'analyticsAccountNumber': '', 'encoding': 'UTF-8', 'locale': 'en', 'localeUnderscoreDelimited': 'en', 'languageDirection': 'ltr', 'isPrivate': false, 'isMobile': false, 'isMobileRequest': false, 'mobileClass': '', 'isPrivateBlog': false, 'isDynamicViewsAvailable': true, 'feedLinks': '\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22cr0 blog - Atom\x22 href\x3d\x22https://blog.cr0.org/feeds/posts/default\x22 /\x3e\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/rss+xml\x22 title\x3d\x22cr0 blog - RSS\x22 href\x3d\x22https://blog.cr0.org/feeds/posts/default?alt\x3drss\x22 /\x3e\n\x3clink rel\x3d\x22service.post\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22cr0 blog - Atom\x22 href\x3d\x22https://www.blogger.com/feeds/8992811497323121233/posts/default\x22 /\x3e\n\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22cr0 blog - Atom\x22 href\x3d\x22https://blog.cr0.org/feeds/4884559622868011417/comments/default\x22 /\x3e\n', 'meTag': '', 'adsenseHostId': 'ca-host-pub-1556223355139109', 'adsenseHasAds': false, 'adsenseAutoAds': false, 'ieCssRetrofitLinks': '\x3c!--[if IE]\x3e\x3cscript type\x3d\x22text/javascript\x22 src\x3d\x22https://www.blogger.com/static/v1/jsbin/1155466832-ieretrofit.js\x22\x3e\x3c/script\x3e\n\x3c![endif]--\x3e', 'view': '', 'dynamicViewsCommentsSrc': '//www.blogblog.com/dynamicviews/4224c15c4e7c9321/js/comments.js', 'dynamicViewsScriptSrc': '//www.blogblog.com/dynamicviews/3f6f2296c2541ccc', 'plusOneApiSrc': 'https://apis.google.com/js/plusone.js', 'disableGComments': true, 'sharing': {'platforms': [{'name': 'Get link', 'key': 'link', 'shareMessage': 'Get link', 'target': ''}, {'name': 'Facebook', 'key': 'facebook', 'shareMessage': 'Share to Facebook', 'target': 'facebook'}, {'name': 'BlogThis!', 'key': 'blogThis', 'shareMessage': 'BlogThis!', 'target': 'blog'}, {'name': 'Twitter', 'key': 'twitter', 'shareMessage': 'Share to Twitter', 'target': 'twitter'}, {'name': 'Pinterest', 'key': 'pinterest', 'shareMessage': 'Share to Pinterest', 'target': 'pinterest'}, {'name': 'Email', 'key': 'email', 'shareMessage': 'Email', 'target': 'email'}], 'disableGooglePlus': true, 'googlePlusShareButtonWidth': 0, 'googlePlusBootstrap': '\x3cscript type\x3d\x22text/javascript\x22\x3ewindow.___gcfg \x3d {\x27lang\x27: \x27en\x27};\x3c/script\x3e'}, 'hasCustomJumpLinkMessage': false, 'jumpLinkMessage': 'Read more', 'pageType': 'item', 'postId': '4884559622868011417', 'pageName': 'Linux NULL pointer dereference due to incorrect proto_ops initializations (CVE-2009-2692)', 'pageTitle': 'cr0 blog: Linux NULL pointer dereference due to incorrect proto_ops initializations (CVE-2009-2692)'}}, {'name': 'features', 'data': {'sharing_get_link_dialog': 'true', 'sharing_native': 'false'}}, {'name': 'messages', 'data': {'edit': 'Edit', 'linkCopiedToClipboard': 'Link copied to clipboard!', 'ok': 'Ok', 'postLink': 'Post Link'}}, {'name': 'template', 'data': {'name': 'Simple', 'localizedName': 'Simple', 'isResponsive': false, 'isAlternateRendering': false, 'isCustom': false, 'variant': 'dark', 'variantId': 'dark'}}, {'name': 'view', 'data': {'classic': {'name': 'classic', 'url': '?view\x3dclassic'}, 'flipcard': {'name': 'flipcard', 'url': '?view\x3dflipcard'}, 'magazine': {'name': 'magazine', 'url': '?view\x3dmagazine'}, 'mosaic': {'name': 'mosaic', 'url': '?view\x3dmosaic'}, 'sidebar': {'name': 'sidebar', 'url': '?view\x3dsidebar'}, 'snapshot': {'name': 'snapshot', 'url': '?view\x3dsnapshot'}, 'timeslide': {'name': 'timeslide', 'url': '?view\x3dtimeslide'}, 'isMobile': false, 'title': 'Linux NULL pointer dereference due to incorrect proto_ops initializations (CVE-2009-2692)', 'description': 'EDIT2: Here  is RedHat\x27s official mitigation recommendation  EDIT3: Brad Spengler  also wrote an exploit for this and published it . The bug...', 'url': 'https://blog.cr0.org/2009/08/linux-null-pointer-dereference-due-to.html', 'type': 'item', 'isSingleItem': true, 'isMultipleItems': false, 'isError': false, 'isPage': false, 'isPost': true, 'isHomepage': false, 'isArchive': false, 'isLabelSearch': false, 'postId': 4884559622868011417}}]);
_WidgetManager._RegisterWidget('_HeaderView', new _WidgetInfo('Header1', 'header', document.getElementById('Header1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogView', new _WidgetInfo('Blog1', 'main', document.getElementById('Blog1'), {'cmtInteractionsEnabled': false, 'lightboxEnabled': true, 'lightboxModuleUrl': 'https://www.blogger.com/static/v1/jsbin/2908359363-lbx.js', 'lightboxCssUrl': 'https://www.blogger.com/static/v1/v-css/4076883957-lightbox_bundle.css'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_PageListView', new _WidgetInfo('PageList1', 'sidebar-right-1', document.getElementById('PageList1'), {'title': '', 'links': [{'isCurrentPage': false, 'href': 'https://blog.cr0.org/', 'title': 'Home'}], 'mobile': false}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogArchiveView', new _WidgetInfo('BlogArchive1', 'sidebar-right-1', document.getElementById('BlogArchive1'), {'languageDirection': 'ltr', 'loadingMessage': 'Loading\x26hellip;'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HTMLView', new _WidgetInfo('HTML1', 'sidebar-right-2-1', document.getElementById('HTML1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_AttributionView', new _WidgetInfo('Attribution1', 'footer-3', document.getElementById('Attribution1'), {}, 'displayModeFull'));
</script>

</body></html>