<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!-- saved from url=(0070)https://kernelbof.blogspot.com/2009/07/even-when-one-byte-matters.html -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>kernelbof: Even when one byte matters</title>

  <script src="./2009 - Even when one byte matters_files/cb=gapi.loaded_1" async=""></script><script src="./2009 - Even when one byte matters_files/cb=gapi.loaded_0" async=""></script><script type="text/javascript">(function() { (function(){function b(g){this.t={};this.tick=function(h,m,f){var n=void 0!=f?f:(new Date).getTime();this.t[h]=[n,m];if(void 0==f)try{window.console.timeStamp("CSI/"+h)}catch(q){}};this.getStartTickTime=function(){return this.t.start[0]};this.tick("start",null,g)}var a;if(window.performance)var e=(a=window.performance.timing)&&a.responseStart;var p=0<e?new b(e):new b;window.jstiming={Timer:b,load:p};if(a){var c=a.navigationStart;0<c&&e>=c&&(window.jstiming.srt=e-c)}if(a){var d=window.jstiming.load;
0<c&&e>=c&&(d.tick("_wtsrt",void 0,c),d.tick("wtsrt_","_wtsrt",e),d.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),d&&0<c&&(d.tick("_tbnd",void 0,window.chrome.csi().startE),d.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,d&&0<c&&(d.tick("_tbnd",void 0,window.external.startE),d.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();window.tickAboveFold=function(b){var a=0;if(b.offsetParent){do a+=b.offsetTop;while(b=b.offsetParent)}b=a;750>=b&&window.jstiming.load.tick("aft")};var k=!1;function l(){k||(k=!0,window.jstiming.load.tick("firstScrollTime"))}window.addEventListener?window.addEventListener("scroll",l,!1):window.attachEvent("onscroll",l);
 })();</script><script type="text/javascript">function a(){var b=window.location.href,c=b.split("?");switch(c.length){case 1:return b+"?m=1";case 2:return 0<=c[1].search("(^|&)m=")?null:b+"&m=1";default:return null}}var d=navigator.userAgent;if(-1!=d.indexOf("Mobile")&&-1!=d.indexOf("WebKit")&&-1==d.indexOf("iPad")||-1!=d.indexOf("Opera Mini")||-1!=d.indexOf("IEMobile")){var e=a();e&&window.location.replace(e)};
</script>
<meta name="generator" content="Blogger">
<link rel="icon" type="image/vnd.microsoft.icon" href="https://www.blogger.com/favicon.ico">
<link rel="alternate" type="application/atom+xml" title="kernelbof - Atom" href="https://kernelbof.blogspot.com/feeds/posts/default">
<link rel="alternate" type="application/rss+xml" title="kernelbof - RSS" href="https://kernelbof.blogspot.com/feeds/posts/default?alt=rss">
<link rel="service.post" type="application/atom+xml" title="kernelbof - Atom" href="https://www.blogger.com/feeds/4807890350046901892/posts/default">
<link rel="alternate" type="application/atom+xml" title="kernelbof - Atom" href="https://kernelbof.blogspot.com/feeds/6305074316533215238/comments/default">
<link rel="stylesheet" type="text/css" href="./2009 - Even when one byte matters_files/1601750677-blog_controls.css">
<link rel="stylesheet" type="text/css" href="./2009 - Even when one byte matters_files/authorization.css">


  <style type="text/css">
/*
-----------------------------------------------
Blogger Template Style
Name:     Minima Black
Designer: Douglas Bowman
URL:      www.stopdesign.com
Date:     26 Feb 2004
----------------------------------------------- */


body {
  background:#000;
  margin:0;
  padding:40px 20px;
  font:x-small "Trebuchet MS",Trebuchet,Verdana,Sans-Serif;
  text-align:center;
  color:#ccc;
  font-size/* */:/**/small;
  font-size: /**/small;
  }
a:link {
  color:#9ad;
  text-decoration:none;
  }
a:visited {
  color:#a7a;
  text-decoration:none;
  }
a:hover {
  color:#ad9;
  text-decoration:underline;
  }
a img {
  border-width:0;
  }


/* Header
----------------------------------------------- */
@media all {
  #header {
    width:750px;
    margin:0 auto 10px;
    border:1px solid #333;
    }
  }
@media handheld {
  #header {
    width:90%;
    }
  }
#blog-title {
  margin:5px 5px 0;
  padding:20px 20px .25em;
  border:1px solid #222;
  border-width:1px 1px 0;
  font-size:200%;
  line-height:1.2em;
  color:#ccc;
  text-transform:uppercase;
  letter-spacing:.2em;
  }
#blog-title a {
  color:#ccc;
  text-decoration:none;
  }
#blog-title a:hover {
  color:#ad9;
  }
#description {
  margin:0 5px 5px;
  padding:0 20px 20px;
  border:1px solid #222;
  border-width:0 1px 1px;
  font:78%/1.4em "Trebuchet MS",Trebuchet,Arial,Verdana,Sans-serif;
  text-transform:uppercase;
  letter-spacing:.2em;
  color:#777;
  }


/* Content
----------------------------------------------- */
@media all {
  #content {
    width:800px;
    margin:0 auto;
    padding:0;
    text-align:left;
    }
  #main {
    width:500px;
    float:left;
    }
  #sidebar {
    width:220px;
    float:right;
    }
  }
@media handheld {
  #content {
    width:90%;
    }
  #main {
    width:100%;
    float:none;
    }
  #sidebar {
    width:100%;
    float:none;
    }
  }

/* Headings
----------------------------------------------- */
h2 {
  margin:1.5em 0 .75em;
  font:bold 78%/1.4em "Trebuchet MS",Trebuchet,Arial,Verdana,Sans-serif;
  text-transform:uppercase;
  letter-spacing:.2em;
  color:#777;
  }


/* Posts
----------------------------------------------- */
@media all {
  .date-header {
    margin:1.5em 0 .5em;
    }
  .post {
    margin:.5em 0 1.5em;
    border-bottom:1px dotted #444;
    padding-bottom:1.5em;
    }
  }
@media handheld {
  .date-header {
    padding:0 1.5em 0 1.5em;
    }
  .post {
    padding:0 1.5em 0 1.5em;
    }
  }
.post-title {
  margin:.25em 0 0;
  padding:0 0 4px;
  font-size:140%;
  line-height:1.4em;
  color:#ad9;
  }
.post-title a {
  text-decoration:none;
  color:#ad9;
  }
.post-title a:hover {
  color:#fff;
  }
.post div {
  margin:0 0 .75em;
  line-height:1.6em;
  }
p.post-footer {
  margin:-.25em 0 0;
  color:#333;
  }
.post-footer em, .comment-link {
  font:78%/1.4em "Trebuchet MS",Trebuchet,Arial,Verdana,Sans-serif;
  text-transform:uppercase;
  letter-spacing:.1em;
  }
.post-footer em {
  font-style:normal;
  color:#777;
  margin-right:.6em;
  }
.comment-link {
  margin-left:.6em;
  }
.post img {
  padding:4px;
  border:1px solid #222;
  }
.post blockquote {
  margin:1em 20px;
  }
.post blockquote p {
  margin:.75em 0;
  }


/* Comments
----------------------------------------------- */
#comments h4 {
  margin:1em 0;
  font:bold 78%/1.6em "Trebuchet MS",Trebuchet,Arial,Verdana,Sans-serif;
  text-transform:uppercase;
  letter-spacing:.2em;
  color:#999;
  }
#comments h4 strong {
  font-size:130%;
  }
#comments-block {
  margin:1em 0 1.5em;
  line-height:1.6em;
  }
#comments-block dt {
  margin:.5em 0;
  }
#comments-block dd {
  margin:.25em 0 0;
  }
#comments-block dd.comment-timestamp {
  margin:-.25em 0 2em;
  font:78%/1.4em "Trebuchet MS",Trebuchet,Arial,Verdana,Sans-serif;
  text-transform:uppercase;
  letter-spacing:.1em;
  }
#comments-block dd p {
  margin:0 0 .75em;
  }
.deleted-comment {
  font-style:italic;
  color:gray;
  }
.paging-control-container {
  float: right;
  margin: 0px 6px 0px 0px;
  font-size: 80%;
}
.unneeded-paging-control {
  visibility: hidden;
}


/* Sidebar Content
----------------------------------------------- */
#sidebar ul {
  margin:0 0 1.5em;
  padding:0 0 1.5em;
  border-bottom:1px dotted #444;
  list-style:none;
  }
#sidebar li {
  margin:0;
  padding:0 0 .25em 15px;
  text-indent:-15px;
  line-height:1.5em;
  }
#sidebar p {
  color:#999;
  line-height:1.5em;
  }


/* Profile
----------------------------------------------- */
#profile-container {
  margin:0 0 1.5em;
  border-bottom:1px dotted #444;
  padding-bottom:1.5em;
  }
.profile-datablock {
  margin:.5em 0 .5em;
  }
.profile-img {
  display:inline;
  }
.profile-img img {
  float:left;
  padding:4px;
  border:1px solid #222;
  margin:0 8px 3px 0;
  }
.profile-data {
  margin:0;
  font:bold 78%/1.6em "Trebuchet MS",Trebuchet,Arial,Verdana,Sans-serif;
  text-transform:uppercase;
  letter-spacing:.1em;
  }
.profile-data strong {
  display:none;
  }
.profile-textblock {
  margin:0 0 .5em;
  }
.profile-link {
  margin:0;
  font:78%/1.4em "Trebuchet MS",Trebuchet,Arial,Verdana,Sans-serif;
  text-transform:uppercase;
  letter-spacing:.1em;
  }


/* Footer
----------------------------------------------- */
#footer {
  width:660px;
  clear:both;
  margin:0 auto;
  }
#footer hr {
  display:none;
  }
#footer p {
  margin:0;
  padding-top:15px;
  font:78%/1.6em "Trebuchet MS",Trebuchet,Verdana,Sans-serif;
  text-transform:uppercase;
  letter-spacing:.1em;
  }


/* Feeds
----------------------------------------------- */
#blogfeeds {
  }
#postfeeds {
  }
  </style>

<meta name="google-adsense-platform-account" content="ca-host-pub-1556223355139109">
<meta name="google-adsense-platform-domain" content="blogspot.com">
<!-- --><style type="text/css">@import url(//www.blogger.com/static/v1/v-css/navbar/3334278262-classic.css);
div.b-mobile {display:none;}
</style>

<style>.gc-bubbleDefault{table-layout:auto!important}.gc-bubbleDefault,.gc-reset{background-color:transparent!important;text-align:left;padding:0!important;margin:0!important;border:0!important}.pls-bubbleTop{border-bottom:1px solid #ccc!important}.pls-contentLeft,.pls-topTail,.pls-vertShimLeft{background-image:url(//ssl.gstatic.com/s2/oz/images/stars/po/bubblev1/border_3.gif)!important}.pls-topTail{background-repeat:repeat-x!important;background-position:bottom!important}.pls-vertShim{background-color:#fff!important;text-align:right}.tbl-grey .pls-vertShim{background-color:#f5f5f5!important}.pls-vertShimLeft{background-repeat:repeat-y!important;background-position:100%!important;height:4px}.pls-vertShimRight{height:4px}.pls-confirm-container .pls-vertShim{background-color:#fff3c2!important}.pls-contentWrap{background-color:#fff!important;position:relative!important;vertical-align:top}.pls-contentLeft{background-repeat:repeat-y;background-position:100%;vertical-align:top}.pls-dropRight{background-image:url(//ssl.gstatic.com/s2/oz/images/stars/po/bubblev1/bubbleDropR_3.png)!important;background-repeat:repeat-y!important}.pls-dropBL,.pls-dropBottom,.pls-dropRight,.pls-dropTR .pls-dropBR,.pls-tailleft,.pls-vert,.pls-vert img{vertical-align:top}.pls-dropBottom{background-image:url(//ssl.gstatic.com/s2/oz/images/stars/po/bubblev1/bubbleDropB_3.png)!important;background-repeat:repeat-x!important;width:100%}.pls-topLeft{text-align:right}.pls-topLeft,.pls-topRight{background:inherit!important;vertical-align:bottom}.pls-topRight{text-align:left}.pls-bottomLeft{background:inherit!important;text-align:right}.pls-bottomRight{background:inherit!important;text-align:left;vertical-align:top}.pls-tailbottom,.pls-tailleft,.pls-tailright,.pls-tailtop{display:none;position:relative}.pls-dropBL,.pls-dropBR,.pls-dropTR,.pls-tailbottom,.pls-tailleft,.pls-tailright,.pls-tailtop{background-image:url(//ssl.gstatic.com/s2/oz/images/stars/po/bubblev1/bubbleSprite_3.png)!important;background-repeat:no-repeat}.tbl-grey .pls-dropBL,.tbl-grey .pls-dropBR,.tbl-grey .pls-dropTR,.tbl-grey .pls-tailbottom,.tbl-grey .pls-tailleft,.tbl-grey .pls-tailright,.tbl-grey .pls-tailtop{background-image:url(//ssl.gstatic.com/s2/oz/images/stars/po/bubblev1/bubbleSprite-grey.png)!important}.pls-tailbottom{background-position:-23px 0}.pls-confirm-container .pls-tailbottom{background-position:-23px -10px}.pls-tailtop{background-position:-19px -20px}.pls-tailright{background-position:0 0}.pls-tailleft{background-position:-10px 0}.pls-tailtop{vertical-align:top}.gc-bubbleDefault td{line-height:0;font-size:0}.pls-tailbottom,.pls-topLeft img,.pls-topRight img{vertical-align:bottom}.bubbleDropTR,.pls-bottomLeft,.pls-bottomLeft img,.pls-dropBottom img,.pls-dropBottomL img,.pls-dropBottomR img{vertical-align:top}.pls-dropTR{background-position:0 -22px}.pls-dropBR{background-position:0 -27px}.pls-dropBL{background-position:0 -16px}.pls-spacerbottom,.pls-spacerleft,.pls-spacerright,.pls-spacertop{position:static!important}.pls-spinner{bottom:0;position:absolute;left:0;margin:auto;right:0;top:0}</style></head>

<body><script type="text/javascript">
    function setAttributeOnload(object, attribute, val) {
      if(window.addEventListener) {
        window.addEventListener('load',
          function(){ object[attribute] = val; }, false);
      } else {
        window.attachEvent('onload', function(){ object[attribute] = val; });
      }
    }
  </script>
<div id="navbar-iframe-container"><iframe ng-non-bindable="" frameborder="0" hspace="0" marginheight="0" marginwidth="0" scrolling="no" style="" tabindex="0" vspace="0" width="100%" id="navbar-iframe" name="navbar-iframe" src="./2009 - Even when one byte matters_files/navbar.html"></iframe></div>
<script type="text/javascript" src="./2009 - Even when one byte matters_files/plusone.js.下載" gapi_processed="true"></script>
<script type="text/javascript">
      gapi.load("gapi.iframes:gapi.iframes.style.bubble", function() {
        if (gapi.iframes && gapi.iframes.getContext) {
          gapi.iframes.getContext().openChild({
              url: 'https://www.blogger.com/navbar.g?targetBlogID\x3d4807890350046901892\x26blogName\x3dkernelbof\x26publishMode\x3dPUBLISH_MODE_BLOGSPOT\x26navbarType\x3dBLACK\x26layoutType\x3dCLASSIC\x26searchRoot\x3dhttps://kernelbof.blogspot.com/search\x26blogLocale\x3den_US\x26v\x3d2\x26homepageUrl\x3dhttps://kernelbof.blogspot.com/\x26vt\x3d-4840029434262121735',
              where: document.getElementById("navbar-iframe-container"),
              id: "navbar-iframe"
          });
        }
      });
    </script>

<div id="header">

  <h1 id="blog-title">
    <a href="http://kernelbof.blogspot.com/">
	kernelbof
	</a>
  </h1>
  <p id="description"></p>

</div>

<!-- Begin #content -->
<div id="content">


<!-- Begin #main -->
<div id="main"><div id="main2">



    
  <h2 class="date-header">Thursday, July 2, 2009</h2>
  

  
     
  <!-- Begin .post -->
  <div class="post"><a name="6305074316533215238"></a>
         
    <h3 class="post-title">
	 
	 Even when one byte matters
	 
    </h3>
    

	         <div class="post-body">
	<div>
      <div style="clear:both;"></div><div style="text-align: center;">Common Vulnerabilities and Exposures</div><span style="font-style:italic;"><div style="text-align: center;">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-1046</div></span><div style="text-align: left;">"The console selection feature in the Linux kernel 2.6.28 before 2.6.28.4, 2.6.25, and possibly earlier versions, when the UTF-8 console is used, allows physically proximate attackers to cause a denial of service (memory corruption) by selecting a small number of 3-byte UTF-8 characters, which triggers an "an off-by-two memory error. NOTE: it is not clear whether this issue crosses privilege boundaries."</div><div style="text-align: left;"><br></div><div style="text-align: center;">Ubuntu Security Notice USN-751-1</div><span style="font-style:italic;"><div style="text-align: center;">http://www.ubuntu.com/usn/usn-751-1</div></span><div style="text-align: left;">"The virtual consoles did not correctly handle certain UTF-8 sequences. A local attacker on the physical console could exploit this to cause a system crash, leading to a denial of service."</div><div style="text-align: left;"><br></div><div style="text-align: center;">RedHat Security Advisory</div><span style="font-style:italic;"><div style="text-align: center;">http://rhn.redhat.com/errata/RHSA-2009-0451.html</div></span><div style="text-align: left;">"An off-by-two error was found in the set_selection() function of the Linux kernel. This could allow a local, unprivileged user to cause a denial of service when making a selection of characters in a UTF-8 console.  Note: physical console access is required to exploit this issue."</div><div style="text-align: left;"><span class="Apple-style-span" style="font-family:Georgia, -webkit-fantasy;"><span class="Apple-style-span" style="font-family:Georgia, fantasy;"><br></span></span></div><br>When I was looking at vendor advisories regarding SCTP remote issue i got attracted by another bug regarding hypothetical kernel heap overflow.<br>For the umpteenth time the impact of the vulnerability is : DoS only.<br>The impact of this issue is highly limited because of you need a VC attached to your process to exploit it, but it's worth spending some time on it  since it's not an everyday bug to find in the kernel.. it's an interesting scenario: an off-by-one(two) kernel heap overflow.<br><br>As I did for the previous post, I'm not going to give any detailed<br>description of the exploit: it should be straightforward enough to<br>everyone who's used to play with internal kernel structures.<br>What I'm about to do is, once again, just briefly introduce the<br>vulnerability and then spend some time on showing how it is possible to<br>turn it in a nearly one-shot exploit.<br><br>Before going on i want to include a digression about this blog:<br>the original idea was to publish a month by month exploit regarding  DoS-claiming-only vulnerability in the linux kernel.<br>After publishing the first post, about SCTP remote exploit, i received some roasts.<br>Someone pulled me down about disclosing a few cool stuff.<br>I want to point out that i just  wrote the exploit: i did not kill the vulnerability.<br>I don't like full disclosure, at least i don't like what full disclosure has become today:  a freaking race between killer-vulns-guys.<br>Even if  i think  there's a big difference between killing vulnerabilities  and writing good exploit code i 'm not sure if i'll continue publishing these stuffs.<br><div><br></div><br>The buffer is allocated here:<br>file: <i>/drivers/char/selection.c</i><br>func: <i>set_selection()</i><br><br><span class="Apple-style-span" style="font-size:small;"><i>multiplier = use_unicode ? 3 : 1;<br>bp = kmalloc((sel_end-sel_start)/2*multiplier+1, GFP_KERNEL);</i></span><div><span class="Apple-style-span" style="font-family:arial, -webkit-fantasy;"><span class="Apple-style-span" style="font-family:Georgia, fantasy;"><br></span></span><div>then the function copies the buffer:<br><br><span class="Apple-style-span" style="font-size:small;"><i>sel_buffer = bp;<br>obp = bp;<br>for (i = sel_start; i &lt;= sel_end; i += 2) { </i></span></div><div><span class="Apple-style-span" style="font-size:small;"><i>c = sel_pos(i); </i></span></div><div><span class="Apple-style-span" style="font-size:small;"><i>if (use_unicode) </i></span></div><div><span class="Apple-style-span" style="font-size:small;"><i><span class="Apple-tab-span" style="white-space:pre"> </span>bp += store_utf8(c, bp);</i></span></div><div><span class="Apple-style-span" style="font-size:small;"><i>...</i></span></div><div><span class="Apple-style-span" style="font-size:small;"><i>...</i></span></div><div><br></div><div><br></div><div>The loop goes from <i>sel_start</i> to <i>sel_end</i> (inclusive). The last character is not multiplied by multiplier (which has value 3) and so we can overflow the buffer by 1 or 2 byte. To make the overflow meaningful we have to allocate a buffer close to the size of a cache object slab or the overflow will end up in the pad zone. Since we can control the "<i>delta</i>" between <i>sel_start</i> and <i>sel_end</i> we can arbitrary choose the slub to be used. </div><div><br></div><div>On of the better slub to pick usually is the 96 bytes slub.. but it doesn't fulfill our goal because: </div><div><br></div><div><i><span class="Apple-style-span" style="font-size:small;">63 / 2 * 3 + 1 =  94</span></i> </div><div>(if we overflow 2 byte we get 96.. no  meaningful overflow happens..)</div><div><i><span class="Apple-style-span" style="font-size:small;">64 / 2 * 3 + 1= 97</span> </i></div><div><i></i> (too large to fit in..)</div><div>We pick instead the 128 slub cache.. using a gap equal to:</div><div><i><span class="Apple-style-span" style="font-size:small;">84 / 2 * 3 =  127 </span></i></div><div><i><span class="Apple-style-span" style="font-size:small;"></span></i>(if we overflow 2 bytes we have meaningful off-by-one heap overflow)  </div><div><br></div><div>Now we can overflow into another 128 byte object which has some interesting meaningful pointer or we can smash internal SLUB  structure. </div><div><br></div><div><br></div></div>The exploit takes the latter approach smashing internal SLUB structure taking full control of the SLUB allocation engine.<br>I decide to use again a previously disclosed structure as a placeholder: SCTP ssnmap struct.<br><div>This can lead to some problem with SELinux.<br>There are other interesting structures to pick in the place of SCTP ones but it is not worth showing them here for such an not useful exploit.</div><div><br>A couple of words about lack of full-recovery in the exploit. On boxes protected by zero mapping kernel protection the code leaves two descriptors holding smashed pointers in its internal structures. Before executing the shell the code migrates those descriptors inside a child process. When this child process will be killed (after reboot?) the kernel oops.<br><br></div><div>A different way could be:<br>- migrate descriptors inside some daemon using ptrace()/SCM_RIGHT<br>- directly patch smashed pointers adding code to the ring0 shellcode<br>- using a stupid lkm<br><br>The exploit works only on x86-64 platform with SLUB allocator but anyone can run it on x86 kernel modifying a couple of lines.<br><br>Talking about "external resources", the exploit uses "/proc/slabinfo" and "/proc/kallsyms". The former is not crucial but increases the exploitation odds close to 100% on idle boxes. The latter is not needed if you have access to the kernel image.<br><br></div><div>I'd like to thank twiz for his pioneer work on original old SLAB exploitation approach: it helps me much in abusing new SLUB counterpart. </div><div><br>Tested on target:<br><i>Ubuntu 8.04 x86_64</i> <i>(generic/server)<br>Ubuntu 8.10 x86_64 (generic/server)<br>Fedora Core 10 x86_64 (default installed kernel - without SElinux)<br></i><br><br>$ ./tioctl_houdini<br>[**] Patching ring0 shellcode with userspace addr: 0x4017e0<br>[**] Using port: 25433<br>[**] Getting slab info...<br>[**] Mapping Segments...<br>[**] Trying mapping safe page...Page Protection Present (Unable to Map Safe Page)<br>[**] Mapping High Address Page (don't kill placeholder child)<br>[**] Mapping Code Page... Done<br>[**] Binding on CPU 0<br>[**] Start Server Thread..<div>...<br>...<br>...<br>┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼<br>┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼<br>┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼<br>[**] Umapped end-to-end fd: 212<br>[**] Unsafe  fd: ( 210 224 214 212 )<br>[**] Hijacking fops...<br>[**] Migrate evil unsafe fds to child process..<br>[**] Child process 25463 _MUST_ NOT die..keep it alive:)<br>[**] Got root!<br># id<br>uid=0(root) gid=0(root) groups=1001(anon)<br><br><b>GAME OVER</b><br></div><div><br></div><div>The exploit code can be downloaded <a href="http://sgrakkyu.antifork.org/tiocl_houdini.c">here</a>.</div><div><br></div></div><div style="clear:both; padding-bottom:0.25em"></div>
    </div>
    </div>
    
    <p class="post-footer">
      <em>posted by sgrakkyu at 
    <a class="post-footer-link" href="http://kernelbof.blogspot.com/2009/07/even-when-one-byte-matters.html" title="permanent link"> 12:44 AM </a></em>
        
    </p>
  
  </div>
  <!-- End .post -->
  
  
  
  <!-- Begin #comments -->
 
  <div id="comments">

	<a name="comments"></a>
        <h4>8 Comments:</h4>
        <dl id="comments-block">
          
      
      <dt class="comment-poster" id="c1222826976188009060"><a name="c1222826976188009060"></a>
        <span style="line-height:16px" class="comment-icon anon-comment-icon"><img src="./2009 - Even when one byte matters_files/anon16-rounded.gif" alt="Anonymous" style="display:inline;"></span>&nbsp;<a href="http://grsecurity.net/" rel="nofollow">spender</a> said...
      </dt>
      <dd class="comment-body">

        <p>great work, yet again ;)</p>
      </dd>
      <dd class="comment-timestamp"><a href="http://kernelbof.blogspot.com/2009/07/even-when-one-byte-matters.html?showComment=1246498268218#c1222826976188009060" title="comment permalink">July 2, 2009 at 3:31 AM</a>
	  <span class="item-control blog-admin pid-1170992158"><a style="border:none;" href="https://www.blogger.com/delete-comment.g?blogID=4807890350046901892&amp;postID=1222826976188009060" title="Delete Comment"><span class="delete-comment-icon">&nbsp;</span></a></span>
	  </dd>
      
      <dt class="comment-poster" id="c3064221539900579031"><a name="c3064221539900579031"></a>
        <span style="line-height:16px" class="comment-icon anon-comment-icon"><img src="./2009 - Even when one byte matters_files/anon16-rounded.gif" alt="Anonymous" style="display:inline;"></span>&nbsp;<a href="http://argp.gr/" rel="nofollow">argp</a> said...
      </dt>
      <dd class="comment-body">

        <p>Thanks for another cool post. Please continue posting.</p>
      </dd>
      <dd class="comment-timestamp"><a href="http://kernelbof.blogspot.com/2009/07/even-when-one-byte-matters.html?showComment=1246539115903#c3064221539900579031" title="comment permalink">July 2, 2009 at 2:51 PM</a>
	  <span class="item-control blog-admin pid-1170992158"><a style="border:none;" href="https://www.blogger.com/delete-comment.g?blogID=4807890350046901892&amp;postID=3064221539900579031" title="Delete Comment"><span class="delete-comment-icon">&nbsp;</span></a></span>
	  </dd>
      
      <dt class="comment-poster" id="c7017575034957799079"><a name="c7017575034957799079"></a>
        <span style="line-height:16px" class="comment-icon anon-comment-icon"><img src="./2009 - Even when one byte matters_files/anon16-rounded.gif" alt="Anonymous" style="display:inline;"></span>&nbsp;<span class="anon-comment-author">Anonymous</span> said...
      </dt>
      <dd class="comment-body">

        <p>How to compile that code ?</p>
      </dd>
      <dd class="comment-timestamp"><a href="http://kernelbof.blogspot.com/2009/07/even-when-one-byte-matters.html?showComment=1247203669745#c7017575034957799079" title="comment permalink">July 10, 2009 at 7:27 AM</a>
	  <span class="item-control blog-admin pid-1170992158"><a style="border:none;" href="https://www.blogger.com/delete-comment.g?blogID=4807890350046901892&amp;postID=7017575034957799079" title="Delete Comment"><span class="delete-comment-icon">&nbsp;</span></a></span>
	  </dd>
      
      <dt class="comment-poster" id="c8875606750855194380"><a name="c8875606750855194380"></a>
        <span style="line-height:16px" class="comment-icon anon-comment-icon"><img src="./2009 - Even when one byte matters_files/anon16-rounded.gif" alt="Anonymous" style="display:inline;"></span>&nbsp;<a href="http://hunger.hu/" rel="nofollow">Hunger</a> said...
      </dt>
      <dd class="comment-body">

        <p>Excellent blog, don't stop</p>
      </dd>
      <dd class="comment-timestamp"><a href="http://kernelbof.blogspot.com/2009/07/even-when-one-byte-matters.html?showComment=1247301810257#c8875606750855194380" title="comment permalink">July 11, 2009 at 10:43 AM</a>
	  <span class="item-control blog-admin pid-1170992158"><a style="border:none;" href="https://www.blogger.com/delete-comment.g?blogID=4807890350046901892&amp;postID=8875606750855194380" title="Delete Comment"><span class="delete-comment-icon">&nbsp;</span></a></span>
	  </dd>
      
      <dt class="comment-poster" id="c6388282170540879671"><a name="c6388282170540879671"></a>
        <span style="line-height:16px" class="comment-icon anon-comment-icon"><img src="./2009 - Even when one byte matters_files/anon16-rounded.gif" alt="Anonymous" style="display:inline;"></span>&nbsp;<span class="anon-comment-author">XeNiX</span> said...
      </dt>
      <dd class="comment-body">

        <p>cant compile this code , it need to be compiled as 64 ,gcc -m64 ?<br>anyone can help with this please !</p>
      </dd>
      <dd class="comment-timestamp"><a href="http://kernelbof.blogspot.com/2009/07/even-when-one-byte-matters.html?showComment=1247411282930#c6388282170540879671" title="comment permalink">July 12, 2009 at 5:08 PM</a>
	  <span class="item-control blog-admin pid-1170992158"><a style="border:none;" href="https://www.blogger.com/delete-comment.g?blogID=4807890350046901892&amp;postID=6388282170540879671" title="Delete Comment"><span class="delete-comment-icon">&nbsp;</span></a></span>
	  </dd>
      
      <dt class="comment-poster" id="c4883360129762644942"><a name="c4883360129762644942"></a>
        <span style="line-height:16px" class="comment-icon anon-comment-icon"><img src="./2009 - Even when one byte matters_files/anon16-rounded.gif" alt="Anonymous" style="display:inline;"></span>&nbsp;<span class="anon-comment-author">kortando</span> said...
      </dt>
      <dd class="comment-body">

        <p>fantastyczne i wogole.. łał</p>
      </dd>
      <dd class="comment-timestamp"><a href="http://kernelbof.blogspot.com/2009/07/even-when-one-byte-matters.html?showComment=1247422270750#c4883360129762644942" title="comment permalink">July 12, 2009 at 8:11 PM</a>
	  <span class="item-control blog-admin pid-1170992158"><a style="border:none;" href="https://www.blogger.com/delete-comment.g?blogID=4807890350046901892&amp;postID=4883360129762644942" title="Delete Comment"><span class="delete-comment-icon">&nbsp;</span></a></span>
	  </dd>
      
      <dt class="comment-poster" id="c9180104663636565190"><a name="c9180104663636565190"></a>
        <span style="line-height:16px" class="comment-icon anon-comment-icon"><img src="./2009 - Even when one byte matters_files/anon16-rounded.gif" alt="Anonymous" style="display:inline;"></span>&nbsp;<span class="anon-comment-author">Anonymous</span> said...
      </dt>
      <dd class="comment-body">

        <p>to compile this code you need <br>sctp module *installed*<br><br>and to compile the code try:<br>gcc tiocl_houdini.c -o tiocl_houdini -lsctp</p>
      </dd>
      <dd class="comment-timestamp"><a href="http://kernelbof.blogspot.com/2009/07/even-when-one-byte-matters.html?showComment=1247560777678#c9180104663636565190" title="comment permalink">July 14, 2009 at 10:39 AM</a>
	  <span class="item-control blog-admin pid-1170992158"><a style="border:none;" href="https://www.blogger.com/delete-comment.g?blogID=4807890350046901892&amp;postID=9180104663636565190" title="Delete Comment"><span class="delete-comment-icon">&nbsp;</span></a></span>
	  </dd>
      
      <dt class="comment-poster" id="c1882168704182113481"><a name="c1882168704182113481"></a>
        <span style="line-height:16px" class="comment-icon blogger-comment-icon"><img src="./2009 - Even when one byte matters_files/b16-rounded.gif" alt="Blogger" style="display:inline;"></span>&nbsp;<a href="https://www.blogger.com/profile/01234222908168002434" rel="nofollow">for ict 99</a> said...
      </dt>
      <dd class="comment-body">

        <p>    Great Article<br>  <a href="http://projectcentersinchennai.co.in/Final-Year-Projects-for-CSE/Final-Year-Projects-for-CSE-Cyber-Security-Domain" title="Cyber Security Projects for CSE Students" rel="nofollow">Cyber Security Projects for CSE Students</a><br>  <br>  <br>     <a href="http://javascripttrainingcourses.com/" title="JavaScript Training in Chennai" rel="nofollow">JavaScript Training in Chennai</a><br>  <br>  <br>  <br> <a href="http://projectcentersinchennai.co.in/" title="Project Centers in Chennai" rel="nofollow">Project Centers in Chennai</a><br> <br> <br> <br><br> <a href="http://wisentechnologies.com/it-courses/html-css-javascript-jquery-training.aspx" title="JavaScript Training in Chennai" rel="nofollow">JavaScript Training in Chennai</a></p>
      </dd>
      <dd class="comment-timestamp"><a href="http://kernelbof.blogspot.com/2009/07/even-when-one-byte-matters.html?showComment=1571454783677#c1882168704182113481" title="comment permalink">October 19, 2019 at 5:13 AM</a>
	  <span class="item-control blog-admin pid-182402285"><a style="border:none;" href="https://www.blogger.com/delete-comment.g?blogID=4807890350046901892&amp;postID=1882168704182113481" title="Delete Comment"><span class="delete-comment-icon">&nbsp;</span></a></span>
	  </dd>
      
      
    </dl>
		<p class="comment-timestamp">

    </p><div class="comment-form">
<a name="comment-form"></a>
<h4>Post a Comment</h4><p></p>
<a id="comment-editor-src" href="https://www.blogger.com/comment-iframe.g?blogID=4807890350046901892&amp;postID=6305074316533215238"></a><iframe id="comment-editor" src="./2009 - Even when one byte matters_files/comment-iframe.html" class="blogger-iframe-colorize" width="100%" height="410" scrolling="no" frameborder="0" allowtransparency="true"></iframe>
<script type="text/javascript" src="./2009 - Even when one byte matters_files/3440758136-iframe_colorizer.js.下載"></script>
</div>
    <p></p>
    <p id="postfeeds">Subscribe to Post Comments [<a target="_blank" href="https://kernelbof.blogspot.com/feeds/6305074316533215238/comments/default" type="application/atom+xml">Atom</a>]</p>
    	    
    


		<p class="comment-timestamp">
	<a href="http://kernelbof.blogspot.com/">&lt;&lt; Home</a>
    </p>
    </div>



  <!-- End #comments -->


</div></div>
<!-- End #main -->







<!-- Begin #sidebar -->
<div id="sidebar"><div id="sidebar2">
  
  
  <!-- Begin #profile-container -->

   <div id="profile-container"><h2 class="sidebar-title">About Me</h2>
<dl class="profile-datablock"><dt class="profile-img"><a href="https://www.blogger.com/profile/05705465328555558803"><img src="./2009 - Even when one byte matters_files/screen-capture.png" width="80" height="42" alt="My Photo"></a></dt>
<dd class="profile-data"><strong>Name:</strong> <a rel="author" href="https://www.blogger.com/profile/05705465328555558803"> sgrakkyu </a></dd>
</dl>

<p class="profile-link"><a rel="author" href="https://www.blogger.com/profile/05705465328555558803">View my complete profile</a></p></div>
   
  <!-- End #profile -->
    
  
  <h2 class="sidebar-title">Previous Posts</h2>
    <ul id="recently">
    
        <li><a href="http://kernelbof.blogspot.com/2009/04/kernel-memory-corruptions-are-not-just.html">When a "potential D.o.S." means a one-shot remote ...</a></li>
     
  </ul>
    

      <p id="powered-by"><a href="https://www.blogger.com/"><img src="./2009 - Even when one byte matters_files/unnamed.gif" alt="Powered by Blogger"></a></p>
      <p id="blogfeeds">Subscribe to<br>Posts [<a target="_blank" href="https://kernelbof.blogspot.com/feeds/posts/default" type="application/atom+xml">Atom</a>]</p>
  
  <!--
  <p>This is a paragraph of text that could go in the sidebar.</p>
  -->
  


</div></div>
<!-- End #sidebar -->


</div>
<!-- End #content -->



<!-- Begin #footer -->
<div id="footer"><hr>
  <p><!--This is an optional footer. If you want text here, place it inside these tags, and remove this comment. -->&nbsp;</p>

</div>
<!-- End #footer -->




</body></html>