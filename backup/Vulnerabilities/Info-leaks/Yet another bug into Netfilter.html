<!DOCTYPE html>
<!-- saved from url=(0052)https://www.randorisec.fr/yet-another-bug-netfilter/ -->
<html lang="en-us"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="robots" content="all,follow">
    <meta name="googlebot" content="index,follow,snippet,archive">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Yet another bug into Netfilter</title>

    
    <link rel="stylesheet" href="./Yet another bug into Netfilter_files/all.css">
    <link rel="stylesheet" href="./Yet another bug into Netfilter_files/mystyles.css">

    <meta name="generator" content="Hugo 0.81.0">

    
    <link rel="shortcut icon" href="https://www.randorisec.fr/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" href="https://www.randorisec.fr/apple-touch-icon.png">


    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@RandoriSec">
    <meta name="twitter:title" content="Yet another bug into Netfilter">
    
    <meta name="twitter:image" content="https://www.randorisec.fr/img/blog/netfilter-logo3.png">
    
    <meta name="twitter:description" content="RandoriSec Offensive Security">

    
    <meta property="og:title" content="Yet another bug into Netfilter">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.randorisec.fr/yet-another-bug-netfilter/">
    <meta property="og:image" content="https://www.randorisec.fr/img/blog/netfilter-logo3.png">
    <meta property="og:description" content="RandoriSec Offensive Security">

</head>
 
 

    <body class="has-navbar-fixed-top">
    
    

<nav class="navbar is-fixed-top is-spaced" role="navigation" aria-label="main navigation">
    
    <div class="navbar-brand">
        <a class="navbar-item" href="https://www.randorisec.fr/">
            <img src="./Yet another bug into Netfilter_files/logo.png" width="142" height="58">
        </a>

        <a role="button" onclick="document.querySelector(&#39;.navbar-menu&#39;).classList.toggle(&#39;is-active&#39;);" class="navbar-burger burger" aria-label="menu" aria-expanded="false" data-target="#navbarBasicExample">
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
        </a>
    </div>
    
    <div id="navbarBasicExample" class="navbar-menu">
        
        
        
        
        
        
        
        <div class="navbar-item">
            <a href="https://www.randorisec.fr/yet-another-bug-netfilter/" class="icon">
                <img src="./Yet another bug into Netfilter_files/en.svg" alt="English flag icon">
            </a>
        </div>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        <div class="navbar-item">
            <a href="https://www.randorisec.fr/fr/yet-another-bug-netfilter/" class="icon">
                <img src="./Yet another bug into Netfilter_files/fr.svg" alt="French flag icon">
            </a>
        </div>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        <div class="navbar-item">
            <a href="https://www.randorisec.fr/pt/yet-another-bug-netfilter/" class="icon">
                <img src="./Yet another bug into Netfilter_files/pt.svg" alt="Portugal flag icon">
            </a>
        </div>
        
        
        
        


        
        
        
        <div class="navbar-item has-dropdown is-hoverable">
            <a class="navbar-link" href="https://www.randorisec.fr/about">
                About
            </a>
            <div class="navbar-dropdown is-hidden-touch">
                
                <a class="navbar-item" href="https://www.randorisec.fr/about#history">
                    History
                </a>
                
                <a class="navbar-item" href="https://www.randorisec.fr/about#our-values">
                    Our Values
                </a>
                
                <a class="navbar-item" href="https://www.randorisec.fr/about#the-team">
                    The Team
                </a>
                
                <a class="navbar-item" href="https://www.randorisec.fr/about#careers">
                    Careers
                </a>
                
                <a class="navbar-item" href="https://www.randorisec.fr/about#testimonials">
                    Testimonials
                </a>
                
                <a class="navbar-item" href="https://www.randorisec.fr/about#certifications">
                    Certifications
                </a>
                
            </div>
        </div>
        
        
        
        <div class="navbar-item has-dropdown is-hoverable">
            <a class="navbar-link" href="https://www.randorisec.fr/services">
                Services
            </a>
            <div class="navbar-dropdown is-hidden-touch">
                
                <a class="navbar-item" href="https://www.randorisec.fr/services/penetration-test/">
                    Penetration test
                </a>
                
                <a class="navbar-item" href="https://www.randorisec.fr/services/security-audit/">
                    Security audit
                </a>
                
                <a class="navbar-item" href="https://www.randorisec.fr/services/training/">
                    Training
                </a>
                
                <a class="navbar-item" href="https://www.randorisec.fr/services/reverse-engineering/">
                    Reverse engineering
                </a>
                
                <a class="navbar-item" href="https://www.randorisec.fr/services/secops-secarch/">
                    SecOps / SecArch
                </a>
                
            </div>
        </div>
        
        
        
        <a class="navbar-item" href="https://www.randorisec.fr/blog">
            Blog
        </a>
        
        
        
        <a class="navbar-item" href="https://www.randorisec.fr/publications">
            Publications
        </a>
        
        
        
        <a class="navbar-item" href="https://www.randorisec.fr/contact">
            Contact
        </a>
        
        
    </div>
    <div class="navbar-end is-hidden-touch">
        <div class="navbar-item">
            <a href="https://www.linkedin.com/company/randorisec/" target="_blank" style="opacity: 1;">
                <i class="fab fa-2x fa-linkedin-in">
                </i>
            </a>
        </div>
        <div class="navbar-item">
            <a href="https://twitter.com/randorisec" target="_blank" style="opacity: 1;">
                <i class="fab fa-2x fa-twitter"></i>
            </a>
        </div>
        <div class="navbar-item">
            <a href="mailto:contact@randorisec.fr" target="_blank" style="opacity: 1;">
                <i class="fa fa-2x fa-envelope"></i>
            </a>
        </div>
        <div class="navbar-item">
            <a href="https://www.youtube.com/channel/UC-ZfbMW6ASkAYD6wqTOT3kg" target="_blank" style="opacity: 1;">
                <i class="fab fa-2x fa-youtube"></i>
            </a>
        </div>

        <div class="navbar-item">
            <a href="https://github.com/randorisec/" target="_blank" style="opacity: 1;">
                <i class="fab fa-2x fa-github"></i>
            </a>
        </div>

    </div>
</nav>
<section class="level"></section>


<section class="hero is-small is-primary">
    <div class="hero-body">
        <div class="container">
            <nav class="level">
                <div class="level-left">
                    <div>
                        <h2 class="title is-3">Yet another bug into Netfilter</h2>
                    </div>
                </div>
            </nav>
        </div>
    </div>
</section>

<section class="section">
    <div class="container">
        <div class="columns is-centered">
            <div class="column is-three-quarters">
                <div class="container">
                    <h3 class="subtitle is-6">
                        <span class="icon"><i class="fa fa-user"></i></span>
                        Arthur Mongodin
                        <span class="icon"><i class="far fa-calendar"></i></span>
                        
<time class="post-date">
    June 13, 2022
</time>


                        <span class="icon"><i class="fa fa-clock"></i></span>
                        13 min
                    </h3>
                    <div class="content" id="blog">
                        <p>This year, I have done my end-of-study internship at Randorisec, the original purpose of my internship was to study different ways of doing variant analysis on open-sources project but also on closed-source software solutions.
The Linux kernel is an attractive target, and so it was chosen as the target of my project.
I started scouting for publicly disclosed bugs which could lead to interesting variant patterns.
Since the beginning of the year, several bugs have been found and fixed wihtin the kernel component netfilter, such has CVE 2022-1015.
In this article, I am going to talk about two bugs I’ve found inside the netfilter kernel section.
One of them lead to information leakage, and potentially to a fully functional local privilege escalation (LPE) exploit.</p>
<h2 id="a-brief-introduction-to-netfilter">A brief introduction to netfilter</h2>
<p><a href="https://netfilter.org/">Netfilter</a> is an open-source project that is used to perform packet filtering, aka the linux firewall.</p>
<p>This project is often mentioned <a href="https://git.netfilter.org/iptables/">iptables</a> which is the userland application used to configure your firewall.
In 2014, a new subsystem was added to the netfilter firewall, called <code>nftable</code>, which is now configured through the <a href="https://git.netfilter.org/nftables/">nftables</a> userland application.</p>
<p><img src="./Yet another bug into Netfilter_files/netfilter_vulgarized.png" alt="Schema of the netfilter organization"></p>
<p>The core logic of netfilter is implemented within the kernel (<code>/net/netfilter</code>), and the userland tools communicate with it via netlink messages.</p>
<h3 id="a-very-basic-usage">A VERY basic usage</h3>
<p>The main purpose of netfilter is the table object.
This object will contain all the information about a filter.
The following <code>nftables</code> command creates a new table  that is named <code>my-table</code> that could be used as a filter on the IP protocol.</p>
<pre><code>nft&gt; add table ip my-table
</code></pre><p>A table can contain different object such as sets, that is used to store data.
The following command create a new set associated to the table <code>my-table</code> named <code>my-set</code> that stores IPv4 addresses.</p>
<pre><code>nft&gt; add set ip my-table my-set {type: ipv4_addr;}
</code></pre><p>Finally, we can create chains of rules that would be applied on the received packet.</p>
<h2 id="starting-point">Starting point</h2>
<p>On April 2022, David Bouman released an <a href="https://blog.dbouman.nl/2022/04/02/How-The-Tables-Have-Turned-CVE-2022-1015-1016/">article</a> about vulnerabilities wihtin the Linux kernel.
I focused my interest on the CVE-2022-1015, as it is the target of my variant analysis.
This vulnerability is very interesting because some of the out-of-bound vulnerabilities happen because the user input checks are not well implemented.
Moreover, this kind of bugs can be found both in the Linux kernel and in userland applications.
The bug associated to this vulnerability is an integer overflow located into the function <code>nft_validate_register_load</code> (<code>/net/netfilter/nf_tables_api.c</code>) at <code>(0)</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">static</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">nft_validate_register_load</span>(<span style="color:#66d9ef">enum</span> nft_registers reg, <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> len)
{
    <span style="color:#66d9ef">if</span> (reg <span style="color:#f92672">&lt;</span> NFT_REG_1 <span style="color:#f92672">*</span> NFT_REG_SIZE <span style="color:#f92672">/</span> NFT_REG32_SIZE)
        <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span>EINVAL;
	
    <span style="color:#66d9ef">if</span> (len <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
        <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span>EINVAL;
	
    <span style="color:#66d9ef">if</span> (reg <span style="color:#f92672">*</span> NFT_REG32_SIZE <span style="color:#f92672">+</span> len <span style="color:#f92672">&gt;</span> sizeof_field(<span style="color:#66d9ef">struct</span> nft_regs, data))           <span style="color:#f92672">&lt;=====</span> (<span style="color:#ae81ff">0</span>)
        <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span>ERANGE;

    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
}
</code></pre></div><p>After reading and understanding how this vulnerability works, I decided to write a CodeQL query able to find such a vulnerability.
The analysis of the different results of the query led to several candidates for CVE-2022-1015 variant.</p>
<h2 id="cve-2022-1015-variant">CVE-2022-1015 variant</h2>
<h3 id="the-bug">The bug</h3>
<p>One of these candidates hold my attention, it is located inside the function <code>nft_set_desc_concat_parse</code> (<code>/net/netfilter/nf_tables_api.c</code>).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">static</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">nft_set_desc_concat_parse</span>(<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">struct</span> nlattr <span style="color:#f92672">*</span>attr,
                     <span style="color:#66d9ef">struct</span> nft_set_desc <span style="color:#f92672">*</span>desc)
{
    <span style="color:#66d9ef">struct</span> nlattr <span style="color:#f92672">*</span>tb[NFTA_SET_FIELD_MAX <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>];
    u32 len;
    <span style="color:#66d9ef">int</span> err;

    err <span style="color:#f92672">=</span> nla_parse_nested_deprecated(tb, NFTA_SET_FIELD_MAX, attr,
                      nft_concat_policy, NULL);
    <span style="color:#66d9ef">if</span> (err <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span>)
        <span style="color:#66d9ef">return</span> err;

    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>tb[NFTA_SET_FIELD_LEN])
        <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span>EINVAL;

    len <span style="color:#f92672">=</span> ntohl(nla_get_be32(tb[NFTA_SET_FIELD_LEN]));

    <span style="color:#66d9ef">if</span> (len <span style="color:#f92672">*</span> BITS_PER_BYTE <span style="color:#f92672">/</span> <span style="color:#ae81ff">32</span> <span style="color:#f92672">&gt;</span> NFT_REG32_COUNT)             <span style="color:#f92672">&lt;=====</span> (<span style="color:#ae81ff">1</span>)
        <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span>E2BIG;

    desc<span style="color:#f92672">-&gt;</span>field_len[desc<span style="color:#f92672">-&gt;</span>field_count<span style="color:#f92672">++</span>] <span style="color:#f92672">=</span> len;                 <span style="color:#f92672">&lt;=====</span> (<span style="color:#ae81ff">2</span>)

    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
}
</code></pre></div><p>At <code>(1)</code>, we discern the pattern which matched the query.</p>
<p>Let’s focus on the left part of the comparison <code>len * BITS_PER_BYTE / 32</code>.
<code>len</code> is a 32 bits integer extracted from a netlink message with <code>nla_get_be32</code>, so we can assume that this is user controlable.
The macro <code>BITS_PER_BYTE</code> is defined in <code>/include/linux/bits.h</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#75715e">#define BITS_PER_BYTE       8
</span></code></pre></div><p>The multiplication <code>len * BITS_PER_BYTE</code> will result in left shift of three bits.
The next arithmetic operation is the division with 32, which will result in a right shift of five bits.
We understand that five bits of <code>len</code> are ignored, the three most significant and the two less significant.</p>
<p>Now, let’s have look to the right side of the comparison.
The macro <code>NFT_REG32_COUNT</code> is defined in the file <code>/include/uapi/linux/netfilter/nf_tables.h</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">enum</span> nft_registers {

    ...

    NFT_REG32_00    <span style="color:#f92672">=</span> <span style="color:#ae81ff">8</span>,
    NFT_REG32_01,
    NFT_REG32_02,
    NFT_REG32_03,
    NFT_REG32_04,
    NFT_REG32_05,
    NFT_REG32_06,
    NFT_REG32_07,
    NFT_REG32_08,
    NFT_REG32_09,
    NFT_REG32_10,
    NFT_REG32_11,
    NFT_REG32_12,
    NFT_REG32_13,
    NFT_REG32_14,
    NFT_REG32_15,
};
...
<span style="color:#75715e">#define NFT_REG32_COUNT (NFT_REG32_15 - NFT_REG32_00 + 1)
</span></code></pre></div><p>We have <code>NFT_REG32_COUNT</code> equal to <code>23 - 8 + 1 = 16</code>.</p>
<p>If we invert the condition at <code>(1)</code> in order to get a condition on <code>len</code>, we get <code>len &lt; 64</code>.
Nevertheless, in this comparison five bits are ignored, so this five bits could be used to store an unwanted value at <code>(2)</code>.</p>
<p>The next step is to find a way for a random unprivileged user to reach this buggy code.</p>
<h3 id="unprivileged-access">Unprivileged access</h3>
<p>The kernel netfilter module can be accessed from a netlink defined in <code>/net/netfilter/nfnetlink.c</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">static</span> <span style="color:#66d9ef">int</span> __net_init <span style="color:#a6e22e">nfnetlink_net_init</span>(<span style="color:#66d9ef">struct</span> net <span style="color:#f92672">*</span>net)
{
    <span style="color:#66d9ef">struct</span> nfnl_net <span style="color:#f92672">*</span>nfnlnet <span style="color:#f92672">=</span> nfnl_pernet(net);
    <span style="color:#66d9ef">struct</span> netlink_kernel_cfg cfg <span style="color:#f92672">=</span> {
        .groups <span style="color:#f92672">=</span> NFNLGRP_MAX,
        .input  <span style="color:#f92672">=</span> nfnetlink_rcv,    <span style="color:#f92672">&lt;=====</span> (<span style="color:#ae81ff">3</span>)
<span style="color:#75715e">#ifdef CONFIG_MODULES
</span><span style="color:#75715e"></span>        .bind   <span style="color:#f92672">=</span> nfnetlink_bind,
<span style="color:#75715e">#endif
</span><span style="color:#75715e"></span>    };

    nfnlnet<span style="color:#f92672">-&gt;</span>nfnl <span style="color:#f92672">=</span> netlink_kernel_create(net, NETLINK_NETFILTER, <span style="color:#f92672">&amp;</span>cfg);
    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>nfnlnet<span style="color:#f92672">-&gt;</span>nfnl)
        <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span>ENOMEM;
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
}
</code></pre></div><p>The <code>input</code> field of the structure <code>netlink_kernel_cfg</code> at <code>(3)</code> gives us the function that will be called when a message is received via the netfilter netlink.
Let’s have a look to this handler.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">nfnetlink_rcv</span>(<span style="color:#66d9ef">struct</span> sk_buff <span style="color:#f92672">*</span>skb)
{
    <span style="color:#66d9ef">struct</span> nlmsghdr <span style="color:#f92672">*</span>nlh <span style="color:#f92672">=</span> nlmsg_hdr(skb);

    <span style="color:#66d9ef">if</span> (skb<span style="color:#f92672">-&gt;</span>len <span style="color:#f92672">&lt;</span> NLMSG_HDRLEN <span style="color:#f92672">||</span>
        nlh<span style="color:#f92672">-&gt;</span>nlmsg_len <span style="color:#f92672">&lt;</span> NLMSG_HDRLEN <span style="color:#f92672">||</span>
        skb<span style="color:#f92672">-&gt;</span>len <span style="color:#f92672">&lt;</span> nlh<span style="color:#f92672">-&gt;</span>nlmsg_len)
        <span style="color:#66d9ef">return</span>;

    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>netlink_net_capable(skb, CAP_NET_ADMIN)) {                         <span style="color:#f92672">&lt;=====</span> (<span style="color:#ae81ff">4</span>)
        netlink_ack(skb, nlh, <span style="color:#f92672">-</span>EPERM, NULL);
        <span style="color:#66d9ef">return</span>;
    }

    <span style="color:#66d9ef">if</span> (nlh<span style="color:#f92672">-&gt;</span>nlmsg_type <span style="color:#f92672">==</span> NFNL_MSG_BATCH_BEGIN)
        nfnetlink_rcv_skb_batch(skb, nlh);
    <span style="color:#66d9ef">else</span>
        netlink_rcv_skb(skb, nfnetlink_rcv_msg);
}
</code></pre></div><p>We see a capability check at <code>(4)</code> done by the function <code>netlink_net_capable</code>, it’s mandatory that the user have the <code>CAP_NET_ADMIN</code> capabilities to use netfilter. 
Luckily for us, this capability could be acquired with user namespaces (<code>CONFIG_USER_NS</code>). 
User namespace have been a game changer those past few years in Linux kernel exploitation, they’ve opened a new set of attack surfaces. 
This is kind of funny, because they are also used to sandbox applications, a good example of double-edged sword.</p>
<p>Let’s get back to our topic, we can map the call path from <code>nfnetlink_rcv</code> to <code>nft_set_desc_concat_parse</code> as the following.</p>
<pre><code>nfnetlink_rcv
    nfnetlink_rcv_skb_batch
        nfnetlink_rcv_batch
            nf_tables_newset
                nf_tables_set_desc_parse
                    nft_set_desc_concat
                        nft_set_desc_concat_parse
</code></pre><p>There is not any relevant information within the intermediate functions, so we are going to ignore them for the moment.</p>
<p>If the kernel is compiled with <code>CONFIG_USER_NS</code> enabled, we will be able to reach our vulnerable code path.</p>
<p><img src="./Yet another bug into Netfilter_files/int-overflow.jpg" alt="Integer overflow verification into GDB"></p>
<h3 id="well-what-can-we-do">Well, what can we do?</h3>
<p>Sadly, it seems that this bug didn’t have any impact on the linux security.</p>
<p>Indeed, the assignment at <code>(2)</code> is hiding a cast from 32 bits unsigned integer into a 8 bits one, because the field <code>field_len</code> of the <code>nft_set_desc</code> structure is of type <code>u8</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">struct</span> nft_set_desc {
    <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span>        klen;
    <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span>        dlen;
    <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span>        size;
    u8          field_len[NFT_REG32_COUNT];
    u8          field_count;
    <span style="color:#66d9ef">bool</span>            expr;
};
</code></pre></div><p>It reduces a lot the power of this overflow as the two less significant bits can’t be used.</p>
<h2 id="a-strange-neighbor">A strange neighbor</h2>
<p>However, this is not the end of the adventure.</p>
<p>When I was looking to exploit the previous bug, something halted me: there was no checks on the index <code>field_count</code> before the assignment at <code>(2)</code>.</p>
<p>The parent function of <code>nft_set_desc_concat_parse</code> is <code>nft_set_desc_concat</code> (<code>/net/netfilter/nf_tables_api.c</code>).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">static</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">nft_set_desc_concat</span>(<span style="color:#66d9ef">struct</span> nft_set_desc <span style="color:#f92672">*</span>desc,
                   <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">struct</span> nlattr <span style="color:#f92672">*</span>nla)
{
    <span style="color:#66d9ef">struct</span> nlattr <span style="color:#f92672">*</span>attr;
    <span style="color:#66d9ef">int</span> rem, err;

    nla_for_each_nested(attr, nla, rem) {                                   <span style="color:#f92672">&lt;=====</span> (<span style="color:#ae81ff">5</span>)
        <span style="color:#66d9ef">if</span> (nla_type(attr) <span style="color:#f92672">!=</span> NFTA_LIST_ELEM)
            <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span>EINVAL;

        err <span style="color:#f92672">=</span> nft_set_desc_concat_parse(attr, desc);                        <span style="color:#f92672">&lt;=====</span> (<span style="color:#ae81ff">6</span>)
        <span style="color:#66d9ef">if</span> (err <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span>)
            <span style="color:#66d9ef">return</span> err;
    }

    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
}
</code></pre></div><p>The call to <code>nft_set_desc_concat_parse</code> is done at <code>(6)</code> but the most interesting thing is that the call is located in a loop that starts at <code>(5)</code>, and there is not any verification in the body loop on the value of <code>desc-&gt;field_count</code>.
<code>nla_for_each_nested</code> will loop over all the netlink attributes provided by the user, if the user provides more than <code>NFT_REG32_COUNT</code>, a buffer overflow will happen.</p>
<h2 id="gimme-gimme-gimme-an-infoleak-">Gimme gimme gimme an infoleak …</h2>
<p>We will see how to turn this buffer overflow into a kernel infoleak.
The first byte that will be overflown is the field <code>field_count</code> that stored the number of elements stored into the field <code>field_len</code>.
We will use this field to reach our goal.</p>
<h3 id="netfilter-sets">Netfilter sets</h3>
<p>We will use the netfilter sets, represented by the structure <code>nft_set</code> (<code>/include/net/netfilter/nf_tables.h</code>).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">struct</span> nft_set {
    <span style="color:#66d9ef">struct</span> list_head        list;
    <span style="color:#66d9ef">struct</span> list_head        bindings;
    <span style="color:#66d9ef">struct</span> nft_table        <span style="color:#f92672">*</span>table;
    possible_net_t          net;
    <span style="color:#66d9ef">char</span>                <span style="color:#f92672">*</span>name;
    u64             handle;
    u32             ktype;
    u32             dtype;
    u32             objtype;
    u32             size;
    u8              field_len[NFT_REG32_COUNT];
    u8              field_count;
    u32             use;
    atomic_t            nelems;
    u32             ndeact;
    u64             timeout;
    u32             gc_int;
    u16             policy;
    u16             udlen;
    <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">char</span>           <span style="color:#f92672">*</span>udata;
    <span style="color:#75715e">/* runtime data below here */</span>
    <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">struct</span> nft_set_ops    <span style="color:#f92672">*</span>ops ____cacheline_aligned;
    u16             flags:<span style="color:#ae81ff">14</span>,
                    genmask:<span style="color:#ae81ff">2</span>;
    u8              klen;
    u8              dlen;
    u8              num_exprs;
    <span style="color:#66d9ef">struct</span> nft_expr         <span style="color:#f92672">*</span>exprs[NFT_SET_EXPR_MAX];
    <span style="color:#66d9ef">struct</span> list_head        catchall_list;
    <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">char</span>           data[]
        __attribute__((aligned(__alignof__(u64))));
};
</code></pre></div><p>This sets are allocated into the function <code>nf_tables_newset</code> (<code>/net/netfilter/nf_tables_api.c</code>) that is a parent of the vulnerable function <code>nft_set_desc_concat_parse</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">static</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">nf_tables_newset</span>(<span style="color:#66d9ef">struct</span> sk_buff <span style="color:#f92672">*</span>skb, <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">struct</span> nfnl_info <span style="color:#f92672">*</span>info,
                <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">struct</span> nlattr <span style="color:#f92672">*</span> <span style="color:#66d9ef">const</span> nla[])
{
    <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">struct</span> nft_set_ops <span style="color:#f92672">*</span>ops;
    <span style="color:#66d9ef">struct</span> nft_set_desc desc;
    <span style="color:#66d9ef">struct</span> nft_set <span style="color:#f92672">*</span>set;
    size_t alloc_size;
    u64 size;
    ...

    memset(<span style="color:#f92672">&amp;</span>desc, <span style="color:#ae81ff">0</span>, <span style="color:#66d9ef">sizeof</span>(desc));             <span style="color:#f92672">&lt;=====</span> (<span style="color:#ae81ff">7</span>)
    
    ...
    
    <span style="color:#66d9ef">if</span> (nla[NFTA_SET_DESC] <span style="color:#f92672">!=</span> NULL) {
        err <span style="color:#f92672">=</span> nf_tables_set_desc_parse(<span style="color:#f92672">&amp;</span>desc, nla[NFTA_SET_DESC]);              <span style="color:#f92672">&lt;=====</span> (<span style="color:#ae81ff">8</span>)
        <span style="color:#66d9ef">if</span> (err <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span>)
            <span style="color:#66d9ef">return</span> err;
    }
    
    ...
    
    size <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    <span style="color:#66d9ef">if</span> (ops<span style="color:#f92672">-&gt;</span>privsize <span style="color:#f92672">!=</span> NULL)
        size <span style="color:#f92672">=</span> ops<span style="color:#f92672">-&gt;</span>privsize(nla, <span style="color:#f92672">&amp;</span>desc);
    alloc_size <span style="color:#f92672">=</span> <span style="color:#66d9ef">sizeof</span>(<span style="color:#f92672">*</span>set) <span style="color:#f92672">+</span> size <span style="color:#f92672">+</span> udlen;
    <span style="color:#66d9ef">if</span> (alloc_size <span style="color:#f92672">&lt;</span> size <span style="color:#f92672">||</span> alloc_size <span style="color:#f92672">&gt;</span> INT_MAX)
        <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span>ENOMEM;
    set <span style="color:#f92672">=</span> kvzalloc(alloc_size, GFP_KERNEL);                                     <span style="color:#f92672">&lt;=====</span> (<span style="color:#ae81ff">9</span>)
    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>set)
        <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span>ENOMEM;

    ...

    set<span style="color:#f92672">-&gt;</span>field_count <span style="color:#f92672">=</span> desc.field_count;
    <span style="color:#66d9ef">for</span> (i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> desc.field_count; i<span style="color:#f92672">++</span>)                                      <span style="color:#f92672">&lt;=====</span> (<span style="color:#ae81ff">10</span>)
        set<span style="color:#f92672">-&gt;</span>field_len[i] <span style="color:#f92672">=</span> desc.field_len[i];
        
    ...
    
}
</code></pre></div><p>We retrieve at <code>(8)</code> the call that leads to the vulnerable function.
Its first argument is the address of the local variable <code>desc</code>, that is initialized at <code>(7)</code>.
This is the object that will be modified into the function <code>nft_set_desc_concat_parse</code>.
We can see that its fields <code>field_count</code> and <code>field_len</code> are used at <code>(10)</code> and they are stored into the freshly allocated <code>nft_set</code> <code>(9)</code>.
So, if the out-of-bound has been used to override solely the field <code>field_len</code> of <code>desc</code> with a value bigger than 20 (end of the structure + alignment), some data from the stack will be copied into the <code>nft_set</code> structure at <code>(10)</code>.
It will also, in this case, produce an out-of-bound into the <code>nft_set</code> structure, but it won’t be useful for our leak.</p>
<h3 id="back-to-the-userland">Back to the userland</h3>
<p>The next step is to find a way to send back this information to userland.
In order to do so, we will use the function <code>nf_tables_getset</code> (<code>/net/netfilter/nf_tables_api.c</code>) that can be reached in a similar way of <code>nf_tables_newset</code>.
<code>nf_tables_getset</code> can be used to retrieve information about a registered set.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c">tatic <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">nf_tables_getset</span>(<span style="color:#66d9ef">struct</span> sk_buff <span style="color:#f92672">*</span>skb, <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">struct</span> nfnl_info <span style="color:#f92672">*</span>info,
                <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">struct</span> nlattr <span style="color:#f92672">*</span> <span style="color:#66d9ef">const</span> nla[])
{
    <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">struct</span> nft_set <span style="color:#f92672">*</span>set;
    <span style="color:#66d9ef">struct</span> sk_buff <span style="color:#f92672">*</span>skb2;
    <span style="color:#66d9ef">struct</span> nft_ctx ctx;
    <span style="color:#66d9ef">int</span> err;

    ...
    
    skb2 <span style="color:#f92672">=</span> alloc_skb(NLMSG_GOODSIZE, GFP_ATOMIC);
    <span style="color:#66d9ef">if</span> (skb2 <span style="color:#f92672">==</span> NULL)
        <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span>ENOMEM;

    err <span style="color:#f92672">=</span> nf_tables_fill_set(skb2, <span style="color:#f92672">&amp;</span>ctx, set, NFT_MSG_NEWSET, <span style="color:#ae81ff">0</span>);           <span style="color:#f92672">&lt;=====</span> (<span style="color:#ae81ff">11</span>)
    <span style="color:#66d9ef">if</span> (err <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span>)
        <span style="color:#66d9ef">goto</span> err_fill_set_info;

    <span style="color:#66d9ef">return</span> nfnetlink_unicast(skb2, net, NETLINK_CB(skb).portid);            <span style="color:#f92672">&lt;=====</span> (<span style="color:#ae81ff">12</span>)

}
</code></pre></div><p>This function will send data to userland through the netfilter netlink thanks to <code>nfnetlink_unicast</code> at <code>(12)</code> and this data will be setup into the call to <code>nf_tables_fill_set</code> (<code>/net/netfilter/nf_tables_api.c</code>).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">static</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">nf_tables_fill_set</span>(<span style="color:#66d9ef">struct</span> sk_buff <span style="color:#f92672">*</span>skb, <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">struct</span> nft_ctx <span style="color:#f92672">*</span>ctx,
                  <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">struct</span> nft_set <span style="color:#f92672">*</span>set, u16 event, u16 flags)
{
    <span style="color:#66d9ef">struct</span> nlmsghdr <span style="color:#f92672">*</span>nlh;
    u32 portid <span style="color:#f92672">=</span> ctx<span style="color:#f92672">-&gt;</span>portid;
    <span style="color:#66d9ef">struct</span> nlattr <span style="color:#f92672">*</span>nest;
    u32 seq <span style="color:#f92672">=</span> ctx<span style="color:#f92672">-&gt;</span>seq;
    <span style="color:#66d9ef">int</span> i;

    event <span style="color:#f92672">=</span> nfnl_msg_type(NFNL_SUBSYS_NFTABLES, event);
    nlh <span style="color:#f92672">=</span> nfnl_msg_put(skb, portid, seq, event, flags, ctx<span style="color:#f92672">-&gt;</span>family,
               NFNETLINK_V0, nft_base_seq(ctx<span style="color:#f92672">-&gt;</span>net));
               
    ...
 
    <span style="color:#66d9ef">if</span> (set<span style="color:#f92672">-&gt;</span>udata <span style="color:#f92672">&amp;&amp;</span>
        nla_put(skb, NFTA_SET_USERDATA, set<span style="color:#f92672">-&gt;</span>udlen, set<span style="color:#f92672">-&gt;</span>udata))
        <span style="color:#66d9ef">goto</span> nla_put_failure;
    
    ...
 
    <span style="color:#66d9ef">if</span> (set<span style="color:#f92672">-&gt;</span>field_count <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">&amp;&amp;</span>
        nf_tables_fill_set_concat(skb, set))                <span style="color:#f92672">&lt;=====</span> (<span style="color:#ae81ff">13</span>)
        <span style="color:#66d9ef">goto</span> nla_put_failure;
        
    ...
    
    nlmsg_end(skb, nlh);
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
    
nla_put_failure:
    nlmsg_trim(skb, nlh);
    <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>;
}
</code></pre></div><p>At <code>(13)</code>, an other auxiliary function is used to manage data concerning the fields <code>field_len</code> and <code>field_count</code> of the <code>nft_set</code> structure.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">static</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">nf_tables_fill_set_concat</span>(<span style="color:#66d9ef">struct</span> sk_buff <span style="color:#f92672">*</span>skb,
                     <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">struct</span> nft_set <span style="color:#f92672">*</span>set)
{
    <span style="color:#66d9ef">struct</span> nlattr <span style="color:#f92672">*</span>concat, <span style="color:#f92672">*</span>field;
    <span style="color:#66d9ef">int</span> i;

    concat <span style="color:#f92672">=</span> nla_nest_start_noflag(skb, NFTA_SET_DESC_CONCAT);
    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>concat)
        <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span>ENOMEM;

    <span style="color:#66d9ef">for</span> (i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> set<span style="color:#f92672">-&gt;</span>field_count; i<span style="color:#f92672">++</span>) {                <span style="color:#f92672">&lt;=====</span> (<span style="color:#ae81ff">14</span>)
        field <span style="color:#f92672">=</span> nla_nest_start_noflag(skb, NFTA_LIST_ELEM);
        <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>field)
            <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span>ENOMEM;

        <span style="color:#66d9ef">if</span> (nla_put_be32(skb, NFTA_SET_FIELD_LEN,           <span style="color:#f92672">&lt;=====</span> (<span style="color:#ae81ff">15</span>)
                 htonl(set<span style="color:#f92672">-&gt;</span>field_len[i])))
            <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span>ENOMEM;

        nla_nest_end(skb, field);
    }

    nla_nest_end(skb, concat);

    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
}
</code></pre></div><p>As we can see at <code>(14)</code>, we will iterate <code>set-&gt;field_count</code> times, and at each iteration, one element of the <code>set-&gt;field_len</code> buffer will be added to the socket buffer at <code>(15)</code>.
So if the off-by-one has been produced at <code>(2)</code> as explained previously, information stored into the stack will be copied into the heap at <code>(10)</code> and finally, the user will be able to access them thanks to sockets.</p>
<p><img src="./Yet another bug into Netfilter_files/leak.png" alt="A leak example"></p>
<p>This leak is the result of my PoC.
We can observe that it allows, in these specific circumstances, to leak a stack canary and an address of the data section.</p>
<h3 id="limitations">Limitations</h3>
<p>We have seen that the out-of-bound can lead to an infoleak, however this leak is not so powerful because it is restricted to 28 bytes due to the organization of the <code>nft_set</code> structure.
Indeed, if we want a bigger leak, it requires to overwrite the least significant bytes of the field <code>udata</code>, and it can lead to segmentation fault in the <code>nf_tables_fill_set</code> function.
Moreover, the leak is dependent on the stack organization which is itself dependent on the compilation, so this leak can provide interesting information on a specific kernel but could also be useless on the next version.</p>
<h2 id="remediation">Remediation</h2>
<p>I didn’t manage to turn this out-of-bound into a fully functional LPE exploit before it was publicly disclosed and fixed. It has been fixed on the 31st may 2022 by the commit <a href="https://git.kernel.org/pub/scm/linux/kernel/git/netfilter/nf.git/commit/?id=fecf31ee395b0295f2d7260aa29946b7605f7c85">fecf31ee395b0295f2d7260aa29946b7605f7c85</a>.
This commit is fixing both the integer overflow and the out-of-bound.
The patch of the integer overflow allows to have a length up to 255, that will had facilitated the exploitation of the vulnerability.</p>
<p>This vulnerability has been officially disclosed on <a href="https://www.openwall.com/lists/oss-security/2022/06/02/1">oss-security</a>, and the CVE-2022-1972 has been assigned to this vulnerability.</p>
<h2 id="say-lpe-again-i-dare-you">Say LPE again! I dare you!</h2>
<p>The <code>nft_set</code> structure stores several pointers, making it a good place to start.
The field <code>udata</code> stores the address at the end of the structure, address of the field <code>data</code>.
If some data are stored into the field <code>data</code>, the number of stored bytes into this field is stored in the <code>udlen</code> field.
The write primitive allows to overwrite this field, which could lead to an heap infoleak.
From this leak, we can imagine being able to get some pointers from different caches.</p>
<p>We can also try to have a random free primitive with an overflow that reaches the field <code>num_exprs</code> of the structure <code>nft_set</code> and set a bigger value than 5 (<code>NFT_SET_EXPR_MAX = 2</code>).
As a result, a part of the field <code>data</code> will also be considered as part as the field <code>exprs</code>, and we are going to obtain a full control over the stored <code>exprs</code>.
We just have to find a way to call <code>nft_expr_destroy</code>. 
So as to do that, we may try to produce an error inside the management of the expression, just after the out-of-bound inside the <code>nft_set</code> structure.</p>
<p>By combining these techniques, we should be able to get a random free primitive and try to produce use-after-free.</p>
<p>All of this is a hypothesis as it has not been tested, so it may or may not work.</p>
<h2 id="conclusion">Conclusion</h2>
<p>To sum-up, I found two bugs wihtin the kernel portion of netfilter which lead to a 28 bytes infoleak.
These bugs could not be exploited to obtain a privilege escalation due to a lack of time and weak write primitive (bytes should be lower than 67).
All the sources of my poc can be found on our <a href="https://github.com/randorisec/CVE-2022-1972-infoleak-PoC">GitHub</a>.</p>

                    </div>
                </div>
            </div>
            <div class="column">
                
<h1 class="title is-5">Categories</h1>
<div class="content">
    <p class="subtitle is-6"><a href="https://www.randorisec.fr/categories/0day">0day (13)</a></p>
    
    <p class="subtitle is-6"><a href="https://www.randorisec.fr/categories/bugbounty">Bugbounty (2)</a></p>
    
    <p class="subtitle is-6"><a href="https://www.randorisec.fr/categories/conference">Conference (19)</a></p>
    
    <p class="subtitle is-6"><a href="https://www.randorisec.fr/categories/general">General (5)</a></p>
    
    <p class="subtitle is-6"><a href="https://www.randorisec.fr/categories/gestion-de-crise">Gestion de crise (1)</a></p>
    
    <p class="subtitle is-6"><a href="https://www.randorisec.fr/categories/pentest">Pentest (30)</a></p>
    
    <p class="subtitle is-6"><a href="https://www.randorisec.fr/categories/publication">Publication (1)</a></p>
    
    <p class="subtitle is-6"><a href="https://www.randorisec.fr/categories/publications">Publications (14)</a></p>
    
    <p class="subtitle is-6"><a href="https://www.randorisec.fr/categories/responsible-disclosure">Responsible disclosure (1)</a></p>
    
    <p class="subtitle is-6"><a href="https://www.randorisec.fr/categories/responsible_disclosure">Responsible disclosure (14)</a></p>
    
    <p class="subtitle is-6"><a href="https://www.randorisec.fr/categories/swift">Swift (1)</a></p>
    
    <p class="subtitle is-6"><a href="https://www.randorisec.fr/categories/training">Training (15)</a></p>
    
    <p class="subtitle is-6"><a href="https://www.randorisec.fr/categories/workshop">Workshop (1)</a></p>
    

</div>

                
<h1 class="title is-5">Tags</h1>
<div class="field is-grouped is-grouped-multiline">
    
    
    <div class="control">
        <div class="tags are-medium">
            <a class="tag is-rounded" href="https://www.randorisec.fr/tags/0day">0day</a>
        </div>
    </div>
    
    <div class="control">
        <div class="tags are-medium">
            <a class="tag is-rounded" href="https://www.randorisec.fr/tags/linux-kernel">Linux Kernel</a>
        </div>
    </div>
    
    <div class="control">
        <div class="tags are-medium">
            <a class="tag is-rounded" href="https://www.randorisec.fr/tags/netfilter">Netfilter</a>
        </div>
    </div>
    
    
</div>
            </div>
        </div>
    </div>
</section>




<footer class="footer">
    <nav class="level">
        <div class="level-item">
            <div class="container">
                <div class="columns is-desktop is-multiline has-text-centered">
                    <div class="column">
                        <h4 class="subtitle is-5">Company</h4>
                        <br>
                        <ul>
                            
                            
                            <li>
                                <a class="subtitle is-6" href="https://www.randorisec.fr/about#history">History</a>
                            </li>
                            
                            <li>
                                <a class="subtitle is-6" href="https://www.randorisec.fr/about#our-values">Our Values</a>
                            </li>
                            
                            <li>
                                <a class="subtitle is-6" href="https://www.randorisec.fr/about#the-team">The Team</a>
                            </li>
                            
                            <li>
                                <a class="subtitle is-6" href="https://www.randorisec.fr/about#careers">Careers</a>
                            </li>
                            
                            <li>
                                <a class="subtitle is-6" href="https://www.randorisec.fr/about#testimonials">Testimonials</a>
                            </li>
                            
                            <li>
                                <a class="subtitle is-6" href="https://www.randorisec.fr/about#certifications">Certifications</a>
                            </li>
                            
                            
                        </ul>
                    </div>
                    <div class="column">
                        <h4 class="subtitle is-5">Services</h4>
                        <br>
                        
                        
                        <p><a class="subtitle is-6" href="https://www.randorisec.fr/services/penetration-test/">Penetration test</a></p>
                        
                        <p><a class="subtitle is-6" href="https://www.randorisec.fr/services/security-audit/">Security audit</a></p>
                        
                        <p><a class="subtitle is-6" href="https://www.randorisec.fr/services/training/">Training</a></p>
                        
                        <p><a class="subtitle is-6" href="https://www.randorisec.fr/services/reverse-engineering/">Reverse engineering</a></p>
                        
                        <p><a class="subtitle is-6" href="https://www.randorisec.fr/services/secops-secarch/">SecOps / SecArch</a></p>
                        
                        
                    </div>
                    <div class="column">
                        <h4 class="subtitle is-5">Resources</h4>
                        <br>
                        
                        <p><a class="subtitle is-6" href="https://www.randorisec.fr/blog/">Our Blogposts</a></p>
                        
                        
                        <p><a class="subtitle is-6" href="https://www.randorisec.fr/publications/">Publications</a></p>
                        
                        
                        <p><a class="subtitle is-6" href="https://www.randorisec.fr/contact/">How to contact us?</a></p>
                        
                        
                        <p><a class="subtitle is-6" href="https://www.randorisec.fr/legal-notice/">Legal Notice</a></p>
                        
                        
                        <p><a class="subtitle is-6" href="https://www.randorisec.fr/vulnerability-disclosure-policy/">Vulnerability Disclosure Policy</a></p>
                        

                    </div>
                    <div class="column">
                        <h4 class="subtitle is-5">Follow us</h4>
                        <br>
                        <p>
                            <a href="https://www.linkedin.com/company/randorisec/">
                                LinkedIn
                            </a>
                        </p>

                        <p>
                            <a href="https://twitter.com/randorisec" target="_blank" style="opacity: 1;">
                                Twitter
                            </a>
                        </p>

                        <p>
                            <a href="mailto:contact@randorisec.fr" target="_blank" style="opacity: 1;">
                                Email
                            </a>
                        </p>

                        <p>
                            <a href="https://www.youtube.com/channel/UC-ZfbMW6ASkAYD6wqTOT3kg" target="_blank" style="opacity: 1;">
                                Youtube
                            </a>
                        </p>

                        <p>
                            <a href="https://github.com/randorisec/" target="_blank" style="opacity: 1;">
                                Github
                            </a>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </nav>
</footer>
<nav class="level has-background-black is-mobile ">
    <div class="level-item">
        <div class="content has-text-centered">
                <h6 class="has-text-white">
                    Copyright (c) Randorisec, all rights reserved.
                </h6>
            </div>
        </div>
</nav>


</body></html>