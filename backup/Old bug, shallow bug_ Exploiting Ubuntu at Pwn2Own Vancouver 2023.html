<!DOCTYPE html>
<!-- saved from url=(0102)https://www.synacktiv.com/publications/old-bug-shallow-bug-exploiting-ubuntu-at-pwn2own-vancouver-2023 -->
<html dir="ltr" lang="fr" prefix="content: http://purl.org/rss/1.0/modules/content/  dc: http://purl.org/dc/terms/  foaf: http://xmlns.com/foaf/0.1/  og: http://ogp.me/ns#  rdfs: http://www.w3.org/2000/01/rdf-schema#  schema: http://schema.org/  sioc: http://rdfs.org/sioc/ns#  sioct: http://rdfs.org/sioc/types#  skos: http://www.w3.org/2004/02/skos/core#  xsd: http://www.w3.org/2001/XMLSchema# " class=" js"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta content="Synacktiv" property="og:site_name">
<meta content="summary_large_image" name="twitter:card">
<link href="https://www.synacktiv.com/old-bug-shallow-bug-exploiting-ubuntu-at-pwn2own-vancouver-2023" rel="canonical">
<meta content="@Synacktiv" name="twitter:site">
<meta content="Old bug, shallow bug: Exploiting Ubuntu at Pwn2Own Vancouver 2023" name="twitter:title">
<meta content="https://www.synacktiv.com/publications/old-bug-shallow-bug-exploiting-ubuntu-at-pwn2own-vancouver-2023" property="og:url">
<meta content="@Synacktiv" name="twitter:creator">
<meta content="Old bug, shallow bug: Exploiting Ubuntu at Pwn2Own Vancouver 2023" property="og:title">
<meta content="https://www.synacktiv.com/publications/old-bug-shallow-bug-exploiting-ubuntu-at-pwn2own-vancouver-2023" name="twitter:url">
<meta content="https://www.synacktiv.com/sites/default/files/styles/blog_grid_view/public/2023-09/cve_hiding.jpg" name="twitter:image">
<meta content="Synacktiv logo" name="twitter:image:alt">
<meta content="https://www.synacktiv.com/sites/default/files/styles/blog_grid_view/public/2023-09/cve_hiding.jpg" property="og:image">
<meta content="width" name="MobileOptimized">
<meta content="true" name="HandheldFriendly">
<meta content="width=device-width, initial-scale=1.0" name="viewport">
<link href="https://www.synacktiv.com/sites/default/files/favicon.ico" rel="shortcut icon" type="image/vnd.microsoft.icon">
<link href="https://www.synacktiv.com/publications/old-bug-shallow-bug-exploiting-ubuntu-at-pwn2own-vancouver-2023" hreflang="fr" rel="alternate">
<link href="https://www.synacktiv.com/en/publications/old-bug-shallow-bug-exploiting-ubuntu-at-pwn2own-vancouver-2023" hreflang="en" rel="alternate">
<link href="https://www.synacktiv.com/publications/old-bug-shallow-bug-exploiting-ubuntu-at-pwn2own-vancouver-2023" rel="revision">
<title>Old bug, shallow bug: Exploiting Ubuntu at Pwn2Own Vancouver 2023</title>
<link href="./Old bug, shallow bug_ Exploiting Ubuntu at Pwn2Own Vancouver 2023_files/css_cdrGS_B9PyjHsXrOzsLk3RX3ouvAQnR_CFdR2uSCwnQ.css" media="all" rel="stylesheet">
<link href="./Old bug, shallow bug_ Exploiting Ubuntu at Pwn2Own Vancouver 2023_files/css_UvNBJL9uEjPIehHKnKil4Hv3zyAM-9T9XaGwc4NGbGk.css" media="all" rel="stylesheet">
<link href="./Old bug, shallow bug_ Exploiting Ubuntu at Pwn2Own Vancouver 2023_files/print.css%3Frz4ixi.css" media="all" rel="stylesheet">
<!--[if lte IE 8]>
<script src="/sites/default/files/js/js_VtafjXmRvoUgAzqzYTA3Wrjkx9wcWhjP0G4ZnnqRamA.js"></script>
<![endif]-->
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async="" src="./Old bug, shallow bug_ Exploiting Ubuntu at Pwn2Own Vancouver 2023_files/icons.29.svg.js.下載"></script><script type="text/javascript" async="" src="./Old bug, shallow bug_ Exploiting Ubuntu at Pwn2Own Vancouver 2023_files/analytics.js.下載"></script><script type="text/javascript" async="" src="./Old bug, shallow bug_ Exploiting Ubuntu at Pwn2Own Vancouver 2023_files/js"></script><script async="" src="./Old bug, shallow bug_ Exploiting Ubuntu at Pwn2Own Vancouver 2023_files/js(1)"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());

gtag('config', 'UA-179971223-1');
</script>
<style type="text/css">.a2a_menu,.a2a_menu *{-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box;float:none;margin:0;padding:0;position:static;height:auto;width:auto}.a2a_menu{border-radius:6px;display:none;direction:ltr;background:#FFF;font:16px sans-serif-light,HelveticaNeue-Light,"Helvetica Neue Light","Helvetica Neue",Arial,Helvetica,"Liberation Sans",sans-serif;color:#000;line-height:12px;border:1px solid #CCC;vertical-align:baseline;outline:0;overflow:hidden}.a2a_mini{min-width:200px;position:absolute;width:300px;z-index:9999997}.a2a_overlay{display:none;background:#616c7d;_height:expression( ((e=document.documentElement.clientHeight)?e:document.body.clientHeight)+"px" );_width:expression( ((e=document.documentElement.clientWidth)?e:document.body.clientWidth)+"px" );filter:alpha(opacity=90);opacity:.92;backdrop-filter:blur(8px);position:fixed;_position:absolute;top:0;right:0;left:0;bottom:0;z-index:9999998;-webkit-tap-highlight-color:rgba(0,0,0,0);transition:opacity .14s,backdrop-filter .14s}.a2a_full{background:#FFF;border:1px solid #FFF;height:auto;height:calc(320px);top:15%;_top:expression(40+((e=document.documentElement.scrollTop)?e:document.body.scrollTop)+"px");left:50%;margin-left:-320px;position:fixed;_position:absolute;text-align:center;width:640px;z-index:9999999;transition:transform .14s,opacity .14s}.a2a_full_footer,.a2a_full_header,.a2a_full_services{border:0;margin:0;padding:12px;box-sizing:border-box}.a2a_full_header{padding-bottom:8px}.a2a_full_services{height:280px;overflow-y:scroll;padding:0 12px;-webkit-overflow-scrolling:touch}.a2a_full_services .a2a_i{display:inline-block;float:none;width:181px;width:calc(33.334% - 18px)}div.a2a_full_footer{font-size:12px;text-align:center;padding:8px 14px}div.a2a_full_footer a,div.a2a_full_footer a:visited{display:inline;font-size:12px;line-height:14px;padding:8px 14px}div.a2a_full_footer a:focus,div.a2a_full_footer a:hover{background:0 0;border:0;color:#0166FF}div.a2a_full_footer a span.a2a_s_a2a,div.a2a_full_footer a span.a2a_w_a2a{background-size:14px;border-radius:3px;display:inline-block;height:14px;line-height:14px;margin:0 3px 0 0;vertical-align:top;*vertical-align:middle;width:14px}.a2a_modal{height:0;left:50%;margin-left:-320px;position:fixed;_position:absolute;text-align:center;top:15%;_top:expression(40+((e=document.documentElement.scrollTop)?e:document.body.scrollTop)+"px");width:640px;z-index:9999999;transition:transform .14s,opacity .14s;-webkit-tap-highlight-color:rgba(0,0,0,0)}.a2a_modal_body{background:0 0;border:0;font:24px sans-serif-light,HelveticaNeue-Light,"Helvetica Neue Light","Helvetica Neue",Arial,Helvetica,"Liberation Sans",sans-serif;position:relative;height:auto;width:auto}.a2a_thanks{color:#fff;height:auto;margin-top:20px;width:auto}.a2a_thanks>div:first-child{margin:0 0 40px 0}.a2a_thanks div *{height:inherit}#a2a_copy_link{background:#FFF;border:1px solid #FFF;margin-top:15%}span.a2a_s_link#a2a_copy_link_icon,span.a2a_w_link#a2a_copy_link_icon{background-size:48px;border-radius:0;display:inline-block;height:48px;left:0;line-height:48px;margin:0 3px 0 0;position:absolute;vertical-align:top;*vertical-align:middle;width:48px}#a2a_modal input#a2a_copy_link_text{background-color:transparent;_background-color:#FFF;border:0;color:#2A2A2A;font:inherit;height:48px;left:62px;max-width:initial;padding:0;position:relative;width:564px;width:calc(100% - 76px)}#a2a_copy_link_copied{background-color:#0166ff;color:#fff;display:none;font:inherit;font-size:16px;margin-top:1px;padding:3px 8px}@media (prefers-color-scheme:dark){.a2a_menu a,.a2a_menu a.a2a_i,.a2a_menu a.a2a_i:visited,.a2a_menu a.a2a_more,i.a2a_i{border-color:#2a2a2a!important;color:#fff!important}.a2a_menu a.a2a_i:active,.a2a_menu a.a2a_i:focus,.a2a_menu a.a2a_i:hover,.a2a_menu a.a2a_more:active,.a2a_menu a.a2a_more:focus,.a2a_menu a.a2a_more:hover,.a2a_menu_find_container{border-color:#444!important;background-color:#444!important}.a2a_menu{background-color:#2a2a2a;border-color:#2a2a2a}.a2a_menu_find{color:#fff!important}.a2a_menu span.a2a_s_find svg{background-color:transparent!important}.a2a_menu span.a2a_s_find svg path{fill:#fff!important}}@media print{.a2a_floating_style,.a2a_menu,.a2a_overlay{visibility:hidden}}@keyframes a2aFadeIn{from{opacity:0}to{opacity:1}}.a2a_starting{opacity:0}.a2a_starting.a2a_full,.a2a_starting.a2a_modal{transform:scale(.8)}@media (max-width:639px){.a2a_full{border-radius:0;top:15%;left:0;margin-left:auto;width:100%}.a2a_modal{left:0;margin-left:10px;width:calc(100% - 20px)}}@media (min-width:318px) and (max-width:437px){.a2a_full .a2a_full_services .a2a_i{width:calc(50% - 18px)}}@media (max-width:317px){.a2a_full .a2a_full_services .a2a_i{width:calc(100% - 18px)}}@media (max-height:436px){.a2a_full{bottom:40px;height:auto;top:40px}}@media (max-height:550px){.a2a_modal{top:30px}}@media (max-height:360px){.a2a_modal{top:20px}.a2a_thanks>div:first-child{margin-bottom:20px}}.a2a_menu a{color:#0166FF;text-decoration:none;font:16px sans-serif-light,HelveticaNeue-Light,"Helvetica Neue Light","Helvetica Neue",Arial,Helvetica,"Liberation Sans",sans-serif;line-height:14px;height:auto;width:auto;outline:0;-moz-outline:none}.a2a_menu a.a2a_i:visited,.a2a_menu a.a2a_more{color:#0166FF}.a2a_menu a.a2a_i:active,.a2a_menu a.a2a_i:focus,.a2a_menu a.a2a_i:hover,.a2a_menu a.a2a_more:active,.a2a_menu a.a2a_more:focus,.a2a_menu a.a2a_more:hover{color:#2A2A2A;border-color:#EEE;border-style:solid;background-color:#EEE;text-decoration:none}.a2a_menu span.a2a_s_find{background-size:24px;height:24px;left:8px;position:absolute;top:7px;width:24px}.a2a_menu span.a2a_s_find svg{background-color:#FFF}.a2a_menu span.a2a_s_find svg path{fill:#CCC}#a2a_menu_container{display:inline-block}#a2a_menu_container{_display:inline}.a2a_menu_find_container{border:1px solid #CCC;border-radius:6px;padding:2px 24px 2px 0;position:relative;text-align:left}.a2a_cols_container .a2a_col1{overflow-x:hidden;overflow-y:auto;-webkit-overflow-scrolling:touch}#a2a_modal input,#a2a_modal input[type=text],.a2a_menu input,.a2a_menu input[type=text]{display:block;background-image:none;box-shadow:none;line-height:100%;margin:0;outline:0;overflow:hidden;padding:0;-moz-box-shadow:none;-webkit-box-shadow:none;-webkit-appearance:none}#a2apage_find_container input,#a2apage_find_container input[type=text]{background-color:transparent;_background-color:#FFF;border:0;box-sizing:content-box;color:#2A2A2A;font:inherit;font-size:16px;height:28px;line-height:20px;left:38px;outline:0;margin:0;max-width:initial;padding:2px 0;position:relative;width:99%}.a2a_clear{clear:both} .a2a_svg{background-repeat:no-repeat;display:block;overflow:hidden;height:32px;line-height:32px;padding:0;width:32px}.a2a_svg svg{background-repeat:no-repeat;background-position:50% 50%;border:none;display:block;left:0;margin:0 auto;overflow:hidden;padding:0;position:relative;top:0;width:auto;height:auto}a.a2a_i,i.a2a_i{display:block;float:left;border:1px solid #FFF;line-height:24px;padding:6px 8px;text-align:left;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;width:132px}a.a2a_i span,a.a2a_more span{display:inline-block;overflow:hidden;vertical-align:top;*vertical-align:middle}a.a2a_i .a2a_svg{margin:0 6px 0 0}a.a2a_i .a2a_svg,a.a2a_more .a2a_svg{background-size:24px;height:24px;line-height:24px;width:24px}a.a2a_sss:hover{border-left:1px solid #CCC}a.a2a_menu_show_more_less{border-bottom:1px solid #FFF;border-left:0;border-right:0;line-height:24px;margin:6px 0 0;padding:6px;-webkit-touch-callout:none}a.a2a_menu_show_more_less span{display:inline-block;height:24px;margin:0 6px 0 0}.a2a_kit .a2a_svg{background-repeat:repeat}.a2a_default_style a{float:left;line-height:16px;padding:0 2px}.a2a_default_style a:hover .a2a_svg,.a2a_floating_style a:hover .a2a_svg,.a2a_overlay_style a:hover .a2a_svg svg{opacity:.7}.a2a_overlay_style.a2a_default_style a:hover .a2a_svg{opacity:1}.a2a_default_style .a2a_count,.a2a_default_style .a2a_svg,.a2a_floating_style .a2a_svg,.a2a_menu .a2a_svg,.a2a_vertical_style .a2a_count,.a2a_vertical_style .a2a_svg{border-radius:4px}.a2a_default_style .a2a_counter img,.a2a_default_style .a2a_dd,.a2a_default_style .a2a_svg{float:left}.a2a_default_style .a2a_img_text{margin-right:4px}.a2a_default_style .a2a_divider{border-left:1px solid #000;display:inline;float:left;height:16px;line-height:16px;margin:0 5px}.a2a_kit a{cursor:pointer}.a2a_floating_style{background-color:#fff;border-radius:6px;position:fixed;z-index:9999995}.a2a_overlay_style{z-index:2147483647}.a2a_floating_style,.a2a_overlay_style{animation:a2aFadeIn .2s ease-in;padding:4px}.a2a_vertical_style a{clear:left;display:block;overflow:hidden;padding:4px;text-decoration:none}.a2a_floating_style.a2a_default_style{bottom:0}.a2a_floating_style.a2a_default_style a,.a2a_overlay_style.a2a_default_style a{padding:4px}.a2a_count{background-color:#fff;border:1px solid #ccc;box-sizing:border-box;color:#2a2a2a;display:block;float:left;font:12px Arial,Helvetica,sans-serif;height:16px;margin-left:4px;position:relative;text-align:center;width:50px}.a2a_count:after,.a2a_count:before{border:solid transparent;border-width:4px 4px 4px 0;content:"";height:0;left:0;line-height:0;margin:-4px 0 0 -4px;position:absolute;top:50%;width:0}.a2a_count:before{border-right-color:#ccc}.a2a_count:after{border-right-color:#fff;margin-left:-3px}.a2a_count span{animation:a2aFadeIn .14s ease-in}.a2a_vertical_style .a2a_counter img{display:block}.a2a_vertical_style .a2a_count{float:none;margin-left:0;margin-top:6px}.a2a_vertical_style .a2a_count:after,.a2a_vertical_style .a2a_count:before{border:solid transparent;border-width:0 4px 4px 4px;content:"";height:0;left:50%;line-height:0;margin:-4px 0 0 -4px;position:absolute;top:0;width:0}.a2a_vertical_style .a2a_count:before{border-bottom-color:#ccc}.a2a_vertical_style .a2a_count:after{border-bottom-color:#fff;margin-top:-3px}.a2a_nowrap{white-space:nowrap}.a2a_note{margin:0 auto;padding:9px;font-size:12px;text-align:center}.a2a_note .a2a_note_note{margin:0;color:#2A2A2A}.a2a_wide a{display:block;margin-top:3px;border-top:1px solid #EEE;text-align:center}.a2a_label{position:absolute!important;clip:rect(1px 1px 1px 1px);clip:rect(1px,1px,1px,1px);clip-path:polygon(0 0,0 0,0 0);-webkit-clip-path:polygon(0 0,0 0,0 0);overflow:hidden;height:1px;width:1px}.a2a_kit,.a2a_menu,.a2a_modal,.a2a_overlay{-ms-touch-action:manipulation;touch-action:manipulation}.a2a_dd img{border:0}.a2a_button_facebook_like iframe{max-width:none}</style><style type="text/css">.medium-zoom-overlay{position:fixed;top:0;right:0;bottom:0;left:0;opacity:0;transition:opacity .3s;will-change:opacity}.medium-zoom--opened .medium-zoom-overlay{cursor:pointer;cursor:zoom-out;opacity:1}.medium-zoom-image{cursor:pointer;cursor:zoom-in;transition:transform .3s cubic-bezier(.2,0,.2,1)!important}.medium-zoom-image--hidden{visibility:hidden}.medium-zoom-image--opened{position:relative;cursor:pointer;cursor:zoom-out;will-change:transform}</style></head>
<body class="page-node-861 path-node page-node-type-article">
<a class="visually-hidden focusable skip-link" href="https://www.synacktiv.com/publications/old-bug-shallow-bug-exploiting-ubuntu-at-pwn2own-vancouver-2023#main-content">
      Aller au contenu principal
    </a>
<div class="dialog-off-canvas-main-canvas" data-off-canvas-main-canvas="">
<div class="header-outer">
<div class="header-inner">
<div class="container">
<div class="top-bar">
<div class="region region-top-bar">
<section class="block block-dropdown-language block-dropdown-languagelanguage-interface clearfix" id="block-dropdownlanguage">
<div class="search-link"><a href="https://www.synacktiv.com/search"><i aria-hidden="true" class="fa fa-search"></i> Rechercher</a></div>
<div class="form-item js-form-item form-wrapper js-form-wrapper panel panel-default" id="bootstrap-panel">
<div class="container">
<div class="panel-heading">
<div class="panel-title">Switch Language</div>
</div>
<div class="panel-body">
<div class="dropdown-language-item btn-group dropdown">
<button class="language-link active-language button js-form-submit form-submit btn-default btn" data-dropdown-target="#dropdown-item-1693561652" formnovalidate="formnovalidate" hreflang="fr" name="op" type="submit" value="FR">FR</button><button aria-expanded="false" aria-haspopup="true" class="btn-default btn dropdown-toggle" data-toggle="dropdown" type="button"><span class="caret"></span><span class="sr-only">Toggle Dropdown</span></button>
<ul class="dropdown-menu" role="menu"><li hreflang="fr"><span class="language-link active-language hidden" formnovalidate="formnovalidate" hreflang="fr" id="dropdown-item-1693561652">FR</span></li><li hreflang="en"><a class="language-link" formnovalidate="formnovalidate" href="https://www.synacktiv.com/en/publications/old-bug-shallow-bug-exploiting-ubuntu-at-pwn2own-vancouver-2023" hreflang="en" id="ajax-link-1693561652">EN</a></li></ul>
</div>
</div>
</div>
</div>
</section>
<section class="block block-block-content block-block-contente1d0bd6e-e175-4e9b-9fb8-a6322c75441a clearfix" id="block-socialmedia">
<div class="item-list item-list--linkicon"><ul class="linkicon linkicon--inline linkicon--no-text" id="linkicon-block-content-social-media-field-social-media-3"><li><a class="linkicon__item" href="https://github.com/Synacktiv" target="_blank"><span aria-hidden="true" class="linkicon__icon icon fa fa-github"></span><span class="linkicon__text">Github</span></a></li><li><a class="linkicon__item" href="https://twitter.com/synacktiv" target="_blank"><span aria-hidden="true" class="linkicon__icon icon fa fa-twitter"></span><span class="linkicon__text">Twitter</span></a></li><li><a class="linkicon__item" href="https://fr.linkedin.com/company/synacktiv" target="_blank"><span aria-hidden="true" class="linkicon__icon icon fa fa-linkedin"></span><span class="linkicon__text">Linkedin</span></a></li></ul></div>
</section>
</div>
</div>
<div class="main-header">
<div class="region region-header">
<a class="logo navbar-btn pull-left" href="https://www.synacktiv.com/index" rel="home" title="Accueil">
<img alt="Accueil" src="./Old bug, shallow bug_ Exploiting Ubuntu at Pwn2Own Vancouver 2023_files/logo_synacktiv_blanc.png">
</a>
<section class="block block-superfish block-superfishmain clearfix" id="block-mainnavigation">
<ul class="menu sf-menu sf-main sf-horizontal sf-style-none sf-js-enabled sf-shadow" id="superfish-main">
<li class="sf-depth-1 menuparent" id="main-menu-link-contentb1f6692b-12b2-4613-aa64-67af9be15b81"><a class="sf-depth-1 menuparent sf-with-ul" href="https://www.synacktiv.com/notre-offre">Notre Offre<span class="sf-sub-indicator"> »</span></a><ul style="float: none; width: 13.7857em;" class="sf-hidden"><li class="sf-depth-2 sf-no-children" id="main-menu-link-content76ea8d8a-879d-49c9-ac0c-05fbaba2f8da" style=""><a class="sf-depth-2" href="https://www.synacktiv.com/prestations/test-dintrusionred-team" style="">Test d’intrusion / Red Team</a></li><li class="sf-depth-2 sf-no-children" id="main-menu-link-content30f5ef9c-84b2-4dab-984d-04b24a86fbbc" style=""><a class="sf-depth-2" href="https://www.synacktiv.com/prestations/reponse-aux-incidents" style="">Réponse aux incidents</a></li><li class="sf-depth-2 sf-no-children" id="main-menu-link-content6f4a2b35-6ffd-46a0-b74e-ff705e822bd2" style=""><a class="sf-depth-2" href="https://www.synacktiv.com/offres/formations" style="">Formations</a></li><li class="sf-depth-2 sf-no-children" id="main-menu-link-content7b20b7d6-5054-43b9-bb6e-6e3f53ddec09" style=""><a class="sf-depth-2" href="https://www.synacktiv.com/prestations/reverse-engineering" style="">Reverse-engineering</a></li><li class="sf-depth-2 sf-no-children" id="main-menu-link-contentc4ba7eec-ad2a-478e-a5d1-abd1cc26e2bc" style=""><a class="sf-depth-2" href="https://www.synacktiv.com/notre-equipe/developpement" style="">Développement</a></li><li class="sf-depth-2 sf-no-children" id="main-menu-link-content1c89e60c-b5be-4937-9149-33132a0b77e6" style=""><a class="sf-depth-2" href="https://www.synacktiv.com/produits/kraqozorus" style="">Produits</a></li><li class="sf-depth-2 sf-no-children" id="main-menu-link-content588748bd-b280-4e46-aa81-6bcf1838cfec" style=""><a class="sf-depth-2" href="https://www.synacktiv.com/csirt" style="">CSIRT</a></li></ul></li><li class="sf-depth-1 sf-no-children" id="main-menu-link-content7b941be1-6abc-4440-908b-f1231838b656"><a class="sf-depth-1" href="https://www.synacktiv.com/nous-rejoindre">Nous rejoindre</a></li><li class="active-trail sf-depth-1 menuparent" id="main-menu-link-content23c47262-3e64-4507-8ad4-7019b5fe572a"><a class="sf-depth-1 menuparent sf-with-ul" href="https://www.synacktiv.com/nos-publications">Publications<span class="sf-sub-indicator"> »</span></a><ul style="float: none; width: 12em;" class="sf-hidden"><li class="active-trail sf-depth-2 sf-no-children" id="main-menu-link-contente57a67d4-5094-4d76-b684-50b95c594a92" style=""><a class="sf-depth-2" href="https://www.synacktiv.com/publications" style="">Articles</a></li><li class="sf-depth-2 sf-no-children" id="main-menu-link-contentdc127af3-02e3-4f2c-9b35-223f94c7b7b7" style=""><a class="sf-depth-2" href="https://www.synacktiv.com/advisories" style="">Avis de sécurité</a></li><li class="sf-depth-2 sf-no-children" id="main-menu-link-contentdc984d98-8791-42d3-88a2-3dffa6db478c" style=""><a class="sf-depth-2" href="https://www.synacktiv.com/ressources" style="">Ressources</a></li></ul></li><li class="sf-depth-1 sf-no-children" id="main-menu-link-contentbb3e5f45-fa45-42b0-a2fe-1a89e07c4059"><a class="sf-depth-1" href="https://www.synacktiv.com/la-societe">La société</a></li><li class="sf-depth-1 sf-no-children" id="main-menu-link-contentd5edd642-8078-459a-9b1f-a6b2d4f65aa2"><a class="sf-depth-1" href="https://www.synacktiv.com/contact">Contact</a></li>
</ul>
</section>
</div>
</div>
</div>
</div>
</div>
<div class="banner">
<div class="region region-banner">
<section class="block page-header block-block-content block-block-contentb084ab8a-3baf-4a93-b927-57e3efdc0802 clearfix" id="block-publicationsdetailheader">
<div class="background-image" style="background-image: url(../sites/default/files/styles/page_header/public/2019-11/header-background_1.jpg)">
</div>
</section>
</div>
</div>
<div class="main-page-content">
<div class="page-content-left sidebar-content">
<div class="item-wrapper">
<div class="social-icons-item">
<div class="item-list item-list--linkicon"><ul class="linkicon linkicon--inline linkicon--no-text" id="linkicon-block-content-social-media-field-social-media-25"><li><a class="linkicon__item" href="https://github.com/Synacktiv" target="_blank"><span aria-hidden="true" class="linkicon__icon icon fa fa-github"></span><span class="linkicon__text">Github</span></a></li><li><a class="linkicon__item" href="https://twitter.com/synacktiv" target="_blank"><span aria-hidden="true" class="linkicon__icon icon fa fa-twitter"></span><span class="linkicon__text">Twitter</span></a></li><li><a class="linkicon__item" href="https://fr.linkedin.com/company/synacktiv" target="_blank"><span aria-hidden="true" class="linkicon__icon icon fa fa-linkedin"></span><span class="linkicon__text">Linkedin</span></a></li></ul></div>
</div>
</div>
</div>
<div class="page-content-right">
<div class="banner-bottom">
<div class="container">
<div class="region region-banner-bottom">
<div class="hidden" data-drupal-messages-fallback=""></div>
</div>
</div>
</div>
<div class="content">
<div class="container">
<div class="region region-content">
<article about="/publications/old-bug-shallow-bug-exploiting-ubuntu-at-pwn2own-vancouver-2023" class="article full clearfix" role="article" typeof="schema:Article">
<div class="content">
<div class="title-wrapper">
<h1><span property="schema:name">Old bug, shallow bug: Exploiting Ubuntu at Pwn2Own Vancouver 2023</span>
</h1>
<div class="short-info">
        Rédigé par
   <span class="author-name">Tanguy Dubroca </span>
           - 01/09/2023 - dans 
   <span class="category">Exploit</span>
<span class="publication-download">
 - <a href="https://www.synacktiv.com/publications/old-bug-shallow-bug-exploiting-ubuntu-at-pwn2own-vancouver-2023#" onclick="window.print()">Téléchargement</a>
<i aria-hidden="true" class="fa fa-download fa-lg"></i>
</span>
</div>
</div>
<div class="introduction">
<p>At this year Pwn2Own Vancouver we demonstrated Local Escalation of Privilege (LPE) exploits for the three desktop operating systems present at the competition: Windows, MacOS and Linux (Ubuntu). This blogpost explores the Ubuntu entry exploiting CVE-2023-35001, a 9 year old vulnerability in the Linux Kernel.</p>
</div>
<div class="field field--name-body field--type-text-with-summary field--label-hidden field--item" property="schema:text"><h2 id="introduction">Introduction</h2>
<p>The surface available at Pwn2Own for LPEs is restricted to the kernel code. Through a survey of public exploits at the time of research, we found two areas in particular which were heavily targeted for exploitation.</p>
<p>The first is kernel code accessible through user namespaces. On most Linux distributions the default configuration exposes a pretty restricted attack surface, with most of the interesting functionality gated behind permission or capability checks. On Ubuntu, however, it is possible to completely open up the attack surface through the use of user namespaces, which are allowed for unprivileged users (through the <code>kernel.unprivileged_userns_clone</code> sysctl).</p>
<p>Then comes io_uring, a complex kernel subsystem used for fast asynchronous IO. This surface has been really popular for kernel exploits lately. So popular in fact that Google decided to <a href="https://security.googleblog.com/2023/06/learnings-from-kctf-vrps-42-linux.html">remove</a> io_uring from their kernelCTF builds of the linux kernel, as more than 60% of the exploits were targetting this subsystem in particular. From an attacker standpoint io_uring is interesting as the code is extremely complex, moves around a lot, and constantly grows to interact with additional parts of the kernel. It is also still accessible to unprivileged users on Ubuntu kernels.</p>
<p>In the end however we settled on the first option and chose to target kernel code accessible through user namespaces. One subsystem in particular caught our attention, <strong>nftables</strong>. Throughout <strong>2022</strong> and <strong>2023</strong> more than a dozen vulnerabilities were found in this subsystem and multiple LPE exploits relied on them.</p>
<p>An audit of this subsystem allowed us to discover a vulnerability, present since the introduction of nftables in the linux kernel back in version 3.13.</p>
<h2 id="exploit">Exploit</h2>
<h3 id="nftables-101-core-objects">nftables 101: Core objects</h3>
<p>The nftables subsystem implements a register based virtual machine for packet filtering. It revolves around a few nested components: tables, chains, rules and expressions.</p>
<p>Expressions are the lowest level object and the actual instructions executed by the vm. They operate on the payload or metadata of incoming packets and implement basic operations (byte comparisons, arithmetic operations, set manipulation, ...). In memory, expressions are composed of a vtable pointer followed by variable length expression specific data:</p>
<div class="sourceCode" id="cb1">
<pre><code class="sourceCode cpp hljs"><span id="cb1-1"><span class="kw"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> <span class="hljs-title">nft_expr</span> </span><span class="op"><span class="hljs-class">{</span></span></span>
<span id="cb1-2">    <span class="at"><span class="hljs-keyword">const</span></span> <span class="kw"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> <span class="hljs-title">nft_expr_ops</span> </span><span class="op"><span class="hljs-class">*</span></span><span class="hljs-class"><span class="hljs-title">ops</span></span><span class="op"><span class="hljs-class">;</span></span></span>
<span id="cb1-3">    <span class="dt"><span class="hljs-keyword">unsigned</span></span> <span class="dt"><span class="hljs-keyword">char</span></span> data<span class="op">[]</span></span>
<span id="cb1-4">        <span class="ex">__attribute__((aligned(__alignof__(u64)))</span><span class="op">);</span></span>
<span id="cb1-5"><span class="op">};</span></span></code></pre>
</div>
<p>These expressions are bundled into rules, which are akin to statements in higher level languages. The vm executes each expression inside a rule and stops when either all expressions were executed, or when an expression sets the verdict register to something different from <code>NFT_CONTINUE</code>. The rule object is composed of a small header followed by an inline array of expressions:</p>
<div class="sourceCode" id="cb2">
<pre><code class="sourceCode cpp hljs"><span id="cb2-1"><span class="kw"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> <span class="hljs-title">nft_rule_dp</span> </span><span class="op"><span class="hljs-class">{</span></span></span>
<span id="cb2-2">    u64 is_last<span class="op">:</span><span class="dv"><span class="hljs-number">1</span></span><span class="op">,</span> dlen<span class="op">:</span><span class="dv"><span class="hljs-number">12</span></span><span class="op">,</span> handle<span class="op">:</span><span class="dv"><span class="hljs-number">42</span></span><span class="op">;</span>    <span class="co"><span class="hljs-comment">/* for tracing */</span></span></span>
<span id="cb2-3">    <span class="dt"><span class="hljs-keyword">unsigned</span></span> <span class="dt"><span class="hljs-keyword">char</span></span> data<span class="op">[]</span></span>
<span id="cb2-4">        <span class="ex">__attribute__((aligned(__alignof__(struct nft_expr)))</span><span class="op">);</span></span>
<span id="cb2-5"><span class="op">};</span></span></code></pre>
</div>
<p>Chains are akin to functions in high level languages. They have a name and contain a list of rules to be executed. Like functions, chains can be called or jumped to using expressions. Much like the rule object, the chain object represents the list of rules as an object with a small header followed by an inline array of rule objects:</p>
<div class="sourceCode" id="cb3">
<pre><code class="sourceCode cpp hljs"><span id="cb3-1"><span class="kw"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> <span class="hljs-title">nft_rule_blob</span> </span><span class="op"><span class="hljs-class">{</span></span></span>
<span id="cb3-2">    <span class="dt"><span class="hljs-keyword">unsigned</span></span> <span class="dt"><span class="hljs-keyword">long</span></span> size<span class="op">;</span></span>
<span id="cb3-3">    <span class="dt"><span class="hljs-keyword">unsigned</span></span> <span class="dt"><span class="hljs-keyword">char</span></span> data<span class="op">[]</span></span>
<span id="cb3-4">        <span class="ex">__attribute__((aligned(__alignof__(struct nft_rule_dp)))</span><span class="op">);</span></span>
<span id="cb3-5"><span class="op">};</span></span></code></pre>
</div>
<p>The top level object is the table, which is a container for chains. For the purpose of this blogpost, there is nothing more to know about it.</p>
<h3 id="nftables-101-usage">nftables 101: Usage</h3>
<p>The nftables code is executed during two distinct phases, configuration and evaluation.</p>
<p>In the configuration phase, userland binaries such as <code>nft</code> communicate through netlink with nftables to prepare the firewall. Top level objects such as tables or chains are created directly, and objects such as rules and expressions are compiled down to bytecode before being sent through netlink. Sanity checks are done during this phase to prevent installing dangerous operations. For example, checks are done on loads and stores of registers to verify that the operations stay within the bounds of the register array.</p>
<p>The evaluation phase occurs when a packet is received. The vm executes the configured firewall operations and returns a verdict about what the network stack should do with the packet. It is interesting to note here that almost no checks are done during expression evaluation, as everything should have been checked during configuration. Being able to corrupt expressions after configuration could thus give powerful exploit primitives.</p>
<h3 id="vulnerability-description">Vulnerability description</h3>
<p>The vulnerability found during the audit occurs during the evaluation of the <code>nft_byteorder</code> expression. This operation implements endianness swapping of the vm's register contents. It takes in a length, representing the total number of bytes on which to operate, as well an element size which can be 2, 4 or 8 bytes wide. The vulnerability occurs in the handling of 16 bits elements:</p>
<div class="sourceCode" id="cb4">
<pre><code class="sourceCode cpp hljs"><span id="cb4-1"><span class="dt"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> <span class="hljs-title">nft_byteorder_eval</span></span><span class="op"><span class="hljs-function"><span class="hljs-params">(</span></span></span><span class="at"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="kw"><span class="hljs-function"><span class="hljs-params">struct</span></span></span><span class="hljs-function"><span class="hljs-params"> nft_expr </span></span><span class="op"><span class="hljs-function"><span class="hljs-params">*</span></span></span><span class="hljs-function"><span class="hljs-params">expr</span></span><span class="op"><span class="hljs-function"><span class="hljs-params">,</span></span></span></span><span class="hljs-function"><span class="hljs-params">
</span></span><span id="cb4-2"><span class="hljs-function"><span class="hljs-params">          </span></span><span class="kw"><span class="hljs-function"><span class="hljs-params">struct</span></span></span><span class="hljs-function"><span class="hljs-params"> nft_regs </span></span><span class="op"><span class="hljs-function"><span class="hljs-params">*</span></span></span><span class="hljs-function"><span class="hljs-params">regs</span></span><span class="op"><span class="hljs-function"><span class="hljs-params">,</span></span></span></span><span class="hljs-function"><span class="hljs-params">
</span></span><span id="cb4-3"><span class="hljs-function"><span class="hljs-params">          </span></span><span class="at"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="kw"><span class="hljs-function"><span class="hljs-params">struct</span></span></span><span class="hljs-function"><span class="hljs-params"> nft_pktinfo </span></span><span class="op"><span class="hljs-function"><span class="hljs-params">*</span></span></span><span class="hljs-function"><span class="hljs-params">pkt</span></span><span class="op"><span class="hljs-function"><span class="hljs-params">)</span></span></span></span><span class="hljs-function">
</span><span id="cb4-4"><span class="op">{</span></span>
<span id="cb4-5">  <span class="at"><span class="hljs-keyword">const</span></span> <span class="kw"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> <span class="hljs-title">nft_byteorder</span> </span><span class="op"><span class="hljs-class">*</span></span><span class="hljs-class"><span class="hljs-title">priv</span> </span><span class="op"><span class="hljs-class">=</span></span><span class="hljs-class"> <span class="hljs-title">nft_expr_priv</span></span><span class="op"><span class="hljs-class">(</span></span><span class="hljs-class"><span class="hljs-title">expr</span></span><span class="op"><span class="hljs-class">);</span></span></span>
<span id="cb4-6">  u32 <span class="op">*</span>src <span class="op">=</span> <span class="op">&amp;</span>regs<span class="op">-&gt;</span>data<span class="op">[</span>priv<span class="op">-&gt;</span>sreg<span class="op">];</span></span>
<span id="cb4-7">  u32 <span class="op">*</span>dst <span class="op">=</span> <span class="op">&amp;</span>regs<span class="op">-&gt;</span>data<span class="op">[</span>priv<span class="op">-&gt;</span>dreg<span class="op">];</span></span>
<span id="cb4-8">  <span class="kw"><span class="hljs-keyword">union</span></span> <span class="op">{</span> u32 u32<span class="op">;</span> u16 u16<span class="op">;</span> <span class="op">}</span> <span class="op">*</span>s<span class="op">,</span> <span class="op">*</span>d<span class="op">;</span> <span class="co"><span class="hljs-comment">// &lt;---- [1]</span></span></span>
<span id="cb4-9">  <span class="dt"><span class="hljs-keyword">unsigned</span></span> <span class="dt"><span class="hljs-keyword">int</span></span> i<span class="op">;</span></span>

<span id="cb4-11">  s <span class="op">=</span> <span class="op">(</span><span class="dt"><span class="hljs-keyword">void</span></span> <span class="op">*)</span>src<span class="op">;</span></span>
<span id="cb4-12">  d <span class="op">=</span> <span class="op">(</span><span class="dt"><span class="hljs-keyword">void</span></span> <span class="op">*)</span>dst<span class="op">;</span></span>

<span id="cb4-14">  <span class="cf"><span class="hljs-keyword">switch</span></span> <span class="op">(</span>priv<span class="op">-&gt;</span>size<span class="op">)</span> <span class="op">{</span></span>
<span id="cb4-15">  <span class="cf"><span class="hljs-keyword">case</span></span> <span class="dv"><span class="hljs-number">8</span></span><span class="op">:</span> <span class="op">{</span></span>
<span id="cb4-16">            <span class="co"><span class="hljs-comment">// ...</span></span></span>
<span id="cb4-17">  <span class="op">}</span></span>
<span id="cb4-18">  <span class="cf"><span class="hljs-keyword">case</span></span> <span class="dv"><span class="hljs-number">4</span></span><span class="op">:</span></span>
<span id="cb4-19">      <span class="cf"><span class="hljs-keyword">switch</span></span> <span class="op">(</span>priv<span class="op">-&gt;</span>op<span class="op">)</span> <span class="op">{</span></span>
<span id="cb4-20">      <span class="cf"><span class="hljs-keyword">case</span></span> NFT_BYTEORDER_NTOH<span class="op">:</span></span>
<span id="cb4-21">          <span class="cf"><span class="hljs-keyword">for</span></span> <span class="op">(</span>i <span class="op">=</span> <span class="dv"><span class="hljs-number">0</span></span><span class="op">;</span> i <span class="op">&lt;</span> priv<span class="op">-&gt;</span>len <span class="op">/</span> <span class="dv"><span class="hljs-number">4</span></span><span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb4-22">              d<span class="op">[</span>i<span class="op">].</span>u32 <span class="op">=</span> ntohl<span class="op">((</span>__force __be32<span class="op">)</span>s<span class="op">[</span>i<span class="op">].</span>u32<span class="op">);</span></span>
<span id="cb4-23">          <span class="cf"><span class="hljs-keyword">break</span></span><span class="op">;</span></span>
<span id="cb4-24">      <span class="cf"><span class="hljs-keyword">case</span></span> NFT_BYTEORDER_HTON<span class="op">:</span></span>
<span id="cb4-25">          <span class="cf"><span class="hljs-keyword">for</span></span> <span class="op">(</span>i <span class="op">=</span> <span class="dv"><span class="hljs-number">0</span></span><span class="op">;</span> i <span class="op">&lt;</span> priv<span class="op">-&gt;</span>len <span class="op">/</span> <span class="dv"><span class="hljs-number">4</span></span><span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb4-26">              d<span class="op">[</span>i<span class="op">].</span>u32 <span class="op">=</span> <span class="op">(</span>__force __u32<span class="op">)</span>htonl<span class="op">(</span>s<span class="op">[</span>i<span class="op">].</span>u32<span class="op">);</span></span>
<span id="cb4-27">          <span class="cf"><span class="hljs-keyword">break</span></span><span class="op">;</span></span>
<span id="cb4-28">      <span class="op">}</span></span>
<span id="cb4-29">      <span class="cf"><span class="hljs-keyword">break</span></span><span class="op">;</span></span>
<span id="cb4-30">  <span class="cf"><span class="hljs-keyword">case</span></span> <span class="dv"><span class="hljs-number">2</span></span><span class="op">:</span></span>
<span id="cb4-31">      <span class="cf"><span class="hljs-keyword">switch</span></span> <span class="op">(</span>priv<span class="op">-&gt;</span>op<span class="op">)</span> <span class="op">{</span></span>
<span id="cb4-32">      <span class="cf"><span class="hljs-keyword">case</span></span> NFT_BYTEORDER_NTOH<span class="op">:</span></span>
<span id="cb4-33">          <span class="cf"><span class="hljs-keyword">for</span></span> <span class="op">(</span>i <span class="op">=</span> <span class="dv"><span class="hljs-number">0</span></span><span class="op">;</span> i <span class="op">&lt;</span> priv<span class="op">-&gt;</span>len <span class="op">/</span> <span class="dv"><span class="hljs-number">2</span></span><span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb4-34">              d<span class="op">[</span>i<span class="op">].</span>u16 <span class="op">=</span> ntohs<span class="op">((</span>__force __be16<span class="op">)</span>s<span class="op">[</span>i<span class="op">].</span>u16<span class="op">);</span> <span class="co"><span class="hljs-comment">// &lt;---- [2]</span></span></span>
<span id="cb4-35">          <span class="cf"><span class="hljs-keyword">break</span></span><span class="op">;</span></span>
<span id="cb4-36">      <span class="cf"><span class="hljs-keyword">case</span></span> NFT_BYTEORDER_HTON<span class="op">:</span></span>
<span id="cb4-37">          <span class="cf"><span class="hljs-keyword">for</span></span> <span class="op">(</span>i <span class="op">=</span> <span class="dv"><span class="hljs-number">0</span></span><span class="op">;</span> i <span class="op">&lt;</span> priv<span class="op">-&gt;</span>len <span class="op">/</span> <span class="dv"><span class="hljs-number">2</span></span><span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb4-38">              d<span class="op">[</span>i<span class="op">].</span>u16 <span class="op">=</span> <span class="op">(</span>__force __u16<span class="op">)</span>htons<span class="op">(</span>s<span class="op">[</span>i<span class="op">].</span>u16<span class="op">);</span> <span class="co"><span class="hljs-comment">// &lt;---- [2]</span></span></span>
<span id="cb4-39">          <span class="cf"><span class="hljs-keyword">break</span></span><span class="op">;</span></span>
<span id="cb4-40">      <span class="op">}</span></span>
<span id="cb4-41">      <span class="cf"><span class="hljs-keyword">break</span></span><span class="op">;</span></span>
<span id="cb4-42">  <span class="op">}</span></span>
<span id="cb4-43"><span class="op">}</span></span></code></pre>
</div>
<p>In <strong>[1]</strong>, 2 pointers to an anonymous union are defined. These pointers are then aliased to the source and destination pointers defined above. The <code>sreg</code> and <code>dreg</code> fields of <code>priv</code> are correctly checked during the configuration phase, so <code>src</code> and <code>dst</code> are always in bounds. The same is true for the <code>len</code> field of <code>priv</code>.</p>
<p>The code for handling 4 bytes and 2 bytes elements uses the union for accessing the elements. While this implementation is valid for 4 bytes elements, it is invalid for handling the 2 bytes elements in <strong>[2]</strong>. In C, the size of an union is the size of its largest element. In this case the array accesses will be aligned on 4 bytes, regardless of the element size. This allows in the 2 bytes case to access memory out of bounds, which is on the stack as this is where the array of registers is allocated. The expected and actual behavior of the operation can be seen in the following illustration:</p>
<p>&nbsp;</p>
<img alt="Expected behavior" class="align-center" data-entity-type="file" data-entity-uuid="40112c06-010e-4fd7-8230-adb8878fe033" src="./Old bug, shallow bug_ Exploiting Ubuntu at Pwn2Own Vancouver 2023_files/oob-expected_1.png"><p>&nbsp;</p>
<img alt="Actual behavior" class="align-center" data-entity-type="file" data-entity-uuid="9ca83f43-7224-416e-be4e-83718c8ea0de" src="./Old bug, shallow bug_ Exploiting Ubuntu at Pwn2Own Vancouver 2023_files/oob-real_1.png"><p>&nbsp;</p>
<h3 id="exploit-outline">Exploit outline</h3>
<p>The out-of-bounds access primitive has the following constraints:</p>
<ul><li>All accesses are 2 bytes wide</li>
<li>All accesses are aligned on 4 bytes</li>
<li><code>priv-&gt;length</code> is still checked, and the overflow range is limited to few dozen bytes after the array</li>
</ul><p>To get a clear idea of what is overwritable we need to check the function <code>nft_do_chain</code>, whose stack frame contains the vm registers:</p>
<div class="sourceCode" id="cb5">
<pre><code class="sourceCode cpp hljs"><span id="cb5-1"><span class="dt"><span class="hljs-function"><span class="hljs-keyword">unsigned</span></span></span><span class="hljs-function"> </span><span class="dt"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function">
</span><span id="cb5-2"><span class="hljs-function"><span class="hljs-title">nft_do_chain</span></span><span class="op"><span class="hljs-function"><span class="hljs-params">(</span></span></span><span class="kw"><span class="hljs-function"><span class="hljs-params">struct</span></span></span><span class="hljs-function"><span class="hljs-params"> nft_pktinfo </span></span><span class="op"><span class="hljs-function"><span class="hljs-params">*</span></span></span><span class="hljs-function"><span class="hljs-params">pkt</span></span><span class="op"><span class="hljs-function"><span class="hljs-params">,</span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="dt"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="op"><span class="hljs-function"><span class="hljs-params">*</span></span></span><span class="hljs-function"><span class="hljs-params">priv</span></span><span class="op"><span class="hljs-function"><span class="hljs-params">)</span></span></span></span><span class="hljs-function">
</span><span id="cb5-3"><span class="op">{</span></span>
<span id="cb5-4">  <span class="at"><span class="hljs-keyword">const</span></span> <span class="kw"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> <span class="hljs-title">nft_chain</span> </span><span class="op"><span class="hljs-class">*</span></span><span class="hljs-class"><span class="hljs-title">chain</span> </span><span class="op"><span class="hljs-class">=</span></span><span class="hljs-class"> <span class="hljs-title">priv</span></span><span class="op"><span class="hljs-class">,</span></span><span class="hljs-class"> </span><span class="op"><span class="hljs-class">*</span></span><span class="hljs-class"><span class="hljs-title">basechain</span> </span><span class="op"><span class="hljs-class">=</span></span><span class="hljs-class"> <span class="hljs-title">chain</span></span><span class="op"><span class="hljs-class">;</span></span></span>
<span id="cb5-5">  <span class="at"><span class="hljs-keyword">const</span></span> <span class="kw"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> <span class="hljs-title">nft_rule_dp</span> </span><span class="op"><span class="hljs-class">*</span></span><span class="hljs-class"><span class="hljs-title">rule</span></span><span class="op"><span class="hljs-class">,</span></span><span class="hljs-class"> </span><span class="op"><span class="hljs-class">*</span></span><span class="hljs-class"><span class="hljs-title">last_rule</span></span><span class="op"><span class="hljs-class">;</span></span></span>
<span id="cb5-6">  <span class="at"><span class="hljs-keyword">const</span></span> <span class="kw"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> <span class="hljs-title">net</span> </span><span class="op"><span class="hljs-class">*</span></span><span class="hljs-class"><span class="hljs-title">net</span> </span><span class="op"><span class="hljs-class">=</span></span><span class="hljs-class"> <span class="hljs-title">nft_net</span></span><span class="op"><span class="hljs-class">(</span></span><span class="hljs-class"><span class="hljs-title">pkt</span></span><span class="op"><span class="hljs-class">);</span></span></span>
<span id="cb5-7">  <span class="at"><span class="hljs-keyword">const</span></span> <span class="kw"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> <span class="hljs-title">nft_expr</span> </span><span class="op"><span class="hljs-class">*</span></span><span class="hljs-class"><span class="hljs-title">expr</span></span><span class="op"><span class="hljs-class">,</span></span><span class="hljs-class"> </span><span class="op"><span class="hljs-class">*</span></span><span class="hljs-class"><span class="hljs-title">last</span></span><span class="op"><span class="hljs-class">;</span></span></span>
<span id="cb5-8">  <span class="kw"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> <span class="hljs-title">nft_regs</span> <span class="hljs-title">regs</span> </span><span class="op"><span class="hljs-class">=</span></span><span class="hljs-class"> </span><span class="op"><span class="hljs-class">{</span>};</span></span>
<span id="cb5-9">  <span class="dt"><span class="hljs-keyword">unsigned</span></span> <span class="dt"><span class="hljs-keyword">int</span></span> stackptr <span class="op">=</span> <span class="dv"><span class="hljs-number">0</span></span><span class="op">;</span></span>
<span id="cb5-10">  <span class="kw"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> <span class="hljs-title">nft_jumpstack</span> <span class="hljs-title">jumpstack</span></span><span class="op"><span class="hljs-class">[</span></span><span class="hljs-class"><span class="hljs-title">NFT_JUMP_STACK_SIZE</span></span><span class="op"><span class="hljs-class">];</span></span></span>
<span id="cb5-11">  <span class="dt"><span class="hljs-keyword">bool</span></span> genbit <span class="op">=</span> READ_ONCE<span class="op">(</span>net<span class="op">-&gt;</span>nft<span class="op">.</span>gencursor<span class="op">);</span></span>
<span id="cb5-12">  <span class="kw"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> <span class="hljs-title">nft_rule_blob</span> </span><span class="op"><span class="hljs-class">*</span></span><span class="hljs-class"><span class="hljs-title">blob</span></span><span class="op"><span class="hljs-class">;</span></span></span>
<span id="cb5-13">  <span class="kw"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> <span class="hljs-title">nft_traceinfo</span> <span class="hljs-title">info</span></span><span class="op"><span class="hljs-class">;</span></span></span>
<span id="cb5-14">      <span class="co"><span class="hljs-comment">// ...</span></span></span>
<span id="cb5-15"><span class="op">}</span></span></code></pre>
</div>
<p>By using a kernel debugger, we notice that the <code>jumpstack</code> array directly follows the registers and is the only data reachable with the overflow. Its purpose is to record at the moment of <code>jump</code> expressions the position in the current chain's rules. At the end of the subchain evaluation the top jumpstack entry is popped to resume execution in the correct place. A jumpstack entry has the following definition:</p>
<div class="sourceCode" id="cb6">
<pre><code class="sourceCode cpp hljs"><span id="cb6-1"><span class="kw"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> <span class="hljs-title">nft_jumpstack</span> </span><span class="op"><span class="hljs-class">{</span></span></span>
<span id="cb6-2">  <span class="at"><span class="hljs-keyword">const</span></span> <span class="kw"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> <span class="hljs-title">nft_chain</span> </span><span class="op"><span class="hljs-class">*</span></span><span class="hljs-class"><span class="hljs-title">chain</span></span><span class="op"><span class="hljs-class">;</span></span></span>
<span id="cb6-3">  <span class="at"><span class="hljs-keyword">const</span></span> <span class="kw"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> <span class="hljs-title">nft_rule_dp</span> </span><span class="op"><span class="hljs-class">*</span></span><span class="hljs-class"><span class="hljs-title">rule</span></span><span class="op"><span class="hljs-class">;</span></span></span>
<span id="cb6-4">  <span class="at"><span class="hljs-keyword">const</span></span> <span class="kw"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> <span class="hljs-title">nft_rule_dp</span> </span><span class="op"><span class="hljs-class">*</span></span><span class="hljs-class"><span class="hljs-title">last_rule</span></span><span class="op"><span class="hljs-class">;</span></span></span>
<span id="cb6-5"><span class="op">};</span></span></code></pre>
</div>
<p>Using the vulnerability it is possible to leak and overwrite the two lower bytes of these pointers to misalign them. The interesting pointers to target in this structure are <code>rule</code> and <code>last_rule</code>. By making them point to a fake rule it should be possible to execute arbitrary expressions and gain kernel code execution. To reach this goal we designed the following exploit strategy:</p>
<ul><li>Leak nf_tables.ko to compute expression vtable addresses</li>
<li>Leak the kernel base using a crafted expression</li>
<li>Use a crafted expression to write a ropchain and gain code execution</li>
</ul><h3 id="template-setup">Template setup</h3>
<p>To overflow the <code>nft_rule_dp</code> pointer in a stable way we need to leak them first. A way of doing this is by using two chains. The top chain calls a subchain, which contains a <code>nft_byteorder</code> expression. As the first chain pushes an entry on the jumpstack, the subchain can read or write to it using the vulnerability.</p>
<p>The jumpstack entry can be leaked through the registers by making the destination register point to the beginning of the array and the source to the end, where it will read out-of-bounds.</p>
<div class="note"><img alt="Jumpstack leak" class="align-center" data-entity-type="file" data-entity-uuid="67d3ce1e-e276-4603-acf0-0b0cbcda4c45" src="./Old bug, shallow bug_ Exploiting Ubuntu at Pwn2Own Vancouver 2023_files/oob_leak.png"></div>
<p>The registers in blue in the figure contain parts of the jumpstack pointers (bits [0:15] and [32:47]). They can be recovered from userland by writing them to a map object using the <code>nft_dynset</code> expression.</p>
<p>To overwrite the pointers, the rule doing the leak must be flushed and its expressions replaced by the opposite of the leak. Source and destination registers are swapped, and the chosen value for the overwrite must be placed inside the register array. Do note that at some point <code>src</code> will overlap with a value written through <code>dst</code>. Effectively, the values we input for the overwrite will be byteswapped twice before being written out-of-bounds.</p>
<div class="note"><img alt="Jumpstack write" class="align-center" data-entity-type="file" data-entity-uuid="11edc900-2e80-46f4-8c5a-f37a1f8c90ab" src="./Old bug, shallow bug_ Exploiting Ubuntu at Pwn2Own Vancouver 2023_files/oob_write.png"></div>
<p>In the end the setup consists of two chains:</p>
<ul><li>The <strong>base-chain</strong>, whose role is to jump to another chain to fill the jumpstack and store the leak pointer in a set</li>
<li>The <strong>leak-chain</strong>, whose role is to contain the leak and overwrite operation</li>
</ul><p>The following process is followed by all the exploit steps:</p>
<ul><li>Fill <strong>base-chain</strong> with required expressions</li>
<li>Fill <strong>leak-chain</strong> with payload for the leak</li>
<li>Send packet to evaluate chain and recover the <strong>base-chain</strong> jumpstack pointers</li>
<li>Replace <strong>leak-chain</strong> expressions with the overwrite payload</li>
<li>Send packet to evaluate chain, which will corrupt the top jumpstack entry</li>
<li>Profit ?</li>
</ul><h3 id="module-infoleak">Module infoleak</h3>
<p>Only a few mechanisms allow a user of nftables to return data from the kernel to userland. Netlink dump command, <code>nft_log</code> expressions, and nftables execution tracing.</p>
<p>The netlink dump command allows recovering the state of all objects in a table in a serialized form. However, it is not used on the packet evaluation path and cannot be used for an infoleak.</p>
<p>The <code>nft_log</code> expression allows sending packet information back to userland for logging. Additionally, an arbitrary prefix of size up to 128 can be provided by the user. This prefix being heap allocated, it could be used in a use-after-free situation to leak heap data. However, on kernel 5.19 and above every nftables allocation uses <code>GFP_KERNEL_ACCOUNT</code> while the prefix still uses the general heap, making the setup for a leak too complex and brittle to implement.</p>
<p>The last functionality is nftables execution tracing. If the tracing bit on a packet is set, the nftables subsystem will send back to userland a blob of information on every executed rule. This is the mecanism we used for an infoleak.</p>
<p>Inside <code>nft_do_chain</code>, rule tracing is implemented through calls to <code>nft_trace_rule</code> and <code>nft_trace_verdict</code>. If tracing is enabled they end up calling <code>nft_trace_notify</code>. This function fills out information about a packet and the rule being evaluated such as:</p>
<ul><li>Protocol</li>
<li>Trace type (<strong>VERDICT</strong>, <strong>RULE</strong>, <strong>POLICY</strong>, ...)</li>
<li>Chain name</li>
<li>Table name</li>
<li>Rule handle (identifier)</li>
</ul><p>From the evaluation path most of these values cannot be controlled or would be to tedious to use, such as trying to leak through name strings. One interesting candidate however is the rule handle. It sits inside the <code>nft_rule_dp</code> structure and we can corrupt pointers to those. By misaligning a rule pointer and making it overlap an ops pointer, it should be possible to recover the pointer from userland through the handle field. This is the theory, as in practice a few hurdles need to be overcome first.</p>
<p>We start from the code serializing the rule handle itself, <code>nft_trace_fill_rule_info</code>:</p>
<div class="sourceCode" id="cb7">
<pre><code class="sourceCode cpp hljs"><span id="cb7-1"><span class="at"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="dt"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> <span class="hljs-title">nf_trace_fill_rule_info</span></span><span class="op"><span class="hljs-function"><span class="hljs-params">(</span></span></span><span class="kw"><span class="hljs-function"><span class="hljs-params">struct</span></span></span><span class="hljs-function"><span class="hljs-params"> sk_buff </span></span><span class="op"><span class="hljs-function"><span class="hljs-params">*</span></span></span><span class="hljs-function"><span class="hljs-params">nlskb</span></span><span class="op"><span class="hljs-function"><span class="hljs-params">,</span></span></span></span><span class="hljs-function"><span class="hljs-params">
</span></span><span id="cb7-2"><span class="hljs-function"><span class="hljs-params">                 </span></span><span class="at"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="kw"><span class="hljs-function"><span class="hljs-params">struct</span></span></span><span class="hljs-function"><span class="hljs-params"> nft_traceinfo </span></span><span class="op"><span class="hljs-function"><span class="hljs-params">*</span></span></span><span class="hljs-function"><span class="hljs-params">info</span></span><span class="op"><span class="hljs-function"><span class="hljs-params">)</span></span></span></span><span class="hljs-function">
</span><span id="cb7-3"><span class="op">{</span></span>
<span id="cb7-4">  <span class="cf"><span class="hljs-keyword">if</span></span> <span class="op">(!</span>info<span class="op">-&gt;</span>rule <span class="op">||</span> info<span class="op">-&gt;</span>rule<span class="op">-&gt;</span>is_last<span class="op">)</span> <span class="co"><span class="hljs-comment">// &lt;---- [1]</span></span></span>
<span id="cb7-5">      <span class="cf"><span class="hljs-keyword">return</span></span> <span class="dv"><span class="hljs-number">0</span></span><span class="op">;</span></span>

<span id="cb7-7">  <span class="co"><span class="hljs-comment">/* a continue verdict with -&gt;type == RETURN means that this is</span></span></span><span class="hljs-comment">
</span><span id="cb7-8"><span class="co"><span class="hljs-comment">   * an implicit return (end of chain reached).</span></span></span><span class="hljs-comment">
</span><span id="cb7-9"><span class="co"><span class="hljs-comment">   *</span></span></span><span class="hljs-comment">
</span><span id="cb7-10"><span class="co"><span class="hljs-comment">   * Since no rule matched, the -&gt;rule pointer is invalid.</span></span></span><span class="hljs-comment">
</span><span id="cb7-11"><span class="co"><span class="hljs-comment">   */</span></span></span>
<span id="cb7-12">  <span class="cf"><span class="hljs-keyword">if</span></span> <span class="op">(</span>info<span class="op">-&gt;</span>type <span class="op">==</span> NFT_TRACETYPE_RETURN <span class="op">&amp;&amp;</span> <span class="co"><span class="hljs-comment">// &lt;---- [2]</span></span></span>
<span id="cb7-13">      info<span class="op">-&gt;</span>verdict<span class="op">-&gt;</span>code <span class="op">==</span> NFT_CONTINUE<span class="op">)</span></span>
<span id="cb7-14">      <span class="cf"><span class="hljs-keyword">return</span></span> <span class="dv"><span class="hljs-number">0</span></span><span class="op">;</span></span>

<span id="cb7-16">  <span class="cf"><span class="hljs-keyword">return</span></span> nla_put_be64<span class="op">(</span>nlskb<span class="op">,</span> NFTA_TRACE_RULE_HANDLE<span class="op">,</span></span>
<span id="cb7-17">              cpu_to_be64<span class="op">(</span>info<span class="op">-&gt;</span>rule<span class="op">-&gt;</span>handle<span class="op">),</span></span>
<span id="cb7-18">              NFTA_TRACE_PAD<span class="op">);</span></span>
<span id="cb7-19"><span class="op">}</span></span></code></pre>
</div>
<p>This function shows the first two constraints. In <strong>[1]</strong> the code checks that the rule must not be the last of the chain. The second check in <strong>[2]</strong> verifies that the tracetype is different from <code>NFT_TRACETYPE_RETURN</code>. It forces us to go through the <code>nft_trace_packet</code> function. By going up the call stack and checking the evaluation loop in <code>nft_do_chain</code>, a few other constraints can be deduced:</p>
<div class="sourceCode" id="cb8">
<pre><code class="sourceCode cpp hljs"><span id="cb8-1">next_rule<span class="op">:</span></span>
<span id="cb8-2">  regs<span class="op">.</span>verdict<span class="op">.</span>code <span class="op">=</span> NFT_CONTINUE<span class="op">;</span></span>
<span id="cb8-3">  <span class="cf"><span class="hljs-keyword">for</span></span> <span class="op">(;</span> rule <span class="op">&lt;</span> last_rule<span class="op">;</span> rule <span class="op">=</span> nft_rule_next<span class="op">(</span>rule<span class="op">))</span> <span class="op">{</span></span>
<span id="cb8-4">      nft_rule_dp_for_each_expr<span class="op">(</span>expr<span class="op">,</span> last<span class="op">,</span> rule<span class="op">)</span> <span class="op">{</span></span>
<span id="cb8-5">          <span class="cf"><span class="hljs-keyword">if</span></span> <span class="op">(</span>expr<span class="op">-&gt;</span>ops <span class="op">==</span> <span class="op">&amp;</span>nft_cmp_fast_ops<span class="op">)</span></span>
<span id="cb8-6">              nft_cmp_fast_eval<span class="op">(</span>expr<span class="op">,</span> <span class="op">&amp;</span>regs<span class="op">);</span></span>
<span id="cb8-7">          <span class="cf"><span class="hljs-keyword">else</span></span> <span class="cf"><span class="hljs-keyword">if</span></span> <span class="op">(</span>expr<span class="op">-&gt;</span>ops <span class="op">==</span> <span class="op">&amp;</span>nft_cmp16_fast_ops<span class="op">)</span></span>
<span id="cb8-8">              nft_cmp16_fast_eval<span class="op">(</span>expr<span class="op">,</span> <span class="op">&amp;</span>regs<span class="op">);</span></span>
<span id="cb8-9">          <span class="cf"><span class="hljs-keyword">else</span></span> <span class="cf"><span class="hljs-keyword">if</span></span> <span class="op">(</span>expr<span class="op">-&gt;</span>ops <span class="op">==</span> <span class="op">&amp;</span>nft_bitwise_fast_ops<span class="op">)</span></span>
<span id="cb8-10">              nft_bitwise_fast_eval<span class="op">(</span>expr<span class="op">,</span> <span class="op">&amp;</span>regs<span class="op">);</span></span>
<span id="cb8-11">          <span class="cf"><span class="hljs-keyword">else</span></span> <span class="cf"><span class="hljs-keyword">if</span></span> <span class="op">(</span>expr<span class="op">-&gt;</span>ops <span class="op">!=</span> <span class="op">&amp;</span>nft_payload_fast_ops <span class="op">||</span></span>
<span id="cb8-12">               <span class="op">!</span>nft_payload_fast_eval<span class="op">(</span>expr<span class="op">,</span> <span class="op">&amp;</span>regs<span class="op">,</span> pkt<span class="op">))</span></span>
<span id="cb8-13">              expr_call_ops_eval<span class="op">(</span>expr<span class="op">,</span> <span class="op">&amp;</span>regs<span class="op">,</span> pkt<span class="op">);</span></span>

<span id="cb8-15">          <span class="cf"><span class="hljs-keyword">if</span></span> <span class="op">(</span>regs<span class="op">.</span>verdict<span class="op">.</span>code <span class="op">!=</span> NFT_CONTINUE<span class="op">)</span></span>
<span id="cb8-16">              <span class="cf"><span class="hljs-keyword">break</span></span><span class="op">;</span></span>
<span id="cb8-17">      <span class="op">}</span></span>

<span id="cb8-19">      <span class="cf"><span class="hljs-keyword">switch</span></span> <span class="op">(</span>regs<span class="op">.</span>verdict<span class="op">.</span>code<span class="op">)</span> <span class="op">{</span></span>
<span id="cb8-20">      <span class="cf"><span class="hljs-keyword">case</span></span> NFT_BREAK<span class="op">:</span></span>
<span id="cb8-21">          regs<span class="op">.</span>verdict<span class="op">.</span>code <span class="op">=</span> NFT_CONTINUE<span class="op">;</span></span>
<span id="cb8-22">          nft_trace_copy_nftrace<span class="op">(</span>pkt<span class="op">,</span> <span class="op">&amp;</span>info<span class="op">);</span></span>
<span id="cb8-23">          <span class="cf"><span class="hljs-keyword">continue</span></span><span class="op">;</span></span>
<span id="cb8-24">      <span class="cf"><span class="hljs-keyword">case</span></span> NFT_CONTINUE<span class="op">:</span></span>
<span id="cb8-25">          nft_trace_packet<span class="op">(</span>pkt<span class="op">,</span> <span class="op">&amp;</span>info<span class="op">,</span> chain<span class="op">,</span> rule<span class="op">,</span></span>
<span id="cb8-26">                   NFT_TRACETYPE_RULE<span class="op">);</span></span>
<span id="cb8-27">          <span class="cf"><span class="hljs-keyword">continue</span></span><span class="op">;</span></span>
<span id="cb8-28">      <span class="op">}</span></span>
<span id="cb8-29">      <span class="cf"><span class="hljs-keyword">break</span></span><span class="op">;</span></span>
<span id="cb8-30">  <span class="op">}</span></span></code></pre>
</div>
<p>While misaligning the rule pointers we need to make sure that:</p>
<ul><li><code>last_rule &gt; rule</code> to enter the loop</li>
<li><code>rule-&gt;dlen</code> must be 0, otherwise misaligned data will be evaluated as expressions (without a module leak expression ops pointers cannot be crafted yet)</li>
<li>The misaligned rule should be the last, otherwise arbitrary data will be evaluated as the next rule</li>
</ul><p>The last constraint for this to run at all is that packet tracing should be enabled, which can be done using an <code>nft_meta</code> expression.</p>
<p>To solve all these constraints the following setup was used:</p>
<ul><li>Setup <strong>base-chain</strong> with two rules:

	<ul><li><code>nft_meta</code> expression to enable tracing</li>
<li>jump <code>leak_chain</code> + <code>verdict_return</code> expression (which is an <code>nft_immediate</code> expression)</li>
</ul></li>
<li>Overwrite <code>rule</code> pointer to point two bytes before <code>verdict_return</code> ops pointer</li>
<li>Overwrite <code>last_rule</code> to point 8 bytes after the new <code>rule</code> pointer</li>
</ul><p>After the pointer corruption the overlap looks as follows:</p>
<div class="note"><img alt="Rule overlap" class="align-center" data-entity-type="file" data-entity-uuid="2bf0ab7c-78af-49d8-8b60-453eee27c0e2" src="./Old bug, shallow bug_ Exploiting Ubuntu at Pwn2Own Vancouver 2023_files/overlap.png"></div>
<p>To understand why it works, let's first recall the structure of a rule:</p>
<div class="sourceCode" id="cb9">
<pre><code class="sourceCode cpp hljs"><span id="cb9-1"><span class="kw"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> <span class="hljs-title">nft_rule_dp</span> </span><span class="op"><span class="hljs-class">{</span></span></span>
<span id="cb9-2">    u64 is_last<span class="op">:</span><span class="dv"><span class="hljs-number">1</span></span><span class="op">,</span> dlen<span class="op">:</span><span class="dv"><span class="hljs-number">12</span></span><span class="op">,</span> handle<span class="op">:</span><span class="dv"><span class="hljs-number">42</span></span><span class="op">;</span>    <span class="co"><span class="hljs-comment">/* for tracing */</span></span></span>
<span id="cb9-3">    <span class="dt"><span class="hljs-keyword">unsigned</span></span> <span class="dt"><span class="hljs-keyword">char</span></span> data<span class="op">[]</span></span>
<span id="cb9-4">        <span class="ex">__attribute__((aligned(__alignof__(struct nft_expr)))</span><span class="op">);</span></span>
<span id="cb9-5"><span class="op">};</span></span></code></pre>
</div>
<p>Setting the rule pointer two bytes before the start of the ops pointer means that <code>is_last</code>, <code>dlen</code> and 3 bits of the <code>handle</code> will overlap with the end of the jump expression. In practice this "jump" expression is an <code>nft_immediate</code> expression and has the following memory layout:</p>
<div class="sourceCode" id="cb10">
<pre><code class="sourceCode cpp hljs"><span id="cb10-1"><span class="kw"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> <span class="hljs-title">nft_immediate_expr</span> </span><span class="op"><span class="hljs-class">{</span></span></span>
<span id="cb10-2">    <span class="kw"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> <span class="hljs-title">nft_data</span>            <span class="hljs-title">data</span> </span><span class="ex"><span class="hljs-class">__<span class="hljs-title">attribute__</span>((__<span class="hljs-title">aligned__</span>(8)))</span></span><span class="op"><span class="hljs-class">;</span></span> <span class="co"><span class="hljs-comment">/*     0    16 */</span></span></span>
<span id="cb10-3">    u8                         dreg<span class="op">;</span>                 <span class="co"><span class="hljs-comment">/*    16     1 */</span></span></span>
<span id="cb10-4">    u8                         dlen<span class="op">;</span>                 <span class="co"><span class="hljs-comment">/*    17     1 */</span></span></span>
<span id="cb10-5">    <span class="co"><span class="hljs-comment">/* size: 24, cachelines: 1, members: 3 */</span></span></span>
<span id="cb10-6">    <span class="co"><span class="hljs-comment">/* padding: 6 */</span></span></span>
<span id="cb10-7">    <span class="co"><span class="hljs-comment">/* forced alignments: 1 */</span></span></span>
<span id="cb10-8">    <span class="co"><span class="hljs-comment">/* last cacheline: 24 bytes */</span></span></span>
<span id="cb10-9"><span class="op">}</span> <span class="ex">__attribute__((__aligned__(<span class="hljs-number">8</span>)))</span><span class="op">;</span></span></code></pre>
</div>
<p>Two bytes before the end of the object ends up in the padding. As all nft private data is allocated with <code>kzalloc</code>, the last two bytes of the structure will be null. As such, <code>dlen</code> and <code>is_last</code> will be 0 as required by the constraints.</p>
<p>The <code>rule &lt; last_rule</code> constraint is verified as well and will not cause unwanted behavior. To obtain the pointer to the next <code>nft_rule_dp</code> the code takes the rule pointer, adds 8 for the header, and adds <code>dlen</code> for the rule contents. As <code>last_rule</code> is set 8 bytes away from <code>rule</code>, we end up at <code>rule == last_rule</code> which exits gracefully.</p>
<p>One issue with this approach is that only 39 bits of the ops pointer are leaked. In practice however, we observed that this was not an issue as most top bits of kernel pointers are set to 1.</p>
<p>To recover the leaked pointer, a netlink socket subscribing to the <code>NFNLGRP_NFTRACE</code> group must be created. The serialized trace can be recovered by reading from the socket after the execution of the payload.</p>
<h3 id="kaslr-leak">kASLR leak</h3>
<p>From the ops leaks obtained in the previous step, it is possible to recover the base address of <code>nf_table.ko</code> and compute the address of ops pointers for core expressions. To break kASLR in this step we use a crafted <code>nft_byteorder</code> expression with a large source register index to read a return address from the stack.</p>
<p>One way of executing arbitrary expressions would be to spray crafted rule blobs around the current blob, and redirect the pointers to the fake object. This however introduces a probabilistic element in the exploit.</p>
<p>Instead, fake rule blobs can be created within nft expressions themselves. It has the advantage of being completely deterministic.</p>
<p>For this step the setup is as follows:</p>
<ul><li>Fill <strong>base-chain</strong> with three rules:

	<ul><li>jump to <strong>leak-chain</strong></li>
<li>Rule embedding the crafted rule within an expression</li>
<li>Rule writing the leaked pointer to a set (<code>nft_dynset</code>)</li>
</ul></li>
</ul><p>This strategy however has a few constraints:</p>
<ul><li>Expressions embed a limited amount of user controllable data</li>
<li>As we did not leak the dynset module and set pointers, it is not possible to craft set expressions. We need to execute the third rule after the crafted rule gracefully.</li>
</ul><p>For the first point an interesting expression is the <code>nft_range</code> expressions, which has the following structure:</p>
<div class="sourceCode" id="cb11">
<pre><code class="sourceCode cpp hljs"><span id="cb11-1"><span class="kw"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> <span class="hljs-title">nft_range_expr</span> </span><span class="op"><span class="hljs-class">{</span></span></span>
<span id="cb11-2">  <span class="kw"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> <span class="hljs-title">nft_data</span> <span class="hljs-title">data_from</span></span><span class="op"><span class="hljs-class">;</span></span></span>
<span id="cb11-3">  <span class="kw"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> <span class="hljs-title">nft_data</span> <span class="hljs-title">data_to</span></span><span class="op"><span class="hljs-class">;</span></span></span>
<span id="cb11-4">  u8          sreg<span class="op">;</span></span>
<span id="cb11-5">  u8          len<span class="op">;</span></span>
<span id="cb11-6">  <span class="kw"><span class="hljs-keyword">enum</span></span> nft_range_ops  op<span class="op">:</span><span class="dv"><span class="hljs-number">8</span></span><span class="op">;</span></span>
<span id="cb11-7"><span class="op">};</span></span></code></pre>
</div>
<p>The <code>nft_data</code> structure is 16 bytes wide and its contents are fully user controlled. In total, it gives us 32 bytes of fake rule and expression data. There is however an issue. A rule header is 8 bytes and an <code>nft_byteorder</code> expression is 16 bytes. This leaves only 8 bytes for a last expression, but all expressions are above 8 bytes in size.</p>
<p>To solve this problem we can make the second expression overlap with the last fields of the <code>nft_range</code> expression. For this purpose, we used the <code>nft_meta</code> expression:</p>
<div class="sourceCode" id="cb12">
<pre><code class="sourceCode cpp hljs"><span id="cb12-1"><span class="kw"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> <span class="hljs-title">nft_meta</span> </span><span class="op"><span class="hljs-class">{</span></span></span>
<span id="cb12-2">    <span class="kw"><span class="hljs-keyword">enum</span></span> nft_meta_keys key<span class="op">:</span><span class="dv"><span class="hljs-number">8</span></span><span class="op">;</span></span>
<span id="cb12-3">    u8                 len<span class="op">;</span></span>
<span id="cb12-4">    <span class="kw"><span class="hljs-keyword">union</span></span> <span class="op">{</span></span>
<span id="cb12-5">        u8 dreg<span class="op">;</span></span>
<span id="cb12-6">        u8 sreg<span class="op">;</span></span>
<span id="cb12-7">    <span class="op">};</span></span>
<span id="cb12-8"><span class="op">};</span></span></code></pre>
</div>
<p>The <code>key</code> and <code>len</code> fields of the <code>nft_meta</code> expression will overlap with the <code>sreg</code> and <code>len</code> fields of the <code>nft_range</code> expression. If we set the <code>sreg</code> to 8 in the range expression, which is the first available register, the value as a <code>key</code> will be invalid. Luckily, an invalid key in <code>nft_meta_set_ops</code> will only trigger a <code>WARN_ON</code> as seen in the code:</p>
<div class="sourceCode" id="cb13">
<pre><code class="sourceCode cpp hljs"><span id="cb13-1"><span class="dt"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> <span class="hljs-title">nft_meta_set_eval</span></span><span class="op"><span class="hljs-function"><span class="hljs-params">(</span></span></span><span class="at"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="kw"><span class="hljs-function"><span class="hljs-params">struct</span></span></span><span class="hljs-function"><span class="hljs-params"> nft_expr </span></span><span class="op"><span class="hljs-function"><span class="hljs-params">*</span></span></span><span class="hljs-function"><span class="hljs-params">expr</span></span><span class="op"><span class="hljs-function"><span class="hljs-params">,</span></span></span></span><span class="hljs-function"><span class="hljs-params">
</span></span><span id="cb13-2"><span class="hljs-function"><span class="hljs-params">             </span></span><span class="kw"><span class="hljs-function"><span class="hljs-params">struct</span></span></span><span class="hljs-function"><span class="hljs-params"> nft_regs </span></span><span class="op"><span class="hljs-function"><span class="hljs-params">*</span></span></span><span class="hljs-function"><span class="hljs-params">regs</span></span><span class="op"><span class="hljs-function"><span class="hljs-params">,</span></span></span></span><span class="hljs-function"><span class="hljs-params">
</span></span><span id="cb13-3"><span class="hljs-function"><span class="hljs-params">             </span></span><span class="at"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="kw"><span class="hljs-function"><span class="hljs-params">struct</span></span></span><span class="hljs-function"><span class="hljs-params"> nft_pktinfo </span></span><span class="op"><span class="hljs-function"><span class="hljs-params">*</span></span></span><span class="hljs-function"><span class="hljs-params">pkt</span></span><span class="op"><span class="hljs-function"><span class="hljs-params">)</span></span></span></span><span class="hljs-function">
</span><span id="cb13-4"><span class="op">{</span></span>
<span id="cb13-5">  <span class="at"><span class="hljs-keyword">const</span></span> <span class="kw"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> <span class="hljs-title">nft_meta</span> </span><span class="op"><span class="hljs-class">*</span></span><span class="hljs-class"><span class="hljs-title">meta</span> </span><span class="op"><span class="hljs-class">=</span></span><span class="hljs-class"> <span class="hljs-title">nft_expr_priv</span></span><span class="op"><span class="hljs-class">(</span></span><span class="hljs-class"><span class="hljs-title">expr</span></span><span class="op"><span class="hljs-class">);</span></span></span>
<span id="cb13-6">  <span class="kw"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> <span class="hljs-title">sk_buff</span> </span><span class="op"><span class="hljs-class">*</span></span><span class="hljs-class"><span class="hljs-title">skb</span> </span><span class="op"><span class="hljs-class">=</span></span><span class="hljs-class"> <span class="hljs-title">pkt</span></span><span class="op"><span class="hljs-class">-&gt;</span></span><span class="hljs-class"><span class="hljs-title">skb</span></span><span class="op"><span class="hljs-class">;</span></span></span>
<span id="cb13-7">  u32 <span class="op">*</span>sreg <span class="op">=</span> <span class="op">&amp;</span>regs<span class="op">-&gt;</span>data<span class="op">[</span>meta<span class="op">-&gt;</span>sreg<span class="op">];</span></span>
<span id="cb13-8">  u32 value <span class="op">=</span> <span class="op">*</span>sreg<span class="op">;</span></span>
<span id="cb13-9">  u8 value8<span class="op">;</span></span>

<span id="cb13-11">  <span class="cf"><span class="hljs-keyword">switch</span></span> <span class="op">(</span>meta<span class="op">-&gt;</span>key<span class="op">)</span> <span class="op">{</span></span>
<span id="cb13-12">  <span class="cf"><span class="hljs-keyword">case</span></span> NFT_META_MARK<span class="op">:</span></span>
<span id="cb13-13">  <span class="cf"><span class="hljs-keyword">case</span></span> NFT_META_PRIORITY<span class="op">:</span></span>
<span id="cb13-14">        <span class="co"><span class="hljs-comment">// ...</span></span></span>
<span id="cb13-15">  <span class="cf"><span class="hljs-keyword">default</span></span><span class="op">:</span></span>
<span id="cb13-16">      WARN_ON<span class="op">(</span><span class="dv"><span class="hljs-number">1</span></span><span class="op">);</span></span>
<span id="cb13-17">  <span class="op">}</span></span>
<span id="cb13-18"><span class="op">}</span></span></code></pre>
</div>
<p>Graphically, the final setup for the overlap is the following:</p>
<div class="note"><img alt="Range rule overlap" class="align-center" data-entity-type="file" data-entity-uuid="5d6716ae-34a3-4553-8065-2d1283ad04d0" src="./Old bug, shallow bug_ Exploiting Ubuntu at Pwn2Own Vancouver 2023_files/range_overlap.png"></div>
<p>Even though <code>nft_meta</code> actual size is 4 bytes, the resulting size as defined in the ops is 8 (due to the <code>NFT_EXPR_SIZE</code> macro). This makes the crafted rule's end align perfectly with the original rule's end. As such the virtual machine continues executing normally the next rule, which is the one writing the leaked kernel pointer to the set.</p>
<p>The actual exploitation follows the same process as before. First, the pointer to the rule containing the <code>nft_range</code> expression is leaked (low 16 bits). Then, the jumpstack <code>rule</code> pointer is overwritten to point into the crafted rule contained in the <code>nft_range</code> expression . The <code>last_rule</code> pointer itself is not modified as we wish to continue execution normally after the crafted rule.</p>
<h3 id="kernel-code-execution">Kernel Code Execution</h3>
<p>For kernel code execution we chose to use a ropchain as we have an easy access to the stack. Storing a ropchain and using a fake <code>nft_byteorder</code> to copy the ropchain beyond the stack cookie would be an idea. However, it is not flexible enough and limits the size of the ropchain.</p>
<p>Instead, a fake <code>nft_payload</code> expression can be crafted. It has the following definition:</p>
<div class="sourceCode" id="cb14">
<pre><code class="sourceCode cpp hljs"><span id="cb14-1"><span class="kw"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> <span class="hljs-title">nft_payload</span> </span><span class="op"><span class="hljs-class">{</span></span></span>
<span id="cb14-2">    <span class="kw"><span class="hljs-keyword">enum</span></span> nft_payload_bases base<span class="op">:</span><span class="dv"><span class="hljs-number">8</span></span><span class="op">;</span></span>
<span id="cb14-3">    u8 offset<span class="op">;</span></span>
<span id="cb14-4">    u8 len<span class="op">;</span></span>
<span id="cb14-5">    u8 dreg<span class="op">;</span></span>
<span id="cb14-6"><span class="op">};</span></span></code></pre>
</div>
<p>This expression copies <code>len</code> bytes from a given <code>offset</code> in the packet contents to the specified <code>dreg</code> in the register array. By specifying an out-of-bounds <code>dreg</code> pointing to the return address, and by sending the ropchain in a network packet, we get code execution. For the copy, the same exploit template as in the previous step is reused. The only change is to replace <code>nft_byteorder</code> by <code>nft_payload</code> in the crafted rule.</p>
<p>The ropchain itself does the following actions:</p>
<ul><li>calls <code>set_memory_rw</code> on <code>sys_modify_ldt</code></li>
<li>calls <code>copy_from_user_priv</code>, reading shellcode from userland to <code>sys_modify_ldt</code>
<ul><li>Shellcode is a simple <code>commit_creds(prepare_kernel_creds(0))</code></li>
</ul></li>
<li>calls <code>do_task_dead</code> to hang the kernel thread</li>
</ul><p>Afterwards, any process making a <code>sys_modify_ldt</code> syscall will be granted root privileges.</p>
<h2 id="conclusion">Conclusion</h2>
<p>The vulnerability we found in the <strong>nftables</strong> subsystem is very shallow and self contained. It was interesting to see that such a bug was able to survive for so long, even after the audit done by researchers on this surface during the past few years. This example illustrates that the mindset of "people already looked at this, there are no other vulnerabilities to be found" can be wrong. As a junior security researcher I find it very comforting.</p>
<p>The code for the exploit described in this post can be found on Synacktiv's <a href="https://github.com/Synacktiv/CVE-2023-35001">Github</a>. It is 100% stable, and supports the kernel versions available at the time of the event.</p>
<p>We would also like to thank ZDI for organizing the Pwn2Own event. See you next year !</p>
<h2 id="resources">Resources</h2>
<ul><li>Exploit code: <a href="https://github.com/Synacktiv/CVE-2023-35001">https://github.com/Synacktiv/CVE-2023-35001</a></li>
<li>Patch: <a href="https://lore.kernel.org/netfilter-devel/20230705210535.943194-1-cascardo@canonical.com/">https://lore.kernel.org/netfilter-devel/20230705210535.943194-1-cascardo@canonical.com/</a></li>
</ul>
</div>
<div class="share-links">
<span>Partagez cet article</span>
<div class="link-wrapper">
<div class="a2a_kit a2a_kit_size_32 a2a_default_style" style="line-height: 32px;">
<a class="a2a_button_facebook" target="_blank" href="https://www.synacktiv.com/#facebook" rel="nofollow noopener"><span class="a2a_svg a2a_s__default a2a_s_facebook" style="background-color: rgb(24, 119, 242);"></span><span class="a2a_label">Facebook</span></a>
<a class="a2a_button_twitter" target="_blank" href="https://www.synacktiv.com/#twitter" rel="nofollow noopener"><span class="a2a_svg a2a_s__default a2a_s_twitter" style="background-color: rgb(85, 172, 238);"></span><span class="a2a_label">Twitter</span></a>
<div style="clear: both;"></div></div>
</div>
<!--<script async src="https://static.addtoany.com/menu/page.js"></script>-->
</div>
</div>
</article>
</div>
</div>
</div>
<div class="page-contact-section">
<div class="container">
<div class="region region-footer">
<section class="contact-service-wrapper block block-block-content block-block-content60a6be42-565a-42b6-88e3-35ff45dab357 clearfix" id="block-autrespublications">
<div class="inner-wrapper">
<h2 class="block-title">Autres publications</h2>
</div>
</section>
<section class="views-element-container other-publications block block-views block-views-blockpublications-with-same-tag-block-1 clearfix" id="block-views-block-publications-with-same-tag-block-1">
<div class="form-group"><div class="view view-publications-with-same-tag view-id-publications_with_same_tag view-display-id-block_1 js-view-dom-id-5b64a91529674fdf535416dacaaa90847200cf1bf34a588ebed06ad89bdd236a">
<div class="view-content">
<div class="col-sm-4 views-row">
<article about="/publications/old-bug-shallow-bug-exploiting-ubuntu-at-pwn2own-vancouver-2023" class="article teaser-view clearfix" role="article" typeof="schema:Article">
<div class="content">
<a href="https://www.synacktiv.com/publications/old-bug-shallow-bug-exploiting-ubuntu-at-pwn2own-vancouver-2023"><h3><span property="schema:name">Old bug, shallow bug: Exploiting Ubuntu at Pwn2Own Vancouver 2023</span>
</h3></a>
<div class="wrapper-content">
<div class="text-summary">
           At this year Pwn2Own Vancouver we demonstrated Local Escalation of Privilege (LPE) exploits for the three desktop operating systems present at the competition: Windows, MacOS and Linux (Ubuntu). This 
                 
          ...
     </div>
<div class="short-info">
<span class="author-name">Tanguy Dubroca </span>
   
 - 01/09/2023 - 
   <span class="category">Exploit</span>
</div>
</div>
</div>
</article>
</div>
<div class="col-sm-4 views-row">
<article about="/publications/forensic-aspects-of-microsoft-remote-access-vpn" class="article teaser-view clearfix" role="article" typeof="schema:Article">
<div class="content">
<a href="https://www.synacktiv.com/publications/forensic-aspects-of-microsoft-remote-access-vpn"><h3><span property="schema:name">Forensic Aspects of Microsoft Remote Access VPN</span>
</h3></a>
<div class="wrapper-content">
<div class="text-summary">
           As remote work surges, VPNs gain significance. With employees using their devices in uncontrolled networks, VPNs are certainly now a serious option for attackers to gain an initial foothold on the cor
                 
          ...
     </div>
<div class="short-info">
<span class="author-name">Théo Letailleur</span>
   
 - 28/08/2023 - 
   <span class="category">CSIRT</span>
</div>
</div>
</div>
</article>
</div>
<div class="col-sm-4 views-row">
<article about="/publications/exploring-android-heap-allocations-in-jemalloc-new" class="article teaser-view clearfix" role="article" typeof="schema:Article">
<div class="content">
<a href="https://www.synacktiv.com/publications/exploring-android-heap-allocations-in-jemalloc-new"><h3><span property="schema:name">Exploring Android Heap allocations in jemalloc 'new'</span>
</h3></a>
<div class="wrapper-content">
<div class="text-summary">
           
                 When writing an exploit for a memory corruption vulnerability, knowing the heap allocator internals is often required to shape the heap as desired. This article will dive into one of Android libc allo
          ...
     </div>
<div class="short-info">
<span class="author-name">Nicolas Stefanski</span>
   
 - 30/05/2023 - 
   <span class="category">Exploit</span>
   ,   <span class="category">Reverse-engineering</span>
</div>
</div>
</div>
</article>
</div>
</div>
</div>
</div>
</section>
</div>
</div>
</div>
</div>
</div>
<div class="footer">
<div class="footer-top">
<div class="container">
<div class="footer-inner">
<div class="left-items col-sm-6">
<div class="footer-left col-sm-6"> <div class="region region-footer-left">
<a class="logo navbar-btn pull-left" href="https://www.synacktiv.com/index" rel="home" title="Accueil">
<img alt="Accueil" src="./Old bug, shallow bug_ Exploiting Ubuntu at Pwn2Own Vancouver 2023_files/logo_synacktiv_blanc.png">
</a>
<nav aria-labelledby="block-lasocieteanchormenu-2-menu" id="block-lasocieteanchormenu-2" role="navigation">
<ul class="menu menu--la-societe-anchor-menu nav">
<li class="first">
<a data-drupal-link-system-path="node/1" href="https://www.synacktiv.com/la-societe#who-we-are">Qui sommes-nous ?</a>
</li>
<li>
<a data-drupal-link-system-path="node/1" href="https://www.synacktiv.com/la-societe#our-values">Nos valeurs</a>
</li>
<li>
<a data-drupal-link-system-path="node/1" href="https://www.synacktiv.com/la-societe#aggrement">Agréments et accréditations</a>
</li>
<li>
<a data-drupal-link-system-path="node/1" href="https://www.synacktiv.com/la-societe#our-clients">Nos clients</a>
</li>
<li class="last">
<a data-drupal-link-system-path="node/6" href="https://www.synacktiv.com/notre-equipe/lequipe-support">Notre équipe</a>
</li>
</ul>
</nav>
<nav aria-labelledby="block-notreequipeanchormenu-menu" id="block-notreequipeanchormenu" role="navigation">
<ul class="menu menu--notre-equipe-anchor-menu nav">
<li class="first">
<a data-drupal-link-system-path="node/6" href="https://www.synacktiv.com/notre-equipe/lequipe-support">L’équipe support</a>
</li>
<li>
<a data-drupal-link-system-path="node/7" href="https://www.synacktiv.com/notre-equipe/pentest">Pentest</a>
</li>
<li>
<a data-drupal-link-system-path="node/8" href="https://www.synacktiv.com/notre-equipe/reverse">Reverse</a>
</li>
<li>
<a data-drupal-link-system-path="node/9" href="https://www.synacktiv.com/notre-equipe/developpement">Développement</a>
</li>
<li class="last">
<a data-drupal-link-system-path="node/573" href="https://www.synacktiv.com/our-team/reponse-aux-incidents">Réponse aux incidents (CSIRT)</a>
</li>
</ul>
</nav>
<nav aria-labelledby="block-nousrejoindreanchormenu-2-menu" id="block-nousrejoindreanchormenu-2" role="navigation">
<ul class="menu menu--nous-rejoindre-anchor-menu nav">
<li class="first">
<a data-drupal-link-system-path="node/19" href="https://www.synacktiv.com/nous-rejoindre#philosophie">Philosophie</a>
</li>
<li>
<a data-drupal-link-system-path="node/19" href="https://www.synacktiv.com/nous-rejoindre#recrutement">Processus de recrutement</a>
</li>
<li class="last">
<a data-drupal-link-system-path="node/19" href="https://www.synacktiv.com/nous-rejoindre#block-views-block-job-offer-list-view-block-1">Offres emploi/stage</a>
</li>
</ul>
</nav>
</div>
</div>
<div class="footer-right col-sm-6"> <div class="region region-footer-right">
<nav aria-labelledby="block-produitsanchormenu-menu" id="block-produitsanchormenu" role="navigation">
<ul class="menu menu--produits-anchor-menu nav">
<li class="first">
<a data-drupal-link-system-path="node/528" href="https://www.synacktiv.com/produits/kraqozorus">Kraqozorus</a>
</li>
<li>
<a data-drupal-link-system-path="node/3" href="https://www.synacktiv.com/produits/houdini">Houdini</a>
</li>
<li>
<a data-drupal-link-system-path="node/30" href="https://www.synacktiv.com/produits/disconet">Disconet</a>
</li>
<li>
<a data-drupal-link-system-path="node/32" href="https://www.synacktiv.com/produits/oursin">Oursin</a>
</li>
<li class="last">
<a data-drupal-link-system-path="node/33" href="https://www.synacktiv.com/produits/leakozorus">Leakozorus</a>
</li>
</ul>
</nav>
<nav aria-labelledby="block-prestationsanchormenu-menu" id="block-prestationsanchormenu" role="navigation">
<ul class="menu menu--prestations-anchor-menu nav">
<li class="first">
<a data-drupal-link-system-path="node/2" href="https://www.synacktiv.com/prestations/test-dintrusionred-team">Test d’intrusion/red team</a>
</li>
<li>
<a data-drupal-link-system-path="node/34" href="https://www.synacktiv.com/prestations/audit-de-securite">Audit de sécurité</a>
</li>
<li>
<a data-drupal-link-system-path="node/35" href="https://www.synacktiv.com/prestations/reverse-engineering">Reverse-engineering</a>
</li>
<li>
<a data-drupal-link-system-path="node/9" href="https://www.synacktiv.com/notre-equipe/developpement">Développement</a>
</li>
<li class="last">
<a data-drupal-link-system-path="node/572" href="https://www.synacktiv.com/prestations/reponse-aux-incidents">Réponse aux incidents</a>
</li>
</ul>
</nav>
<nav aria-labelledby="block-csirtanchormenu-menu" id="block-csirtanchormenu" role="navigation">
<ul class="menu menu--reponse-aux-incidents-anchor-men nav">
<li class="first last">
<a data-drupal-link-system-path="node/576" href="https://www.synacktiv.com/csirt">CSIRT Synacktiv </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="right-items col-sm-6">
<div class="block-title"><h2>Nous contacter</h2></div>
<div class="contact-teaser"><div class="views-element-container form-group"><div class="view view-ou-nous-trouver- view-id-ou_nous_trouver_ view-display-id-block_1 js-view-dom-id-96fc0475392440383045c281eefb39838003db5d501de5c0da8422edacc8a89d">
<div class="view-content">
<div class="views-row">
<div class="field field--name-field-phone field--type-string field--label-hidden field--item">
<a class="phone-icon" href="tel:01 45 79 74 75">01 45 79 74 75</a>
</div>
<div class="field field--name-field-email field--type-email field--label-hidden field--item">
<a class="mail-icon" href="mailto:contact@synacktiv.com">contact@synacktiv.com</a>
</div>
<div class="field field--name-field-gpg-key field--type-link field--label-hidden field--item">
<a class="key-icon" href="https://www.synacktiv.com/ressources/contact_synacktiv.asc">Clé GPG</a>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="locations"><div class="views-element-container form-group"><div class="view view-ou-nous-trouver- view-id-ou_nous_trouver_ view-display-id-block_2 js-view-dom-id-3f22715937749dacc302006a228e1d914a2fff9a4bf3f0f74e8c3aab12c59b90">
<div class="view-content">
<div class="col-sm-6 views-row"><div class="views-field views-field-field-address"><div class="field-content"> <div class="paragraph paragraph--type--locations paragraph--view-mode--default">
<div class="field-address-items">
<h2 class="marker-icon">PARIS</h2>
<div class="address">
<div class="field field--name-field-address field--type-string-long field--label-hidden field--item">5 boulevard Montmartre<br>
75002 Paris</div>
</div>
</div>
</div>
</div></div></div>
<div class="col-sm-6 views-row"><div class="views-field views-field-field-address"><div class="field-content"> <div class="paragraph paragraph--type--locations paragraph--view-mode--default">
<div class="field-address-items">
<h2 class="marker-icon">TOULOUSE</h2>
<div class="address">
<div class="field field--name-field-address field--type-string-long field--label-hidden field--item">4 Rue du Pont Guilhemery<br>
31000 Toulouse</div>
</div>
</div>
</div>
</div></div></div>
<div class="col-sm-6 views-row"><div class="views-field views-field-field-address"><div class="field-content"> <div class="paragraph paragraph--type--locations paragraph--view-mode--default">
<div class="field-address-items">
<h2 class="marker-icon">LYON</h2>
<div class="address">
<div class="field field--name-field-address field--type-string-long field--label-hidden field--item">56 rue Smith<br>
69002 Lyon</div>
</div>
</div>
</div>
</div></div></div>
<div class="col-sm-6 views-row"><div class="views-field views-field-field-address"><div class="field-content"> <div class="paragraph paragraph--type--locations paragraph--view-mode--default">
<div class="field-address-items">
<h2 class="marker-icon">RENNES</h2>
<div class="address">
<div class="field field--name-field-address field--type-string-long field--label-hidden field--item">7D Rue de Châtillon<br>
35000 Rennes</div>
</div>
</div>
</div>
</div></div></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="footer-bottom">
<div class="container">
<div class="copyright">Copyright © Synacktiv 2023</div>
<div class="region region-footer-bottom">
<nav aria-labelledby="block-footermenu-menu" id="block-footermenu" role="navigation">
<ul class="menu menu--footer-menu nav">
<li class="first">
<a data-drupal-link-system-path="node/4" href="https://www.synacktiv.com/mentions-legales">Mentions légales</a>
</li>
<li class="last">
<a data-drupal-link-system-path="contact" href="https://www.synacktiv.com/contact">Contactez-nous</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
</div>
</div>
<script data-drupal-selector="drupal-settings-json" type="application/json">{"path": {"baseUrl": "/", "scriptPath": null, "pathPrefix": "", "currentPath": "node/861", "currentLanguage": "fr"}, "pluralDelimiter": "\u0003", "suppressDeprecationErrors": true, "back_to_top": {"back_to_top_button_trigger": "100", "back_to_top_prevent_on_mobile": 0, "back_to_top_prevent_in_admin": 0, "back_to_top_button_type": "image", "back_to_top_button_text": "Back to top"}, "bootstrap": {"forms_has_error_value_toggle": 1}, "superfish": {"superfish-main": {"id": "superfish-main", "sf": {"animation": {"opacity": "show", "height": "show"}, "speed": "fast"}, "plugins": {"touchscreen": {"behaviour": "1", "mode": "window_width"}, "smallscreen": {"mode": "window_width", "breakpoint": 992, "accordionButton": "0", "expandText": "D\u00e9plier", "collapseText": "Replier", "title": "Main navigation"}, "supposition": true, "supersubs": true}}}}</script>
<script src="./Old bug, shallow bug_ Exploiting Ubuntu at Pwn2Own Vancouver 2023_files/js_rusY0UQGpgUgVePYPv62RpyTqKUL_GdQs27OT6RdhmA.js.下載"></script>
<script src="./Old bug, shallow bug_ Exploiting Ubuntu at Pwn2Own Vancouver 2023_files/bootstrap.min.js.下載"></script>
<script defer="" src="./Old bug, shallow bug_ Exploiting Ubuntu at Pwn2Own Vancouver 2023_files/custom.js.下載"></script>
<script defer="" src="./Old bug, shallow bug_ Exploiting Ubuntu at Pwn2Own Vancouver 2023_files/swiper.js.下載"></script>
<script src="./Old bug, shallow bug_ Exploiting Ubuntu at Pwn2Own Vancouver 2023_files/js_JP_x-sbRzkzG4QidGa5FeaACScdu33oppQ2UimueYro.js.下載"></script>
<script defer="" src="./Old bug, shallow bug_ Exploiting Ubuntu at Pwn2Own Vancouver 2023_files/addtoany.js.下載"></script>
<script defer="" src="./Old bug, shallow bug_ Exploiting Ubuntu at Pwn2Own Vancouver 2023_files/katex.js.下載"></script>
<script defer="" src="./Old bug, shallow bug_ Exploiting Ubuntu at Pwn2Own Vancouver 2023_files/katex-autoloader.js.下載"></script>
<script defer="" src="./Old bug, shallow bug_ Exploiting Ubuntu at Pwn2Own Vancouver 2023_files/zoom.min.js.下載"></script>
<script src="./Old bug, shallow bug_ Exploiting Ubuntu at Pwn2Own Vancouver 2023_files/js_afLzLLMCXuLWKjfsfRcX9ld1UTdhWte08w7Epc7bG8g.js.下載"></script>


<script charset="UTF-8" src="./Old bug, shallow bug_ Exploiting Ubuntu at Pwn2Own Vancouver 2023_files/zh-TW.js.下載"></script><div style="position: static;"><div class="a2a_overlay" id="a2a_overlay"></div><div id="a2a_modal" class="a2a_modal" role="dialog" tabindex="-1" aria-label="" style="display:none"><div class="a2a_modal_body a2a_menu" id="a2a_copy_link" style="display:none"><span id="a2a_copy_link_icon" class="a2a_svg a2a_s_link" style="background-color:#0166ff"><svg focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path fill="#FFF" d="M24.4 21.18c0-.36-.1-.67-.36-.92l-2.8-2.8a1.24 1.24 0 0 0-.92-.38c-.38 0-.7.14-.97.43.02.04.1.12.25.26l.3.3.2.24c.08.12.14.24.17.35.03.1.05.23.05.37 0 .36-.13.66-.38.92a1.25 1.25 0 0 1-.92.37 1.4 1.4 0 0 1-.37-.03 1.06 1.06 0 0 1-.35-.18 2.27 2.27 0 0 1-.25-.2 6.82 6.82 0 0 1-.3-.3l-.24-.25c-.3.28-.44.6-.44.98 0 .36.13.66.38.92l2.78 2.8c.24.23.54.35.9.35.37 0 .68-.12.93-.35l1.98-1.97c.26-.25.38-.55.38-.9zm-9.46-9.5c0-.37-.13-.67-.38-.92l-2.78-2.8a1.24 1.24 0 0 0-.9-.37c-.36 0-.67.1-.93.35L7.97 9.92c-.26.25-.38.55-.38.9 0 .36.1.67.37.92l2.8 2.8c.24.25.55.37.92.37.36 0 .7-.13.96-.4-.03-.04-.1-.12-.26-.26s-.24-.23-.3-.3a2.67 2.67 0 0 1-.2-.24 1.05 1.05 0 0 1-.17-.35 1.4 1.4 0 0 1-.04-.37c0-.36.1-.66.36-.9.26-.26.56-.4.92-.4.14 0 .26.03.37.06.12.03.23.1.35.17.1.1.2.16.25.2l.3.3.24.26c.3-.28.44-.6.44-.98zM27 21.17c0 1.07-.38 2-1.15 2.73l-1.98 1.98c-.74.75-1.66 1.12-2.73 1.12-1.1 0-2-.38-2.75-1.14l-2.8-2.8c-.74-.74-1.1-1.65-1.1-2.73 0-1.1.38-2.04 1.17-2.82l-1.18-1.17c-.8.8-1.72 1.18-2.82 1.18-1.08 0-2-.36-2.75-1.12l-2.8-2.8C5.38 12.8 5 11.9 5 10.82c0-1.08.38-2 1.15-2.74L8.13 6.1C8.87 5.37 9.78 5 10.86 5c1.1 0 2 .38 2.75 1.15l2.8 2.8c.74.73 1.1 1.65 1.1 2.72 0 1.1-.38 2.05-1.17 2.82l1.18 1.18c.8-.8 1.72-1.2 2.82-1.2 1.08 0 2 .4 2.75 1.14l2.8 2.8c.76.76 1.13 1.68 1.13 2.76z"></path></svg></span><input id="a2a_copy_link_text" type="text" title="Copy link" readonly=""><div id="a2a_copy_link_copied">✓</div></div><div class="a2a_modal_body a2a_menu a2a_thanks" id="a2a_thanks" style="display:none"><div class="a2a_localize" data-a2a-localize="inner,ThanksForSharing">Thanks for sharing!</div></div></div><div class="a2a_menu a2a_full a2a_localize" id="a2apage_full" role="dialog" tabindex="-1" aria-label="Share" data-a2a-localize="title,Share"><div class="a2a_full_header"><div id="a2apage_find_container" class="a2a_menu_find_container"><input id="a2apage_find" class="a2a_menu_find a2a_localize" type="text" autocomplete="off" title="Find any service" data-a2a-localize="title,FindAnyServiceToAddTo"><span id="a2apage_find_icon" class="a2a_svg a2a_s_find"><svg focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="#CCC" d="M19.7 18.2l-4.5-4.5c.7-1.1 1.2-2.3 1.2-3.6 0-3.5-2.8-6.3-6.3-6.3s-6.3 2.8-6.3 6.3 2.8 6.3 6.3 6.3c1.4 0 2.6-.4 3.6-1.2l4.5 4.5c.6.6 1.3.7 1.7.2.5-.4.4-1.1-.2-1.7zm-9.6-3.6c-2.5 0-4.5-2.1-4.5-4.5 0-2.5 2.1-4.5 4.5-4.5 2.5 0 4.5 2.1 4.5 4.5s-2 4.5-4.5 4.5z"></path></svg></span></div></div><div class="a2a_full_services" id="a2apage_full_services" role="presentation"><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#facebook" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_facebook" style="background-color: rgb(24, 119, 242);"></span>Facebook </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#twitter" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_twitter" style="background-color: rgb(85, 172, 238);"></span>Twitter </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#email" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_email" style="background-color: rgb(1, 102, 255);"></span>Email </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#pinterest" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_pinterest" style="background-color: rgb(189, 8, 28);"></span>Pinterest </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#linkedin" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_linkedin" style="background-color: rgb(0, 123, 181);"></span>LinkedIn </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#reddit" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_reddit" style="background-color: rgb(255, 69, 0);"></span>Reddit </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#whatsapp" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_whatsapp" style="background-color: rgb(18, 175, 10);"></span>WhatsApp </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#google_gmail" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_gmail" style="background-color: rgb(221, 83, 71);"></span>Gmail </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#telegram" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_telegram" style="background-color: rgb(44, 165, 224);"></span>Telegram </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#pocket" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_pocket" style="background-color: rgb(238, 64, 86);"></span>Pocket </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#mix" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_mix" style="background-color: rgb(255, 130, 38);"></span>Mix </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#tumblr" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_tumblr" style="background-color: rgb(53, 70, 92);"></span>Tumblr </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#amazon_wish_list" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_amazon" style="background-color: rgb(255, 153, 0);"></span>Amazon Wish List </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#aol_mail" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_aol" style="background-color: rgb(42, 42, 42);"></span>AOL Mail </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#balatarin" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_balatarin" style="background-color: rgb(7, 153, 72);"></span>Balatarin </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#bibsonomy" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_bibsonomy" style="background-color: rgb(42, 42, 42);"></span>BibSonomy </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#bitty_browser" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_bitty" style="background-color: rgb(153, 153, 153);"></span>Bitty Browser </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#blinklist" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_blinklist" style="background-color: rgb(61, 60, 59);"></span>Blinklist </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#blogger" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_blogger" style="background-color: rgb(253, 163, 82);"></span>Blogger </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#blogmarks" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_blogmarks" style="background-color: rgb(83, 83, 83);"></span>BlogMarks </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#bookmarks_fr" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_bookmarks_fr" style="background-color: rgb(150, 192, 68);"></span>Bookmarks.fr </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#box_net" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_box" style="background-color: rgb(26, 116, 176);"></span>Box.net </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#buffer" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_buffer" style="background-color: rgb(42, 42, 42);"></span>Buffer </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#care2_news" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_care2" style="background-color: rgb(110, 180, 63);"></span>Care2 News </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#citeulike" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_citeulike" style="background-color: rgb(39, 129, 205);"></span>CiteULike </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#copy_link" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_link" style="background-color: rgb(1, 102, 255);"></span>Copy Link </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#design_float" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_designfloat" style="background-color: rgb(138, 200, 255);"></span>Design Float </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#diary_ru" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_diary_ru" style="background-color: rgb(145, 45, 49);"></span>Diary.Ru </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#diaspora" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_diaspora" style="background-color: rgb(46, 52, 54);"></span>Diaspora </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#digg" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_digg" style="background-color: rgb(42, 42, 42);"></span>Digg </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#diigo" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_diigo" style="background-color: rgb(74, 139, 202);"></span>Diigo </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#douban" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_douban" style="background-color: rgb(0, 119, 17);"></span>Douban </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#draugiem" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_draugiem" style="background-color: rgb(255, 102, 0);"></span>Draugiem </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#dzone" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_dzone" style="background-color: rgb(130, 194, 81);"></span>DZone </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#evernote" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_evernote" style="background-color: rgb(0, 168, 45);"></span>Evernote </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#facebook_messenger" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_facebook_messenger" style="background-color: rgb(0, 132, 255);"></span>Facebook Messenger </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#fark" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_fark" style="background-color: rgb(85, 85, 85);"></span>Fark </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#flipboard" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_flipboard" style="background-color: rgb(204, 0, 0);"></span>Flipboard </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#folkd" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_folkd" style="background-color: rgb(15, 112, 178);"></span>Folkd </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#google_bookmarks" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_google" style="background-color: rgb(66, 133, 244);"></span>Google Bookmarks </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#google_classroom" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_google_classroom" style="background-color: rgb(255, 193, 18);"></span>Google Classroom </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#hacker_news" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_y18" style="background-color: rgb(255, 102, 0);"></span>Hacker News </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#hatena" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_hatena" style="background-color: rgb(0, 166, 219);"></span>Hatena </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#houzz" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_houzz" style="background-color: rgb(122, 193, 67);"></span>Houzz </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#instapaper" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_instapaper" style="background-color: rgb(42, 42, 42);"></span>Instapaper </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#kakao" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_kakao" style="background-color: rgb(252, 183, 0);"></span>Kakao </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#kik" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_kik" style="background-color: rgb(42, 42, 42);"></span>Kik </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#kindle_it" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_kindle" style="background-color: rgb(42, 42, 42);"></span>Push to Kindle </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#known" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_known" style="background-color: rgb(42, 42, 42);"></span>Known </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#line" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_line" style="background-color: rgb(0, 195, 0);"></span>Line </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#livejournal" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_livejournal" style="background-color: rgb(17, 49, 64);"></span>LiveJournal </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#mail_ru" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_mail_ru" style="background-color: rgb(53, 111, 172);"></span>Mail.Ru </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#mastodon" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_mastodon" style="background-color: rgb(43, 144, 217);"></span>Mastodon </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#mendeley" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_mendeley" style="background-color: rgb(167, 8, 5);"></span>Mendeley </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#meneame" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_meneame" style="background-color: rgb(255, 125, 18);"></span>Meneame </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#mewe" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_mewe" style="background-color: rgb(0, 125, 161);"></span>MeWe </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#mixi" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_mixi" style="background-color: rgb(209, 173, 90);"></span>Mixi </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#myspace" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_myspace" style="background-color: rgb(42, 42, 42);"></span>MySpace </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#netvouz" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_netvouz" style="background-color: rgb(102, 204, 51);"></span>Netvouz </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#odnoklassniki" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_odnoklassniki" style="background-color: rgb(242, 114, 12);"></span>Odnoklassniki </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#outlook_com" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_outlook_com" style="background-color: rgb(0, 114, 198);"></span>Outlook.com </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#papaly" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_papaly" style="background-color: rgb(58, 192, 246);"></span>Papaly </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#pinboard" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_pinboard" style="background-color: rgb(19, 65, 222);"></span>Pinboard </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#plurk" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_plurk" style="background-color: rgb(207, 104, 47);"></span>Plurk </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#print" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_print" style="background-color: rgb(1, 102, 255);"></span>Print </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#printfriendly" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_printfriendly" style="background-color: rgb(109, 159, 0);"></span>PrintFriendly </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#protopage_bookmarks" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_protopage" style="background-color: rgb(65, 63, 255);"></span>Protopage Bookmarks </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#pusha" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_pusha" style="background-color: rgb(0, 114, 184);"></span>Pusha </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#qzone" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_qzone" style="background-color: rgb(43, 130, 217);"></span>Qzone </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#rediff" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_rediff" style="background-color: rgb(210, 0, 0);"></span>Rediff MyPage </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#refind" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_refind" style="background-color: rgb(20, 146, 239);"></span>Refind </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#renren" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_renren" style="background-color: rgb(0, 94, 172);"></span>Renren </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#sina_weibo" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_sina_weibo" style="background-color: rgb(230, 22, 45);"></span>Sina Weibo </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#sitejot" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_sitejot" style="background-color: rgb(255, 200, 8);"></span>SiteJot </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#skype" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_skype" style="background-color: rgb(0, 175, 240);"></span>Skype </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#slashdot" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_slashdot" style="background-color: rgb(0, 66, 66);"></span>Slashdot </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#sms" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_sms" style="background-color: rgb(108, 190, 69);"></span>SMS </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#stocktwits" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_stocktwits" style="background-color: rgb(64, 87, 111);"></span>StockTwits </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#svejo" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_svejo" style="background-color: rgb(91, 212, 40);"></span>Svejo </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#symbaloo_bookmarks" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_symbaloo" style="background-color: rgb(109, 168, 247);"></span>Symbaloo Bookmarks </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#threema" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_threema" style="background-color: rgb(42, 42, 42);"></span>Threema </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#trello" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_trello" style="background-color: rgb(0, 121, 191);"></span>Trello </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#tuenti" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_tuenti" style="background-color: rgb(0, 117, 201);"></span>Tuenti </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#twiddla" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_twiddla" style="background-color: rgb(42, 42, 42);"></span>Twiddla </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#typepad_post" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_typepad" style="background-color: rgb(210, 222, 97);"></span>TypePad Post </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#viadeo" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_viadeo" style="background-color: rgb(42, 42, 42);"></span>Viadeo </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#viber" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_viber" style="background-color: rgb(124, 82, 158);"></span>Viber </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#vk" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_vk" style="background-color: rgb(88, 126, 163);"></span>VK </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#wanelo" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_wanelo" style="background-color: rgb(156, 176, 146);"></span>Wanelo </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#wechat" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_wechat" style="background-color: rgb(123, 179, 46);"></span>WeChat </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#wordpress" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_wordpress" style="background-color: rgb(70, 70, 70);"></span>WordPress </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#wykop" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_wykop" style="background-color: rgb(54, 125, 169);"></span>Wykop </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#xing" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_xing" style="background-color: rgb(22, 91, 102);"></span>XING </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#yahoo_mail" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_yahoo" style="background-color: rgb(64, 0, 144);"></span>Yahoo Mail </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#yoolink" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_yoolink" style="background-color: rgb(162, 197, 56);"></span>Yoolink </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#yummly" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_yummly" style="background-color: rgb(225, 97, 32);"></span>Yummly </a><i class="a2a_i"></i><i class="a2a_i"></i></div><div class="a2a_full_footer"><a href="https://www.addtoany.com/" title="Share Buttons" rel="noopener" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_a2a" style="background-color:#0166ff"><svg focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><g fill="#FFF"><path d="M14 7h4v18h-4z"></path><path d="M7 14h18v4H7z"></path></g></svg></span>AddToAny</a></div></div><div id="a2apage_dropdown" class="a2a_menu a2a_mini a2a_localize" tabindex="-1" aria-label="Share" data-a2a-localize="label,Share" style="display:none"><div id="a2apage_title_container" class="a2a_menu_title_container" style="display:none"><div id="a2apage_title" class="a2a_menu_title"></div></div><div class="a2a_mini_services" id="a2apage_mini_services"><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#facebook" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_facebook" style="background-color: rgb(24, 119, 242);"></span>Facebook </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#twitter" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_twitter" style="background-color: rgb(85, 172, 238);"></span>Twitter </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#email" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_email" style="background-color: rgb(1, 102, 255);"></span>Email </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#pinterest" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_pinterest" style="background-color: rgb(189, 8, 28);"></span>Pinterest </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#linkedin" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_linkedin" style="background-color: rgb(0, 123, 181);"></span>LinkedIn </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#reddit" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_reddit" style="background-color: rgb(255, 69, 0);"></span>Reddit </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#whatsapp" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_whatsapp" style="background-color: rgb(18, 175, 10);"></span>WhatsApp </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#google_gmail" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_gmail" style="background-color: rgb(221, 83, 71);"></span>Gmail </a></div><div id="a2apage_cols_container" class="a2a_cols_container"><div class="a2a_col1" id="a2apage_col1"></div><div id="a2apage_2_col1" style="display:none"><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#email" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_email" style="background-color: rgb(1, 102, 255);"></span>Email </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#google_gmail" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_gmail" style="background-color: rgb(221, 83, 71);"></span>Gmail </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#aol_mail" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_aol" style="background-color: rgb(42, 42, 42);"></span>AOL Mail </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#outlook_com" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_outlook_com" style="background-color: rgb(0, 114, 198);"></span>Outlook.com </a><a rel="nofollow noopener" class="a2a_i" href="https://www.synacktiv.com/#yahoo_mail" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_yahoo" style="background-color: rgb(64, 0, 144);"></span>Yahoo Mail </a></div><div class="a2a_clear"></div></div><div class="a2apage_wide a2a_wide"><a href="https://www.synacktiv.com/publications/old-bug-shallow-bug-exploiting-ubuntu-at-pwn2own-vancouver-2023" id="a2apage_show_more_less" class="a2a_menu_show_more_less a2a_more a2a_localize" title="Show all" data-a2a-localize="title,ShowAll"><span class="a2a_svg a2a_s__default a2a_s_a2a" style="background-color:#0166ff"><svg focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><g fill="#FFF"><path d="M14 7h4v18h-4z"></path><path d="M7 14h18v4H7z"></path></g></svg></span><span class="a2a_localize" data-a2a-localize="inner,More">More…</span></a></div></div><div style="height: 1px; width: 1px; position: absolute; z-index: 100000; top: 0px; visibility: hidden;"><iframe id="a2apage_sm_ifr" height="1" width="1" title="AddToAny Utility Frame" transparency="true" allowtransparency="true" frameborder="0" src="./Old bug, shallow bug_ Exploiting Ubuntu at Pwn2Own Vancouver 2023_files/sm.22.html" style="height: 1px; width: 1px; border: 0px; left: 0px; top: 0px; position: absolute; z-index: 100000;"></iframe></div></div><button id="backtotop">Back to top</button></body></html>