!function(){var e,t,n,r={91298:function(e,t,n){t.__esModule=!0,t.AccessLogViewer=void 0,n(69826);var r=o(n(73609)),i=o(n(20996));function o(e){return e&&e.__esModule?e:{default:e}}var a=function(){function e(e,t){this.data=this.generateData(e,t.unit,t.number),this.$parent=t.parent,this.$parent.css({width:this.$parent.parent().width()-(t.graphAreaMarginRight||50),height:+this.$parent.attr("data-graph-height")}).show(),this.graph=this.plot(t.barWidth,t.minTickSize,t.timeformat),this.$tooltip=this.$parent.find(".tooltip"),0===this.$tooltip.length&&(this.$tooltip=(0,r.default)('<div class="tooltip"></div>'),this.$tooltip.appendTo(this.$parent).hide()),this.$parent.on("plothover",this.onMouseOver.bind(this))}var t=e.prototype;return t.generateData=function(e,t,n){for(var r=Math.floor((new Date).getTime()/t)*t+t,i=r-t*n,o=60*(new Date).getTimezoneOffset()*1e3,a=[],s=0,u=i;u<=r;u+=9e5){s+=e[u]||0;var l=u-o;l%t==0&&(a.push([l-t,s]),s=0)}return a},t.plot=function(e,t,n){return r.default.plot(this.$parent,[{label:"",data:this.data,bars:{show:!0,lineWidth:e||15},legend:{show:!1}}],{xaxis:{mode:"time",minTickSize:t,timeformat:n},yaxis:{min:0,minTickSize:1,autoscaleMargin:.5,labelWidth:+this.$parent.attr("data-yaxis-width"),tickFormatter:function(e){return i.default.formatNumber(e)}},grid:{axisMargin:5,labelMargin:5,minBorderMargin:0,borderWidth:1,borderColor:"#CCCCCC",hoverable:!0}})},t.onMouseOver=function(e,t){var n=this.graph.getAxes();if(!(t.x<n.xaxis.min||t.x>n.xaxis.max||t.y<n.yaxis.min||t.y>n.yaxis.max)){var r=this.graph.getData()[0],o=function(e,t){var n;for(n=0;n<e.length;n++)if(t(e[n]))return n;return n}(r.data,(function(e){return e[0]>t.x})),a=r.data[o-1],s=r.data[o];if(a||s){var u=a?s?t.x-a[0]<s[0]-t.x?a:s:a:s;this.showTooltip(n.xaxis.p2c(u[0]),n.yaxis.p2c(u[1]),i.default.formatNumber(u[1]))}}},t.showTooltip=function(e,t,n){this.$tooltip.css({position:"absolute",top:t-25,left:e+13}).text(n).show()},e.showGraph=function(t,n){return new e(t,n)},e}();t.AccessLogViewer=a},50607:function(e,t,n){n(83753),n(69826),n(68309);var r=n(70879),i=a(n(57942)),o=a(n(1606));function a(e){return e&&e.__esModule?e:{default:e}}var s=n(73609),u=n(13469),l=n(36808),c=function(){function e(e){this.id=e.id,this.data=e.data,this.modified=e.modified}return e.prototype.toJSON=function(){return{id:this.id,data:this.data,modified:this.modified}},e}(),d=function(){function e(e){this.$form=e,this.localStorageKey="backup",this.localStorageEnabled()&&(s(document).on("clearBackup",this.clearBackup.bind(this)),this.deletePreviousBackup())}var t=e.prototype;return t.watch=function(){var e=this;if(!this.timer){var t=this.localStorageEnabled()?3e3:9e3,n=1e3*+this.$form.attr("data-backup-interval")||t;this.timer=setInterval((function(){return e.save()}),n)}},t.localStorageEnabled=function(){var e=!1;try{e=window.localStorage&&"user-blog-config-design-detail"!==(0,i.default)("page")}catch(e){}return e},t.clearBackup=function(){localStorage.removeItem(this.localStorageKey)},t.deletePreviousBackup=function(){l.get("clear_backup")&&(localStorage.removeItem(this.localStorageKey),l.remove("clear_backup",{path:"/"}))},t.load=function(){var e=this,t=this.$form.attr("data-backup-id");this.$form.data("backup",this.serialize());var n=s.Deferred();return u.defer((function(){var i;try{var o=JSON.parse(localStorage.getItem(e.localStorageKey));i=new c(o)}catch(e){}if(i&&i.id===t){var a=new Date(1e3*+i.modified);new Date-a>36e5?n.reject():((0,r.LOG)(["backup.load",i]),n.resolve(i))}else n.reject()})),n.promise()},t.save=function(e){var t=this.$form.attr("data-backup-id"),n=this.$form.data("backup"),i=this.serialize();if(n!==i||e){this.$form.trigger("backup-presave"),this.$form.data("backup",i);var o=Math.floor((new Date).getTime()/1e3),a=new c({id:t,data:i,modified:o});localStorage.setItem(this.localStorageKey,JSON.stringify(a)),(0,r.LOG)(["backup.save",a]),this.$form.trigger("backup-save")}},t.serialize=function(){var e=[],t=this.$form.find('input[type="text"], textarea, input[data-with-backup], input[type="hidden"].backup, input[type="radio"].backup, input[type="checkbox"].backup-button');return u.each(t,(function(t){t.name&&("radio"!==t.type||t.checked)&&("checkbox"!==t.type||t.checked?e.push({name:t.name,value:t.value}):e.push({name:t.name,value:0}))})),u.each(this.$form.find("select"),(function(t){var n=s(t);if(null===t.getAttribute("data-without-backup")){var r=n.find("option:selected");0!==r.length&&e.push({name:t.name,value:s(r[0]).val()})}})),s.param(e)},t.restoreBackup=function(e){(0,r.LOG)("restore backup"),this.formDataBeforeRestore=this.serialize(),this.assignData(e)},t.clearRestore=function(){(0,r.LOG)("clear restore"),this.assignData(this.formDataBeforeRestore)},t.assignData=function(e){var t=(0,o.default)(e);for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&"category"!==n&&this.$form.find('input[name="'+n+'"], textarea[name="'+n+'"]').val(t[n]);this.$form.data("backup",e),this.$form.trigger("backup-restore",e),this.$form.trigger("backup-restore-params",[t])},e}();e.exports=d},33868:function(e,t,n){var r=n(50607),i=function(){function e(e,t,n){this.$form=e,this.$editarea=t,this.editor=n,this.model=new r(e),this.restore(),this.model.watch()}var t=e.prototype;return t.restore=function(){var e,t=this;return this.model.load().then((function(n){return e=n,t.shouldAutoRestore()?(t.promptAutoRestored(n),!0):t.promptRestore(n)})).then((function(){t.model.restoreBackup(e.data)})).always((function(){t.editor&&t.editor.emit("resizeRequired")}))},t.shouldAutoRestore=function(){},t.promptRestore=function(){},t.promptAutoRestored=function(e){},e}();e.exports=i},56026:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),n(24603),n(74916),n(39714),n(69826);var r,i=(r=n(20996))&&r.__esModule?r:{default:r};!function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=o(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}r.default=e,n&&n.set(e,r)}(n(55992));function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(o=function(e){return e?n:t})(e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var s=n(73609),u=function(e){var t,n;function r(t,n,r){var i;return(i=e.call(this,t,n,r)||this).editor&&i.editor.on("saveDraft",(function(){i.model.deletePreviousBackup()})),i.initMessage(),i}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,a(t,n);var o=r.prototype;return o.initMessage=function(){var e=this;this.$message=s('<div class="backup-message" style="display: none; margin-buttom: -1px;" />'),this.$closeButton=s('<button type="button" class="backup-message-close" aria-label="'+i.default.text("close")+'"><i class="blogicon-close"></i></button>'),this.$message.append(this.$closeButton).insertBefore(this.$editarea),this.height=this.$message.outerHeight()-(parseInt(this.$message.css("border-width"),10)||1),this.$form.data("backup-message",this.$message),this.$form.on("backup-presave",(function(){return e.closeMessage()})),this.$closeButton.on("click",(function(){return e.closeMessage()})),s("#editor-main .ui-tabs").on("tabsactivate",(function(t,n){"ui-id-1"===n.newPanel.attr("aria-labelledby")?e.$message.show():e.$message.hide()}))},o.closeMessage=function(){this.$message.remove(),this.editor.emit("resizeRequired")},o.shouldAutoRestore=function(){var e=new RegExp("user/blog/edit-\\d+-new").test(this.$form.attr("data-backup-id")),t=this.$form.find(':input[name="title"]'),n=t[0]&&0===t.val().length,r=this.$form.find(':input[name="body"]'),i=r[0]&&0===r.val().length;return e&&n&&i},o.promptRestore=function(e){var t=this,n=new Date(1e3*+e.modified),r=s.Deferred(),o=i.default.text("backup.notice",'<time data-relative data-epoch="'+n.getTime()+'"></time>'),a=s('<a href="javascript:void(0)">('+i.default.text("backup.restore")+")</a>");return this.$message.prepend(o,a).show(),i.default.updateTimestamps(this.$message[0]),a.on("click",(function(){r.resolve(),t.closeMessage()})),r.promise()},o.promptAutoRestored=function(e){var t=this,n=new Date(1e3*+e.modified),r=i.default.text("backup.notice.auto_restored",'<time data-relative data-epoch="'+n.getTime()+'"></time>'),o=s('<a href="javascript:void(0)">('+i.default.text("backup.clear_restore")+")</a>");this.$message.prepend(r,o).show(),i.default.updateTimestamps(this.$message[0]),o.on("click",(function(){t.model.clearRestore(),t.closeMessage()}))},r}(n(33868));e.exports=u},82507:function(e,t,n){var r,i=(r=n(20996))&&r.__esModule?r:{default:r};function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var a=n(73609),s=function(e){var t,n;function r(){return e.apply(this,arguments)||this}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,o(t,n);var s=r.prototype;return s.shouldAutoRestore=function(){return!1},s.promptRestore=function(e){var t=a.Deferred(),n=new Date(1e3*+e.modified);return window.confirm(i.default.text("backup.notice.ask_restore",n))&&t.resolve(),t.promise()},s.promptAutoRestored=function(){},r}(n(33868));e.exports=s},63488:function(e,t,n){var r=n(56412),i=n(56026),o=n(82507);e.exports={createMessage:function(e,t,n){return"pc"===r.device()?new i(e,t,n):new o(e)}}},55248:function(e,t,n){t.__esModule=!0,t.BlogPermission=void 0,n(69826);var r,i=(r=n(73609))&&r.__esModule?r:{default:r};function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a=function(){function e(e){o(this,"$element",void 0),o(this,"$authconfigs",void 0),o(this,"$newAuthconfig",void 0),o(this,"$authconfigSelect",void 0),o(this,"$customConfigs",void 0),o(this,"$newCustomConfig",void 0),o(this,"$checkboxes",void 0),o(this,"$customCheckbox",void 0),o(this,"$publicCheckbox",void 0),o(this,"$inputOverlay",void 0),this.$element=e,this.$authconfigs=this.$element.find(".permission-authconfigs"),this.$newAuthconfig=this.$element.find("#new-authconfig"),this.$authconfigSelect=this.$element.find("#viewable-id-select"),this.$customConfigs=this.$element.find("#permission-custom-viewable-id"),this.$newCustomConfig=this.$element.find(".authconfig-detail-new"),this.$checkboxes=this.$element.find('[name = "permission"]'),this.$customCheckbox=this.$element.find("#permission-custom"),this.$publicCheckbox=this.$element.find("#permission-public"),this.$inputOverlay=this.$element.find(".config-private-overlay"),this.initEvents()}var t=e.prototype;return t.initEvents=function(){var e=this;this.$newAuthconfig.on("click",(function(){e.$element.find("#create-authconfig").submit()})),this.$authconfigSelect.on("change",(function(t){var n=(0,i.default)(t.currentTarget).find("option:selected").attr("data-ac");e.$authconfigs.find(".authconfig-detail").addClass("hide"),e.$authconfigs.find("."+n).removeClass("hide")})).change(),this.$checkboxes.on("change",(function(){e.$publicCheckbox.prop("checked")?e.$inputOverlay.show():e.$inputOverlay.hide(),e.customAuthConfigExists()?e.$customCheckbox.prop("checked")?e.$customConfigs.show():e.$customConfigs.hide():(e.$customConfigs.show(),e.$newCustomConfig.show())})).change()},t.customAuthConfigExists=function(){return!this.$customCheckbox.attr("disabled")},e}();t.BlogPermission=a},10788:function(e,t,n){function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var i=n(86544).Rule,o=function(e){var t,n;function o(t){var n;return(n=e.call(this,t)||this).isEditingNewRule=!0,n}n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,r(t,n);var a=o.prototype;return a.isEditing=function(){return!!this.editingRule},a.canSetPageType=function(){return!0},a.canSetCategory=function(){return this.mayHaveCategory()},a.startEdit=function(){this.editingRule=new i("all",null,[])},a.save=function(){this.startEdit()},a.revert=function(){this.editingRule=null},a.canDestroy=function(){return!1},a.asDefaultEditor=function(){return new i(this.editingRule)},o}(n(57180).s);e.exports=o},86544:function(e,t,n){function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}t.__esModule=!0,t.Rule=void 0,n(92222);var i=n(13469),o=function(){function e(e,t,n,i){void 0===i&&(i=!1),r(this,"pageType",void 0),r(this,"category",void 0),r(this,"items",void 0),r(this,"isEditable",void 0),this.pageType=e,this.category=t,this.items=n,this.isEditable=i}var t=e.prototype;return t.getItemsWithFilledLength=function(e){var t=[].concat(this.items);return i.times(e-t.length,(function(){return t.push({})})),t},t.getItemsForEdit=function(e){var t=this.getItemsWithFilledLength(e),n=t[t.length-1]||{};return(0===t.length||n.label||n.uri)&&t.push({}),t},t.getItemsLength=function(){return this.items.length},t.getItemsLengthForEdit=function(){var e=this.items,t=e[e.length-1];return 0===e.length||t.label||t.uri?e.length+1:e.length},t.equals=function(e){return this.pageType===e.pageType&&this.category===e.category&&i.isEqual(this.items,e.items)},t.clone=function(){return new e(this.pageType,this.category,[].concat(this.items))},t.pageTypePretty=function(){return this.pageType},t.setPageType=function(e){this.pageType=e},t.setCategory=function(e){this.category=e},t.canSetCategory=function(){return i.include(["entry","category"],this.pageType)},t.setItemLabel=function(e,t){var n=this;i.times(e-this.items.length+1,(function(){return n.items.push({})})),this.items[e].label=t,this._trimItems()},t.setItemURI=function(e,t){var n=this;i.times(e-this.items.length+1,(function(){return n.items.push({})})),this.items[e].uri=t,this._trimItems()},t._trimItems=function(){for(var e=this.items,t=e[e.length-1];t&&!t.label&&!t.uri;)e.pop(),t=e[e.length-1]},e}();t.Rule=o},57180:function(e,t,n){t.s=void 0;var r=n(86544);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o=function(){function e(t){i(this,"rule",void 0),i(this,"editingRule",void 0),i(this,"id",void 0),this.rule=t,this.editingRule=null,this.id=e.generateId()}var t=e.prototype;return t.canSetPageType=function(){return!1},t.canSetCategory=function(){return!1},t.mayHaveCategory=function(){return(this.isEditing()?this.editingRule:this.rule).canSetCategory()},t.isEditing=function(){return this.editingRule instanceof r.Rule},t.startEdit=function(){this.editingRule=this.rule.clone()},t.save=function(){this.isEditing()&&(this.rule=this.editingRule,this.revert())},t.revert=function(){this.editingRule=null},t.getItemsLength=function(){return this.isEditing()?this.editingRule.getItemsLengthForEdit():this.rule.getItemsLength()},e}();t.s=o,i(o,"editorId",0),i(o,"generateId",(function(){return"RuleEditor-"+o.editorId++}))},44188:function(e,t,n){n(21249);var r,i=(r=n(57942))&&r.__esModule?r:{default:r};function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var a=n(73609),s=n(17187).EventEmitter,u=n(37914),l=n(86544).Rule,c=function(e){var t,n;function r(){return e.apply(this,arguments)||this}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,o(t,n);var s=r.prototype;return s.loadRules=function(){var e=this;a.ajax({url:"rules.json",data:{spreadsheet_uri:u.param("spreadsheet_uri")},dataType:"json"}).done((function(t){var n=_.map(t,(function(e){return new l(e.pageType,e.category,e.items,e.isEditable)}));e.emit("rulesLoaded",n)}))},s.startEdit=function(e){this.emit("startEdit",e)},s.revert=function(e){this.emit("revert",e)},s.create=function(e){var t=this;this.postEditingRule("rules/register.json",e.editingRule).done((function(e){var n=_.map(e,(function(e){return new l(e.pageType,e.category,e.items,e.isEditable)}));t.emit("rulesLoaded",n)})).fail((function(){alert("error")}))},s.save=function(e){var t=this;this.postEditingRule("rules/register.json",e.editingRule).done((function(e){var n=_.map(e,(function(e){return new l(e.pageType,e.category,e.items,e.isEditable)}));t.emit("rulesLoaded",n)})).fail((function(){alert("error")}))},s.destroy=function(e){var t=this;this.postEditingRule("rules/delete.json",e.rule).done((function(){t.emit("destroy",e),t.loadRules()})).fail((function(){alert("error")}))},s.postEditingRule=function(e,t){return a.ajax({url:e,method:"POST",data:{page_type:t.pageType,category:t.category,items:JSON.stringify(t.items),rkm:(0,i.default)("rkm"),rkc:(0,i.default)("rkc")},dataType:"json",cache:!1})},s.setPageType=function(e,t){this.emit("setPageType",e,t)},s.setCategory=function(e,t){this.emit("setCategory",e,t)},s.setItemLabel=function(e,t,n){this.emit("setItemLabel",e,t,n)},s.setItemURI=function(e,t,n){this.emit("setItemURI",e,t,n)},r}(s);e.exports=new c},21407:function(e,t,n){function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n(21249);var i=n(13469),o=n(17187).EventEmitter,a=n(44188),s=n(57180).s,u=n(10788),l=function(e){var t,n;function o(){var t;return(t=e.call(this)||this).currentEditor=null,t.ruleEditors=[],t.newRuleEditor=new u,a.on("rulesLoaded",(function(e){t.currentEditor=null;var n=e.map((function(e){return new s(e)}));t.setEditors(n),t.emit("change")})),a.on("startEdit",(function(e){t.currentEditor=e,e.startEdit(),t.emit("change")})),a.on("revert",(function(e){t.currentEditor=null,e.revert(),t.emit("change")})),a.on("destroy",(function(e){var n=i.reject(t.ruleEditors,(function(t){return e===t}));t.setEditors(n),t.emit("change")})),a.on("setPageType",(function(e,n){e.editingRule.setPageType(n),t.emit("change")})),a.on("setCategory",(function(e,n){e.editingRule.setCategory(n),t.emit("change")})),a.on("setItemLabel",(function(e,n,r){e.editingRule.setItemLabel(n,r),t.emit("change")})),a.on("setItemURI",(function(e,n,r){e.editingRule.setItemURI(n,r),t.emit("change")})),t}n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,r(t,n);var l=o.prototype;return l.initialize=function(){a.loadRules()},l.setEditors=function(e){this.ruleEditors=e},l.getState=function(){return{currentEditor:this.currentEditor,ruleEditors:this.ruleEditors,newRuleEditor:this.newRuleEditor,itemsLength:this.getItemsLength()}},l.getItemsLength=function(){var e=this.ruleEditors.map((function(e){return e.getItemsLength()}));return e.push(1),Math.max.apply(Math,e)},o}(o);e.exports=new l},71124:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880);var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),o=(r=n(20996))&&r.__esModule?r:{default:r};function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u=n(44188),l=function(e){var t,n;function r(){return e.apply(this,arguments)||this}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,s(t,n);var a=r.prototype;return a.render=function(){var e=this;return i.createElement("div",{className:"item-editor"},i.createElement("h4",{className:"item-title"},o.default.text("admin.breadcrumbs.breadcrumbs_item"),this.props.itemIndex+1),i.createElement("div",{className:"item-input"},i.createElement("span",{className:"label-container"},i.createElement("input",{type:"text",placeholder:o.default.text("admin.breadcrumbs.labels"),value:this.props.label,list:"labels",onChange:function(t){return e.onLabelChanged(t)}})),i.createElement("span",{className:"uri-container"},i.createElement("input",{type:"text",placeholder:"URL",value:this.props.uri,list:"uris",onChange:function(t){return e.onURIChanged(t)}}))))},a.onLabelChanged=function(e){u.setItemLabel(this.props.editor,this.props.itemIndex,e.target.value)},a.onURIChanged=function(e){u.setItemURI(this.props.editor,this.props.itemIndex,e.target.value)},r}(i.Component);!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(l,"defaultProps",{label:"",uri:""}),e.exports=l},7623:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.RuleEditorPanel=void 0,n(21249);var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),o=(r=n(20996))&&r.__esModule?r:{default:r};function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u=n(71124),l=n(44188),c=function(e){var t,n;function r(){return e.apply(this,arguments)||this}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,s(t,n);var a=r.prototype;return a.render=function(){var e=this;return i.createElement("div",{className:"rule-editor-panel"},i.createElement("div",{className:"rule-editor-panel-inner"},i.createElement("div",{className:"rule-editor-panel-header"},i.createElement("h1",null,o.default.text("admin.breadcrumbs.breadcrumbs_add")),i.createElement("span",null,i.createElement("a",{href:"",onClick:function(t){return e.onRevertClicked(t)},className:"rule-editor-panel-close-btn"},i.createElement("i",{className:"blogicon-close"})))),i.createElement("div",{className:"rule-editor-panel-embed"},i.createElement("table",{className:"table"},i.createElement("tbody",null,i.createElement("tr",null,i.createElement("th",null,o.default.text("admin.breadcrumbs.page_type")),i.createElement("td",null,this.renderPageType(),i.createElement("p",null,o.default.text("admin.breadcrumbs.breadcrumbs_rule_page_type_tip")))),this.renderCategoryRow(),i.createElement("tr",null,i.createElement("th",null,o.default.text("admin.breadcrumbs.breadcrumbs_rule")),i.createElement("td",null,this.renderRules(),i.createElement("p",{className:"breadcrumb-rules-discription"},o.default.text("admin.breadcrumbs.breadcrumbs_rule_tip"))))))),i.createElement("div",{className:"rule-editor-panel-submit"},i.createElement("input",{type:"submit",value:o.default.text("save"),onClick:function(t){return e.onSaveClicked(t)},className:"save btn btn-primary"}))))},a.renderPageType=function(){var e=this,t=this.props.editor;if(!t)return null;var n=t.editingRule;return!!n&&(t.canSetPageType()?i.createElement("div",{className:"page-type editing"},i.createElement("select",{value:n.pageType,onChange:function(t){return e.onPageTypeChanged(t)}},i.createElement("option",{value:"all"},"all"),i.createElement("option",{value:"category"},"category"),i.createElement("option",{value:"entry"},"entry"),i.createElement("option",{value:"index"},"index"),i.createElement("option",{value:"archive"},"archive"))):i.createElement("div",{className:"page-type"},n.pageTypePretty()))},a.renderCategoryRow=function(){var e=this.props.editor;return e?e.mayHaveCategory()?i.createElement("tr",null,i.createElement("th",null,o.default.text("admin.breadcrumbs.categories")),i.createElement("td",null,this.renderCategory())):void 0:null},a.renderCategory=function(){var e=this,t=this.props.editor;if(!t)return null;var n=t.editingRule;return!!n&&(t.canSetCategory()?[i.createElement("div",{className:"category editing",key:1},i.createElement("input",{type:"text",placeholder:"Category",value:n.category||"",onChange:function(t){return e.onCategoryChanged(t)}})),i.createElement("p",{key:2},o.default.text("admin.breadcrumbs.breadcrumbs_category_discription"))]:[i.createElement("div",{className:"category",key:1},n.category||o.default.text("none"))])},a.renderRules=function(){var e=this,t=this.props.editor;if(!t)return null;var n=t.editingRule;return!!n&&n.getItemsForEdit(this.props.itemsLength).map((function(t,n){return i.createElement(u,{key:n,label:t.label,uri:t.uri,editor:e.props.editor,itemIndex:n})}))},a.onPageTypeChanged=function(e){l.setPageType(this.props.editor,e.target.value)},a.onCategoryChanged=function(e){l.setCategory(this.props.editor,e.target.value)},a.onSaveClicked=function(e){e.preventDefault();var t=this.props.editor;t&&("isEditingNewRule"in t?l.create(this.props.editor):l.save(this.props.editor))},a.onRevertClicked=function(e){e.preventDefault(),l.revert(this.props.editor)},r}(i.Component);t.RuleEditorPanel=c},42713:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),n(21249),n(4723),n(74916);var r,i=u(n(67294)),o=u(n(55992)),a=(r=n(20996))&&r.__esModule?r:{default:r};function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}function u(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var c=n(13469),d=n(44188),f=function(e){var t,n;function r(){return e.apply(this,arguments)||this}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,l(t,n);var s=r.prototype;return s.startEdit=function(){d.startEdit(this.props.editor)},s.render=function(){return i.createElement("tr",{className:"rule-row"},i.createElement("th",{className:"page-type"},this.renderPageType()),i.createElement("td",null,this.renderItems()),i.createElement("td",{className:"btn-container"},this.renderEditButton(),this.renderDeleteButton()))},s.renderEditButton=function(){var e=this;return this.props.editor.rule.isEditable?i.createElement("button",{type:"button",onClick:function(){return e.startEdit()},className:"edit"},a.default.text("admin.breadcrumbs.edit")):null},s.renderDeleteButton=function(){var e=this;return this.props.editor.rule.isEditable?i.createElement("button",{type:"button",onClick:function(){return e.onDeleteClicked()},className:"delete"},a.default.text("admin.breadcrumbs.delete")):null},s.renderPageType=function(){var e=this.props.editor.rule;return i.createElement("span",null,i.createElement("span",{className:"type"},e.pageTypePretty()),this.renderCategory())},s.renderItems=function(){var e=this,t=this.props.editor.rule.items.map((function(t,n){return t.label?[i.createElement("span",{className:"label",key:"label-"+n},e.renderLink(t)),i.createElement("span",{className:"label-slash",key:"label-slash-"+n},">")]:[i.createElement("span",{className:"empty-item",key:"empty-item-"+n})]})),n=c.flatten(t);return n.pop(),n},s.renderCategory=function(){var e=this.props.editor.rule;if(e.canSetCategory())return i.createElement("span",{className:"category"},i.createElement("span",{className:"category-text"},a.default.text("admin.breadcrumbs.categories")," "),e.category||a.default.text("none"))},s.formatLabel=function(e){return e?e.match(/^:/)?i.createElement("i",null,e):i.createElement("b",null,e):e},s.renderLink=function(e){if(!e.uri)return this.formatLabel(e.label);if(e.uri.match(/^:/))return i.createElement("a",{href:"#",title:e.uri},this.formatLabel(e.label));var t="/"===e.uri[0]?o.userBlogUrl(e.uri):e.uri;return i.createElement("a",{href:t},this.formatLabel(e.label))},s.onDeleteClicked=function(){window.confirm(a.default.text("admin.breadcrumbs.breadcrumbs_rule_delete_confirm"))&&d.destroy(this.props.editor)},r}(i.Component);e.exports=f},20967:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),n(21249);var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),o=n(7623),a=(r=n(20996))&&r.__esModule?r:{default:r};function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=n(83253),f=n(42713),p=n(44188),h=n(21407),m=function(e){var t,n;function r(t){var n;return c(u(n=e.call(this,t)||this),"updateState",void 0),c(u(n),"onModalOverlayClicked",void 0),n.state=h.getState(),n.updateState=n._updateState.bind(u(n)),n.onModalOverlayClicked=n._onModalOverlayClicked.bind(u(n)),n}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,l(t,n);var s=r.prototype;return s.componentDidMount=function(){h.on("change",this.updateState)},s.componentWillUnmount=function(){h.removeListener("change",this.updateState)},s._updateState=function(){var e=h.getState();this.setState(e)},s.isModalOpen=function(){return null!=this.state.currentEditor&&this.state.currentEditor.isEditing()},s.render=function(){var e=this;return i.createElement("div",null,i.createElement("table",{className:"rules-table"},i.createElement("thead",null,this.renderHeader()),i.createElement("tbody",null,this.renderRules())),i.createElement("div",null,i.createElement("button",{type:"submit",className:"create btn btn-primary",onClick:function(t){return e.onCreateClicked()}},a.default.text("admin.breadcrumbs.breadcrumbs_add")),i.createElement(d,{contentLabel:a.default.text("admin.breadcrumbs.breadcrumbs_edit"),isOpen:this.isModalOpen(),onRequestClose:this.onModalOverlayClicked,className:"rule-editor-panel-modal",overlayClassName:"rule-editor-panel-overlay"},i.createElement(o.RuleEditorPanel,{editor:this.state.currentEditor,itemsLength:this.state.itemsLength}))))},s.renderHeader=function(){return i.createElement("tr",{className:"header"},i.createElement("th",{className:"page-type"},a.default.text("admin.breadcrumbs.page_type")),i.createElement("th",{className:"items"},a.default.text("admin.breadcrumbs.breadcrumbs_preview")),i.createElement("th",{className:"buttons"}))},s.renderRules=function(){var e=this;return this.state.ruleEditors.map((function(t){return i.createElement(f,{editor:t,itemsLength:e.state.itemsLength,key:t.id})}))},s.onCreateClicked=function(){p.startEdit(this.state.newRuleEditor)},s._onModalOverlayClicked=function(){p.revert(this.state.currentEditor)},r}(i.Component);e.exports=m},52841:function(e,t,n){var r=n(67294),i=n(73935),o=n(20967),a=n(21407),s={init:function(e){a.initialize(),i.render(r.createElement(o,null),e)}};e.exports=s},3869:function(e,t,n){var r,i=(r=n(20996))&&r.__esModule?r:{default:r};var o=n(73609),a={init:function(){o('button[name="mode"][value="delete"]').on("click",(function(){return confirm(i.default.text("admin.comments.delete.confirm"))}));var e=o(":submit"),t=o(".js-delete-entries-button"),n=function(){var n=o('input[name="comment"]').is(":checked");e.prop("disabled",!n),e.toggleClass("disabled",!n),t.toggleClass("btn-danger",n)};o('input[name="comment"]').on("change",n),n()}};e.exports=a},68160:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.default=void 0,n(23157);var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=u(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),o=(r=n(20996))&&r.__esModule?r:{default:r},a=n(8617),s=n(58144);function u(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(u=function(e){return e?n:t})(e)}var l=function(e){var t=e.blog;return i.createElement("div",{className:"blog-host"},i.createElement("div",{className:"blog-meta-wrapper"},i.createElement(s.BlogVisibilityMeta,{blog:t}),i.createElement(a.BlogOwnerMeta,{blog:t}),i.createElement("div",{className:"blog-meta-item blog-meta-item-uri"},i.createElement("a",{href:t.uri,title:o.default.text("admin.view_blog")},t.uri))),!t.uri.startsWith("https://")&&i.createElement("div",{className:"blog-http-warning"},i.createElement("i",{className:"blogicon-warning"})," ",o.default.text("epic.myblog.alert_http"),i.createElement("a",{href:t.path_admin.config_url},o.default.text("epic.myblog.goto_https_setting"))))};t.default=l},8617:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.BlogOwnerMeta=void 0;var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),o=(r=n(20996))&&r.__esModule?r:{default:r};function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}t.BlogOwnerMeta=function(e){var t=e.blog,n=t.is_mine,r=t.owner;return n?null:i.createElement("span",{className:"blog-meta-item"},i.createElement("i",{className:"blogicon-user"}),o.default.text("admin.blog.members.owner"),": ",i.createElement("a",{href:r.primary_blog_url},r.user_name))}},58144:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.BlogVisibilityMeta=void 0;var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),o=(r=n(20996))&&r.__esModule?r:{default:r};function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}t.BlogVisibilityMeta=function(e){return e.blog.is_public?i.createElement("span",{className:"blog-meta-item"},i.createElement("i",{className:"blogicon-public"})," ",o.default.text("admin.permission.public")):i.createElement("span",{className:"blog-meta-item"},i.createElement("i",{className:"blogicon-private"})," ",o.default.text("blog.permission.private"))}},41241:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.default=void 0;var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),o=(r=n(20996))&&r.__esModule?r:{default:r};function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}var s=function(e){return i.createElement("div",{className:"myblog-config-icon-link"},i.createElement("a",{href:e.blog.path_admin.config,title:o.default.text("admin.edit_delete")},i.createElement("i",{className:"blogicon-setting"})))};t.default=s},19449:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.default=void 0;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=i(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=o?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(67294));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(i=function(e){return e?n:t})(e)}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var a=function(e){var t,n;function i(){return e.apply(this,arguments)||this}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,o(t,n),i.prototype.render=function(){var e="myblog-box-handle "+(this.props.draggable?"is-open":"");return r.createElement("div",{className:e},r.createElement("div",{className:"myblog-box-handle-reorder"}))},i}(r.Component);t.default=a},33876:function(e,t,n){n(4129),n(78783),n(38880),t.__esModule=!0,t.default=void 0,n(41539),n(66992),n(33948),n(21249);var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),o=(r=n(20996))&&r.__esModule?r:{default:r};function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u=function(e){var t,n;function r(t){var n;return function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(n=e.call(this,t)||this),"dropdownContainer",null),n.state={isOpen:!1,menuItemsProps:[]},n}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,s(t,n);var a=r.prototype;return a.componentDidMount=function(){var e=this;document.addEventListener("click",(function(t){return e.forceCloseDropdownMenu(t)}),!1),this.generateMenuItemProps()},a.componentWillUnmount=function(){var e=this;document.removeEventListener("click",(function(t){return e.forceCloseDropdownMenu(t)}),!1)},a.render=function(){var e=this,t=this.state.isOpen,n=this.menuItems();return i.createElement("div",{className:"myblog-box-setting-dropdown dropdown-window-wrapper",ref:function(t){e.dropdownContainer=t}},i.createElement("button",{type:"submit",className:"myblog-box-subcontent-btn dropdown-window-wrapper",title:o.default.text("admin.myblog.subcontent.detail"),onClick:function(t){return e.toggleDropdownMenu(t)}},i.createElement("i",{className:"blogicon-others"})),i.createElement("div",{className:"myblog-box-setting-dropdown-window dropdown-window "+(t?"is-open":"")},i.createElement("ul",{className:"list"},n)))},a.generateMenuItemProps=function(){var e=this.props.blog,t=[];e.privilege.can_visit_entries&&t.push({href:e.path_admin.entries,iconClassName:"blogicon-entry",key:"entries",label:o.default.text("admin.entries")}),e.privilege.can_visit_accesslog&&t.push({href:e.path_admin.accesslog,iconClassName:"blogicon-analytics",key:"accesslog",label:o.default.text("admin.accesslog")}),e.privilege.can_configure_setting&&t.push({href:e.path_admin.config,iconClassName:"blogicon-setting",key:"setting",label:o.default.text("settings")}),e.privilege.can_edit_design&&t.push({href:e.path_admin.config_design,iconClassName:"blogicon-design",key:"design",label:o.default.text("design")}),e.privilege.can_set_as_primary_blog&&!e.is_primary&&t.push({href:e.path_admin.primary,iconClassName:null,key:"change-primary",label:o.default.text("epic.change_primary")}),this.setState({menuItemsProps:t})},a.toggleDropdownMenu=function(e){e.stopPropagation(),e.preventDefault(),this.setState({isOpen:!this.state.isOpen})},a.forceCloseDropdownMenu=function(e){this.dropdownContainer.contains(e.target)||this.setState({isOpen:!1})},a.menuItems=function(){return this.state.menuItemsProps.map((function(e){return i.createElement("li",{key:e.key},i.createElement("a",{href:e.href,"data-item-key":e.key},e.iconClassName?i.createElement("i",{className:e.iconClassName}):null," ",e.label))}))},r}(i.PureComponent);t.default=u},86548:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.default=void 0,n(68309);var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),i=a(n(41241)),o=a(n(10793));function a(e){return e&&e.__esModule?e:{default:e}}function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var l=function(e){var t,n;function a(){return e.apply(this,arguments)||this}return n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,u(t,n),a.prototype.render=function(){var e=this.props.blog;return r.createElement("div",{className:"myblog-blog-icon"},r.createElement("a",{href:e.path_admin.root},r.createElement("img",{src:e.icon_url,alt:e.name})),e.is_mine?null:r.createElement(o.default,{owner:e.owner}),e.privilege.can_configure_setting?r.createElement(i.default,{blog:e}):null)},a}(r.Component);t.default=l},77158:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.default=void 0,n(68309);var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),o=(r=n(68160))&&r.__esModule?r:{default:r};function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u=function(e){var t,n;function r(){return e.apply(this,arguments)||this}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,s(t,n),r.prototype.render=function(){var e=this.props.blog;return i.createElement("div",{className:"myblog-box-content"},i.createElement("div",{className:"blog-name-wrapper"},i.createElement("a",{href:e.path_admin.root,className:"blog-name","data-blog-id":e.uuid},e.name)),i.createElement(o.default,{blog:e}))},r}(i.Component);t.default=u},52695:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.default=void 0;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=l(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),i=u(n(86548)),o=u(n(77158)),a=n(29784),s=u(n(77765));function u(e){return e&&e.__esModule?e:{default:e}}function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(l=function(e){return e?n:t})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var d=function(e){var t,n;function u(){return e.apply(this,arguments)||this}return n=e,(t=u).prototype=Object.create(n.prototype),t.prototype.constructor=t,c(t,n),u.prototype.render=function(){var e=this.props,t=e.blog,n=e.draggable;return r.createElement("div",{className:"myblog-box","data-blog-id":t.uuid},r.createElement(i.default,{blog:t}),r.createElement(o.default,{blog:t}),r.createElement(s.default,{blog:t}),r.createElement(a.SortableDragHandle,{draggable:n}))},u}(r.Component);t.default=d},46754:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.default=void 0,n(92222),n(21249);var r=f(n(67294)),i=n(4205),o=c(n(57942)),a=f(n(55992)),s=c(n(20996)),u=c(n(26845)),l=n(37845);function c(e){return e&&e.__esModule?e:{default:e}}function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(d=function(e){return e?n:t})(e)}function f(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=d(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var h=n(26307).default,m=function(e){var t,n;function c(t){var n;return(n=e.call(this,t)||this).state={blogs:[].concat(t.blogs),draggable:!1},n}n=e,(t=c).prototype=Object.create(n.prototype),t.prototype.constructor=t,p(t,n);var d=c.prototype;return d.render=function(){var e=this,t={className:this.state.draggable?"btn btn-primary":"btn",label:this.state.draggable?s.default.text("admin.myblogs.draghandle.hide"):s.default.text("admin.myblogs.draghandle.show")},n=this.props.shouldLinkToBlogmediaRegistrationForm?a.httpsAdminUrl("/register/blog_media?via=200131"):a.httpsAdminUrl("/register?via=200131");return r.createElement("div",null,r.createElement("div",{className:"main-header"},r.createElement("h1",null,r.createElement("i",{className:"blogicon-myblog lg"})," ",s.default.text("admin.my_blogs"))),this.renderBlogsListOrNotice(),r.createElement("div",{className:"myblog-operations"},r.createElement("a",{href:n,className:"myblog-create-btn test-myblog-create-btn"},r.createElement("i",{className:"blogicon-add"})," ",s.default.text("create_new_blog")),this.state.blogs.length>1?r.createElement("button",{type:"submit",className:t.className,onClick:function(){e.toggleDraggable()}},t.label):null))},d.renderBlogsListOrNotice=function(){var e=this;return 0===this.state.blogs.length?r.createElement("div",{className:"alert-box"},s.default.text("admin.myblog.no_blog")):r.createElement(l.SortableBlogList,{blogs:this.state.blogs,draggable:this.state.draggable,onSortStart:function(){e.onSortStart()},onSortEnd:function(t){e.onSortEnd(t)},useDragHandle:!0})},d.toggleDraggable=function(){var e=this.state.draggable;this.setState({draggable:!e})},d.onSortStart=function(){h.on()},d.onSortEnd=function(e){var t=e.oldIndex,n=e.newIndex,r=this.state.blogs,a=(0,i.arrayMove)(r,t,n),s=(0,o.default)("rkc"),l=(0,o.default)("rkm"),c=a.map((function(e){return e.uuid}));s&&l&&(0,u.default)({rkc:s,rkm:l,order:c}),this.setState({blogs:a}),h.off()},c}(r.Component);t.default=m},10793:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.default=void 0;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=i(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=o?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(67294));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(i=function(e){return e?n:t})(e)}var o=function(e){return r.createElement("a",{href:e.owner.primary_blog_url,className:"blog-host-icon-link"},r.createElement("img",{src:e.owner.user_icon_url,className:"blog-host-icon"}))};t.default=o},55544:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.SortableBlog=void 0;var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),o=n(4205),a=(r=n(52695))&&r.__esModule?r:{default:r};function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}var u=(0,o.SortableElement)((function(e){var t=e.blog,n=e.draggable;return i.createElement(a.default,{blog:t,draggable:n})}));t.SortableBlog=u},37845:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.SortableBlogList=void 0,n(21249);var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),i=n(4205),o=n(55544);function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}var s=(0,i.SortableContainer)((function(e){var t=e.blogs,n=e.draggable;return r.createElement("div",{className:"main-box"},t.map((function(e,t){return r.createElement(o.SortableBlog,{key:e.uuid,index:t,blog:e,draggable:n})})))}));t.SortableBlogList=s},29784:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.SortableDragHandle=void 0;var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),o=n(4205),a=(r=n(19449))&&r.__esModule?r:{default:r};function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}var u=(0,o.SortableHandle)((function(e){var t=e.draggable;return i.createElement(a.default,{draggable:t})}));t.SortableDragHandle=u},77765:function(e,t,n){n(4129),n(78783),n(38880),t.__esModule=!0,t.default=void 0,n(41539),n(66992),n(33948);var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),i=a(n(20996)),o=a(n(33876));function a(e){return e&&e.__esModule?e:{default:e}}function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var l=function(e){var t,n;function a(){return e.apply(this,arguments)||this}return n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,u(t,n),a.prototype.render=function(){var e=this.props.blog;return r.createElement("div",{className:"myblog-box-subcontent"},r.createElement("div",{className:"myblog-box-subcontent-row"},e.is_primary?r.createElement("div",null,r.createElement("span",{className:"primary-blog"},i.default.text("epic.primary_blog"))):null,r.createElement("div",null,r.createElement("a",{href:e.path_admin.edit,title:i.default.text("new_entry"),className:"test-blog-edit-button"},r.createElement("i",{className:"blogicon-edit myblog-box-subcontent-btn"}))),r.createElement(o.default,{blog:e})),r.createElement("div",{className:"myblog-box-overview-digest"},r.createElement("div",{className:"overview-digest-item"},r.createElement("span",{className:"overview-digest-label"},i.default.text("admin.post_count")),r.createElement("a",{href:e.path_admin.entries,className:"overview-digest-count"},e.entry_count)),r.createElement("div",{className:"overview-digest-item"},r.createElement("span",{className:"overview-digest-label"},i.default.text("admin.blog_subscribers_count")),r.createElement("a",{href:e.path_admin.subscribers,className:"overview-digest-count"},e.subscribers_count))))},a}(r.Component);t.default=l},26845:function(e,t,n){t.__esModule=!0,t.default=void 0,n(69600);var r=o(n(80129)),i=o(n(347));function o(e){return e&&e.__esModule?e:{default:e}}var a=function(e){var t=e.rkc,n=e.rkm,o=e.order.join(",");i.default.request({data:r.default.stringify({rkc:t,rkm:n,order:o}),method:"post",url:"/api/blog/update_blogs_order"})};t.default=a},11596:function(e,t,n){var r,i=(r=n(46754))&&r.__esModule?r:{default:r};e.exports=i.default},99171:function(e,t,n){t.__esModule=!0,t.default=void 0;var r=o(n(67294)),i=o(n(20996));function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var s=function(e){var t,n;function o(){return e.apply(this,arguments)||this}n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,a(t,n);var s=o.prototype;return s.render=function(){var e=this.props.blog;if(!e.latest_entry&&e.is_public)return null;var t=this.renderIcon(),n=this.renderBlogName(),i=this.renderEntryMetaData(),o=this.renderThumbnail(),a=this.renderEntryTitle(),s=this.renderEntryBody();return r.default.createElement("li",{className:"subscribed-list-list"},r.default.createElement("div",{className:"subscribed-list-item"},t,r.default.createElement("div",{className:"subscribed-list-header"},n),r.default.createElement("div",{className:"entry-unit-content"},r.default.createElement("div",{className:"entry-unit-content-main"},a,s,i),o)))},s.renderIcon=function(){var e=this.props.blog;return r.default.createElement("a",{href:e.uri},r.default.createElement("img",{src:e.icon,className:"subscribed-list-icon"}))},s.renderBlogName=function(){var e=this.props.blog;return r.default.createElement("a",{href:e.uri,className:"entry-unit-blog-name"},e.title)},s.renderEntryMetaData=function(){var e=this.props.blog,t=e.latest_entry,n=null;if(e.is_public&&t){var o=new Date(t.datetime),a=o.getTime(),s=i.default.deltaDatetime(o);n=r.default.createElement("time",{className:"post-time time",dateTime:t.datetime,"data-epoch":a},s)}return r.default.createElement("div",{className:"entry-unit-entry-footer"},n)},s.renderThumbnail=function(){var e=this.props.blog,t=this.props.blog.latest_entry;return e.is_public&&t&&t.image?r.default.createElement("a",{href:t.uri},r.default.createElement("img",{src:t.image,className:"entry-unit-entry-thumb"})):null},s.renderEntryTitle=function(){var e=this.props.blog,t=e.latest_entry;return e.is_public&&t?r.default.createElement("h3",{className:"entry-unit-entry-title"},r.default.createElement("a",{href:t.uri},t.title)):null},s.renderEntryBody=function(){var e,t=this.props.blog,n=t.latest_entry,o=null;t.is_public||(o=r.default.createElement("i",{className:"blogicon-private"})),e=t.is_public?n.summary:i.default.text("admin.subscribe.private.blog.message");var a=this.renderSeeMoreLink();return r.default.createElement(r.default.Fragment,null,r.default.createElement("p",{className:"entry-unit-entry-content"},o,e),a)},s.renderSeeMoreLink=function(){var e=this.props.blog,t=e.latest_entry;return e.is_public&&t.summary_is_trimmed?r.default.createElement("a",{href:t.uri},i.default.text("see_more")):null},o}(r.default.Component);t.default=s},82059:function(e,t,n){t.__esModule=!0,t.default=void 0,n(21249);var r=o(n(67294)),i=o(n(99171));function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var s=function(e){var t,n;function o(){return e.apply(this,arguments)||this}return n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,a(t,n),o.prototype.render=function(){var e=this.props.blogs.map((function(e){return r.default.createElement(i.default,{key:e.id,blog:e})}));return r.default.createElement("ul",{className:"subscribed-list"},e)},o}(r.default.Component);t.default=s},1379:function(e,t,n){t.__esModule=!0,t.default=void 0;var r=o(n(67294)),i=o(n(20996));function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var s=function(e){var t,n;function o(){return e.apply(this,arguments)||this}return n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,a(t,n),o.prototype.render=function(){return this.props.hasMore?r.default.createElement("a",{className:"btn",href:"/-/antenna"},i.default.text("epic.more")):null},o}(r.default.Component);t.default=s},45288:function(e,t,n){t.__esModule=!0,t.default=void 0;var r=u(n(67294)),i=u(n(20996)),o=u(n(347)),a=u(n(82059)),s=u(n(1379));function u(e){return e&&e.__esModule?e:{default:e}}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var c,d,f,p=function(e){var t,n;function u(t){var n;return(n=e.call(this,t)||this).state={blogs:[],hasMore:!1},n}n=e,(t=u).prototype=Object.create(n.prototype),t.prototype.constructor=t,l(t,n);var c=u.prototype;return c.componentDidMount=function(){this.loadSubscribingBlogs()},c.render=function(){return 0===this.state.blogs.length?null:r.default.createElement("div",null,r.default.createElement("div",{className:"main-header"},r.default.createElement("h1",null,i.default.text("admin.subscription_list"))),r.default.createElement(a.default,{blogs:this.state.blogs}),r.default.createElement(s.default,{hasMore:this.state.hasMore}))},c.loadSubscribingBlogs=function(){var e=this;o.default.request({data:{limit:this.props.limit},method:"get",url:"/api/subscribing"}).then((function(t){var n=t.data;e.setState({blogs:n.blogs,hasMore:n.has_more})}))},u}(r.default.Component);f={limit:3},(d="defaultProps")in(c=p)?Object.defineProperty(c,d,{value:f,enumerable:!0,configurable:!0,writable:!0}):c[d]=f;var h=p;t.default=h},51731:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.FlagToggle=void 0;var r,i=n(55834),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),a=(r=n(20996))&&r.__esModule?r:{default:r};function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}t.FlagToggle=function(e){var t=e.flagName,n=(0,o.useState)((0,i.hasFlagVariant)(t)),r=n[0],s=n[1];return o.default.createElement("div",null,r?o.default.createElement("button",{type:"button",className:"btn",onClick:function(){(0,i.removeFlagVariant)(t),s(!1)}},a.default.text("global.deactivate")):o.default.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(){(0,i.addFlagVariant)(t),s(!0)}},a.default.text("global.activate")))}},99908:function(e,t,n){t.__esModule=!0,t.FlagVariantsConfig=void 0,n(21249);var r,i=n(51731),o=(r=n(67294))&&r.__esModule?r:{default:r};t.FlagVariantsConfig=function(e){var t=e.availableFlags;return o.default.createElement("div",{id:"flag-variants-config"},t.map((function(e){return o.default.createElement(i.FlagToggle,{flagName:e,key:e})})))}},34914:function(e,t,n){t.__esModule=!0,t.initializeFlagVariantsConfigIfApplicable=void 0;var r,i=n(99908),o=n(73380),a=(r=n(67294))&&r.__esModule?r:{default:r};var s=n(91269);t.initializeFlagVariantsConfigIfApplicable=function(e){if(e){var t=s.get("flagVariants").availableFlags;(0,o.safeRender)(a.default.createElement(i.FlagVariantsConfig,{availableFlags:t}),e)}}},75809:function(e,t,n){t.__esModule=!0,t.NotificationsContainer=void 0;var r,i=n(61922),o=n(81433),a=(r=n(67294))&&r.__esModule?r:{default:r};t.NotificationsContainer=function(){var e=(0,o.useNotifications)();return a.default.createElement(i.NotificationsPresentation,e)}},59958:function(e,t,n){t.__esModule=!0,t.ContentObject=void 0,n(68309);var r,i=n(16972),o=(r=n(67294))&&r.__esModule?r:{default:r};t.ContentObject=function(e){var t=e.content;switch(typeof t){case"string":case"number":return o.default.createElement(o.default.Fragment,null,t);case"object":switch(t.type){case"link":return o.default.createElement("a",{href:t.href},t.text);case"star":return o.default.createElement(i.Star,{color:t.color});case"user":return o.default.createElement("a",{href:"https://blog.hatena.ne.jp/"+t.name+"/",className:"notification-screenName"},t.screen_name);default:return null}default:return null}}},83961:function(e,t,n){t.__esModule=!0,t.NoticeLine=void 0,n(21249);var r=a(n(20996)),i=n(59958),o=a(n(67294));function a(e){return e&&e.__esModule?e:{default:e}}t.NoticeLine=function(e){var t=e.notice,n=new Date(1e3*t.created);return o.default.createElement("div",{className:"notification-item"},o.default.createElement("div",{className:"item-icon"},o.default.createElement("a",{href:"https://blog.hatena.ne.jp/my"},o.default.createElement("img",{src:t.icon,alt:r.default.text("blog.go_to.blog")}))),o.default.createElement("div",{className:"item-content"},t.content.map((function(e,t){return o.default.createElement(i.ContentObject,{content:e,key:t})})),o.default.createElement("div",{className:"item-footer"},t.created&&o.default.createElement("time",{dateTime:n.toISOString()},r.default.deltaDatetime(n)))))}},61922:function(e,t,n){t.__esModule=!0,t.NotificationsPresentation=void 0,n(21249);var r=n(55992),i=n(83961),o=s(n(20996)),a=s(n(67294));function s(e){return e&&e.__esModule?e:{default:e}}t.NotificationsPresentation=function(e){var t=e.data,n=e.loading,s=e.error;return n||!t?a.default.createElement("div",{className:"notifications-loading"},a.default.createElement("img",{src:(0,r.staticUrl)("/images/loading.gif"),alt:"",className:"loading-spinner"}),o.default.text("loading")):s?a.default.createElement("div",{className:"error-box"},o.default.text("epic.failed_to_load")):a.default.createElement("div",null,t.notices.map((function(e){return a.default.createElement(i.NoticeLine,{notice:e,key:e.subject+e.verb+e.modified})})))}},16972:function(e,t,n){t.__esModule=!0,t.Star=void 0;var r,i=(r=n(67294))&&r.__esModule?r:{default:r};t.Star=function(e){var t=e.color;return i.default.createElement("span",{className:"notifications-star-"+t},"★")}},81433:function(e,t,n){t.__esModule=!0,t.useNotifications=void 0;var r=n(55992),i=n(91289);t.useNotifications=function(){var e=(0,i.useXHR)({url:(0,r.httpsAdminUrl)("/-/notifications/api")})[0];return{data:e.data,loading:e.loading,error:e.error}}},71637:function(e,t,n){n(69826),n(21249);var r,i=(r=n(57942))&&r.__esModule?r:{default:r};var o=n(73609),a=n(13469),s=n(49282),u={user:"module-category-sortable-container"},l={user:"module-category-sortable-item"},c=function(){function e(){var e=this;this.categoryTemplate=a.template(o(".js-categories-template").html()),this.$categoryContainer=o(".js-categories-container"),this.updateNumberOfItemsInputDisability(),o("input[name=limit_number_of_categories]").change((function(){e.updateCategoryPreview()})),o("input[name=number_of_items]").change(a.throttle((function(){e.updateCategoryPreview()}),30))}var t=e.prototype;return t.doesLimitNumberOfCategories=function(){return"limited"===o("input[name=limit_number_of_categories]:checked").val()},t.updateNumberOfItemsInputDisability=function(){o("#number_of_items").prop("disabled",!this.doesLimitNumberOfCategories())},t.updateCategoryPreview=function(){var e=this,t=o(".js-categories-order-type option:selected").val(),n=this.doesLimitNumberOfCategories(),r=o("#number_of_items").val();this.updateNumberOfItemsInputDisability(),o.ajax({url:this.$categoryContainer.data("getUrl"),data:{order_type:t}}).done((function(i){e.$categoryContainer.html(e.categoryTemplate({categories:i.categories,sortableContainerClass:u[t]||"",sortableItemClass:l[t]||"",doesLimitNumberOfCategories:n,categoriesCountLimit:r})),"user"===t&&e.setupSortable()}))},t.setupSortable=function(){var e=this;this.$categoryContainer.find(".js-categories-sortable").each((function(t,n){var r=o(n);s.create(n,{animation:150,group:"shared",forceFallback:!0,onUpdate:function(){e.updateSortedCategories(r)},onAdd:function(){e.updateSortedCategories(r)}})}))},t.updateSortedCategories=function(e){var t=this,n=this.$categoryContainer.find(".js-categories-sortable-item").map((function(e,t){return o(t).data("categoryName")})).get();o.ajax({type:"POST",url:e.data("sortUrl"),data:{category_names:n,rkm:(0,i.default)("rkm"),rkc:(0,i.default)("rkc")},traditional:!0}).done((function(){t.updateCategoryPreview()}))},e}();e.exports=c},3147:function(e,t,n){n(4723),n(74916),n(69600),n(69826),n(15306);var r=o(n(57942)),i=o(n(20996));function o(e){return e&&e.__esModule?e:{default:e}}var a=n(73609),s={init:function(e){var t=e.$input,n=e.size,r=a.Deferred(),i="undefined"!=typeof FormData,o=function(e){var t=e.match(/f:id:([^:]+):(\d+)([jpg]):image/);if(t){var n=t[1],i=t[2],o=t[3],a=[n.substring(0,1),n,i.substring(0,8),i].join("/"),s="https://cdn-ak.f.st-hatena.com/images/fotolife/"+a+{j:".jpg",p:".png",g:".gif"}[o],u="https://cdn-ak.f.st-hatena.com/images/fotolife/"+a+"_120.jpg";r.notify({fid:e,url:s,thumbnail_url:u})}};return i?t.on("change",(function(){if(this.files.length)return s.uploadImage({file:t[0],$input:t,folder:"Hatena Blog",fotosize:n,callback:o}),!1})):s.setIframeUploader({$fileInput:t,fotosize:n,callback:o}),r.promise()},uploadImage:function(e){var t=e.file,n=e.folder,o=e.fotosize,s=e.$input,u=e.callback;s.prop("disabled",!0);var l=new FormData;l.append("rkm",(0,r.default)("rkm")),l.append("append",1),l.append("fototitle",""),l.append("folder",n),l.append("fotosize",o),l.append("image",t.files[0]),l.append("delete-gps",1);var c=a(t).parent().parent().find(".progress");c.show();var d=c.find("div.bar");d.width("0%");var f=c.find("div.percent"),p=function(e){e>100&&(e=100),d.width(e+"%"),f.text(i.default.text("uploading"))},h=new XMLHttpRequest;h.upload.addEventListener("progress",(function(e){var t=e.lengthComputable?e.loaded/e.total*100:NaN;p(t)}),!1),h.addEventListener("load",(function(e){s.prop("disabled",!1),s.val(""),p(100),u(h.responseText),c.hide(),_.defer((function(){p(0)}))}),!1),h.addEventListener("error",(function(e){c.addClass("error"),s.val(""),f.text("error"),s.prop("disabled",!1)}),!1),h.open("POST","/f/"+(0,r.default)("name")+"/upbysmart"),h.setRequestHeader("X-Requested-With","XMLHttpRequest"),h.send(l)},setIframeUploader:function(e){var t=e.$fileInput,n=e.fotosize,r=e.callback,o=a("<iframe/>");t.replaceWith(o);var s="/api/upload/fotolife_smart";o.attr("src",s),o.addClass("uploader"),o.load((function(){var e;if(o[0].contentDocument)e=o[0].contentDocument;else{if(!o[0].contentWindow)return;e=o[0].contentWindow.document}e.body.innerHTML.match(/^\s*(f:id:\S+)/)&&o[0].contentWindow.location.replace(s),r(e.body.innerHTML),a(e).find('input[name="fotosize"]').val(n);var t=a(e).find('input[type="file"]');a(t[0]).change((function(){a(e).find("#fotolife-upload-form").submit(),a(t[0]).replaceWith(a("<h5>").text(i.default.text("uploading")))}))}))}};e.exports=s},44474:function(e,t,n){n(69826),n(15306),n(74916);var r=n(73609),i=n(13469),o=function(e,t){var n=this;n.imageSize=t,n.$container=e,n.$image_src=e.find(".js-image-src"),n.$image_id=e.find(".js-image-id"),n.$display_area=e.find(".js-display-area"),i.defer((function(){n.updated()}))};o.prototype={setImage:function(e,t){this.$image_src.val(e),this.$image_id.val(t),this.$display_area.val(""),this.$display_area.length||this.updated()},setDisplayArea:function(e){this.$display_area.val(JSON.stringify(e)),this.updated()},clear:function(){this.$image_src.val(""),this.$image_id.val(""),this.$display_area.val(""),this.updated()},getImageSrc:function(){return this.$image_src.val()},getThumbnailSrc:function(){return this.getImageSrc().replace(/\.(jpg|png|gif)$/,"_120.jpg")},getImageId:function(){return this.$image_id.val()},getDisplayArea:function(){var e;try{e=JSON.parse(this.$display_area.val())}catch(e){}return e},getTrimmingArea:function(){var e=this.getDisplayArea();return e?[e.x,e.y,e.x2,e.y2]:[0,0,this.imageSize.width,this.imageSize.height]},updated:function(){r(this).triggerHandler("updated")}},e.exports=o},36384:function(e,t,n){n(69826);var r=n(73609),i=n(42807),o=function(e){this.$container=e,this.jcrop=r.Jcrop(this.$container.find(".js-header-image-thumbnail"),{bgOpacity:"0.4",addClass:"jcrop-dark",allowSelect:!1,allowResize:!1,allowMove:!1})};o.prototype={render:function(e,t,n){var r=this;e?r.jcrop.setImage(t,(function(){n&&r.setArea(e,t,n)})):n&&r.setArea(e,t,n),r.$container.show()},clear:function(){this.$container.hide()},setArea:function(e,t,n){var r=this;i([e,t]).done((function(e){var t=e[0],i=e[1].height/t.height,o=[0,n.y*i,n.w,n.y2*i];r.jcrop.setSelect(o)}))}},e.exports=o},28461:function(e,t,n){t.__esModule=!0,t.default=void 0,n(15306),n(74916),n(57327),n(69826);var r=a(n(73609)),i=a(n(60717)),o=n(9304);function a(e){return e&&e.__esModule?e:{default:e}}var s={init:function(){var e=(0,r.default)("#css"),t=(0,r.default)("#themes .js-theme-item");t.addClass("ui-selectee").on("click",(function(n){var a=(0,r.default)(n.currentTarget),s=a.attr("data-css").replace(/\s+/g," "),u=a.attr("data-id"),l=a.attr("data-store-url"),c=new i.default(e.val());c.setData("theme",u,'@import "'+s+'";'),e.val(c.getCSS()),e.trigger("change"),t.removeClass("ui-selected"),a.addClass("ui-selected"),(0,o.updateLinkToCurrentTheme)(l)}));var n=(0,r.default)("#background-image-thumbnail"),a=(0,r.default)("#backgrounds li"),s=(0,r.default)("#background-colors li");a.addClass("ui-selectee").on("click",(function(t){var o=(0,r.default)(t.currentTarget),u=o.attr("data-css").replace(/\s+/g," "),l=o.attr("data-id"),c=new i.default(e.val());c.setData("background",l,u),e.val(c.getCSS()),e.trigger("change"),a.removeClass("ui-selected"),s.removeClass("ui-selected"),o.addClass("ui-selected"),n.removeClass("ui-selected"),(0,r.default)('input[name="bg-image-selected"]').val(0)})),s.addClass("ui-selectee").on("click",(function(t){var o=(0,r.default)(t.currentTarget),u=new i.default(e.val()),l=o.attr("data-css").replace(/\s+/g," "),c=o.attr("data-id"),d=u.getData("background").content;n.hasClass("ui-selected")&&d&&(l=d.replace(/background-color:(.*?);/,"background-color:#"+c+";"),c="custom"),a.removeClass("ui-selected"),u.setData("background",c,l),e.val(u.getCSS()),e.trigger("change"),s.removeClass("ui-selected"),o.addClass("ui-selected")}));var u=new i.default(e.val()),l=u.getData("theme").selected;if(l){var c=t.filter('[data-id="'+l+'"]');c.addClass("ui-selected"),(0,o.updateLinkToCurrentTheme)(c.attr("data-store-url"))}else t.removeClass("ui-selected");var d=u.getData("background").selected;d?(0,r.default)("#backgrounds, #background-colors").find('[data-id="'+d+'"]').addClass("ui-selected"):a.removeClass("ui-selected")}};t.default=s},36848:function(e,t,n){n(69826),n(15306),n(74916);var r,i=(r=n(20996))&&r.__esModule?r:{default:r};function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var a=n(73609),s=n(13469),u=function(e){var t,n;function r(t){var n;(n=e.call(this)||this).$element=t,n.type=n.$element.find("input.js-module-type").val(),n.title=n.$element.find("input.js-module-title").val(),n.value={};try{n.value=JSON.parse(n.$element.find("input.js-module-value").val())}catch(e){}return n.$element.on("click",".js-edit-module",(function(){return n.edit(),!1})).on("click",".js-remove-module",(function(){return confirm(i.default.text("blog.confirm.delete"))&&n.remove(),!1})),n}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,o(t,n);var a=r.prototype;return a.edit=function(){this.emit("edit")},a.remove=function(){this.$element.remove(),this.emit("removed")},a.update=function(e,t,n){this.type=e,this.title=t,this.value=n,this.render(),this.emit("updated")},a.isNewModule=function(){return this.isNew},a.setAsNewModule=function(){this.isNew=!0,this.$element.addClass("created")},a.unsetAsNewModule=function(){this.isNew=!1,this.$element.removeClass("created")},a.setAsSelected=function(){this.$element.addClass("selected")},a.unsetAsSelected=function(){this.$element.removeClass("selected")},a.render=function(){this.$element.find("input.js-module-type").val(this.getType()),this.$element.find("input.js-module-title").val(this.getTitle()),this.$element.find("input.js-module-value").val(this.getValueAsJSON()),this.$element.addClass(this.getType()),this.$element.find(".title, .clipped-content").text(this.getTitleForPreview())},a.getType=function(){return this.type},a.getTitle=function(){return this.title},a.getValue=function(){return this.value},a.getElement=function(){return this.$element},a.getTitleForPreview=function(){var e=this.getTitle();return e||"html"!==this.getType()||(e=this.removeTag(this.value["module-value"]||"")||i.default.text("blog.module.html")),e},a.getValueAsJSON=function(){return JSON.stringify(this.value)},a.removeTag=function(e){return e.replace(/<.*?>/g,"")},r}(n(17187).EventEmitter);u.initializeWithModulesPosition=function(e){var t=a(".new-module-template").html(),n=s.template(t)({position:e}),r=a(a.parseHTML(n));return new u(r)},e.exports=u},24634:function(e,t,n){n(69826),n(57327);var r=n(73609),i=function(e){var t=this;t.$modalWindow=e,t.$modalWindow.appendTo(document.body),t.$dialogBox=t.$modalWindow.find(".dialog-box"),t.$dialogOverray=t.$modalWindow.find(".dialog-overray"),t.$applyButton=t.$modalWindow.find(".submit button.apply"),t.$cancelButton=t.$modalWindow.find(".submit button.cancel"),t.$radios=t.$modalWindow.find(".radios"),t.session=r.Deferred(),t.session.reject(),t.init()};i.prototype={init:function(){var e=this;e.$radios.find("input:radio").change((function(){var t=e.$radios.find("input:radio:checked").val();e.selectPanelByType(t),e.updateSettingsAvailability()})),e.$modalWindow.find(".radio").click((function(){var t=r(this).find("input:radio").val();e.selectPanelByType(t),e.updateSettingsAvailability()})),e.$modalWindow.find("#module-value-component-link").each((function(){var t=r(this);t.find("#add-link-input-button").click((function(){var n=t.find(".link-input").eq(0).clone();n.find(":input").val(""),n.insertAfter(t.find(".link-input").eq(-1));var r=e.$modalWindow.find(".module-value-box-inner");r.scrollTop(r[0].scrollHeight)}))})),e.$modalWindow.delegate(".delete-link-input-button","click",(function(){return e.$modalWindow.find(".link-input").length>1&&r(this).closest(".link-input").remove(),!1})),e.$applyButton.click((function(){e.applyEdit()})),e.$dialogOverray.click((function(){e.cancelEdit()})),e.$cancelButton.click((function(){e.cancelEdit()})),r(window).keyup((function(t){"S-ESC"===keyString(t)&&e.cancelEdit()})),e.$modalWindow.find(".js-categories-order-type").change((function(){r(e).triggerHandler("change-category-order-type")})),e.$modalWindow.find(".js-restrict-entry-title-length").change((function(){e.updateSettingsAvailability()})),e.$modalWindow.find(".js-enable-customize-format").change((function(){e.updateSettingsAvailability()})),e.$modalWindow.find(".js-variable-toggle").click((function(){return e.$modalWindow.find(".js-variable-help").slideToggle(),!1}))},editNewModule:function(e){var t=this;return t.session.reject(),t.session=r.Deferred(),t.editingModule=e,t.setupValues(),t.$modalWindow.addClass("created").removeClass("hide-radios"),t.$cancelButton.show(),t.show(),t.updateSettingsAvailability(),t.session.promise()},editModule:function(e){var t=this;return t.session.reject(),t.session=r.Deferred(),t.editingModule=e,t.setupValues(),t.$modalWindow.removeClass("created").addClass("hide-radios"),t.$cancelButton.hide(),t.selectPanelByType(e.getType()),t.show(),t.fillValuesFromModule(e),t.updateSettingsAvailability(),r(t).triggerHandler("edit-new-module"),t.session.promise()},selectPanelByType:function(e){var t=this;t.$radios.find(".radio").removeClass("selected");var n=t.$radios.find(".radio.module-"+e).closest(".radio");n.addClass("selected"),n.find("input:radio").prop("checked",!0),t.$modalWindow.find(".module-value-component").hide(),t.$modalWindow.find("#module-value-component-"+e).show()},getSelectedPanelType:function(){var e=this.$radios.find("input:enabled:checked");return e.length?e.val():null},setupValues:function(){var e=this;e.$modalWindow.find("textarea, input[type=text], input[type=number]").each((function(){r(this).attr("data-default-value")?r(this).val(r(this).attr("data-default-value")):r(this).val("")})),e.$modalWindow.find("input[type=checkbox]").prop("checked",!1),e.$modalWindow.find("select").each((function(){r(this).attr("data-default-option")?r(this).val(r(this).attr("data-default-option")):r(this).find("option:first").prop("selected",!0)})),e.$modalWindow.find("input[type=radio]").prop("checked",!1),e.$modalWindow.find("input[type=radio][data-default-radio-choise=true]").prop("checked",!0),e.$modalWindow.find("input[data-default-disabled=true]").prop("disabled",!0),e.getSelectedPanelType()||e.selectPanelByType("profile")},show:function(){var e=this,t=r("#tab-customize");t.scrollTop(t[0].scrollHeight),e.$modalWindow.show(),e.setPosition(),e.$dialogBox.find("input[type=text]:visible:first").focus()},setPosition:function(){var e=this,t=r(window).height(),n=r(window).width(),i=t/2-e.$dialogBox.height()/2,o=n/2-e.$dialogBox.width()/2;e.$dialogBox.css({top:i,left:o}),e.$dialogOverray.css({height:t,width:n})},applyEdit:function(){var e=this,t=e.extractInputToModuleValues();e.session.resolve(t),e.hide()},cancelEdit:function(){this.session.reject(),this.hide()},hide:function(){this.$modalWindow.hide()},fillValuesFromModule:function(e){var t=this,n=e.getValue(),i=e.getType();for(var o in n)if("link"!==i||"link_title"!==o&&"link_url"!==o){var a=t.$dialogBox.find(":input:visible").filter((function(){return r(this).attr("name")===o}));"radio"===a.eq(0).attr("type")?a.filter((function(e,t){return r(t).attr("value")===n[o]})).prop("checked",!0):(a.eq(0).val(n[o]),"checkbox"===a.eq(0).attr("type")&&n[o]&&a.eq(0).prop("checked",!0))}else t.setLinkInput(t.$dialogBox,n,o);t.$dialogBox.find("input[name=module-title]:visible").val(e.getTitle())},updateSettingsAvailability:function(){var e=this,t=e.$dialogBox.find(".js-enable-customize-format:visible").prop("checked"),n=e.$dialogBox.find(".js-basic-config-wrapper:visible");if(e.$dialogBox.find(".js-customize-format-textarea:visible").prop("disabled",!t),n.find(":input").prop("disabled",t),t)n.find("label").addClass("disabled");else{n.find("label").removeClass("disabled");var r="0"===e.$dialogBox.find(".js-restrict-entry-title-length:visible").val();e.$dialogBox.find(".js-display-entry-title-length:visible").prop("disabled",r)}},extractInputToModuleValues:function(){var e,t=this,n=t.$dialogBox.find("input[name=module-title]:visible").val();e=t.editingModule.isNewModule()?t.getSelectedPanelType():t.editingModule.getType();var i={};n||"html"===e||(n=t.$radios.find("input:checked").attr("data-default-module-title"));return t.$dialogBox.find(":input:visible").each((function(){var e=r(this),t=e.attr("name"),n=e.val();"module-title"!==t&&("checkbox"===e.attr("type")&&(n=e.prop("checked")?1:0),("radio"!==e.attr("type")||e.prop("checked"))&&t&&(void 0===i[t]?i[t]=n:i[t]instanceof Array?i[t].push(n):i[t]=[i[t],n]))})),{type:e,title:n,value:i}},setLinkInput:function(e,t,n){var i,o=e.find(":input:visible").filter((function(){return r(this).attr("name")===n}));if(t[n]instanceof Array){for(var a=t[n].length>o.length,s=a?t[n].length-o.length:o.length-t[n].length,u=0;u<s;u++)a?((i=e.find(".link-input:visible").eq(0).clone()).find(":input").val(""),i.insertAfter(e.find(".link-input").eq(-1))):(i=e.find(".link-input:visible").eq(-1)).remove();(o=e.find(":input:visible").filter((function(){return r(this).attr("name")===n}))).each((function(e,i){r(i).val(t[n][e])}))}else{for(;o.length>1;)(i=e.find(".link-input:visible").eq(-1)).remove(),o=e.find(":input:visible").filter((function(){return r(this).attr("name")===n}));o.eq(0).val(t[n])}}},e.exports=i},67089:function(e,t,n){n(69826),n(21249);var r=n(73609),i=n(13469),o=n(49282),a=n(36848),s=function(e,t){var n=this;n.$element=e,n.editor=t,n.init()};s.prototype={init:function(){var e=this;e.position=e.$element.attr("data-modules-type"),e.modules=[],e.$element.on("click",".js-add-module",(function(){return e.addNewModule(),!1})),e.$element.find(".module").each((function(){e.addModuleFromElement(r(this))}));var t=e.$element.find(".modules")[0];o.create(t,{animation:150,onUpdate:function(){e.onSorted()}})},addModuleFromElement:function(e){var t=new a(e);this.awareModule(t),t.render()},awareModule:function(e){var t=this;t.modules.push(e),e.on("removed",(function(){t.onModuleRemoved(e)})).on("updated",(function(){t.onUpdated()})).on("edit",(function(){t.editModule(e)}))},onSorted:function(){var e=this,t=e.$element.find(".module").map((function(){var t=this;return i.find(e.modules,(function(e){return e.getElement()[0]===t}))})).toArray();e.modules=t,e.onUpdated()},onModuleRemoved:function(e){var t=this;t.modules=i.difference(t.modules,[e]),t.onUpdated()},editModule:function(e){var t=this.editor.editModule(e);e.setAsSelected(),t.done((function(t){e.update(t.type,t.title,t.value)})).always((function(){e.unsetAsSelected()}))},addNewModule:function(){var e=this,t=a.initializeWithModulesPosition(e.position);t.setAsNewModule(),t.setAsSelected(),e.$element.find(".modules").append(t.getElement()),e.editor.editNewModule(t).done((function(n){e.awareModule(t),t.update(n.type,n.title,n.value),t.unsetAsNewModule(),t.unsetAsSelected()})).fail((function(){t.remove()}))},onUpdated:function(){r(this).triggerHandler("updated")}},e.exports=s},42114:function(e,t,n){n(69826);var r,i=(r=n(57942))&&r.__esModule?r:{default:r};var o=n(73609),a=function(e){this.$form=e.$form,this.$loading=e.$loading,this.$preview=e.$preview,this.formState=e.formState,this.$deviceInput=this.$form.find(":input[name=device]"),this.device=this.$deviceInput.val(),this.pageType="index",this.failedCount=0};a.prototype={setAsIndexPreview:function(){this.pageType="index"},setAsPermalinkPreview:function(){this.pageType="permalink"},getPageType:function(){return this.pageType},setDeviceAsPC:function(){this._setDevice("pc")},setDeviceAsTouch:function(){this._setDevice("touch")},_setDevice:function(e){var t=this;t.device=e,t.$deviceInput.val(t.device),t.requestPreview(),t.$preview.toggleClass("device-touch","touch"===e)},requestPreview:function(){var e=this,t=e.$form.serialize();t!==e.serialized&&(e.serialized=t,e.preview())},preview:function(){var e=this;if(!(e.failedCount>10)){e.showEffect(),e.serialized||(e.serialized=e.$form.serialize());var t=e.serialized;e.getSignature(t).done((function(t){e.onGotSignature(t),e.failedCount=0})).fail((function(){e.failedCount++,e.requestPreview()}))}},getSignature:function(e){var t=this,n=o.Deferred();return o.ajax({url:"../../preview/design",type:"post",dataType:"json",data:e}).done((function(r){e===t.$form.serialize()?n.resolve(r):n.reject()})).fail((function(){n.reject()})),n.promise()},onGotSignature:function(e){var t=e.signature,n=e.preview_token,r=this,i=o("#preview-iframe"),a=i.clone();i.replaceWith(a),r.$preview=a;var s=r.$form,u=s.attr("action"),l=s.attr("target"),c=this.formState.isWatching;s.attr("action",r.getAction()),s.attr("target",r.$preview.attr("name"));var d=o("<textarea/>").attr("name","signature").val(t);d.appendTo(s);var f=o("<textarea/>").attr("name","token").val(n);f.appendTo(s),s.submit(),d.remove(),f.remove(),s.attr("action",u),s.attr("target",l),this.formState.isWatching=c},showEffect:function(){var e=this;e.$loading.fadeIn("fast"),setTimeout((function(){e.$loading.fadeOut("fast")}),1e3)},getAction:function(){return(0,i.default)("blogs-uri-base")+"/preview/"+this.pageType+"_design"}},e.exports=a},36532:function(e,t,n){n(69826);var r=n(73609),i=n(26410),o=function(e){this.$container=e,this.init()};o.prototype={init:function(){var e=this;e.$container.appendTo(document.body),e.session=r.Deferred(),e.session.reject(),e.jcrop=r.Jcrop(e.$container.find(".js-header-image-resizer"),{bgOpacity:"0.4",addClass:"jcrop-dark",allowSelect:!1,keySupport:!1,allowResize:!1}),e.$container.on("click",".js-header-image-apply-button",(function(){return e.save(),!1})).on("click",".js-header-image-cancel-button",(function(){return e.cancel(),!1}))},trim:function(e,t){var n=this;return n.cancel(),n.session=r.Deferred(),n.session.always((function(){n._hide()})),n.jcrop.setImage(e,(function(){n.jcrop.setSelect(t),n._show()})),n.session.promise()},save:function(){this.session.resolve(this.jcrop.tellSelect())},cancel:function(){this.session.reject(this.jcrop.tellSelect())},_show:function(){i.show(this.$container,{center:!0,showBackground:!0,closeExplicitly:!0})},_hide:function(){i.hide(this.$container)}},e.exports=o},61030:function(e,t,n){var r=n(73609),i=n(13469);e.exports=function(){i.each([["header-touch-show-html-for-pc",".js-hide-on-header-touch-show-html-for-pc"],["display-touch",".js-hide-on-display-touch"],["footer-touch-show-html-for-pc",".js-hide-on-footer-touch-show-html-for-pc"],["header-touch-show-image-for-pc",".js-hide-on-header-touch-show-image-for-pc"]],(function(e){var t=e[0],n=e[1],o=r(":input[name="+t+"]");if(o.length){var a=r(n);if(a.length){var s=function(){var e=r(":checked[name="+t+"]");e.length&&(+e.val()?a.hide():a.show())};o.on("change",(function(){i.defer(s)})),s()}}}))}},2101:function(e,t,n){n(69826);var r,i=(r=n(20996))&&r.__esModule?r:{default:r};var o=n(73609),a=n(3147),s=n(44474);e.exports=function(e){var t=e.$container,n=e.previewUpdater,r={width:+t.attr("data-max-width"),height:+t.attr("data-max-height")},u=new s(t,r),l=t.find(".js-header-image-item"),c=t.find(".js-header-image-thumbnail");o(u).on("updated",(function(){u.getImageSrc()?(c.attr("src",u.getThumbnailSrc()).show(),l.show()):(c.hide(),l.hide()),n&&n.requestPreview()})),a.init({$input:t.find(".js-header-image-input"),size:r.width}).progress((function(e){u.setImage(e.url,e.fid)})),t.on("click",".js-delete-header-image",(function(){return!!confirm(i.default.text("admin.design.stop_header_image_confirm"))&&(u.clear(),!1)}))}},9304:function(e,t){t.__esModule=!0,t.updateLinkToCurrentTheme=function(e){var t=document.querySelector(".js-link-to-currently-selected-theme");t&&(e?(t.classList.remove("is-hidden"),t.setAttribute("href",e)):t.classList.add("is-hidden"))}},60717:function(e,t,n){t.__esModule=!0,t.default=void 0,n(54747),n(15306),n(74916),n(4723),n(47941),n(73210),n(69600);var r=n(13469),i=function(){function e(e){this.data={},this.setCSS(e)}var t=e.prototype;return t.setCSS=function(e){var t=this,n=this.scanCSS(e),r=n.userCSS,i=n.sectionCSSList;this.userCSS=r,i.forEach((function(e){var n=t.scanSection(e),r=n.sectionName,i=n.selected,o=n.content;r&&t.setData(r,i,o)}))},t.scanCSS=function(e){var t=[];return{userCSS:e.replace(/\n?\/\* <system([^>]+)> \*\/\n*([\s\S]+?)\n*\/\* <\/system> \*\/\n?/g,(function(e){return t.push(e),""})),sectionCSSList:t}},t.scanSection=function(e){var t=e.match(/\n?\/\* <system([^>]+)> \*\/\n*([\s\S]+?)\n*\/\* <\/system> \*\/\n?/),n=(t[0],t[1]),r=t[2],i={};return n.replace(/(\S+)="([^"]+)"/g,(function(e,t,n){i[t]=n})),{sectionName:i.section,selected:i.selected,content:r}},t.getCSS=function(){var t=this,n=[];return(0,r.uniq)((0,r.flatten)([e.sections,Object.keys(this.data).sort()])).forEach((function(e){n.push(t.getSectionAsCSS(e))})),n.push(this.userCSS),n.join("").trim()},t.getSectionAsCSS=function(e){if(!this.data[e])return"";var t=this.data[e];return['\n/* <system section="'+e+'" selected="'+t.selected+'"> */',""+t.content,"/* </system> */\n"].join("\n")},t.getData=function(e){return this.data[e]||{}},t.setData=function(e,t,n){this.data[e]={selected:t,content:n}},e}();i.sections=["theme","background"];var o=i;t.default=o},17723:function(e){var t=function(){function e(){}var t=e.prototype;return t.setModalDisabled=function(){try{localStorage["Hatena.Diary.Admin.User.Blog.Edit.Done.ExternalAuthModal.disabled"]=!0}catch(e){}},t.isModalDisabled=function(){try{return!!localStorage["Hatena.Diary.Admin.User.Blog.Edit.Done.ExternalAuthModal.disabled"]}catch(e){}},e}();e.exports=t},26028:function(e,t,n){n(69826);var r,i=(r=n(57942))&&r.__esModule?r:{default:r};var o=n(26410),a=n(17723),s=function(){function e(e){var t=this;this.$el=e,this.modal=new a,this.$el.length&&!this.modal.isModalDisabled()&&this.showModal(),this.$el.on("click","button",(function(){window.open((0,i.default)("admin-domain")+"/-/config/external")})),this.$el.on("click",".js-skip-button",(function(){return t.$el.find(".js-non-display-checkbox").prop("checked")&&t.modal.setModalDisabled(),t.hideModal(),!1}))}var t=e.prototype;return t.showModal=function(){o.show(this.$el,{center:1,showBackground:!0})},t.hideModal=function(){o.hide(this.$el)},e}();e.exports=s},49634:function(e,t,n){var r,i=(r=n(76804))&&r.__esModule?r:{default:r};var o=function(){function e(e,t,n,r,i){this.url=e,this.width=t,this.height=n,this.screenWidth=r,this.screenHeight=i,this.setLeft(),this.setTop(),this.openWindow()}var t=e.prototype;return t.setLeft=function(){this.left=Math.floor((this.screenWidth-this.width)/2)},t.setTop=function(){this.top=Math.floor((this.screenHeight-this.height)/2)},t.openWindow=function(){window.open(this.url,"share_window",(0,i.default)({width:this.width,height:this.height,left:this.left,top:this.top,scrollbars:"yes"}))},e}();e.exports=o},67677:function(e,t,n){t.__esModule=!0,t.TwitterShareForm=void 0,n(69826),n(57327);var r=s(n(73609)),i=s(n(20996)),o=s(n(57942)),a=n(13964);function s(e){return e&&e.__esModule?e:{default:e}}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=function(){function e(e,t,n,r){u(this,"$shareForm",void 0),u(this,"$textarea",void 0),u(this,"$userName",void 0),u(this,"$userNameSelector",void 0),u(this,"$shareSuccessMessage",void 0),u(this,"$shareExecuteButton",void 0),u(this,"$tweetPostedButton",void 0),u(this,"entryId",void 0),u(this,"isShareButtonDisabled",void 0),u(this,"isPosted",void 0),u(this,"serviceName",void 0),this.$shareForm=e,this.$textarea=this.$shareForm.find(".js-share-message"),this.$userName=this.$shareForm.find('input[name="js-twitter-account"]'),this.$userNameSelector=this.$shareForm.find('input[name="js-twitter-account-selector"]'),this.$shareSuccessMessage=t,this.$shareExecuteButton=this.$shareForm.find(".js-share-execute-button"),this.entryId=r,this.serviceName="twitter",this.isPosted=!1,this.isShareButtonDisabled=!1,this.$tweetPostedButton=n,this.initEvents()}var t=e.prototype;return t.initEvents=function(){var e=this;this.updateShareExecuteButton(),this.hideShareSuccessMessage(),this.$textarea.on("input",(function(){e.validateMessage(e.$textarea.val())?(e.$shareForm.find(".js-validation-error").hide(),e.isShareButtonDisabled=!1,e.updateShareExecuteButton()):(e.$shareForm.find(".js-validation-error").show(),e.isShareButtonDisabled=!0,e.updateShareExecuteButton())})),this.$userNameSelector.on("change",(function(){e.updateShareExecuteButton()})),this.$shareExecuteButton.on("click",(function(t){if(t.preventDefault(),!e.isPosted&&!e.isShareButtonDisabled){var n=e.$textarea.val(),r=e.getUserName();e.validateMessage(n)&&r&&e.post(n,r)}}))},t.getUserName=function(){return this.$userName.val()||this.$userNameSelector.filter(":checked").first().val()},t.updateShareExecuteButton=function(){!this.getUserName()||this.isShareButtonDisabled||this.isPosted?this.$shareExecuteButton.prop("disabled",!0):this.$shareExecuteButton.prop("disabled",!1)},t.validateMessage=function(e){return(0,a.validateTweetLength)(e)},t.showShareSuccessMessage=function(){this.$shareSuccessMessage.find("p").text(i.default.text("blog.social.share.success",i.default.text("blog.social.service.name."+this.serviceName))),this.$shareSuccessMessage.show()},t.hideShareSuccessMessage=function(){this.$shareSuccessMessage.hide()},t.post=function(e,t){var n=this;window.confirm(i.default.text("blog.edit_done.confirm.tweet")+"\n"+e)&&(this.isPosted=!0,this.updateShareExecuteButton(),r.default.ajax({url:"post_to_social_service",type:"POST",data:{rkm:(0,o.default)("rkm"),rkc:(0,o.default)("rkc"),service_name:this.serviceName,entry_id:this.entryId,user_name:t,message:e}}).done((function(){n.$shareForm.hide(),n.$tweetPostedButton.show(),n.showShareSuccessMessage()})).fail((function(){n.isPosted=!1})))},e}();t.TwitterShareForm=l},34525:function(e,t,n){n(21249),n(68309),n(69826);var r=n(73609),i=n(13469),o=n(16622),a=n(64300),s=function(){function e(){this.load()}var t=e.prototype;return t.load=function(){var e=this;r.ajax({url:"categories.json"}).done((function(t){e.onLoaded(t)}))},t.reload=function(){this.load()},t.onLoaded=function(e){var t=this;this.categories?(this.newCategories=[],i.each(e.categories,(function(e){var n=t.getCategory(e.name);n?n.setEntriesCount(e.count):(n=new o(e),t.categories.push(n),t.newCategories.push(n))}))):(this.categories=i.map(e.categories,(function(e){return new o(e)})),this.newCategories=this.categories),a.categories=this,r(this).triggerHandler("loaded")},t.getNewCategories=function(){return this.newCategories},t.getCategory=function(e){return i.find(this.categories,(function(t){return t.getName()===e}))},e}();e.exports=s},10281:function(e,t,n){var r=n(73609),i=function(){function e(){var e=this;this.$dropdown=r(".js-category-dropdown-list"),this.$dropdownToggle=r(".js-category-dropdown-toggle"),this.$dropdownToggle.on("click",(function(){return e.toggleDropdown(),!1})),r(document).on("click",(function(){e.hideDropdown()}))}var t=e.prototype;return t.toggleDropdown=function(){this.$dropdown.toggle()},t.hideDropdown=function(){this.$dropdown.hide()},e}();e.exports=i},69864:function(e,t,n){n(41539),n(66992),n(33948);var r,i=(r=n(20996))&&r.__esModule?r:{default:r},o=n(24367);var a=n(73609),s=n(13469),u=n(11135),l=n(45660),c=function(){function e(e,t){var n=this;this.categories=e,this.entries=t,this.$categoriesSelector=a(".js-categories-selector"),this.$createNewCategory=a(".js-create-new-category"),a(e).on("loaded",(function(){n.render()})),a(".js-create-new-category").on("click",(function(){var e=(0,o.formatCategoryName)(window.prompt(i.default.text("create_category")));e&&n.entries.addCategoryToSelectedEntries(e).always((function(){n.categories.reload()}))}))}return e.prototype.render=function(){var e=this;s.each(this.categories.getNewCategories(),(function(t){var n=new l(t);e.$categoriesSelector.append(n.getElement());var r=new u(t,e.entries);e.$createNewCategory.before(r.getElement())}))},e}();e.exports=c},16622:function(e,t,n){n(68309);var r=n(73609),i=function(){function e(e){this.data=e}var t=e.prototype;return t.getName=function(){return this.data.name},t.getEntriesCount=function(){return this.data.count},t.setEntriesCount=function(e){this.data.count=e,r(this).triggerHandler("change")},e}();e.exports=i},11135:function(e,t,n){n(41539),n(66992),n(33948);var r=n(73609),i=n(64300),o=function(){function e(e,t){var n=this;this.category=e,this.entries=t,this.render(),this.$element.on("click",(function(){n.entries.addCategoryToSelectedEntries(n.category.getName()).always((function(){i.categories.reload()}))})),r(this.category).on("change",(function(){n.render()}))}var t=e.prototype;return t.render=function(){this.$element||(this.$element=r("<li>"));var e=this.category.getName(),t=this.category.getEntriesCount();this.$element.text(e+" ("+t+")")},t.getElement=function(){return this.$element},e}();e.exports=o},45660:function(e,t,n){n(73609);var r=function(){function e(e){this.category=e,this.render()}var t=e.prototype;return t.render=function(){if(!this.element){this.element=document.createElement("option");var e=this.category.getName();this.element.setAttribute("value",e),this.element.textContent=e}},t.getElement=function(){return this.element},e}();e.exports=r},64300:function(e){e.exports={entries:null,categories:null}},99266:function(e,t,n){n(41539),n(66992),n(33948),n(21249),n(92222),n(57327);var r,i=(r=n(57942))&&r.__esModule?r:{default:r};var o=n(73609),a=n(13469),s=n(60191),u=n(64300),l=function(){function e(){}var t=e.prototype;return t.load=function(){var e=this,t={};this.keyword&&(t.q=this.keyword),this.category&&(t.category=this.category),this.hatenaId&&(t.hatena_id=this.hatenaId),this.datetimeFrom&&(t.datetime_from=this.datetimeFrom),this.datetimeTo&&(t.datetime_to=this.datetimeTo),"all"!==this.getPermission()&&(t.permission=this.getPermission());var n=a.last(this.entries);n&&(t.until=n.getCreatedTime()/1e3),o.ajax({url:"entries.json",data:t}).done((function(t){e.onLoaded(t)}))},t.onLoaded=function(e){var t=o(this);this.receivedEntries=a.map(e.entries,(function(e){return new s(e)})),o(this.receivedEntries).on("select",(function(){t.triggerHandler("select")})).on("remove",(function(){t.triggerHandler("remove")})),this.entries||(this.entries=[]),this.entries=this.entries.concat(this.receivedEntries),this.hasMore=e.has_more,u.entries=this,o(this).triggerHandler("loaded")},t.reset=function(){a.each(this.entries,(function(e){e.remove()})),this.entries=[],this.receivedEntries=[],this.hasMore=void 0,o(this).triggerHandler("reset"),this.load()},t.getEntries=function(){return this.entries},t.getReceivedEntries=function(){return this.receivedEntries},t.hasMoreEntries=function(){return this.hasMore},t.setKeyword=function(e){this.keyword=e},t.getKeyword=function(){return this.keyword},t.setCategory=function(e){this.category=e},t.setHatenaID=function(e){this.hatenaId=e},t.setDatetimeFrom=function(e){this.datetimeFrom=e},t.setDatetimeTo=function(e){this.datetimeTo=e},t.setPermission=function(e){this.permission=e,o(this).triggerHandler("permissionChanged",e)},t.getPermission=function(){return this.permission},t.getSelectedEntries=function(){return a.filter(this.entries,(function(e){return e.isSelected()}))},t.deleteSelectedEntries=function(){var e=this,t=this.getSelectedEntries();if(t.length){var n=o.ajax({type:"post",url:"entries.delete.json",data:{entry:a.map(t,(function(e){return e.getUUID()})),rkm:(0,i.default)("rkm"),rkc:(0,i.default)("rkc")},traditional:!0});return n.done((function(){e.entries=a.difference(e.entries,t),a.each(t,(function(e){e.remove()}))})),n}},t.addCategoryToSelectedEntries=function(e){var t=this.getSelectedEntries();if(t.length)return a.each(t,(function(t){t.addCategory(e)})),o.ajax({type:"post",url:"entries.add_category.json",data:{entry:a.map(t,(function(e){return e.getUUID()})),category:e,rkm:(0,i.default)("rkm"),rkc:(0,i.default)("rkc")},traditional:!0})},e}();e.exports=l},27866:function(e,t,n){var r=n(73609),i=function(){function e(e){this.$element=r(e)}return e.prototype.show=function(){this.$element.stop().show().delay(1e4).fadeOut()},e}();e.exports=i},29130:function(e,t,n){n(41539),n(66992),n(33948),n(69826),n(54747),n(60285),n(78783);var r,i=(r=n(20996))&&r.__esModule?r:{default:r};var o=n(73609),a=n(13469),s=n(64300),u=n(202),l=n(27866),c=n(2521),d=function(){function e(e){var t=this;!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"isSetSearchFormParam",(function(){return[t.$keywordField,t.$categoryField,t.$hatenaIdField,t.$datetimeFromField,t.$datetimeToField].some((function(e){return!!e.val()}))})),this.entries=e;var n=o(e);this.entriesDeletedView=new l(document.querySelector(".js-entry-deleted-message")),this.$entriesContainer=o(".js-entries-container"),this.$loadNextPage=o(".js-load-next-page"),this.$form=o(".js-entry-search-form"),this.$keywordField=this.$form.find(':input[name="q"]'),this.$categoryField=this.$form.find(':input[name="category"]'),this.$hatenaIdField=this.$form.find(':input[name="hatena_id"]'),this.$datetimeFromField=this.$form.find(':input[name="datetime_from"]'),this.$datetimeToField=this.$form.find(':input[name="datetime_to"]'),this.entriesAdvancedSearchButton=document.querySelector(".js-entries-advanced-search"),this.resetFormButton=document.querySelector(".js-entry-search-form-reset"),n.on("loaded",(function(){t.render()})),n.on("select remove",(function(){t.renderButtons()})),this.$loadNextPage.on("click",(function(){t.entries.load()})),o(".js-delete-entries-button").on("click",(function(){var e=t.entries.getSelectedEntries().length;confirm(i.default.text("epic.entry.delete.confirm_with_entries_num",e))&&t.entries.deleteSelectedEntries().always((function(){s.categories.reload(),t.entriesDeletedView.show()}))})),this.entriesAdvancedSearchButton.addEventListener("click",(function(){t.entriesAdvancedSearchButton.classList.contains("open")?t.closeEntriesAdvancedSearchBox():t.openEntriesAdvancedSearchBox()})),this.$form.on("submit",(function(n){n.preventDefault(),e.setKeyword(t.$keywordField.val()),e.setCategory(t.$categoryField.val()),e.setHatenaID(t.$hatenaIdField.val()),e.setDatetimeFrom(t.$datetimeFromField.val()),e.setDatetimeTo(t.$datetimeToField.val()),e.reset()})),o(".js-select-all-entries").on("change",(function(n){o(n.currentTarget).is(":checked")?e.getEntries().forEach((function(e){e.select()})):e.getEntries().forEach((function(e){e.unselect()})),t.renderButtons()})),new URL(window.location.href).searchParams.get("deleted")&&this.entriesDeletedView.show(),this.$form.on("change",(function(){t.renderResetButton()})),o(".js-entry-search-box-input").on("input",(function(){t.renderResetButton()})),document.querySelector(".js-entry-search-form").addEventListener("reset",(function(){t.resetEntriesSearch(),e.reset(),t.resetFormButton.style.display="none"})),c.setupCloseHandler()}var t=e.prototype;return t.render=function(){var e=this;a.each(this.entries.getReceivedEntries(),(function(t){var n=new u(t);e.$entriesContainer.append(n.getElement())})),this.entries.hasMoreEntries()?this.$loadNextPage.show():this.$loadNextPage.hide(),this.renderButtons(),o(this).triggerHandler("rendered")},t.renderButtons=function(){var e=o(".js-delete-entries-button"),t=o(".js-category-dropdown-toggle");this.entries.getSelectedEntries().length>0?(e.prop("disabled",!1).removeClass("disabled").addClass("btn-danger"),t.prop("disabled",!1).removeClass("disabled")):(e.prop("disabled",!0).addClass("disabled").removeClass("btn-danger"),t.prop("disabled",!0).addClass("disabled"))},t.closeEntriesAdvancedSearchBox=function(){this.entriesAdvancedSearchButton.classList.remove("open"),document.querySelector(".js-table-blog-entries-advanced-search").style.display="none"},t.openEntriesAdvancedSearchBox=function(){this.entriesAdvancedSearchButton.classList.add("open"),document.querySelector(".js-table-blog-entries-advanced-search").style.display="block"},t.resetEntriesSearch=function(){this.entries.setKeyword(void 0),this.entries.setCategory(void 0),this.entries.setHatenaID(void 0),this.entries.setDatetimeFrom(void 0),this.entries.setDatetimeTo(void 0)},t.renderResetButton=function(){this.isSetSearchFormParam()?this.resetFormButton.style.display="":this.resetFormButton.style.display="none"},e}();e.exports=d},60191:function(e,t,n){var r,i=(r=n(23218))&&r.__esModule?r:{default:r};var o=n(73609),a=n(13469),s=function(){function e(e){this.data=e}var t=e.prototype;return t.getUUID=function(){return this.data.uuid},t.getURL=function(){return this.data.url},t.getEditURL=function(){return this.data.edit_url},t.getEditScheduledUpdateURL=function(){return this.data.edit_scheduled_update_url},t.getRevisionsURL=function(){return this.data.revisions_url},t.getMakingACopyURL=function(){return this.data.making_a_copy_url},t.getTitle=function(){return this.data.title},t.getSummary=function(){return this.data.summary},t.getThumbnailImage=function(){if(this.data.thumbnails&&this.data.thumbnails[60])return this.data.thumbnails[60]},t.getCreated=function(){return this.data.created},t.getCreatedTime=function(){return this.getCreatedDate().getTime()},t.getCreatedDate=function(){return(0,i.default)(this.data.created)},t.getDatetime=function(){return this.data.datetime},t.getDatetimeTime=function(){var e=this.getDatetimeDate();return e?e.getTime():null},t.getDatetimeDate=function(){return(0,i.default)(this.data.datetime)},t.getAuthorName=function(){return this.data.author_name},t.getCommentCount=function(){return this.data.comment_count},t.getCategories=function(){return this.data.categories},t.isPublic=function(){return this.data.is_public},t.isScheduledEntry=function(){return this.data.is_scheduled_entry},t.select=function(){this.data.isSelected=!0,o(this).triggerHandler("change")},t.unselect=function(){this.data.isSelected=!1,o(this).triggerHandler("change")},t.isSelected=function(){return this.data.isSelected},t.remove=function(){o(this).triggerHandler("remove")},t.addCategory=function(e){a.contains(this.data.categories,e)||(this.data.categories||(this.data.categories=[]),this.data.categories.push(e),o(this).triggerHandler("change"))},t.canBeManageEntry=function(){return this.data.can_be_manage_entry},t.canCreateDraftPreviewToken=function(){return this.data.can_create_draft_preview_token},e}();e.exports=s},2521:function(e,t,n){n(69826);var r=n(73609),i=function(){function e(e){var t=this;this.$dropdown=e,this.$dropdown.find(".dropdown-toggle").on("click",(function(e){e.preventDefault(),e.stopPropagation();var n=r(e.currentTarget).next(".dropdown-window"),i=n.hasClass("is-open");t.constructor.closeAllDropdowns(),i?n.removeClass("is-open"):n.addClass("is-open")}))}return e.closeAllDropdowns=function(){r(".dropdown-window").removeClass("is-open")},e.setupCloseHandler=function(){var e=this;r(document).on("click",(function(){e.closeAllDropdowns()}))},e}();e.exports=i},50825:function(e,t,n){n(41539),n(66992),n(33948),n(69826);var r=n(73609),i=function(){function e(e){var t=this;this.entries=e,this.$tabs=r(".js-entry-type-select-tabs"),this.$tabs.on("click","a",(function(e){t.clicked(e)}));var n=this.$tabs.find(".ui-tabs-active").find("a").attr("data-permission");this.entries.setPermission(n)}return e.prototype.clicked=function(e){e.preventDefault(),this.$tabs.find(".ui-tabs-active").removeClass("ui-tabs-active"),r(e.target).parents("li").addClass("ui-tabs-active");var t=r(e.target).attr("data-permission");this.entries.getPermission()!==t&&(this.entries.setPermission(t),this.entries.reset())},e}();e.exports=i},202:function(e,t,n){n(15306),n(74916),n(41539),n(66992),n(33948),n(69826),n(69600),n(23123);var r,i=(r=n(20996))&&r.__esModule?r:{default:r};var o=n(73609),a=n(13469),s=n(64300),u=n(2521),l=function(){function e(e){var t=this;this.entry=e,this.permission=o(".ui-tabs-active a")[0].dataset.permission,this.rootTemplate=a.template(o(".js-entry-root-template").html().replace(/^\s*/,"").replace(/\s*$/,"")),this.elementTemplate=a.template(o(".js-entry-inner-template").html()),this.render(),o(this.entry).on("change",(function(){t.render()})).on("remove",(function(){t.remove()})),this.$element.on("change","input",(function(e){o(e.currentTarget).is(":checked")?t.entry.select():t.entry.unselect(),o(t.entry).triggerHandler("select")}))}var t=e.prototype;return t.render=function(){if(this.$element||(this.$element=o(o.parseHTML(this.rootTemplate({entry:this.entry,permission:this.permission})))),this.$element.html(this.elementTemplate({entry:this.entry,permission:this.permission})),s.entries&&s.entries.getKeyword()){var e=a.escape(s.entries.getKeyword());this.$element.find(".js-search-entry-title").html((function(t,n){var r='<span class="entry-search-keyword">'+e+"</span>";return n.split(e).join(r)})),this.$element.find(".js-search-entry-body").html((function(t,n){var r='<span class="entry-search-keyword">'+e+"</span>";return n.split(e).join(r)}))}new u(this.$element),i.default.updateTimestamps(this.$element[0])},t.remove=function(){this.$element.remove()},t.getElement=function(){return this.$element},e}();e.exports=l},90847:function(e,t,n){n(88674),n(41539),n(47042),n(91038),n(78783),n(82526),n(41817),n(32165),n(66992),n(33948),t.__esModule=!0,t.HatenaIdDataList=void 0,n(68309),n(35666);var r,i=(r=n(347))&&r.__esModule?r:{default:r},o=n(70879);function a(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c=function(){function e(){var t=this;l(this,"container",void 0),l(this,"data",void 0),this.container=document.querySelector(".js-hatena-ids-selector"),e._load().then((function(e){void 0!==e&&(t.data=e,t._render())}))}return e._load=function(){var e,t=(e=regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.default.get("./entries_member.json");case 3:return t=e.sent,e.abrupt("return",t.data);case 7:return e.prev=7,e.t0=e.catch(0),(0,o.BUG)(e.t0,"Load entries member"),e.abrupt("return",void 0);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})),function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){u(o,r,i,a,s,"next",e)}function s(e){u(o,r,i,a,s,"throw",e)}a(void 0)}))});return function(){return t.apply(this,arguments)}}(),e.prototype._render=function(){if(this.container)for(var e,t=a(this.data.members);!(e=t()).done;){var n=e.value,r=document.createElement("option");r.value=n.name,this.container.appendChild(r)}},e}();t.HatenaIdDataList=c},13794:function(e,t,n){n(69826),n(47042);var r,i=(r=n(57942))&&r.__esModule?r:{default:r},o=n(55992);var a=n(73609),s=function(){function e(e){var t=this;this.section=a("section")[0],this.$shareBoxWrapper=a(".js-share-draft-box-wrapper"),this.$shareBox=a(".js-share-draft-box"),this.$tokenInput=this.$shareBox.find("input"),this.$closeButton=this.$shareBox.find(".btn-close"),this.$mask=this.$shareBoxWrapper.find(".mask"),this.pos={top:-9999,left:-9999},a(e).on("rendered",(function(){t.initEvent()}))}var t=e.prototype;return t.initEvent=function(){var e=this;this.$shareButton=a(".js-icon-share-draft"),this.$shareButton.on("click",(function(t){var n=t.currentTarget,r=e.section.getBoundingClientRect(),i=n.getBoundingClientRect();e.setWindowPosition({top:i.bottom-r.top,left:i.right-r.left});var o=a(n).data("publicationType"),s=a(n).data("uuid");return e.openShareDraftWindow(t,o,s),!1})),this.$closeButton.on("click",(function(){return e.closeShareDraftWindow(),!1})),this.$mask.on("click",(function(){return e.closeShareDraftWindow(),!1}))},t.setWindowPosition=function(e){this.pos=e},t.openShareDraftWindow=function(e,t,n){var r=this,s={rkm:(0,i.default)("rkm"),rkc:(0,i.default)("rkc"),publication_type:t,uuid:n};a.ajax({url:"./share_existing_draft",type:"POST",dataType:"json",data:s}).done((function(e){r.$shareBoxWrapper.addClass("visible");var n=+r.$shareBox.css("margin").slice(0,-2),i=r.pos.top+r.$shareBox[0].getBoundingClientRect().height+2*n-r.section.offsetHeight;i>0&&(r.pos.top=Math.max(r.pos.top-i+10,20)),r.$shareBox.css(r.pos);var a=e.token,s=(0,o.userBlogUrl)("/draft/"+t+"/"+a);r.$tokenInput.val(s).focus().select()}))},t.closeShareDraftWindow=function(){this.$shareBoxWrapper.removeClass("visible")},e}();e.exports=s},21593:function(e,t,n){t.__esModule=!0,t.TopPlacedActivateButtonsHandler=void 0;var r=o(n(73609)),i=o(n(20996));function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}t.TopPlacedActivateButtonsHandler=function(e){var t=this;a(this,"controller",void 0),a(this,"switcherPanel",void 0),a(this,"entriesView",void 0),a(this,"_setupActivateButtonListeners",(function(){(0,r.default)(t.entriesView).on("rendered",(function(){(0,r.default)(".js-top-placed-activate-button").on("click",(function(e){var n=e.currentTarget;e.stopPropagation(),e.preventDefault(),n.disabled=!0;var r=n.dataset.uuid;if(!r)return n.disabled=!1,!1;if(!window.confirm(i.default.text("admin.entries.top_placed_publication.confirm_activation")))return n.disabled=!1,!1;var o=t.switcherPanel.getBlogId();if(!o)return n.disabled=!1,!1;var a=t._successfulActivationHandlerGenerator(n),s=t._errorActivationHandlerGenerator(n);t.controller.activate(o,r).then(a).catch(s)}))}))})),a(this,"_topPlacedEntryLabelFactory",(function(e,t,n){return e&&"■"!==e?e:t?t.substr(0,30):n})),a(this,"_successfulActivationHandlerGenerator",(function(e){return function(){t.switcherPanel.isPublicationTopPlaced()?window.alert(i.default.text("admin.entries.top_placed_publication.activated_overwritten")):window.alert(i.default.text("admin.entries.top_placed_publication.activated"));var n=e.dataset.url,r=e.dataset.title,o=e.dataset.summary,a=t._topPlacedEntryLabelFactory(r,o,n);t.switcherPanel.configureTopPlacedPublication(a,n),e.disabled=!1}})),a(this,"_errorActivationHandlerGenerator",(function(e){return function(t){throw t.response&&404===t.response.status?window.alert(i.default.text("admin.entries.top_placed_publication.not_found")):window.alert(i.default.text("admin.entries.top_placed_publication.comm_failed")),e.disabled=!1,t}})),this.controller=e.controller,this.switcherPanel=e.switcherPanel,this.entriesView=e.entriesView,this._setupActivateButtonListeners()}},13118:function(e,t,n){t.__esModule=!0,t.TopPlacedEntrySwitcher=void 0;var r=o(n(20996)),i=o(n(73609));function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s=function(){function e(e){a(this,"containerSet",void 0),a(this,"controller",void 0),a(this,"deactivateButton",void 0),this.controller=e.controller,this.containerSet=e.containerSet;var t=this.containerSet.querySelector(".js-deactivate-button");if(!t)throw Error(".js-deactivate-button and .js-top-publication-name-box required");this.deactivateButton=t,this._updateVisibility(),this._registerEvents()}var t=e.prototype;return t._registerEvents=function(){var e=this;this.deactivateButton.addEventListener("click",(function(t){t.stopPropagation(),t.preventDefault(),e.deactivateButton.setAttribute("disabled","1");var n=e.getBlogId();return n&&window.confirm(r.default.text("admin.entries.top_placed_publication.confirm_deactivation"))?void e.controller.deactivate(n).then((function(){window.alert(r.default.text("admin.entries.top_placed_publication.deactivated")),e._inactivateTopPlacedPublication(),e.deactivateButton.removeAttribute("disabled")})).catch((function(t){throw window.alert(r.default.text("admin.entries.top_placed_publication.comm_failed")),e.deactivateButton.removeAttribute("disabled"),t})):e.deactivateButton.removeAttribute("disabled")})),(0,i.default)(".js-entry-type-select-tabs a").on("click",(function(t){t.target instanceof HTMLElement&&e._updateVisibility(t.target.dataset.permission)}))},t.getBlogId=function(){return this.containerSet.dataset.blogUuid},t._getChosenTab=function(){var e=document.querySelector(".ui-tabs-active > a");if(null===e)throw Error(".ui-tabs-active > a required");return e.dataset.permission},t._updateVisibility=function(e){"public"===(e||this._getChosenTab())&&this.isPublicationTopPlaced()?this.containerSet.classList.add("is-open"):this.containerSet.classList.remove("is-open")},t.isPublicationTopPlaced=function(){return"set"===this.containerSet.dataset.isTopPlaced},t.configureTopPlacedPublication=function(e,t){var n=this.containerSet.querySelector(".js-top-placed-entry-title");n&&(n.innerText=e,n.setAttribute("href",t),this.containerSet.dataset.isTopPlaced="set",this._updateVisibility())},t._inactivateTopPlacedPublication=function(){this.containerSet.dataset.isTopPlaced="unset",this._updateVisibility()},e}();t.TopPlacedEntrySwitcher=s},46044:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.Item=void 0,n(68309),n(19601);var r,i=n(17187),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(78265));function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e){e.NEW="new",e.UPLOADING="uploading",e.SUCCESS="success",e.FAILED="failed"}(r||(r={}));var c=function(e){var t,n;function i(t,n){var i;return l(s(i=e.call(this)||this),"folder",void 0),l(s(i),"file",void 0),l(s(i),"publicURL",void 0),l(s(i),"fileInfo",void 0),l(s(i),"uploadStatus",void 0),l(s(i),"uploadedAt",void 0),i.folder=n,i.file=t,i.publicURL=null,i.uploadedAt=null,i.fileInfo={filename:i.file.name,contentType:i.file.type,previewURL:i.file.preview,isImage:o.isImage(i.file.type)},i.uploadStatus=r.NEW,i}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,u(t,n);var a=i.prototype;return a.getFile=function(){return this.file},a.getFolder=function(){return this.folder},a.getContentType=function(){return this.fileInfo.contentType},a.isWaitingForUpload=function(){return this.uploadStatus===r.NEW},a.hasUploadStarted=function(){return this.uploadStatus!==r.NEW},a.isUploading=function(){return this.uploadStatus===r.UPLOADING},a.isSuccess=function(){return this.uploadStatus===r.SUCCESS},a.isFailed=function(){return this.uploadStatus===r.FAILED},a.isCompleted=function(){return this.isSuccess()||this.isFailed()},a.emitChange=function(){this.emit("change")},a.uploadStart=function(){this.uploadStatus=r.UPLOADING,this.emitChange()},a.uploadSuccess=function(e){this.uploadStatus=r.SUCCESS,this.publicURL=e,this.uploadedAt=new Date,delete this.file,this.emitChange()},a.uploadFailed=function(){this.uploadStatus=r.FAILED,delete this.file,this.emitChange()},a.getState=function(){return Object.assign({},this.fileInfo,{publicURL:this.publicURL,uuid:null,hasUploadStarted:this.hasUploadStarted(),isUploading:this.isUploading(),isSuccess:this.isSuccess(),isFailed:this.isFailed(),uploadedAt:this.uploadedAt,showPreview:!0})},i}(i.EventEmitter);t.Item=c},66977:function(e,t,n){n(88674),n(41539),t.__esModule=!0,t.ItemsRepository=void 0,n(35666),n(21249),n(92222),n(57327);var r=n(17187),i=n(46044),o=n(55171),a=n(94676),s=n(8251);function u(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var f=function(e){var t,n;function r(t){var n;return d(l(n=e.call(this)||this),"folder",void 0),d(l(n),"items",void 0),d(l(n),"previousItems",void 0),d(l(n),"uploadQueue",void 0),n.items=[],n.previousItems=[],n.uploadQueue=[],n.folder=t,n}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,c(t,n);var f=r.prototype;return f.emitChange=function(){this.emit("change")},f.loadPreviousItems=function(){var e=this;(0,o.loadPreviousItems)().then((function(t){e.previousItems=t,e.emitChange()}))},f.filesDropped=function(e){var t=this,n=e.map((function(e){var n=new i.Item(e,t.folder);return n.on("change",(function(){t.checkForUpload(),t.emitChange()})),n}));this.items=n.concat(this.items),this.uploadQueue=this.uploadQueue.concat(n),this.checkForUpload(),this.emitChange()},f.checkForUpload=function(){var e=this.uploadQueue[0];if(e)return e.isCompleted()?(this.uploadQueue.shift(),void this.checkForUpload()):void(e.isWaitingForUpload()&&(0,a.uploadItem)(e))},f.deleteItem=function(){var e,t=(e=regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,s.deleteItem)(t);case 2:this.previousItems=this.previousItems.filter((function(e){return e.uuid!==t.uuid})),this.emitChange();case 4:case"end":return e.stop()}}),e,this)})),function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){u(o,r,i,a,s,"next",e)}function s(e){u(o,r,i,a,s,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}(),f.getState=function(){return{folder:this.folder,items:this.items.map((function(e){return e.getState()})),previousItems:this.previousItems.map((function(e){return e.getState()}))}},r}(r.EventEmitter);t.ItemsRepository=f},78265:function(e,t,n){t.__esModule=!0,t.isWebP=t.isSVG=t.isImage=void 0,n(4723),n(74916);t.isImage=function(e){return null!==e.match(/^image\//i)};t.isSVG=function(e){return"image/svg+xml"===e};t.isWebP=function(e){return"image/webp"===e}},75651:function(e,t){function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}t.__esModule=!0,t.PreviousItem=void 0;var r=function(){function e(e){n(this,"filename",void 0),n(this,"uuid",void 0),n(this,"publicURL",void 0),n(this,"contentType",void 0),n(this,"uploadedAt",void 0),this.filename=e.filename,this.uuid=e.uuid,this.contentType=e.contentType,this.uploadedAt=new Date(1e3*e.uploadedAt),this.publicURL=e.publicURL}return e.prototype.getState=function(){return{filename:this.filename,uuid:this.uuid,contentType:this.contentType,isImage:!1,uploadedAt:this.uploadedAt,previewURL:this.publicURL,publicURL:this.publicURL,hasUploadStarted:!1,isUploading:!1,isSuccess:!1,isFailed:!1,showPreview:!1}},e}();t.PreviousItem=r},4277:function(e,t,n){n(4129),n(38880),t.__esModule=!0,t.LazyUploaderLoader=void 0,n(88674),n(41539),n(78783),n(66992),n(33948);var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),o=(r=n(20996))&&r.__esModule?r:{default:r},a=n(90381);function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}var u=(0,i.lazy)((function(){return n.e(836).then(n.bind(n,76713)).then((function(e){return{default:e.UploaderContainer}}))}));t.LazyUploaderLoader=function(e){var t=e.onDrop,n=e.repository;return i.default.createElement(i.Suspense,{fallback:i.default.createElement(a.LoadingIndicator,{text:o.default.text("loading")})},i.default.createElement(u,{onDrop:t,repository:n}))}},8251:function(e,t,n){n(4129),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.deleteItem=void 0,n(88674),n(41539),n(35666);var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=o(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(347)),i=n(55992);function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(o=function(e){return e?n:t})(e)}function a(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}var s=function(){var e,t=(e=regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.uuid){e.next=2;break}throw new Error("uuid is not set");case 2:return e.abrupt("return",r.default.post((0,i.protocolRelativeAdminUserBlogUrl)("/files/delete"),{uuid:t.uuid},{transformRequest:[r.withEpicRKs,r.formDataRequest],responseType:"json"}));case 3:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function s(e){a(o,r,i,s,u,"next",e)}function u(e){a(o,r,i,s,u,"throw",e)}s(void 0)}))});return function(e){return t.apply(this,arguments)}}();t.deleteItem=s},96337:function(e,t,n){t.__esModule=!0,t.init=void 0;var r,i=(r=n(67294))&&r.__esModule?r:{default:r},o=n(73380),a=n(66977),s=n(4277);t.init=function(e){var t=new a.ItemsRepository("Hatena Blog Files");(0,o.safeRender)(i.default.createElement(s.LazyUploaderLoader,{onDrop:t.filesDropped.bind(t),repository:t}),e)}},55171:function(e,t,n){t.__esModule=!0,t.loadPreviousItems=void 0,n(35666),n(21249),n(88674),n(41539);var r,i=(r=n(347))&&r.__esModule?r:{default:r},o=n(75651);function a(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}var s=function(){var e,t=(e=regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.default.get("./list");case 2:return t=e.sent,n=t.data,e.abrupt("return",n.map((function(e){return new o.PreviousItem(e)})));case 5:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function s(e){a(o,r,i,s,u,"next",e)}function u(e){a(o,r,i,s,u,"throw",e)}s(void 0)}))});return function(){return t.apply(this,arguments)}}();t.loadPreviousItems=s},94676:function(e,t,n){t.__esModule=!0,t.uploadItem=void 0;var r=o(n(57942)),i=o(n(347));function o(e){return e&&e.__esModule?e:{default:e}}t.uploadItem=function(e){var t=e.getFile();if(t){e.uploadStart();var n=new FormData,o=(0,r.default)("rkm");o&&n.append("rkm",o);var a=(0,r.default)("rkc");a&&n.append("rkc",a),n.append("file",t),i.default.request({url:"upload",method:"post",data:n,responseType:"json"}).then((function(t){var n=t.data;e.uploadSuccess(n.publicURL)})).catch((function(){e.uploadFailed()}))}}},39338:function(e,t,n){var r=n(67321),i={init:function(e,t,n){var i=new r(t);i.on("progress",(function(t){e.css("width",t+"%")})),i.on("complete",(function(){setTimeout((function(){location.href=n}),1500)}))}};e.exports=i},67321:function(e,t,n){var r,i=(r=n(73609))&&r.__esModule?r:{default:r};function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var a=function(e){var t,n;function r(t){var n;return(n=e.call(this)||this).url=t,n.checkProgress(),n}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,o(t,n);var a=r.prototype;return a.checkProgress=function(){var e=this;i.default.ajax({url:this.url,type:"GET",cache:!1,dataType:"json"}).done((function(t){e.handleResponse(t)}))},a.handleResponse=function(e){var t=this;e.progress&&this.emit("progress",e.progress),"complete"!==e.status&&"failed"!==e.status||this.emit("complete"),"started"!==e.status&&"new"!==e.status||setTimeout((function(){return t.checkProgress()}),1e3)},r}(n(17187).EventEmitter);e.exports=a},47535:function(e,t,n){t.__esModule=!0,t.default=void 0,n(68309),n(21249),n(54747);var r,i=(r=n(67294))&&r.__esModule?r:{default:r};function o(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u=function(e){var t,n;function r(t){var n;return s(o(n=e.call(this,t)||this),"coursesByName",void 0),s(o(n),"renderDropdown",(function(){return i.default.createElement("select",{name:n.props.inputName,defaultValue:n.props.currentCourse.name,onChange:function(e){var t=e.target.value,r=n.coursesByName[t];r&&n.props.onCourseChange(r)}},n.props.availableCourses.map((function(e){return i.default.createElement("option",{key:e.name,value:e.name},e.label+" ("+e.durationDays+"日間)")})))})),n.state={editing:!1},n.coursesByName={},t.availableCourses.forEach((function(e){n.coursesByName[e.name]=e})),n}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,a(t,n),r.prototype.render=function(){var e=this;return this.state.editing?this.renderDropdown():i.default.createElement("span",null,i.default.createElement("span",{className:"text-bigger"},this.props.currentCourse.label),"(",this.props.currentCourse.durationDays,"日間)",i.default.createElement("span",{className:"btn btn-link",role:"button",onClick:function(){return e.setState({editing:!0})}},"変更する"),i.default.createElement("input",{type:"hidden",name:this.props.inputName,value:this.props.currentCourse.name}))},r}(i.default.PureComponent);t.default=u},73722:function(e,t,n){n(4129),n(38880),t.__esModule=!0,t.default=void 0,n(60285),n(41539),n(78783),n(66992),n(33948),n(68309);var r=l(n(67294)),i=l(n(849)),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=u(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(55992)),a=n(76809),s=l(n(9560));function u(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(u=function(e){return e?n:t})(e)}function l(e){return e&&e.__esModule?e:{default:e}}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var p=function(e){var t,n;function u(t){var n;return f(c(n=e.call(this,t)||this),"confirm",(function(){n.setState({confirmed:!0})})),f(c(n),"buildConfirmButton",(function(){return r.default.createElement("div",{className:"pro-btn-wrapper"},r.default.createElement("a",{href:n.props.landingPagePath,className:"btn"},"申込みをキャンセル"),r.default.createElement("button",{type:"submit",onClick:function(){return n.confirm()},className:"btn btn-primary track-click-by-gtm","data-gtm-event-action":"click","data-gtm-event-label":"admin_pro_confirm_button"},"次へ（最終確認へ進む）"))})),f(c(n),"buildRegisterCardURL",(function(){var e=new URL(n.props.registerCardUrlBase);return e.searchParams.append("redirect_uri",n.props.redirectUrl),e.href})),f(c(n),"buildRegisterCardLink",(function(){var e=n.buildRegisterCardURL();return r.default.createElement("a",{href:e,className:"btn btn-primary",role:"button","data-js-register-card-link":!0},"クレジットカードを登録する")})),f(c(n),"renderConfirmForm",(function(){var e=n.props.joinPlusUrl?r.default.createElement("li",{"data-js-join-plus-note":!0},"はてなポイントでのお支払いを希望される方は、",r.default.createElement("a",{href:n.props.joinPlusUrl},"こちら"),"からお手続きを行ってください。"):null;return r.default.createElement("section",{id:n.props.confirmFormId,className:"pro-confirm-form"},r.default.createElement("h1",null,n.props.course.label,"を申し込む"),r.default.createElement("p",null,"以下の内容で手続きを行います。内容をご確認いただき、画面下部のボタンを押してお進みください。"),r.default.createElement("table",{className:"table"},r.default.createElement("tbody",null,r.default.createElement("tr",null,r.default.createElement("th",null,"コース名"),r.default.createElement("td",null,r.default.createElement("span",{className:"text-bigger"},n.props.course.label),"(",n.props.course.durationDays,"日間)")),r.default.createElement("tr",null,r.default.createElement("th",null,"金額"),r.default.createElement("td",null,r.default.createElement("span",{className:"text-bigger text-bold"},(0,i.default)(n.props.course.price),"円")," (税込)",r.default.createElement("br",null),n.props.course.isCampaign&&r.default.createElement("div",null,"「提供開始記念 永年割引キャンペーン」適用"))),r.default.createElement(a.FirstPaymentDateRow,{shouldShowFirstPaymentOn:n.props.shouldShowFirstPaymentOn,firstPaymentOn:n.props.firstPaymentOn}),r.default.createElement(a.ExpiresOnDateRow,{expiresOn:n.props.expiresOn}))),r.default.createElement("div",{className:"admin-notice"},r.default.createElement("h3",null,"お申込みにあたって"),r.default.createElement("ul",null,r.default.createElement("li",null,"お支払には、VISA、Mastercard、JCB、American Express、Diners Clubの各種クレジットカードがご利用になれます。"),r.default.createElement("li",null,"他のコースからこのコースへ変更する場合、現在残っている有効期間が終了した後に上記の金額が決済され、新しいコースへ切り替わります。"),e)),n.props.registeredCard?n.buildConfirmButton():n.buildRegisterCardLink())})),f(c(n),"renderStartProForm",(function(){if(!n.props.registeredCard)return null;var e=n.props.registeredCard;return r.default.createElement("div",null,r.default.createElement("h1",null,n.props.course.label,"のお申し込みを確定する"),r.default.createElement("p",null,"以下の内容でお申込み手続きを行います。"," よろしければ「お申し込みを確定する」をクリックしてください。"),r.default.createElement(s.default,{actionPath:n.props.actionPath,formId:n.props.startProFormId,course:n.props.course,courseStructureVersion:n.props.courseStructureVersion,expiresOn:n.props.expiresOn,shouldShowFirstPaymentOn:n.props.shouldShowFirstPaymentOn,firstPaymentOn:n.props.firstPaymentOn,registerCardUrlBase:n.props.registerCardUrlBase,redirectUrl:n.props.redirectUrl,registeredCard:e,courseInput:r.default.createElement("span",null,r.default.createElement("span",{className:"text-bigger"},n.props.course.label),"(",n.props.course.durationDays,"日間)",r.default.createElement("input",{type:"hidden",name:"course_name",value:n.props.course.name})),plusVia:n.props.plusVia,plusViaTerm:n.props.plusViaTerm}),r.default.createElement("aside",{className:"pro-confirm-aside"},"「お申し込みを確定する」をクリックすることで、下記の注意事項に同意をしたものとみなされます。"),n.props.course.isCampaign&&r.default.createElement("div",{className:"admin-notice"},r.default.createElement("h3",null,"キャンペーン規約"),r.default.createElement("ul",null,r.default.createElement("li",null,"キャンペーン適用中は永年割引価格でご利用いただけます。キャンペーンは1アカウントにつき1度のみ適用されます。"),r.default.createElement("li",null,"キャンペーン適用中にプランの解約または他プランへの変更が行われた場合、本キャンペーンは無効になります。"),r.default.createElement("li",null,"消費税率の変更や本体価格の変更などにより、本キャンペーンの継続利用価格も変更する場合があります。キャンペーン価格を変更する場合には、変更日の30日前までに通知します。ただし、やむを得ない場合については、この限りではありません。"))),r.default.createElement("div",{className:"admin-notice"},r.default.createElement("h3",null,"お申込み前の注意事項"),r.default.createElement("ul",null,r.default.createElement("li",null,"ご利用は、コースごとに定まった利用期間の一括払いとなります。期間中に解約手続きを行わない限り、利用期間満了時に利用中のコースが自動更新されます。"),r.default.createElement("li",null,"ご利用開始時および自動更新時に、各コースの料金のお支払いが発生します。引き落とし時点でご登録のクレジットカードが無効となっている場合、7日間の支払い猶予期間を経て、",n.props.tier,"の機能は利用停止（解約扱い）となります。"),r.default.createElement("li",null,"解約は「",n.props.tier,"」ページの「",n.props.tier,"を解約」のリンクから手続きでき、次の自動更新予定時に解約が完了します。解約手続き後も、解約完了（利用期間満了）までは、",n.props.tier,"の機能をご利用いただけます。"),r.default.createElement("li",null,"利用期間中の途中解約・返金は、原則として対応しておりません。例外的に、解約手続き漏れなどの意図しない自動更新が発生した場合、一定の条件のもと返金を受け付けています。詳しくは",r.default.createElement("a",{href:o.helpUrl("/entry/refund-policy"),target:"_blank",rel:"noopener"},"返金ポリシー"),"をご確認ください。"),r.default.createElement("li",null,r.default.createElement("a",{href:o.helpUrl("/entry/guideline"),target:"_blank",rel:"noopener"},"はてなブログのガイドライン"),"および",r.default.createElement("a",{href:"https://policies.hatena.ne.jp/rule",target:"_blank",rel:"noopener"},"はてな利用規約"),"で禁止事項と定める行為が行われた場合、ブログの公開停止や、アカウントの利用停止といった措置を講じることがあります。なお、利用期間中に利用停止措置や退会等があった場合でも、理由の如何を問わず料金やポイントの返還はいたしません。"))))})),n.state={confirmed:!1},n}return n=e,(t=u).prototype=Object.create(n.prototype),t.prototype.constructor=t,d(t,n),u.prototype.render=function(){return this.state.confirmed?this.renderStartProForm():this.renderConfirmForm()},u}(r.default.Component);t.default=p},76809:function(e,t,n){t.__esModule=!0,t.ExpiresOnDateRow=t.FirstPaymentDateRow=void 0;var r,i=(r=n(67294))&&r.__esModule?r:{default:r};t.FirstPaymentDateRow=function(e){return e.shouldShowFirstPaymentOn?i.default.createElement("tr",{className:"pro-first-payment-date-row"},i.default.createElement("th",null,"初回カード決済予定日"),i.default.createElement("td",null,e.firstPaymentOn)):null};t.ExpiresOnDateRow=function(e){return i.default.createElement("tr",{className:"pro-expires-on-date-row"},i.default.createElement("th",null,"次回お支払い予定日（自動更新）"),i.default.createElement("td",null,e.expiresOn))}},9560:function(e,t,n){t.__esModule=!0,t.default=void 0,n(60285),n(41539),n(78783),n(66992),n(33948),n(92222),n(69600);var r=s(n(67294)),i=s(n(57942)),o=s(n(849)),a=n(76809);function s(e){return e&&e.__esModule?e:{default:e}}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=function(e){var t,n;function s(t){var n;return c(u(n=e.call(this,t)||this),"onSubmit",(function(){n.setState({submitting:!0})})),c(u(n),"buildRegisteredCardURL",(function(){var e=new URL(n.props.registerCardUrlBase);return e.searchParams.append("redirect_uri",n.props.redirectUrl),e.href})),c(u(n),"renderMigrateViaInput",(function(){var e=n.props.migrateVia;return e?r.default.createElement("input",{type:"hidden",name:"migrate_via",value:e}):null})),c(u(n),"renderPlusViaInput",(function(){var e=n.props.plusVia;return e?r.default.createElement("input",{type:"hidden",name:"plus_via",value:e}):null})),c(u(n),"renderPlusViaTermInput",(function(){var e=n.props.plusViaTerm;return e?r.default.createElement("input",{type:"hidden",name:"plus_via_term",value:e}):null})),n.state={submitting:!1},n}return n=e,(t=s).prototype=Object.create(n.prototype),t.prototype.constructor=t,l(t,n),s.prototype.render=function(){var e=(0,i.default)("rkm"),t=(0,i.default)("rkc"),n=["btn","btn-primary"],s=this.state.submitting?n.concat("disabled"):n,u=this.buildRegisteredCardURL(),l=this.props.courseStructureVersion;return r.default.createElement("form",{action:this.props.actionPath,method:"POST",id:this.props.formId,onSubmit:this.onSubmit},r.default.createElement("table",{className:"table"},r.default.createElement("tbody",null,r.default.createElement("tr",null,r.default.createElement("th",null,"クレジットカード番号"),r.default.createElement("td",null,r.default.createElement("span",null,"****-****-****-",this.props.registeredCard.lastCardNumbers),r.default.createElement("a",{href:u,className:"btn btn-link pro-link-change-card"},"変更する"))),r.default.createElement("tr",null,r.default.createElement("th",null,"お申し込みのコース"),r.default.createElement("td",null,this.props.courseInput,this.props.course.isCampaign&&r.default.createElement("div",null,"「提供開始記念 永年割引キャンペーン」適用"))),r.default.createElement("tr",null,r.default.createElement("th",null,"お支払い金額"),r.default.createElement("td",null,r.default.createElement("span",{className:"text-bigger text-bold"},(0,o.default)(this.props.course.price),"円 "),"(税込)")),r.default.createElement(a.FirstPaymentDateRow,{shouldShowFirstPaymentOn:this.props.shouldShowFirstPaymentOn,firstPaymentOn:this.props.firstPaymentOn}),r.default.createElement(a.ExpiresOnDateRow,{expiresOn:this.props.expiresOn}))),r.default.createElement("input",{type:"hidden",name:"rkm",value:e}),r.default.createElement("input",{type:"hidden",name:"rkc",value:t}),l&&r.default.createElement("input",{type:"hidden",name:"course_structure_version",value:l}),this.renderMigrateViaInput(),this.renderPlusViaInput(),this.renderPlusViaTermInput(),r.default.createElement("input",{type:"submit",className:s.join(" "),value:"お申し込みを確定する",disabled:this.state.submitting}))},s}(r.default.PureComponent);t.default=d},71617:function(e,t,n){n(4129),n(38880),t.__esModule=!0,t.default=void 0,n(60285),n(41539),n(78783),n(66992),n(33948);var r=u(n(67294)),i=u(n(47535)),o=u(n(9560)),a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(55992));function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}function u(e){return e&&e.__esModule?e:{default:e}}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var f=function(e){var t,n;function s(t){var n;return d(l(n=e.call(this,t)||this),"buildRegisterCardURL",(function(){var e=new URL(n.props.registerCardUrlBase);return e.searchParams.append("redirect_uri",n.props.redirectUrl),e.href})),d(l(n),"renderRegisterCardLink",(function(){var e=n.buildRegisterCardURL();return r.default.createElement("a",{href:e,className:"btn btn-primary",role:"button","data-js-register-card-link":!0},"クレジットカードを登録する")})),d(l(n),"renderConfirm",(function(){if(!n.props.registeredCard)return null;var e=n.props.registeredCard,t=n.props.migrateVia;return r.default.createElement(o.default,{actionPath:"/-/pro/migrate",formId:"pro-form-will-migrate",course:n.state.course,expiresOn:n.props.expiresOn,shouldShowFirstPaymentOn:!1,registerCardUrlBase:n.props.registerCardUrlBase,redirectUrl:n.props.redirectUrl,registeredCard:e,migrateVia:t,courseInput:r.default.createElement(i.default,{inputName:"course_name",currentCourse:n.state.course,availableCourses:n.props.availableCourses,onCourseChange:function(e){return n.setState({course:e})}})})})),n.state={course:t.initialCourse},n}return n=e,(t=s).prototype=Object.create(n.prototype),t.prototype.constructor=t,c(t,n),s.prototype.render=function(){return r.default.createElement("div",null,r.default.createElement("h1",null,"お支払い方法を変更する"),r.default.createElement("p",null,"はてなブログProのお支払い方法を「はてなポイント」から「クレジットカード」に変更します。"),this.props.registeredCard?this.renderConfirm():null,r.default.createElement("div",{className:"admin-notice"},r.default.createElement("h3",null,"変更前に必ずご確認ください"),r.default.createElement("ul",null,r.default.createElement("li",null,r.default.createElement("strong",null,"お支払い方法を変更すると、はてなポイントでの支払いに戻すことができません。"),"はてなポイントでの支払いに変更したい場合は、クレジットカードでの直接決済でお支払いいただいているはてなブログProを解約いただき、 有効期限が切れた後に、あらためてはてなポイント支払いにてお申し込みいただく必要があります。"),r.default.createElement("li",null,"「クレジットカード支払い」に変更しても、はてなポイントの自動リチャージ設定は無効になりません。 自動リチャージ設定がご不要でしたら、",r.default.createElement("a",{href:"https://www.hatena.ne.jp/my/point/creditcard"},"設定画面"),"から「自動リチャージ設定を取り消す」ボタンを押して設定を解除してください。")),r.default.createElement("h3",null,"その他ご注意いただきたいこと"),r.default.createElement("ul",null,r.default.createElement("li",null,"現在ご利用中のコースの有効期限は支払い方法変更後も引き継がれます。コース更新日に初回のクレジットカード決済が発生します。"),r.default.createElement("li",null,"引き落とし時点でご登録のクレジットカードが無効となっている場合、7日間の支払い猶予期間を経て、はてなブログProの機能は利用停止（解約扱い）となります。"),r.default.createElement("li",null,"はてなブログProのご利用は、コースごとに定まった利用期間の一括払いとなります。期間中に解約手続きを行わない限り、利用期間満了時に利用中のコースが自動更新されます。"),r.default.createElement("li",null,"解約は「はてなブログPro」ページの「はてなブログProを解約」のリンクから手続きでき、次の自動更新予定時に解約が完了します。 解約手続き後も、解約完了（利用期間満了）までは、はてなブログProの機能をご利用いただけます。利用期間内の途中解約・返金には対応しておりません。"),r.default.createElement("li",null,"利用期間中の途中解約・返金は、原則として対応しておりません。例外的に、解約手続き漏れなどの意図しない自動更新が発生した場合、一定の条件のもと返金を受け付けています。詳しくは",r.default.createElement("a",{href:a.helpUrl("/entry/refund-policy"),target:"_blank",rel:"noopener"},"返金ポリシー"),"をご確認ください。"),r.default.createElement("li",null,r.default.createElement("a",{href:a.helpUrl("/entry/guideline"),target:"_blank",rel:"noopener"},"はてなブログのガイドライン"),"および",r.default.createElement("a",{href:"https://policies.hatena.ne.jp/rule",target:"_blank",rel:"noopener"},"はてな利用規約"),"で禁止事項と定める行為が行われた場合、ブログの公開停止や、アカウントの利用停止といった措置を講じることがあります。 なお、利用期間中に利用停止措置や退会等があった場合でも、理由の如何を問わず料金やポイントの返還はいたしません。"))),this.props.registeredCard?null:this.renderRegisterCardLink())},s}(r.default.PureComponent);t.default=f},30044:function(e,t,n){t.__esModule=!0,t.default=void 0,n(60285),n(41539),n(78783),n(66992),n(33948),n(68309),n(92222),n(69600);var r=u(n(67294)),i=n(55992),o=u(n(20996)),a=u(n(57942)),s=n(76809);function u(e){return e&&e.__esModule?e:{default:e}}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var f=function(e){var t,n;function u(t){var n;return d(l(n=e.call(this,t)||this),"buildRegisterCardURL",(function(){var e=new URL(n.props.registerCardUrlBase);return e.searchParams.append("redirect_uri",n.props.redirectUrl),e.href})),d(l(n),"renderCardInfo",(function(){var e=n.buildRegisterCardURL();return n.props.registeredCard?r.default.createElement("div",null,r.default.createElement("span",null,"クレジットカード"),r.default.createElement("div",null,r.default.createElement("span",null,"****-****-****-",n.props.registeredCard.lastCardNumbers),r.default.createElement("a",{href:e,className:"btn btn-link pro-link-change-card"},"変更する"))):r.default.createElement("a",{href:e,className:"btn btn-primary",role:"button","data-js-register-card-link":!0},"クレジットカードを登録する")})),d(l(n),"renderRequestButton",(function(){var e=(0,a.default)("rkm"),t=(0,a.default)("rkc"),i=n.props.courseStructureVersion,o=n.props.destinationCourse.name,s=["btn","btn-primary"],u=n.state.submitting?s.concat("disabled"):s;return r.default.createElement("form",{action:"/-/pro/migrate/pay",method:"POST",onSubmit:n.onSubmit},r.default.createElement("input",{type:"hidden",name:"rkm",value:e}),r.default.createElement("input",{type:"hidden",name:"rkc",value:t}),r.default.createElement("input",{type:"hidden",name:"course_name",value:o}),i&&r.default.createElement("input",{type:"hidden",name:"course_structure_version",value:i}),n.renderMigrateViaInput(),r.default.createElement("div",{className:"planMigration-submit"},r.default.createElement("input",{type:"submit",className:u.join(" "),value:"お申し込みを確定する",disabled:n.state.submitting}),r.default.createElement("p",null,"「お申し込みを確定する」をクリックすることで、上記の「変更前に必ずご確認ください」に同意をしたものとみなされます。")))})),d(l(n),"onSubmit",(function(){n.setState({submitting:!0})})),d(l(n),"renderMigrateViaInput",(function(){var e=n.props.migrateVia;return e?r.default.createElement("input",{type:"hidden",name:"migrate_via",value:e}):null})),n.state={submitting:!1},n}return n=e,(t=u).prototype=Object.create(n.prototype),t.prototype.constructor=t,c(t,n),u.prototype.render=function(){return r.default.createElement("div",null,r.default.createElement("div",{className:"planMigration-summary"},r.default.createElement("div",null,r.default.createElement("div",{className:"summary-title"},"変更前"),r.default.createElement("div",{className:"summary-courseName"},this.props.currentCourse.label),r.default.createElement("ul",{className:"summary-courseMeta"},r.default.createElement("li",null,"¥",o.default.formatNumber(this.props.currentCourse.price)),r.default.createElement("li",null,"有効期限: ",this.props.expiresOn," (残り",this.props.daysUntilExpiration,"日)"))),r.default.createElement("div",null,r.default.createElement("div",{className:"summary-title"},"変更後"),r.default.createElement("div",{className:"summary-courseName"},this.props.destinationCourse.label),r.default.createElement("ul",{className:"summary-courseMeta"},r.default.createElement("li",null,"¥",o.default.formatNumber(this.props.destinationCourse.price)),r.default.createElement("li",null,"有効期限: ",this.props.newExpiresOn," (",this.props.destinationCourse.durationDays,"日間 +"," ",this.props.daysToExtend,"日繰り越し)")))),r.default.createElement("div",{className:"planMigration-extendDays-breakdown"},r.default.createElement("div",{className:"extendDays-breakdown-heading"},r.default.createElement("h4",null,"繰り越し日数の内訳"),r.default.createElement("p",null,"変更前コースの未使用分は、以下の計算に従って変更後コースに繰り越されます。")),r.default.createElement("table",{className:"extendDays-breakdown-table"},r.default.createElement("tbody",null,r.default.createElement("tr",null,r.default.createElement("th",null,"変更前コース未使用分の価格",r.default.createElement("div",{className:"table-value-notice"},"1日あたり ",this.props.currentCourse.pricePerDay,"円 x 残日数 ",this.props.daysUntilExpiration,"日")),r.default.createElement("td",null,this.props.unusedAmount,"円")),r.default.createElement("tr",null,r.default.createElement("th",null,"変更後コースの1日分の価格"),r.default.createElement("td",null,this.props.destinationCourse.pricePerDay,"円")),r.default.createElement("tr",null,r.default.createElement("th",null,r.default.createElement("strong",null,"変更後コースの繰り越し日数"),r.default.createElement("div",{className:"table-value-notice"},this.props.unusedAmount," / ",this.props.destinationCourse.pricePerDay)),r.default.createElement("td",null,r.default.createElement("strong",{className:"bigger"},this.props.daysToExtend),"日",r.default.createElement("div",{className:"table-value-notice"},"※ 小数点繰り上げ")))))),r.default.createElement("h3",null,"お支払い方法"),this.renderCardInfo(),r.default.createElement("h3",null,"お支払い金額"),r.default.createElement("div",{className:"planMigration-amount"},r.default.createElement("span",{className:"amount-value"},o.default.formatNumber(this.props.destinationCourse.price)),"円 (税込)",r.default.createElement("p",null,"お申し込みを確定した時点で、料金のお支払いが発生します。"),r.default.createElement("table",{className:"planMigration-amount-detail"},r.default.createElement(s.ExpiresOnDateRow,{expiresOn:this.props.newExpiresOn}))),r.default.createElement("div",{className:"planMigration-notice"},r.default.createElement("div",{className:"planMigration-notice-heading"},r.default.createElement("h4",null,"変更前に必ずご確認ください")),r.default.createElement("ul",null,r.default.createElement("li",null,"お支払いは、コースごとに定まった利用期間の一括払いとなります。期間中に解約手続きを行わない限り、利用期間満了時に利用中のコースが自動更新されます。"),r.default.createElement("li",null,"ご利用開始時および自動更新時に、各コースの料金のお支払いが発生します。引き落とし時点でご登録のクレジットカードが無効となっている場合、7日間の支払い猶予期間を経て、プランの機能は利用停止（解約扱い）となります。"),r.default.createElement("li",null,"解約手続きを行うと、次の自動更新予定時に解約が完了します。解約手続き後も、解約完了（利用期間満了）までは、プランの機能をご利用いただけます。利用期間内の途中解約・返金には対応しておりません。"),r.default.createElement("li",null,"解約は「法人情報の確認」ページの「解約」のリンクから手続きでき、次の自動更新予定時に解約が完了します。解約手続き後も、解約完了（利用期間満了）までは、ご契約中のコースの機能をご利用いただけます。利用期間内の途中解約・返金には対応しておりません。"),r.default.createElement("li",null,r.default.createElement("a",{href:(0,i.helpUrl)("/entry/guideline"),target:"_blank",rel:"noopener"},"はてなブログのガイドライン"),"および",r.default.createElement("a",{href:"https://policies.hatena.ne.jp/rule",target:"_blank",rel:"noopener"},"はてな利用規約"),"で禁止事項と定める行為が行われた場合、ブログの公開停止や、アカウントの利用停止といった措置を講じることがあります。なお、利用期間中に利用停止措置や退会等があった場合でも、理由の如何を問わず料金やポイントの返還はいたしません。"))),this.props.registeredCard?this.renderRequestButton():null)},u}(r.default.PureComponent);t.default=f},74213:function(e,t,n){var r;t.__esModule=!0,t.changeSearchQuery=t.editProfileCard=t.cancelEdit=t.duplicateProfileCard=t.modifyProfileCardAdvancedSettings=t.modifyProfileCard=t.createProfileCard=t.deleteCard=t.saveCard=t.loadProfileCards=void 0;var i=(0,((r=n(99308))&&r.__esModule?r:{default:r}).default)("ProfileCardManager"),o=i.async("FETCH_CARDS");t.loadProfileCards=o;var a=i.async("SAVE_CARD");t.saveCard=a;var s=i.async("DELETE_CARD");t.deleteCard=s;var u=i("CREATE_CARD");t.createProfileCard=u;var l=i("MODIFY_CARD");t.modifyProfileCard=l;var c=i("ADVANCED_MODIFY_CARD");t.modifyProfileCardAdvancedSettings=c;var d=i("DUPLICATE_CARD");t.duplicateProfileCard=d;var f=i("CANCEL_EDIT");t.cancelEdit=f;var p=i("EDIT_CARD");t.editProfileCard=p;var h=i("CHANGE_SEARCH_QUERY");t.changeSearchQuery=h},92349:function(e,t,n){n(4129),n(78783),n(38880),t.__esModule=!0,t.postDeleteCard=t.postEditedCard=t.postNewCard=t.fetchProfileCards=t.getFetchProfileCardsOption=void 0,n(35666),n(41539),n(66992),n(33948),n(88674),n(19601);var r,i=(r=n(57942))&&r.__esModule?r:{default:r},o=u(n(55992)),a=u(n(347));function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}function u(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}function l(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}var c=function(){return{url:o.httpsAdminUserBlogUrl("/profile_cards.json")}};t.getFetchProfileCardsOption=c;var d=function(){var e,t=(e=regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,a.default)(c());case 2:return t=e.sent,e.abrupt("return",t.data.entries);case 4:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){l(o,r,i,a,s,"next",e)}function s(e){l(o,r,i,a,s,"throw",e)}a(void 0)}))});return function(){return t.apply(this,arguments)}}();t.fetchProfileCards=d;var f=function(e,t){var n=(0,i.default)("rkm"),r=(0,i.default)("rkc");return n&&r?a.default.post(o.httpsAdminUserBlogUrl(e),Object.assign({},t,{rkm:n,rkc:r}),{transformRequest:a.traditionalDataRequest}):Promise.reject("Failed to retrieve credentials")};t.postNewCard=function(e){var t=e.title,n=e.body,r=e.author,i=e.author_urls;return f("/add_profile_card.json",{body:n,title:t,author:r,author_urls:i})};t.postEditedCard=function(e){var t=e.title,n=e.body,r=e.author,i=e.author_urls;return f("/profile_card/"+e.uuid+"/edit.json",{body:n,title:t,author:r,author_urls:i})};t.postDeleteCard=function(e){return f("/profile_card/"+e.uuid+"/delete.json",{})}},32240:function(e,t,n){t.__esModule=!0,t.AddProfileCardButton=void 0;var r,i=(r=n(67294))&&r.__esModule?r:{default:r};t.AddProfileCardButton=function(e){var t=e.onClick;return i.default.createElement("button",{type:"submit",className:"btn test-add-profile-card-button",onClick:t},"プロフィールカードを追加する")}},27825:function(e,t,n){t.__esModule=!0,t.ProfileCardEditorFormInputTableRow=void 0;var r,i=(r=n(67294))&&r.__esModule?r:{default:r};t.ProfileCardEditorFormInputTableRow=function(e){var t=e.tableHeader,n=e.value,r=e.placeholder,o=e.onChange,a=e.children;return i.default.createElement("tr",null,i.default.createElement("th",null,t),i.default.createElement("td",null,i.default.createElement("input",{placeholder:r,type:"text",value:n,onChange:o,className:"full-width"}),a))}},72003:function(e,t,n){t.__esModule=!0,t.ProfileCardEditorFormOuter=void 0;var r,i=(r=n(67294))&&r.__esModule?r:{default:r};t.ProfileCardEditorFormOuter=function(e){var t=e.children,n=e.submitDisabled,r=e.onClickCloseButton,o=e.onSubmit,a=e.isEditingNewCard,s=e.modalState;return i.default.createElement("div",{className:"profile_cards-modal"},i.default.createElement("div",{className:"profile_cards-modal-inner"},i.default.createElement("form",{onSubmit:o},i.default.createElement("div",{className:"profile_cards-modal-header"},i.default.createElement("h2",null,"edit"===s&&(a?"新しくプロフィールを追加する":"プロフィールカードを編集する"),"advanced"===s&&"高度な設定"),i.default.createElement("span",null,i.default.createElement("a",{href:"",onClick:r,className:"rule-editor-panel-close-btn"},i.default.createElement("i",{className:"blogicon-close"})))),i.default.createElement("div",{className:"profile_cards-modal-body"},t),i.default.createElement("div",{className:"profile_cards-modal-footer"},i.default.createElement("button",{type:"submit",className:"btn btn-primary",onClick:o,disabled:n},"保存")))))}},31011:function(e,t,n){t.__esModule=!0,t.ProfileCardEditorFormTextAreaTableRaw=void 0;var r,i=(r=n(67294))&&r.__esModule?r:{default:r};t.ProfileCardEditorFormTextAreaTableRaw=function(e){var t=e.tableHeader,n=e.value,r=e.placeholder,o=e.onChange,a=e.children;return i.default.createElement("tr",null,i.default.createElement("th",null,t),i.default.createElement("td",null,i.default.createElement("textarea",{placeholder:r,value:n,onChange:o,className:"full-width profile_cards-body-text-area"}),a))}},2448:function(e,t,n){t.__esModule=!0,t.SearchProfileCardsFormComponent=void 0;var r=o(n(67294)),i=o(n(20996));function o(e){return e&&e.__esModule?e:{default:e}}t.SearchProfileCardsFormComponent=function(e){var t=e.onKeyPress,n=e.onChange,o=e.value,a=e.onClick;return r.default.createElement("div",{className:"profile-card-search"},r.default.createElement("div",{className:"profile-card-search-form"},r.default.createElement("input",{type:"text",onKeyPress:t,onChange:n,value:o,placeholder:i.default.text("admin.profile_card.search")}),r.default.createElement("button",{type:"button",onClick:a,className:"btn profile-card-search-btn"},i.default.text("admin.profile_card.search.button"))))}},18150:function(e,t,n){t.__esModule=!0,t.ProfileCardsManagerComponent=void 0;var r=a(n(67294)),i=n(32240),o=a(n(83253));function a(e){return e&&e.__esModule?e:{default:e}}t.ProfileCardsManagerComponent=function(e){var t=e.modalState,n=e.SearchProfileCardsForm,a=e.ProfileCardEditorForm,s=e.ProfileCardAdvancedSettingsForm,u=e.shouldShowTopButton,l=e.ProfileCardsListTable,c=e.onClickAddProfileCardButton,d=e.onRequestClose;return r.default.createElement("div",null,r.default.createElement("div",{className:"main-header"},r.default.createElement("h1",null,"プロフィールカード")),r.default.createElement(n,null),r.default.createElement("div",{className:"main-box"},u&&r.default.createElement(i.AddProfileCardButton,{onClick:c}),r.default.createElement(o.default,{className:"profile-cards-editor-modal",overlayClassName:"profile-cards-editor-modal-overlay",portalClassName:"profile-cards-editor-modal-portal",isOpen:"closed"!==t,shouldCloseOnOverlayClick:!0,onRequestClose:d},"edit"===t&&r.default.createElement(a,null),"advanced"===t&&r.default.createElement(s,null)),r.default.createElement(l,null),r.default.createElement(i.AddProfileCardButton,{onClick:c})))}},32905:function(e,t,n){t.__esModule=!0,t.ProfileCardRow=void 0;var r=a(n(67294)),i=n(83521),o=a(n(30381));function a(e){return e&&e.__esModule?e:{default:e}}t.ProfileCardRow=function(e){var t=e.card,n=e.onClickEditButton,a=e.onClickAdvancedSettingsButton,s=e.onClickDuplicateButton,u=e.onClickDeleteButton;return r.default.createElement("tr",{key:"card-row-"+t.uuid},r.default.createElement("td",{className:"profile-table-card-name"},t.title),r.default.createElement("td",{className:"profile-table-card-author"},t.author),r.default.createElement("td",{className:"profile-table-card-description"},t.body_preview),r.default.createElement("td",{className:"profile-table-card-modified"},function(e){return e.modified?(0,o.default)(e.modified).format("YYYY/MM/DD HH:mm:ss"):null}(t)),r.default.createElement("td",{className:"td-admin-button profile-table-btn"},r.default.createElement(i.Dropdown,{items:[{label:"編集",icon:"blogicon-edit",className:"test-blogicon-edit",onClick:function(){return n(t)}},{label:"高度な設定",icon:"blogicon-cog",className:"test-blogicon-cog",onClick:function(){return a(t)}},{label:"コピーを作成",icon:"blogicon-entry",className:"test-blogicon-entry",onClick:function(){return s(t)}},{label:"削除",icon:"blogicon-close",className:"test-blogicon-close",onClick:function(){return u(t)}}]})))}},74953:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.ProfileCardsListTableComponent=void 0,n(21249);var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=o(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(67294)),i=n(32905);function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(o=function(e){return e?n:t})(e)}t.ProfileCardsListTableComponent=function(e){var t=e.profileCards,n=e.onClickEditButton,o=e.onClickAdvancedSettingsButton,a=e.onClickDuplicateButton,s=e.onClickDeleteButton;return r.createElement("table",{className:"table profile-cards-list"},r.createElement("thead",null,r.createElement("tr",null,r.createElement("th",{className:"profile-table-card-name"},"プロフィールカード名"),r.createElement("th",{className:"profile-table-card-author"},"著者名"),r.createElement("th",{className:"profile-table-card-description"},"本文"),r.createElement("th",{className:"profile-table-card-modified"},"更新日"),r.createElement("th",{className:"profile-table-btn"}))),r.createElement("tbody",null,t.map((function(e){return r.createElement(i.ProfileCardRow,{key:e.uuid,card:e,onClickEditButton:n,onClickAdvancedSettingsButton:o,onClickDuplicateButton:a,onClickDeleteButton:s})}))))}},58733:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.ProfileCardAdvancedSettingsForm=void 0;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=f(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),i=n(72003),o=n(13410),a=n(27825),s=n(31011),u=n(57295),l=n(81305),c=n(33095),d=n(62803);function f(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(f=function(e){return e?n:t})(e)}t.ProfileCardAdvancedSettingsForm=function(){var e=(0,o.useProfileCardEditorForm)(),t=e.title,n=e.author,f=e.setAuthor,p=e.authorURLsText,h=e.setAuthorURLsText,m=e.cancelEdit,v=(0,r.useContext)(d.MaxAuthorURLsCountContext).maxAuthorURLsCount,g=(0,l.useSaveProfileCard)(v).save,b=(0,u.useCanSave)(v),y=(0,c.useSelector)((function(e){return e.modal.modalState}));return r.default.createElement(i.ProfileCardEditorFormOuter,{onSubmit:g,isEditingNewCard:!1,onClickCloseButton:m,submitDisabled:!b,modalState:y},r.default.createElement("table",{className:"admin-table"},r.default.createElement("tbody",null,r.default.createElement("tr",null,r.default.createElement("th",null,"カード名"),r.default.createElement("td",null,t)),r.default.createElement(a.ProfileCardEditorFormInputTableRow,{tableHeader:"著者名",placeholder:"author",value:n,onChange:function(e){return f(e.target.value)}},r.default.createElement("p",null,"プロフィールカードを設定する記事の著者名を入力してください。",r.default.createElement("br",null),"構造化データや記事下のAuthor情報で使用されます。")),r.default.createElement(s.ProfileCardEditorFormTextAreaTableRaw,{tableHeader:"URL",placeholder:"",value:p,onChange:function(e){return h(e.target.value)}},r.default.createElement("p",null,"著者のプロフィールページのURLを入力してください。改行区切りで複数入力可能です")))))}},90482:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.ProfileCardEditorForm=void 0;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=f(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),i=n(72003),o=n(13410),a=n(27825),s=n(31011),u=n(57295),l=n(81305),c=n(33095),d=n(62803);function f(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(f=function(e){return e?n:t})(e)}t.ProfileCardEditorForm=function(){var e=(0,o.useProfileCardEditorForm)(),t=e.title,n=e.setTitle,f=e.body,p=e.setBody,h=e.isEditingNewCard,m=e.cancelEdit,v=(0,r.useContext)(d.MaxAuthorURLsCountContext).maxAuthorURLsCount,g=(0,l.useSaveProfileCard)(v).save,b=(0,u.useCanSave)(v),y=(0,c.useSelector)((function(e){return e.modal.modalState}));return r.default.createElement(i.ProfileCardEditorFormOuter,{onSubmit:g,isEditingNewCard:h,onClickCloseButton:m,submitDisabled:!b,modalState:y},r.default.createElement("table",{className:"admin-table"},r.default.createElement("tbody",null,r.default.createElement(a.ProfileCardEditorFormInputTableRow,{tableHeader:"カード名",placeholder:"title",value:t,onChange:function(e){return n(e.target.value)}},r.default.createElement("p",null,"このカードの名称を入力してください。",r.default.createElement("br",null),"主に記事の編集サイドバーやプロフィールカード管理画面などで使用されます。")),r.default.createElement(s.ProfileCardEditorFormTextAreaTableRaw,{tableHeader:"カード本文",placeholder:"body",value:f,onChange:function(e){return p(e.target.value)}},r.default.createElement("p",null,"プロフィールカードとして記事の文末に表示する内容を記述してください。",r.default.createElement("br",null),"※HTMLタグが使用できます。")))))}},9751:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.ProfileCardsListTable=void 0,n(57327);var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=u(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),i=n(74953),o=n(33095),a=n(80060),s=n(74213);function u(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(u=function(e){return e?n:t})(e)}t.ProfileCardsListTable=function(){var e=(0,o.useSelector)((function(e){return e.cards.cards})),t=(0,o.useSelector)((function(e){return e.cards.searchQuery})),n=(0,r.useMemo)((function(){return""===t?e:e.filter((function(e){return-1!==e.title.indexOf(t)||-1!==e.body.indexOf(t)}))}),[e,t]),u=(0,a.useDeleteProfileCard)().confirmDeleteCard,l=(0,o.useDispatch)();return r.default.createElement(i.ProfileCardsListTableComponent,{profileCards:n,onClickEditButton:function(e){l((0,s.modifyProfileCard)({card:e}))},onClickAdvancedSettingsButton:function(e){l((0,s.modifyProfileCardAdvancedSettings)({card:e}))},onClickDuplicateButton:function(e){l((0,s.duplicateProfileCard)({card:e}))},onClickDeleteButton:function(e){u(e)}})}},71900:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.ProfileCardsManager=void 0;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=d(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),i=n(34963),o=n(33095),a=n(14890),s=n(65400),u=n(71822),l=n(62803),c=n(56290);function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(d=function(e){return e?n:t})(e)}var f=function(){return(0,c.useProfileCardsManager)(),null};t.ProfileCardsManager=function(e){var t=e.maxAuthorURLsCount,n=(0,r.useState)((function(){return{store:(0,a.createStore)(u.reducer,(0,s.composeEnhancers)()),storeState:u.INITIAL_STATE}}))[0];return r.default.createElement(o.ProfileCardManagerReduxContext.Provider,{value:n},r.default.createElement(l.MaxAuthorURLsCountContext.Provider,{value:{maxAuthorURLsCount:t}},r.default.createElement(f,null),r.default.createElement(i.ProfileCardsManagerConsumer,null)))}},34963:function(e,t,n){t.__esModule=!0,t.ProfileCardsManagerConsumer=void 0;var r,i=(r=n(67294))&&r.__esModule?r:{default:r},o=n(67124),a=n(9751),s=n(90482),u=n(58733),l=n(18150),c=n(33095),d=n(74213);t.ProfileCardsManagerConsumer=function(){var e=(0,c.useSelector)((function(e){return e.cards.cards.length>0})),t=(0,c.useSelector)((function(e){return e.modal.modalState})),n=(0,c.useDispatch)();return i.default.createElement(l.ProfileCardsManagerComponent,{modalState:t,SearchProfileCardsForm:o.SearchProfileCardsForm,ProfileCardsListTable:a.ProfileCardsListTable,ProfileCardEditorForm:s.ProfileCardEditorForm,ProfileCardAdvancedSettingsForm:u.ProfileCardAdvancedSettingsForm,onClickAddProfileCardButton:function(){n((0,d.createProfileCard)())},onRequestClose:function(){n((0,d.cancelEdit)())},shouldShowTopButton:e})}},67124:function(e,t,n){t.__esModule=!0,t.SearchProfileCardsForm=void 0;var r,i=(r=n(67294))&&r.__esModule?r:{default:r},o=n(2448),a=n(80465);t.SearchProfileCardsForm=function(){var e=(0,a.useSearchProfileCardsForm)(),t=e.localSearchQuery,n=e.onChange,r=e.onKeyPress,s=e.onClick;return i.default.createElement(o.SearchProfileCardsFormComponent,{onKeyPress:r,onChange:n,onClick:s,value:t})}},62803:function(e,t,n){t.__esModule=!0,t.MaxAuthorURLsCountContext=t.maxAuthorURLsCountContextDefault=void 0;var r=n(67294),i={maxAuthorURLsCount:0};t.maxAuthorURLsCountContextDefault=i;var o=(0,r.createContext)(i);t.MaxAuthorURLsCountContext=o},33095:function(e,t,n){t.__esModule=!0,t.useSelector=t.useDispatch=t.ProfileCardManagerReduxContext=t.profileCardManagerStore=void 0;var r=n(14890),i=n(67294),o=n(74308),a=n(71822),s=(0,r.createStore)(a.reducer);t.profileCardManagerStore=s;var u=(0,i.createContext)({store:s,storeState:a.INITIAL_STATE});t.ProfileCardManagerReduxContext=u;var l=(0,o.createDispatchHook)(u);t.useDispatch=l;var c=(0,o.createSelectorHook)(u);t.useSelector=c},57295:function(e,t,n){t.__esModule=!0,t.useCanSave=t.canSaveSelector=void 0,n(24603),n(74916),n(39714),n(69600);var r=n(33095),i=["title","body","author"],o=new RegExp("^https?://"),a=function(e,t){var n=e.cards,r=n.editingCard,a=n.isSavingCard,s=n.targetCard;return!!r&&(!a&&(""!==r.title&&""!==r.body&&(null===s||!(0!==r.author_urls.length&&!r.author)&&(!!function(e,t){return e.length<=t&&e.every((function(e){return o.test(e)}))}(r.author_urls,t)&&(!!i.some((function(e){return r[e]!==s[e]}))||r.author_urls.join("\n")!==s.author_urls.join("\n"))))))};t.canSaveSelector=a;t.useCanSave=function(e){return(0,r.useSelector)((function(t){return a(t,e)}))}},80060:function(e,t,n){n(4129),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.useDeleteProfileCard=void 0,n(88674),n(41539),n(35666);var r=n(67294),i=n(33095),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(74213)),a=n(92349);function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}function u(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){u(o,r,i,a,s,"next",e)}function s(e){u(o,r,i,a,s,"throw",e)}a(void 0)}))}}t.useDeleteProfileCard=function(){var e=(0,i.useDispatch)(),t=(0,i.useSelector)((function(e){return e.cards.isDeletingCard})),n=(0,r.useCallback)(function(){var n=l(regeneratorRuntime.mark((function n(r){var i;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t){n.next=2;break}return n.abrupt("return");case 2:return e(o.deleteCard.started({data:{uuid:r.uuid}})),n.prev=3,n.next=6,(0,a.postDeleteCard)({uuid:r.uuid});case 6:i=n.sent,e(o.deleteCard.done({params:{data:r},result:{data:i.data}})),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(3),e(o.deleteCard.failed({error:{error:n.t0},params:{data:r}}));case 13:case"end":return n.stop()}}),n,null,[[3,10]])})));return function(e){return n.apply(this,arguments)}}(),[e,t]);return{confirmDeleteCard:(0,r.useCallback)(function(){var e=l(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("本当にこのプロフィールカードを削除しますか")){e.next=3;break}return e.next=3,n(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[n])}}},6352:function(e,t,n){t.__esModule=!0,t.useFetchProfileCards=void 0;var r=n(91289),i=n(92349);t.useFetchProfileCards=function(){return(0,r.useXHR)((0,i.getFetchProfileCardsOption)())}},13410:function(e,t,n){t.__esModule=!0,t.useProfileCardEditorForm=void 0,n(69600),n(57327),n(21249),n(23123),n(74916),n(73210);var r=n(67294),i=n(33095),o=n(74213);t.useProfileCardEditorForm=function(){var e=(0,i.useSelector)((function(e){return e.cards.editingCard})),t=(0,i.useSelector)((function(e){return null===e.cards.targetCard})),n=(0,i.useDispatch)(),a=(0,r.useState)((function(){return(null==e?void 0:e.body)||""})),s=a[0],u=a[1],l=(0,r.useState)((function(){return(null==e?void 0:e.title)||""})),c=l[0],d=l[1],f=(0,r.useState)((function(){return(null==e?void 0:e.author)||""})),p=f[0],h=f[1],m=(0,r.useState)((function(){var t=(null==e?void 0:e.author_urls)||[];return[t.join("\n"),t]})),v=m[0],g=v[0],b=v[1],y=m[1],_=(0,r.useCallback)((function(e){var t=e.split("\n").map((function(e){return e.trim()})).filter((function(e){return e}));y([e,t])}),[]),w=(0,r.useCallback)((function(e){e.preventDefault(),n((0,o.cancelEdit)())}),[n]);return(0,r.useEffect)((function(){n((0,o.editProfileCard)({card:{title:c,body:s,author:p,author_urls:b}}))}),[n,c,s,p,g]),{title:c,setTitle:d,body:s,setBody:u,isEditingNewCard:t,cancelEdit:w,author:p,setAuthor:h,authorURLsText:g,setAuthorURLsText:_}}},56290:function(e,t,n){t.__esModule=!0,t.useProfileCardsManager=void 0;var r=n(34665),i=n(6352);t.useProfileCardsManager=function(){var e=(0,i.useFetchProfileCards)()[0],t=e.loading,n=e.error,o=e.data;(0,r.useProfileCardsManagerEffects)({loading:t,error:n,data:o})}},34665:function(e,t,n){t.__esModule=!0,t.useProfileCardsManagerEffects=void 0,n(41539),n(66992),n(33948);var r=n(33095),i=n(67294),o=n(74213);t.useProfileCardsManagerEffects=function(e){var t=e.loading,n=e.data,a=e.error,s=(0,r.useDispatch)();(0,i.useEffect)((function(){if(!t){if(a)return void s(o.loadProfileCards.failed({params:{},error:{error:a}}));if(!n)throw new TypeError("'data' doesn't exist");s(o.loadProfileCards.done({params:{},result:{profileCards:n.entries}}))}}),[t,n,a,s])}},81305:function(e,t,n){n(4129),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.useSaveProfileCard=void 0,n(88674),n(41539),n(35666);var r=n(67294),i=n(33095),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=u(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(74213)),a=n(92349),s=n(57295);function u(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(u=function(e){return e?n:t})(e)}function l(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){l(o,r,i,a,s,"next",e)}function s(e){l(o,r,i,a,s,"throw",e)}a(void 0)}))}}t.useSaveProfileCard=function(e){var t=(0,s.useCanSave)(e),n=(0,i.useSelector)((function(e){return e.cards.targetCard})),u=(0,i.useSelector)((function(e){return e.cards.editingCard})),l=(0,i.useDispatch)(),d=(0,r.useCallback)(function(){var e=c(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(o.saveCard.started({})),e.prev=1,e.next=4,t;case 4:return e.next=6,(0,a.fetchProfileCards)();case 6:n=e.sent,l(o.saveCard.done({params:{},result:{profileCards:n}})),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),l(o.saveCard.failed({error:{error:e.t0},params:{}}));case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}(),[l]);return{save:(0,r.useCallback)(function(){var e=c(regeneratorRuntime.mark((function e(r){var i,o,s,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.preventDefault(),!t){e.next=11;break}if(!u){e.next=11;break}if(i=u.body,o=u.title,s=u.author,l=u.author_urls,!n){e.next=9;break}return e.next=7,d((0,a.postEditedCard)({uuid:n.uuid,body:i,title:o,author:s,author_urls:l}));case 7:e.next=11;break;case 9:return e.next=11,d((0,a.postNewCard)({body:i,title:o,author:s,author_urls:l}));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[t,u,n,d])}}},80465:function(e,t,n){t.__esModule=!0,t.useSearchProfileCardsForm=void 0;var r=n(67294),i=n(33095),o=n(74213),a=n(41960);t.useSearchProfileCardsForm=function(){var e=(0,i.useSelector)((function(e){return e.cards.searchQuery})),t=(0,r.useState)((function(){return e})),n=t[0],s=t[1],u=(0,i.useDispatch)(),l=(0,r.useCallback)((function(e){s(e.target.value)}),[s]),c=(0,r.useCallback)((function(e){"RET"===a(e)&&(e.preventDefault(),u((0,o.changeSearchQuery)({searchQuery:n})))}),[u,n]),d=(0,r.useCallback)((function(){u((0,o.changeSearchQuery)({searchQuery:n}))}),[u,n]);return{localSearchQuery:n,onChange:l,onKeyPress:c,onClick:d}}},66383:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.cardsReducer=t.INITIAL_CARDS_STATE=void 0,n(19601),n(57327);var r=n(76983),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=o(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(74213));function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(o=function(e){return e?n:t})(e)}var a={cards:[],searchQuery:"",isLoadingCard:!0,isSavingCard:!1,isDeletingCard:!1,editingCard:null,targetCard:null,deletingCard:null};t.INITIAL_CARDS_STATE=a;var s={body:"",title:"",author:"",author_urls:[]},u=function(e){return{body:e.body,author:e.author,title:e.title,author_urls:e.author_urls}},l=(0,r.reducerWithInitialState)(a).case(i.loadProfileCards.started,(function(e){return Object.assign({},e,{isLoadingCard:!0})})).case(i.saveCard.started,(function(e){return Object.assign({},e,{isSavingCard:!0})})).case(i.deleteCard.started,(function(e,t){return Object.assign({},e,{isDeletingCard:!0,deletingCard:t.data})})).case(i.loadProfileCards.done,(function(e,t){return Object.assign({},e,{isLoadingCard:!1,cards:t.result.profileCards})})).case(i.saveCard.done,(function(e,t){return Object.assign({},e,{isSavingCard:!1,cards:t.result.profileCards,editingCard:null,targetCard:null})})).case(i.deleteCard.done,(function(e){return Object.assign({},e,{isDeletingCard:!1,cards:e.cards.filter((function(t){var n;return t.uuid!==(null===(n=e.deletingCard)||void 0===n?void 0:n.uuid)})),deletingCard:null})})).case(i.createProfileCard,(function(e){return Object.assign({},e,{targetCard:null,editingCard:s})})).case(i.modifyProfileCard,(function(e,t){return Object.assign({},e,{targetCard:t.card,editingCard:u(t.card)})})).case(i.modifyProfileCardAdvancedSettings,(function(e,t){return Object.assign({},e,{targetCard:t.card,editingCard:u(t.card)})})).case(i.duplicateProfileCard,(function(e,t){return Object.assign({},e,{targetCard:null,editingCard:u(t.card)})})).case(i.editProfileCard,(function(e,t){return Object.assign({},e,{editingCard:t.card})})).case(i.cancelEdit,(function(e){return Object.assign({},a,{isLoadingCard:!1,searchQuery:e.searchQuery,cards:e.cards})})).case(i.changeSearchQuery,(function(e,t){return Object.assign({},e,{searchQuery:t.searchQuery})})).build();t.cardsReducer=l},12810:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.errorReducer=t.INITIAL_ERROR_STATE=void 0,n(19601);var r=n(76983),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=o(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(74213));function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(o=function(e){return e?n:t})(e)}var a={isError:!1,error:void 0};t.INITIAL_ERROR_STATE=a;var s=(0,r.reducerWithInitialState)(a).cases([i.loadProfileCards.failed,i.saveCard.failed,i.deleteCard.failed],(function(e,t){return Object.assign({},e,{isError:!0,error:t.error.error})})).build();t.errorReducer=s},71822:function(e,t,n){t.__esModule=!0,t.INITIAL_STATE=t.reducer=void 0;var r=n(14890),i=n(59703),o=n(12810),a=n(66383),s=(0,r.combineReducers)({modal:i.modalReducer,error:o.errorReducer,cards:a.cardsReducer});t.reducer=s;var u={modal:i.INITIAL_MODAL_STATE,error:o.INITIAL_ERROR_STATE,cards:a.INITIAL_CARDS_STATE};t.INITIAL_STATE=u},59703:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.modalReducer=t.INITIAL_MODAL_STATE=void 0,n(19601);var r=n(76983),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=o(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(74213));function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(o=function(e){return e?n:t})(e)}var a={modalState:"closed",disableEditorModal:!1};t.INITIAL_MODAL_STATE=a;var s=(0,r.reducerWithInitialState)(a).cases([i.createProfileCard,i.modifyProfileCard,i.duplicateProfileCard],(function(e){return Object.assign({},e,{modalState:"edit"})})).cases([i.modifyProfileCardAdvancedSettings],(function(e){return Object.assign({},e,{modalState:"advanced"})})).cases([i.saveCard.started,i.deleteCard.started],(function(e){return Object.assign({},e,{disableEditorModal:!0})})).cases([i.saveCard.done,i.deleteCard.done,i.cancelEdit],(function(){return a})).build();t.modalReducer=s},43614:function(e,t,n){n(68309),n(21249),n(92222),n(69826),n(23123),n(74916);var r,i=(r=n(57942))&&r.__esModule?r:{default:r};var o=n(73609),a=n(13469),s=n(61875),u={init:function(){var e=function(e){if(e.length<2)throw"invalid name";this.name=e};e.prototype={getName:function(){return this.name},getProfileImage:function(){return"https://cdn.profile-image.st-hatena.com/users/"+this.getName()+"/profile.png"},getURL:function(){return"http://profile.hatena.ne.jp/"+this.getName()+"/"},getHatenaID:function(){return"id:"+this.getName()},equals:function(e){return this.name===e.name}},e.loadUserNames=function(t){return a.map(t,(function(t){return new e(t)}))};var t=function(){this.init.apply(this,arguments)};t.prototype={init:function(){this.refusals=[]},load:function(e){this.refusals=e,o(this).trigger("refusalsChanged")},add:function(e){var t=this;if(!t.isRefused(e)){var n=t.refusals.concat(e);this._save(n).done((function(){o(t).trigger("refusalAdded")})).fail((function(){o(t).trigger("refusalSaveFailed")}))}},remove:function(e){var t=this;if(t.isRefused(e)){var n=a.reject(t.refusals,(function(n){return t.isEqual(e,n)}));this._save(n).done((function(){o(t).trigger("refusalRemoved")})).fail((function(){o(t).trigger("refusalSaveFailed")}))}},isEqual:function(e,t){return e===t},isRefused:function(e){var t=this;return a.find(this.refusals,(function(n){return t.isEqual(e,n)}))},getRefusals:function(){return this.refusals},_save_url:"specify this",_getSaveParams:function(e){throw new Error("implement this")},_save:function(e){var t=this,n=o.Deferred();return o.ajax({url:t._save_url,type:"POST",data:a.extend(t._getSaveParams(e),{rkm:(0,i.default)("rkm"),rkc:(0,i.default)("rkc")}),traditional:!0,dataType:"json"}).done((function(){t.refusals=e,o(t).trigger("refusalsChanged"),n.resolve()})).fail((function(){n.reject()})),n}};var n=function(){this.init.apply(this,arguments)};s(n.prototype={getUserNames:function(){return a.map(this.refusals,(function(e){return e.getName()}))},isEqual:function(e,t){return e.equals(t)},_save_url:"/-/refusal/save",_getSaveParams:function(e){return{user_names:a.map(e,(function(e){return e.getName()}))}}},t.prototype);var r=function(){this.init.apply(this,arguments)};s(r.prototype={_save_url:"/-/refusal/save_refused_ips",_getSaveParams:function(e){return{ips:e}}},t.prototype);var u=function(e,t){this.$refusalsContainer=e.find(".js-refusals-container"),this.refusalsTemplate=a.template(e.find(".js-refusals-template").html()),this.$alertAdded=t.find(".js-alert-added"),this.$alertRemoved=t.find(".js-alert-removed"),this.$alertNotFound=t.find(".js-alert-not-found")};u.prototype={onChanged:function(e){this.$refusalsContainer.html(this.refusalsTemplate({refusals:e.getRefusals()}))},onAdded:function(e){this.showAlert(this.$alertAdded)},onRemoved:function(e){this.showAlert(this.$alertRemoved)},onNotFound:function(e){this.showAlert(this.$alertNotFound)},showAlert:function(e){a.each([this.$alertAdded,this.$alertRemoved,this.$alertNotFound],(function(e){e.hide()})),e.show(),setTimeout((function(){e.fadeOut("slow")}),3e3)}};var l=new n,c=new r,d=new u(o(".js-refuse-users"),o(".js-refuse-users-alert-wrapper")),f=new u(o(".js-refuse-ips"),o(".js-refuse-ips-alert-wrapper"));o(l).on("refusalsChanged",(function(){d.onChanged(this)})).on("refusalAdded",(function(){d.onAdded(this)})).on("refusalRemoved",(function(){d.onRemoved(this)})).on("refusalSaveFailed",(function(){d.onNotFound(this)})),o(c).on("refusalsChanged",(function(){f.onChanged(this)})).on("refusalAdded",(function(){f.onAdded(this)})).on("refusalRemoved",(function(){f.onRemoved(this)})).on("refusalSaveFailed",(function(){f.onNotFound(this)}));var p=o(".js-refused-users-container").data("user-names");if(p.length>0){var h=e.loadUserNames(p.split(","));l.load(h)}var m=o(".js-refused-ips-container").data("ips");m.length>0&&c.load(m.split(","));o(".js-refuse-users").on("submit",(function(t){t.preventDefault();var n=o('input[name="refusal_input"]'),r=n.val();if(/^(\d{1,3}(\.\d{1,3}){3})|([0-9a-fA-F]{1,4}(:[0-9a-fA-F]{1,4})+)$/.test(r))c.add(r);else{var i;try{i=new e(r)}catch(e){}i&&l.add(i)}return n.val("").focus(),!1})),o(".js-refuse-users").on("click",".js-delete-refused-user",(function(){var t=o(this).closest(".refused-user").data("user-name");l.remove(new e(t))})),o(".js-refuse-ips").on("click",".js-delete-refusal",(function(){var e=o(this).closest(".refused-ip").data("ip");c.remove(e)}))}};e.exports=u},93687:function(e,t,n){var r,i=(r=n(76804))&&r.__esModule?r:{default:r};var o=n(73609),a=n(28507),s={setup:function(e,t){var n=this;n.entry_id=e,n.refresh_callback=t,n.saveExternalAuthorizeConfig(),n.setupExternalAuthLink()},setupExternalAuthLink:function(){var e=this,t=o("html").attr("data-admin-domain")+"/-/config/external?with_parent_window=1";o(document).on("click","[data-open-external-auth-link=1]",(function(n){n.preventDefault();var r={width:900,height:600,scrollbars:"yes"};r.left=Math.floor((screen.width-r.width)/2),r.top=Math.floor((screen.height-r.height)/2);var s=window.open(t,"external_auth",(0,i.default)(r));return a((function(){return s.closed}),(function(){var t=o(".js-socialize-modal");t.length>0&&(t.hide(),o(".modal-window-background").fadeOut("fast")),e.getExternalAuthStatus().done((function(t){e.saveExternalAuthorizeConfig(),e.refreshSocializeBox(t)}))})),!1}))},refreshSocializeBox:function(e){o(".js-refresh-socialize-box").empty().html(e),this.refresh_callback&&this.refresh_callback()},saveExternalAuthorizeConfig:function(){this.externalAuthorizeConfig={twitter:1===o(".js-authenticated-twitter").size()}},isExternalAuthorizeFinished:function(){return!1===this.externalAuthorizeConfig.twitter&&1===o(".js-authenticated-twitter").size()},getExternalAuthStatus:function(){var e=o.Deferred();return o.ajax({url:"socialize_box",type:"GET",dataType:"html",data:{entry_id:this.entry_id}}).done((function(t){e.resolve(t)})).fail((function(){e.reject()})),e.promise()}};e.exports=s},16292:function(e,t,n){n(30489),n(39714),n(12419),n(51532),n(78783),n(66992),n(33948),t.__esModule=!0,t.attachSubscriptionConfig=function(e,t){f(e).on("click",t,(function(e){var t=f(e.currentTarget);if(b.shouldHandle(e,t))b.newFromContainer(t).unsubscribe().then((function(){t.hide()}),m);else if(v.shouldHandle(e,t)){v.newFromContainer(t).toggle()}})),f(e).on("click",(function(e){f(".js-subscription-config-dropdown-container").get().every((function(t){return!f.contains(t,e.target)}))&&v.visibleDropdowns().addClass("is-hidden")}))},n(69826),n(88674),n(41539),n(21249);var r,i=(r=n(57942))&&r.__esModule?r:{default:r},o=n(70879);function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e){var t="function"==typeof Map?new Map:void 0;return(s=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return u(e,arguments,d(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),c(r,e)})(e)}function u(e,t,n){return(u=l()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&c(i,n.prototype),i}).apply(null,arguments)}function l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=n(73609),p=n(13469),h=p.bind,m=p.noop;var v=function(){function e(e,t){this.$button=e,this.$content=t}return e.shouldHandle=function(e,t){var n=t.find(".js-subscription-config-dropdown-btn"),r=f(e.target).is(n),i=f.contains(n.get(0),e.target);return r||i},e.visibleDropdowns=function(){return f(".js-subscription-config-dropdown-content:not(.is-hidden)")},e.newFromContainer=function(t){return new e(t.find(".js-subscription-config-dropdown-btn"),t.find(".js-subscription-config-dropdown-content"))},e.prototype.toggle=function(){this.$content.toggleClass("is-open")},e}(),g=function(e){var t,n;function r(){return e.apply(this,arguments)||this}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,c(t,n),r}(s(Error)),b=function(){function e(e){this._$el=f(e)}e.shouldHandle=function(e,t){return f(e.target).is(".js-unsubscribe-btn")},e.newFromContainer=function(t){return new e(t.find(".js-unsubscribe-btn").get(0))};var t,n,r,s=e.prototype;return s.unsubscribe=function(){var e=this;return this.confirmed()?[this.toggleState,this.requestUnsubscribe,this.notifyCompletion].map((function(t){return h(t,e)})).reduce((function(e,t){return e.then(t)}),Promise.resolve()).catch(this.onFailure.bind(this)):Promise.reject(new g)},s.onFailure=function(e){this.toggleState(),(0,o.BUG)(e,"UnsubscribeButton")},s.confirmed=function(){return window.confirm(this.confirmingMessage)},s.toggleState=function(){this._$el.prop("disabled",!this._$el.prop("disabled")),this._$el.toggleClass("disabled")},s.requestUnsubscribe=function(){return f.ajax({type:"POST",url:"/api/1/json/unsubscribe",data:{uri:this.blogUri,rkm:(0,i.default)("rkm"),rkc:(0,i.default)("rkc")}})},s.notifyCompletion=function(){alert(this.completionMessage)},t=e,(n=[{key:"blogUri",get:function(){return this._$el.attr("data-blog-uri")}},{key:"confirmingMessage",get:function(){return this._$el.attr("data-confirm-msg")}},{key:"completionMessage",get:function(){return this._$el.attr("data-completion-msg")}}])&&a(t.prototype,n),r&&a(t,r),e}()},1493:function(e,t,n){var r=n(73609),i={init:function(){var e=this,t=r("#android-app-banner");0!==t.length&&(r("#android-app-banner-close").click((function(n){t.slideToggle(400),e.setDismiss(!0)})),e.isDismissed()||setTimeout((function(){t.slideToggle(400)}),0))},_localStorageKey:"Hatena.Diary.Pages.AdminTouch.dismissAndroidAppBanner",_localStorageEnabled:function(){try{if(window.localStorage)return!0}catch(e){}return!1},isDismissed:function(){return!!this._localStorageEnabled()&&"true"===localStorage.getItem(this._localStorageKey)},setDismiss:function(e){this._localStorageEnabled()&&localStorage.setItem(this._localStorageKey,e?"true":"false")}};e.exports=i},11412:function(e,t,n){n(69826);var r,i=(r=n(20996))&&r.__esModule?r:{default:r};var o=n(73609),a={show:function(e,t){var n=a.container;if(!n){(n=o('<div class="hatena-diary-color-picker" tabindex="0"><a href="#" class="color-chip default" data-color="">'+i.default.text("default")+"</a></div>").appendTo(document.body).hide()).delegate(".color-chip","click",(function(){var e=o(this).attr("data-color");return n.trigger("colorpick",e),n.hide(),!1}));var r=30,s=[["#ffffff","#cccccc","#999999","#666666","#333333","#000000"],["#cc0000","#cc00cc","#0000cc","#00cccc","#00cc00","#cccc00"],["#990000","#990099","#000099","#009999","#008800","#aaaa00"],["#660000","#660066","#000066","#006666","#006600","#666600"],["#330000","#330033","#000033","#003333","#003300","#333300"]];n.css({width:38*s[0].length+8,height:38*(s.length+1)+8});n.find("a").css({top:8,left:8,height:r,width:n.width()-16});for(var u,l=o('<a href="#" class="color-chip"></a>'),c=0;u=s[c];c++)for(var d,f=0;d=u[f];f++)l.clone().attr("data-color",d).css({top:38*(c+1)+8,left:38*f+8,background:d,width:r,height:r}).appendTo(n);a.container=n}n.unbind("colorpick"),n.bind("colorpick",t),n.css(e),n.fadeIn("fast"),n.focus(),o(n).one("blur",(function(){n.hide()}))}};e.exports=a},56663:function(e,t,n){n(69826),n(4723),n(74916),n(15306);var r,i=(r=n(20996))&&r.__esModule?r:{default:r};var o=n(73609),a=n(81191),s=n(48211),u={init:function(e){var t;((t=document.createElement("input")).type="file",t.disabled)||(o(".toolbar-container").show(),"undefined"!=typeof FormData?u.setupAjaxUpload(e):u.setupIframeUpload(e))},setupAjaxUpload:function(e){var t=o(".toolbar-container"),n=t.find("input[type=file]");n.change((function(){!this.files.length>0||(s({$input:n,$progress:t.find(".progress")}).done(e).fail((function(e){alert(i.default.text("admin.blog.config.image_upload_failure"))})),a.trackEvent("upload-photo-smartphone"))}))},setupIframeUpload:function(e){var t=o(".toolbar-container");t.find("input[type=file]");t.addClass("iframe-uploader"),u.setIframeUploader({fileinput:t.find(".file-container"),fotosize:1200,callback:e})},setIframeUploader:function(e){var t=e.fileinput,n=e.fotosize,r=e.callback,a=o("<iframe/>");t.replaceWith(a);var s="/api/upload/fotolife_smart";a.attr("src",s),a.addClass("uploader"),a.load((function(){var e;if(a[0].contentDocument)e=a[0].contentDocument;else{if(!a[0].contentWindow)return;e=a[0].contentWindow.document}e.body.innerHTML.match(/^\s*(f:id:\S+)/)&&a[0].contentWindow.location.replace(s),e.body.innerHTML.match(/f:id:([^:]+):(\d+)([jpg]):image/)&&r(e.body.innerHTML),o(e).find('input[name="fotosize"]').val(n);var t=o(e).find('input[type="file"]');o(t[0]).change((function(){o(e).find("#fotolife-upload-form").submit(),o(t[0]).replaceWith(o("<h5>").text(i.default.text("uploading")))}))}))}};e.exports=u},3126:function(e,t,n){n(74916),n(9653),n(24603),n(39714);var r=n(73609);e.exports=function(){var e=r("#edit-entry"),t=navigator.userAgent,n=/\b(?:iPhone|iPad)\b/.exec(t)&&/\bVersion\/(\d+\.\d+)/.exec(t)&&Number(RegExp.$1)>=5.1,i=/\bAndroid\b/.exec(t)&&/\bChrome\b/.exec(t);return"html"===e.attr("data-entry-syntax")&&"contentEditable"in document.body&&(n||i)}},30917:function(e,t){t.__esModule=!0,t.insertText=void 0;var n=function e(t){document.querySelector("iframe#entry-html-body")?e.contentEditable(t):e.textarea(t)};t.insertText=n,n.textarea=function(e){var t=document.querySelector("textarea#entry-body"),n=t.value;t.value=n.substring(0,t.selectionStart)+e+n.substring(t.selectionEnd)},n.contentEditable=function(e){var t=document.querySelector("#entry-html-body").contentDocument;null!==t&&(t.body.focus(),t.execCommand("insertHTML",!1,e))}},83391:function(e,t,n){n(41539),n(39714),n(47042),n(69600),n(4723),n(74916);var r=n(73609);e.exports=function(){r(".post-options .js-datetime").show();var e=r(".js-datetime-input-date"),t=r(".js-datetime-input-time"),n=r("input[name=datetime]"),i=function(e){n.val(e).trigger("change")},o=n.val()||"",a=o.match(/^(\d{4}-\d{2}-\d{2})T(\d{2}:\d{2}:\d{2})\+(\d{2}:\d{2})$/);if(a){var s=a[1],u=a[2];e.val(s),t.val(u)}e.change((function(){var n=e.val(),r=t.val();n?(r||(t.val("00:00"),r="00:00"),i(n+"T"+r)):i(o)})),t.change((function(){var n=e.val(),r=t.val();if(r){if(!n){var a=function(){var e=new Date,t=[];return t.push((1900+e.getYear()).toString()),t.push(("0"+(1+e.getMonth()).toString()).slice(-2)),t.push(("0"+e.getDate().toString()).slice(-2)),t.join("-")}();e.val(a),n=a}i(n+"T"+r)}else i(o)}))}},48211:function(e,t,n){n(69826);var r=o(n(20996)),i=o(n(57942));function o(e){return e&&e.__esModule?e:{default:e}}var a=n(73609);e.exports=function(e){var t=e.folder||"Hatena Blog",n=e.fotosize||1200,o=e.$input,s=o.prop("files")[0],u=e.$progress,l=a.Deferred();o.prop("disabled",!0);var c=new FormData;c.append("rkm",(0,i.default)("rkm")),c.append("append",1),c.append("fototitle",""),c.append("folder",t),c.append("fotosize",n),c.append("image",s),c.append("delete-gps",1),u.show();var d=u.find(".bar");d.width("0%");var f=u.find(".percent"),p=function(e){e>100&&(e=100),d.width(e+"%"),f.text(r.default.text("uploading"))},h=new XMLHttpRequest;return h.upload.addEventListener("progress",(function(e){var t=e.lengthComputable?e.loaded/e.total*100:NaN;p(t)}),!1),h.addEventListener("load",(function(e){if(p(100),u.hide(),o.prop("disabled",!1),200===h.status){var t=h.responseText;l.resolve(t)}else l.reject(h.responseText)}),!1),h.addEventListener("error",(function(e){u.hide(),o.prop("disabled",!1),l.reject(e)}),!1),h.open("POST","/f/"+(0,i.default)("name")+"/upbysmart?dummy="+(new Date).getTime()),h.setRequestHeader("X-Requested-With","XMLHttpRequest"),h.send(c),l}},30546:function(e,t,n){n(69826);var r=n(13964),i=function(){this.init.apply(this,arguments)};i.prototype={init:function(e){this.$el=e,this.$textarea=e.find("textarea"),this.$errorMessage=e.find(".js-twitter-length-error"),this.$checkBox=e.find('input[name="post_to_twitter"]'),this.$shareButton=e.find(".js-touch-share-button"),this.bindEvents()},bindEvents:function(){var e=this;e.$textarea.keyup((function(){!1===(0,r.validateTweetLength)(e.$textarea.val())?(e.showErrorMessage(),e.disabledCheckBox(),e.disabledShareButton()):(e.hideErrorMessage(),e.enabledCheckBox(),e.enabledShareButton())}))},hideErrorMessage:function(){this.$errorMessage.hide()},showErrorMessage:function(){this.$errorMessage.show()},disabledCheckBox:function(){this.$checkBox.attr("disabled",!0)},enabledCheckBox:function(){this.$checkBox.attr("disabled",!1)},disabledShareButton:function(){this.$shareButton.attr("disabled",!0)},enabledShareButton:function(){this.$shareButton.attr("disabled",!1)}},e.exports=i},39769:function(e,t,n){n(69826);var r=n(55834),i=n(73609),o=n(13469),a={_setup:function(){this._reloadStarImplement||((0,r.hasFlagVariant)("new-starjs")?this._reloadStarImplement=o.throttle((function(){document.dispatchEvent(new Event("hatena:star:requestreload"))}),1e3):this._reloadStarImplement=o.throttle((function(){var e=i(document.body),t=e.find("span.hatena-star-comment-container, span.hatena-star-star-container");t.length>0&&(t.remove(),Hatena.Star.EntryLoader.loadNewEntries(e[0]))}),1e3))},reloadStar:function(){this._setup(),this._reloadStarImplement()}};e.exports=a},6636:function(e,t,n){t.__esModule=!0,t.AccessLogger=void 0,n(19601);var r=s(n(73609)),i=s(n(57942)),o=n(55992),a=s(n(80129));function s(e){return e&&e.__esModule?e:{default:e}}var u={ping:function(){if((0,i.default)("blogs-uri-base")){var e=(0,o.protocolRelativeAdminUrl)("/api/log"),t={uri:location.href,referer:document.referrer};r.default.ajax({url:e,type:"get",cache:!1,data:t,xhrFields:{withCredentials:!0}}).fail((function(){var n=a.default.stringify(Object.assign({},t,{_:(new Date).getTime()}));(new Image).src=e+"?"+n}))}}};t.AccessLogger=u},56882:function(e,t,n){t.__esModule=!0,t.default=void 0,n(69826);var r=o(n(73609)),i=o(n(57942));function o(e){return e&&e.__esModule?e:{default:e}}var a={updateMembershipCategory:function(e){var t,n,o=e.attr("data-circle-id"),a=e.attr("data-blog-id"),s=e.find("option:selected").val();return"delete"===s?t="delete":(t="update",n=s),r.default.ajax({url:"/api/circle/membership/category",type:"POST",data:{rkm:(0,i.default)("rkm"),rkc:(0,i.default)("rkc"),operation:t,circle_id:o,blog_id:a,category_id:n}})}};t.default=a},24264:function(e,t,n){var r=n(59662),i={userAgent:function(){return r.isTouch?"touch":"pc"}};e.exports=i},73287:function(e,t,n){function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var i=n(17187).EventEmitter,o=new i;o.on("__DISPATCH__",(function(e){o.emit(e.type,e.payload)}));var a=function(){function e(){}return e.prototype.emit=function(e,t){o.emit("__DISPATCH__",{type:e,payload:t})},e}();function s(e){return e}var u=function(e){var t,n;function i(t){var n;return void 0===t&&(t=s),(n=e.call(this)||this).state=t(void 0,{}),o.on("__DISPATCH__",(function(e){n.state=t(n.state,e||{}),n.emit("change")})),n}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,r(t,n),i.prototype.getState=function(){return this.state},i}(i);o.Actions=a,o.Store=u,e.exports=o},96371:function(e,t,n){n(15306),n(74916);var r,i=n(70879),o=(r=n(57942))&&r.__esModule?r:{default:r};var a=n(73609),s=n(26410),u=n(36500),l="hatena-diary-dropdown",c={toggle:function(e,t,n,r){n=l+(n?"-"+n:e.replace(/\//,"-")),"object"!=typeof(r=r||{})&&(0,i.BUG)("Wrong type of options given: "+r);var c,d=a(document.getElementById(n));if(r.key&&d.length&&d.attr("data-dropdown-key")!==r.key&&(d.remove(),d=a()),d.length)c="show"in r?!!r.show:!d.is(":visible"),d[c?"fadeIn":"fadeOut"]("fast"),d.trigger("dropdown:"+(c?"show":"hide")+":start");else if("show"in r&&!1===r.show);else{if(d=a('<div class="hatena-globalheader-window"></div>').hide().attr("id",n).appendTo(document.body),r.key&&d.attr("data-dropdown-key",r.key),r.parent){var f=document.getElementById(l+"-"+r.parent);a(f).on("dropdown:hide:start",(function(){d.fadeOut("fast")}))}r.className&&d.addClass(r.className);var p=a('<iframe frameborder="0" width="150" height="300"></iframe>').appendTo(d),h=p[0];/^https?:/.test(e)||(e=(0,o.default)("admin-domain")+e);var m=u.createForFrame(h,e);if(m.addEventListener("close",(function(){s.hide(p)})),m.addEventListener("init",(function(e){e&&d.css(e),m.send("init",t)})),m.addEventListener("resize",(function(e){e&&d.css(e)})),m.addEventListener("reload",(function(e){location.reload(!0)})),r.callback&&r.callback(h,m),s.show(d,{destroy:function(){d.remove(),m.destroy()},keepOthers:!!r.parent||!1}),t){if("left"in t||"right"in t||"top"in t){var v=d.offset();"left"in t?v.left=t.left:"right"in t&&(v.left=t.right-d.width()),"top"in t&&(v.top=t.top),d.offset(v)}"height"in t&&d.height(t.height)}}}};e.exports=c},10714:function(e,t,n){t.__esModule=!0,t.EditorConnector=void 0,n(64765),n(74916),n(69600),n(21249);var r=n(30917),i=a(n(1606)),o=a(n(73609));function a(e){return e&&e.__esModule?e:{default:e}}var s=n(36500),u=n(56412),l=n(3126),c=null,d={insertLines:function(e){this._validate(e),this._setup(),this._insertLinesImplement(e)},isiOS:function(){return Boolean((0,i.default)(location.search.substr(1)).ios)},isAndroid:function(){return Boolean((0,i.default)(location.search.substr(1)).android)},loadServiceOnChildWindow:function(e){var t=this,n=window.open();s.createForWindow(n,e).addEventListener("insertLines",(function(e){t.insertLines(e)}))},_validate:function(e){["html","hatena","markdown"].forEach((function(t){if(!e[t])throw"missing "+t}))},_setup:function(){if(!this._insertLinesImplement){var e="pc"===u.device()&&c,t="touch"===u.device(),n=window.opener,r=this.isiOS(),i=this.isAndroid();if(r||i)this._insertLinesImplement=this._insertLinesOpenURL;else if(e)this._insertLinesImplement=this._insertLinesPC;else if(t)this._insertLinesImplement=this._insertLinesTouch;else{if(!n)throw"handling failed";this._insertLinesImplement=this._insertLinesMessenger}}},_insertLinesImplement:null,_insertLinesPC:function(e){if(c){var t=e[c.syntaxForInsertLines];c.insertLines(t)}},_insertLinesTouch:function(e){var t=(0,o.default)("#edit-entry").attr("data-entry-syntax");"html"!==t||l()||(t="hatena");var n=e[t]||e.hatena||e.markdown;(0,r.insertText)(n.join("\n"))},_insertLinesMessenger:function(e){s.createForParent().send("insertLines",e),window.close()},_insertLinesOpenURL:function(e){var t=e.html.map((function(e){return"<p>"+e+"</p>"}));location.href="hatenablog:/entry/body/insert?"+o.default.param({hatena:e.hatena.join("\n"),html:t.join(""),markdown:e.markdown.join("\n\n"),version:1})},registerCurrentEditor:function(e){c=e},emit:function(){var e;c&&(e=c).emit.apply(e,arguments)}};t.EditorConnector=d},81191:function(e,t,n){n(69826),n(23123),n(74916);var r=a(n(73609)),i=a(n(13469)),o=a(n(57942));function a(e){return e&&e.__esModule?e:{default:e}}var s,u,l,c={};c.trackEvent=(s=[],u=null,l=function(){u=null,(new Image).src=((0,o.default)("admin-domain")||"")+"/api/track?"+r.default.param({track_name:s,blog:(0,o.default)("blogs-uri-base")||"http://"+(0,o.default)("blog")}),s=[]},function(e){u||(u=setTimeout(l,1e3)),i.default.each(r.default.makeArray(e),(function(e){s.push(e)}))}),c.checkSelector=function(e,t){var n=e.attr("data-track-selector");if(!n)return!0;var r=e.find(n);return!(!r.is(t)&&!r.find(t).get(0))},c.getDataTrackNames=function(e){return e.attr("data-track-name").split(/\s+/)},c.trackEventNow=function(e){var t=r.default.Deferred(),n=new Image;return n.onload=function(){t.resolve()},n.onerror=function(){t.reject()},n.src=((0,o.default)("admin-domain")||"")+"/api/track?"+r.default.param({track_name:r.default.makeArray(e),blog:(0,o.default)("blogs-uri-base")||"http://"+(0,o.default)("blog")}),setTimeout((function(){t.reject()}),5e3),t.promise()},c.setupTrack=function(){(0,r.default)(document).on("mousedown","[data-track-name]:not([data-track-once])",(function(e){if(1===e.which){var t=(0,r.default)(this);if(c.checkSelector(t,(0,r.default)(e.target))){var n=c.getDataTrackNames(t);c.trackEvent(n)}}})),(0,r.default)(document).on("mousedown","[data-track-name][data-track-once]:not([data-track-once-tracked])",(function(e){if(1===e.which){var t=(0,r.default)(this);if(c.checkSelector(t,(0,r.default)(e.target))){var n=c.getDataTrackNames(t);c.trackEventNow(n),t.attr("data-track-once-tracked","")}}}))},e.exports=c},41730:function(e,t,n){var r,i=(r=n(57942))&&r.__esModule?r:{default:r};var o=n(73609),a=n(26410),s=n(36500),u="hatena-diary-feedback",l={toggle:function(e){var t=document.getElementById(u);if(t)o(t).fadeToggle("fast");else{var n=o('<iframe frameborder="0" width="320" height="320"></iframe>').hide().attr("id",u).appendTo(document.body);t=n[0];var r=s.createForFrame(t,e+"?uri="+encodeURIComponent(location.href)+"&page_id="+encodeURIComponent((0,i.default)("page")));r.addEventListener("close",(function(){a.hide(n)})),r.addEventListener("resize",(function(e){e&&n.css(e)})),a.show(n,{destroy:function(){n.remove(),r.destroy()},fixScroll:!0})}}};e.exports=l},44878:function(e,t,n){var r,i=(r=n(20996))&&r.__esModule?r:{default:r};var o=n(73609),a=void 0!==window.onbeforeunload?"beforeunload":"unload",s=function(){function e(e){var t=this;this.$form=e,this.isWatching=!0,this.commit(),this.$form.on("submit",(function(){t.isWatching=!1})),this.onLeave=function(){return t.confirm()},o(window).on(a,this.onLeave)}var t=e.prototype;return t.confirm=function(){if(o(window).triggerHandler("close-preview-window"),this.isWatching&&this.hasFormChanged())return i.default.text("form.confirm.changed.epic")},t.hasFormChanged=function(){return this.$form.serialize()!==this.initialState},t.commit=function(){this.initialState=this.$form.serialize()},t.unWatch=function(){o(window).off(a,this.onLeave)},e}();e.exports=s},56769:function(e,t,n){var r=n(86965),i=n(70879),o=n(55834),a=u(n(57942)),s=u(n(73609));function u(e){return e&&e.__esModule?e:{default:e}}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c=n(36500),d=n(24264),f=n(78304),p=n(56412),h=function(){function e(){l(this,"globalheader",void 0),l(this,"color",void 0),l(this,"bgColor",void 0),l(this,"circleId",void 0),l(this,"pageCategory",void 0),l(this,"params",void 0);var e=!!(0,o.hasFlagVariant)("gh-ng");this.globalheader=this.createGlobalHeader(),this.color=this.getColor(),this.bgColor=this.getBackgroundColor(),this.circleId=this.getCircleId(),this.pageCategory=this.getPageCategory(),this.params=this.getParams();var t=e?this.getURLNextGen():this.getURL();c.listenToFrame(this.globalheader,t),c.addEventListener("init",(function(e){(0,s.default)((function(){(0,i.LOG)(["init",e]),p.resolveInfo(e),f.record("globalHeaderLoaded")}))})),f.record("loadGlobalHeader")}var t=e.prototype;return t.createGlobalHeader=function(){var e=document.querySelector("iframe#globalheader");if(e)return e;var t=(0,s.default)('<iframe id="globalheader" style="display: none"></iframe>');return t.appendTo(document.body),t[0]},t.getColor=function(){return(0,r.canonicalizeColor)((0,s.default)(this.globalheader).css("color"))||"000000"},t.getBackgroundColor=function(){for(var e=null,t=this.globalheader;!e&&t&&t!==document.documentElement;){var n=(0,s.default)(t).css("backgroundColor");e=(0,r.canonicalizeColor)(n),t=t.parentNode}return e||(e="ffffff"),e},t.getDevice=function(){var e=(0,a.default)("globalheader-type")||"auto";return"auto"===e?d.userAgent():e},t.getCircleId=function(){return(0,a.default)("circle-id")},t.getPageCategory=function(){return/\.hatena\.ne\.jp(:\d+)?$/.test(location.host)?"admin":(0,a.default)("blog")?"blogs":this.circleId?"circle":"global"},t.showUpgradePro=function(){return"admin"===this.pageCategory&&(0,a.default)("dont-recommend-pro")&&"false"===(0,a.default)("dont-recommend-pro")&&(0,a.default)("pro")&&"false"===(0,a.default)("pro")},t.showGMOCampaignLink=function(){return"admin"===this.pageCategory&&(0,a.default)("dont-recommend-pro")&&"false"===(0,a.default)("dont-recommend-pro")},t.getBrand=function(){return(0,a.default)("brand")},t.getParams=function(){var e={device:this.getDevice()};return this.circleId&&(e.circle_id=this.circleId),this.showGMOCampaignLink()&&(e.show_upgrade_pro="yes"),this.showGMOCampaignLink()&&(e.show_campaign="yes"),(0,a.default)("brand")&&(e.brand=(0,a.default)("brand")),e},t.getURL=function(){var e=(0,a.default)("admin-domain"),t=encodeURIComponent(this.color),n=encodeURIComponent(this.bgColor),r=s.default.param(this.params),i=encodeURIComponent(location.href);return e+"/-/globalheader/"+t+"/"+n+"/"+this.pageCategory+"?"+r+"#"+i},t.getURLNextGen=function(){return(0,a.default)("admin-origin")+"/-/globalheader_ng?"+s.default.param(this.params)+"#"+encodeURIComponent(location.href)},e}();e.exports=h},36843:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.GlobalHeaderSubscriber=t.initForGlobalHeaderNextGeneration=void 0,n(73210),n(69826);var r,i=n(50025),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(55992)),a=(r=n(57942))&&r.__esModule?r:{default:r};function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}var u=n(73609),l=n(36500),c=n(56412),d=n(96371),f=n(41730),p=n(26410),h=n(10912),m=n(43302),v=function(){l.addEventListener("resizeGlobalHeader",(function(e){"100vh"===e?document.body.classList.add("globalheader-expanded"):document.body.classList.remove("globalheader-expanded")}))};t.initForGlobalHeaderNextGeneration=v;var g={navigateToEditNewEntry:function(e){c.infoLoaded.then((function(t){t.can_open_editor?h.newEntry({openedFrom:e.openedFrom}):location.href=o.protocolRelativeAdminUrl("/my/?fragment=edit")}))},navigateToEditNewEntryWithQuote:function(){c.infoLoaded.then((function(){location.href=o.protocolRelativeAdminUrl("/my/edit?sidebar=quote#auto_fillin")}))},navigateToEditNewEntryWithReQuote:function(){c.infoLoaded.then((function(){location.href=o.protocolRelativeAdminUrl("/my/edit")}))},init:function(){if(window!==window.parent)return null;if(!l.messenger)return null;v(),(0,i.setupAnalyticsClientIdBroadcaster)(),l.addEventListener("new-entry",(function(){g.navigateToEditNewEntry({openedFrom:"globalheader-new-entry"})})),l.addEventListener("new-entry-with-quote",(function(){g.navigateToEditNewEntryWithQuote()})),l.addEventListener("new-entry-with-requote",(function(){g.navigateToEditNewEntryWithReQuote()})),l.addEventListener("feedback",(function(e){f.toggle(e.uri)})),l.addEventListener("mymenu",(function(e){m.toggle(e)})),l.addEventListener("servicesmenu",(function(e){d.toggle("/-/menu/services",e)})),l.addEventListener("unread",(function(){location.href=o.protocolRelativeAdminUrl("/-/antenna")}));var e,t=u('\n          <div id="notify-window" class="hatena-globalheader-window" style="display: none;">\n            <iframe style="border:none" frameBorder="0"\n              class="notify" width="250" height="300"\n              ></iframe>\n          </div>\n        '.trim());l.addEventListener("notify",(function(n){var r=n.BASE;if(e){if(e.is(":visible"))return void p.hide(e);e.remove()}(e=t.clone()).css({left:n.left-250+32}),e.find("iframe").attr("src","https://www"+r+"/notify/notices.iframe?"+(new Date).getTime()),e.appendTo(document.body).fadeIn("fast"),p.show(e,{fixScroll:!0})})),l.addEventListener("blogmenu",(function(e){var t={};(0,a.default)("blog")&&(t.blog=location.href,"entry"===(0,a.default)("page")&&u('article.entry:not([class~="no-entry"])').length>0&&(t.blog_permalink=1));var n="/-/menu/blogmenu?"+u.param(t);d.toggle(n,e,"blogmenu",{callback:function(e,t){t.addEventListener("request-report-abuse-info",(function(){t.send("response-report-abuse-info",window.location.href)})),t.addEventListener("edit-this-entry",(function(){var e=u("article.entry").first();h.editEntryInPlace(e,{openedFrom:"blogmenu-edit-this-entry"})})),t.addEventListener("new-entry",(function(){g.navigateToEditNewEntry({openedFrom:"blogmenu-new-entry"})})),t.addEventListener("subscribe",(function(e){u(document).trigger("subscribe",e)}))}})}))}};t.GlobalHeaderSubscriber=g},75225:function(e,t,n){var r=n(73609),i=n(56769);e.exports={init:function(){return function(){if("fixed"===r("#globalheader-container").css("position")){var e=r("#globalheader-container").height(),t=r(document);t.on("click",'a[href^="#"]',(function(){var n=t.scrollTop(),r=0;setTimeout((function i(){t.scrollTop()!==n?window.scrollBy(0,-e):r++<10&&setTimeout(i,0)}),0)}))}}(),new i}}},54102:function(e,t,n){function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var i=n(67294),o=function(e){var t,n;function o(){return e.apply(this,arguments)||this}return n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,r(t,n),o.prototype.render=function(){var e=this;return i.createElement("span",{dangerouslySetInnerHTML:{__html:e.props.body}})},o}(i.Component);e.exports=o},22592:function(e,t,n){var r=n(73609),i=function(){this.init.apply(this,arguments)};i.prototype={init:function(e,t){if(!r.isFunction(e))throw"generator must be a function ("+e+")";if(this.generator=e,t){if(!(t instanceof i))throw"prev must be a instance of LazyList";this._prev=t}},promise:function(){if(!this._promise){var e=this.generator(this.prev());if(!r.isFunction(e.promise))throw"generator must return a Deferred Object ("+e+")";this._promise=e.promise()}return this._promise},prev:function(){return this._prev},next:function(){return this._next||(this._next=new i(this.generator,this)),this._next},root:function(){return this._prev?this._prev.root():this}},e.exports=i},50477:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),n(69826);var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=i(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=o?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(55992));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(i=function(e){return e?n:t})(e)}var o,a=n(73609),s=r.staticUrl("/js/external/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"),u={load:function(e){var t=e.find('img[src*="chart.apis.google.com/chart?cht=tx&chl="]');t.length&&(o||(o=a.getScript(s)),o.done((function(){MathJax.Hub.Config({tex2jax:{inlineMath:[],displayMath:[]}}),t.each((function(){var e=a(this),t=e.attr("alt");if(t){var n=a('<script type="math/tex">');e.replaceWith(n),MathJax.HTML.setScript(n[0],t)}})),MathJax.Hub.Queue(["Typeset",MathJax.Hub,e[0]])})))}};e.exports=u},26410:function(e,t,n){var r=a(n(73609)),i=a(n(13469)),o=a(n(99349));function a(e){return e&&e.__esModule?e:{default:e}}var s={shown:[],init:function(){var e=this;(0,r.default)(document.body).click((function(t){i.default.any(e.shown,(function(e){return e.win[0]===t.target||r.default.contains(e.win[0],t.target)}))||e.hideAll()})),this.init=function(){}},show:function(e,t){t||(t={}),this.init(),t.keepOthers||this.hideAll(),t.fixScroll&&o.default.enable(),t.center&&s._setCenter(e),t.showBackground&&s._showBackground(),this.shown.push({closeExplicitly:!!t.closeExplicitly,win:e,destroy:t.destroy||function(){},fixScroll:!!t.fixScroll,showBackground:!!t.showBackground}),t.then?e.fadeIn("fast",t.then):e.fadeIn("fast")},hide:function(e){for(var t=0,n=this.shown.length;t<n;t++){var i=this.shown[t];if(i.win===e){e.fadeOut("fast",i.destroy),(0,r.default)(".modal-window-background").fadeOut("fast"),i.fixScroll&&o.default.disable();break}}},hideAll:function(){for(var e=[],t=0,n=this.shown.length;t<n;t++)this.shown[t].closeExplicitly?e.push(this.shown[t]):this.hide(this.shown[t].win);this.shown=e},toggle:function(e,t){return e.is(":visible")?(this.hide(e),!1):(this.show(e,t),!0)},_setCenter:function(e){var t=i.default.throttle((function(){if((0,r.default)(e).is(":visible")){var n=((0,r.default)(window).height()-(0,r.default)(e).height())/2,i=((0,r.default)(window).width()-(0,r.default)(e).width())/2;(0,r.default)(e).css({top:n,left:i})}else(0,r.default)(window).off("resize",t)}),100);(0,r.default)(window).on("resize",t),t()},_showBackground:function(){(0,r.default)("<div>").addClass("modal-window-background").appendTo(document.body)}};e.exports=s},99349:function(e,t,n){t.__esModule=!0,t.default=void 0;var r,i=(r=n(73609))&&r.__esModule?r:{default:r};var o=0,a=!1;function s(){(0,i.default)(window).scrollTop()!==o&&(0,i.default)(window).scrollTop(o)}var u={enable:function(){a||(o=(0,i.default)(window).scrollTop(),(0,i.default)(window).on("scroll",s),a=!0)},disable:function(){a&&((0,i.default)(window).off("scroll",s),a=!1)}};t.default=u},83092:function(e,t,n){t.__esModule=!0,t.default=void 0,n(15306),n(74916),n(69826);var r,i=(r=n(73609))&&r.__esModule?r:{default:r};function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a=function(){function e(e,t){var n=this;void 0===t&&(t=0),o(this,"$el",void 0),o(this,"$tabs",void 0),o(this,"$anchors",void 0),o(this,"$panels",void 0),o(this,"tabs",void 0),this.$el=e;var r=e.children("ol, ul");r.attr("role","tabs"),r.addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header");var a=r.children('li:has(a[href^="#"])');a.attr({role:"tab",tabIndex:-1}),a.addClass("ui-tabs-tab ui-state-default");var s=a.children("a[href]:first-child");s.attr("tabIndex",-1),s.addClass("ui-tabs-anchor"),s.each((function(e,t){(0,i.default)(t).data("index",e)})),s.on("click",(function(e){e.isDefaultPrevented()||(e.preventDefault(),n.show(+(0,i.default)(e.currentTarget).data("index")))})),this.tabs=[];var u=(0,i.default)();s.each((function(t){var r,i=s.eq(t),o=a.eq(t),l=i.attr("href"),c=l.substring(1),d=e.find((r=l)?r.replace(/[!"$%&'()*+,./:;<=>?@[\]^`{|}~]/g,"\\$&"):"");if(d.length){var f=o.attr("aria-controls");f&&o.data("ui-tabs-aria-controls",f),o.attr({"aria-controls":c,"aria-labelledby":c}),d.attr({"aria-labelledby":c,role:"tabpanel"}),d.addClass("ui-tabs-panel ui-widget-content"),u=u.add(d),n.tabs.push({$anchor:i,$panel:d,$tab:o})}})),this.$tabs=a,this.$anchors=s,this.$panels=u,this.show(t)}return e.prototype.show=function(e){this.$tabs.removeClass("ui-tabs-active ui-state-active"),this.$tabs.attr({tabIndex:-1,"aria-expanded":"false","aria-selected":"false"}),this.$anchors.attr("tabIndex",-1),this.$panels.attr("aria-hidden","true"),this.$panels.hide();var t=this.tabs[e];t.$tab.addClass("ui-tabs-active ui-state-active"),t.$tab.attr({tabIndex:0,"aria-expanded":"true","aria-selected":"true"}),t.$anchor.attr("tabIndex",0),t.$panel.attr("aria-hidden","false"),t.$panel.show(),this.$el.triggerHandler("tabsactivate",{newPanel:t.$panel})},e}();t.default=a},46658:function(e,t,n){var r,i=(r=n(20996))&&r.__esModule?r:{default:r};var o=n(73609),a=void 0!==window.onbeforeunload?"beforeunload":"unload",s=function(){function e(){var e=this;this.isWatching=!1,o(window).on(a,(function(){return e.confirm()}))}var t=e.prototype;return t.confirm=function(){if(this.isWatching)return i.default.text("form.confirm.changed")},t.enable=function(){this.isWatching=!0},t.disable=function(){this.isWatching=!1},e}();e.exports=s},97050:function(e,t,n){t.__esModule=!0,t.replaceImageToPlain=t.extractFotolifeSyntax=void 0,n(4723),n(74916),n(15306),n(69600);var r,i=n(92477),o=(r=n(73609))&&r.__esModule?r:{default:r};t.extractFotolifeSyntax=function(e){var t=o.default.Deferred(),n=e.match(/f:id:([^:]+):(\d+)([jpg]):image/);if(!n)return t.reject("Invalid format? "+e).promise();var r=n[0],a=n[1],s=n[2],u=n[3],l="["+r.replace(/:image$/,":plain")+"]",c=[a.substring(0,1),a,s.substring(0,8),s].join("/"),d="https://cdn-ak.f.st-hatena.com/images/fotolife/"+c+"_120.jpg",f="https://cdn-ak.f.st-hatena.com/images/fotolife/"+c+"."+function(e){var t=e.toLowerCase();return"g"===t?"gif":"p"===t?"png":"jpg"}(u);return(0,i.extractSyntax)(l).done((function(e){t.resolve({image:d,largeImage:f,syntax:l,html:e.html})})).fail((function(e){t.reject(e)})),t.promise()};t.replaceImageToPlain=function(e){return e.replace(/:image$/,":plain")}},92477:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.extractSyntax=void 0,n(69600);var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(73609)),o=(r=n(57942))&&r.__esModule?r:{default:r};function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}t.extractSyntax=function(e){var t=i.Deferred(),n=e;return Array.isArray(n)&&(n=n.join("\n\n")),i.ajax({url:"/api/support.expand",type:"POST",data:{syntax:n,rkm:(0,o.default)("rkm"),rkc:(0,o.default)("rkc")},dataType:"json"}).done((function(e){t.resolve({html:e.html})})).fail((function(e){t.reject(e)})),t}},55834:function(e,t,n){t.__esModule=!0,t.hasFlagVariant=t.getFlagVariants=t.removeFlagVariant=t.addFlagVariant=void 0,n(69600),n(92222),n(57327),n(23123),n(74916),n(15306),n(26699),n(32023);var r,i=(r=n(36808))&&r.__esModule?r:{default:r};var o="epic_flag_variants";t.addFlagVariant=function(e){i.default.set(o,[].concat(a(),[e]).join(","))};t.removeFlagVariant=function(e){i.default.set(o,a().filter((function(t){return t!==e})).join(","))};var a=function(){var e=i.default.get(o);return e?e.replace(/\s+/,"").split(",").filter((function(e){return!!e})):[]};t.getFlagVariants=a;t.hasFlagVariant=function(e){return a().includes(e)}},43459:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880);var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=i(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=o?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(55992));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(i=function(e){return e?n:t})(e)}var o=n(80570);e.exports=function(e){o(r.staticUrl(e))}},85814:function(e,t,n){n(69826);var r=n(73609);e.exports=function(){window!==window.parent&&r("form").each((function(){var e=r(this);if(!e.attr("data-pass-through-click-jacking-validation")){var t=e.find("input[type=submit][name!=delete][name!=draft]"),n=e.find("input[type=submit][name=delete], input[type=submit][name=draft]"),i=function(e){return r({elements:e.find(":input:not([data-ignore-click-jacking])")}).serialize()};e.addClass("unedited"),t.attr("disabled","disabled"),n.attr("disabled","disabled");var o=i(e),a=setInterval((function(){n.removeAttr("disabled"),o!==i(e)&&(clearInterval(a),e.removeClass("unedited"),t.removeAttr("disabled"))}),1500)}}))}},8659:function(e,t,n){var r=n(73609),i=n(36500),o=n(26410);e.exports=function(){r(".open-pro-modal").css("visibility","visible"),r(document.body).on("click",".open-pro-modal",(function(){return function(e){var t=r('<div class="hatena-iframe-container pro-modal-container">').appendTo(document.body),n=r('<iframe frameborder="0"></iframe>').appendTo(t),a=i.createForFrame(n[0],e);a.addEventListener("close",(function(){o.hide(t)})),o.show(t,{destroy:function(){n.remove(),a.destroy()},fixScroll:!0,center:!0,showBackground:!0})}(r(this).attr("data-guide-pro-modal-ad-url")),!1}))}},38600:function(e,t,n){var r;t.__esModule=!0,t.default=void 0;var i=((r=n(73609))&&r.__esModule?r:{default:r}).default.Deferred();t.default=i},13964:function(e,t,n){t.__esModule=!0,t.validateTweetLength=void 0;var r,i=(r=n(72778))&&r.__esModule?r:{default:r};t.validateTweetLength=function(e){var t=(e||"")+"\nhttps://hatenablog.com/";return i.default.parseTweet(t).valid}},23226:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.AboutSubscribersElement=void 0,n(21249),n(68309);var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),o=(r=n(20996))&&r.__esModule?r:{default:r};function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}t.AboutSubscribersElement=function(e){var t=e.subscribers,n=e.subscribeCount,r=e.hasMoreSubscribers;return i.createElement("div",null,i.createElement("span",{className:"about-subscription-count"},o.default.textN("unit_person",n,n)),t.map((function(e,t){return i.createElement(i.Fragment,null," ",i.createElement("a",{href:e.blog_url,className:"subscriber",rel:"nofollow",key:t},i.createElement("img",{src:e.profile_image_url,width:"16",height:"16",alt:e.name,title:e.name,className:"profile-icon"})))})),r&&i.createElement("span",null,o.default.text("hidden_subscribes")))}},43348:function(e,t,n){t.__esModule=!0,t.AboutSubscribers=void 0;var r,i=n(55992),o=n(91289),a=n(23226),s=(r=n(67294))&&r.__esModule?r:{default:r};t.AboutSubscribers=function(){var e=(0,o.useXHR)((0,i.userBlogUrl)("/api/about_subscribers"))[0],t=e.data,n=e.loading,r=e.error;if(n)return s.default.createElement(s.default.Fragment,null);if(r)return null;if(!t)throw new TypeError("'data' doesn't exist");var u=t.subscribers,l=t.subscribe_count,c=t.has_more_subscribers;return s.default.createElement(a.AboutSubscribersElement,{subscribers:u,subscribeCount:l,hasMoreSubscribers:c})}},10912:function(e,t,n){n(73210),n(15306),n(74916);var r=n(82667),i=n(78899),o=n(9736),a=n(73609),s=n(9479),u={editEntryInPlace:function(e,t){e&&o.InPlaceEditor.showEditInPlace(e,{openedFrom:t.openedFrom,update:function(t){var n=a(t.entry.trim());n.length?(e.replaceWith(n),u.initEntry(n),(0,i.updateDynamicPieces)(n.parent())):e.remove()}})},newEntry:function(e){var t=e.openedFrom;o.InPlaceEditor.showEditInPlace(null,{openedFrom:t,update:function(e){var t=a(e.entry.replace(/^\s+/,"").replace(/\s+$/,""));t.length&&(t.insertBefore("#main article.entry:first"),u.initEntry(t),(0,i.updateDynamicPieces)(t.parent()),a("[data-remove-on-new-entry=1]").remove())}})},initEntry:function(e){(0,r.replaceYoutubeURL)(e),e.attr("data-uuid")&&new s(e)}};e.exports=u},9994:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),n(73210),n(69826);var r=c(n(73609)),i=c(n(57942)),o=c(n(20996)),a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=l(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(55992)),s=c(n(76804)),u=n(59662);function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(l=function(e){return e?n:t})(e)}function c(e){return e&&e.__esModule?e:{default:e}}var d=n(36808),f=n(26410),p={render:function(e){var t=e.entryId,n=e.$target,o=e.onUpdate,a=(0,i.default)("admin-origin")+"/"+(0,i.default)("author")+"/"+(0,i.default)("blog")+"/comment?"+r.default.param({entry:t,token:d.get("bk")});u.isHatenaBlogNativeApp?p.renderIframe(a,n,o):p.renderWindow(a,o)},renderWindow:function(e,t){var n=(0,s.default)({width:400,height:240,left:Math.floor((screen.width-400)/2),top:Math.floor((screen.height-120)/2)}),r=window.open("","comment",n),i=Messenger.createForWindow(r,e);i.addEventListener("close",(function(){i.destroy(),r.close()})),i.addEventListener("update",(function(e){t(e.comment)}))},renderIframe:function(e,t,n){var s=(0,r.default)(('\n      <div class="hatena-iframe-container" style="display: none;">\n        <div class="loading" style="display: none;">\n          <img src="'+a.staticUrl("/images/loading.gif")+'" class="loading-spinner" alt="loading"/>\n          '+o.default.text("loading")+'\n        </div>\n        <iframe frameborder="0"></iframe>\n      </div>\n    ').trim()).appendTo(document.body),u=t.offset(),l=(0,r.default)(window).width(),c=440;c+20>l&&(c=l-20,u.left=10);var d=235,p=(0,i.default)("blog-comments-top-is-new");p&&(u.top-=d,u.top+=t.height()),s.css({width:c,height:d,position:"absolute"}).offset(u);var h=s.find("iframe"),m=s.find(".loading");setTimeout((function(){return m.show()}),250),h.load((function(){return m.remove()}));var v=h[0],g=Messenger.createForFrame(v,e);g.addEventListener("update",(function(e){n(e.comment)})),g.addEventListener("close",(function(){f.hide(s)})),g.addEventListener("resize",(function(e){e&&(p&&e.height!==d&&(e.top=s.css("top")+d-e.height),s.css(e))})),f.show(s,{closeExplicitly:!0,destroy:function(){h.remove(),g.destroy()}})}};e.exports=p},57035:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),n(47042),n(73210),n(69826);var r=c(n(73609)),i=c(n(20996)),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=l(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(55992)),a=c(n(57942)),s=c(n(76804)),u=n(59662);function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(l=function(e){return e?n:t})(e)}function c(e){return e&&e.__esModule?e:{default:e}}var d=n(26410),f={render:function(e){var t=e.commentId,n=e.$target,i=e.onDelete,o=(0,a.default)("admin-origin")+"/"+(0,a.default)("author")+"/"+(0,a.default)("blog")+"/comment/delete?"+r.default.param({comment:t.slice(8)});u.isHatenaBlogNativeApp?f.renderIframe(o,n,i):f.renderWindow(o,i)},renderWindow:function(e,t){var n=(0,s.default)({width:300,height:150,left:Math.floor((screen.width-300)/2),top:Math.floor((screen.height-150)/2)}),i=window.open("","delete_comment",n),o=Messenger.createForWindow(i,e),a=function(){o.destroy(),i.close()};o.addEventListener("delete",(function(){t()})),o.addEventListener("close",a),(0,r.default)(document.body).one("focus",a)},renderIframe:function(e,t,n){var a=(0,r.default)(('\n          <div class="hatena-iframe-container">\n            <div class="loading" style="display: none;">\n              <img src="'+o.staticUrl("/images/loading.gif")+'" class="loading-spinner" alt="loading"/>\n              '+i.default.text("loading")+'\n            </div>\n            <iframe frameborder="0"></iframe>\n          </div>\n        ').trim()).appendTo(document.body);a.css({width:440,height:120,position:"absolute"}).offset(t.offset());var s=a.find("iframe"),u=a.find(".loading");setTimeout((function(){return u.show()}),250),s.load((function(){return u.remove()}));var l=Messenger.createForFrame(s[0],e);l.addEventListener("delete",(function(){n()})),l.addEventListener("close",(function(){d.hide(a)})),d.show(a,{destroy:function(){s.remove(),l.destroy()}})}};e.exports=f},26652:function(e,t,n){n(69826),n(69600),n(34553),n(40561);var r,i=n(78899),o=(r=n(57942))&&r.__esModule?r:{default:r},a=n(54948),s=n(55834);var u=n(73609),l=n(28507),c=n(78304),d=n(56412),f=n(9994),p=n(57035),h=function(){function e(e){var t=this;if(this.$entry=e,this.$container=e.find(".js-comment-box .js-comment"),this.$readMoreLine=this.$entry.find(".read-more-comments"),this.$readMoreButton=this.$readMoreLine.find("a"),this.$leaveCommentButton=this.$entry.find(".js-leave-comment-title"),this.entryId=this.$entry.attr("data-uuid"),this.comments=[],this.hasMore=!1,this.topIsNew=(0,o.default)("blog-comments-top-is-new"),this.$container.length){this.loadComments(3),d.infoLoaded.then((function(e){t.$leaveCommentButton.toggle(!e.cookie_received||e.commentable)})),this.initEvents()}}var t=e.prototype;return t.initEvents=function(){var e=this;this.$readMoreButton.on("click",(function(){return e.expandComments(),!1})),this.$leaveCommentButton.on("click",(function(){return e.showAddCommentBox(),!1})),this.$container.on("click",".comment-delete-button",(function(t){return e.showDeleteCommentBox(u(t.currentTarget)),!1}))},t.expandComments=function(){var e=this;this.loadComments(0).then((function(){if("entry"!==(0,o.default)("page")){var t=JSON.parse(sessionStorage.getItem("entriesExpandedComments"))||{};t[e.entryId]=!0,sessionStorage.setItem("entriesExpandedComments",JSON.stringify(t))}})).catch((function(){}))},t.loadComments=function(e){var t=this;return(0,a.requestForComments)(this.entryId,e,(function(){return c.record("Pages.Blogs['*'].loadEntryInfo.ajax.success")})).then((function(e){e&&e.comments&&(t.comments=e.comments,t.hasMore=e.has_more,t.renderComments(),c.record("Pages.Blogs['*'].init.showEntryInfo"))}))},t.shouldExpandComments=function(){if("entry"===(0,o.default)("page"))return!1;var e=!1;try{e=!!(JSON.parse(sessionStorage.getItem("entriesExpandedComments"))||{})[this.entryId]}catch(e){}return e},t.renderComments=function(){var e=this;if(0!==this.comments.length){this.$container.find(".js-entry-comment").remove();var t=u.parseHTML(this.comments.join(""));this.$container.prepend(t),this.hasMore?this.$readMoreLine.show():(this.$readMoreLine.hide(),this.$entry.attr("data-comments-expanded",!0)),!(0,s.hasFlagVariant)("new-starjs")&&Hatena.Star?l((function(){return Hatena.Star&&Hatena.Star.WindowObserver.loaded}),(function(){Hatena.Star.EntryLoader.intoCommentScope((function(){(0,i.updateDynamicPieces)(e.$container)}))})):(0,i.updateDynamicPieces)(this.$container)}},t.addComment=function(e){this.topIsNew?this.comments.unshift(e):this.comments.push(e),this.renderComments()},t.removeComment=function(e){u("#"+e).fadeOut();var t=this.comments.findIndex((function(t){return u.parseHTML(t)[0].id===e}));-1!==t&&(this.comments.splice(t,1),this.renderComments())},t.showAddCommentBox=function(){var e=this;f.render({entryId:this.entryId,$target:this.$leaveCommentButton,onUpdate:function(t){return e.addComment(t)}})},t.showDeleteCommentBox=function(e){var t=this,n=e.closest("li.entry-comment").attr("id");p.render({commentId:n,$target:e,onDelete:function(){return t.removeComment(n)}})},e}();e.exports=h},9479:function(e,t,n){e.exports=n(26652)},40793:function(e,t,n){n(69826),n(9653);var r=n(70879),i=n(73609),o=function(e,t){this.init(e,t)};o.prototype={init:function(e,t){t||(t={});var n=this;n.moveInProgress=!1,n.$containerElem=e,n.$goBackElem=i(i.parseHTML('<a class="module-entries-carousel-button back"><span>Back</span<</a>')),n.$goForwardElem=i(i.parseHTML('<a class="module-entries-carousel-button forward"><span>Forward</span></a>')),n.isAutoScroll=t.isAutoScroll||!1,n.autoScrollInterval=t.autoScrollInterval||5e3,n.displayEntrySizeAtOnce=t.displayEntrySizeAtOnce||2,n.isAutoScroll&&(n.autoScrollIntervalId=window.setInterval((function(e){e.goForwardWithLoop()}),n.autoScrollInterval,n)),n.$containerElem.on("click",".module-entries-carousel-button.back.active",(function(){n.isAutoScroll&&window.clearInterval(n.autoScrollIntervalId),n.goBack()})),n.$containerElem.on("click",".module-entries-carousel-button.forward.active",(function(){n.isAutoScroll&&window.clearInterval(n.autoScrollIntervalId),n.goForward()})),n.currentPosition=0;var r=n.getCarouselBodyElem();n.carouselList=r.find(".urllist-item"),n.carouselElementsSize=n.carouselList.length,n.carouselSize=n.carouselElementsSize-(n.displayEntrySizeAtOnce-1),n.$directNavigationListElem=i(i.parseHTML('<ol class="module-entries-carousel-navigation">'));for(var o=0;o<n.carouselSize;)n.$directNavigationListElem.append(i(i.parseHTML('<li><a data-carousel-index="'+o+'"><span>'+o+"</span></a></li>"))),o++;n.$containerElem.on("click",".module-entries-carousel-navigation a.active",(function(e){n.isAutoScroll&&window.clearInterval(n.autoScrollIntervalId),n.goToIndex(Number(i(this).attr("data-carousel-index")))})),n.updateNavigationElementsClass(),n.$containerElem.append(n.$goBackElem),n.$containerElem.append(n.$goForwardElem),n.$containerElem.append(n.$directNavigationListElem)},canGoBack:function(){return this.currentPosition>0},canGoForward:function(){var e=this;return e.currentPosition<e.carouselSize-(e.displayEntrySizeAtOnce-1)},updateNavigationElementsClass:function(){var e=this;e.$goBackElem.toggleClass("active",e.canGoBack()),e.$goForwardElem.toggleClass("active",e.canGoForward()),e.$directNavigationListElem.find("a").removeClass("current"),e.$directNavigationListElem.find('a[data-carousel-index="'+e.currentPosition+'"]').addClass("current"),e.$directNavigationListElem.find("a").addClass("active"),e.$directNavigationListElem.find("a.current").removeClass("active")},getUnitWidth:function(){var e=this.getCarouselBodyElem().find(".urllist-item");return 0===e.length?((0,r.BUG)("Can't get unit width"),200):1===e.length?e.width():i(e[1]).offset().left-i(e[0]).offset().left},getCarouselBodyElem:function(){return i(this.$containerElem).find(".urllist-with-thumbnails")},goToIndex:function(e){var t=this;if(!(e<0||e>=t.carouselSize||t.moveInProgress)){t.moveInProgress=!0;var n=t.getCarouselBodyElem(),r=(n.offset(),"-="+t.getUnitWidth()*(e-t.currentPosition)+"px");n.animate({left:r},300,(function(){t.currentPosition=e,t.updateNavigationElementsClass(),t.moveInProgress=!1}))}},goBack:function(){this.goToIndex(this.currentPosition-1)},goForward:function(){this.goToIndex(this.currentPosition+1)},goForwardWithLoop:function(){this.canGoForward()?this.goForward():this.goToIndex(0)}},e.exports=o},9736:function(e,t,n){t.__esModule=!0,t.InPlaceEditor=void 0;var r=o(n(73609)),i=o(n(57942));function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s=function(){function e(){}return e.showEditInPlace=function(e,t){this.$entry=e,this.opts=t;var n=this.getEditorUrl();window.location.assign(n)},e.getEditorUrl=function(){var e={openedFrom:this.opts.openedFrom};return this.$entry&&(e.entry=this.$entry.attr("data-uuid")),this.opts.title&&(e.title=this.opts.title),this.opts.body&&(e.body=this.opts.body),(0,i.default)("admin-domain")+"/"+(0,i.default)("author")+"/"+(0,i.default)("blog")+"/edit?"+r.default.param(e)},e}();t.InPlaceEditor=s,a(s,"$entry",void 0),a(s,"opts",void 0)},50154:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),n(69826),n(23123),n(74916);var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(55992)),o=(r=n(57942))&&r.__esModule?r:{default:r};function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}var s=n(73609),u=n(13469),l=n(78304);e.exports={init:function(){var e=s(".hatena-module-archive");if(0!==e.length){var t=function(){if("archive"===(0,o.default)("page")){var e=s("section.archive-entry:first");if(e.length>0){var t=e.find("div.date > a > time").attr("datetime");return{year:t.split("-")[0],month:t.split("-")[1]}}return null}var n=s("article.entry:first");if(n.length>0){var r=n.find("header time > span.date-year").text(),i=n.find("header time > span.date-month").text();if(r&&i)return{year:r,month:i}}return null};u.each(e,(function(e){var n=s(e),r=n.data("archiveType");s.ajax({type:"get",url:i.userBlogUrl("/archive_module"),data:{archive_type:r},dataType:"html"}).done((function(e){n.find(".hatena-module-body").append(e),l.record("Pages.Blogs['*'].setupArchiveModule"),"calendar"===r?function(e){var n=e.find(".js-archive-module-calendar-selector"),r=function(){var t=n.find("option:selected"),r=t.data("year"),o=t.data("month");s.ajax({type:"get",url:i.userBlogUrl("/archive_module_calendar"),data:{month:o,year:r}}).done((function(t){e.find(".js-archive-module-calendar-container").html(t)}))};n.change((function(){r()}));var o=t();o?n.val(o.year+" "+o.month):n.val(n.find("option:first-child").val()),r()}(n):function(e){var n,r=t();if(r){var i=r.year;if(i){var o=e.find('li.archive-module-year[data-year="'+i+'"]');n=o.length>0?o:null}}(n=n||s("li.archive-module-year:first")).removeClass("archive-module-year-hidden"),e.find(".archive-module-button").click((function(e){e.preventDefault(),s(this).parent(".archive-module-year").toggleClass("archive-module-year-hidden")}))}(n)}))}))}}}},49445:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.init=void 0,n(69826),n(9653),n(54747),n(69720);var r,i=n(70879),o=(r=n(73609))&&r.__esModule?r:{default:r},a=n(55992),s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=u(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(78558));function u(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(u=function(e){return e?n:t})(e)}var l=n(78304),c=s.object({circles:s.record(s.object({html:s.string().optional().nullable()}).nonstrict())}).nonstrict();t.init=function(){var e=(0,o.default)(".hatena-module-circles");if(0!==e.length){var t=[],n={},r=0;e.find("[data-circle-id][data-circle-mtime]").each((function(e,i){var a=(0,o.default)(i),s=a.attr("data-circle-id");t.push(s),n[s]=a;var u=Number(a.attr("data-circle-mtime"));u>r&&(r=u)})),0!==t.length&&o.default.ajax({type:"GET",url:(0,a.userBlogUrl)("/api/module/circles"),data:{mtime:r,circle_id:t},traditional:!0,dataType:"json"}).done((function(e){var t=c.safeParse(e);if(t.success){var r=t.data.circles;Object.entries(r).forEach((function(e){var t=e[0],r=e[1];n[t].replaceWith(o.default.parseHTML(r.html||" "))})),l.record("Pages.Blogs['*'].setupCirclesModule")}else(0,i.BUG)(t.error)}))}}},76310:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),n(4723),n(74916),n(68309),n(15306),n(69826);var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=i(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=o?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(55992));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(i=function(e){return e?n:t})(e)}var o=n(73609),a=n(13469);e.exports={init:function(){var e=o(".hatena-module-entries-access-ranking");0!==e.length&&e.each((function(){var e=o(this),t={};a.each(e[0].attributes,(function(e){e.name.match(/^data-/)&&(t[e.name.replace(/^data-/,"")]=e.value)})),o.ajax({type:"GET",url:r.userBlogUrl("/entries_access_ranking_module"),data:t,dataType:"html"}).done((function(t){e.find(".hatena-module-body").append(t)}))}))}}},80846:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880);!function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=r(t);if(n&&n.has(e))return n.get(e);var i={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=o?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(i,a,s):i[a]=e[a]}i.default=e,n&&n.set(e,i)}(n(55992));function r(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(r=function(e){return e?n:t})(e)}var i=n(73609);n(78304);e.exports={init:function(){var e=i(".profile-running-duration"),t=Math.floor(Date.now()/1e3);e.each((function(e,n){var r=i(n),o=parseInt(r.attr("data-show-until"))||t;t<o&&r.removeClass("is-hidden")}))}}},74709:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),n(69826);var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=o(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(55992)),i=n(78899);function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(o=function(e){return e?n:t})(e)}var a=n(73609),s=n(13469),u=n(78304);e.exports={init:function(){var e=a(".hatena-module-recent-comments");if(0!==e.length){var t=s.template(a(".recent-comments-template").html()),n=0;e.each((function(){var e=a(this).find(".hatena-module-body").attr("data-count");n=s.max([n,e])})),0!==n&&a.ajax({url:r.userBlogUrl("/api/recent_comments"),dataType:"json",data:{count:n}}).done((function(n){e.each((function(){for(var e=a(this),r=e.find(".hatena-module-body").attr("data-count"),o="",s=0;s<r&&n[s];s++)o+=t({comment:n[s]});e.find(".recent-comments").html(o),(0,i.updateDynamicPieces)(e)})),u.record("Pages.Blogs['*'].setupRecentCommentsModule")}))}}}},20854:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),n(54747);var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=i(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=o?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(49445));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(i=function(e){return e?n:t})(e)}var o=n(50154),a=n(76310),s=n(74709),u=n(80846);e.exports={init:function(){[o,r,a,s,u].forEach((function(e){e.init()}))}}},43302:function(e,t,n){var r=n(73609),i=n(13469),o=n(96371),a=n(41730),s={dropdown:null,$activeContainer:null,blogToDropdownContainer:{},toggle:function(e){var t=this,n="/-/menu/mymenu?location="+encodeURIComponent(location.href);o.toggle(n,e,"mymenu",{callback:function(e,n){s.dropdown=e,n.addEventListener("feedback",(function(e){a.toggle(e.uri)})),n.addEventListener("myblogmenu.init",(function(e){t.initMyBlogMenu(e)})),n.addEventListener("myblogmenu.open",(function(e){var n=t.blogToDropdownContainer[e.blogUri];n.show(),t.$activeContainer=n})),n.addEventListener("myblogmenu.close",(function(e){t.blogToDropdownContainer[e.blogUri].hide(),t.$activeContainer=null}))}}),this.$activeContainer&&this.$activeContainer.is(":hidden")&&this.$activeContainer.fadeIn("fast")},initMyBlogMenu:function(e){var t=this,n={top:r(this.dropdown).offset().top+e.top,right:r(this.dropdown).offset().left-2,height:266},a="/-/menu/myblogmenu?blog="+encodeURIComponent(e.blogUri);o.toggle(a,n,null,{callback:function(n){t.blogToDropdownContainer[e.blogUri]=r(n).parent(),i.delay((function(){return r(n).parent().hide()}))},key:e.blogUri,parent:"mymenu",className:"hatena-diary-dropdown-myblogs"})}};e.exports=s},30618:function(e,t,n){n(73210),n(69826);var r=n(73609),i=n(36500),o=function(){this.init()};o.prototype={init:function(){this.quote={body:"",url:"",title:""};var e=r("#js-requote-button-template");e[0]&&(this.$reQuoteButton=r(e.html().trim()),this.bindEvents())},getSelectedText:function(){return window.getSelection?""+(window.getSelection()||""):document.getSelection?document.getSelection():document.selection?document.selection.createRange().text:""},selectedTextExists:function(){return this.getSelectedText().length>0},bindEvents:function(){var e=this;r(document).on("mouseenter","blockquote",(function(t){if(!1===e.selectedTextExists()){var n=r(t.target).closest("blockquote");if(n.find("blockquote").length>0)return;e.focusOnBlockquote(n),e.showButton()}})),r(document).on("mouseleave","blockquote",(function(t){!1===r(t.toElement).hasClass("js-select_quote_panel")&&e.hideButton()})),r(document).on("mouseup","blockquote",(function(){e.selectedTextExists()?e.hideButton():e.showButton()})),e.$reQuoteButton.on("click",(function(){return i.send("requote-edit-entry",{quote:e.quote}),!1}))},focusOnBlockquote:function(e){this.$blockquote=e,this.setButtonData(e),this.$blockquote.append(this.$reQuoteButton)},setButtonData:function(e){this.setQuoteBody(e),this.setQuoteMeta(e),""===this.quote.body&&(this.quote.body=this.quote.title,this.quote.title=this.quote.url)},setQuoteBody:function(e){var t=e.children(":not(cite, .js-requote-button)");t.length<=0?this.quote.body=e.contents().get(0).nodeValue||"":this.quote.body=t.text()},setQuoteMeta:function(e){var t=e.find("cite"),n=t.find("a"),r=e.attr("cite")||n.attr("href");void 0===r&&(r=e.closest("article").find(".entry-title .entry-title-link").attr("href"));var i=n.text()||t.text()||r;this.quote.url=r,this.quote.title=i},showButton:function(){this.$reQuoteButton.addClass("is-visible")},hideButton:function(){this.$reQuoteButton.removeClass("is-visible")}},e.exports=o},23249:function(e,t,n){n(69600),n(21249);var r=o(n(73609)),i=o(n(57942));function o(e){return e&&e.__esModule?e:{default:e}}var a=n(36500),s=n(92901);e.exports={init:function(e,t){var n=(0,i.default)("blog-uri"),o=(0,i.default)("blog-host"),u={isSubscribing:e,isGuest:!((0,i.default)("rkm")&&(0,i.default)("rkc"))},l={subscribersCount:t,blogUrl:n,blogName:(0,i.default)("blog-name"),requestUrl:[(0,i.default)("admin-domain"),(0,i.default)("author"),o,"subscribe"].join("/")},c=a.createForCurrentWindow();(0,r.default)(".hatena-follow-button-box").map((function(){return new s.Blogs((0,r.default)(this),u,l,c,"hatena-follow-button-box")})).toArray();a.addEventListener("subscription",(function(e){c.send("subscription",e)})),c.addEventListener("subscription",(function(e){a.send("subscription",e)}));var d=(0,r.default)("#hidden-subscribe-button > .hatena-follow-button-box");this.subscribeButtonForMessage=new s.Blogs(d,u,l,c,"globalheader");var f=this;a.addEventListener("subscribe",(function(e){var t={left:e.left+5};f.subscribeButtonForMessage.openSubscribeWindow(t,!0)})),c.addEventListener("subscription",(function(e){!0===e[n]&&a.send("subscribed-current-blog")})),(0,r.default)(document).on("subscribe",(function(e,t){var n={left:t.left+5};f.subscribeButtonForMessage.openSubscribeWindow(n,!0)}))}}},90757:function(e,t,n){var r=n(73609),i={init:function(e){r(e||document.body).on("click","a[data-hatenablog-tumblr-share-button]",(function(e){var t=r(e.currentTarget),n=""+(window.getSelection?window.getSelection():document.getSelection?document.getSelection():document.selection?document.selection.createRange().text:0),i="http://www.tumblr.com/share?"+r.param({v:3,u:t.attr("data-share-url")||location.href,t:t.attr("data-share-title")||document.title,s:n}),o=function(){window.open(i,"t","toolbar=0,resizable=0,status=1,width=450,height=430")||(location.href=i)};return/Firefox/.test(navigator.userAgent)?setTimeout(o,0):o(),!1}))}};e.exports=i},57525:function(e,t,n){function r(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function o(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function a(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function s(e){o(a,r,i,s,u,"next",e)}function u(e){o(a,r,i,s,u,"throw",e)}s(void 0)}))}}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n(47042),n(68309),n(82526),n(41817),n(32165),t.__esModule=!0,t.YouTubeEmbed=void 0,n(35666),n(88674),n(41539),n(54747),n(57327),n(92222),n(91038),n(78783),n(38478),n(66992),n(33948);var u=/^https:\/\/www.youtube.com\/embed\//,l=function(){function e(){}return e.init=function(){var e=a(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.cachedInitPromise){e.next=2;break}return e.abrupt("return",this.cachedInitPromise);case 2:return this.cachedInitPromise=new Promise((function(e){window.onYouTubeIframeAPIReady=function(){t.updatePlayers(),e()};var n=document.createElement("script");n.src="https://www.youtube.com/iframe_api";var r=document.querySelector("script");r&&r.parentNode&&r.parentNode.insertBefore(n,r)})),e.abrupt("return",this.cachedInitPromise);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e.updatePlayers=function(){var e=a(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.init().then((function(){t.collectYouTubeEmbeddedIframes().forEach((function(e){t.registeredIframes.has(e)||t.createPlayer(e)}))}));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e.collectYouTubeEmbeddedIframes=function(){var e,t,n=document.querySelectorAll("iframe"),r=(null===(e=document.querySelector("#body_ifr"))||void 0===e||null===(t=e.contentWindow)||void 0===t?void 0:t.document.querySelectorAll("iframe"))||[];return Array.from(n).concat(Array.from(r)).filter((function(e){return u.test(e.src||"")}))},e.createPlayer=function(e){var t=this;this.registeredIframes.add(e);var n=new YT.Player(e,{events:{onStateChange:function(e){e.data===YT.PlayerState.PLAYING&&t.pauseAllExcept(e.target)}}});this.players.push(n)},e.pauseAllExcept=function(e){for(var t,n=r(this.players);!(t=n()).done;){var i=t.value;i!==e&&i.getPlayerState()===YT.PlayerState.PLAYING&&i.pauseVideo()}},e}();t.YouTubeEmbed=l,s(l,"cachedInitPromise",null),s(l,"players",[]),s(l,"registeredIframes",new WeakSet)},54948:function(e,t,n){n(4129),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.requestForComments=function(e,t,n){return m.apply(this,arguments)},n(35666),n(88674),n(41539),n(47941),n(54747);var r,i=n(70879),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(55992)),a=(r=n(347))&&r.__esModule?r:{default:r};function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}function u(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){u(o,r,i,a,s,"next",e)}function s(e){u(o,r,i,a,s,"throw",e)}a(void 0)}))}}var c=o.userBlogUrl("/api/entry/info"),d=null,f={};function p(e,t,n,r){return h.apply(this,arguments)}function h(){return(h=l(regeneratorRuntime.mark((function e(t,n,r,i){var o,s,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={e:Object.keys(t),limit:r},e.prev=1,e.next=4,a.default.get(c,{params:o});case 4:s=e.sent,u=s.data,Object.keys(u).forEach((function(e){t[e].resolves.forEach((function(t){return t(u[e])}))})),i&&i(),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),t[n].rejects.forEach((function(t){return t(e.t0)}));case 13:case"end":return e.stop()}}),e,null,[[1,10]])})))).apply(this,arguments)}function m(){return(m=l(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===n&&(n=0),!f[t]){e.next=9;break}return e.prev=2,e.abrupt("return",new Promise((function(e,n){f[t].resolves.push(e),f[t].rejects.push(n)})));case 6:return e.prev=6,e.t0=e.catch(2),e.abrupt("return",(0,i.BUG)(e.t0,"loadEntryInfo"));case 9:return d||(d=setTimeout((function(){p(f,t,n,r),d=null,f={}}),0)),e.prev=10,e.abrupt("return",new Promise((function(e,r){f[t]={entryId:t,limit:n,rejects:[r],resolves:[e]}})));case 14:return e.prev=14,e.t1=e.catch(10),e.abrupt("return",(0,i.BUG)(e.t1,"loadEntryInfo"));case 17:case"end":return e.stop()}}),e,null,[[2,6],[10,14]])})))).apply(this,arguments)}},44504:function(e,t,n){n(47042);var r,i=(r=n(57942))&&r.__esModule?r:{default:r};var o=n(2933),a=function(){function e(e){this.$element=e,this.uuid=e.attr("id"),this.initDeleteButton()}var t=e.prototype;return t.initDeleteButton=function(){var e=this;this.deleteBox=new o(this.$element,this.getDeleteUrl()),this.deleteBox.on("delete",(function(){return e.delete()})),this.$element.on("click",".js-comment-delete-button",(function(){return e.deleteBox.show(),!1}))},t.getDeleteUrl=function(){return(0,i.default)("admin-origin")+"/"+(0,i.default)("author")+"/"+(0,i.default)("blog")+"/comment/delete?comment="+encodeURIComponent(this.uuid.slice(8))},t.delete=function(){this.$element.fadeOut()},t.getElement=function(){return this.$element},e}();e.exports=a},94508:function(e,t,n){n(69826),n(21249),n(54747);var r=n(82667),i=d(n(2933)),o=n(59662),a=d(n(57942)),s=n(54948),u=d(n(36500)),l=n(96486),c=n(78899);function d(e){return e&&e.__esModule?e:{default:e}}var f=n(73609),p=n(36808),h=n(56412),m=n(44504),v=function(){function e(e){(0,r.replaceYoutubeURL)(e),this.$element=e,this.$commentBox=e.find(".js-comment-box"),this.$commentList=e.find(".js-comment-box .js-comment"),this.$showCommentInputButton=e.find(".js-leave-comment-title"),this.$readMoreBox=e.find(".js-read-more-comments"),this.$readMoreButton=e.find(".js-read-more-comments-button"),this.uuid=this.$element.attr("data-uuid"),this.comments=[],this.hasMoreComments=!1,this.summaryCommentCount=3,this.initArticleBar(),this.$commentBox.length&&(this.initComments(),this.initCommentInputBox()),this.initEditButton()}var t=e.prototype;return t.initArticleBar=function(){var e=document.querySelector(".js-entry-header"),t=document.querySelector(".js-article-bar");if(e&&t){var n=e.getBoundingClientRect().top+window.pageYOffset;window.addEventListener("scroll",(0,l.throttle)((function(){n<window.pageYOffset?t.classList.add("is-visible"):t.classList.remove("is-visible")}),100))}},t.initComments=function(){var e=this;return this.uuid?(0,s.requestForComments)(this.uuid,this.summaryCommentCount).then((function(t){t&&t.comments&&(e.comments=t.comments.map((function(e){return new m(f(e))})),e.hasMoreComments=t.has_more,e.renderComments(e.comments),e.initCommentsExpansion())})):null},t.initCommentsExpansion=function(){var e=this;this.hasMoreComments&&(this.$readMoreBox.show(),this.$readMoreButton.on("click",(function(){return(0,s.requestForComments)(e.uuid).then((function(t){t.comments&&(e.comments=t.comments.map((function(e){return new m(f(e))})),e.$readMoreBox.hide(),e.$commentList.empty(),e.renderComments(e.comments))})),!1})))},t.initCommentInputBox=function(){var e=this;this.$showCommentInputButton.on("click",(function(t){t.preventDefault(),e.renderCommentInputBox()}))},t.renderCommentInputBox=function(){o.isHatenaBlogNativeApp?this._renderCommentInputIframe():this._renderCommentInputWindow()},t._renderCommentInputWindow=function(){var e=this,t=this.getCommentInputUrl(),n=window.open("","comment"),r=u.default.createForWindow(n,t);r.addEventListener("close",(function(){r.destroy(),n.close()})),r.addEventListener("update",(function(t){e.addComment(new m(f(t.comment))),e.renderComments(e.comments)}))},t._renderCommentInputIframe=function(){var e=this,t=this.getCommentInputUrl();this.inputBox=new i.default(this.$commentBox,t),this.inputBox.on("update",(function(t){e.addComment(new m(f(t.comment))),e.renderComments(e.comments)})),this.inputBox.show()},t.initEditButton=function(){var e=this,t=this.$element.find(".js-entry-edit-button-container"),n=t.find(".js-entry-edit-button");h.infoLoaded.then((function(r){r.editable&&(t.show(),n.attr("href",e.getEditorUrl()))}))},t.getCommentInputUrl=function(){return(0,a.default)("admin-origin")+"/touch/"+(0,a.default)("author")+"/"+(0,a.default)("blog")+"/comment?"+f.param({entry:this.uuid,token:p.get("bk")})},t.getEditorUrl=function(){return(0,a.default)("admin-domain")+"/"+(0,a.default)("author")+"/"+(0,a.default)("blog")+"/edit?entry="+this.uuid},t.addComment=function(e){(0,a.default)("blog-comments-top-is-new")?this.comments.unshift(e):this.comments.push(e)},t.renderComments=function(e){var t=this;e.forEach((function(e){t.$commentList.append(e.getElement())})),(0,c.updateDynamicPieces)(this.$commentList)},e}();e.exports=v},2933:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),n(69826),n(54747),n(47941);var r=s(n(73609)),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(55992)),o=s(n(20996));function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}function s(e){return e&&e.__esModule?e:{default:e}}var u=n(13469),l=n(36500),c=function(){function e(t,n){this.url=n,this.$container=(0,r.default)(e.TEMPLATE({image:i.staticUrl("/images/loading.gif"),text:o.default.text("loading")})).css({position:"relative"}).appendTo(t),this.$loading=this.$container.find(".js-loading"),this.eventListeners={}}var t=e.prototype;return t.show=function(){var e=this;this.$iframe=(0,r.default)('<iframe frameborder="0"></iframe>'),this.$container.append(this.$iframe),this.messenger=l.createForFrame(this.$iframe[0],this.url),this.messenger.addEventListener("close",(function(){e.$container.fadeOut(),e.$iframe.remove(),e.messenger.destroy()})),this.messenger.addEventListener("resize",(function(t){t&&e.$container.css(t)})),Object.keys(this.eventListeners).forEach((function(t){e.eventListeners[t].forEach((function(n){e.messenger.addEventListener(t,n)}))})),this.$container.fadeIn()},t.on=function(e,t){this.eventListeners[e]=this.eventListeners[e]||[],this.eventListeners[e].push(t)},e}();c.TEMPLATE=u.template('<div class="hatena-iframe-container" style="display: none;">  <div class="loading js-loading" style="display: none;">    <img src="<%- image %>" alt="loading" class="loading-spinner" />    <%- text %>  </div></div>'),e.exports=c},99109:function(e,t,n){e.exports=n(94508)},56764:function(e,t,n){t.__esModule=!0,t.init=void 0;var r=o(n(73609)),i=o(n(1780));function o(e){return e&&e.__esModule?e:{default:e}}t.init=function(){var e=(0,r.default)("form#create-circle-form");e.on("submit",(function(){(0,i.default)(e)}))}},8078:function(e,t,n){t.__esModule=!0,t.init=void 0,n(68309),n(69826);var r=o(n(73609)),i=o(n(56882));function o(e){return e&&e.__esModule?e:{default:e}}var a=n(36500);t.init=function(){a.listenToParent(),a.send("resize",{height:(0,r.default)(document.body).height()+50}),a.send("done"),(0,r.default)(".close").on("click",(function(){return a.send("close",{name:window.name}),!1}));var e=(0,r.default)(".options"),t=e.find(".membership-category-select"),n=t.find("option:selected").val(),o=e.find(".indicator");t.change((function(){i.default.updateMembershipCategory(t).done((function(){o.find(".success").show(),o.find(".fail").hide()})).fail((function(){t.val(n),o.find(".success").hide(),o.find(".fail").show()}))}))}},13796:function(e,t,n){t.__esModule=!0,t.init=void 0,n(68309);var r,i=(r=n(73609))&&r.__esModule?r:{default:r};var o=n(36500),a=n(67279);t.init=function(){o.listenToParent(),(0,i.default)(".close").on("click",(function(){return o.send("close",{name:window.name}),!1})),a()}},33576:function(e,t,n){var r,i=(r=n(73609))&&r.__esModule?r:{default:r};var o=n(55540),a=n(13605),s={init:function(){new o({container:(0,i.default)("#editor-amazon-search"),sidebar:new a})}};e.exports=s},68850:function(e,t,n){var r,i=(r=n(73609))&&r.__esModule?r:{default:r};var o=n(52570),a=n(13605),s={init:function(){(0,i.default)("#editor-flickr.enabled").get(0)&&o.init({container:document.querySelector("#editor-flickr"),sidebar:new a})}};e.exports=s},88956:function(e,t,n){var r,i=(r=n(73609))&&r.__esModule?r:{default:r};var o=n(90036),a=n(13605),s={init:function(){(0,i.default)("#editor-gourmet.enabled").get(0)&&new o({container:(0,i.default)("#editor-gourmet"),sidebar:new a}).requestLoadItems()}};e.exports=s},37013:function(e,t,n){var r,i=(r=n(73609))&&r.__esModule?r:{default:r},o=n(30871);var a=n(13605),s={init:function(){(0,i.default)("#editor-instagram.enabled").get(0)&&new o.Instagram({container:(0,i.default)("#editor-instagram"),sidebar:new a}).requestLoadItems()}};e.exports=s},62492:function(e,t,n){var r,i=(r=n(73609))&&r.__esModule?r:{default:r};var o=n(35227),a=n(13605),s={init:function(){new o({container:(0,i.default)("#editor-itunes"),sidebar:new a}).requestLoadItems()}};e.exports=s},41516:function(e,t,n){n(41539),n(66992),n(33948);var r=n(58972),i=n(67294),o=n(73935),a=n(14674),s=n(40746),u=n(50525),l=n(73287).Store,c={init:function(){var e=new l(u);o.render(i.createElement(r.PromotionTouch,{store:e}),document.querySelector("#promotion")),a.init(),s.loadOdais();var t=e.getState().entries.entryIds;t.length>0&&a.showEntry(t[0])}};e.exports=c},59451:function(e,t,n){var r,i=(r=n(73609))&&r.__esModule?r:{default:r},o=n(42740);var a=n(13605),s={init:function(){(0,i.default)("#editor-twitter.enabled").get(0)&&new o.Twitter({$container:(0,i.default)("#editor-twitter"),sidebar:new a})}};e.exports=s},55431:function(e,t,n){t.__esModule=!0,t.default=void 0;var r=o(n(57942)),i=o(n(347));function o(e){return e&&e.__esModule?e:{default:e}}var a=function(){function e(){}var t=e.prototype;return t.activate=function(e,t){return i.default.put("/api/blog/top_placed_publication",{blog_id:e,entry_id:t},{params:{rkc:(0,r.default)("rkc"),rkm:(0,r.default)("rkm")}})},t.deactivate=function(e){return i.default.delete("/api/blog/top_placed_publication",{params:{blog_id:e,rkc:(0,r.default)("rkc"),rkm:(0,r.default)("rkm")}})},e}();t.default=a},5927:function(e,t,n){var r=n(65939),i=n(73609),o=n(36500),a=n(67279),s={init:function(){o.listenToParent(),a(),(0,r.initGlobalHeaderEventTracker)(),o.send("init"),o.addEventListener("init",(function(e){i(".subscribe").click((function(){return o.send("subscribe",{left:e.left?e.left:0}),!1})),o.send("request-report-abuse-info",{}),o.addEventListener("response-report-abuse-info",(function(e){var t=i(".js-report-abuse-link");t.attr("href",t.attr("href")+"?target_url="+encodeURIComponent(e))}))})),i(".edit-this-entry").click((function(){return o.send("edit-this-entry"),!1})),i(".new-entry").click((function(){return o.send("new-entry"),!1}))}};e.exports=s},39212:function(e,t,n){var r=n(65939),i=n(73609),o=n(36500),a=n(67279),s=n(28507),u={init:function(){o.listenToParent(),(0,r.initGlobalHeaderEventTracker)(),s((function(){return i(document.body).is(":visible")}),(function(){a()}),100),i(document.body).mouseenter((function(){o.send("mouseenter")}))}};e.exports=u},35358:function(e,t,n){n(69826);var r=n(65939),i=n(73609),o=n(36500),a=n(67279),s={init:function(){o.listenToParent(),a(),(0,r.initGlobalHeaderEventTracker)();var e,t=i("#help");(t.click((function(){return o.send("feedback",{uri:t.attr("data-feedback-url")}),!1})),window.matchMedia("(hover: none)").matches)?i("a.myblog").on("click",(function(t){t.preventDefault();var n=i(this).attr("href");e&&o.send("myblogmenu.close",{blogUri:e}),o.send("myblogmenu.open",{blogUri:n}),e=n})):i(".dropdown-mymenu").menuAim({activate:function(e){if(i(e).hasClass("dropdown-mymenu-submenu")){var t=i(e).find("a").attr("href");o.send("myblogmenu.open",{blogUri:t})}},deactivate:function(e){if(i(e).hasClass("dropdown-mymenu-submenu")){var t=i(e).find("a").attr("href");o.send("myblogmenu.close",{blogUri:t})}},submenuDirection:"left"});i("a.myblog").each((function(){var e=i(this).position().top,t=i(this).attr("href");o.send("myblogmenu.init",{top:e,blogUri:t})}))}};e.exports=s},966:function(e,t,n){n(69826),n(68309);var r,i=(r=n(20996))&&r.__esModule?r:{default:r};var o=n(73609),a=n(36500),s=n(67279),u={init:function(){a.listenToParent(),a.addEventListener("init",(function(e){var t=e.BASE,n=e.info.services,r=o("#username-window");o('<dt class="label"><span>Services in Use</span></dt>').find("span").text(i.default.text("services_in_use")).end().appendTo(r);var u=[];for(var l in n)n[l].is_beta||n[l].portal_top_priority&&u.push(l);u.sort((function(e,t){return n[t].portal_top_priority-n[e].portal_top_priority}));for(var c=0,d=u.length;c<d;c++){var f=u[c],p=n[f];if(p){var h="http://www"+t+"/me/"+p.name+"/",m="//www.hatena.com/images/favicon/"+p.name+".png";o('<dd><a href="" rel="noreferrer" target="_blank"><img alt="" width="16" height="16"/></a></dd>').find("a").find("img").attr("src",m).end().attr("href",h).append(document.createTextNode(p.text)).end().appendTo(r)}}o('<dt class="label"><span>Lang</span></td>').find("span").text(i.default.text("lang")).end().appendTo(r);for(var v=i.default.getAvailLangs(),g=0;g<v.length;g++){var b=v[g];v[g]===i.default.getTextLang()?o('<dd><span class="selected">lang</span></dd>').find("span").text(i.default.text("lang."+b+".native")).end().appendTo(r):o('<dd><a href="#">lang</a></dd>').find("a").attr("data-lang",b).text(i.default.text("lang."+b+".native")).end().appendTo(r)}r.find("a[data-lang]").click((function(){var e=o(this).attr("data-lang");return i.default.setAcceptLang(e),a.send("reload"),!1})),o('<dt class="label"><span>My Hatena</span></dt>').find("span").text(i.default.text("my_hatena")).end().appendTo(r),o('<dd><a href="" rel="noreferrer" target="_blank"><img src="/images/favicon/my.png" width="16" height="16" alt=""></a></dd>').find("a").attr("href","http://www"+t+"/my/").append(i.default.text("profile")).end().appendTo(r),o('<dd><a href="" rel="noreferrer" class="logout" target="_parent"><img width="16" height="16" src="/images/favicon/logout.gif"></a></dd>').find("a").attr("href","http://www"+t+"/logout?location="+encodeURIComponent(e.location)).append(i.default.text("logout")).end().appendTo(r),s()})),a.send("init")}};e.exports=u},10175:function(e,t,n){n(69826);var r=o(n(20996)),i=o(n(57942));function o(e){return e&&e.__esModule?e:{default:e}}var a=n(73609),s={init:function(){var e=this;this.$form=a("#odai"),this.$submit=this.$form.find("input[type=submit]"),this.$period=a("input[name=period]"),this.$dateWrapper=a(".admin-odai-period-date-wrapper"),this.$startDate=a("input[name=start_date]"),this.$endDate=a("input[name=end_date]"),this.$periodError=a(".admin-odai-period-error"),a(".delete-odai").on("submit",(function(){return e.confirmDelete()})),this.$period.on("change",(function(){return e.togglePeriod()})),this.$form.on("change",(function(){return e.validatePeriod()})),this.togglePeriod()},confirmDelete:function(){var e=this.$form.attr("data-odai-title"),t=this.$form.attr("data-odai-id"),n=(0,i.default)("admin-domain")+"/"+t;return window.confirm(r.default.text("admin.odai.delete_odai.confirm",e,n))},togglePeriod:function(){this.$dateWrapper.toggle(this.$period.prop("checked"))},validatePeriod:function(){var e=!this.isPeriodValid();this.$submit.attr("disabled",e),this.$periodError.toggle(e)},isPeriodValid:function(){if(!this.$period.prop("checked"))return!0;var e=new Date(this.$startDate.val()),t=new Date(this.$endDate.val());return isNaN(e)||isNaN(t)||t-e>=0}};e.exports=s},63931:function(e,t,n){n(69826);var r=n(73609),i={init:function(){r("form").submit((function(){r(this).find("input:submit").attr("disabled","disabled")}))}};e.exports=i},3136:function(e,t,n){n(54747),n(91038),n(78783);var r={init:function(){var e=this;document.querySelectorAll(".js-pro-survey-required-checkbox").forEach((function(t){t.addEventListener("change",(function(){e.updateSubmitState()}))})),document.querySelectorAll(".js-pro-survey-required-textarea").forEach((function(t){t.addEventListener("keyup",(function(){e.updateSubmitState()}))})),this.updateSubmitState()},updateSubmitState:function(){var e=Array.from(document.querySelectorAll(".js-pro-survey-required-checkbox")).some((function(e){return e.checked}))||Array.from(document.querySelectorAll(".js-pro-survey-required-textarea")).some((function(e){return""!==e.value}));document.querySelector(".js-pro-survey-submit-button").disabled=!e}};e.exports=r},47814:function(e,t,n){t.__esModule=!0,t.init=void 0;var r=n(99057),i=n(91269);t.init=function(){var e=i.get("eCommerceTransaction");e&&((0,r.pushToDataLayer)(e),(0,r.pushToDataLayer)({event:"submitECommerceTransaction"}))}},84032:function(e,t,n){var r=a(n(67294)),i=n(73380),o=a(n(71617));function a(e){return e&&e.__esModule?e:{default:e}}var s=n(91269),u={init:function(){var e=s.get("pro.registerCardUrlBase"),t=s.get("pro.redirectUrl"),n=s.get("pro.registeredCard"),a=s.get("pro.expiresOn"),u={durationDays:s.get("pro.durationDays"),label:s.get("pro.courseLabel"),name:s.get("pro.courseName"),price:s.get("pro.price"),isCampaign:s.get("pro.isCampaign")},l=s.get("pro.availableCourses"),c=s.get("pro.migrateVia");(0,i.safeRender)(r.default.createElement(o.default,{registerCardUrlBase:e,redirectUrl:t,registeredCard:n,expiresOn:a,initialCourse:u,availableCourses:l,migrateVia:c}),document.querySelector("main"))}};e.exports=u},60680:function(e,t,n){var r=a(n(67294)),i=n(73380),o=a(n(30044));function a(e){return e&&e.__esModule?e:{default:e}}var s=n(91269),u={init:function(){var e=s.get("pro.registerCardUrlBase"),t=s.get("pro.redirectUrl"),n=s.get("pro.registeredCard"),a={durationDays:s.get("pro.currentCourseDurationDays"),label:s.get("pro.currentCourseLabel"),name:s.get("pro.currentCourseName"),price:s.get("pro.currentCoursePrice"),isCampaign:s.get("pro.currentCourseIsCampaign"),pricePerDay:s.get("pro.currentCoursePricePerDay")},u={durationDays:s.get("pro.destinationCourseDurationDays"),label:s.get("pro.destinationCourseLabel"),name:s.get("pro.destinationCourseName"),price:s.get("pro.destinationCoursePrice"),isCampaign:s.get("pro.destinationCourseIsCampaign"),pricePerDay:s.get("pro.destinationCoursePricePerDay")},l=s.get("pro.expiresOn"),c=s.get("pro.migrateVia"),d=s.get("pro.daysUntilExpiration"),f=s.get("pro.unusedAmount"),p=s.get("pro.daysToExtend"),h=s.get("pro.newExpiresOn"),m=s.get("pro.courseStructureVersion");(0,i.safeRender)(r.default.createElement(o.default,{registerCardUrlBase:e,redirectUrl:t,registeredCard:n,currentCourse:a,destinationCourse:u,expiresOn:l,migrateVia:c,daysUntilExpiration:d,unusedAmount:f,daysToExtend:p,newExpiresOn:h,courseStructureVersion:m}),document.querySelector("main"))}};e.exports=u},98924:function(e,t,n){var r=a(n(67294)),i=n(73380),o=a(n(73722));function a(e){return e&&e.__esModule?e:{default:e}}var s=n(91269),u={init:function(){var e=s.get("pro.expiresOn"),t=s.get("pro.joinPlusUrl"),n={durationDays:s.get("pro.durationDays"),label:s.get("pro.courseLabel"),name:s.get("pro.courseName"),price:s.get("pro.price"),isCampaign:s.get("pro.isCampaign")},a=s.get("pro.tier"),u=s.get("pro.registeredCard"),l=s.get("pro.registerCardUrlBase"),c=s.get("pro.redirectUrl");(0,i.safeRender)(r.default.createElement(o.default,{actionPath:"/-/pro/resume",confirmFormId:"pro-form-confirm-will-resume",startProFormId:"pro-form-will-resume",registeredCard:u,course:n,tier:a,expiresOn:e,shouldShowFirstPaymentOn:!1,joinPlusUrl:t,registerCardUrlBase:l,redirectUrl:c,landingPagePath:void 0}),document.querySelector("main"))}};e.exports=u},97812:function(e,t,n){var r=a(n(67294)),i=n(73380),o=a(n(73722));function a(e){return e&&e.__esModule?e:{default:e}}var s=n(91269),u={init:function(){var e=s.get("pro.isChangingCourse"),t=e?"/-/pro/change_course":"/-/pro/start",n=e?"pro-form-confirm-will-change-course":"pro-form-confirm-will-start",a=e?"pro-form-will-change-course":"pro-form-will-start",u=s.get("pro.expiresOn"),l=s.get("pro.shouldShowFirstPaymentOn"),c=s.get("pro.firstPaymentOn"),d=s.get("pro.joinPlusUrl"),f={durationDays:s.get("pro.durationDays"),label:s.get("pro.courseLabel"),name:s.get("pro.courseName"),price:s.get("pro.price"),isCampaign:s.get("pro.isCampaign")},p=s.get("pro.tier"),h=s.get("pro.registeredCard"),m=s.get("pro.registerCardUrlBase"),v=s.get("pro.redirectUrl"),g=s.get("pro.landingPagePath"),b=s.get("pro.plusVia"),y=s.get("pro.plusViaTerm"),_=s.get("pro.courseStructureVersion");(0,i.safeRender)(r.default.createElement(o.default,{courseStructureVersion:_,actionPath:t,confirmFormId:n,startProFormId:a,registeredCard:h,course:f,tier:p,expiresOn:u,shouldShowFirstPaymentOn:l,firstPaymentOn:c,joinPlusUrl:d,registerCardUrlBase:m,redirectUrl:v,landingPagePath:g,plusVia:b,plusViaTerm:y}),document.querySelector("main"))}};e.exports=u},86968:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880);var r,i=(r=n(57942))&&r.__esModule?r:{default:r},o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(55992));function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u=n(73609),l=n(13469),c=n(17187).EventEmitter,d=n(91269),f=function(e){var t,n;function r(){return e.apply(this,arguments)||this}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,s(t,n);var o=r.prototype;return o.setState=function(e){this.state=e,this.emit("change",this.state)},o.saveTask=function(e,t){var n=this;return u.ajax({url:"../task/"+e+"/save",method:"POST",data:{value:t?1:0,rkm:(0,i.default)("rkm"),rkc:(0,i.default)("rkc")}}).done((function(e){n.setState(e)}))},r}(c),p=function(e,t){var n=this;this.series=e,u("input").on("change",(function(e){var t=u(e.target);n.series.saveTask(t.attr("data-task-id"),t.is(":checked"))})),this.series.on("change",(function(e){t.render(e)}))},h=function(){function e(){}var t=e.prototype;return t.render=function(e){var t=u(".challenge-indicator-gauge"),n=u(".achieved-count"),r=e.user_status,i=e.achieved_rate+"%";t.css({width:i}),n.text(i),u(".js-user-title").text(r.title),u(".js-user-level").text(r.level),u(".js-user-point").text(r.point),u(".js-user-achieved-count").text(r.achieved_tasks_count),u(".js-challenge-status").removeClass("is-bronze").removeClass("is-silver").removeClass("is-gold"),u(".js-rank-label").text(""),r.rank&&(u(".js-challenge-status").addClass("is-"+r.rank),u(".js-rank-label").text("("+r.rank+")")),100===e.achieved_rate?(u(".js-congratulations").show(),document.body.style.backgroundImage="url('"+o.staticUrl("/images/special/challenge/kira-bg.jpg")+"')"):(u(".js-congratulations").hide(),document.body.style.backgroundImage=""),this.setSocialURLs(e.links)},t.setSocialURLs=function(e){u(".js-post-completed-to-blog").attr({href:e.post_completed_to_blog_link}),u(".js-post-completed-to-twitter").attr({href:e.post_completed_to_twitter_link}),u(".js-post-name-to-twitter").attr({href:e.post_name_to_twitter_link})},e}(),m=function(e){var t=u(window);t.on("load scroll",l.throttle((function(){var n={isFixed:t.scrollTop()>1e3};e.render(n)}),100))},v=function(){function e(){this.$challengeStatus=u(".l-challenge-status")}return e.prototype.render=function(e){e.isFixed?this.$challengeStatus.addClass("is-fixed"):this.$challengeStatus.removeClass("is-fixed")},e}(),g={init:function(){var e=new f,t=new h,n=(new p(e,t),d.get("blogChallenge"));e.setState(n);var r=new v;new m(r)}};e.exports=g},57005:function(e,t,n){var r,i=(r=n(83092))&&r.__esModule?r:{default:r};var o=n(73609),a={init:function(){new i.default(o("#topic-entries-tabs"),0)}};e.exports=a},95974:function(e,t,n){var r=n(36500),i={init:function(){r.listenToParent(),r.send("delete")}};e.exports=i},52163:function(e,t,n){var r=n(36500),i={init:function(){r.listenToParent()}};e.exports=i},99352:function(e,t,n){var r=n(36500),i={init:function(){r.listenToParent();var e=document.getElementById("posted").value;r.send("update",{comment:e}),r.send("close")}};e.exports=i},12412:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.default=void 0,n(21249),n(68309);var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),o=(r=n(20996))&&r.__esModule?r:{default:r};function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var l=function(e){var t,n;function r(t){var n;return(n=e.call(this,t)||this).state={checked:!1,confirmBlogURL:""},n.onClickCheckBox=n.onClickCheckBox.bind(s(n)),n.inputURLBox=n.inputURLBox.bind(s(n)),n.validateButtonDisabled=n.validateButtonDisabled.bind(s(n)),n}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,u(t,n);var a=r.prototype;return a.render=function(){var e=this.validateButtonDisabled();return i.createElement("form",{action:this.props.postURL,method:"post",id:"blog-delete"},i.createElement("table",{className:"table"},i.createElement("tr",null,i.createElement("th",null,i.createElement("label",{htmlFor:"id"},o.default.text("admin.blog.config.id"))),i.createElement("td",null,i.createElement("a",{href:this.props.blogURI,target:"_blank",rel:"noopener noreferrer"},this.props.blogHost))),i.createElement("tr",null,i.createElement("th",null,o.default.text("admin.blog.config.name")),i.createElement("td",null,this.props.blogName)),i.createElement("tr",null,i.createElement("th",null,o.default.text("admin.blog.config.description")),i.createElement("td",null,this.props.blogDescription)),this.checkEntryCount(),this.checkTotalDays(),this.checkSubscribers(),i.createElement("tr",null,i.createElement("th",null,o.default.text("admin.config_delete.why.textarea")),i.createElement("td",null,i.createElement("p",{className:"admin-p"},o.default.text("admin.config_delete.why")),i.createElement("textarea",{name:"blog_delete_reason",rows:5,cols:50}))),i.createElement("tr",null,i.createElement("th",{rowSpan:2},o.default.text("admin.config_delete.confirm_blog"),i.createElement("small",{className:"confirm-required-label"},o.default.text("admin.config_delete.confirm_required"))),i.createElement("td",null,i.createElement("p",null,o.default.text("admin.config_delete.confirm_notice")),i.createElement("label",null,i.createElement("input",{type:"checkbox",checked:this.state.checked,onChange:this.onClickCheckBox}),o.default.text("admin.config_delete.confirm_agreement")))),i.createElement("tr",null,i.createElement("td",null,i.createElement("p",null,o.default.text("admin.config_delete.confirm_blog_url")),i.createElement("div",null,i.createElement("input",{placeholder:this.props.blogHost,type:"text",value:this.state.confirmBlogURL,onChange:this.inputURLBox,size:50}))))),this.checkProStatus(),i.createElement("div",{className:"blog-delete-submit"},i.createElement("button",{type:"submit",id:"delete-button",disabled:!e,className:"btn btn-danger"},o.default.text("delete")),i.createElement("button",{type:"button",className:"btn"},o.default.text("cancel")),i.createElement("input",{type:"hidden",name:"rkm",value:this.props.rkm}),i.createElement("input",{type:"hidden",name:"rkc",value:this.props.rkc})))},a.checkEntryCount=function(){var e=this.props.blogEntryCount;if(e>=1)return i.createElement("tr",{"data-test":"entry-count"},i.createElement("th",null,o.default.text("blog_entry_number")),i.createElement("td",null,o.default.textN("unit_entry",e,e)))},a.checkTotalDays=function(){var e=this.props.blogTotalDays;if(e)return i.createElement("tr",{"data-test":"total-days"},i.createElement("th",null,o.default.text("blog_total_days.20200528")),i.createElement("td",null,o.default.textN("unit_day",e,e)))},a.checkSubscribers=function(){var e=this.props.blogSubscribers;if(e.length>=1)return i.createElement("tr",{"data-test":"subscribers"},i.createElement("th",null,o.default.text("epic.subscriber")),i.createElement("td",null,i.createElement("div",{className:"info"},i.createElement("span",{className:"subscription-count"},o.default.textN("unit_person",e.length,e.length)),e.map((function(e,t){return i.createElement("a",{href:e.blogURL,key:e.blogURL},i.createElement("img",{src:e.iconURL,width:16,height:16,alt:e.name,title:e.name,"data-test":"icon-"+t}))})))))},a.checkProStatus=function(){if(this.props.proStatusCanRequestCancel)return i.createElement("aside",{className:"error-box delete-pro-notice",id:"plus-message"},i.createElement("h3",null,o.default.text("admin.blog.plus.notice")),i.createElement("p",{"data-pro-quit-link":this.props.proStatusCancelRequestURL},o.default.text("admin.blog.config.confirm.delete_pro_notice_with_url")),i.createElement("p",null,i.createElement("a",{href:this.props.proStatusCancelRequestURL,className:"btn"},o.default.text("admin.leave_plus"))))},a.onClickCheckBox=function(e){this.setState({checked:e.currentTarget.checked})},a.inputURLBox=function(e){this.setState({confirmBlogURL:e.currentTarget.value})},a.validateButtonDisabled=function(){var e=this.props.blogHost;return this.state.confirmBlogURL===e&&this.state.checked},r}(i.Component);t.default=l},64007:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.init=void 0;var r=l(n(67294)),i=n(73380),o=l(n(57942)),a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=u(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(55992)),s=l(n(12412));function u(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(u=function(e){return e?n:t})(e)}function l(e){return e&&e.__esModule?e:{default:e}}var c=n(91269);t.init=function(){var e=a.httpsAdminUserBlogUrl("/config/delete"),t=(0,o.default)("blog-host"),n=(0,o.default)("blog-uri"),u=(0,o.default)("blog-name"),l=c.get("blog.description"),d=c.get("blog.entrycount"),f=c.get("blog.totaldays"),p=c.get("blog.subscribers"),h=c.get("pro_status.can_request_cancel"),m=c.get("pro_status.cancel_request_url"),v=(0,o.default)("rkc"),g=(0,o.default)("rkm");(0,i.safeRender)(r.default.createElement(s.default,{postURL:e,blogHost:t,blogURI:n,blogName:u,blogDescription:l,blogEntryCount:d,blogTotalDays:f,blogSubscribers:p,proStatusCanRequestCancel:h,proStatusCancelRequestURL:m,rkc:v,rkm:g}),document.querySelector("#confirm-deleting-blog-form"))}},85407:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),n(4723),n(74916),n(69600),n(69826),n(73210),n(15306),n(54747);var r=C(n(73609)),i=n(13469),o=C(n(20996)),a=C(n(44878)),s=C(n(83092)),u=C(n(46658)),l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=S(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(26410)),c=C(n(57942)),d=C(n(60717)),f=C(n(28461)),p=C(n(67089)),h=C(n(24634)),m=C(n(71637)),v=C(n(42114)),g=C(n(36532)),b=C(n(44474)),y=C(n(36384)),_=C(n(61030)),w=C(n(3147)),E=C(n(2101));function S(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(S=function(e){return e?n:t})(e)}function C(e){return e&&e.__esModule?e:{default:e}}var k={init:function(){var e=(0,r.default)("#css"),t=(0,r.default)("#form-design"),n=(0,r.default)("#preview"),i=(0,r.default)("#preview-loading"),o=(0,r.default)("#tabs"),s=(0,r.default)("#form-design-fold-button"),u=new a.default(t),l=new v.default({$form:t,$preview:(0,r.default)("#preview-iframe"),$loading:i,formState:u});l.requestPreview(),t.on("change",(function(){l.requestPreview()})),f.default.init(),k.setupTabs({$tabs:o,previewUpdater:l}),k.setupFoldButton({$form:t,$preview:n,$foldButton:s}),k.setupPreviewTypeButton(l),["header-html","entry-header-html","entry-footer-html","footer-html","header-touch-html","entry-touch-header-html","entry-touch-footer-html","footer-touch-html","touch-under-pager-html"].forEach((function(e){var t=':input[name = "'+e+'"]',n=(0,r.default)(t);n.length&&(n.prop("disabled")||k.setupEditor({syntax:"html",$textarea:n}))})),k.setupEditor({syntax:"css",$textarea:e}),k.setupBackgroundComponent({$css:e});var c=new g.default((0,r.default)(".js-header-modal-window")),d=(0,r.default)(".js-design-header .js-header-image-container");0!==d.length&&k.setupHeaderImageComponent({$container:d,previewUpdater:l,trimmingWindow:c}),(0,E.default)({$container:(0,r.default)(".js-design-header-touch .js-header-image-container"),previewUpdater:l}),k.setupEntryComponent();var b=new h.default((0,r.default)(".js-module-edit-modal-window")),y=new m.default;(0,r.default)(b).on("edit-new-module change-category-order-type",(function(){y.updateCategoryPreview()})),["sidebar","top-page-main-column","top-page-header","top-page-sidebar","entry-header","entry-footer-primary","entry-footer-secondary","touch-top-page-header","touch-entry-header","touch-entry-footer-primary","touch-entry-footer-secondary","touch-footer"].forEach((function(e){var n=(0,r.default)('div[data-modules-type="'+e+'"].sidebar-box');if(n.length){var i=new p.default(n,b);(0,r.default)(i).on("updated",(function(){return t.trigger("change")}))}})),k.setupAccordion(".accordion-title");var w=k.updateProfileModule(),S=k.updateCirclesModule();y.updateCategoryPreview(),r.default.when(w,S).always((function(){return u.commit()})),k.setupThemesListSwitcher(),(0,_.default)(),k.setupSeeMoreBackgrounds(),k.setupTouchAccentColor({$form:t})},setupAccordion:function(e){var t=(0,r.default)(e);t.next().hide(),t.click((function(){var e=(0,r.default)(this),t=e.next();t.is(":visible")?(t.hide(),e.removeClass("open")):(t.show(),e.addClass("open"))}))},setupTabs:function(e){var t=e.$tabs,n=e.previewUpdater,i=(0,r.default)("#force-pc-view");if(t[0]){var o=function(e,t){"tab-customize-touch"!==(t.newPanel||t.panel).attr("id")||i.is(":checked")?n.setDeviceAsPC():n.setDeviceAsTouch()};t.on("tabsactivate",o).on("tabscreate",o),i.on("change",(function(){i.is(":checked")?n.setDeviceAsPC():n.setDeviceAsTouch()})).triggerHandler("change"),this.tabs=new s.default(t)}},setupFoldButton:function(e){var t=e.$form,n=e.$preview,r=e.$foldButton;r[0]&&r.click((function(){r.hasClass("open")?(r.removeClass("open").addClass("close"),t.hide(),n.addClass("fold-form")):(r.removeClass("close").addClass("open"),t.show(),n.removeClass("fold-form"))}))},fadeInLoading:function(e){e.fadeIn("fast")},fadeOutLoading:function(e){setTimeout((function(){e.fadeOut("fast")}),1e3)},setupPreviewTypeButton:function(e){var t=(0,r.default)(".switch-button");t.click((function(){"index"===e.getPageType()?(t.addClass("permalink").removeClass("index"),t.text(o.default.text("admin.design.quit_preview_entry_page")),e.setAsPermalinkPreview(),e.preview()):(t.addClass("index").removeClass("permalink"),t.text(o.default.text("admin.design.preview_entry_page")),e.setAsIndexPreview(),e.preview())}))},setupBackgroundComponent:function(e){var t=e.$css,n=(0,r.default)('input[type="file"].background-image'),a=(0,r.default)("#background-image"),s=(0,r.default)("#background-image-thumbnail"),u=(0,r.default)("a.delete-background-image"),l=(0,r.default)('input[name="bg-image-src"]'),c=(0,r.default)('input[name="bg-image-id"]'),f=(0,r.default)('input[name="bg-image-selected"]'),p=(0,i.template)("body{ background-image: url('<%= image %>'); background-repeat: <%= repeat %>; background-color:<%= backgroundColor %>; background-attachment: <%= attachment %>; background-position: <%= position %> top;}"),h=(0,r.default)('select[name="background-position"]'),m=(0,r.default)('select[name="background-repeat"]'),v=(0,r.default)('select[name="background-attachment"]'),g=function(){a.hide()};u.click((function(){return confirm(o.default.text("admin.design.stop_header_image_confirm"))&&(c.val(""),l.val(""),f.val(0),y(),g()),!1})),s.click((function(){(y(),s.hasClass("ui-selected"))||((0,r.default)("#backgrounds li").removeClass("ui-selected"),s.addClass("ui-selected"),f.val(1))})),h.change((function(){y()})),v.change((function(){y()})),m.change((function(){y()}));var b=function(e){c.val(e);var t=e.match(/f:id:([^:]+):(\d+)([jpg]):image/);if(t){var r=t[1],i=t[2],o=t[3],u=[r.substring(0,1),r,i.substring(0,8),i].join("/"),d="https://cdn-ak.f.st-hatena.com/images/fotolife/"+u+{j:".jpg",p:".png",g:".gif"}[o],f="https://cdn-ak.f.st-hatena.com/images/fotolife/"+u+"_120.jpg";if(l.val(d),s.attr("src",f),a.show(),n.prop("disabled",!1),s.trigger("click"),"undefined"!=typeof FormData){var p=n.clone(!0);n.replaceWith(p),n=p}}},y=function(){var e,n,i=l.val(),o=new d.default(t.val());if(i){var a=(0,r.default)("#background-colors li.ui-selected"),s="transparent";0===a.length?(0,r.default)('#background-colors li[data-css=""]').addClass("ui-selected"):void 0!==a.attr("data-id")&&(s="#"+a.attr("data-id")),e="custom";var u=m.find("option:selected").val(),c=h.find("option:selected").val(),f=v.find("option:selected").val();n=p({image:i,backgroundColor:s,repeat:u,position:c,attachment:f})}else e="default",n=(0,r.default)('li[data-id="default"]').attr("data-css");o.setData("background",e,n),t.val(o.getCSS()),t.trigger("change")};"undefined"!=typeof FormData?n.on("change",(function(){this.files.length&&(g(),w.default.uploadImage({file:this,folder:"Hatena Blog",fotosize:3e3,$input:n,callback:b}))})):w.default.setIframeUploader({$fileinput:n,fotosize:3e3,callback:b})},setupHeaderImageComponent:function(e){var t=e.$container,n=e.previewUpdater,i=e.trimmingWindow,a={width:+t.attr("data-max-width"),height:+t.attr("data-max-height")},s=new b.default(t,a),u=new y.default(t.find(".js-header-image-item"));(0,r.default)(s).on("updated",(function(){s.getImageSrc()?u.render(s.getImageSrc(),s.getThumbnailSrc(),s.getDisplayArea()):s.getImageSrc()||u.clear(),n.requestPreview()})),w.default.init({$input:t.find(".js-header-image-input"),size:a.width}).progress((function(e){s.setImage(e.url,e.fid),i.trim(s.getImageSrc(),s.getTrimmingArea()).always((function(e){s.setDisplayArea(e)}))})),t.on("click",".js-header-image-thumbnail, .jcrop-holder, .js-resizer",(function(){return i.trim(s.getImageSrc(),s.getTrimmingArea()).done((function(e){s.setDisplayArea(e)})),!1})).on("click",".js-delete-header-image",(function(){return!!confirm(o.default.text("admin.design.stop_header_image_confirm"))&&(s.clear(),!1)}))},setupEntryComponent:function(){(0,r.default)(".js-variable-toggle").click((function(){return(0,r.default)(this).parents(".custom_html_section").find(".js-variable-help").slideToggle(),!1}))},updateProfileModule:function(){var e=r.default.Deferred();return r.default.ajax({type:"GET",url:"/api/applications_data",dataType:"json"}).done((function(t){var n=t;(0,r.default)(".js-module-value-component-profile").each((function(e,t){var i=(0,r.default)(t);n.twitter?i.find(".cannot-twitter-button").remove():(i.find(".can-twitter-button").remove(),i.find(".cannot-twitter-button").removeClass("cannot-twitter-button").addClass("cannot-twitter-button-display")),n.facebook?i.find(".cannot-facebook-follow").remove():(i.find(".can-facebook-follow").remove(),i.find(".can-facebook-subscribe").remove(),i.find(".note").remove(),i.find(".cannot-facebook-follow").removeClass(".cannot-facebook-follow").addClass(".cannot-facebook-follow-display"))})),e.resolve()})).fail((function(){e.reject()})),e.promise()},updateCirclesModule:function(){var e=r.default.Deferred();return 0===(0,r.default)("#module-value-component-circles").length?(e.resolve(),e.promise()):(r.default.ajax({type:"GET",url:"/api/circles",data:{blog:(0,c.default)("blogs-uri-base")},dataType:"json"}).done((function(t){var n=(0,i.template)((0,r.default)(".js-module-circles-select-circles-template").html().replace(/^\s+|\s+$/g,""));t.circles.forEach((function(e){(0,r.default)(".js-select-circles-container").each((function(t,i){(0,r.default)(i).append((0,r.default)(n({circle:e})))}))})),e.resolve()})).fail((function(){e.reject()})),e.promise())},setupEditor:function(e){var t=e.syntax,n=e.$textarea;if(n[0]){var i=document.createElement("div");(0,r.default)(i).css({position:"absolute",top:"auto",left:0,bottom:50,padding:0,margin:0,borderTop:"1px solid #ccc",borderBottom:"1px solid #ccc",width:"500px",height:"400px",zIndex:9999,background:"#fff"}).appendTo(document.body).hide(),n.css({"font-size":"14px","white-space":"nowrap",overflow:"hidden"});var o=ace.edit(i);o.commands.removeCommand("gotoline"),o.commands.removeCommand("indent"),o.commands.removeCommand("outdent"),o.commands.removeCommand("find"),o.renderer.setHScrollBarAlwaysVisible(!1),o.renderer.setPadding(5),o.renderer.setShowPrintMargin(!1),o.setFontSize("10px"),o.setHighlightActiveLine(!1),ace.require("ace/config").set("workerPath",(0,c.default)("admin-domain")+"/js/external/ace-builds");var a=o.getSession();if(a.setUseWrapMode(!0),"css"!==t){var s=new(0,ace.require("ace/mode/"+t).Mode);a.setMode(s)}var l=new u.default;n.focus((function(){(0,r.default)(i).show(),o.resize(),o.focus(),l.enable()})),o.on("blur",(function(){n.val(a.getValue()),n.trigger("change"),(0,r.default)(i).hide(),l.disable()})),(0,r.default)(i).mousedown((function(){return!1})),a.setValue(n.val()),n.change((function(){a.setValue(n.val())})),(0,r.default)("#tabs").on("tabsactivate",(function(){setTimeout((function(){o.resize()}),0)})),(0,r.default)(window).resize((function(){o.resize()}))}},setupThemesListSwitcher:function(){(0,r.default)(".switch-theme-list-types").on("blog:dropdown:selected","[data-theme-list-type]",(function(){var e=(0,r.default)(this).attr("data-theme-list-type");(0,r.default)("#themes .themes-container").each((function(){(0,r.default)(this).toggle((0,r.default)(this).attr("data-theme-list-type")===e)}))}));var e=(0,r.default)(".dropdown-container"),t=e.find(".dropdown-list").hide();e.on("click",".dropdown-button, .dropdown-selected",(function(){var e=l.toggle(t);return t.toggleClass("opened",e),!1})).on("click",".dropdown-list-item",(function(){e.find(".dropdown-selected").text((0,r.default)(this).text()),(0,r.default)(this).trigger("blog:dropdown:selected")})).find(".dropdown-list-item").eq(0).click()},setupSeeMoreBackgrounds:function(){var e=(0,r.default)(".js-show-more-background-images");e.one("click",(function(){e.remove(),(0,r.default)("#backgrounds li:hidden").show()}))},setupTouchAccentColor:function(e){var t=e.$form,n=t.find(':input[name="touch-accent-color"]'),i=(0,r.default)("#touch-accent-colors"),o=function(e){i.find(".selected").removeClass("selected"),e.addClass("selected");var r=e.attr("data-color");n.val(r),t.trigger("change")};i.on("click","[data-color]",(function(){o((0,r.default)(this))}));var a=n.val();o(i.find('[data-color="'+a+'"]'))}};e.exports=k},38703:function(e,t,n){t.__esModule=!0,t.init=void 0,n(69826);var r,i=(r=n(73609))&&r.__esModule?r:{default:r};var o=n(1780);t.init=function(){(0,i.default)(".main-tab").find(".user-blog-config-detail").addClass("current-tab");var e=(0,i.default)(".js-blog-config-detail-form");e.on("submit",(function(){o(e)})),(0,i.default)("#blog-config-custom-domain .check-validity").click((function(e){var t=(0,i.default)(this);return t.attr("disabled","disabled").addClass("disabled"),(0,i.default)("#blog-config-custom-domain .validity-status").text("-"),i.default.ajax({type:"POST",url:"/api/custom_domain.check",data:t.closest("form").serialize(),dataType:"json",success:function(e){(0,i.default)("#blog-config-custom-domain .validity-status").text(e.message),(0,i.default)("#blog-config-custom-domain .validity-status.detail").text(e.detail||"")},complete:function(){t.removeAttr("disabled").removeClass("disabled")}}),!1}));var t=document.querySelector('input[name="custom-domain_https_confirmation-checkbox"]');if(t){var n=document.querySelector("#custom_host");if(!n)throw new Error("[BUG] custom_host input not found");t.addEventListener("change",(function(e){n.disabled=!e.target.checked}))}}},24460:function(e,t,n){var r=n(73609),i={init:function(){this.setupResetButton()},setupResetButton:function(){var e=r("#reset-entry-directory"),t=r("#entry-directory-input");e.on("click",(function(){return t.val("entry")}))}};e.exports=i},41145:function(e,t,n){var r=n(37914),i={init:function(){var e=r.param("with_parent_window"),t=r.param("callback");e&&t&&window.close()}};e.exports=i},56870:function(e,t,n){var r=n(55248),i=n(73609),o={init:function(){new r.BlogPermission(i("#blog-permission-container"))}};e.exports=o},47405:function(e,t,n){n(69826);var r=n(73609),i={init:function(){var e=r("#theme-preview-form"),t=r("#theme-install-form"),n=t.find(".notice").text();t.on("submit",(function(){return confirm(n)})),e.submit()}};e.exports=i},64059:function(e,t,n){n(69826);var r=n(67677),i=n(73609),o=n(36500),a=n(93687),s=n(8659),u=n(26028),l=n(49634),c={init:function(){o.listenToParent();var e=document.getElementById("js-posted");if(e){var t=e.value;o.send("update",{entry:t})}setTimeout((function(){i("form").each((function(e,t){var n=i(t),r=n.find("input[type=submit]");n.removeClass("unedited"),r.removeAttr("disabled")}))}),1e3),s();new u(i(".js-socialize-modal"));this.initializeTwitter(),a.setup(i(".js-socialize-box").data("entry-id"),this.initializeTwitter),i(document).on("click",".js-official-share-button",(function(e){var t=i(e.currentTarget).attr("href");return new l(t,550,450,screen.width,screen.height),!1}))},initializeTwitter:function(){var e=i(".js-twitter-share-form"),t=i(".js-socialize-box").data("entry-id"),n=i(".js-share-success-message"),o=i(".js-tweet-posted");new r.TwitterShareForm(e,n,o,t)}};e.exports=c},34174:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880);var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=i(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=o?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(96337));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(i=function(e){return e?n:t})(e)}var o={init:function(){var e=document.querySelector("#uploader-container");r.init(e)}};e.exports=o},54385:function(e,t,n){n(69826);var r=n(73609),i=n(39338),o={init:function(){var e=r("#import-hatena_diary-progress"),t=e.find(".bar");if(e[0]&&t[0]){var n=e.attr("data-progress-api"),o=e.attr("data-diary-page");i.init(t,n,o)}}};e.exports=o},79997:function(e,t,n){n(69826);var r=n(73609),i=n(39338),o={init:function(){var e=r("#import-hatena_diary-progress"),t=e.find(".bar");if(e[0]&&t[0]){var n=e.attr("data-progress-api"),o=e.attr("data-diary-page");i.init(t,n,o)}}};e.exports=o},93841:function(e,t,n){t.__esModule=!0,t.init=void 0;var r,i=(r=n(20996))&&r.__esModule?r:{default:r};t.init=function(){document.querySelector(".js-yahoo-import-password-copy-button").addEventListener("click",(function(e){var t=document.getElementsByClassName("js-yahoo-import-password")[0],n=document.createRange();n.selectNodeContents(t),window.getSelection().removeAllRanges(),window.getSelection().addRange(n),document.execCommand("copy"),window.getSelection().removeAllRanges(),alert(i.default.text("epic.yahoo_import_password_copied"))}))}},45348:function(e,t,n){var r=n(36500),i=n(67279),o={init:function(){r.listenToParent(),i(),r.send("done")}};e.exports=o},52943:function(e,t,n){n(69600);var r,i=(r=n(57942))&&r.__esModule?r:{default:r};var o=n(73609),a=n(92901),s={init:function(){var e=o(".js-hatena-follow-button-box"),t={isSubscribing:e.data("is-subscribing"),isGuest:!((0,i.default)("rkm")&&(0,i.default)("rkc"))},n=(0,i.default)("blog-uri"),r=(0,i.default)("blog-host"),s={subscribersCount:parseInt(e.data("subscribers-count"),10),blogName:(0,i.default)("blog-name"),blogUrl:n,requestUrl:[(0,i.default)("admin-domain"),(0,i.default)("author"),r,"subscribe"].join("/")};new a.Admin(e,t,s)}};e.exports=s},18695:function(e,t,n){n(69826);var r,i=n(91298),o=(r=n(83092))&&r.__esModule?r:{default:r};var a=n(73609),s={init:function(){var e=a("#access-counts").remove(),t={};e.find("tr").each((function(){var e=a(this),n=+e.find("td[data-time]").attr("data-time"),r=+e.find("td[data-count]").attr("data-count");t[n]=r})),i.AccessLogViewer.showGraph(t,{parent:a("#access-counts-daily"),timeformat:"%m/%d",minTickSize:[1,"day"],unit:864e5,number:31}),i.AccessLogViewer.showGraph(t,{parent:a("#access-counts-hourly"),timeformat:"%d %H:%M",minTickSize:[1,"hour"],unit:36e5,number:48});new o.default(a("#access-counts-tabs")),new o.default(a("#summary-detail-tabs"));a(".summary-box .hosts").delegate(".host","click",(function(){a(".summary-box .hosts .selected").removeClass("selected"),a(this).addClass("selected");var e=a(this).attr("data-site-host");return a(".summary-box .site.selected").removeClass("selected"),a(".summary-box .sites").find('*[data-site-host="'+e+'"]').addClass("selected"),!1}))}};e.exports=s},46292:function(e,t,n){var r=n(52841),i={init:function(){var e=document.querySelector(".js-rules-container");r.init(e)}};e.exports=i},24166:function(e,t,n){n(15306),n(74916);var r=n(73609),i=n(26410),o={init:function(){var e=this;r(document).on("click",".js-show-edit-modal-window",(function(t){var n=r(t.target).attr("data-category-name");e.openModal(n)})),r(".js-modal-window .js-icon-close").on("click",(function(){i.hideAll()})),r(".js-modal-window").on("click",(function(e){e.stopPropagation()}))},openModal:function(e){var t=r('.js-edit-modal-window[data-category-name="'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"]');t.is(":visible")||i.show(t,{})}};e.exports=o},76674:function(e,t,n){var r,i=(r=n(73609))&&r.__esModule?r:{default:r};var o=n(36500),a=n(67279),s=n(1780),u={init:function(){o.listenToParent(),u.focusTextArea(),(0,i.default)(".g-recaptcha").length>0?o.send("resize",{height:490}):a();var e=(0,i.default)("form#comment-form");e.on("submit",(function(){s(e)}))},focusTextArea:function(){try{(0,i.default)("#body").focus()}catch(e){setTimeout(u.focusTextArea,100)}}};e.exports=u},80185:function(e,t,n){var r=n(3869),i={init:function(){r.init()}};e.exports=i},68440:function(e,t,n){n(69826);var r,i=(r=n(20996))&&r.__esModule?r:{default:r},o=n(43652),a=n(99303),s=n(76728),u=n(45241),l=n(16686),c=n(57525);var d=n(73609),f=n(41960),p=n(36500),h=n(81191),m=n(44878),v=n(1780),g=n(93687),b={init:function(){(0,o.isIframe)(window)&&(p.listenToParent(),p.send("ready"));var e=d("#title"),t=d("#character-count"),n=d("#edit-form"),r=new m(n);n.on("backup-restore",(function(){return r.commit()}));var b=(0,a.createEditor)(n),y=document.getElementById("tag-editor-root");y&&(0,l.initTagEditor)(y,document.getElementById("editor-main")),b.on("saveDraft",(function(){r.commit(),p.send("change",!1)})),b.on("initialize",(function(){r.commit(),b.focus(),b.bind("change",(function(){var e=b.getCharacterCount();t.text(i.default.textN("edit_form.character_count_unit",e,e)),(0,o.isIframe)(window)&&p.send("change",r.isWatching&&r.hasFormChanged())})),e.on("keydown",(function(e){if("RET"===f(e))return b.focus(),!1})),b.$form.on("submit",(function(){var e=b.$form.find(":submit");if(b.getByteCount()>655360)return b.$form.addClass("unedited"),e.attr("disable","disable"),b.bind("change",(function(){b.$form.removeClass("unedited"),e.removeAttr("disable")})),window.alert(i.default.text("edit_form.body_length_exceeded_error")),!1;v(d(b.$form)),(0,o.isIframe)(window)&&p.send("change",!1)}));var n=new s.EmbedBox({editor:b,$container:d(".js-editor-embed-box")});b.on("paste-url",(function(e){if(n.isEnabledOnPasteURL()){n.setURL(e);var t=n.show();n.requestPreview(),t.fail((function(){return b.insert(e)})),h.trackEvent("EmbedBox.showFromPaste")}else b.insert(e)}));var a=new u.EmbedBoxFotoCaption({editor:b,$container:d(".js-editor-embed-box-foto-caption")});b.on("paste-foto",(function(e){var t=e.syntax,n=e.onSuccess,r=e.thumbnailUrls,i=e.isUploadError,o=t;a.setFotoExpression(o),a.setThumbnailUrls(r),a.show(i).then((function(){return n()})),h.trackEvent("EmbedBoxFotoCaption.showFromPaste")})),g.setup()})),c.YouTubeEmbed.init()}};e.exports=b},87025:function(e,t,n){n(69600),n(88674),n(41539);var r,i,o=u(n(57942)),a=u(n(347)),s=n(70879);function u(e){return e&&e.__esModule?e:{default:e}}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e){e.RUNNING="running",e.COMPLETED="completed",e.NOT_CREATED="not-created",e.INIT="init"}(r||(r={})),function(e){e.COMPLETED="EXPORT_IS_COMPLETED",e.NOT_FINISH_YET="EXPORT_HAS_NOT_FINISH_YET",e.RUNNING="EXPORT_IS_RUNNING"}(i||(i={}));var c=function(){function e(e){l(this,"getExportStatusURL",void 0),l(this,"reserveURL",void 0),l(this,"container",void 0),l(this,"panels",void 0),l(this,"reserveCompletedAt",void 0),l(this,"statusToSelector",void 0),l(this,"reserveCompletedAtText",void 0),l(this,"successMessage",void 0),l(this,"date",null),l(this,"status",r.INIT),this.getExportStatusURL=e.getExportStatusURL,this.reserveURL=e.reserveURL,this.container=e.container,this.panels=e.panels,this.statusToSelector=e.statusToSelector,this.reserveCompletedAt=e.reserveCompletedAt,this.reserveCompletedAtText=e.reserveCompletedAtText,this.successMessage=e.successMessage}var t=e.prototype;return t.fetchStatus=function(){var e=this;a.default.get(this.getExportStatusURL).then((function(t){t.data.status===i.COMPLETED?(e.date=t.headers["last-modified"],e.status=r.COMPLETED):t.data.status===i.RUNNING?(e.date=null,e.status=r.RUNNING,setTimeout((function(){e.fetchStatus()}),1e3)):(e.date=null,e.status=r.NOT_CREATED),e._updated()})).catch((function(e){(0,s.BUG)(e)}))},t.reserveExport=function(){var e=this;this._post(this.reserveURL).then().catch().then((function(){e.fetchStatus(),e.status=r.RUNNING,e._updated()}))},t.getStatus=function(){return this.status},t.getDate=function(){var e=this.date;if(!e)return null;var t=Date.parse(e);if(isNaN(t))return null;var n=new Date(t);return[n.getFullYear(),n.getMonth()+1,n.getDate()].join("/")},t._post=function(e){var t=(0,o.default)("rkm"),n=(0,o.default)("rkc");if(!t||!n)return Promise.reject("Failed to retrieve credentials");var r=new FormData;return r.append("rkm",t),r.append("rkc",n),a.default.post(e,r)},t._showReserveCompletedAt=function(){this.reserveCompletedAt.textContent=this.getDate(),""===this.reserveCompletedAt.textContent?this.reserveCompletedAtText.style.display="none":this.reserveCompletedAtText.style.display="inline"},t._updated=function(){var e=this.getStatus();if(this.panels.style.display="none",e!==r.INIT){var t=this.container.querySelector(this.statusToSelector[e]);if(t instanceof HTMLElement)if(t.style.display="block",this._showReserveCompletedAt(),e===r.COMPLETED){var n=this.container.querySelector(this.statusToSelector.running);if(!(n instanceof HTMLElement))return;n.style.display="none"}else this.successMessage.style.display="none"}},e}(),d={init:function(){var e,t=document.querySelector(".js-export-wrapper");if(null!==t){var n=t.querySelector(".js-export-control-panel"),i=t.querySelector(".js-reserve-completed-at"),o=t.querySelector(".js-reserve-completed-at-text"),a=t.querySelector(".js-reserve-export-button"),u=t.querySelector(".js-re-reserve-export-button"),l=document.querySelector(".js-export-success-message"),d=t.getAttribute("data-get-export-status-url");if(null!==d&&""!==d){var f=((e={})[r.COMPLETED]=".js-export-completed-wrapper",e[r.NOT_CREATED]=".js-reserve-export-wrapper",e[r.RUNNING]=".js-exporting-wrapper",e),p=new c({container:t,getExportStatusURL:d,panels:n,reserveCompletedAt:i,reserveCompletedAtText:o,reserveURL:t.getAttribute("data-reserve-url"),statusToSelector:f,successMessage:l});a.addEventListener("click",(function(){p.reserveExport()})),u.addEventListener("click",(function(){p.reserveExport()})),p.fetchStatus()}else(0,s.BUG)("download URL not found")}else(0,s.BUG)("container not found")}};e.exports=d},71771:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880);var r=d(n(73609)),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=c(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(55992)),o=n(70879),a=d(n(55431)),s=n(21593),u=n(13118),l=n(90847);function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(c=function(e){return e?n:t})(e)}function d(e){return e&&e.__esModule?e:{default:e}}var f=n(99266),p=n(29130),h=n(34525),m=n(69864),v=n(13794),g=n(10281),b=n(50825),y={init:function(){var e=this,t=new f,n=new p(t),i=new h,o=(new m(i,t),new g,new l.HatenaIdDataList,new b(t),new v(n),new a.default),c=document.querySelector(".js-top-placed-entry-container-set.js-role-permits-top-placed-publication");if(c){var d=new u.TopPlacedEntrySwitcher({controller:o,containerSet:c});new s.TopPlacedActivateButtonsHandler({controller:o,switcherPanel:d,entriesView:n})}(0,r.default)(t).on("permissionChanged",(function(t){var n=t.target.permission;e.replaceURLforPermission(n)})),t.reset()},replaceURLforPermission:function(e){var t;switch(e){case"public":t=i.httpsAdminUserBlogUrl("/entries");break;case"draft":t=i.httpsAdminUserBlogUrl("/drafts");break;case"all":t=i.httpsAdminUserBlogUrl("/entries");break;default:return void(0,o.BUG)(new Error("unexpected permission: "+e))}history.replaceState({permission:e},document.title,t)}};e.exports=y},16566:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.init=void 0,n(69600),n(54747);var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=o(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(347)),i=n(70879);function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(o=function(e){return e?n:t})(e)}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=function(e){var t,n;function o(t,n){var r;return u(a(r=e.call(this)||this),"exportStatusURL",void 0),u(a(r),"reserveURL",void 0),u(a(r),"date",""),u(a(r),"status","not-created"),r.exportStatusURL=t,r.reserveURL=n,r}n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,s(t,n);var l=o.prototype;return l.getStatus=function(){return this.status},l.getDate=function(){var e=this.date,t=Date.parse(e);if(isNaN(t))return null;var n=new Date(t);return[n.getFullYear(),n.getMonth()+1,n.getDate()].join("/")},l.fetchStatus=function(){var e=this;r.default.get(this.exportStatusURL,{headers:{"Cache-Control":"no-cache"}}).then((function(t){"EXPORT_IS_COMPLETED"===t.data.status?(e.date=t.headers["last-modified"]||"",e.status="completed"):"EXPORT_IS_RUNNING"===t.data.status?(e.date="",e.status="running",setTimeout((function(){e.fetchStatus()}),1e3)):(e.date="",e.status="not-created"),e.updated()})).catch((function(e){(0,i.BUG)(e)}))},l.reserveExport=function(){var e=this;r.default.post(this.reserveURL,{},{transformRequest:[r.withEpicRKs,r.formDataRequest]}).then((function(){e.fetchStatus()}),(function(){e.fetchStatus()})),this.status="running",this.updated()},l.updated=function(){this.emit("updated")},o}(n(17187).EventEmitter);t.init=function(){var e=document.querySelector(".js-export-wrapper");if(null!==e){var t=e.querySelectorAll(".js-export-control-panel"),n=e.querySelector(".js-reserve-completed-at"),r=e.querySelector(".js-reserve-export-button"),o=e.querySelector(".js-re-reserve-export-button"),a=document.querySelector(".js-export-success-message"),s=e.getAttribute("data-export-status-url"),u=e.getAttribute("data-reserve-url");if(s&&u){var c={"not-created":".js-reserve-export-wrapper",running:".js-exporting-wrapper",completed:".js-export-completed-wrapper"},d=new l(s,u);r.addEventListener("click",(function(){d.reserveExport()})),o.addEventListener("click",(function(){d.reserveExport()})),d.on("updated",(function(){var r=d.getStatus();t.forEach((function(e){e.style.display="none"})),e.querySelectorAll(c[r]).forEach((function(e){e.style.display="block"})),n.textContent=d.getDate(),a.style.display="completed"===r?"block":"none"})),d.fetchStatus()}else(0,i.BUG)("exportStatusURL or reserveURL not found")}else(0,i.BUG)("container not found")}},34113:function(e,t,n){n(69826);var r,i=(r=n(20996))&&r.__esModule?r:{default:r};var o=n(73609),a=n(39338),s={init:function(){this.initRevertButton(),this.initProgressBar(),this.initToggleFotolifeButton()},initRevertButton:function(){o(".js-revert-import").on("submit",(function(){return confirm(i.default.text("admin.import.undo.confirm"))}))},initProgressBar:function(){var e=o(".js-import-progress");if(e[0]){var t=e.find(".js-import-bar"),n=e.attr("data-api-url"),r=e.attr("data-on-complete-url");a.init(t,n,r)}},initToggleFotolifeButton:function(){o(".js-toggle-fotolife-import-button").on("click",(function(e){o(e.target).closest(".js-user-blog-import-list-item").toggleClass("is-open")}))}};e.exports=s},13027:function(e,t,n){n(69826);var r=n(73609),i={init:function(){r(".js-manage-members-table").on("click",".js-edit-role",(function(){var e=r(this).parents(".js-member-row");e.find(".js-form-member-update").show(),e.find(".js-member-role").hide()})).on("click",".js-edit-cancel",(function(){var e=r(this).parents(".js-member-row");e.find(".js-member-role").show(),e.find(".js-form-member-update").hide()}))}};e.exports=i},18858:function(e,t,n){var r=n(73609),i=n(2521),o=n(13794),a={init:function(){i.setupCloseHandler(),new i(r(".js-pages-edit-dropdown")),new o(r(".js-admin-user-blog-pages")).initEvent()}};e.exports=a},73650:function(e,t,n){var r=n(71900),i=n(73380),o=s(n(67294)),a=s(n(83253));function s(e){return e&&e.__esModule?e:{default:e}}var u={init:function(){var e=document.querySelector("#profile-cards-container");if(a.default.setAppElement(".admin-wrapper"),e){var t=parseInt(e.getAttribute("data-max-author_urls-count")||"",10);(0,i.safeRender)(o.default.createElement(r.ProfileCardsManager,{maxAuthorURLsCount:t}),e)}}};e.exports=u},65641:function(e,t,n){var r=n(17565),i={init:function(){r.ProxyTest.init(document.querySelector("#proxy-test-container"))}};e.exports=i},79923:function(e,t,n){var r=n(73609),i=n(13794),o={init:function(){new i(r(".admin-user-blog-revisions")).initEvent()}};e.exports=o},99907:function(e,t,n){var r=n(73609),i=n(36500),o=n(1780),a=n(67279),s={init:function(){r("#subscribe-form").submit((function(){o(r(this))})),i.listenToParent(),a(),r("section input[type=checkbox]").focus()}};e.exports=s},36783:function(e,t,n){var r,i=(r=n(73609))&&r.__esModule?r:{default:r};var o=n(34418),a={init:function(){var e=(0,i.default)("#subscribers-table-body");o(e)}};e.exports=a},77573:function(e,t,n){n(21249),n(57327),n(91038),n(78783),n(54747);var r,i=n(60361),o=n(9467),a=(r=n(57942))&&r.__esModule?r:{default:r};var s={init:function(){(0,a.default)("blog-is-public")&&s.loadBookmarksAndStars()},loadBookmarksAndStars:function(){var e=document.querySelector("html").getAttribute("data-blog-uuid"),t=document.querySelectorAll(".js-blog-recent-entry"),n=Array.from(t).filter((function(e){return e.hasAttribute("data-public")})).map((function(e){return e.getAttribute("data-uuid")}));i.bookmarkLoader.loadBlogBookmarksCount(e).then((function(e){return e.data.count})).then(s.renderBookmarksIntoOverviewTable),o.starLoader.loadBlogStarsCounts(e).then((function(e){return e.data.total})).then(s.renderStarsIntoOverviewTable),n.length>0&&(i.bookmarkLoader.loadEntriesBookmarksCount(e,n).then((function(e){return e.data.counts})).then(s.renderBookmarksIntoEntriesTable),o.starLoader.loadEntriesStarsCount(e,n).then((function(e){return e.data.counts})).then(s.renderStarsIntoEntriesTable))},renderBookmarksIntoOverviewTable:function(e){document.querySelector(".js-blog-bookmarks-count").textContent=e},renderStarsIntoOverviewTable:function(e){document.querySelector(".js-blog-stars-count").textContent=e},renderBookmarksIntoEntriesTable:function(e){var t={};e.forEach((function(e){t[e.entry_id]=e.count}));var n=document.querySelectorAll(".js-entry-bookmarks-count");Array.from(n).forEach((function(e){var n=t[e.getAttribute("data-entry-uuid")];e.textContent=n}))},renderStarsIntoEntriesTable:function(e){var t={};e.forEach((function(e){t[e.entry_id]=e.stars.total}));var n=document.querySelectorAll(".js-entry-stars-count");Array.from(n).forEach((function(e){var n=t[e.getAttribute("data-entry-uuid")];e.textContent=n}))}};e.exports=s},62536:function(e,t,n){var r=n(36843),i=n(37213),o=s(n(57942)),a=s(n(20996));function s(e){return e&&e.__esModule?e:{default:e}}var u=n(73609),l=n(56412),c=n(36500),d=n(96371),f={init:function(){a.default.setupTimestampUpdater(),r.GlobalHeaderSubscriber.init(),f.setupBlogList(),f.setupSubscribeBadge(),f.prepareForGlobalHeader()},prepareForGlobalHeader:function(){if(window!==window.parent)return null;if(!c.messenger)return null;var e=(0,o.default)("blogs-uri-base"),t=(0,o.default)("blog-name"),n=(0,o.default)("blog-is-public");e&&t&&"index"!==(0,o.default)("page")&&(l.infoLoaded.then((function(){c.send("showBlogInfo",{blogName:t,blogUri:e,blogIsPublic:n})})),c.addEventListener("blogmenuAdmin",(function(e){var t=u.param({blog:e.blogUri,isEditing:"user-blog-edit"===(0,o.default)("page")?1:0});d.toggle("/-/menu/blogmenu_admin?"+t,e,"blogmenu")})))},setupBlogList:function(){var e=u(".js-admin-menu-myblog-list");u(".js-admin-menu-myblog-btn").on("click",(function(){return 0===e.size()||(e.toggle(),!1)})),u(document).on("click",(function(t){u.contains(e,t.target)||e.hide()}))},setupSubscribeBadge:function(){if(window!==window.parent)return null;(0,i.fetchUnreadCount)().then((function(e){if(0!==e){var t=e>i.UNREAD_COUNT_RESPONSE_MAX?i.UNREAD_COUNT_RESPONSE_MAX+"+":""+e;u(".js-badge-subscribe").addClass("visible").text(t),u(".js-badge-subscribe-notifier").show()}}))}};e.exports=f},19778:function(e,t,n){n(69826),n(69600),n(57327);i(n(20996));var r=i(n(57942));function i(e){return e&&e.__esModule?e:{default:e}}var o=n(73609),a=n(92901),s=n(16292).attachSubscriptionConfig,u={init:function(){s(document,".js-subscription");o(".entry-unit-older-post").each((function(){var e;(e=o(this)).find("li.posts"),e.find("li.more")})),o(".js-subscription").on("click",".js-read-more",(function(e){var t=o(this);t.siblings(".js-older-entry-unit:hidden").slideToggle("fast"),t.addClass("is-hidden")}));!function(){var e=o(".js-admin-subscribe-recommended-wrapper"),t=e.find(".recommend-blog"),n=e.find(".more");t.each((function(e){var t=o(this),n=o(this).find(".js-hatena-follow-button-box"),i=t.data("blogHost"),s={subscribersCount:parseInt(n.data("subscribers-count"),10),blogUrl:i,requestUrl:[(0,r.default)("admin-domain"),t.data("author"),i,"subscribe"].join("/")};new a.Admin(n,{isSubscribing:!1,isGuest:!1},s)}));var i=t.filter(":visible").length,s=i+10;n.on("click",(function(e){t.filter((function(e){return i<=e&&e<s})).fadeIn("fast"),i=s,s+=10,t.length<i&&n.addClass("is-hidden")}))}()}};e.exports=u},83404:function(e,t,n){n(69826);var r,i=(r=n(56882))&&r.__esModule?r:{default:r};var o=n(73609),a={init:function(){o(".membership-category").each((function(e,t){var n=o(t),r=n.find(".membership-category-select"),a=r.find("option:selected").val(),s=n.find(".indicator");r.change((function(e){i.default.updateMembershipCategory(r).done((function(e){s.find(".success").show(),s.find(".fail").hide()})).fail((function(){r.val(a),s.find(".success").hide(),s.find(".fail").show()}))}))}))}};e.exports=a},90594:function(e,t,n){var r=n(34914),i=n(78899),o=n(73609),a={init:function(){(0,i.updateDynamicPieces)(o("#user-config")),(0,r.initializeFlagVariantsConfigIfApplicable)(document.getElementById("admin-config-flag_variants-root"))}};e.exports=a},1640:function(e,t,n){function r(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n(47042),n(68309),n(82526),n(41817),n(32165),t.__esModule=!0,t.init=void 0,n(60285),n(41539),n(78783),n(66992),n(33948),n(39714),n(91038);t.init=function(){o(),a()};var o=function(){var e=document.querySelector(".js-blogs-dropdown"),t=document.querySelector(".js-switch-blog");null==t||t.addEventListener("click",(function(){if(null!=e&&e.value){var t=new URL(window.location.href);t.searchParams.set("blog",e.value),t.searchParams.delete("page"),window.location.assign(t.toString())}}))},a=function(){var e=Array.from(document.querySelectorAll(".js-confirmation-checkbox")),t=document.querySelector("#js-check-all");null==t||t.addEventListener("click",(function(){for(var n,i=r(e);!(n=i()).done;){n.value.checked=t.checked}}))}},23606:function(e,t,n){n(68309);var r=n(73609),i=n(36500),o={init:function(){i.listenToParent(),r(".close").on("click",(function(e){return i.send("close",{name:window.name}),!1}))}};e.exports=o},11229:function(e,t,n){n(4723),n(74916),n(69826);var r,i=n(70879),o=n(93358),a=n(65939),s=n(33671),u=n(37213),l=(r=n(57942))&&r.__esModule?r:{default:r};var c=n(73609),d=n(59662),f=n(74350),p=n(56412),h=(n(92901),{init:function(){Messenger.listenToParent(),(0,a.initGlobalHeaderEventTracker)();var e,t=location.hostname.match(/\.hatena\.[^:]+/)[0],n=c("#header"),r=c("#header-services"),m=c("#header-notify"),v=c("#header-unread"),g=decodeURIComponent(location.hash.substring(1)),b=(0,l.default)("admin-origin")+"/go?blog="+encodeURIComponent(g);if(document.cookie.match(/\brk=/)?e=c.ajax({type:"get",dataType:"jsonp",url:"https://www"+t+"/notify/notices.count.json",data:{services:1}}):(e=c.Deferred()).reject(),!d.isIE){var y=document.body.getAttribute("data-color");h.renderDropdown(y)}n.delegate(".header-dropdown",{keypress:function(e){13===e.which&&(c(e.currentTarget).click(),e.preventDefault(),e.stopPropagation())},mouseup:function(e){e.currentTarget.blur()}}),n.find("a.new-entry").on("click",(function(){return Messenger.send("new-entry",{}),(0,a.trackGlobalHeaderClick)("new-entry"),!1})),n.find("a.feedback").on("click",(function(e){var t=c(e.currentTarget);return Messenger.send("feedback",{left:t.offset().left,uri:t.attr("data-feedback-url")}),(0,a.trackGlobalHeaderClick)("feedback"),!1})),r.find(".header-dropdown").on("click",(function(n){var r=c(n.currentTarget);return e.done((function(e){Messenger.send("servicesmenu",{BASE:t,right:r.offset().left+r.width(),info:e,location:b})})),(0,a.trackGlobalHeaderClick)("services-dropdown"),!1})),m.find(".header-dropdown").on("click",(function(e){var n=c(e.currentTarget);return Messenger.send("notify",{BASE:t,left:n.offset().left}),m.find(".notify-count").text("").hide(),(0,a.trackGlobalHeaderClick)("notify-dropdown"),!1})),e.done((function(e){e.count>0?m.find(".notify-count").text(e.count).show():m.find(".notify-count").text("").hide()})),e.done(f),(0,l.default)("rkm")&&(0,l.default)("rkc")&&(0,u.fetchUnreadCount)().then((function(e){0!==e&&v.find(".unread-count").show()})),p.loadInfo().done((function(e){h.initQuoteStock(e);var r=c("#header-my");r.on("click",(function(){return Messenger.send("mymenu",{BASE:t,right:r.offset().left+r.width()}),!1})),"blogs"===n.attr("data-page-category")&&(e.is_public||c(".js-blog-private-badge").show(),e.blog_name&&(c("#current-blog .current-blog-title").append(document.createTextNode(e.blog_name)),c("#current-blog .current-blog-title").attr("href",e.blog_url)),h.initBlogDropdown(t)),"admin"===n.attr("data-page-category")&&h.initAdminDropdown()})),c(".login").attr("href","https://www.hatena.ne.jp/login?location="+encodeURIComponent(b)),Messenger.addEventListener("visitorAttribute",o.respondOnVisitorAttributeEvent),Messenger.addEventListener("inheritVia",(function(e){(0,i.LOG)(["inheritVia",e]),(0,s.inheritVia)(e)})),Messenger.addEventListener("newEntryGeometry",(function(){var e=c("a.new-entry"),t=e.offset();Messenger.send("newEntryGeometry",{top:t.top,left:t.left,height:e.height(),width:e.width()})}))},coloringSvgHeader:function(e,t){e.onload=null;try{var n=document.body.getAttribute("data-color");c(e).find("path").attr("fill",n)}catch(e){(0,i.BUG)(e,"render logo")}t(c(e))},renderDropdown:function(e){var t=new Image;t.src="/images/header/dropdown@2x.png?version="+(0,l.default)("version"),t.onload=function(){try{t.onload=null;var n=document.createElement("canvas");if(n.setAttribute("width",24),n.setAttribute("height",24),!n.getContext)return;var r=n.getContext("2d");if(r.drawImage(t,0,0),r.globalCompositeOperation="source-in",r.fillStyle=e,r.fillRect(0,0,24,24),!n.toDataURL)return;var o=n.toDataURL(),a=document.createElement("style");a.setAttribute("type","text/css"),a.appendChild(document.createTextNode("\n          #header span.header-dropdown,\n          #header span.header-dropdown-custom {\n              background: url("+o+") center right no-repeat; background-size: 12px 12px;\n          }\n        ")),document.body.appendChild(a)}catch(e){(0,i.BUG)(e,"render logo dropdown"),t.src="/images/header/dropdown.gif?version="+(0,l.default)("version")}}},initAdminDropdown:function(){var e=c("#current-blog"),t=e.find(".current-blog-title");Messenger.addEventListener("showBlogInfo",(function(n){e.show(),t.text(n.blogName),n.blogIsPublic||c(".js-blog-private-badge").show(),c(".service-menu .edit").hide(),c(".service-menu .admin-blog").show(),c("#current-blog .current-blog-title").attr("href",n.blogUri),c("#current-blog, #my-blogs").on("click",(function(e){var t=c(e.currentTarget);return Messenger.send("blogmenuAdmin",{left:t.offset().left,blogUri:n.blogUri}),(0,a.trackGlobalHeaderClick)("current-blog-title-in-admin"),!1}))}))},initBlogDropdown:function(e){c("#current-blog").show(),c("#current-blog, #my-blogs").on("click",(function(t){var n=c(t.currentTarget);return Messenger.send("blogmenu",{BASE:e,left:n.offset().left}),(0,a.trackGlobalHeaderClick)("current-blog-title-in-blogs"),!1}))},initQuoteStock:function(){Messenger.addEventListener("stockQuote",(function(e){e.uri&&e.selected_text||Messenger.send("failStockQuote",{}),c.ajax({url:"/api/quotes",data:{uri:e.uri,body:e.selected_text,rkm:(0,l.default)("rkm"),rkc:(0,l.default)("rkc")},cache:!1,type:"post",dataType:"json"}).done((function(e){Messenger.send("successStockQuote",{res:e})})).fail((function(e){Messenger.send("failStockQuote",{res:e})}))})),Messenger.addEventListener("quote-edit-entry",(function(){Messenger.send("new-entry-with-quote")})),Messenger.addEventListener("requote-edit-entry",(function(e){try{localStorage.setItem("ReQuote",JSON.stringify(e.quote))}catch(e){}Messenger.send("new-entry-with-requote")}))}});e.exports=h},91602:function(e,t,n){n(21249),n(69826);i(n(20996));var r=i(n(45288));function i(e){return e&&e.__esModule?e:{default:e}}var o=n(73609),a=n(16292).attachSubscriptionConfig,s=n(67294),u=n(73935),l=n(91269),c=n(11596),d={init:function(){a(document,".js-subscription"),o(".access-graph[itemscope]").each((function(){var e=o(this),t=0,n=e.find("meta").map((function(){return[[t++,+this.getAttribute("content")]]}));o.plot(e,[{data:n,bars:{show:!0,lineWidth:.7},points:{show:!1},legend:{show:!1},shadowSize:0}],{xaxis:{min:0,ticks:[]},yaxis:{min:1,autoscaleMargin:.1,ticks:[]},grid:{show:!1}})}));var e=l.get("admin.myblogs"),t=l.get("admin.should_link_to_blogmedia_registration_form");u.render(s.createElement(c,{blogs:e,shouldLinkToBlogmediaRegistrationForm:t}),document.querySelector("#myblogs")),u.render(s.createElement(r.default,{limit:5}),document.querySelector("#subscribing-blogs"))}};e.exports=d},90487:function(e,t,n){var r,i=(r=n(20996))&&r.__esModule?r:{default:r};var o=n(73609),a=n(36500),s=n(67279),u={init:function(){a.listenToParent(),o("#locale-window a").on("click",(function(){var e=o(this).attr("data-lang");return i.default.setAcceptLang(e),a.send("reload"),!1})),s()}};e.exports=u},50068:function(e,t,n){var r=n(36500),i=n(67279),o={init:function(){r.listenToParent(),i(),r.send("init")}};e.exports=o},43e3:function(e,t,n){t.__esModule=!0,t.init=void 0;var r,i=n(75809),o=n(73380),a=(r=n(67294))&&r.__esModule?r:{default:r};t.init=function(){var e=document.getElementById("js-notifications-root");e&&(0,o.safeRender)(a.default.createElement(i.NotificationsContainer,null),e)}},37320:function(e,t,n){var r=n(43614),i={init:function(){r.init()}};e.exports=i},68156:function(e,t,n){n(15306),n(74916);var r,i=(r=n(57942))&&r.__esModule?r:{default:r};var o=n(73609),a={init:function(){if((0,i.default)("name")){var e,t;e=(0,i.default)("name").toLowerCase().replace(/_/,"-"),""===(t=o("input[name=id]")).val()&&t.val(e)}}};e.exports=a},19557:function(e,t,n){n(15306),n(74916),n(69826),n(41539),n(66992),n(33948);var r,i=(r=n(57942))&&r.__esModule?r:{default:r};var o=n(73609),a=n(13469),s={init:function(){if((0,i.default)("name")){var e=s;e.submitButton=o("input[type=submit]");var t=o(':input[name="domain"]'),n=o('input[name="id"]');e.STATES={progress:{className:"progress",message:o(".domain-check-message.progress")},available:{className:"check",message:o(".domain-check-message.check")},unavailable:{className:"error",message:o(".domain-check-message.error")},invalid:{className:"invalid",message:o(".domain-check-message.invalid")},invalidLength:{className:"invalid-length",message:o(".domain-check-message.invalid-length")}},e.inputValidStates={id:!0,import:!0};var r=function(){var r=n.val(),i=t.val();if(r)if(r.length<2||r.length>32)s.changeAvailabilityState({nextState:"invalidLength"});else if(s.isValidBlogID(r)){var a=o("[data-brand-name]").attr("data-brand-name");o.ajax({url:"/api/blog/domain_registry",dataType:"json",data:{blog_ids:JSON.stringify([r]),brand_name:a}}).done((function(t){var n=t[r];void 0!==n&&e.checkBlogIdAvailability({blogID:r,topdomain:i,statuses:n})}))}else s.changeAvailabilityState({nextState:"invalid"})};r(),t.change(r),n.keyup(a.debounce(r,1e3)).keyup((function(){e.changeAvailabilityState({nextState:"progress"})}));var u,l;u=(0,i.default)("name").toLowerCase().replace(/_/,"-"),l=o("[data-brand-name]").attr("data-brand-name"),o.ajax({url:"/api/blog/domain_registry",dataType:"json",data:{blog_ids:JSON.stringify([u]),brand_name:l}}).done((function(e){var t=e[u];void 0!==t&&null!==typeof t||(t={});var n=s.availableDomains(t);if(a.any(n)){var r=o(':input[name="domain"]'),i=r.val();a.include(n,i)||r.val(n[0]);var l=o("input[name=id]");""===l.val()&&(l.val(u),s.changeAvailabilityState({nextState:"available"}))}})),o("input[name=import]").length&&(o("input[name=permission],input[name=import]").change((function(){e.changeImportAvailabilityState()})),o(".import-error").hide(),e.changeImportAvailabilityState())}},changeAvailabilityState:function(e){var t=s,n=e.nextState;t.inputValidStates.id="unavailable"!==n&&"invalid"!==n&&"invalidLength"!==n,t.changeSubmitButtonState(),a.each(s.STATES,(function(e,t){t===n?e.message.show():e.message.hide()}))},checkBlogIdAvailability:function(e){var t=e.topdomain,n=e.blogID,r=e.statuses,i=r[t],o=s.availableDomains(r);"unavailable"===i&&a.any(o)&&s.suggestAlternativeDomainNames({blogID:n,availableDomains:o}),s.changeAvailabilityState({nextState:i})},suggestAlternativeDomainNames:function(e){var t=e.blogID,n=e.availableDomains,r=o(".domain-recommend"),i=o(':input[name="domain"]');o(".requested-blog-id").text(t),r.find("ul").detach();var s=o("<ul/>");a.each(n,(function(e){o("<li/>").text(t+"."+e).click((function(){i.val(e).change()})).appendTo(s)})),r.append(s).show()},availableDomains:function(e){var t=a.keys(e),n=a.select(t,(function(t){return"available"===e[t]}));return n},changeImportAvailabilityState:function(e){var t=s,n=o("input[name=permission]:checked"),r=o("input[name=import]:checked"),i=n.val(),a=r.attr("data-permission"),u=o(".import-error");"private"===a&&"public"===i?(u.show(),t.inputValidStates.import=!1,t.changeSubmitButtonState()):(u.hide(),t.inputValidStates.import=!0,t.changeSubmitButtonState())},changeSubmitButtonState:function(e){var t=s,n=t.submitButton;a.every(t.inputValidStates,(function(e){return e}))?(n.attr("disabled",!1),n.removeClass("disabled"),n.addClass("btn-blue")):(n.attr("disabled",!0),n.removeClass("btn-blue"),n.addClass("disabled"))},isValidBlogID:function(e){return/^[a-z0-9][a-z0-9-]{0,30}[a-z0-9]$/.test(e)&&!/--/.test(e)&&e.length>=2}};e.exports=s},52966:function(e,t,n){n(69826);var r=n(73609),i={init:function(){var e=r(".available-licenses"),t=r(".show-more").find("a");e.hide(),t.on("click",(function(n){"1"===e.attr("data-collapsed")?(e.show(),e.attr("data-collapsed",0),t.text(t.attr("data-collapse-message"))):(e.hide(),e.attr("data-collapsed",1),t.text(t.attr("data-expand-message"))),n.preventDefault()})),r(".deed").hide(),r(".show-deed").on("click",(function(e){return r(r(this).attr("data-target-selector")).toggle(),!1})),!1===r("input[name=license]:checked").is(":visible")&&t.click()}};e.exports=i},29106:function(e,t,n){n(69826);var r,i=n(7307),o=(r=n(83092))&&r.__esModule?r:{default:r},a=n(55834);var s=n(73609),u={init:function(){!(0,a.hasFlagVariant)("new-starjs")&&i.Star&&(i.Star.SiteConfig={entryNodes:{"#container":{uri:"a.permalink",title:"h1.theme-name",container:".star-container"}}});var e=u;e.$themeContainer=s("#store-container"),e.$installDialog=s(".blog-title-dropdown-window"),e.$installButton=s("#sidebar").find(".install-theme-btn"),e.$installDialog.hide(),e.$installButton.click((function(){e.$installDialog.slideToggle()})),new o.default(s("#theme-detail-tabs"))}};e.exports=u},86260:function(e,t,n){n(69826);var r,i=(r=n(83092))&&r.__esModule?r:{default:r};var o=n(73609),a={init:function(){var e=o(".description"),t=o("#topic-entries-tabs");e.find(".read-more").on("click",(function(t){t.preventDefault();var n=e.find(".read-more-text");e.html(n.html())})),new i.default(t)}};e.exports=a},210:function(e,t,n){var r=n(36500),i={init:function(){r.listenToParent();var e=document.getElementById("posted").value;r.send("update",{comment:e}),r.send("close")}};e.exports=i},20894:function(e,t,n){var r=n(73609),i=n(61030),o=n(2101),a={init:function(){i(),o({$container:r(".js-header-image-container"),previewUpdater:null})}};e.exports=a},1008:function(e,t,n){t.__esModule=!0,t.init=void 0;var r,i=(r=n(73609))&&r.__esModule?r:{default:r};var o=n(1780);t.init=function(){var e=document.querySelector('input[name="custom-domain_https_confirmation-checkbox"]'),t=(0,i.default)(".js-blog-config-detail-form");if(t.on("submit",(function(){o(t)})),e){var n=document.querySelector("#custom_host");if(!n)throw new Error("[BUG] custom_host input not found");e.addEventListener("change",(function(e){n.disabled=!e.target.checked}))}}},38642:function(e,t,n){var r,i=(r=n(73609))&&r.__esModule?r:{default:r},o=n(55248);var a={init:function(){new o.BlogPermission((0,i.default)("#blog-permission-container"))}};e.exports=a},71950:function(e,t,n){n(69826);var r,i=n(91298),o=(r=n(83092))&&r.__esModule?r:{default:r};var a=n(73609),s={init:function(){var e=a("#access-counts").remove(),t={};e.find("tr").each((function(){var e=a(this),n=+e.find("td[data-time]").attr("data-time"),r=+e.find("td[data-count]").attr("data-count");t[n]=r})),i.AccessLogViewer.showGraph(t,{parent:a("#access-counts-daily"),timeformat:"%m/%d",minTickSize:[1,"day"],unit:864e5,number:14,graphAreaMarginRight:20,barWidth:15}),i.AccessLogViewer.showGraph(t,{parent:a("#access-counts-hourly"),timeformat:"%d %H:%M",minTickSize:[1,"hour"],unit:36e5,number:24,graphAreaMarginRight:20,barWidth:10});new o.default(a("#access-counts-tabs"));a(".summary-box .hosts").delegate(".host","click",(function(){a(".summary-box .hosts .selected").removeClass("selected"),a(this).addClass("selected");var e=a(this).attr("data-site-host");return a(".summary-box .site.selected").removeClass("selected"),a(".summary-box .sites").find('*[data-site-host="'+e+'"]').addClass("selected"),!1}))}};e.exports=s},37764:function(e,t,n){var r=n(73609),i=n(36500),o={init:function(){i.listenToParent(),i.send("resize",{height:r(document.body).height()})}};e.exports=o},53457:function(e,t,n){var r=n(73609),i=n(36500),o=n(67279),a=n(1780),s={init:function(){i.listenToParent(),r(".g-recaptcha").length>0?window.outerWidth<340?i.send("resize",{width:"100%",left:"0",height:600}):i.send("resize",{height:600}):o();var e=r("form#comment-form");e.on("submit",(function(){a(e)}))}};e.exports=s},50455:function(e,t,n){var r=n(3869),i={init:function(){r.init()}};e.exports=i},45319:function(e,t,n){n(4723),n(74916),n(69826),n(54747),n(91038),n(78783),n(15306),n(21249);var r=n(10714),i=u(n(57942)),o=u(n(347)),a=n(30917),s=u(n(83902));function u(e){return e&&e.__esModule?e:{default:e}}var l=n(73609),c=n(13469),d=n(30381),f=n(63488),p=n(81191),h=n(97050).extractFotolifeSyntax,m=n(11412),v=n(30546),g=n(56663),b=n(83391),y=n(3126),_=function(){var e=l("input[name=datetime]"),t=l(".js-datetime-input-date"),n=l(".js-datetime-input-time"),r=e.val();if(r){var i=r.match(/^(\d{4}-\d{2}-\d{2})T(\d{2}:\d{2}(:\d{2})?)$/);if(i){var o=i[1],a=i[2];t.val(o),n.val(a)}e.trigger("change")}},w={init:function(){this.$editEntry=l("#edit-entry");var e=l("#edit-form");y()&&w.setupWysiwygEditor(),g.init(w.uploadDone),w.setupMyCuration(),w.setUpPromotionCheck(),w.setupPromotionAnkerStop(),w.setupAccordionToggles(),w.setupCustomUrlUniqueCheck(e),w.setupScheduledEntry(),w.dateTimeEditorEnabled()&&b(),e.on("backup-restore-params",_),new v(l(".js-touch-edit-socialize-box-li.twitter")),new s.default,f.createMessage(e),e.find(".custom-url-input input").on("keydown",(function(e){if("RET"===keyString(e))return!1})),e.find(".edit-title input").on("keydown",(function(e){if("RET"===keyString(e))return!1}))},setupWysiwygEditor:function(){var e=this.$editEntry.find("textarea#entry-body"),t=l('<iframe src="about:blank" frameborder="0">').attr("id","entry-html-body").prependTo("div.edit-body"),n=t.prop("contentDocument"),r=e.val();r||l('form#edit-form input[name="entry"]').val()||(r="<p><br/></p>");var o=n.createElement("link");o.setAttribute("type","text/css"),o.setAttribute("rel","stylesheet"),o.setAttribute("href",(0,i.default)("admin-domain")+"/css/touch/blog-edit.css"),n.getElementsByTagName("head")[0].appendChild(o),n.body.innerHTML=r,n.body.contentEditable=!0,n.body.addEventListener("keyup",(function(){e.val(n.body.innerHTML)}),!0),l("form#edit-form").append(l('<input type="hidden" name="wysiwyg" value="1">')).submit((function(){l("textarea#entry-body").val(n.body.innerHTML)})).bind("backup-restore",(function(){n.body.innerHTML=e.val()})),l("input#entry-title").blur((function(){t.focus()})),l(n).on("click","a",(function(){return!1})),e.hide()},setupAccordionToggles:function(){var e=document.querySelectorAll(".js-post-accordion-item");Array.from(e).forEach((function(e){var t=e.querySelector(".js-post-accordion-toggle"),n=e.querySelector(".js-post-accordion-content");t.addEventListener("click",(function(r){r.preventDefault(),r.stopPropagation(),e.classList.toggle("is-open"),n.classList.toggle("is-open"),window.scroll(0,window.scrollY+t.getBoundingClientRect().top)}))}))},setupCustomUrlUniqueCheck:function(e){var t=e.find(".custom-url-input input"),n=e.find(".js-custom-url-duplicate-warning");t.on("blur",(function(t){if(t.target.value){var r=e.find("input[name=entry]").val();o.default.get("/api/1/json/custom_url",{params:{custom_url:t.target.value,entry_id:r,blog_id:(0,i.default)("blog-uuid"),rkm:(0,i.default)("rkm"),rkc:(0,i.default)("rkc")}}).then((function(e){e.data.isExisting?n.show():n.hide()})).catch((function(){}))}}))},execCommand:function(e,t){var n=tinymce.get("entry-body");n.execCommand(e,!1,t),n.save()},pickColor:function(e){var t=l('#edit-entry .toolbar button[data-action="color"]');m.show(t.offset(),(function(t,n){e(n)}))},fontSize:function(e){var t=tinymce.get("entry-body").selection,n=t.getNode();if("span"!==n.nodeName.toLowerCase()){(n=document.createElement("span")).setAttribute("style","font-size: "+(100+e)+"%");var r=t.getRng();r.surroundContents(n),t.setRng(r)}else{var i=!1;if(n.setAttribute("style",n.getAttribute("style").replace(/font-size:\s*(\d+)%|$/,(function(t,n){return void 0===n&&(n=100),100===(n=+n+e)&&(i=!0),"font-size:"+n+"%"}))),i){for(var o=document.createDocumentFragment();n.firstChild;)o.appendChild(n.firstChild);n.parentNode.insertBefore(o,n),n.parentNode.removeChild(n)}}},EDITOR_ACTIONS:{bold:function(){this.execCommand("Bold")},italic:function(){this.execCommand("Italic")},strike:function(){this.execCommand("StrikeThrough")},underline:function(){this.execCommand("Underline")},removeFormat:function(){this.execCommand("removeFormat"),this.execCommand("unlink")},fontSizeIncl:function(){this.fontSize(10)},fontSizeDecl:function(){this.fontSize(-10)},unorderedList:function(){this.execCommand("InsertUnorderedList")},orderedList:function(){this.execCommand("InsertOrderedList")},color:function(){var e=this;e.pickColor((function(t){t?e.execCommand("ForeColor",t):e.execCommand("RemoveFormat")}))},link:function(){var e=prompt("URL");e&&(e=e.toLowerCase()),this.execCommand("CreateLink",e)}},uploadDone:function(e){w.trackPhotoUpload(),y()?h(e).done((function(e){(0,a.insertText)(e.html)})):(0,a.insertText)("["+e.replace(/:image/,":plain")+"]")},trackPhotoUpload:function(){var e="undefined"!=typeof FormData?"photo-xhr-upload-touch":"photo-form-upload-touch";p.trackEvent(e)},setupMyCuration:function(){l("[data-curation-action]").click((function(){var e=l(this).attr("data-curation-action");r.EditorConnector.loadServiceOnChildWindow("/-/curation/"+e),p.trackEvent("open-curation-"+e)}))},setUpPromotionCheck:function(){l("#promotion-check").click((function(){var e="promotion",t=l(this).attr("data-promotion-id");r.EditorConnector.loadServiceOnChildWindow("/-/curation/promotion?ref="+t),p.trackEvent("open-curation-"+e)}))},setupPromotionAnkerStop:function(){l(".promotion-button a").click((function(e){e.preventDefault()}))},dateTimeEditorEnabled:function(){var e=c.map(["date","time"],(function(e){var t=document.createElement("input");return t.setAttribute("type",e),t.setAttribute("value","not-a-date"),"text"!==t.type&&"not-a-date"!==t.value}));return c.all(e)},setupScheduledEntry:function(){var e=l("input[name=datetime]"),t=l("input[name=is_scheduled_entry]"),n=l(".js-schedule-post-button"),r=l(".js-show-on-normal-post"),i=l(".js-show-on-scheduled-post"),o=document.querySelector(".js-touch-scheduled-socialize-box"),a=function(e){return!!e&&d(e).isAfter(d())},s=function(){a(e.val())&&n.prop("checked")?(r.hide(),i.show(),o.classList.add("is-open")):(r.show(),i.hide(),o.classList.remove("is-open"))},u=function(){a(e.val())?(n.prop("disabled",!1),t.val(["1"])):(n.prop("disabled",!0),t.val(["0"])),s()};t.on("change",s),e.on("change",u),u()}};e.exports=w},48083:function(e,t,n){n(69826);var r=n(73609),i={init:function(){r("ul#entries li").click((function(e){0===r(e.target).parents("a").length&&(location.href=r(this).find("a:first").attr("href"))}))}};e.exports=i},46284:function(e,t,n){var r,i=(r=n(73609))&&r.__esModule?r:{default:r};var o=n(34418),a={init:function(){var e=(0,i.default)("#subscribers-table-body");o(e)}};e.exports=a},48056:function(e,t,n){var r=n(36843),i=a(n(73609)),o=a(n(20996));function a(e){return e&&e.__esModule?e:{default:e}}var s=n(1493),u={init:function(){o.default.setupTimestampUpdater(),(0,i.default)("label").on("click",(function(){})),s.init(),Messenger.messenger&&(0,r.initForGlobalHeaderNextGeneration)()}};e.exports=u},61531:function(e,t,n){var r,i=n(34914),o=(r=n(73609))&&r.__esModule?r:{default:r},a=n(78899);var s={init:function(){(0,a.updateDynamicPieces)((0,o.default)("#user-config")),(0,i.initializeFlagVariantsConfigIfApplicable)(document.getElementById("admin-config-flag_variants-root"))}};e.exports=s},40074:function(e,t,n){n(69826),n(60285),n(41539),n(78783),n(66992),n(33948);var r,i=(r=n(57942))&&r.__esModule?r:{default:r},o=n(93358),a=n(65939);var s=n(73609),u=n(36500),l=n(56412),c={init:function(){u.listenToParent(),(0,a.initGlobalHeaderEventTracker)(),l.loadInfo().done((function(e,t){c.initSubscribe(e),c.initQuoteStock(e)})),u.addEventListener("visitorAttribute",o.respondOnVisitorAttributeEvent)},initSubscribe:function(e){if(e.blog&&!e.can_open_editor&&!e.subscribe&&!e.force_pc_view){var t=s(".js-subscribe-container"),n=t.find(".js-subscribe-link");if(e.subscribe_url){var r=new URL(e.subscribe_url);r.searchParams.set("from_url",e.blog),r.searchParams.set("utm_source","globalheader_touch"),r.searchParams.set("utm_medium","button"),r.searchParams.set("utm_campaign","subscribe_blog"),n.attr("href",r.href)}t.show()}},initQuoteStock:function(e){u.addEventListener("stockQuote",(function(e){e.uri&&e.selected_text||u.send("failStockQuote",{}),s.ajax({url:"/api/quotes",data:{uri:e.uri,body:e.selected_text,rkm:(0,i.default)("rkm"),rkc:(0,i.default)("rkc")},cache:!1,type:"post",dataType:"json"}).done((function(e){u.send("successStockQuote",{res:e})})).fail((function(e){u.send("failStockQuote",{res:e})}))})),u.addEventListener("quote-edit-entry",(function(e){void 0!==e.quote&&localStorage.setItem("reQuote",JSON.stringify(e.quote)),u.send("new-entry-with-quote",{})}))}};e.exports=c},82848:function(e,t,n){n(69826),n(15306),n(74916),n(57327),n(4723);var r;(r=n(20996))&&r.__esModule;var i=n(73609),o=n(74350),a={init:function(){var e=i("#admin-top-tab"),t=i("#admin-top-tab .js-nav-tab"),n=i("#config-container > .js-section"),r=!1;i(window).load((function(){r=!0})),t.click((function(){var o=i(this);t.removeClass("selected"),t.find("a img").each((function(){/-selected/.test(this.src)&&(this.src=this.src.replace(/-selected/,""))})),n.hide();var a=o.find("a");o.addClass("selected"),a.find("img").each((function(){this.src=this.src.replace(/\.([^./]+)$/,"-selected.$1")}));var s=n.filter(a.attr("href"));if(s.show(),e.trigger("tabsactivate",{panel:{id:s.attr("id")}}),"replaceState"in history&&r){var u=a.attr("href").match(/(#.+)/)[0];u&&history.replaceState(null,document.title,u)}return!1}));var s=location.hostname.match(/\.hatena\.[^:]+/)[0],u=i("#admin-top-tab .notify-count").hide();i.getJSON("https://www"+s+"/notify/notices.count.json?callback=?",(function(e){e.count&&u.text(e.count).show(),o(e)})),e.on("tabsactivate",(function(e,t){if("notify"===t.panel.id){u.hide();var n=i("#notify").empty(),r="https://www"+s+"/notify/notices.iframe?"+(new Date).getTime();i('<iframe style="width: 100%; height: 340px; margin: 5px 0; padding: 0" frameborder="0"/>').attr("src",r).appendTo(n)}}));var l=t.filter((function(){return 0!==i(this).find("a").filter((function(){return i(this).attr("href")===location.hash})).length}));(l.length?l:t.eq(0)).click(),a.getDashboardData()},getDashboardData:function(){i.ajax({type:"GET",url:"/-/dashboard_data",data:{device:"touch"}}).done((function(e){i("#subscribe").append(e.subscribing_blogs)}))}};e.exports=a},91242:function(e,t,n){var r,i=(r=n(20996))&&r.__esModule?r:{default:r};var o=n(73609),a=n(37914),s={init:function(){o("a.js-set-language").on("click",(function(){var e=o(this).attr("data-lang");return i.default.setAcceptLang(e),location.href=a.param("location")||"/",!1}))}};e.exports=s},64881:function(e,t,n){t.__esModule=!0,t.init=function(){var e=new URL(window.location.href).searchParams.get("ref");r("#promotion-entry").click((function(t){var n=t.target.getAttribute("data-keyword"),r=t.target.getAttribute("data-fillin-id");r?window.location.href=e+"edit?fill_in="+encodeURIComponent(r):n&&(window.location.href=e+"edit?body="+encodeURIComponent(n))}))},n(60285),n(41539),n(78783),n(66992),n(33948);var r=n(73609)},57404:function(e,t,n){var r=n(43614),i={init:function(){r.init()}};e.exports=i},9126:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),n(69826);var r=n(36843),i=n(57525),o=n(6636),a=(m(n(59662)),function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=h(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(55992))),s=m(n(57942)),u=m(n(38600)),l=m(n(20996)),c=n(46955),d=n(55834),f=n(7307),p=n(78899);function h(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(h=function(e){return e?n:t})(e)}function m(e){return e&&e.__esModule?e:{default:e}}var v=n(73609),g=n(13469),b=n(36500),y=n(35652),_=n(32920),w=n(37914),E=n(56412),S=n(78304),C=n(8659),k=n(10912),O=n(40793),x=n(20854),P=n(30618),j=n(23249),M=n(90757),$={hasInfoLoaded:!1,init:function(){window.parent===window&&o.AccessLogger.ping(),E.infoLoaded.then((function(e){$.infoLoaded(e),e.quote&&y.quoteInfoLoaded(e.quote)})),(0,p.updateDynamicPieces)(v(document)),v(document).on("click","img.hatena-fotolife, img.magnifiable, img.http-image",(function(e){var t=e.currentTarget,n=v(t);if(!n.data("colorbox")){var r=n.closest("a").get(0);if(!r||r.href===t.src)return n.colorbox({maxWidth:"95%",maxHeight:"95%",transition:"none",photo:!0,href:n.attr("src"),title:" ",open:!0,opacity:.85}),v("#cboxContent").on("click",(function(){v.colorbox.close()})),!1}})),x.init(),r.GlobalHeaderSubscriber.init(),$.setupOndemandCommentDeleteButton(),$.highlightKeyword(),g.contains(["archive","hatena-bookmark-comment"],(0,s.default)("page"))||(0,d.hasFlagVariant)("new-starjs")||(f.Star.initBigStar(),f.Star.initStarNavigation(),f.Star.initDeleteStar(),y.Star.init()),(0,d.hasFlagVariant)("new-starjs")||f.Star.setDetailURLForTouch(),M.init(),i.YouTubeEmbed.init()},highlightKeyword:function(){var e=w.params();if(e&&e.q){var t=v(".search-result").data("searchQueries");t&&(v(".entry-title").highlight(t,{caseSensitive:!1}),v(".entry-description").highlight(t,{caseSensitive:!1}))}},infoLoaded:function(e){if(!$.hasInfoLoaded){$.hasInfoLoaded=!0;var t=w.param("via");if(t&&b.send("inheritVia",t),e.message&&_(e.message),u.default.resolve(!e.cookie_received),v("article.entry:not(.no-entry)").each((function(e,t){k.initEntry(v(t))})),e.editable){var n,r,i=v("<div>").addClass("entry-header-menu"),o='article.entry[data-publication-type="entry"]';v(document).on("mouseenter",o,(function(e){var t,o,u,c,d,f=v(e.currentTarget);f.is(n)?clearTimeout(r):(n=f).attr("data-uuid")&&i.empty().append((t=n,o=t.attr("data-uuid"),u=(0,s.default)("author"),c=(0,s.default)("blog"),d=a.protocolRelativeAdminUrl("/"+u+"/"+c+"/edit?entry="+o),v('<a href="'+d+'">'+l.default.text("edit")+"</a>"))).appendTo(n.find(".entry-header")).show()})),v(document).on("mouseleave",o,(function(){clearTimeout(r),r=setTimeout((function(){n=null,i.fadeOut("fast")}),2e3)})),"index"===(0,s.default)("page")&&!w.param("preview")&&v("#globalheader").is(":visible")&&$.setupFirstEntry(),C();var p=v(".sleeping-ads-notice");p.length>0&&p.show(),v(".js-no-entry").length&&(v(".js-no-entry-message").hide(),v(".js-welcome-message").show())}if(e.should_show_invitation_pc_link){var h=v(".js-guide-register");h.attr("style","display: block !important;"),h.find(".js-inherit-ga").each((function(e,t){var n=v(t),r=n.attr("href"),i=(0,c.inheritGA)(location.href,r);n.attr("href",i)}))}$.setupHatenaBookmarkComment(v("#container")),$.setupEntryModuleCarousel(),j.init(e.subscribe,e.subscribes),e.is_public&&new P,(0,d.hasFlagVariant)("new-starjs")||u.default.done((function(t){t&&f.Star.initStarForThirdPartyCookiesDisabled(e)})),S.record("Pages.Blogs['*'].init")}},setupFirstEntry:function(){v(".entry-content").show();var e=v(".welcome-tooltip-newentry");e.on("click",(function(){return k.newEntry({openedFrom:"welcome-tooltip"})})),b.send("newEntryGeometry"),b.addEventListener("newEntryGeometry",(function(t){e.offset({left:t.left+t.width/2-e.outerWidth()/2}),e.show()}))},elementDidAppear:function(e){var t=v.Deferred(),n=v(window);return n.scrollTop()>v(e).offset().top-n.height()?t.resolve():n.on("scroll",g.throttle((function(){n.scrollTop()>v(e).offset().top-n.height()&&t.resolve()}),200)),t.promise()},setupHatenaBookmarkComment:function(e){var t=e.find(".hatena-bookmark-comment-iframe");0!==t.size()&&g.each(t,(function(e){var t=v(e);b.createForFrame(e,t.attr("data-src")).addEventListener("resize",(function(e){t.css("height",e)}))}))},setupOndemandCommentDeleteButton:function(){v(document).on("mouseenter",".entry-comment",(function(e){var t=v(e.currentTarget);if(!(t.find(".comment-delete-button img").size()>0)){var n=(0,s.default)("admin-domain"),r=v.param({comment:t.attr("data-comment-uuid"),blog:t.attr("data-blog-uuid")}),i=v('<img src="'+(n+"/api/comment.delete.image?"+r)+'" />');i.on("load error",(function(){return i.attr("alt","delete")})),t.find(".comment-delete-button").append(i)}}))},setupEntryModuleCarousel:function(){var e=v(document).find('script[type="text/x-hatenablog-carousel"]');g.each(e,(function(e){var t=v(e),n=t.attr("data-carousel-display-entry-size-at-once"),r={isAutoScroll:!!t.attr("data-carousel-autoscroll"),displayEntrySizeAtOnce:+n||void 0};if(r.isAutoScroll){var i=t.attr("data-carousel-autoscroll-interval");r.autoScrollInterval=+i||void 0}new O(v(document).find(t.html()),r)}))}};e.exports=$},74592:function(e,t,n){t.__esModule=!0,t.init=void 0;var r,i=(r=n(67294))&&r.__esModule?r:{default:r},o=n(73380),a=n(43348);t.init=function(){var e=document.querySelector(".js-about-subscriber");e&&(0,o.safeRender)(i.default.createElement(a.AboutSubscribers,null),e)}},59328:function(e,t,n){var r=n(73609),i=n(56412),o={init:function(){i.infoLoaded.then((function(e){var t=e.editable?".js-message-author":".js-message-guest";r("#container").append(r(t).html())}))}};e.exports=o},99127:function(e,t,n){var r=n(73609),i=n(36500),o={init:function(){var e=i.createForParent(),t=0,n=function(){var n=r("body").height()+30;n!==t&&(e.send("resize",n),t=n)};r(document).on("click",".hatena-bookmark-span-button",(function(){n()})),setInterval((function(){n()}),1e3)}};e.exports=o},30780:function(e,t,n){var r=n(70879),i=n(37914),o=n(56412),a=n(10912),s={init:function(){i.setup();var e=function(){"#edit"===location.hash&&o.infoLoaded.then((function(e){e.editable&&a.newEntry({openedFrom:"hashchange"})})).catch((function(e){return(0,r.BUG)(e)}))};window.addEventListener("hashchange",(function(){return e()})),e()}};e.exports=s},9007:function(e,t,n){n(69826);var r=n(73609),i={init:function(){r((function(){var e=r(".js-preview-draft-modal");e.find(".js-preview-draft-modal-btn").focus().on("click",(function(){e.addClass("is-hidden")}))}))}};e.exports=i},68348:function(e,t,n){var r=n(73609),i={init:function(){try{if(!window.sessionStorage)return;var e=r("#content").attr("data-editor-id");if(!e)return;var t=r(document),n=sessionStorage.previewed_scroll_position?JSON.parse(sessionStorage.previewed_scroll_position):null;n&&n.editor_id===e&&(t.scrollTop(n.top),t.scrollLeft(n.left)),t.scroll(_.throttle((function(){sessionStorage.previewed_scroll_position=JSON.stringify({editor_id:e,top:t.scrollTop(),left:t.scrollLeft()})}),100))}catch(e){}}};e.exports=i},74387:function(e,t,n){var r=n(73609),i=n(36500),o={init:function(){var e=i.createForParent(),t=null,n=function(){var n=r("html").height();n!==t&&(e.send("resize",n),t=n)};!!r(".js-embed-preview")[0]?(n(),setInterval((function(){n()}),1e3)):e.send("close")}};e.exports=o},19394:function(e,t,n){var r=n(73609),i=n(13469),o={init:function(){try{if(!window.sessionStorage)return;var e=r("#realtime-preview-content").attr("data-editor-id");if(!e)return;var t=r("#realtime-preview-wrapper"),n=sessionStorage.realtime_previewed_scroll_position?JSON.parse(sessionStorage.realtime_previewed_scroll_position):null;r(window).on("load",(function(){n&&n.editor_id===e&&(t.scrollTop(n.top),t.scrollLeft(n.left))})),t.scroll(i.throttle((function(){sessionStorage.realtime_previewed_scroll_position=JSON.stringify({editor_id:e,top:t.scrollTop(),left:t.scrollLeft()})}),100))}catch(e){}}};e.exports=o},12779:function(e,t,n){n(69826);var r=n(7307),i=n(6636),o=d(n(20996)),a=d(n(57942)),s=n(78899),u=n(55834),l=d(n(38600)),c=n(36843);function d(e){return e&&e.__esModule?e:{default:e}}var f=n(73609),p=n(36500),h=n(37914),m=n(56412),v=n(20854),g=n(23249),b=n(83401),y={init:function(){window.parent===window&&i.AccessLogger.ping(),p.messenger&&(0,c.initForGlobalHeaderNextGeneration)(),m.infoLoaded.then((function(e){y.loadInfo(e),"entry"===(0,a.default)("page")&&e.quote&&b.init(e.quote)})),(0,s.updateDynamicPieces)(f(document)),o.default.setupTimestampUpdater(),y.initFooterAction(),y.setupOndemandCommentDeleteButton(),(0,u.hasFlagVariant)("new-starjs")||(r.Star.initBigStar(),r.Star.setDetailURLForTouch()),v.init()},loadInfo:function(e){l.default.resolve(!e.cookie_received);var t=h.param("via");t&&p.send("inheritVia",t),g.init(e.subscribe,e.subscribes),e.editable&&f(".js-no-entry").length&&(f(".js-no-entry-message").hide(),f(".js-welcome-message").show())},setupOndemandCommentDeleteButton:function(){f(document).on("mouseenter",".js-entry-comment",(function(e){var t=f(e.currentTarget);if(!(t.find(".js-comment-delete-button .js-comment-delete-image").size()>0)){var n=(0,a.default)("admin-domain")+"/api/comment.delete.image?"+f.param({comment:t.attr("data-comment-uuid"),blog:t.attr("data-blog-uuid")}),r=f("<img>");r.addClass("js-comment-delete-image"),r.attr("src",n);var i=function(){return r.attr("alt","delete")};r.load(i),r.error(i),t.find(".js-comment-delete-button").append(r)}}))},initFooterAction:function(){var e=f("iframe.js-footer-action");if(e.length)try{p.createForFrame(e.get(0),e.attr("data-src")).addEventListener("resize",(function(t){t&&e.css(t)}))}catch(e){}}};e.exports=y},55557:function(e,t,n){n(54747);var r=n(73609),i=n(99109),o={init:function(){r(".js-entry-article").toArray().forEach((function(e){return new i(r(e))}))}};e.exports=o},89401:function(e,t,n){var r=n(42999),i={init:function(){r.init()}};e.exports=i},59268:function(e,t,n){var r,i=n(36843),o=(r=n(38600))&&r.__esModule?r:{default:r},a=n(99057),s=n(78899);var u=n(9694),l=n(56412),c=n(36500),d=n(73609),f={init:function(){i.GlobalHeaderSubscriber.init(),(0,s.updateDynamicPieces)(d(document)),document.body.classList.contains("page-is-responsive")&&(this.responsiveFooter=new u),c.addEventListener("visitorAttribute",(function(e){var t=e.visitorAttribute,n=e.daysSinceRegister;(0,a.pushToDataLayer)({visitorAttribute:t,daysSinceRegister:n}),(0,a.pushToDataLayer)({event:"gotVisitorAttribute"})})),l.infoLoaded.then((function(e){o.default.resolve(!e.cookie_received),c.send("visitorAttribute")}))}};e.exports=f},96991:function(e,t,n){n(69826);var r=n(73609),i=n(56412),o=n(42999),a={init:function(){a.setupControls(),o.init(),i.infoLoaded.then((function(e){if(e.flash&&e.flash.has_just_created_circle){var t=function(){r("#flash-created-circle").fadeOut("fast")};r("#flash-created-circle").find(".close").click((function(){t()})).end().show(),r(document.body).on("click",(function(e){if(0===r(e.target).closest("#flash-created-circle").length)return t(),r(document.body).off("click",arguments.callee),!1}))}}))},setupControls:function(){i.infoLoaded.then((function(e){e.is_admin?r(".admin-control").addClass("admin-control-available"):r(".admin-control").addClass("admin-control-unavailable"),e.is_member?r(".circle-member-control").addClass("circle-member-control-available"):r(".circle-member-control").addClass("circle-member-control-unavailable"),e.has_blogs?r(".blog-user-control").addClass("blog-user-control-available"):r(".blog-user-control").addClass("blog-user-control-unavailable"),!1===e.cookie_received&&r("[data-user-unknown-overrides]").removeClass("admin-control-unavailable circle-member-control-unavailable blog-user-control-unavailable").addClass("admin-control-available circle-member-control-available blog-user-control-available")}))}};e.exports=a},51169:function(e,t,n){n(69826);var r=n(73609),i={init:function(){r(document).on("click",".js-read-old-entries",(function(){var e=r(this);e.closest(".js-category-container").find(".js-old-entry").show(),e.remove()}))}};e.exports=i},96065:function(e,t,n){t.__esModule=!0,t.init=void 0,n(64765),n(74916),n(60285),n(41539),n(78783),n(66992),n(33948);var r=n(33671),i=n(48379),o=n(37914);t.init=function(){var e=o.param("via");e&&(0,r.inheritVia)(e);var t=window.location.search;!!new URLSearchParams(t).get("showBookmarkCounts")&&(0,i.showBookmarkCounts)()}},90989:function(e,t,n){var r=n(73609),i=n(72005),o={init:function(){i(r(".js-followed-ad-container"),!0)}};e.exports=o},46267:function(e,t,n){t.__esModule=!0,t.init=void 0,n(54747);t.init=function(){var e;(e=document.documentElement).style.scrollBehavior="smooth",e.style.scrollPaddingTop="60px",function(){if("IntersectionObserver"in window){var e=document.querySelector("#js-company-navigation");if(e){var t=document.querySelectorAll(".js-cannot-coexist-with-navigation"),n=new IntersectionObserver((function(t){var n=t.some((function(e){return e.isIntersecting}));e.classList.toggle("off-screen",n)}));t.forEach((function(e){n.observe(e)}))}}}()}},33556:function(e,t,n){n(68309);var r=n(73609),i=n(36500),o={init:function(){i.listenToParent(),r(".close-window").on("click",(function(e){return i.send("close",{name:window.name}),!1}))}};e.exports=o},20343:function(e,t,n){t.__esModule=!0,t.init=void 0,n(64765),n(74916),n(60285),n(41539),n(78783),n(66992),n(33948);var r=n(48379);t.init=function(){var e=window.location.search;!!new URLSearchParams(e).get("showBookmarkCounts")&&(0,r.showBookmarkCounts)()}},49205:function(e,t,n){var r=n(73609),i=n(72005),o={init:function(){i(r(".js-followed-ad-container"),!0)}};e.exports=o},26065:function(e,t,n){var r={__domain__:n(62536),globalheader:n(11229),circle:n(83404),"circle-create":n(56764),"circle-membership":n(13796),"circle-membership-done":n(8078),"odai-new":n(10175),"odai-odai_id-edit":n(10175),"plus-quit":n(63931),"topic-show":n(57005),antenna:n(19778),config:n(90594),index:n(91602),locale:n(90487),refusal:n(37320),"feedback-iframe":n(23606),register:n(19557),"register-iframe":n(68156),"store-theme-new":n(52966),"store-theme-theme_id":n(29106),"menu-mymenu":n(35358),"menu-myblogmenu":n(39212),"menu-blogmenu":n(5927),"menu-services":n(966),"menu-blogmenu_admin":n(50068),"curation-amazon":n(33576),"curation-flickr":n(68850),"curation-gourmet":n(88956),"curation-instagram":n(37013),"curation-itunes":n(62492),"curation-promotion":n(41516),"curation-twitter":n(59451),"user-blog":n(77573),"user-blog-breadcrumb":n(46292),"user-blog-files-upload":n(34174),"user-blog-entries":n(71771),"user-blog-entries-summary":n(87025),"user-blog-drafts":n(71771),"user-blog-pages":n(18858),"user-blog-revisions":n(79923),"user-blog-comment":n(76674),"user-blog-comments":n(80185),"user-blog-comment-done":n(99352),"user-blog-comment-delete":n(52163),"user-blog-comment-delete-deleted":n(95974),"user-blog-profile_cards":n(73650),"user-blog-config-theme-theme_id-preview":n(47405),"user-blog-config-detail":n(38703),"user-blog-config-external":n(41145),"user-blog-config-permission":n(56870),"user-blog-config-design-detail":n(85407),"user-blog-config-entry_directory":n(24460),"user-blog-config-delete":n(64007),"special-challenge-series-series_name":n(86968),"user-blog-accesslog":n(18695),"user-blog-categories":n(24166),"user-blog-export-movable_type":n(16566),"user-blog-members":n(13027),"user-blog-subscribe":n(99907),"user-blog-subscribe-done":n(45348),"user-blog-subscribe-iframe":n(52943),"user-blog-subscribers":n(36783),"user-blog-import":n(34113),"user-blog-import-yahoo-start":n(93841),"user-blog-import-hatena_diary":n(79997),"user-blog-import-hatena_diary-diary-diary_name":n(54385),"user-blog-edit":n(68440),"user-blog-edit-done":n(64059),"user-blog-proxy_test":n(65641),"pro-will-start":n(97812),"pro-will-resume":n(98924),"pro-will-migrate":n(84032),"pro-welcome":n(47814),"pro-cancel-survey":n(3136),"pro-will-migrate-to-business":n(60680),notifications:n(43e3),"confirm-google-photos":n(1640)},i={__domain__:n(9126),index:n(30780),realtime_preview:n(19394),preview:n(68348),"preview-draft":n(9007),preview_url_embed:n(74387),"hatena-bookmark-comment":n(99127),"blog-count-limit-exceeded":n(59328),about:n(74592)},o={__domain__:n(59268),"global-top":n(96065),"mixed-topic":n(20343),"famous-blogs-top":n(51169),circle:n(96991),"circle-blogs":n(89401),"group-category":n(90989),"recent-groups":n(49205),"guide-pro-modal-ad":n(33556),"guide-corporation":n(46267)},a={__domain__:n(48056),config:n(61531),globalheader:n(40074),index:n(82848),locale:n(91242),refusal:n(57404),"topic-show":n(86260),"promotion-promotion_id":n(64881),"user-blog-accesslog":n(71950),"user-blog-action":n(37764),"user-blog-comment":n(53457),"user-blog-comment-done":n(210),"user-blog-comments":n(50455),"user-blog-entries":n(48083),"user-blog-subscribers":n(46284),"user-blog-config-detail":n(1008),"user-blog-config-permission":n(38642),"user-blog-config-design-detail":n(20894),"user-blog-edit":n(45319),"user-blog-edit-done":n(64059),"user-blog-import-yahoo-start":n(93841),"pro-will-start":n(97812),"pro-will-resume":n(98924),"pro-will-migrate":n(84032),"pro-welcome":n(47814),"pro-cancel-survey":n(3136),notifications:n(43e3)},s={__domain__:n(12779),entry:n(55557),about:n(74592)};e.exports={Admin:r,Blogs:i,Global:o,AdminTouch:a,BlogsTouch:s}},7544:function(e,t,n){n(15306),n(74916);var r,i=(r=n(20996))&&r.__esModule?r:{default:r};var o=n(73609),a=n(59662);e.exports={defaultParagraph:function(){this.formatBlock("p")},largeHeading:function(){this.formatBlock("h3")},middleHeading:function(){this.formatBlock("h4")},smallHeading:function(){this.formatBlock("h5")},bold:function(){this.execCommand("Bold")},italic:function(){this.execCommand("Italic")},strike:function(){this.execCommand("StrikeThrough")},underline:function(){this.execCommand("Underline")},removeFormat:function(){this.execCommand("removeFormat"),this.execCommand("unlink")},veryLargeFontSize:function(){this.execCommand("FontSize","200%")},largeFontSize:function(){this.execCommand("FontSize","150%")},defaultFontSize:function(){this.execCommand("RemoveFormat","FontSize")},smallFontSize:function(){this.execCommand("FontSize","80%")},unorderedList:function(){this.execCommand("InsertUnorderedList")},orderedList:function(){this.execCommand("InsertOrderedList")},color:function(){},pickColor:function(e){var t,n=this,r=this.tinymce.selection.getRng();if(a.isIE&&(this.tinymce.focus(),t=this.tinymce.selection.getBookmark(1),n.tinymce.selection.setRng(r)),e)n.execCommand("ForeColor",e);else try{n.execCommand("RemoveFormat")}catch(e){}t&&n.tinymce.selection.moveToBookmark(t)},link:function(){o(document).trigger("show-embed-box")},insertSeeMore:function(){this.insertLines(["\x3c!-- more --\x3e",""])},insertTOC:function(){this.insertLines(["[:contents]",""])},blockquote:function(){a.isIE&&this.tinymce.focus();var e=this.tinymce.selection.getNode(),t=o(e),n=0!==t.closest("blockquote").length,r=0===t.next().length,i=0===t.text().length;if(a.isIE&&"body"===e.tagName.toLowerCase())this.tinymce.selection.isCollapsed()?this.insertBlockQuoteWithNewLine():this.formatBlockQuote();else if(r&&!n)if(!this.tinymce.selection.isCollapsed()||i)this.insertBlockQuoteWithNewLine();else{this.moveCaretToNodeEnd(e),this.insert("<p>&nbsp;</p>");var s=o(this.tinymce.selection.getNode()).prev()[0];this.tinymce.selection.select(s),this.formatBlockQuote()}else this.formatBlockQuote()},footnote:function(){var e=this.tinymce.selection.getContent();if(e.length)this.replace("(("+e+"))");else{var t=i.default.text("edit_form.footnote_message");this.insertAndSelectText("(("+t+"))",2,2+t.length)}this.tinymce.focus()}}},39571:function(e,t,n){n(15306),n(74916),n(24603),n(39714);var r,i=(r=n(20996))&&r.__esModule?r:{default:r};var o=n(73609);e.exports={defaultParagraph:function(){this.headingAction("")},largeHeading:function(){this.headingAction("* ")},middleHeading:function(){this.headingAction("** ")},smallHeading:function(){this.headingAction("*** ")},italic:function(){this.wrapString("<em>","</em>","<i>","</i>")},bold:function(){this.wrapString("<strong>","</strong>","<b>","</b>")},underline:function(){this.wrapString("<u>","</u>")},strike:function(){this.wrapString("<s>","</s>")},veryLargeFontSize:function(){this.toggleFontSize(200)},largeFontSize:function(){this.toggleFontSize(150)},defaultFontSize:function(){this.removeFontSize()},smallFontSize:function(){this.toggleFontSize(80)},unorderedList:function(){var e=this.getSelectionText(),t=this.replace("\n- "+e);t.start=t.end,this.setSelectionRange(t)},orderedList:function(){var e=this.getSelectionText(),t=this.replace("\n+ "+e);t.start=t.end,this.setSelectionRange(t)},color:function(){},pickColor:function(e){var t=this,n=t.getSelectionRange(),r=t.getSelectionText(n);/(<span style="color: [^;]+?">)/.test(r)?(r=e?r.replace(RegExp.$1,'<span style="color: '+e+'">'):r.replace(RegExp.$1,"").replace(/<\/span>/,""),n=t.replace(r,n)):e&&(n=t.replace('<span style="color: '+e+'">'+r+"</span>",n)),t.setSelectionRange(n)},link:function(){o(document).trigger("show-embed-box")},insertSeeMore:function(){this.insertLines(["====",""])},insertTOC:function(){this.insertLines(["[:contents]",""])},blockquote:function(){this.wrapStringAround(">>\n","\n<<")},footnote:function(){this.wrapStringAroundLabel("((",i.default.text("edit_form.footnote_message"),"))")}}},66939:function(e,t,n){n(19601),n(15306),n(74916),n(24603),n(39714);var r=n(73609),i=n(39571);e.exports=Object.assign({},i,{largeHeading:function(){this.headingAction("### ")},middleHeading:function(){this.headingAction("#### ")},smallHeading:function(){this.headingAction("##### ")},italic:function(){this.wrapString("*","*","<i>","</i>")},bold:function(){this.wrapString("**","**","<b>","</b>")},unorderedList:function(){var e=this.getSelectionText(),t=this.replace("\n* "+e);t.start=t.end,this.setSelectionRange(t)},orderedList:function(){var e=this.getSelectionText(),t=this.replace("\n1. "+e);t.start=t.end,this.setSelectionRange(t)},color:function(){},pickColor:function(e){var t=this,n=t.getSelectionRange(),r=t.getSelectionText(n);/(<span style="color: [^;]+?">)/.test(r)?(r=e?r.replace(RegExp.$1,'<span style="color: '+e+'">'):r.replace(RegExp.$1,"").replace(/<\/span>/,""),n=t.replace(r,n)):e&&(n=t.replace('<span style="color: '+e+'">'+r+"</span>",n)),t.setSelectionRange(n)},link:function(){r(document).trigger("show-embed-box")},insertSeeMore:function(){this.insertLines(["\x3c!-- more --\x3e",""])},insertTOC:function(){this.insertLines(["[:contents]",""])},blockquote:function(){var e=this.getSelectionText();if(0!==e.length){var t;if(/^(> .*\r?\n)+(> .*)?$/.test(e)){var n=e.replace(/^> (.*)/gm,"$1");t=this.replace(n)}else{var r=e.replace(/\r?\n$/g,"").replace(/^(.*)/gm,"> $1");t=this.replace(r)}this.setSelectionRange(t)}else this.insert("\n> ")}})},90542:function(e,t,n){e.exports={html:n(7544),hatena:n(39571),markdown:n(66939)}},88792:function(e,t,n){function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var i=n(73609),o=function(e){var t,n;function o(t){var n;return(n=e.call(this)||this).$container=t,n.$container.on("click",".js-color-chip",(function(e){var t=i(e.currentTarget).attr("data-color");n.emit("colorpick",t)})),n.$container.on("click",".js-color-picker-cancel",(function(){n.emit("colorpick")})),n.$container.appendTo(document.body),n}return n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,r(t,n),o.prototype.setPosition=function(e){this.$container.css(e)},o}(n(17187).EventEmitter);e.exports=o},55540:function(e,t,n){n(69826),n(64765),n(74916),n(15306),n(21249);var r=l(n(73609)),i=l(n(13469)),o=l(n(37119)),a=n(92477),s=n(10714),u=n(70879);function l(e){return e&&e.__esModule?e:{default:e}}var c=n(41960),d=n(81191).trackEvent,f=function(){function e(e){var t=this;this.type="editor-amazon-search",t.$container=e.container,t.$container.get(0)&&(t.$categorySelect=t.$container.find(".amazon-search-category"),t.$keywordInput=t.$container.find(".amazon-search-keyword"),t.$keywordSubmit=t.$container.find(".amazon-search-keyword-submit"),t.$itemsContainer=t.$container.find(".amazon-search-items"),t.itemTemplate=i.default.template((0,r.default)(".amazon-search-item-template").html()),t.$indicator=t.$container.find(".indicator"),t.$pasteButton=t.$container.find(".amazon-search-paste-button"),t.$layoutType=t.$container.find(".amazon-search-layout-type"),t.$layoutTypeContainer=t.$container.find(".amazon-search-layout-type-container"),t.$resultIsEmpty=t.$container.find(".amazon-search-result-is-empty"),t.$formats=t.$container.find('.amazon-search-formats input[name="amazon-search-format"]'),t.$formatsContainer=t.$container.find(".amazon-search-formats"),t.$welcomeMessage=t.$container.find(".amazon-search-welcome"),t.$header=t.$container.find(".amazon-search-header"),t.$footer=t.$container.find(".amazon-search-footer"),this.sidebar=e.sidebar,t.bindEvents(),t.resize(),t.$keywordInput.val()&&t.$keywordSubmit.click())}var t=e.prototype;return t.bindEvents=function(){var e=this,t=this;t.$keywordSubmit.click((function(e){return t.searchByInput(),!1})),t.$categorySelect.change((function(e){return t.searchByInput(),!1})),t.$keywordInput.keydown((function(e){if("RET"===c(e))return t.searchByInput(),!1})),t.$keywordInput.focus((function(){setTimeout((function(){t.resize()}),0)})),t.$itemsContainer.delegate(".amazon-search-item","click",(function(e){(0,r.default)(e.target).is("a")||((0,r.default)(this).toggleClass("selected"),t.selectedItemsChanged())})),t.$container.delegate(".amazon-search-item","dblclick",(function(e){if(!(0,r.default)(e.target).is("a"))return t.insertAsins([(0,r.default)(this).attr("data-asin")]),(0,r.default)(this).removeClass("selected"),t.selectedItemsChanged(),d(t.$pasteButton.attr("data-track-name")),!1})),t.$pasteButton.click((function(e){var n=[];t.$itemsContainer.find(".selected").each((function(){n.push((0,r.default)(this).attr("data-asin")),(0,r.default)(this).removeClass("selected")})),t.insertAsins(n),t.selectedItemsChanged()})),(0,o.default)({$container:t.$formatsContainer,key:"amazon-formats",onchange:function(e){t.$formatsContainer.find("label.selected").removeClass("selected"),e.closest("label").addClass("selected")}}),(0,o.default)({$container:t.$layoutTypeContainer,key:"amazon-layout",onchange:function(e){t.$itemsContainer.removeClass("layout-thumbnail"),t.$itemsContainer.removeClass("layout-list");var n=e.val();t.$itemsContainer.addClass("layout-"+n),t.$layoutTypeContainer.find("label.selected").removeClass("selected"),e.closest("label").addClass("selected"),t.setTipsyEnabled("thumbnail"===n)}});var n=function(t){t===e.type&&e.resize()};this.sidebar.on("resize",n),this.sidebar.on("tabChange",n)},t.setTipsyEnabled=function(e){var t=this.$itemsContainer.find(".amazon-search-item"),n="tipsy-southeast";e?t.addClass(n):t.removeClass(n)},t.resize=function(){var e=(0,r.default)(window).height(),t=0;t+=parseInt(this.$itemsContainer.css("padding-top"),10)||0,t+=parseInt(this.$itemsContainer.css("padding-bottom"),10)||0,this.$itemsContainer.height(e-this.$container.offset().top-this.$header.outerHeight(!0)-this.$footer.outerHeight(!0)-t)},t.selectedItemsChanged=function(){var e=this;e.$itemsContainer.find(".selected").length>0?e.$pasteButton.removeClass("disabled").addClass("enabled").prop("disabled",!1):e.$pasteButton.removeClass("enabled").addClass("disabled").prop("disabled",!0)},t.searchByInput=function(){var e=this;e.search(e.$keywordInput.val(),e.$categorySelect.find("option:selected").val())},t.search=function(e,t){var n,i=this;if("string"!=typeof e)return!1;if(0===(e=(e=e.replace(/^\s*/,"")).replace(/\s*$/,"")).length)return!1;if(i._searchingKeyword===e&&i._searchingCategory===t)return!1;i.$welcomeMessage.addClass("disable"),i._searchDeferred&&i._searchDeferred.reject(),i.ajaxStarted(),i._searchingKeyword=e,i._searchingCategory=t;var o=r.default.Deferred().done((function(){})).fail((function(){n&&n.abort()})).always((function(){i.ajaxFinished()}));i.$itemsContainer.find(".amazon-search-item").remove();!function a(s){i.ajaxStarted(),n=r.default.ajax({url:"/api/amazon",data:{keyword:e,category:t,page:s}}).done((function(e){i.showItems(e.items),1===e.page&&0===e.items.length?i.$resultIsEmpty.show():i.$resultIsEmpty.hide(),e.has_next?e.page>=5?o.resolve():a(e.page+1):o.resolve()})).fail((function(e){o.reject(e)}))}(1),i._searchDeferred=o},t.showItems=function(e){var t=this,n="";i.default.each(e,(function(e){n+=t.itemTemplate({item:e})})),t.$indicator.before(n),t.setTipsyEnabled(t.$itemsContainer.hasClass("layout-thumbnail"))},t.insertAsins=function(e){var t=this.$container.find('[name="amazon-search-format"]:checked').val(),n=i.default.map(e,(function(e){return"[asin:"+e+(t.length>0?":"+t:"")+"]"})),r={html:n,hatena:n,markdown:n};(0,a.extractSyntax)(n).done((function(e){r.html="detail"===t?["",'<div class="freezed">'+e.html+"</div>",""]:[e.html],s.EditorConnector.insertLines(r)})).fail((function(e){(0,u.BUG)(e),s.EditorConnector.insertLines(r)}))},t.ajaxStarted=function(){var e=this;e.isAjaxing=!0,e.$keywordSubmit.prop("disabled",!0),e.$indicator.show(),e.$resultIsEmpty.hide()},t.ajaxFinished=function(){var e=this;e.isAjaxing=!1,e.$keywordSubmit.prop("disabled",!1),e.$indicator.hide()},e}();e.exports=f},32226:function(e){e.exports={actions:{RESET_ENTRIES:"ARCHIVES:RESET_ENTRIES",LOAD:"ARCHIVES:LOAD",TOGGLE_SELECTION:"ARCHIVES:TOGGLE_SELECTION",CLEAR_SELECTION:"ARCHIVES:CLEAR_SELECTION",UPDATE_TERM:"ARCHIVES:UPDATE_TERM",START_LOADING:"ARCHIVES:START_LOADING",FINISH_LOADING:"ARCHIVES:FINISH_LOADING"}}},81841:function(e,t,n){n(21249),n(41539),n(66992),n(33948),n(54747);var r=n(92477),i=n(10714),o=n(70879);function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var s=n(32226).actions,u=n(73287),l=n(55063),c=n(27816),d=function(e){var t,n;function u(){return e.apply(this,arguments)||this}n=e,(t=u).prototype=Object.create(n.prototype),t.prototype.constructor=t,a(t,n);var d=u.prototype;return d.setTerm=function(e){this.emit(s.RESET_ENTRIES),this.emit(s.UPDATE_TERM,e)},d.load=function(e,t){var n=this;this.emit(s.START_LOADING),l(e,t).then((function(e){n.emit(s.LOAD,e.entries.map(c)),n.emit(s.FINISH_LOADING,e.has_more)})).catch((function(){n.emit(s.LOAD,[]),n.emit(s.FINISH_LOADING,!1)}))},d.toggleSelection=function(e){this.emit(s.TOGGLE_SELECTION,e)},d.insertEntries=function(e){this.emit(s.CLEAR_SELECTION);var t={hatena:[],markdown:[]};return e.sort((function(e,t){return e.datetime-t.datetime})).forEach((function(e){t.hatena.push("["+e.url+":embed:cite]"),t.markdown.push("["+e.url+":embed:cite]")})),(0,r.extractSyntax)(t.hatena).done((function(e){t.html=["",e.html,""]})).fail((function(e){t.html=t.hatena,(0,o.BUG)(e)})).always((function(){(i.EditorConnector.isiOS()||i.EditorConnector.isAndroid())&&(t.html=t.hatena),i.EditorConnector.insertLines(t)}))},u}(u.Actions);e.exports=new d},25750:function(e,t,n){t.__esModule=!0,t.default=void 0;var r=s(n(67294)),i=s(n(20996)),o=n(64292),a=n(80418);function s(e){return e&&e.__esModule?e:{default:e}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var l=n(81841),c=function(e){var t,n;function s(){return e.apply(this,arguments)||this}n=e,(t=s).prototype=Object.create(n.prototype),t.prototype.constructor=t,u(t,n);var c=s.prototype;return c.render=function(){var e=this,t=this.props.entry,n=+t.datetime,s=i.default.deltaDatetime(t.datetime);return r.default.createElement("div",{className:"item "+(t.isSelected?"selected":""),"data-permalink":t.url,onClick:function(){return e.onClick()},onDoubleClick:function(){return e.onDoubleClick()}},r.default.createElement("div",{className:"item-inner"},r.default.createElement("table",null,r.default.createElement("tbody",null,r.default.createElement("tr",null,r.default.createElement("td",{className:"text"},r.default.createElement("span",{className:"entry-title"},t.title),r.default.createElement(a.Thumbnail,{thumbnails:t.thumbnails}),r.default.createElement("span",{className:"entry-body"},(0,o.trimString)(t.summary,34)),r.default.createElement("time",{className:"meta","data-epoch":n},s)),r.default.createElement("td",{className:"detail"},r.default.createElement("a",{href:t.url,target:"_blank",rel:"noopener noreferrer",onClick:function(t){return e.onLinkClick(t)}},r.default.createElement("i",{className:"blogicon-external"}))))))))},c.onClick=function(){l.toggleSelection(this.props.entry.id)},c.onLinkClick=function(e){e.stopPropagation()},c.onDoubleClick=function(){l.insertEntries([this.props.entry])},s}(r.default.Component);t.default=c},59855:function(e,t,n){n(4129),n(78783),n(38880),t.__esModule=!0,t.EntryList=void 0,n(21249),n(41539),n(66992),n(33948);var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=u(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),i=s(n(25750)),o=n(90381),a=s(n(20996));function s(e){return e&&e.__esModule?e:{default:e}}function u(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(u=function(e){return e?n:t})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var c=n(97670),d=function(e){var t,n;function s(){return e.apply(this,arguments)||this}return n=e,(t=s).prototype=Object.create(n.prototype),t.prototype.constructor=t,l(t,n),s.prototype.render=function(){var e=this.props.entries.map((function(e){return r.createElement(i.default,{key:e.id,entry:e})})),t=this.props.isLoading,n=0===e.length&&!t;return r.createElement("div",{className:"items vertical-items"},e,t?r.createElement(o.LoadingIndicator,{text:a.default.text("edit_form.archive.searching")}):null,n?r.createElement(c,null):null)},s}(r.Component);t.EntryList=d},97670:function(e,t,n){var r,i=(r=n(20996))&&r.__esModule?r:{default:r};function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var a=n(67294),s=function(e){var t,n;function r(){return e.apply(this,arguments)||this}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,o(t,n),r.prototype.render=function(){return a.createElement("div",{className:"error-message active"},i.default.text("edit_form.archive.not_found"))},r}(a.Component);e.exports=s},75568:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.Footer=void 0;var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),o=(r=n(9825))&&r.__esModule?r:{default:r};function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u=n(81841),l=function(e){var t,n;function r(){return e.apply(this,arguments)||this}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,s(t,n);var a=r.prototype;return a.onClick=function(){u.insertEntries(this.props.selectedEntries)},a.render=function(){var e=this,t=0===this.props.selectedEntries.length;return i.createElement("div",{className:"insert-button-wrapper"},i.createElement(o.default,{disabled:t,trackingId:"curation-archive-paste-button",onClick:function(){return e.onClick()}}))},r}(i.Component);t.Footer=l},50932:function(e,t,n){n(41539),n(66992),n(33948),n(57327);var r,i=(r=n(20996))&&r.__esModule?r:{default:r},o=n(3174),a=n(59855),s=n(75568),u=n(46171);function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var c=n(67294),d=n(20762),f=n(98595),p=n(81841),h=function(e){var t,n;function r(){var t;return(t=e.call(this)||this).state={entries:d.getState(),archive:f.getState()},t.updateState=t._updateState.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t)),t}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,l(t,n);var h=r.prototype;return h.componentDidMount=function(){d.on("change",this.updateState),f.on("change",this.updateState)},h._updateState=function(){this.setState({entries:d.getState(),archive:f.getState()})},h.render=function(){var e=this,t=this.state.entries.entries,n=this.state.archive.isLoading,r=this.state.archive;return c.createElement("div",{className:"editor-archive-content"},c.createElement("div",{className:"editor-archive-header"},c.createElement("div",{className:"header curation-header curation-tab-content-inner"},c.createElement("h2",null,i.default.text("edit_form.archive")),c.createElement(o.SearchForm,r))),c.createElement("div",{className:"editor-archive-main"},c.createElement(u.InfiniteScroll,{onScroll:function(){return e.onScroll()}},c.createElement("div",{className:"result"},c.createElement(a.EntryList,{entries:t,isLoading:n})))),c.createElement(s.Footer,{selectedEntries:t.filter((function(e){return e.isSelected}))}))},h.onScroll=function(){var e=this.state.archive,t=e.isLoading,n=e.hasMore,r=e.term;if(!t&&n){var i=this.state.entries.entries,o=Date.parse(i[i.length-1].created)/1e3;p.load(r,o)}},r}(c.Component);e.exports=h},3174:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.SearchForm=void 0,n(64765),n(74916),n(73210);var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),i=a(n(20996)),o=a(n(70881));function a(e){return e&&e.__esModule?e:{default:e}}function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var l=n(81841),c=function(e){var t,n;function a(){return e.apply(this,arguments)||this}n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,u(t,n);var s=a.prototype;return s.render=function(){var e=this;return r.createElement(o.default,{placeholder:i.default.text("edit_form.archive.placeholder"),onSubmit:function(t){return e.search(t)}})},s.search=function(e){var t=e.trim();this.props.isLoading||(l.setTerm(t),l.load(t))},a}(r.Component);t.SearchForm=c},80418:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.Thumbnail=void 0;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=i(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=o?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(67294));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(i=function(e){return e?n:t})(e)}t.Thumbnail=function(e){if(e.thumbnails&&e.thumbnails[60]){var t={backgroundImage:"url("+e.thumbnails[60]+")"};return r.createElement("div",{className:"thumb",style:t})}return null}},27816:function(e){e.exports=function(e){return{id:e.uuid,title:e.title,summary:e.summary,datetime:new Date(e.datetime),created:new Date(e.created),url:e.url,thumbnails:e.thumbnails,isSelected:!1}}},55063:function(e,t,n){n(88674),n(41539),n(66992),n(33948);var r=n(73609).get;e.exports=function(e,t){void 0===e&&(e=""),void 0===t&&(t=null);var n={permission:"public",q:e};return t&&(n.until=t),new Promise((function(e,t){r("entries.json",n).then((function(n){n.entries.length>0?e(n):t()})).fail((function(){t()}))}))}},20489:function(e,t,n){var r=n(67294),i=n(73935),o=n(50932),a=n(81841),s=n(20762),u=n(98595);e.exports={init:function(e){s.init(),u.init(),i.render(r.createElement(o,null),e),a.load()}}},98595:function(e,t,n){function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var i=n(73287),o=n(32226).actions,a=function(e){var t,n;function a(){return e.apply(this,arguments)||this}n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,r(t,n);var s=a.prototype;return s.init=function(){var e=this;this.state={term:"",hasMore:!1,isLoading:!1},i.on(o.UPDATE_TERM,(function(t){e.updateTerm(t),e.emit("change")})),i.on(o.START_LOADING,(function(){e.startLoading(),e.emit("change")})),i.on(o.FINISH_LOADING,(function(t){e.finishLoading(t),e.emit("change")}))},s.updateTerm=function(e){this.state.term=e,this.state.hasMore=!1},s.startLoading=function(){this.state.isLoading=!0},s.finishLoading=function(e){this.state.hasMore=e,this.state.isLoading=!1},a}(i.Store);e.exports=new a},20762:function(e,t,n){function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n(92222),n(41539),n(66992),n(33948),n(69826),n(54747);var i=n(73287),o=n(32226).actions,a=function(e){var t,n;function a(){return e.apply(this,arguments)||this}n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,r(t,n);var s=a.prototype;return s.init=function(){var e=this;this.state={entries:[]},i.on(o.RESET_ENTRIES,(function(){e.resetEntries(),e.emit("change")})),i.on(o.LOAD,(function(t){e.load(t),e.emit("change")})),i.on(o.TOGGLE_SELECTION,(function(t){e.toggleSelection(t),e.emit("change")})),i.on(o.CLEAR_SELECTION,(function(){e.clearSelection(),e.emit("change")}))},s.resetEntries=function(){this.state={entries:[]}},s.load=function(e){this.state={entries:this.state.entries.concat(e).sort((function(e,t){return t.created-e.created}))}},s.toggleSelection=function(e){var t=this.state.entries.find((function(t){return t.id===e}));t.isSelected=!t.isSelected},s.clearSelection=function(){this.state.entries.forEach((function(e){e.isSelected=!1}))},a}(i.Store);e.exports=new a},41205:function(e,t,n){n(19601),n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.AutoCompleteInput=void 0,n(4723),n(74916),n(57327),n(21249);var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=i(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=o?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(67294));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(i=function(e){return e?n:t})(e)}function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=function(e){var t,n;function i(t){var n;u(a(n=e.call(this,t)||this),"input",null),u(a(n),"lineHeight",void 0),u(a(n),"ul",null),u(a(n),"onFocus",(function(){var e=n.getSuggestions(n.state.value,n.props);n.setState({suggestions:e,isFocused:!0}),n.updateRect()}));var r=t.inputProps.value||"",i=n.getSuggestions(r,t);return n.state={value:r,cursor:-1,scroll:0,isFocused:!1,suggestions:i,x:null,y:null,width:null},n.lineHeight=20,n}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,s(t,n),i.getDerivedStateFromProps=function(e){return void 0===e.inputProps.value?null:{value:e.inputProps.value}};var l=i.prototype;return l.componentDidUpdate=function(){this.ul&&0!==this.state.suggestions.length&&(this.lineHeight=this.ul.scrollHeight/this.state.suggestions.length,this.ul.scrollTop=this.state.scroll*this.lineHeight)},l.upCursor=function(){return this.state.cursor<1?this.state.suggestions.length-1:this.state.cursor-1},l.downCursor=function(){return this.state.cursor===this.state.suggestions.length-1?Math.min(0,this.state.suggestions.length-1):this.state.cursor+1},l.onKeyDown=function(e){var t=this.state,n=t.cursor,r=t.value,i=t.suggestions,o=t.scroll;38===e.keyCode&&0!==i.length&&(r=i[n=this.upCursor()],this.setState({value:r}),e.preventDefault()),40===e.keyCode&&0!==i.length&&(r=i[n=this.downCursor()],this.setState({value:r}),e.preventDefault());var a=e.nativeEvent;"BS"===keyString(a)&&""===r&&this.props.onCancel(),"RET"===keyString(a)&&(r.match(/\S+/)&&this.props.onSubmit(r),i=[],n=-1,e.preventDefault(),e.stopPropagation());var s=o+this.props.max;if(n>-1&&i.length>this.props.max)if(n>=s-1){var u=n-(s-2);o=Math.min(o+u,i.length-this.props.max)}else n<o+1&&(o=Math.max(n-1,0));this.setState({suggestions:i,cursor:n,scroll:o})},l.getSuggestions=function(e,t){var n=t.suggestions,r=t.showDefault;return t.filter?e.match(/\S+/)?n.filter((function(t){return-1!==t.indexOf(e)})):r?n:[]:n},l.onChange=function(e){var t=e.target.value,n=this.getSuggestions(t,this.props);this.setState({value:t,suggestions:n}),this.props.onChangeValue&&this.props.onChangeValue(t)},l.onMouseDownSuggestion=function(e){this.setState({cursor:-1}),this.props.onSubmit(e)},l.reset=function(){var e=this.getSuggestions("",this.props);this.setState({value:"",suggestions:e})},l.updateSuggestionList=function(){var e=this;this.setState((function(t,n){return{suggestions:e.getSuggestions(t.value,n)}}))},l.updateRect=function(){var e=this.getRectForSuggestionList();e&&this.setState({x:e.left,y:e.bottom,width:e.right-e.left})},l.getRectForSuggestionList=function(){if(this.props.getSuggestionsListBaseRect){var e=this.props.getSuggestionsListBaseRect();if(e)return e}if(this.input)return this.input.getBoundingClientRect()},l.renderSuggestion=function(e,t){var n=this,i=this.state.cursor===t;return r.createElement("li",{key:t,className:"AutoComplete__Suggestion "+(i?"isOnCursor":""),onMouseDown:function(){return n.onMouseDownSuggestion(e)}},e)},l.renderSuggestionList=function(){var e=this;if(!this.state.isFocused||0===this.state.suggestions.length)return null;var t=Math.min(this.props.max,this.state.suggestions.length),n={x:this.state.x||void 0,y:this.state.y||void 0,width:this.state.width||void 0,height:this.lineHeight?t*this.lineHeight:void 0};return r.createElement("ul",{className:"AutoComplete__SuggestionList",style:n,ref:function(t){e.ul=t}},this.state.suggestions.map((function(t,n){return e.renderSuggestion(t,n)})))},l.render=function(){var e=this;return r.createElement("span",{className:"AutoComplete"},this.props.inputPrefix,r.createElement("input",o({type:"text"},this.props.inputProps,{ref:function(t){e.input=t},value:this.state.value,onChange:function(t){return e.onChange(t)},onKeyDown:function(t){return e.onKeyDown(t)},onFocus:this.onFocus,onBlur:function(){return e.setState({isFocused:!1})}})),this.props.inputSuffix,this.renderSuggestionList())},i}(r.Component);t.AutoCompleteInput=l,u(l,"defaultProps",{suggestions:[],onSubmit:function(){},onCancel:function(){},onChangeValue:function(){},inputProps:{},max:7,showDefault:!1,filter:!0,inputPrefix:null,inputSuffix:null})},11363:function(e,t,n){n(57327),n(92222),n(47042),n(26699),n(32023);var r,i=n(90242),o=n(45298),a=n(23983),s=n(24367),u=n(4205),l=(r=n(26307))&&r.__esModule?r:{default:r};function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var d=n(67294),f=function(e){var t,n;function r(t){var n;return(n=e.call(this)||this).state={categories:t.categories,selectedCategories:t.selectedCategories},n}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,c(t,n);var f=r.prototype;return f.toggleCategory=function(e){var t=this.state.selectedCategories,n=t.indexOf(e);-1!==n?this.setState({selectedCategories:t.filter((function(e,t){return t!==n}))}):this.setState({selectedCategories:[].concat(t,[e])})},f.removeLastCategory=function(){var e=this.state.selectedCategories;this.setState({selectedCategories:[].concat(e.slice(0,-1))})},f.addCategory=function(e){var t=this.state.categories,n=(0,s.formatCategoryName)(e);n&&(t.includes(n)||this.setState({categories:[].concat(t,[n])}),this.toggleCategory(n))},f.onSortStart=function(){l.default.on()},f.onSortEnd=function(e){var t=e.oldIndex,n=e.newIndex,r=this.state.selectedCategories,i=(0,u.arrayMove)(r,t,n);this.setState({selectedCategories:i}),l.default.off()},f.render=function(){var e=this,t=this.state,n=t.categories,r=t.selectedCategories;return d.createElement("div",{className:"editor-sidebar-category_CategoryEditor"},d.createElement(i.CategoryHeader,{categories:n,selectedCategories:r,onSubmit:function(t){return e.addCategory(t)},onCancel:function(){return e.removeLastCategory()},onClickRemoveBtn:function(t){return e.toggleCategory(t)},onSortStart:function(){return e.onSortStart()},onSortEnd:function(t){return e.onSortEnd(t)}}),d.createElement(a.NewCategoryButton,{onSubmit:function(t){return e.addCategory(t)}}),d.createElement(o.CategoryList,{categories:n,selectedCategories:r,onClickCategory:function(t){return e.toggleCategory(t)}}))},r}(d.Component);e.exports=f},59631:function(e,t,n){var r=n(67294),i=n(73935),o=n(91269),a=n(11363),s=n(67516),u=function(e){return e.canSet?r.createElement(a,e):r.createElement(s,null)};e.exports=function(){this.type="editor-category";var e=o.get("editor.categories.canSet"),t=document.querySelector("#editor-category"),n=o.get("editor.categories")||[],a=o.get("editor.selectedCategories")||[];i.render(r.createElement(u,{categories:n,selectedCategories:a,canSet:e}),t)}},90242:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.CategoryHeader=void 0,n(57327),n(26699),n(32023);var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=l(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),o=(r=n(20996))&&r.__esModule?r:{default:r},a=n(41205),s=n(43609),u=n(55992);function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(l=function(e){return e?n:t})(e)}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var p=function(e){var t,n;function r(t){var n;return f(c(n=e.call(this,t)||this),"input",null),f(c(n),"onSubmit",(function(e){n.props.onSubmit(e),n.input.reset()})),n}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,d(t,n);var l=r.prototype;return l.focusEditor=function(){this.input.input.focus()},l.render=function(){var e=this,t=this.props.selectedCategories,n=this.props.categories.filter((function(t){return!e.props.selectedCategories.includes(t)}));return i.createElement("div",{className:"editor-sidebar-category_CategoryHeader"},i.createElement("label",{htmlFor:"editor-sidebar-category_Input"},i.createElement("h2",{className:"CategoryHeaderHeading"},o.default.text("blog.category"))),i.createElement("p",null,o.default.text("edit_form.category_description2"),i.createElement("a",{href:(0,u.helpUrl)("/entry/editor/category"),target:"_blank",rel:"noopener noreferrer"},o.default.text("epic.show_detail"))),i.createElement("div",{className:"CategoryInput",onClick:function(){return e.focusEditor()}},i.createElement(s.SortableSelectedCategories,{selectedCategories:t,onClickRemoveBtn:function(t){return e.props.onClickRemoveBtn(t)},onSortStart:function(){e.props.onSortStart()},onSortEnd:function(t){e.props.onSortEnd(t)},helperClass:"sortableHelper",axis:"xy",distance:5}),i.createElement(a.AutoCompleteInput,{ref:function(t){e.input=t},inputProps:{id:"editor-sidebar-category_Input",className:"Input",autoComplete:"off"},suggestions:n,onSubmit:this.onSubmit,onCancel:this.props.onCancel})),i.createElement("p",{className:"categoryAsideNotice"},o.default.text("edit_form.category_aside_notice")))},r}(i.Component);t.CategoryHeader=p},45298:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.CategoryList=void 0,n(26699),n(32023),n(21249);var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=i(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=o?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(67294));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(i=function(e){return e?n:t})(e)}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var a=function(e){var t,n;function i(){return e.apply(this,arguments)||this}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,o(t,n);var a=i.prototype;return a.isSelected=function(e){return this.props.selectedCategories.includes(e)},a.formatKey=function(e){return encodeURIComponent(e)},a.renderCategoryListItem=function(e){var t=this;return this.isSelected(e)?r.createElement("li",{key:this.formatKey(e),className:"selected",onClick:function(){return t.props.onClickCategory(e)}},r.createElement("span",{className:"category"},e)):r.createElement("li",{key:this.formatKey(e),onClick:function(){return t.props.onClickCategory(e)}},e)},a.render=function(){var e=this;return r.createElement("ul",{id:"existing-categories",className:"editor-sidebar-category_CategoryList"},this.props.categories.map((function(t){return e.renderCategoryListItem(t)})))},i}(r.Component);t.CategoryList=a},23983:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.NewCategoryButton=void 0;var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),o=(r=n(20996))&&r.__esModule?r:{default:r};function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u=function(e){var t,n;function r(){return e.apply(this,arguments)||this}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,s(t,n);var a=r.prototype;return a.onClick=function(){var e=window.prompt(o.default.text("category.new.prompt"));e&&this.props.onSubmit(e)},a.render=function(){var e=this;return i.createElement("div",{className:"editor-sidebar-category_NewCategoryButton"},i.createElement("div",{className:"NewCategoryButtonText",onClick:function(){return e.onClick()}},i.createElement("i",{className:"blogicon-plus"})," ",o.default.text("category.new")))},r}(i.Component);t.NewCategoryButton=u},43609:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.SortableSelectedCategories=void 0,n(21249);var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),i=n(4205),o=n(15604);function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}var s=(0,i.SortableContainer)((function(e){var t=e.selectedCategories,n=e.onClickRemoveBtn;return r.createElement("span",{className:"editor-sidebar-category_Categories"},t.map((function(e,t){return r.createElement(o.SortableSelectedCategory,{key:encodeURIComponent(e),index:t,selectedCategory:e,onClickRemoveBtn:n})})))}));t.SortableSelectedCategories=s},15604:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.SortableSelectedCategory=void 0;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=i(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=o?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(67294));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(i=function(e){return e?n:t})(e)}var o=(0,n(4205).SortableElement)((function(e){var t=e.selectedCategory,n=e.onClickRemoveBtn;return r.createElement("div",{className:"editor-sidebar-category_Category","data-category-name":t},r.createElement("span",{className:"name"},t),r.createElement("button",{type:"submit",className:"RemoveBtn",onClick:function(e){e.preventDefault(),e.stopPropagation(),n(t)}},r.createElement("i",{className:"blogicon-close"})),r.createElement("input",{type:"hidden",name:"category",value:t,"data-with-backup":!0}))}));t.SortableSelectedCategory=o},67516:function(e,t,n){var r,i=(r=n(20996))&&r.__esModule?r:{default:r};function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var a=n(67294),s=function(e){var t,n;function r(){return e.apply(this,arguments)||this}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,o(t,n),r.prototype.render=function(){return a.createElement("div",{className:"CategoryEditor"},a.createElement("div",{className:"CategoryHeader"},a.createElement("h2",null,i.default.text("blog.category")),a.createElement("p",null,i.default.text("blog.category.unavailable"))))},r}(a.Component);e.exports=s},83902:function(e,t,n){e.exports=n(59631)},88346:function(e,t){t.__esModule=!0,t.DAZN_CHANNELS=t.API_ENDPOINT=void 0;t.API_ENDPOINT="/api/dazn";t.DAZN_CHANNELS=[{name:"すべて",channels:[{id:"",name:"すべて"}]},{name:"サッカー",channels:[{id:"F4433F395A264E1A96539FA4AEA62EF",name:"プレミアリーグ"},{id:"96A71ECA0B8F4FAFA267C4637628E83B",name:"リーガ・エスパニョーラ"},{id:"9EBA1139EF334ECBA03DFBAAEAFC1BB7",name:"ブンデスリーガ"},{id:"ACC896A0FE484AB38518A0D0B7EB7795",name:"リーグアン"},{id:"C0CBEE8AB6D741D6827DB8ACBECF9571",name:"セリエA"},{id:"2A0C93A0A0AB4655B7BB331400A5043",name:"チャンピオンズリーグ"},{id:"1kplj22px43b11wk1kadu2nr39",name:"UEFA ヨーロッパリーグ"},{id:"6gyrzeim2dwl1d0excvgxca1u",name:"J1 League – JP"},{id:"1g6fhxbcglxt5128bqeqwiwa5k",name:"J2 League – JP"},{id:"ffvjpbv2a63p1jko34cukjxut",name:"J3 League – JP"},{id:"E9D256F54119471BB65B2D548111573E",name:"サッカー：各国代表戦（親善試合など）"},{id:"488AAE72FF434C45A6ABB519F15A565",name:"サッカー：欧州リーグ（5大リーグ以外）"},{id:"hw3xsyj2ij381unosidf7d2li",name:"サッカー: コパ・アメリカ"},{id:"1m2gjj02oo2gl1h4kj452lrb0t",name:"ワールドカップニュース"},{id:"unlw2iar4lduzvjlu1aggnwy",name:"UCL Archive"},{id:"69CF724DFD24498CBAFC5637DBD16C39",name:"サッカー:アジアリーグ"},{id:"C12C3C0B4FE444F4A75EA9A8CC6B8481",name:"MLS&南米サッカー(JP)"},{id:"1synmnu9m5oyh1bi9kmigoggvp",name:"サッカー日本代表戦ハイライト"}]},{name:"ラグビー",channels:[{id:"tq4x6po6e55v1f6bnv4jxye32",name:"ラグビーリーグ"},{id:"1jt67pfg4hxxe16vsy0v10atex",name:"ラグビーワールドカップ"},{id:"x0tjhfhgjv6z1tfokt8e456sd",name:"ラグビーユニオン"}]},{name:"モータースポーツ",channels:[{id:"CCA50690AB7E2912E0440021281A8A86",name:"Autosport TV (JP)"},{id:"gjr8ps1pnr4w123wk3qnht8rh",name:"Autosport TV:Fシリーズ以外"}]},{name:"バレーボール",channels:[{id:"qtrofp6czyzb1xyu3tr3jb7o4",name:"Vリーグ (V-League)"}]},{name:"テニス",channels:[{id:"wk9s8s24nhdv1oh7ni1rcx3n1",name:"テニス: WTA(女子テニス)"},{id:"caelhxv70zfg1lq0eds2jrdp4",name:"テニス: ATP(男子テニス)"}]},{name:"野球",channels:[{id:"1hdbd5ra64enh1ef79ld10a08u",name:"NPB:Central league"},{id:"439FF2318532453A9F6F82E9D420035",name:"NPB:Paciffic league"},{id:"18v8wmvtevku513zn6dlzrekns",name:"NPB:Pre season matches"},{id:"1weibsujwjtr919wpccu8gaatf",name:"MLB"}]},{name:"格闘技",channels:[{id:"36876F5ACF14456FAEFC142E7FB94D99",name:"Fighting Sport"}]},{name:"サイクリング",channels:[{id:"12kz7qhv0tbcj11iolbtngiwvn",name:"Cycling – JP"}]},{name:"バスケ",channels:[{id:"n1ogbm1buyaz1v6mdhim90k0g",name:"FIBAワールドカップ(JP)"},{id:"e7127ff5-b828-43ee-bab8-3548c15d96cb",name:"LiveBasketball.TV - FIBA"},{id:"44qngj5fdvvg1fawfldx46t81",name:"バスケ:Bリーグ"},{id:"B77272C671834ADDB42520B8C871B975",name:"NBA TV (jp)"}]},{name:"アメフト",channels:[{id:"anin0x73jf59100tzafi4znpp",name:"NFL(Japan)"}]},{name:"その他",channels:[{id:"1fybbl64d2qbl1brg302ycusmx",name:"スポーツニュース"}]}]},98296:function(e,t,n){n(47042),n(68309),n(91038),n(78783),n(82526),n(41817),n(32165),n(66992),n(33948),t.__esModule=!0,t.DaznViewModel=void 0,n(19601),n(88674),n(41539),n(92222),n(26699),n(32023),n(57327),n(21249);var r=n(17187),i=n(10714),o=n(90872);function a(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var l=n(81191),c=function(e){var t,n;function r(){var t,n,r,i;return t=e.call(this)||this,n=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t),i=void 0,(r="state")in n?Object.defineProperty(n,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[r]=i,t.state={items:[],selectedItemIds:[],page:1,keyword:"",channelId:"",hasNext:!1,error:null,isLoading:!1,isFirst:!0},t}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,u(t,n);var s=r.prototype;return s.setState=function(e){this.state=Object.assign({},this.state,e),this.emit("change")},s.getState=function(){return Object.assign({},this.state)},s.searchItems=function(){var e=this,t=this.state.keyword;return/^\s*$/.test(t)&&(t=""),this.setState({keyword:t,isLoading:!0,isFirst:!1}),(0,o.fetchAPI)({keyword:t,channel_id:this.state.channelId,page:1}).then((function(t){e.setState({items:t.items,hasNext:t.hasNext,error:null,selectedItemIds:[]})})).catch((function(t){e.setState({error:t})})).then((function(){e.setState({isLoading:!1})}))},s.loadNextItems=function(){var e=this;if(!this.state.hasNext||this.state.error)return Promise.resolve();this.setState({isLoading:!0});var t=this.state.keyword,n=this.state.channelId,r=this.state.page+1;return(0,o.fetchAPI)({keyword:t,channel_id:n,page:r}).then((function(t){e.setState({items:e.state.items.concat(t.items),hasNext:t.hasNext,page:r})})).catch((function(t){e.setState({error:t})})).then((function(){e.setState({isLoading:!1})}))},s.toggleItemSelection=function(e){var t=this.state.selectedItemIds.includes(e.itemId)?this.state.selectedItemIds.filter((function(t){return t!==e.itemId})):[].concat(this.state.selectedItemIds,[e.itemId]);this.setState({selectedItemIds:t})},s.insertSelectedItems=function(){for(var e,t={},n=a(this.state.items);!(e=n()).done;){var r=e.value;t[r.itemId]=r}var o=this.state.selectedItemIds.map((function(e){return"[dazn:"+t[e].itemId+"]"}));i.EditorConnector.insertLines({html:o,hatena:o,markdown:o}),l.trackEvent("curation-dazn-insert-item"),this.setState({selectedItemIds:[]})},s.insertItem=function(e){var t=["[dazn:"+e.itemId+"]"];i.EditorConnector.insertLines({html:t,hatena:t,markdown:t}),l.trackEvent("curation-dazn-insert-item"),this.isItemSelected(e)&&this.toggleItemSelection(e)},s.isItemSelected=function(e){return this.state.selectedItemIds.includes(e.itemId)},s.hasSelectedItems=function(){return this.state.selectedItemIds.length>0},s.onInputChange=function(e){this.setState({keyword:e})},s.onSelectChange=function(e){this.setState({channelId:e,items:[],selectedItemIds:[]}),this.searchItems()},r}(r.EventEmitter);t.DaznViewModel=c},49063:function(e,t,n){t.__esModule=!0,t.DaznSearchForm=void 0,n(21249),n(68309);var r=a(n(67294)),i=n(88346),o=a(n(20996));function a(e){return e&&e.__esModule?e:{default:e}}var s=n(41960);t.DaznSearchForm=function(e){return r.default.createElement("div",{className:"editor-sidebar-dazn_search"},r.default.createElement("div",{className:"sidebar-search-form"},r.default.createElement("input",{type:"text",placeholder:e.placeholder,className:"sidebar-search-form__input",onKeyPress:function(t){!function(e,t){"RET"===s(e)&&(e.preventDefault(),t())}(t,e.onSubmit)},onChange:function(t){e.onInputChange(t.target.value)}}),r.default.createElement("button",{type:"button",className:"sidebar-search-form__submit",onClick:e.onSubmit,"aria-label":o.default.text("search")},r.default.createElement("i",{className:"blogicon-search"}))),r.default.createElement("div",{className:"formats-title search-channel-wrapper"},r.default.createElement("select",{name:"dazn-search-channel",className:"search-channel",defaultValue:"",onChange:function(t){return e.onSelectChange(t.target.value)}},i.DAZN_CHANNELS.map((function(e){return r.default.createElement("optgroup",{label:e.name,key:e.name},e.channels.map((function(e){return r.default.createElement("option",{value:e.id,key:e.id},e.name)})))})))))}},38974:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.DaznSidebar=void 0,n(21249);var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=d(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),o=(r=n(20996))&&r.__esModule?r:{default:r},a=n(46171),s=n(49063),u=n(90381),l=n(34007),c=n(1199);function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(d=function(e){return e?n:t})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=function(e){var t,n;function r(t){var n;return function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(n=e.call(this,t)||this),"update",void 0),n.state=t.vm.getState(),n.update=function(){return n.setState(t.vm.getState())},n}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,f(t,n);var d=r.prototype;return d.componentDidMount=function(){this.props.vm.on("change",this.update)},d.componentWillUnmount=function(){this.props.vm.off("change",this.update)},d.render=function(){var e=this.props.vm,t=this.state,n=t.items,r=t.keyword,d=t.channelId,f=t.isFirst,p=t.isLoading,h=!f&&!p&&0===n.length;return i.createElement("div",{className:"editor-dazn-content"},i.createElement("div",{className:"editor-dazn-header"},i.createElement("h2",null,o.default.text("edit_form.dazn")),i.createElement(s.DaznSearchForm,{keyword:r,channelId:d,placeholder:o.default.text("edit_form.dazn.placeholder"),onInputChange:function(t){return e.onInputChange(t)},onSelectChange:function(t){return e.onSelectChange(t)},onSubmit:function(){return e.searchItems()}})),i.createElement("div",{className:"editor-dazn-main"},i.createElement(a.InfiniteScroll,{onScroll:function(){return e.loadNextItems()},interval:1e3},i.createElement("div",{className:"editor-dazn-items"},n.map((function(t,n){return i.createElement(c.Item,{item:t,key:n,isSelected:e.isItemSelected(t),onSelect:function(){return e.toggleItemSelection(t)},onDoubleClick:function(){return e.insertItem(t)}})})),f&&i.createElement("div",{className:"editor-dazn-items-message"},o.default.text("edit_form.dazn.description")),h&&i.createElement("div",{className:"editor-dazn-items-message"},o.default.text("edit_form.dazn.empty")),p&&i.createElement(u.LoadingIndicator,null)))),i.createElement(l.Footer,{hasSelectedItems:e.hasSelectedItems(),onSubmit:function(){return e.insertSelectedItems()}}))},r}(i.Component);t.DaznSidebar=p},34007:function(e,t,n){t.__esModule=!0,t.Footer=void 0;var r=o(n(67294)),i=o(n(9825));function o(e){return e&&e.__esModule?e:{default:e}}t.Footer=function(e){return r.default.createElement("div",{className:"editor-sidebar-dazn_footer"},r.default.createElement(i.default,{disabled:!e.hasSelectedItems,onClick:e.onSubmit}))}},1199:function(e,t,n){t.__esModule=!0,t.Item=void 0;var r=a(n(67294)),i=a(n(20996)),o=n(74868);function a(e){return e&&e.__esModule?e:{default:e}}t.Item=function(e){return r.default.createElement("div",{className:"editor-sidebar-dazn_item item "+(e.isSelected?"selected":""),onClick:e.onSelect,onDoubleClick:e.onDoubleClick},r.default.createElement("div",{className:"inner"},r.default.createElement("div",{className:"thumbnail-wrapper"},r.default.createElement("img",{className:"thumbnail",src:e.item.thumbnail.url,width:e.item.thumbnail.width,height:e.item.thumbnail.height,alt:""}),r.default.createElement("span",{className:"duration"},(0,o.formatDuration)(e.item.duration))),r.default.createElement("div",{className:"info-container"},r.default.createElement("div",{className:"name"},e.item.itemTitle),r.default.createElement("div",{className:"channel"},e.item.channel),r.default.createElement("span",{className:"publishedTime"},i.default.deltaDatetime(new Date(e.item.publishedTime))))))}},90872:function(e,t,n){t.__esModule=!0,t.fetchAPI=void 0;var r,i=(r=n(347))&&r.__esModule?r:{default:r},o=n(70879),a=n(88346);t.fetchAPI=function(e){return i.default.get(a.API_ENDPOINT,{params:e}).then((function(e){if(e.data.error)throw e.data.error;return e.data}),(function(e){throw(0,o.BUG)(e),-1}))}},57833:function(e,t,n){t.__esModule=!0,t.Dazn=void 0;var r,i=(r=n(67294))&&r.__esModule?r:{default:r},o=n(73380),a=n(38974),s=n(98296);t.Dazn=function(e){var t=new s.DaznViewModel;(0,o.safeRender)(i.default.createElement(a.DaznSidebar,{vm:t}),e.container)}},43265:function(e,t,n){t.__esModule=!0,t.EditorSidebar=void 0,n(69826),n(92222);var r,i=(r=n(73609))&&r.__esModule?r:{default:r},o=n(17187),a=n(80417);function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=n(19165),c=function(){function e(e){var t=this;u(this,"editor",void 0),u(this,"eventEmitter",void 0),u(this,"$editor",void 0),u(this,"$container",void 0),u(this,"$services",void 0),u(this,"$header",void 0),u(this,"$footer",void 0),u(this,"_type",void 0),u(this,"isOpen",void 0),u(this,"sidebarButtons",void 0),this.editor=e,this.eventEmitter=new o.EventEmitter,this.eventEmitter.setMaxListeners(100),this.$editor=(0,i.default)("#editor"),this.$container=(0,i.default)("#editor-support-container"),this.$services=this.$container.find(".services"),this.$header=this.$container.find(".header"),this.$footer=this.$container.find(".footer"),this._type="editor-home",this.isOpen=!0,this.sidebarButtons=new a.SidebarButtons(this.$container.find(".curation-bar-itemlist"),this,this.editor.getPublicationType()),this.bindEvents(),this.restoreLastStatus(),setTimeout((function(){return t.emit("resize",t._type)}),0)}var t,n,r,c=e.prototype;return c.bindEvents=function(){var e=this;this.on("toggle",(function(){return e.toggle()})),this.on("openByType",(function(t){return e.openByType(t)})),this.editor.on("resize",(function(){return e.emit("resize",e._type)}))},c.restoreLastStatus=function(){var e=l.load("sidebar-status");e&&(this._type=e.type,this.isOpen=e.is_open),this.$editor.attr("data-sidebar-type")&&(this._type=this.$editor.attr("data-sidebar-type"),this.isOpen=!0),this.isOpen&&this.openByType(this._type)},c.isOpening=function(){return(0,i.default)(document.body).hasClass("support-shown")},c.toggle=function(){this.isOpening()?this.close():this.openByType(this._type)},c.openByType=function(e){if(e){var t=this.$container.find("#"+e);t.get(0)?(this._type=e,this.$container.find(".curation-tab-content").hide(),(0,i.default)(document.body).addClass("support-shown"),t.show(),t.triggerHandler("show"),this.isOpen=!0,this.save(),this.emit("tabChange",e)):this.openByType("editor-home")}else this.close()},c.close=function(){(0,i.default)(document.body).removeClass("support-shown");var e=this.$container.find(".curation-itemlist.active");e.removeClass("active"),e.removeClass(e.attr("data-icon-class-when-active")),e.addClass(e.attr("data-icon-class")),this.isOpen=!1,this.save(),this.emit("tabChange","none")},c.save=function(){l.save("sidebar-status",{is_open:this.isOpen,type:this._type})},c.on=function(e,t){this.eventEmitter.on(e,t)},c.emit=function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(t=this.eventEmitter).emit.apply(t,[e].concat(r))},t=e,(n=[{key:"type",get:function(){return this._type}}])&&s(t.prototype,n),r&&s(t,r),e}();t.EditorSidebar=c},76728:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.EmbedBox=void 0,n(69826),n(4723),n(74916),n(54747);var r=l(n(73609)),i=l(n(13469)),o=l(n(57942)),a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=u(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(55992)),s=n(23042);function u(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(u=function(e){return e?n:t})(e)}function l(e){return e&&e.__esModule?e:{default:e}}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=n(36500),f=n(41960),p=n(59662),h=n(26410),m=n(81191).trackEvent,v=function(){function e(e){var t=this;if(c(this,"editor",void 0),c(this,"$container",void 0),c(this,"$urlInput",void 0),c(this,"$previewButton",void 0),c(this,"$embedTypes",void 0),c(this,"$pasteButton",void 0),c(this,"$showEmbedCheckbox",void 0),c(this,"candidates",void 0),c(this,"session",void 0),c(this,"selectionRange",void 0),c(this,"selectionRangeInTimer",void 0),c(this,"selectionContent",void 0),c(this,"selectionContentInTimer",void 0),this.editor=e.editor,this.$container=e.$container,this.$urlInput=this.$container.find(".js-embed-url"),this.$previewButton=this.$container.find(".js-preview-button"),this.$embedTypes=this.$container.find(".js-embed-types"),this.$pasteButton=this.$container.find(".js-paste-button"),this.$showEmbedCheckbox=this.$container.find(".js-show-embed-box-on-paste-url"),this.candidates=[],this.session=r.default.Deferred(),this.session.reject(),this.$container.on("click",".js-close",(function(){t.hide()})),this.$previewButton.on("click",(function(){t.requestPreview()})),this.$urlInput.on("keydown",(function(e){"RET"===f(e)&&(t.requestPreview(),e.preventDefault(),e.stopPropagation())})),this.$pasteButton.on("click",(function(){t.requestPaste()})),this.$container.on("keydown",":input",(function(e){"ESC"===f(e)&&(t.hide(),e.preventDefault(),e.stopPropagation())})),p.isIE){var n=this.editor;setInterval((function(){try{t.selectionRangeInTimer=n.getSelectionRange(),t.selectionContentInTimer=n.isCollapsed()?null:n.getSelectionText()}catch(e){}}),1e3)}var i="EmbedBox.show-embed-box-on-paste-url",o=!0;try{o="false"!==localStorage.getItem(i)}catch(e){}o&&this.$showEmbedCheckbox.prop("checked",!0),this.$showEmbedCheckbox.on("change",(function(){var e=t.isEnabledOnPasteURL();localStorage.setItem(i,String(e)),m("EmbedBox.showFromPaste.setEnable."+e)})),(0,r.default)(document).on("show-embed-box",(function(){t.show()})),this.$embedTypes.on("change",":input",(function(e){var n=(0,r.default)(e.currentTarget);t.$embedTypes.find(".js-embed-type.selected").removeClass("selected"),n.parents(".js-embed-type").toggleClass("selected")})),this.$embedTypes.on("dblclick",".js-embed-type",(function(){t.requestPaste()}))}var t=e.prototype;return t.isEnabledOnPasteURL=function(){return this.$showEmbedCheckbox.prop("checked")},t.show=function(){var e=this;if(!this.isShown())return this.$container.css("left",((0,r.default)(window).width()-this.$container.width())/2),this.$embedTypes.find(".js-embed-type.selected").removeClass("selected"),h.show(this.$container,{showBackground:!0,destroy:function(){e.onHide()}}),i.default.defer((function(){e.$urlInput.focus().first().select()})),this.checkSelection(),m("EmbedBox.show"),this.session=r.default.Deferred(),this.session.promise()},t.setURL=function(e){this.$urlInput.val(e)},t.isShown=function(){return this.$container.is(":visible")},t.hide=function(){h.hide(this.$container)},t.onHide=function(){this.session.reject(),this.reset()},t.checkSelection=function(){if(p.isIE)this.selectionRange=this.selectionRangeInTimer,this.selectionContent=this.selectionContentInTimer;else{var e=this.editor;this.selectionRange=e.getSelectionRange(),this.selectionContent=e.isCollapsed()?null:e.getSelectionText()}},t.requestPreview=function(){var e=this,t=this.$urlInput.val();t&&(t.match(/^https?:\/\//)||(t="http://"+t),this.reset(),i.default.defer((function(){e.$pasteButton.prop("disabled",!1).removeClass("disabled").focus()})),this.selectionRange&&this.selectionContent&&this.candidates.push(this.createQuoteCandidate(t,this.selectionContent)),this.candidates.push(this.createImageCandidate(t)),this.candidates.push(this.createEmbedCandidate(t)),this.candidates.push(this.createTitleCandidate(t)),this.candidates.push(this.createURLCandidate(t)))},t.reset=function(){this.candidates.forEach((function(e){e.kill()})),this.candidates=[],this.$pasteButton.prop("disabled",!0).addClass("disabled")},t.requestPaste=function(){if(!this.$pasteButton.is(":disabled")){var e=this.candidates.find((function(e){return e.isChecked()}))||this.candidates.find((function(e){return e.isEnabled()}));e&&(m("EmbedBox.paste"),m("EmbedBox.paste."+e.type),this.session.resolve(e),e.paste(),this.hide())}},t.createEmbedCandidate=function(e){var t,n=(0,r.default)('<iframe width="100%" scrolling="no">'),o=a.partsUrl("/preview_url_embed")+"?"+r.default.param({url:e}),u=r.default.Deferred();i.default.defer((function(){var e=d.createForFrame(n[0],o);e.addEventListener("resize",(function(e){n.css("height",e),u.resolve()})),e.addEventListener("close",(function(){n.remove(),u.reject()}))}));var l=document.createElement("a");return l.href=e,"itunes.apple.com"===l.host||"twitter.com"===l.host&&l.pathname.match(/\/status\//)||l.host.match(/flickr\.com/)&&l.pathname.match(/\/photos\//)?(t="["+e+":embed]","html"===(0,r.default)("#syntax").val()&&(t+="\n\n ")):t="["+e+":embed:cite]",new s.EmbedBoxCandidate({$root_container:this.$container,type:"embed",syntax:t,loader:u.promise(),$preview:n,editor:this.editor})},t.createImageCandidate=function(e){var t=r.default.Deferred(),n=(0,r.default)("<img>").on("load",(function(){t.resolve()})).on("error",(function(){t.reject()})).attr("src",e);return new s.EmbedBoxCandidate({$root_container:this.$container,type:"image",selectionRange:this.selectionRange,syntax:"["+e+":image="+e+"]",loader:t.promise(),$preview:n,editor:this.editor})},t.createTitleCandidate=function(e){var t=(0,r.default)("<div>"),n=r.default.Deferred();return r.default.ajax({type:"POST",dataType:"json",url:"/api/extract_title",data:{url:e,rkm:(0,o.default)("rkm"),rkc:(0,o.default)("rkc")}}).done((function(e){e.title?(t.text(e.title),n.resolve()):n.reject()})).fail((function(){n.reject()})),new s.EmbedBoxCandidate({$root_container:this.$container,type:"title",selectionRange:this.selectionRange,syntax:"["+e+":title]",loader:n.promise(),$preview:t,editor:this.editor})},t.createURLCandidate=function(e){var t=(0,r.default)("<div>").text(e);return new s.EmbedBoxCandidate({$root_container:this.$container,type:"url",selectionRange:this.selectionRange,syntax:"["+e+"]",loader:r.default.Deferred().resolve().promise(),$preview:t,editor:this.editor})},t.createQuoteCandidate=function(e,t){var n=this,i=(0,r.default)("<pre>").text(t);return new s.EmbedBoxCandidate({$root_container:this.$container,type:"quote",selectionRange:this.selectionRange,syntax:"["+e+":title="+t+"]",loader:r.default.Deferred().resolve().promise(),$preview:i,paste:function(){var t=n.editor;t.setSelectionRange(n.selectionRange),t.createLink(e)},editor:this.editor})},e}();t.EmbedBox=v},23042:function(e,t,n){t.__esModule=!0,t.EmbedBoxCandidate=void 0,n(69826),n(23123),n(74916),n(88674),n(41539);var r=n(92477),i=n(10714);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a=function(){function e(e){var t=this;o(this,"type",void 0),o(this,"selectionRange",void 0),o(this,"editor",void 0),o(this,"syntax",void 0),o(this,"$container",void 0),o(this,"$radio",void 0),o(this,"$previewContainer",void 0),o(this,"loader",void 0),this.type=e.type,this.selectionRange=e.selectionRange,this.editor=e.editor,this.syntax=e.syntax,e.paste&&(this.paste=e.paste),this.$container=e.$root_container.find('[data-embed-type="'+this.type+'"]'),this.$container.hide(),this.$radio=this.$container.find(".js-type-select"),this.$radio.prop("checked",!1),this.$previewContainer=this.$container.find(".js-preview-container"),this.$previewContainer.hide(),this.$previewContainer.append(e.$preview),this.loader=e.loader,this.loader.done((function(){t.enable()})).fail((function(){t.disable()}))}var t=e.prototype;return t.isEnabled=function(){return"resolved"===this.loader.state()},t.enable=function(){this.$container.show(),this.$previewContainer.show()},t.disable=function(){this.$container.hide(),this.$previewContainer.empty()},t.kill=function(){this.disable()},t.isChecked=function(){return this.$radio.prop("checked")},t.paste=function(){var e=this;this.getSyntaxLines().then((function(t){e.selectionRange&&e.editor.setSelectionRange(e.selectionRange),i.EditorConnector.insertLines(t)}))},t.getSyntaxLines=function(){var e=this,t=this.syntax.split("\n"),n={html:t,hatena:t,markdown:t};return new Promise((function(t){(0,r.extractSyntax)(e.syntax).done((function(e){n.html=[e.html]})).always((function(){t(n)}))}))},e}();t.EmbedBoxCandidate=a},45241:function(e,t,n){n(4129),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.EmbedBoxFotoCaption=void 0,n(69826),n(88674),n(41539);var r=h(n(73609)),i=h(n(84395)),o=h(n(57394)),a=h(n(75603)),s=h(n(1845)),u=h(n(59198)),l=n(75560),c=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=p(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),d=n(73380),f=n(27499);function p(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(p=function(e){return e?n:t})(e)}function h(e){return e&&e.__esModule?e:{default:e}}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var v=n(41960),g=n(26410),b=n(81191).trackEvent,y=function(){function e(e){if(m(this,"editor",void 0),m(this,"expr",void 0),m(this,"thumbnailUrls",void 0),m(this,"$container",void 0),m(this,"$captionInput",void 0),m(this,"$pasteForm",void 0),m(this,"$altAttrLabelAndInputPanel",void 0),m(this,"$altCheckbox",void 0),m(this,"$uploadErrorBox",void 0),m(this,"thumbnailsPanel",void 0),m(this,"altFormPanel",void 0),m(this,"altFormRef",null),m(this,"submitContainerPanel",void 0),m(this,"resolve",void 0),this.expr="",void 0===e.editor||void 0===e.$container)throw new TypeError("Both editor and $container must be specified");this.editor=e.editor,this.$container=e.$container,this.$altAttrLabelAndInputPanel=this.$container.find(".js-embed-foto-detail"),this.$altCheckbox=this.$container.find(".js-checkbox-whether-alt-form"),this.$captionInput=this.$container.find(".js-embed-foto-caption"),this.$pasteForm=this.$container.find(".embed-box-form"),this.$uploadErrorBox=this.$container.find(".error-box"),this.thumbnailUrls=[],this.thumbnailsPanel=this.$container[0].querySelector(".js-thumbnails-panel"),this.altFormPanel=this.$container[0].querySelector(".js-alt-input-panel"),this.submitContainerPanel=this.$container[0].querySelector(".js-embed-submit-container"),this.registerEvents()}var t=e.prototype;return t.registerEvents=function(){var e=this;this.$container.on("click",".js-close",(function(){e.hide()})),this.$pasteForm.on("submit",(function(t){t.stopPropagation(),t.preventDefault(),e.doPaste()})),this.$container.on("keydown",":input",(function(t){"ESC"===v(t)&&e.hide()})),this.$altCheckbox.on("click",(function(t){e.$altAttrLabelAndInputPanel.toggleClass("is-hidden")}))},t.setThumbnailUrls=function(e){this.thumbnailUrls=e},t.show=function(e){var t=this;return this.isShown()||(this.$container.css("left",((0,r.default)(window).width()-this.$container.width())/2),e?this.$uploadErrorBox.removeClass("is-hidden"):this.$uploadErrorBox.addClass("is-hidden"),(0,d.safeRender)(c.createElement(s.default,{thumbnailUrls:this.thumbnailUrls}),this.thumbnailsPanel),(0,d.safeRender)(c.createElement(u.default,{thumbnailUrls:this.thumbnailUrls,ref:function(e){t.altFormRef=e}}),this.altFormPanel),(0,d.safeRender)(c.createElement(l.EmbedBoxFotoCaptionSubmitContainer,{willModifyCaption:!1,onClickClose:function(){t.hide()}}),this.submitContainerPanel),g.show(this.$container,{showBackground:!0,then:function(){t.$captionInput.focus()[0].select()},destroy:function(){t.onHide()}}),b("EmbedBoxFotoCaption.show")),new Promise((function(e){t.resolve=e}))},t.setFotoExpression=function(e){this.expr=e},t.isShown=function(){return this.$container.is(":visible")},t.hide=function(){g.hide(this.$container)},t.onHide=function(){this.$captionInput.val("")},t.doPaste=function(){b("EmbedBoxFotoCaption.paste"),this.resolve();var e,t=this.altFormRef.getAltStrings(),n={coreExpr:this.expr,captionStr:this.$captionInput.val(),altStrings:t};switch(this.editor.mode){case"html":e=new a.default(n);break;case"raw":e=new i.default(n);break;case"hatena":e=new f.EmbedBoxFotoCaptionExprBuilderHatena(n);break;default:e=new o.default(n)}!this.$altAttrLabelAndInputPanel.hasClass("is-hidden")&&e.injectAlt();var r=e.build();this.editor.insert(r),this.hide()},e}();t.EmbedBoxFotoCaption=y},59198:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.default=void 0,n(21249),n(92222);var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),i=a(n(20996)),o=a(n(40702));function a(e){return e&&e.__esModule?e:{default:e}}function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var l=function(e){var t,n;function a(t){var n;n=e.call(this,t)||this;for(var r=[],i=0;i<t.thumbnailUrls.length;i+=1)r[i]="";return n.state={altStrings:r},n}n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,u(t,n);var s=a.prototype;return s.componentWillReceiveProps=function(e){for(var t=[],n=0;n<e.thumbnailUrls.length;n+=1)t[n]="";this.setState({altStrings:t})},s.getAltStrings=function(){return this.state.altStrings},s.render=function(){var e=this,t=this.props.thumbnailUrls,n=this.state.altStrings;if(t.length>1){var a=t.map((function(t,a){return r.createElement("tr",{key:t},r.createElement("th",null,r.createElement(o.default,{url:t,order:a+1})),r.createElement("td",null,r.createElement("input",{type:"text",name:"image_alt",className:"js-embed-foto-alt full-width",placeholder:i.default.text("epic.image_alt"),value:n[a],onChange:function(t){return e.onFormChange(t,a)}})))}));return r.createElement("table",{className:"table-foto-alt table js-alt-def-table"},r.createElement("tbody",null,a))}return r.createElement("input",{type:"text",name:"image_alt",className:"js-embed-foto-alt full-width",placeholder:i.default.text("epic.image_alt"),value:n[0],onChange:function(t){return e.onFormChange(t,0)}})},s.onFormChange=function(e,t){var n=[].concat(this.state.altStrings);n[t]=e.currentTarget.value,this.setState({altStrings:n})},a}(r.PureComponent);t.default=l},57394:function(e,t,n){t.__esModule=!0,t.default=void 0,n(69600),n(54747),n(15306),n(74916);var r,i=(r=n(13469))&&r.__esModule?r:{default:r};function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a=function(){function e(e){if(o(this,"extraClasses",[]),o(this,"escapedCaptionStr",""),o(this,"coreExpr",""),o(this,"altStrings",[]),this.coreExpr=e.coreExpr,this.altStrings=e.altStrings,void 0===e.captionStr)throw new TypeError("caption must be defined");if(this.escapedCaptionStr=i.default.escape(e.captionStr),void 0===this.escapedCaptionStr)throw new Error("escaping caption failed")}var t=e.prototype;return t.build=function(){return 0===this.escapedCaptionStr.length?this.coreExpr:this._wrapWithCaption(this.coreExpr)},t._wrapWithCaption=function(e){var t;return['<figure class="figure-image figure-image-fotolife'+(t=this.extraClasses,(0===t.length?"":" "+t.join(" "))+'" title="')+this.escapedCaptionStr+'">',e,this.buildCaption(this.escapedCaptionStr),"</figure>"].join("")},t.buildCaption=function(e){return"<figcaption>"+e+"</figcaption>"},t.injectAlt=function(){this.coreExpr=this._injectAltNew(this.coreExpr,this.altStrings)},t._injectAltNew=function(e,t){return t.forEach((function(t){e=e.replace(/:plain]/,":plain:alt="+i.default.escape(t)+"]")})),e},e}();t.default=a},75603:function(e,t,n){t.__esModule=!0,t.default=void 0,n(15306),n(74916),n(54747);var r,i=(r=n(57394))&&r.__esModule?r:{default:r};function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var a=n(13469),s=function(e){var t,n;function r(t){var n;return function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(n=e.call(this,t)||this),"extraClasses",void 0),n.extraClasses=["mceNonEditable"],n}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,o(t,n);var i=r.prototype;return i.build=function(){return e.prototype.build.call(this)+"<br/>"},i.buildCaption=function(e){return'<figcaption class="mceEditable">'+e+"</figcaption>"},i._injectAltNew=function(e,t){return e=e.replace(/title="[^"]+" +/g,""),t.forEach((function(t){e=e.replace(/alt="f:id[^"]+"/,'alt="'+a.escape(t)+'"')})),e},r}(i.default);t.default=s},27499:function(e,t,n){var r;function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}t.__esModule=!0,t.EmbedBoxFotoCaptionExprBuilderHatena=void 0;var o=function(e){var t,n;function r(){return e.apply(this,arguments)||this}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,i(t,n),r.prototype._wrapWithCaption=function(t){return">"+e.prototype._wrapWithCaption.call(this,t)+"<"},r}(((r=n(57394))&&r.__esModule?r:{default:r}).default);t.EmbedBoxFotoCaptionExprBuilderHatena=o},84395:function(e,t,n){t.__esModule=!0,t.default=void 0,n(15306),n(74916),n(54747);var r=i(n(13469));function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var a=function(e){var t,n;function i(){return e.apply(this,arguments)||this}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,o(t,n);var a=i.prototype;return a.buildCaption=function(e){return'<figcaption class="mceEditable">'+e+"</figcaption>"},a._injectAltNew=function(e,t){return e=e.replace(/title="[^"]+" +/g,""),t.forEach((function(t){e=e.replace(/alt="f:id[^"]+"/,'alt="'+r.default.escape(t)+'"')})),e},i}(i(n(57394)).default);t.default=a},75560:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.EmbedBoxFotoCaptionSubmitContainer=void 0;var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),o=(r=n(20996))&&r.__esModule?r:{default:r};function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}t.EmbedBoxFotoCaptionSubmitContainer=function(e){return i.createElement(i.Fragment,null,i.createElement("button",{className:"btn btn-primary js-paste-button",type:"submit"},o.default.text("epic.embed_photo.submit")),i.createElement("button",{type:"button",className:"btn js-close",onClick:e.onClickClose},o.default.text("cancel")))}},40702:function(e,t,n){n(4129),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.default=void 0,n(41539),n(39714);var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=i(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=o?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(67294));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(i=function(e){return e?n:t})(e)}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var a=function(e){var t,n;function i(){return e.apply(this,arguments)||this}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,o(t,n),i.prototype.render=function(){var e={backgroundImage:"url("+this.props.url+")"};return r.createElement("div",{className:"embed-foto-thumb",style:e},r.createElement("div",{className:"item-order-label"},this.props.order.toString()))},i}(r.PureComponent);t.default=a},1845:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.default=void 0,n(21249);var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),o=(r=n(40702))&&r.__esModule?r:{default:r};function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u=function(e){var t,n;function r(){return e.apply(this,arguments)||this}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,s(t,n),r.prototype.render=function(){var e=this.props.thumbnailUrls.map((function(e,t){return i.createElement(o.default,{key:t,url:e,order:t+1})}));return i.createElement("div",{className:"embed-foto-thumbs js-thumbnails"},e)},r}(i.PureComponent);t.default=u},86585:function(e,t,n){n(69826);var r=n(67294),i=n(73935),o=n(91269),a=n(19303);function s(e,t){e&&null!=e[0]&&t(e[0])}e.exports=function(e,t,n){var u=this;this.type="editor-option",this.editor=t;var l=o.get("editor.entryOption");this.entryOptionReact=i.render(r.createElement(a,{option:l,editor:this.editor}),e.find("#editor-option-react")[0]),this.entryOptionReact.setState({isOpen:n.type===this.type}),n.on("tabChange",(function(e){var t=e===u.type;u.entryOptionReact.setState({isOpen:t}),t&&u.entryOptionReact.reloadImages()})),this.editor.$form.on("backup-restore-params",(function(e,t){s(t.datetime,(function(e){return u.entryOptionReact.setDateTime(e)})),s(t.customurl,(function(e){return u.entryOptionReact.setCustomUrl(e)})),s(t.layout,(function(e){return u.entryOptionReact.setLayout(e)})),s(t.og_description,(function(e){return u.entryOptionReact.setOgDescription(e)})),s(t.og_image,(function(e){return u.entryOptionReact.setOgImage(e)})),s(t.og_title,(function(e){return u.entryOptionReact.setOgTitle(e)})),s(t.page_title,(function(e){return u.entryOptionReact.setPageTitle(e)}))}))}},32325:function(e,t,n){t.__esModule=!0,t.AdvancedSettingsEditor=void 0;var r=o(n(67294)),i=o(n(20996));function o(e){return e&&e.__esModule?e:{default:e}}t.AdvancedSettingsEditor=function(e){return r.default.createElement("div",{id:"advanced-settings",className:"editor-option-section editor-option-advanced-settings "+(e.useAdvancedSettings?"is-open":"")},r.default.createElement("span",{id:"toggle-advanced-settings",className:"editor-option-accordion",onClick:function(){return e.toggleAdvancedSettings()}},i.default.text("edit_form.advanced.settings"),r.default.createElement("i",{className:"blogicon-chevron-down"})),r.default.createElement("div",{className:"advanced-title-content js-advanced-title-content"},r.default.createElement("p",null,i.default.text("edit_form.advanced.settings.description")),r.default.createElement("h4",{className:"advanced-title-heading"},i.default.text("edit_form.advanced_title.page_title")),r.default.createElement("textarea",{id:"advanced-page-title",name:"page_title",placeholder:i.default.text("edit_form.advanced_title.page_title"),value:e.pageTitle,onChange:function(t){return e.setPageTitle(t.target.value)},rows:3}),r.default.createElement("h4",{className:"advanced-title-heading"},i.default.text("edit_form.advanced_title.og_title")),r.default.createElement("textarea",{id:"advanced-og-title",name:"og_title",placeholder:i.default.text("edit_form.advanced_title.og_title"),value:e.ogTitle,onChange:function(t){return e.setOgTitle(t.target.value)},rows:3}),e.canSetNoindexNofollow&&r.default.createElement("p",{className:"advanced-robot-checkbox"},r.default.createElement("input",{type:"checkbox",id:"advanced-robot",name:"noindex_nofollow",checked:e.noindexNofollow,onChange:function(t){return e.setNoindexNofollow(t.target.checked)}}),r.default.createElement("label",{htmlFor:"advanced-robot"},i.default.text("edit_form.advanced_robot.robot_title")))))}},73634:function(e,t,n){t.__esModule=!0,t.fetchCanvaButtonApi=void 0,n(35666),n(88674),n(41539);var r=n(70879);function i(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function s(e){i(a,r,o,s,u,"next",e)}function u(e){i(a,r,o,s,u,"throw",e)}s(void 0)}))}}var a=n(91269),s=null;t.fetchCanvaButtonApi=function(){return s||(s=new Promise((function(e,t){var n=document.createElement("script");n.src="https://sdk.canva.com/designbutton/v2/api.js",document.head.appendChild(n);var i=a.get("canva.apiKey");n.onload=o(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,window.Canva.DesignButton.initialize({apiKey:i});case 3:r=n.sent,e(r),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),t(n.t0);case 10:case"end":return n.stop()}}),n,null,[[0,7]])}))),n.onerror=function(){var e=new Error("Failed to load "+n.src);(0,r.BUG)(e,"fetchCanvaButtonApi"),t(e)}})))}},57706:function(e,t,n){n(4129),n(38880),t.__esModule=!0,t.CanvaButtonContainer=void 0,n(23123),n(74916),n(60285),n(41539),n(78783),n(66992),n(33948),n(88674),n(35666);var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=c(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),i=l(n(20996)),o=l(n(57942)),a=l(n(347)),s=n(73634),u=n(97050);function l(e){return e&&e.__esModule?e:{default:e}}function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(c=function(e){return e?n:t})(e)}function d(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function f(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){d(o,r,i,a,s,"next",e)}function s(e){d(o,r,i,a,s,"throw",e)}a(void 0)}))}}var p=function(){var e=f(regeneratorRuntime.mark((function e(t,n,r){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,s.fetchCanvaButtonApi)();case 2:o=e.sent,n?o.editDesign({design:{id:n},editor:{publishLabel:i.default.text("done")},onDesignPublish:function(e){var n=e.exportUrl,i=e.designId;h(n,i,t,r)}}):o.createDesign({design:{type:"HatenaEyeCatch"},editor:{publishLabel:i.default.text("done")},onDesignPublish:function(e){var n=e.exportUrl,i=e.designId;h(n,i,t,r)}});case 4:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),h=function(){var e=f(regeneratorRuntime.mark((function e(t,n,r,i){var s,l,c,d,p,h,m,v,g;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=r.setOgImage,l=r.editor,c=r.reloadImages,d=r.setIsLoadingOgImage,p=r.setOgImageFailed,e.next=3,a.default.get(t,{responseType:"blob"});case 3:h=e.sent,m=new URL(t).pathname.split("/").pop()||"",v=new File([h.data],m,{type:h.data.type}),(g=new FormData).append("rkm",(0,o.default)("rkm")),g.append("append","1"),g.append("fototitle",""),g.append("folder","Hatena Blog"),g.append("image",v),g.append("fotosize","1200"),g.append("delete-gps","1"),d(!0),a.default.post("/f/"+(0,o.default)("name")+"/upbysmart?with_image_url=1",g).then(function(){var e=f(regeneratorRuntime.mark((function e(t){var r,o,a,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.data,o=r.hatena_syntax,a=r.image_url,s(a),l.setSelectionRange({start:0,end:0}),"html"!==l.syntaxForInsertLines){e.next=10;break}return e.next=6,(0,u.extractFotolifeSyntax)("["+o+"]");case 6:d=e.sent,l.insert(d.html),e.next=11;break;case 10:l.insert("["+(0,u.replaceImageToPlain)(o)+"]\n");case 11:c(),i(n);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(){d(!1),p(!0)}));case 16:case"end":return e.stop()}}),e)})));return function(t,n,r,i){return e.apply(this,arguments)}}();t.CanvaButtonContainer=function(e){var t=(0,r.useState)(null),n=t[0],o=t[1];return r.default.createElement("div",{className:"editor-option-section editor-option-canva"},r.default.createElement("button",{onClick:function(){return p(e,n,o)},type:"button",className:"canva-design-button"},r.default.createElement("span",{className:"canva-button-i"}),r.default.createElement("span",{className:"canva-button-label"},i.default.text("edit_form.og_image.create"))),r.default.createElement("p",null,i.default.text("edit_form.og_image.create.canva_account_required"),r.default.createElement("br",null),r.default.createElement("a",{href:"https://www.canva.com/ja_jp/learn/hatena_eyecatch/",target:"_blank",rel:"noopener"},i.default.text("edit_form.og_image.create.help"))))}},68566:function(e,t,n){t.__esModule=!0,t.default=void 0;var r=o(n(67294)),i=o(n(20996));function o(e){return e&&e.__esModule?e:{default:e}}var a=n(41960),s=function(e){var t=e.directoryPath,n=e.directoryUrl,o=e.isUrlDuplicate,s=e.customUrl,u=e.setCustomUrl,l=e.onBlur;return r.default.createElement("div",{id:"custom-url",className:"editor-option-section editor-option-custom-url"},r.default.createElement("label",{htmlFor:"customurl-input"},r.default.createElement("h3",null,i.default.text("blog.custom_url"))),r.default.createElement("p",null,i.default.text("edit_form.url_description",n)),r.default.createElement("div",null,t,r.default.createElement("input",{type:"text",id:"customurl-input",name:"customurl",placeholder:i.default.text("blog.custom_url"),value:s,onChange:function(e){return u(e.target.value)},onKeyDown:function(e){return function(e){"RET"===a(e.nativeEvent)&&(e.preventDefault(),e.stopPropagation())}(e)},style:{width:"160px"},onBlur:function(e){return l(e.target.value)}}),o&&r.default.createElement("div",{className:"error-msg"},i.default.text("blog.custom_url.error.duplicate"))))};t.default=s},98601:function(e,t,n){t.__esModule=!0,t.default=void 0,n(4723),n(74916),n(92222),n(23123);var r=a(n(30381)),i=a(n(67294)),o=a(n(20996));function a(e){return e&&e.__esModule?e:{default:e}}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c=n(84319),d=n(43459),f=function(e){return(0,r.default)(e).format("YYYY-MM-DD")},p=f(new Date),h=function(e){var t,n;function r(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return l(s(t=e.call.apply(e,[this].concat(r))||this),"datepicker",void 0),l(s(t),"dateInput",null),t}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,u(t,n);var a=r.prototype;return a.componentDidMount=function(){var e=this,t=this.props.date.match(/^\d{4}-\d{2}-\d{2}$/)?new Date(this.props.date):null;d("/css/external/pikaday.css"),this.datepicker=new c({field:this.dateInput,i18n:{previousMonth:o.default.text("edit_form.pikaday.previous_month"),nextMonth:o.default.text("edit_form.pikaday.next_month"),months:o.default.text("edit_form.pikaday.months").split(","),weekdays:o.default.text("edit_form.pikaday.weekdays").split(","),weekdaysShort:o.default.text("edit_form.pikaday.weekdays_short").split(",")},yearSuffix:o.default.text("edit_form.pikaday.year_suffix"),showMonthAfterYear:"true",defaultDate:t,setDefaultDate:!!t,onSelect:function(t){return e.props.onSelect(f(t))}})},a.componentDidUpdate=function(e,t){e.date!==this.props.date&&(this.datepicker.setDate(this.props.date,!0),this.dateInput&&this.dateInput.setCustomValidity(this.props.validity))},a.cancelEnter=function(e){13===e.keyCode&&(e.preventDefault(),e.stopPropagation())},a.render=function(){var e=this;return i.default.createElement("input",{type:"text",className:"datetime-input-date",ref:function(t){e.dateInput=t},autoComplete:"off",placeholder:p,pattern:"\\d{4}-\\d{2}-\\d{2}",value:this.props.date,onKeyDown:function(t){return e.cancelEnter(t)},onChange:function(t){return e.props.onChange(t)}})},r}(i.default.Component);t.default=h},37067:function(e,t,n){t.__esModule=!0,t.default=void 0,n(4723),n(74916),n(47042),n(15306),n(69600);var r=u(n(30381)),i=u(n(67294)),o=u(n(20996)),a=u(n(98601)),s=u(n(64246));function u(e){return e&&e.__esModule?e:{default:e}}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var c,d=(c=new Date,(0,r.default)(c).format("YYYY-MM-DD")),f=function(e){var t,n;function u(t){var n;return(n=e.call(this,t)||this).state=n.splitDateTime(t.datetime),n}n=e,(t=u).prototype=Object.create(n.prototype),t.prototype.constructor=t,l(t,n);var c=u.prototype;return c.componentWillReceiveProps=function(e){var t=this.splitDateTime(e.datetime);this.setState(t)},c.splitDateTime=function(e){var t="",n="",r="",i=e.match(/^(\d{4}-\d{2}-\d{2})T(\d{2}:\d{2}:\d{2})(?:\+(\d{2}:\d{2}))?$/);if(i){var o=i.slice(1);t=o[0],n=o[1],r=o[2]}return{date:t,time:n=n.replace(/(\d{2}:\d{2}):00/,"$1"),tz:r}},c.mergeDateTime=function(e,t,n){var i=n?"+"+n:"";return""+(0,r.default)(e+"T"+t).format("YYYY-MM-DDTHH:mm:ss")+i},c.isValidDate=function(e){return!!e.match(/^\d{4}-\d{2}-\d{2}$/)},c.isValidTime=function(e){var t=e.match(/^(\d{2}):(\d{2})(?::(\d{2}))?$/);if(!t)return!1;var n=parseInt(t[1],10),r=parseInt(t[2],10),i=parseInt(t[3]||"0",10);return 0<=n&&n<24&&0<=r&&r<60&&0<=i&&i<60},c.setDateTime=function(e,t,n){var r=this.mergeDateTime(e,t,n);this.props.setDateTime(r)},c.resetDateTime=function(){this.props.setDateTime("")},c.setDate=function(e){if(this.setState({date:e}),this.isValidDate(e)){var t=this.isValidTime(this.state.time)?this.state.time:"00:00";this.setDateTime(e,t,this.state.tz)}else""===e&&""===this.state.time&&this.resetDateTime()},c.setTime=function(e){if(this.setState({time:e}),this.isValidTime(e)){var t=this.isValidDate(this.state.date)?this.state.date:d;this.setDateTime(t,e,this.state.tz)}else""===e&&""===this.state.date&&this.resetDateTime()},c.isPast=function(){return(0,r.default)(this.props.datetime).isBefore((0,r.default)())},c.renderScheduleCheckBox=function(){var e=this;if(!this.props.isNewOrDraft||!this.props.canPostScheduledEntry)return null;var t=this.props.isScheduledEntry?void 0:"checked",n=[],r=this.props.willPublish;return this.props.isScheduledEntry&&n.push("checked"),this.isPast()&&n.push("disabled"),i.default.createElement("div",null,i.default.createElement("p",{className:"editor-option-scheduled-section"},i.default.createElement("label",{className:t},i.default.createElement("input",{type:"radio",name:"is_scheduled_entry",value:"0",className:"js-scheduled-entry-checkbox",checked:!this.props.isScheduledEntry,disabled:!this.props.datetime,onChange:function(){return e.props.onScheduledEntryChanged(!1)}}),r?o.default.text("edit_form.publish_soon"):o.default.text("edit_form.set_draft_datetime"))),i.default.createElement("p",{className:"editor-option-scheduled-section"},i.default.createElement("label",{className:n.join(" ")},i.default.createElement("input",{type:"radio",name:"is_scheduled_entry",value:"1",className:"js-scheduled-entry-checkbox",checked:this.props.isScheduledEntry,disabled:!this.props.datetime||this.isPast(),onChange:function(){return e.props.onScheduledEntryChanged(!0)}}),o.default.text("edit_form.schedule_this_entry"))))},c.render=function(){var e=this;return this.props.canSetDatetime?i.default.createElement("div",{id:"datetime",className:"editor-option-section"},i.default.createElement("h3",null,o.default.text("blog.datetime")),i.default.createElement("p",null,this.props.isNewOrDraft&&this.props.canPostScheduledEntry?o.default.text("edit_form.datetime_description"):o.default.text("edit_form.published_datetime_description")),i.default.createElement("input",{type:"hidden",size:10,id:"datetime-input",name:"datetime","data-with-backup":!0,value:this.props.datetime}),i.default.createElement("div",{className:"datetime-input"},i.default.createElement(a.default,{validity:this.props.isScheduledPast?o.default.text("edit_form.schedule_coming_entry"):"",date:this.state.date,onChange:function(t){return e.setDate(t.target.value)},onSelect:function(t){return e.setDate(t)}}),i.default.createElement(s.default,{time:this.state.time,onChange:function(t){return e.setTime(t.target.value)},onSubmit:function(t){return e.setTime(t)}})),this.renderScheduleCheckBox()):null},u}(i.default.Component);t.default=f},77405:function(e,t,n){t.__esModule=!0,t.default=void 0,n(19601),n(54747),n(92222);var r=g(n(30381)),i=g(n(67294)),o=g(n(57942)),a=n(13964),s=g(n(347)),u=n(43652),l=n(57706),c=g(n(68566)),d=g(n(37067)),f=g(n(7783)),p=g(n(62225)),h=g(n(93959)),m=n(32325),v=g(n(61053));function g(e){return e&&e.__esModule?e:{default:e}}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n(13469);var w=n(80129),E=function(e){var t,n;function g(t){var n;return _(b(n=e.call(this,t)||this),"setCustomUrl",(function(e){return n.setState({customUrl:e})})),_(b(n),"setLayout",(function(e){return n.setState({layout:e})})),_(b(n),"removeOgImage",(function(){return n.setState({ogImage:void 0})})),_(b(n),"setOgImage",(function(e){return n.setState({ogImage:e})})),_(b(n),"setOgDescription",(function(e){return n.setState({ogDescription:e})})),_(b(n),"toggleAdvancedSettings",(function(){return n.setState({useAdvancedSettings:!n.state.useAdvancedSettings})})),_(b(n),"setPageTitle",(function(e){return n.setState({pageTitle:e})})),_(b(n),"setOgTitle",(function(e){return n.setState({ogTitle:e})})),_(b(n),"setNoindexNofollow",(function(e){return n.setState({noindexNofollow:e})})),_(b(n),"shouldShowSocializeBox",(function(){return!!n.state.isScheduledEntry&&!n.isScheduledPast()})),n.state=Object.assign({},t.option,{ogImageCandidates:[t.option.defaultOgImage],isLoadingOgImage:!1,ogImageFailed:!1,isOpen:!1,isUrlDuplicate:!1,willPublish:t.option.isNew}),n.state.socializeServiceIds.forEach((function(e){n.state.socializeServices[e].valid=!0})),n}n=e,(t=g).prototype=Object.create(n.prototype),t.prototype.constructor=t,y(t,n);var E=g.prototype;return E.componentDidMount=function(){var e=this;this.props.editor.bind("updateWillPublish",(function(t,n){e.setState({willPublish:n})}))},E.isScheduledPast=function(){return this.state.isScheduledEntry&&this.isPastMoment((0,r.default)(this.state.datetime))},E.setDateTime=function(e){var t=""!==e,n={datetime:e};this.state.isNew&&(n.isScheduledEntry=t&&!this.isPastMoment((0,r.default)(e))),this.setState(n)},E.onScheduledEntryChanged=function(e){this.props.editor.emit("toggleScheduledEntry",e),this.setState({isScheduledEntry:e})},E.isPastMoment=function(e){return e.isBefore((0,r.default)())},E.checkSocialize=function(e,t){var n=this.state.socializeServices;n[e].checked=t,this.setState({socializeServices:n})},E.updateServiceMessage=function(e,t){var n=this.state.socializeServices;n[e].message=t,"twitter"===e&&(n[e].valid=(0,a.validateTweetLength)(t)),this.setState({socializeServices:n})},E.onBlur=function(e){var t=this;if(e){var n=this.props.editor.getEntryId(),r=(0,o.default)("blog-uuid");s.default.get("/api/1/json/custom_url",{params:{custom_url:e,entry_id:n,blog_id:r,rkm:(0,o.default)("rkm"),rkc:(0,o.default)("rkc")}}).then((function(e){t.setState({isUrlDuplicate:e.data.isExisting})})).catch((function(){}))}},E.reloadImages=function(){var e=this;if(!this.state.isLoading){var t=this.props.editor,n=t.getBody();n?(this.setState({isLoadingOgImage:!0}),s.default.post("/api/entry/images",w.stringify({body:n,syntax:t.getSyntax(),rkm:(0,o.default)("rkm"),rkc:(0,o.default)("rkc")})).then((function(t){e.setState({ogImageCandidates:[e.state.defaultOgImage].concat(t.data)})})).catch((function(){e.setState({ogImageFailed:!0})})).then((function(){e.setState({isLoadingOgImage:!1})}))):this.setState({ogImageCandidates:[this.state.defaultOgImage]})}},E.render=function(){var e=this;return this.props.editor.emit("toggleScheduledEntry",this.state.isScheduledEntry),i.default.createElement("div",null,i.default.createElement(f.default,{canChangeLayout:!!this.state.canChangeLayout,availableLayouts:this.state.availableLayouts,layout:this.state.layout,setLayout:function(t){return e.setLayout(t)}}),i.default.createElement(h.default,{ogImage:this.state.ogImage||"",defaultOgImage:this.state.defaultOgImage||"",ogImageCandidates:this.state.ogImageCandidates,isLoadingOgImage:this.state.isLoadingOgImage,ogImageFailed:this.state.ogImageFailed,setOgImage:function(t){return e.setOgImage(t)},removeOgImage:function(){return e.removeOgImage()},reloadImages:function(){return e.reloadImages()}}),i.default.createElement(l.CanvaButtonContainer,{setOgImage:function(t){return e.setOgImage(t)},editor:this.props.editor,reloadImages:function(){return e.reloadImages()},setIsLoadingOgImage:function(t){return e.setState({isLoadingOgImage:t})},setOgImageFailed:function(t){return e.setState({ogImageFailed:t})}}),i.default.createElement(c.default,{directoryPath:this.state.directoryPath,directoryUrl:this.state.directoryUrl,isUrlDuplicate:this.state.isUrlDuplicate,customUrl:this.state.customUrl,setCustomUrl:function(t){return e.setCustomUrl(t)},onBlur:function(t){return e.onBlur(t)}}),i.default.createElement(d.default,{canSetDatetime:!!this.state.canSetDatetime,canPostScheduledEntry:!!this.state.canPostScheduledEntry,datetime:this.state.datetime||"",isNewOrDraft:!!this.state.isNewOrDraft,isScheduledEntry:!!this.state.isScheduledEntry,isScheduledPast:this.isScheduledPast(),onScheduledEntryChanged:function(t){return e.onScheduledEntryChanged(t)},setDateTime:function(t){return e.setDateTime(t)},willPublish:!!this.state.willPublish}),i.default.createElement(v.default,{services:this.state.socializeServices,serviceIds:this.state.socializeServiceIds,isIframe:(0,u.isIframe)(window),isNewOrDraft:!!this.state.isNewOrDraft,shouldShow:this.shouldShowSocializeBox(),showExternalAuthLink:!!this.state.showExternalAuthLink,checkSocialize:function(t,n){return e.checkSocialize(t,n)},updateServiceMessage:function(t,n){return e.updateServiceMessage(t,n)}}),i.default.createElement(p.default,{ogDescription:this.state.ogDescription,setOgDescription:function(t){return e.setOgDescription(t)}}),i.default.createElement(m.AdvancedSettingsEditor,{ogTitle:this.state.ogTitle,pageTitle:this.state.pageTitle,noindexNofollow:this.state.noindexNofollow,useAdvancedSettings:!!this.state.useAdvancedSettings,canSetNoindexNofollow:this.state.canSetNoindexNofollow,toggleAdvancedSettings:function(){return e.toggleAdvancedSettings()},setOgTitle:function(t){return e.setOgTitle(t)},setPageTitle:function(t){return e.setPageTitle(t)},setNoindexNofollow:function(t){return e.setNoindexNofollow(t)}}))},g}(i.default.Component);t.default=E},7783:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.default=void 0,n(21249);var r=s(n(67294)),i=s(n(20996)),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(55992));function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e){return e.canChangeLayout?r.default.createElement("div",{id:"layout",className:"editor-option-section"},r.default.createElement("label",{htmlFor:"layout-input"},r.default.createElement("h3",null,r.default.createElement("span",{className:"badge"},i.default.text("publication_type.page"))," ",i.default.text("publication.layout"))),r.default.createElement("p",null,i.default.text("publication.layout.description")),r.default.createElement("div",{className:"editor-option-layout-wrapper"},r.default.createElement("ul",{className:"editor-option-layout"},e.availableLayouts.map((function(t){return r.default.createElement("li",{className:"editor-option-layout-item",key:"editor-option-layout-"+t},r.default.createElement("div",{className:"editor-option-layout-image"},r.default.createElement("label",{htmlFor:"input-layout-"+t},r.default.createElement("img",{src:o.staticUrl("/images/admin/edit/pages-layout-"+t+".svg")}))),r.default.createElement("div",{className:"editor-option-layout-content"},r.default.createElement("label",{className:"editor-option-layout-label is-selected"},r.default.createElement("input",{id:"input-layout-"+t,type:"radio",name:"layout",value:t,onChange:function(t){return e.setLayout(t.target.value)},checked:t===e.layout}),r.default.createElement("span",{className:"editor-option-layout-heading"},i.default.text("publication.layout."+t))),r.default.createElement("p",null,i.default.text("publication.layout."+t+".description"))))}))))):null};t.default=u},62225:function(e,t,n){t.__esModule=!0,t.default=void 0;var r=o(n(67294)),i=o(n(20996));function o(e){return e&&e.__esModule?e:{default:e}}var a=function(e){return r.default.createElement("div",{id:"og-description",className:"editor-option-section"},r.default.createElement("label",{htmlFor:"og-description-input"},r.default.createElement("h3",null,i.default.text("edit_form.og_description.label"))),r.default.createElement("p",null,i.default.text("edit_form.og_description.description")),r.default.createElement("div",null,r.default.createElement("textarea",{id:"og-description-input",name:"og_description",placeholder:i.default.text("edit_form.og_description.placeholder"),rows:8,value:e.ogDescription,onChange:function(t){return e.setOgDescription(t.target.value)}})))};t.default=a},93959:function(e,t,n){t.__esModule=!0,t.default=void 0,n(21249);var r=s(n(67294)),i=n(90381),o=s(n(20996)),a=n(55992);function s(e){return e&&e.__esModule?e:{default:e}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var l=n(41960),c=function(e){var t,n;function s(t){var n;return(n=e.call(this,t)||this).state={inputValue:t.ogImage||""},n}n=e,(t=s).prototype=Object.create(n.prototype),t.prototype.constructor=t,u(t,n);var c=s.prototype;return c.componentDidMount=function(){this.props.reloadImages()},c.componentWillReceiveProps=function(e){this.setState({inputValue:e.ogImage})},c.onChange=function(e){this.setState({inputValue:e.target.value})},c.onKeyDown=function(e){"RET"===l(e)&&(this.props.setOgImage(this.state.inputValue),e.preventDefault(),e.stopPropagation())},c.onBlur=function(e){this.props.setOgImage(this.state.inputValue)},c.renderImageList=function(){var e=this;return this.props.isLoadingOgImage?r.default.createElement(i.LoadingIndicator,null):this.props.ogImageFailed?r.default.createElement("div",{className:"error"},o.default.text("edit_form.og_image_upload_failure")):this.props.ogImageCandidates.map((function(t,n){return e.renderItem(t,n)}))},c.renderItem=function(e,t){var n=this,i=this.props.ogImage===e,o="image-item "+(i?"selected":"");return r.default.createElement("li",{className:o,key:t,onClick:function(){return i?n.props.removeOgImage():n.props.setOgImage(e)}},r.default.createElement("span",{className:"image-container"},r.default.createElement("img",{src:e})))},c.render=function(){var e=this;return r.default.createElement("div",{id:"og-image",className:"editor-option-section","data-default-ogimage-url":this.props.defaultOgImage},r.default.createElement("label",{htmlFor:"ogimage-input"},r.default.createElement("h3",null,o.default.text("blog.og_image"))),r.default.createElement("button",{className:"reload",type:"button",tabIndex:-1,onClick:function(){return e.props.reloadImages()}},r.default.createElement("i",{className:"blogicon-repeat"})),r.default.createElement("p",null,o.default.text("edit_form.og_image_description"),r.default.createElement("a",{href:(0,a.helpUrl)("/entry/post_thumbnail"),target:"_blank",rel:"noopener noreferrer"},o.default.text("epic.show_detail"))),r.default.createElement("div",{className:"og-image-selector"},r.default.createElement("div",{className:"image-items"},r.default.createElement("ul",null,this.renderImageList())),r.default.createElement("div",{className:"selector-input",id:"og-image-input-container"},r.default.createElement("input",{type:"url",size:50,title:o.default.text("edit_form.input_url.specify"),id:"ogimage-input",name:"ogimage",placeholder:o.default.text("edit_form.input_url.specify"),value:this.state.inputValue,onChange:function(t){return e.onChange(t)},onKeyDown:function(t){return e.onKeyDown(t)},onBlur:function(t){return e.onBlur(t)}}),r.default.createElement("span",{className:"remove-og-image",onClick:function(){return e.props.removeOgImage()}},r.default.createElement("i",{className:"blogicon-close"})))))},s}(r.default.Component);t.default=c},61053:function(e,t,n){t.__esModule=!0,t.default=void 0,n(21249);var r=a(n(67294)),i=a(n(20996)),o=a(n(57942));function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u=function(e){var t,n;function a(){return e.apply(this,arguments)||this}n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,s(t,n);var u=a.prototype;return u.renderCheckBox=function(e){var t=this,n=!(e.enabled&&e.valid);return r.default.createElement("div",null,r.default.createElement("input",{type:"checkbox",name:e.input_name,id:e.service,className:"editor-socialize-box-checkbox",checked:e.checked,disabled:n,onChange:function(){return t.props.checkSocialize(e.service,!e.checked)}}),r.default.createElement("label",{htmlFor:e.service},i.default.text(e.msgid)))},u.renderTextArea=function(e){var t=this;if(!e.textarea_name||!e.enabled)return null;if("twitter"===e.service){var n=null!==e.fillin_msgid?i.default.text(e.fillin_msgid):"",o=null!==e.message?e.message:n;return r.default.createElement("div",null,r.default.createElement("textarea",{name:e.textarea_name,value:o,onChange:function(n){return t.props.updateServiceMessage(e.service,n.target.value)}}),r.default.createElement("p",{className:"error-box js-twitter-length-error",style:{display:e.valid?"none":"block"}},i.default.text("blog.twitter.length.over.error")))}return null},u.renderExternalAuthLink=function(){return this.props.showExternalAuthLink?r.default.createElement("div",null,r.default.createElement("a",{href:(e="/-/config/external?with_parent_window=1",""+(0,o.default)("admin-domain")+e),target:this.props.isIframe?"_parent":"",tabIndex:3,"data-track-name":"edit-done-external-auth-link","data-track-once":"1","data-open-external-auth-link":"1"},"» ",i.default.text("go_to_settings"))):null;var e},u.render=function(){var e=this;if(!this.props.isNewOrDraft)return null;if(!this.props.shouldShow)return null;var t=this.props.serviceIds.map((function(t){return e.props.services[t]}));return r.default.createElement("div",{className:"editor-socialize-box editor-option-section"},r.default.createElement("h3",null,i.default.text("blog.editform.label.socialize_on_post")),r.default.createElement("ul",{className:"editor-socialize-box-ul"},t.map((function(t){return r.default.createElement("li",{key:t.msgid,className:"editor-socialize-box-li "+t.class_name+" "+(t.enabled?"":"disable")},e.renderCheckBox(t),e.renderTextArea(t))}))),this.renderExternalAuthLink())},a}(r.default.Component);t.default=u},64246:function(e,t,n){t.__esModule=!0,t.default=void 0,n(47042);var r,i=(r=n(67294))&&r.__esModule?r:{default:r},o=n(41205);function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}for(var s=[],u=0;u<24;u+=1){var l=("0"+u).slice(-2);s.push(l+":00",l+":30")}var c=function(e){var t,n;function r(){return e.apply(this,arguments)||this}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,a(t,n);var u=r.prototype;return u.cancelEnter=function(e){13===e.keyCode&&(e.preventDefault(),e.stopPropagation())},u.render=function(){var e={type:"text",className:"datetime-input-time",autoComplete:"off",placeholder:"00:00",pattern:"\\d{2}:\\d{2}(:\\d{2})?",value:this.props.time,onKeyDown:this.cancelEnter,onInput:this.props.onChange};return i.default.createElement("div",{className:"datetime-input-time-wrapper",style:{display:"inline-block"}},i.default.createElement(o.AutoCompleteInput,{inputProps:e,max:7,showDefault:!0,filter:!1,suggestions:s,onSubmit:this.props.onSubmit,onCancel:function(){}}))},r}(i.default.Component);t.default=c},19303:function(e,t,n){var r,i=(r=n(77405))&&r.__esModule?r:{default:r};e.exports=i.default},31427:function(e,t,n){n(69826),n(64765),n(74916),n(21249),n(54747),n(41539),n(66992),n(33948),n(15306),n(73210);var r=a(n(20996)),i=a(n(57942)),o=n(57753);function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var l=n(73609),c=n(13469),d=n(41960),f=n(28507),p=function(e){var t,n;function o(t){var n;return(n=e.call(this,t)||this).editor=t.editor,n.sidebar=t.sidebar,n.$keywordInput=t.container.find(".evernote-search-keyword"),n.$keywordSubmit=t.container.find(".evernote-search-keyword-submit"),n._searchDeferred=null,n.bindEvents(),n}n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,u(t,n);var a,p,h,m=o.prototype;return m.bindEvents=function(){var t=this;e.prototype.bindEvents.call(this),this.$keywordSubmit.on("click",(function(){return t.search(),!1})),this.$keywordInput.on("keydown",(function(e){if("RET"===d(e))return t.search(),!1})),this.$container.on("insert_items",(function(e,n){var r=n.$items,i=c.chain(r).map((function(e){return e.find(".evernote-item-resource").get()})).flatten().value();t.requestInsertResources(i);var o=c.chain(r).map((function(e){return e.find(".evernote-search-item-title").text()})).find((function(e){return e})).value(),a=t.editor.getTitle();o&&!a&&t.editor.setTitle(o)}))},m.loadNoteContents=function(e){var t=this;e.forEach((function(e){var n=t.$itemsContainer.find(".item[data-item-guid="+e.guid+"]");l.ajax({url:"/api/evernote/note",type:"GET",dataType:"json",data:{content:1,guid:n.attr("data-item-guid")}}).done((function(e){if(e&&e.content){var r="html"===t.editor.getSyntax()?"html":"plain",i=c.unescape(e.content.extended[r]),o=c.unescape(e.content.extended.excerpt);n.find(".evernote-search-item-body").text(i),n.find(".evernote-search-item-body-preview").text(o),n.attr("data-loaded-body",!0),e.extended.has_resource&&(t.appendResources({item:n,resources:e.resources}),t.previewResources({item:n,resources:e.resources}))}}))}))},m.loadItems=function(){var e=this;return l.ajax({url:"/api/evernote/notes_metadata",type:"GET",dataType:"json",data:{filter_order:"created"}}).pipe((function(t){if(!t)return t;if(t.is_error){if(t.is_error&&"auth_expired"===t.error_details.type)return e.$container.html(e.$container.find(".auth-expired-template").html()).removeClass("enabled").addClass("disabled"),t}else t.entries=t.notes;return e.itemsReachedEnd=!t.extended.has_next,t})).fail((function(t){if(!t)return t;var n=null;try{n=l.parseJSON(t.responseText)}catch(e){}return n&&n.is_rate_limit_reached?(e.$container.html(e.$container.find(".rate-limit-reached-template").html()).removeClass("enabled").addClass("disabled"),t):void 0}))},m.previewResources=function(e){var t=e.item,n=e.resources;if(!(n.length<=0)){var r=n[0],i=l("<img/>");i.attr("src","/api/evernote/thumbnail?guid="+r.guid),i.addClass("resource-image"),f((function(){return t.attr("data-loaded-body")}),(function(){return t.find(".evernote-image-preview").append(i)}))}},m.appendResources=function(e){var t=e.item,n=e.resources;t.attr("data-has-resource",!0),t.addClass("has-resource");var r=n.map((function(e){var t=l("<li/>"),n={"data-guid":e.guid};return t.attr(n),t.addClass("evernote-item-resource"),t}));t.find(".evernote-item-resources").append(r)},m.requestInsertResources=function(e){var t=this,n=e.shift();if(n){var r=l(n);if(r.attr("data-uploaded"))this.insertFotolifeImage({annotation:r.attr("data-fotolife-annotation"),html:r.attr("data-fotolife-html"),hex_body_hash:r.attr("data-hex-body-hash")}),this.requestInsertResources(e);else this.requestUploadResource(r).done((function(){t.requestInsertResources(e)}))}},m.requestUploadResource=function(e){var t=this;return l.ajax({url:"/api/upload/evernote/resource",type:"POST",dataType:"json",data:{rkm:(0,i.default)("rkm"),rkc:(0,i.default)("rkc"),guid:e.attr("data-guid")}}).done((function(n){t.onCompleteUploadingResource(e,n)}))},m.onCompleteUploadingResource=function(e,t){e.attr({"data-uploaded":1,"data-fotolife-annotation":t.annotation,"data-fotolife-html":t.html,"data-hex-body-hash":t.hex_body_hash}),this.insertFotolifeImageByResource(e)},m.insertFotolifeImageByResource=function(e){e.attr("data-uploaded")&&this.insertFotolifeImage({annotation:e.attr("data-fotolife-annotation"),html:e.attr("data-fotolife-html"),hexBodyHash:e.attr("data-hex-body-hash")})},m.insertFotolifeImage=function(e){var t=e.annotation,n=e.hexBodyHash,i=e.html,o=r.default.text("uploading"),a=this.editor.getBody(),s="[evernote:"+n+" "+o+"]",u="html"===this.editor.getSyntax()?i:"["+t+"]",l=a.replace(s,u);this.editor.setValue(l)},m.resourcesAreUploaded=function(e){return e.find(".evernote-resource").get().every((function(e){return e.getAttribute("data-uploaded")}))},m.insertItems=function(e){var t=this;f((function(){return t._readyToInsert(e)}),(function(){return t._insertItems(e)}))},m._readyToInsert=function(e){var t=this;return e.every((function(e){var n=e.attr("data-loaded-body"),r=!e.attr("data-has-resource")||t.resourcesAreUploaded(e);return n&&r}))},m._insertItems=function(e){var t=r.default.text("uploading"),n=e.map((function(e){return e.find(".evernote-search-item-body").text().replace(/\[evernote:([^\]]*)\]/gm,"[evernote:$1 "+t+"]")}));this.editor.insertLines(n),this.$container.trigger("insert_items",{$items:e,lines:n})},m.showItems=function(t){e.prototype.showItems.call(this,t),this.loadNoteContents(t)},m.search=function(){var e=this,t=this.$keywordInput.val().trim();if(0===t.length)return this.requestReload(),!1;this.$itemsContainer.find(".evernote-search-item").remove(),this._searchDeferred&&this._searchDeferred.reject(),this.ajaxStarted(),this._searchDeferred=this._searchAll(t),this._searchDeferred.always((function(){return e.ajaxFinished()}))},m._searchAll=function(e){var t=this,n=l.Deferred(),r=this._searchWithOffset(e,0);return r.done((function(i){t.showItems(i.notes),i.extended.has_next&&i.extended.next_offset?r=t._searchWithOffset(e,i.extended.next_offset):n.resolve()})).fail((function(e){return n.reject(e)})),n.fail((function(){r&&r.abort()})),n},m._searchWithOffset=function(e,t){return l.ajax({url:"/api/evernote/notes_metadata",data:{offset:t,filter_order:"created",filter_words:e}})},m.ajaxStarted=function(){this.isAjaxing=!0,this.$keywordSubmit.prop("disabled",!0),this.$indicator.show(),this.$errorMessage.hide()},m.ajaxFinished=function(){this.isAjaxing=!1,this.$keywordSubmit.prop("disabled",!1),this.$errorMessage.hide(),this.$indicator.hide()},a=o,(p=[{key:"type",get:function(){return"editor-evernote"}},{key:"serviceName",get:function(){return"Evernote"}}])&&s(a.prototype,p),h&&s(a,h),o}(o.MyCuration);e.exports=p},48862:function(e){e.exports={actions:{SEARCH:{LOAD:"FLICKR:SEARCH:LOAD",START_LOADING:"FLICKR:SEARCH:START_LOADING",FINISH_LOADING:"FLICKR:SEARCH:FINISH_LOADING",INIT_WITH_WORD:"FLICKR:SEARCH:INIT_WITH_WORD",TOGGLE_SELECTION:"FLICKR:SEARCH:TOGGLE_SELECTION",INSERT_SELECTED:"FLICKR:SEARCH:INSERT_SELECTED",INSERT_DOUBLE_CLICKED:"FLICKR:SEARCH:INSERT_DOUBLE_CLICKED"},PHOTOSTREAM:{LOAD:"FLICKR:PHOTOSTREAM:LOAD",REGISTER_USER:"FLICKR:PHOTOSTREAM:REGISTER_USER",UNREGISTER_USER:"FLICKR:PHOTOSTREAM:UNREGISTER_USER",HIDE_WELCOME_MESSAGE:"FLICKR:PHOTOSTREAM:HIDE_WELCOME_MESSAGE",START_LOADING:"FLICKR:PHOTOSTREAM:START_LOADING",FINISH_LOADING:"FLICKR:PHOTOSTREAM:FINISH_LOADING",TOGGLE_SELECTION:"FLICKR:PHOTOSTREAM:TOGGLE_SELECTION",INSERT_SELECTED:"FLICKR:PHOTOSTREAM:INSERT_SELECTED",INSERT_DOUBLE_CLICKED:"FLICKR:PHOTOSTREAM:INSERT_DOUBLE_CLICKED"}}}},73599:function(e,t,n){var r=n(45441),i=n(46007);function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var a=n(48862).actions,s=function(e){var t,n;function s(){return e.apply(this,arguments)||this}n=e,(t=s).prototype=Object.create(n.prototype),t.prototype.constructor=t,o(t,n);var u=s.prototype;return u.registerUser=function(e){var t=this;/^\s*$/.test(e)||(0,r.fetchUserInfo)(e).then((function(e){t.emit(a.PHOTOSTREAM.REGISTER_USER,e),t._load(e.data.nsid,1)})).catch((function(){t.emit(a.PHOTOSTREAM.HIDE_WELCOME_MESSAGE)}))},u.unregisterUser=function(){this.emit(a.PHOTOSTREAM.UNREGISTER_USER)},u.loadMore=function(e){if(!e.isLoading&&e.hasMore){var t=e.user.id,n=e.page;this._load(t,n)}},u.toggleSelection=function(e){this.emit(a.PHOTOSTREAM.TOGGLE_SELECTION,e)},u.insertSelected=function(){this.emit(a.PHOTOSTREAM.INSERT_SELECTED)},u.insertDoubleClicked=function(e){this.emit(a.PHOTOSTREAM.INSERT_DOUBLE_CLICKED,e)},u.load=function(e,t){this._load(e,t)},u._load=function(e,t){var n=this;this.emit(a.PHOTOSTREAM.START_LOADING),(0,i.fetchUserPhotostream)(e,t).then((function(e){n.emit(a.PHOTOSTREAM.LOAD,e.data),n.emit(a.PHOTOSTREAM.FINISH_LOADING,e)}))},s}(n(73287).Actions);e.exports=new s},51192:function(e,t,n){function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var i=n(48862).actions,o=n(73287),a=n(29806),s=function(e){var t,n;function o(){return e.apply(this,arguments)||this}n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,r(t,n);var s=o.prototype;return s.load=function(e,t){var n=this;e.isLoading||/^\s*$/.test(t)||(this.emit(i.SEARCH.INIT_WITH_WORD,t),this.emit(i.SEARCH.START_LOADING),a(t).then((function(e){n.emit(i.SEARCH.LOAD,e.data),n.emit(i.SEARCH.FINISH_LOADING,e)})))},s.loadMore=function(e){var t=this;!e.isLoading&&e.hasMore&&(this.emit(i.SEARCH.START_LOADING),a(e.word,e.page).then((function(e){t.emit(i.SEARCH.LOAD,e.data),t.emit(i.SEARCH.FINISH_LOADING,e)})))},s.toggleSelection=function(e){this.emit(i.SEARCH.TOGGLE_SELECTION,e)},s.insertSelected=function(){this.emit(i.SEARCH.INSERT_SELECTED)},s.insertDoubleClicked=function(e){this.emit(i.SEARCH.INSERT_DOUBLE_CLICKED,e)},o}(o.Actions);e.exports=new s},81915:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.Footer=void 0;var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),o=(r=n(9825))&&r.__esModule?r:{default:r};function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u=function(e){var t,n;function r(){return e.apply(this,arguments)||this}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,s(t,n),r.prototype.render=function(){var e=this,t=!this.props.hasSelectedItems;return i.createElement("div",{className:"editor-sidebar-flickr_footer"},i.createElement(o.default,{disabled:t,trackingId:this.props.trackingId,onClick:function(){return e.props.onClickInsertButton()}}))},r}(i.Component);t.Footer=u},38778:function(e,t,n){var r,i=(r=n(20996))&&r.__esModule?r:{default:r},o=n(49383);function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var s=n(67294),u=n(37357),l=n(66972),c=function(e){var t,n;function r(){return e.apply(this,arguments)||this}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,a(t,n),r.prototype.render=function(){var e=[{key:"photostream",name:i.default.text("edit_form.flickr.photostream"),component:u},{key:"search",name:i.default.text("edit_form.flickr.search"),component:l}];return s.createElement("div",{className:"editor-sidebar-main-panel-container"},s.createElement("div",{className:"editor-sidebar-main-panel"},s.createElement("div",{className:"editor-sidebar-header"},s.createElement("h2",null,i.default.text("edit_form.flickr"))),s.createElement("div",{className:"editor-sidebar-body"},s.createElement("div",{className:"editor-sidebar-tabs-container"},s.createElement(o.Tabs,{tabs:e,className:"editor-sidebar-tabs",localStoragePrefix:"sidebar-flickr-tab"})))))},r}(s.Component);e.exports=c},79218:function(e,t,n){t.__esModule=!0,t.default=void 0;var r,i=(r=n(67294))&&r.__esModule?r:{default:r};var o=function(e){var t=e.photo,n=e.onClickPhoto,r=e.onDoubleClickPhoto,o={backgroundImage:"url("+t.src_thumbnail+")"};return i.default.createElement("div",{className:"photo-list-item"+(t.isSelected?" selected":""),style:o,onClick:function(){return n(t.key)},onDoubleClick:function(){return r(t.key)}})};t.default=o},61393:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.PhotoList=void 0,n(21249);var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=l(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),i=u(n(20996)),o=u(n(79218)),a=u(n(71394)),s=n(90381);function u(e){return e&&e.__esModule?e:{default:e}}function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(l=function(e){return e?n:t})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var d=function(e){var t,n;function u(){return e.apply(this,arguments)||this}n=e,(t=u).prototype=Object.create(n.prototype),t.prototype.constructor=t,c(t,n);var l=u.prototype;return l.render=function(){if(this.props.showWelcomeMessage)return r.createElement("div",{className:"editor-sidebar-flickr_photo-list"},r.createElement(a.default,{text:this.props.welcomeMessage}));var e=this.props.isLoading,t=0===this.props.photos.length&&!e;return r.createElement("div",{className:"editor-sidebar-flickr_photo-list"},this.renderPhotos(),e?r.createElement(s.LoadingIndicator,null):null,t?r.createElement(a.default,{text:i.default.text("edit_form.empty_items")}):null)},l.renderPhotos=function(){var e=this;return this.props.photos.map((function(t){return r.createElement(o.default,{key:t.key,photo:t,onClickPhoto:function(t){return e.props.onClickPhoto(t)},onDoubleClickPhoto:function(t){return e.props.onDoubleClickPhoto(t)}})}))},u}(r.Component);t.PhotoList=d},71394:function(e,t,n){t.__esModule=!0,t.default=void 0;var r,i=(r=n(67294))&&r.__esModule?r:{default:r};var o=function(e){var t=e.text;return i.default.createElement("div",{className:"editor-sidebar-flickr_photo-list-message"},t)};t.default=o},37357:function(e,t,n){var r,i=(r=n(20996))&&r.__esModule?r:{default:r},o=n(46171),a=n(6529),s=n(61393),u=n(81915);function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var c=n(67294),d=n(73599),f=n(74937),p=function(e){var t,n;function r(){var t;return(t=e.call(this)||this).state=f.getState(),t.updateState=t._updateState.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t)),t}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,l(t,n);var p=r.prototype;return p.componentDidMount=function(){f.on("change",this.updateState)},p.componentWillUnmount=function(){f.removeListener("change",this.updateState)},p._updateState=function(){this.setState(f.getState())},p.render=function(){var e=this;return c.createElement("div",{className:"editor-sidebar-flickr_photostream"},c.createElement(a.UserAssociation,{user:this.state.user}),c.createElement("div",{className:"result"},c.createElement(o.InfiniteScroll,{onScroll:function(){return e.loadMore()}},c.createElement(s.PhotoList,{photos:this.state.photos,showWelcomeMessage:this.state.showWelcomeMessage,isLoading:this.state.isLoading,welcomeMessage:i.default.text("edit_form.flickr.photostream.description"),onClickPhoto:function(t){return e.toggleSelection(t)},onDoubleClickPhoto:function(t){return e.insertDoubleClicked(t)}}))),c.createElement(u.Footer,{onClickInsertButton:function(){return e.insertSelected()},hasSelectedItems:this.state.hasSelectedItems,trackingId:"curation-flickr-photostream-paste-button"}))},p.loadMore=function(){d.loadMore(this.state)},p.toggleSelection=function(e){d.toggleSelection(e)},p.insertDoubleClicked=function(e){d.insertDoubleClicked(e)},p.insertSelected=function(){d.insertSelected()},r}(c.Component);e.exports=p},66972:function(e,t,n){var r,i=(r=n(20996))&&r.__esModule?r:{default:r},o=n(46171),a=n(77898),s=n(61393),u=n(81915);function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var c=n(67294),d=n(51192),f=n(91395),p=function(e){var t,n;function r(){var t;return(t=e.call(this)||this).state=f.getState(),t.updateState=t._updateState.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t)),t}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,l(t,n);var p=r.prototype;return p.componentDidMount=function(){f.on("change",this.updateState)},p.componentWillUnmount=function(){f.removeListener("change",this.updateState)},p._updateState=function(){this.setState(f.getState())},p.render=function(){var e=this;return c.createElement("div",{className:"editor-sidebar-flickr_search"},c.createElement(a.SearchForm,{onSubmit:function(t){return e.load(t)}}),c.createElement("div",{className:"result"},c.createElement(o.InfiniteScroll,{onScroll:function(){return e.loadMore()}},c.createElement(s.PhotoList,{photos:this.state.photos,showWelcomeMessage:this.state.showWelcomeMessage,isLoading:this.state.isLoading,welcomeMessage:i.default.text("edit_form.flickr.search.description"),onClickPhoto:function(t){return e.toggleSelection(t)},onDoubleClickPhoto:function(t){return e.insertDoubleClicked(t)}}))),c.createElement(u.Footer,{onClickInsertButton:function(){return e.insertSelected()},hasSelectedItems:this.state.hasSelectedItems,trackingId:"curation-flickr-search-paste-button"}))},p.load=function(e){d.load(this.state,e)},p.loadMore=function(){d.loadMore(this.state)},p.toggleSelection=function(e){d.toggleSelection(e)},p.insertDoubleClicked=function(e){d.insertDoubleClicked(e)},p.insertSelected=function(){d.insertSelected()},r}(c.Component);e.exports=p},77898:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.SearchForm=void 0;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),i=a(n(20996)),o=a(n(70881));function a(e){return e&&e.__esModule?e:{default:e}}function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var l=function(e){var t,n;function a(){return e.apply(this,arguments)||this}return n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,u(t,n),a.prototype.render=function(){var e=this;return r.createElement("div",{className:"editor-sidebar-flickr_search-form"},r.createElement(o.default,{placeholder:i.default.text("edit_form.flickr.placeholder"),onSubmit:function(t){return e.props.onSubmit(t)}}))},a}(r.Component);t.SearchForm=l},6529:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.UserAssociation=void 0;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),i=a(n(20996)),o=a(n(6686));function a(e){return e&&e.__esModule?e:{default:e}}function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var l=n(73599),c=function(e){var t,n;function a(){return e.apply(this,arguments)||this}n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,u(t,n);var s=a.prototype;return s.render=function(){var e=this;return r.createElement(o.default,{user:this.props.user,onRegister:function(t){return e.register(t)},onUnregister:function(){return e.unregister()},placeholder:i.default.text("edit_form.flickr.screen_name")})},s.register=function(e){l.registerUser(e)},s.unregister=function(){l.unregisterUser()},a}(r.Component);t.UserAssociation=c},45441:function(e,t,n){t.__esModule=!0,t.fetchUserInfo=void 0,n(88674),n(41539);var r,i=(r=n(347))&&r.__esModule?r:{default:r};t.fetchUserInfo=function(e){return new Promise((function(t,n){i.default.get("/api/flickr/user",{params:{user_id:e}}).then((function(e){e.data.data?t(e.data):n()}),(function(){n()}))}))}},46007:function(e,t,n){t.__esModule=!0,t.fetchUserPhotostream=void 0,n(88674),n(41539);var r,i=(r=n(347))&&r.__esModule?r:{default:r};t.fetchUserPhotostream=function(e,t){return void 0===t&&(t=1),new Promise((function(n){i.default.get("/api/flickr/user_photostream",{params:{user_id:e,page:t}}).then((function(e){e.data.data?n(e.data):n({data:[]})}),(function(){n({data:[]})}))}))}},29806:function(e,t,n){n(88674),n(41539);var r=n(73609).get;e.exports=function(e,t){return void 0===e&&(e=""),void 0===t&&(t=1),new Promise((function(n){r("/api/flickr/search",{word:e,page:t}).then((function(e){e.data||(e={data:[]}),n(e)})).fail((function(){n({data:[]})}))}))}},52570:function(e,t,n){var r=n(67294),i=n(73935),o=n(38778),a=n(91395),s=n(74937),u=n(73599);e.exports={init:function(e){var t=e.container,n=e.sidebar;a.init(),s.init(),i.render(r.createElement(o,null),t);var l=!1,c=function(){var e=s.getState().user;e&&e.id&&u.load(e.id,1),l=!0},d="editor-flickr";n.type===d&&c(),n.on("tabChange",(function(e){!1===l&&e===d&&c()}))}}},6802:function(e,t,n){n(88674),n(41539);var r=n(45441),i=function(){function e(e){this.key=e.farm+"-"+e.server+"-"+e.id,this.id=e.id,this.farm=e.farm,this.server=e.server,this.permalink=e.permalink,this.title=e.title,this.user_id=e.user_id,this.username=null,this.src=e.src,this.src_thumbnail=e.src_thumbnail,this.isSelected=!1}var t=e.prototype;return t.fetchUserInfo=function(){var e=this;return this.username?Promise.resolve():new Promise((function(t,n){(0,r.fetchUserInfo)(e.user_id).then((function(n){e.username=n.data.username._content,t()})).catch((function(){n()}))}))},t.toggleSelection=function(){this.isSelected=!this.isSelected},e}();e.exports=i},15400:function(e,t,n){n(69826),n(57327),n(54747),n(88674),n(41539);var r=n(92477),i=n(10714),o=n(70879);function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var s=n(73287),u=n(6802),l=function(e){var t,n;function s(){return e.apply(this,arguments)||this}n=e,(t=s).prototype=Object.create(n.prototype),t.prototype.constructor=t,a(t,n);var l=s.prototype;return l.initState=function(){this.state={photos:[],isLoading:!1,hasMore:!1,page:1,hasSelectedItems:!1},this._photoKeys={}},l.getState=function(){return this.state.hasSelectedItems=this.state.photos.some((function(e){return e.isSelected})),this.state},l.load=function(e){this._add(e)},l.toggleSelection=function(e){this.state.photos.find((function(t){return t.key===e})).toggleSelection()},l.insertSelected=function(){var e=this.state.photos.filter((function(e){return e.isSelected}));this._insert(e),e.forEach((function(e){e.isSelected=!1}))},l.insertDoubleClicked=function(e){var t=this.state.photos.find((function(t){return t.key===e}));this._insert([t])},l.startLoading=function(){this.state.isLoading=!0},l.finishLoading=function(e){e.data.length?(this.state.page++,this.state.hasMore=!0):this.state.hasMore=!1,this.state.isLoading=!1},l._add=function(e){var t=this;e.forEach((function(e){var n=new u(e);t._photoKeys[n.key]||(t._photoKeys[n.key]=!0,t.state.photos.push(n))}))},l._insert=function(e){var t={hatena:[],markdown:[],html:[]};return e.forEach((function(e){t.hatena.push("["+e.permalink+":embed]"),t.markdown.push("["+e.permalink+":embed]")})),new Promise((function(e,n){(0,r.extractSyntax)(t.hatena).done((function(n){t.html=[n.html],e()})).fail((function(e){t.html=t.hatena,(0,o.BUG)(e),n()}))})).then((function(){(i.EditorConnector.isiOS()||i.EditorConnector.isAndroid())&&(t.html=t.hatena),i.EditorConnector.insertLines(t)}))},s}(s.Store);e.exports=l},74937:function(e,t,n){function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var i=n(48862).actions,o=n(73287),a=n(19165),s="sidebar-flickr-user",u=function(e){var t,n;function u(){return e.apply(this,arguments)||this}n=e,(t=u).prototype=Object.create(n.prototype),t.prototype.constructor=t,r(t,n);var l=u.prototype;return l.init=function(){var e=this;this.initState(),this.restoreUser(),o.on(i.PHOTOSTREAM.LOAD,(function(t){e.load(t),e.emit("change")})),o.on(i.PHOTOSTREAM.REGISTER_USER,(function(t){e.registerUser(t),e.emit("change")})),o.on(i.PHOTOSTREAM.UNREGISTER_USER,(function(){e.unregisterUser(),e.emit("change")})),o.on(i.PHOTOSTREAM.HIDE_WELCOME_MESSAGE,(function(){e.state.showWelcomeMessage=!1,e.emit("change")})),o.on(i.PHOTOSTREAM.START_LOADING,(function(){e.startLoading(),e.emit("change")})),o.on(i.PHOTOSTREAM.FINISH_LOADING,(function(t){e.finishLoading(t),e.emit("change")})),o.on(i.PHOTOSTREAM.TOGGLE_SELECTION,(function(t){e.toggleSelection(t),e.emit("change")})),o.on(i.PHOTOSTREAM.INSERT_SELECTED,(function(){e.insertSelected(),e.emit("change")})),o.on(i.PHOTOSTREAM.INSERT_DOUBLE_CLICKED,(function(t){e.insertDoubleClicked(t),e.emit("change")}))},l.registerUser=function(e){var t=e.data;this.state.user={id:t.nsid,name:t.username._content,uri:t.photosurl._content,icon:this._iconUrl(t)},this.state.showWelcomeMessage=!1,a.save(s,this.state.user)},l.unregisterUser=function(){this.initState(),a.save(s,null)},l.initState=function(){e.prototype.initState.call(this),this.state.user=null,this.state.showWelcomeMessage=!0},l.restoreUser=function(){var e=a.load(s);e&&e.id&&(this.state.showWelcomeMessage=!1,this.state.user=a.load(s))},l._iconUrl=function(e){var t=e.iconfarm,n=e.iconserver,r=e.nsid;return n>0?"https://farm"+t+".staticflickr.com/"+n+"/buddyicons/"+r+".jpg":"https://www.flickr.com/images/buddyicon.gif"},u}(n(15400));e.exports=new u},91395:function(e,t,n){function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var i=n(48862).actions,o=n(73287),a=function(e){var t,n;function a(){return e.apply(this,arguments)||this}n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,r(t,n);var s=a.prototype;return s.init=function(){var e=this;this.initState(),this.state.showWelcomeMessage=!0,o.on(i.SEARCH.INIT_WITH_WORD,(function(t){e.initState(t),e.emit("change")})),o.on(i.SEARCH.LOAD,(function(t){e.load(t),e.emit("change")})),o.on(i.SEARCH.START_LOADING,(function(){e.startLoading(),e.emit("change")})),o.on(i.SEARCH.FINISH_LOADING,(function(t){e.finishLoading(t),e.emit("change")})),o.on(i.SEARCH.TOGGLE_SELECTION,(function(t){e.toggleSelection(t),e.emit("change")})),o.on(i.SEARCH.INSERT_SELECTED,(function(){e.insertSelected(),e.emit("change")})),o.on(i.SEARCH.INSERT_DOUBLE_CLICKED,(function(t){e.insertDoubleClicked(t),e.emit("change")}))},s.initState=function(t){void 0===t&&(t=""),e.prototype.initState.call(this),this.state.word=t,this.state.showWelcomeMessage=!1},a}(n(15400));e.exports=new a},19864:function(e,t,n){t.__esModule=!0,t.Footer=void 0,n(69826),n(57327);var r=s(n(73609)),i=s(n(13469)),o=n(77102),a=s(n(20996));function s(e){return e&&e.__esModule?e:{default:e}}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var c=function(e){var t,n;function r(){return e.apply(this,arguments)||this}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,l(t,n),r.prototype.setPosition=function(){var e=this.$element[0].getBoundingClientRect(),t=this.$window.height();this.$window.css({top:e.top-t,left:e.right-this.$window.width()})},r}(o.Dropdown),d=function(){function e(e){var t=this;u(this,"editor",void 0),u(this,"$element",void 0),u(this,"$selector",void 0),u(this,"$dropdown",void 0),u(this,"$dropdownButtons",void 0),u(this,"$saveButtons",void 0),u(this,"$saveDraftButton",void 0),u(this,"$scheduledButton",void 0),u(this,"$otherActionsButton",void 0),u(this,"$otherActionsDropdownWindow",void 0),u(this,"saveMode",void 0),u(this,"isScheduled",void 0),u(this,"isOpen",void 0),u(this,"saveDraftState",void 0),u(this,"dropdown",void 0),u(this,"otherActionsDropdown",void 0),this.editor=e,this.$element=(0,r.default)(".l-editor-footer"),this.$selector=this.$element.find(".editor-save-buttons-selector a"),this.$dropdown=this.$element.find(".editor-save-buttons-dropdown"),this.$dropdownButtons=this.$dropdown.find("a"),this.$saveButtons=this.$element.find(".editor-save-buttons"),this.$saveDraftButton=this.$element.find(".js-editor-save-button-draft-and-continue"),this.$scheduledButton=this.$element.find(".editor-save-buttons-scheduled"),this.$otherActionsButton=this.$element.find(".other-actions-button"),this.$otherActionsDropdownWindow=this.$element.find(".other-actions-dropdown-window"),this.saveMode=this.$element.data("saveMode"),this.isScheduled=!1,this.isOpen=!1,this.saveDraftState="pending",this.dropdown=new c(this.$selector,this.$dropdown),this.otherActionsDropdown=new c(this.$otherActionsButton,this.$otherActionsDropdownWindow),this.$dropdown.on("click","a",(function(e){var n=(0,r.default)(e.currentTarget).data("saveMode");t.changeSaveMode(n)})),this.$selector.on("click",(function(){t.isOpen=!t.isOpen,t.render(),t.focusOnSelector()})),this.editor.on("toggleScheduledEntry",(function(e){t.isScheduled=e,t.isOpen=!1,t.render()})),this.$saveDraftButton.on("click",(function(e){e.preventDefault(),t.editor.saveDraft(!0)})),this.editor.on("savingDraft",(function(){t.saveDraftState="saving","draft"!==t.saveMode&&t.changeSaveMode("draft"),t.render()})),this.editor.on("saveDraft",(function(){t.saveDraftState="saved",t.editor.bindOnce("change",(function(){"saving"!==t.saveDraftState&&t.editor.emit("prepareSavingDraft")})),t.render()})),this.editor.on("prepareSavingDraft",(function(){t.saveDraftState="pending",t.render()})),"publish"===this.saveMode&&this.editor.getEntryId()||this.editor.on("saveShortcutKeydown",i.default.throttle((function(){"saved"!==t.saveDraftState&&t.editor.saveDraft(!0)}),1e3)),this.render()}var t=e.prototype;return t.render=function(){if(this.$saveButtons.find("input, button").addClass("is-hidden"),this.$saveButtons.find(".editor-save-button-"+this.saveMode).removeClass("is-hidden"),this.$selector.toggle(!this.isScheduled),this.$saveButtons.toggle(!this.isScheduled),this.$scheduledButton.toggle(this.isScheduled),"saving"===this.saveDraftState)this.$saveDraftButton.addClass("editor-save-label-saving-draft").removeClass("editor-save-label-saved-draft").text(a.default.text("edit_form.draft.saving")).prop("disabled",!0);else if("saved"===this.saveDraftState)this.$saveDraftButton.removeClass("editor-save-label-saving-draft").addClass("editor-save-label-saved-draft").html('<i class="blogicon-check"></i> '+i.default.escape(a.default.text("edit_form.draft.saved"))).prop("disabled",!1);else{if("pending"!==this.saveDraftState)throw new Error("unexpected state: "+this.saveDraftState);var e=this.editor.getEntryId()?a.default.text("edit_form.update_draft_button"):a.default.text("edit_form.draft_button");this.$saveDraftButton.removeClass("editor-save-label-saving-draft").removeClass("editor-save-label-saved-draft").text(e).prop("disabled",!1)}},t.focusOnSelector=function(){var e=this.$dropdownButtons.filter("[data-save-mode="+this.saveMode+"]");this.$dropdownButtons.removeClass("is-selected"),e.addClass("is-selected"),this.isOpen?e.focus():this.$selector.focus()},t.changeSaveMode=function(e){this.saveMode=e,this.isOpen=!1,this.render(),this.focusOnSelector(),this.editor.trigger("updateWillPublish","publish"===this.saveMode)},e}();t.Footer=d},70335:function(e,t,n){function r(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n(47042),n(41539),n(68309),n(91038),n(78783),n(82526),n(41817),n(32165),n(66992),n(33948),t.__esModule=!0,t.DiskSize=void 0,n(69826);var a=n(81191).trackEvent,s=function(){function e(t,n){o(this,"$container",void 0),o(this,"resize",void 0),this.$container=t.find(".js-disksize-container"),this.resize=n,e.allInstances.push(this)}e.renderDiskSizeGraph=function(t,n){for(var i,o=r(e.allInstances);!(i=o()).done;){i.value.renderDiskSizeGraph(t,n)}};var t=e.prototype;return t.renderDiskSizeGraph=function(e,t){var n=this.$container.find(".js-box"),r=this.$container.find(".js-bar"),i=this.$container.find(".js-rate"),o=e/t,a=Math.floor(100*o)+"%";i.text(a),r.css("width",a);var s=n.attr("data-label")+a;n.attr("original-title",s),this.$container.show(),this.resize()},t.showDiskFullAlert=function(){this.$container.find(".js-disk-full-alert").show(),this.resize(),a("fotolife.full_alert.show")},t.showUploadErrorAlert=function(e){e instanceof TypeError?this.$container.find(".js-upload-type-alert").show():(this.$container.find(".js-upload-fail-alert").show(),void 0!==e.errmsg&&this.$container.find(".js-upload-fail-alert").text(e.errmsg)),this.resize(),a("fotolife.upload_error.show")},e}();t.DiskSize=s,o(s,"allInstances",[])},15160:function(e,t,n){t.__esModule=!0,t.FotolifeUploadForm=void 0,n(69826),n(91038),n(78783),n(4723),n(74916),n(24603),n(39714),n(15306);var r=n(70879),i=n(21650),o=n(70782),a=n(70335),s=d(n(73609)),u=n(97050),l=d(n(57942)),c=d(n(20996));function d(e){return e&&e.__esModule?e:{default:e}}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var p=n(36500),h=n(59662),m=function(){function e(e,t){var n=this;f(this,"$element",void 0),f(this,"parent",void 0),f(this,"document",void 0),f(this,"messenger",void 0),f(this,"info",void 0),f(this,"diskSize",void 0),this.$element=e,this.parent=t,this.messenger=p.createForCurrentWindow(),this.diskSize=new a.DiskSize(this.$element,(function(){n.parent.emit("resize")})),!h.isIE&&(0,s.default)('<input type="file" />')[0].files&&"undefined"!=typeof FormData?this.initUploader():this.initIframeUploader(),this.initEvents()}var t=e.prototype;return t.initEvents=function(){var e=this;this.parent.on("success",(function(){return e.loadInfo()})),this.parent.on("error",(function(t){return e.diskSize.showUploadErrorAlert(t)})),this.parent.on("disk_full",(function(){return e.diskSize.showDiskFullAlert()}))},t.initUploader=function(){var e=this;this.$element.find(".fotolife-upload-form").show();var t=this.$element.find("input.file"),n=t.get()[0];t.on("change",(function(){e.parent.uploadAndPasteFiles(n.files?Array.from(n.files):[])})),this.loadInfo()},t.initIframeUploader=function(){var e,t=this,n=(0,s.default)('<iframe frameborder="0" style="border: none;"/>').prependTo(this.$element),o="/api/upload/fotolife/"+this.messenger.key;n.attr("src",o),n.css({width:250,height:90}),n.on("load",(function(){var e,r=n[0],i=r.contentDocument||(null===(e=r.contentWindow)||void 0===e?void 0:e.document);if(i){t.document=i;var a=i.body.innerHTML.match(/^\s*(f:id:\S+)/),s=i.body.innerHTML.match(/disk full/);a?(t.emitIframe("success",RegExp.$1),r.contentWindow&&r.contentWindow.location.replace(o)):s?(t.emitIframe("disk_full",null),t.emitIframe("error",null),r.contentWindow&&r.contentWindow.location.replace(o)):t.loadInfo()}})),this.onIframe("progress",(function(){e||(e=new i.Uploader,t.parent.emit("upload",e)),e.emit("progress",{percent:100})})),this.onIframe("success",(function(t){(0,u.extractFotolifeSyntax)(t).done((function(t){e&&t&&e.emit("success",t)})).fail((function(e){(0,r.BUG)(e)})).always((function(){e=null}))})),this.onIframe("disk_full",(function(t){e&&e.emit("disk_full",t)})),this.onIframe("error",(function(t){e&&e.emit("error",t)}))},t.onIframe=function(e,t){this.messenger.addEventListener("EditorUploadIframe",(function(n){n.eventName===e&&((0,r.LOG)(["onUploadIframe",n.eventName,n.result]),t(n.result))}))},t.emitIframe=function(e,t){var n={eventName:e,result:t};this.messenger.send("EditorUploadIframe",n)},t.uploadFile=function(e){var t=(0,s.default)(".js-folder-selector",this.document).val(),n=new i.Uploader;return this.parent.emit("upload",n),n.upload(e,t)},t.uploadFiles=function(e){var t=this,n=s.default.Deferred(),i=[];return e.reduce((function(e,n){return e.then((function(){return t.uploadFile(n).done((function(e){e&&i.push(e)})).fail((function(e){return e}))}),(function(e){return s.default.Deferred().reject(e)}))}),s.default.Deferred().resolve().promise()).done((function(){return n.resolve(i)})).fail((function(e){(0,r.LOG)(e),n.reject(i)})),n.promise()},t.loadInfo=function(){var e=this;(0,o.fetchFotolifeInfo)((0,l.default)("name")).then((function(t){e.info=t,e.updateFolderList(t.folder_list,t.is_private),e.setFotoSizeForIframeUploader(),a.DiskSize.renderDiskSizeGraph(t.disksize,t.maxdisksize),e.parent.emit("resize")}))},t.setFotoSizeForIframeUploader=function(){this.document&&(this.info&&(0,s.default)(".js-fotosize",this.document).val(this.fotoSize()))},t.fotoSize=function(){var e=i.Uploader.DEFAULT_SIZE;return this.info&&this.info.fotosize>e?this.info.fotosize:e},t.updateFolderList=function(e,t){var n=this,r=this.parent.defaultFolder;e.push({status:"private",folder:r}),e.push({status:t?"private":"public",folder:""});for(var i,o={},a=[],u=0;i=e[u];u++)o[i.folder]=i,a.push(i.folder);a.sort();var l=(0,s.default)(".js-folder-selector",this.document).val();o[l]||(l=r);for(var d=(0,s.default)(".js-folder-selector",this.document).empty(),f=0;f<a.length;f++)if(a[f]!==a[f-1]){var p=o[a[f]],h=p.folder||c.default.text("fotolife.folder.top");(t||"private"===p.status)&&(h+="(private)");var m=(0,s.default)("<option/>").attr("value",p.folder).text(h).appendTo(d);p.folder===l&&m.prop("selected",!0)}d.off("change"),d.on("change",(function(){n.parent.emit("changeFolder",(0,s.default)(d).val())})),d.parents(".js-fotolife-folder-wrapper").show()},e}();t.FotolifeUploadForm=m},64722:function(e,t,n){t.__esModule=!0,t.default=void 0,n(35666),n(88674),n(41539),n(21249),n(51532),n(78783),n(66992),n(33948),n(15306),n(74916),n(69826),n(91038);var r,i=n(70879),o=n(49573),a=n(62433),s=n(15160),u=n(17187),l=(r=n(73609))&&r.__esModule?r:{default:r};function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}var p=function(){var e,t=(e=regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){e(t.map((function(e){return{html:e.dataset.html||"",image:e.dataset.image||"",syntax:e.dataset.syntax||""}})))})));case 1:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){f(o,r,i,a,s,"next",e)}function s(e){f(o,r,i,a,s,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}(),h=function(e){return new Map([["html",e.html],["image",e.image],["syntax",e.syntax.replace(/:image/,":plain")]])},m=function(){function e(e){var t=this;d(this,"eventEmitter",void 0),d(this,"editor",void 0),d(this,"syntax",void 0),d(this,"sidebar",void 0),d(this,"imagePicker",void 0),d(this,"uploadForm",void 0),d(this,"$element",void 0),d(this,"$items",void 0),d(this,"$uploadForm",void 0),d(this,"$uploadFormWrapper",void 0),this.$element=e.container,this.eventEmitter=new u.EventEmitter,this.editor=e.editor,this.syntax=this.editor.syntaxForInsertLines,this.sidebar=e.sidebar,this.imagePicker=new o.ImagePicker({container:this.$element,editor:this.editor,selectors:this.selectors,storageKey:"fotolife-grid-column",showDetailSettingsCheckboxKey:"Fotolife.show-detail-settings-on-image-insertion",showLoadingWhilePasting:!1,convertItemsToFotolifeSyntaxes:p}),this.$items=this.$element.find(this.selectors.items),this.$uploadForm=this.$element.find(this.selectors.uploadForm),this.$uploadFormWrapper=this.$element.find(this.selectors.uploadFormWrapper),this.uploadForm=this.createUploadForm(),this._setupEvents(),this.resize(),this.load(this.defaultFolder,1),"editor-fotolife"===this.type&&((0,l.default)(document).on("uploadDroppedFiles",(function(e,n){return t.uploadAndPasteFiles(n)})),this.$items.on("drop",(function(e){var n=e.originalEvent.dataTransfer;if(null===n)return!1;var r=Array.from(n.files);return t.uploadAndPasteFiles(r),!1})).on("dragenter dragover",(function(){return!1})))}var t,n,r,f=e.prototype;return f.createUploadForm=function(){return new s.FotolifeUploadForm(this.$uploadForm,this)},f._setupEvents=function(){var e=this;this.on("upload",this.addUploadingItem.bind(this)),this.on("changeFolder",(function(t){e.load(t,1)}));var t=function(t){t===e.type&&e.resize()};this.sidebar.on("resize",t),this.sidebar.on("tabChange",t),this.on("resize",(function(){return e.resize()}))},f.uploadAndPasteFiles=function(e){var t=this;this.uploadForm.uploadFiles(e).then((function(e){return t.imagePicker.pasteItems({items:e||[],isUploadError:!1}).catch((function(e){return(0,i.BUG)(e)}))}),(function(e){return t.imagePicker.pasteItems({items:e||[],isUploadError:!0}).catch((function(e){return(0,i.BUG)(e)}))}))},f.addUploadingItem=function(e){var t=new a.Item({},!1);t.listenTo(e,this.eventEmitter,h),e.setParams({fotosize:this.uploadForm.fotoSize(),"delete-gps":1}),this.imagePicker.addItem(t)},f.load=function(e,t){var n=this,r=this.imagePicker.useHires;(0,i.LOG)(["load",e,t]),l.default.ajax({url:"/api/support/fotolife",type:"get",cache:!1,dataType:"json",data:{folder:e,page:t}}).done((function(o){if((0,i.LOG)(o),!o.error){var s=o.items.map((function(e){return new a.Item({image:e.image,hires_thumbnail:e.hires_thumbnail,attributes:h(e)},r)})),u=o.last?void 0:function(){n.load(e,t+1)};n.imagePicker.renderItems(s,1===t,u)}}))},f.resize=function(){var e=(0,l.default)("#editor-main").offset();if(void 0!==e){var t=(0,l.default)(window).height()-e.top;this.imagePicker.resize(t,this.$uploadFormWrapper.outerHeight(!0))}},f.on=function(){var e;(e=this.eventEmitter).on.apply(e,arguments)},f.emit=function(){var e;(e=this.eventEmitter).emit.apply(e,arguments)},t=e,(n=[{key:"selectors",get:function(){return{items:"#items",pasteButton:".paste-button",footerButtons:"#footer-buttons",uploadForm:"#uploader",uploadFormWrapper:"#uploader-wrapper",gridDropdown:".js-fotolife-grid-dropdown",gridDropdownToggle:".js-fotolife-grid-dropdown-toggle",showDetailSettingsCheckbox:".embed-config-fotolife"}}},{key:"type",get:function(){return"editor-fotolife"}},{key:"defaultFolder",get:function(){return"Hatena Blog"}}])&&c(t.prototype,n),r&&c(t,r),e}();t.default=m},54274:function(e){e.exports={API_LIMIT:"API_LIMIT",GIST_NOT_FOUND:"GIST_NOT_FOUND",USER_NOT_FOUND:"USER_NOT_FOUND"}},31046:function(e,t,n){n(69826);var r,i=(r=n(73609))&&r.__esModule?r:{default:r};var o=n(54274),a=function(){function e(e,t){var n=this;this.$container=e,this.$gistNotFound=this.$container.find(".gist-not-found-error"),this.$userNotFound=this.$container.find(".user-not-found-error"),this.$apiLimit=this.$container.find(".api-limit-error"),this.$ajaxError=this.$container.find(".ajax-error"),this.emitter=t,this.emitter.on("showError",(function(e){return n.showError(e)})),this.emitter.on("hideError",(function(){return n.hideError()}))}var t=e.prototype;return t.hideError=function(){this.$gistNotFound.hide(),this.$userNotFound.hide(),this.$apiLimit.hide(),this.$ajaxError.hide()},t.showError=function(e){this.hideError(),e===o.API_LIMIT?this.$apiLimit.show():e===o.GIST_NOT_FOUND?this.$gistNotFound.show():e===o.USER_NOT_FOUND?this.$userNotFound.show():this.$ajaxError.show(),(0,i.default)(window).resize()},e}();e.exports=a},86741:function(e,t,n){n(21249),n(82526),n(41817),n(41539),n(66992),n(33948),n(69600),n(54747),n(15306),n(74916);var r,i=(r=n(20996))&&r.__esModule?r:{default:r},o=n(64292),a=n(57753);function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var l=n(73609),c=n(13469),d=n(17187).EventEmitter,f=n(82607),p=n(31046),h=function(e){var t,n;function r(t){var n;return(n=e.call(this,t)||this).emitter=new d,n.errorMessage=new p(n.$container,n.emitter),n.userManager=new f(n.$container,n.emitter),n.emitter.on("userRegistered",(function(){n.resetUser(),n.requestLoadItems(),n.resize()})),n.emitter.on("userUnregistered",(function(){n.resetUser(),n.resize()})),n.bindEvents(),n}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,u(t,n);var a,h,m,v=r.prototype;return v.loadItems=function(e){var t=this,n=l.Deferred();if(!this.userManager||!this.userManager.getUser())return n.reject(),n;var r=this.userManager.getUser();return e&&r.forward(),r.loadGists().then((function(e){0===e.length&&(t.itemsReachedEnd=!0),n.resolve({entries:e})})).catch((function(e){t.emitter.emit("showError",e),t.itemsReachedEnd=!0,n.reject(e)})),n},v.showItems=function(e){var t=this,n=e.map((function(e){var n=e.description?(0,o.trimString)(e.description,50):"gist"+e.id,r=c.values(e.files)[0].language||"Unknown";return t.template({item:e,description:n,language:r})}));this.$indicator.before(n.join("")),i.default.updateTimestamps(this.$container[0])},v.insertItems=function(e){var t=this,n=[],r=this.editor.mode;e.forEach((function(e){var i=e.data("html-url"),o=e.data("description"),a=t.escapeDescription(r,o);n.push("["+i+":embed#"+a+"]"),"html"===r?n.push('<a href="'+i+'">'+a+"</a>"):"hatena"===r?n.push("["+i+":title="+a+"]"):n.push("["+a+"]("+i+")")})),this.editor.insertLines(n)},v.escapeDescription=function(e,t){var n=t;return"markdown"===e&&(n=t.replace(/[\\_*`]/g,"\\$&")),c.escape(n.replace(/[\n[\]]/g,""))},v.resetUser=function(){this.itemsReachedEnd=!1,this.removeItems(),this.emitter.emit("hideError"),this.userManager&&this.userManager.getUser()&&this.userManager.getUser().rewind()},a=r,(h=[{key:"type",get:function(){return"editor-gist"}},{key:"serviceName",get:function(){return"Gist"}},{key:"enableAutoPager",get:function(){return!0}},{key:"pasteReverseOrder",get:function(){return!0}}])&&s(a.prototype,h),m&&s(a,m),r}(a.MyCuration);e.exports=h},42703:function(e,t,n){n(68309),n(88674),n(41539),n(4723),n(74916);var r,i=(r=n(347))&&r.__esModule?r:{default:r};var o=n(54274),a=function(){function e(e){this.name=e,this.page=1,this._exists=!1}var t=e.prototype;return t.getName=function(){return this.name},t.getImage=function(){return this.info.avatar_url},t.loadUser=function(){var e=this;return i.default.get("https://api.github.com/users/"+this.name).then((function(t){e.info=t.data,e._exists=!0})).catch((function(){return Promise.reject(o.USER_NOT_FOUND)}))},t.loadGists=function(){var e=this;return i.default.get("https://api.github.com/users/"+this.name+"/gists",{params:{page:this.page,per_page:20}}).then((function(t){var n=t.data;return 0===n.length&&1===e.page?Promise.reject(o.GIST_NOT_FOUND):Promise.resolve(n)}),(function(e){try{var t=e.data.message;if(t.match("API rate limit exceeded"))return Promise.reject(o.API_LIMIT);if(t.match("Not Found"))return Promise.reject(o.USER_NOT_FOUND)}catch(e){}return Promise.reject()}))},t.forward=function(){this.page++},t.rewind=function(){this.page=1},t.exists=function(){return this._exists},e}();e.exports=a},49747:function(e,t,n){var r=n(42703),i=function(){function e(){this.users={}}return e.prototype.loadUser=function(e){var t=this;return this.users[e]||(this.users[e]=new r(e)),this.users[e].loadUser().then((function(){return t.users[e]}))},e}();e.exports=i},82607:function(e,t,n){n(69826);n(73609);var r=n(41960),i=n(19165),o=n(49747),a=function(){function e(e,t){this.$container=e,this.$input=this.$container.find(".gist-user-name"),this.$registerButton=this.$container.find(".register-button"),this.$unregisterButton=this.$container.find(".unregister-button"),this.$userImage=this.$container.find(".user-image"),this.$name=this.$container.find(".user-name"),this.$nameLink=this.$container.find(".user-name-link"),this.userLoader=new o,this.emitter=t,this.bindEvents(),this.$input.val(this.loadUserName()),this.tryRegisterFromInput()}var t=e.prototype;return t.bindEvents=function(){var e=this;this.$registerButton.on("click",(function(){return e.tryRegisterFromInput(),!1})),this.$input.on("keydown",(function(t){if("RET"===r(t))return e.tryRegisterFromInput(),!1})),this.$unregisterButton.on("click",(function(){return e.unregister(),!1}))},t.tryRegisterFromInput=function(){var e=this.$input.val();e&&this.tryRegister(e)},t.getUser=function(){return this.currentUser},t.tryRegister=function(e){var t=this;this.userLoader.loadUser(e).then((function(e){t.register(e)})).catch((function(e){t.emitter.emit("showError",e)}))},t.register=function(e){this.currentUser=e;var t=e.getName();this.setUserImage(e.getImage()),this.$name.text(t),this.$nameLink.attr("href","http://gist.github.com/"+t),this.saveUserName(t),this.$container.addClass("registered"),this.emitter.emit("userRegistered"),this.emitter.emit("hideError")},t.unregister=function(){this.currentUser=null,this.setUserImage(this.DEFAULT_UESR_IMAGE),this.saveUserName(""),this.$container.removeClass("registered"),this.$input.focus(),this.emitter.emit("userUnregistered"),this.emitter.emit("hideError")},t.setUserImage=function(e){this.$userImage.attr("src",e)},t.saveUserName=function(e){i.save("gist-user-name",e)},t.loadUserName=function(){return i.load("gist-user-name")||""},e}();e.exports=a},72069:function(e,t,n){e.exports=n(86741)},37048:function(e,t,n){n(88674),t.__esModule=!0,t.AlbumSelector=void 0,n(35666),n(51532),n(41539),n(78783),n(66992),n(33948),n(21249),n(92222),n(39714);var r,i=n(17187),o=(r=n(20996))&&r.__esModule?r:{default:r},a=n(4707);function s(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l={id:"all-images",title:o.default.text("edit_form.google-photos.all_images"),productUrl:"https://photos.google.com/"},c=function(){function e(e){var t=this;u(this,"eventEmitter",void 0),u(this,"albumIdToAlbum",void 0),u(this,"currentAlbum",void 0),u(this,"hasInitialized",!1),u(this,"selectorElement",void 0),u(this,"albumLink",void 0),this.eventEmitter=new i.EventEmitter,this.albumIdToAlbum=new Map,this.currentAlbum=null,this.selectorElement=e.querySelector(".js-album-selector"),this.albumLink=e.querySelector(".js-album-link"),this.selectorElement.addEventListener("change",(function(e){e.target instanceof HTMLSelectElement&&t.handleAlbumSelect(e.target.value)}))}var t=e.prototype;return t.init=function(){var e,t=(e=regeneratorRuntime.mark((function e(){var t,n,r,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.hasInitialized){e.next=2;break}return e.abrupt("return");case 2:return this.hasInitialized=!0,e.next=5,(0,a.fetchAlbums)();case 5:for(t=e.sent,this.albumIdToAlbum=new Map(t.map((function(e){return[e.id,e]}))),this.currentAlbum=l,this.selectorElement.innerHTML="",n=0,r=[l].concat(t);n<r.length;n++)i=r[n],(o=document.createElement("option")).value=i.id,o.textContent=i.title,i.id===l.id&&(o.selected=!0),this.selectorElement.appendChild(o);case 10:case"end":return e.stop()}}),e,this)})),function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){s(o,r,i,a,u,"next",e)}function u(e){s(o,r,i,a,u,"throw",e)}a(void 0)}))});return function(){return t.apply(this,arguments)}}(),t.handleAlbumSelect=function(e){this.currentAlbum&&this.currentAlbum.id===e||(this.currentAlbum=this.albumIdToAlbum.get(e)||l,this.albumLink.href=this.currentAlbum.productUrl,this.eventEmitter.emit("changeAlbum",this.currentAlbum.id===l.id?null:this.currentAlbum))},t.on=function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){var e;(e=this.eventEmitter).on.apply(e,arguments)})),e}();t.AlbumSelector=c},30189:function(e,t,n){function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}t.__esModule=!0,t.GooglePickerImportNotice=void 0;var i=n(19165),o=function(){function e(e,t,n){r(this,"editor",void 0),r(this,"noticeContainer",void 0),r(this,"isDismissedKey",void 0),this.editor=e,this.noticeContainer=t,this.isDismissedKey=n+".is-dismissed",this.isDismissed()?this.hide():this.setupEventListener()}var t=e.prototype;return t.isDismissed=function(){return i.load(this.isDismissedKey)},t.dismiss=function(){i.save(this.isDismissedKey,!0)},t.setupEventListener=function(){var e=this,t=this.noticeContainer.querySelector(".js-close-google-picker-import-notice");t&&t.addEventListener("click",(function(){e.dismiss(),e.hide(),e.editor.emit("resize")}))},t.hide=function(){this.noticeContainer.classList.add("dismissed")},e}();t.GooglePickerImportNotice=o},4707:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.uploadToFotolife=t.fetchMediaItems=t.fetchAlbums=void 0,n(21249);var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(347)),o=n(70879),a=(r=n(57942))&&r.__esModule?r:{default:r};function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}t.fetchAlbums=function(){return i.default.get("/api/google_photos/albums").then((function(e){if(e.data.error)throw e.data.error;return e.data.albums.map((function(e){return{id:e.id,title:e.title,productUrl:e.product_url}}))}),(function(e){throw(0,o.BUG)(e),e}))};t.fetchMediaItems=function(e,t,n){var r={page_size:t};return null!==e&&(r.album=e.id),void 0!==n&&(r.page_token=n),i.default.get("/api/google_photos/media_items",{params:r}).then((function(e){if(e.data.error)throw e.data.error;var t=e.data;return{mediaItems:t.media_items.map((function(e){return{id:e.id,isImage:e.is_image,baseUrl:e.base_url}})),nextPageToken:t.next_page_token||void 0}}),(function(e){throw(0,o.BUG)(e),e}))};t.uploadToFotolife=function(e){return i.default.request({method:"post",url:"/api/google_photos/upload_to_fotolife",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:{media_item_id:e.map((function(e){return e.id})),rkc:(0,a.default)("rkc"),rkm:(0,a.default)("rkm")},transformRequest:i.traditionalDataRequest}).then((function(e){if(e.data.error)throw e.data.error;return e.data.items}))}},73861:function(e,t,n){n(88674),t.__esModule=!0,t.GooglePhotos=void 0,n(35666),n(69826),n(21249),n(51532),n(41539),n(78783),n(66992),n(33948),n(57327);var r=p(n(73609)),i=n(17187),o=p(n(57942)),a=n(70782),s=n(70335),u=n(49573),l=n(62433),c=n(37048),d=n(4707),f=n(50121);function p(e){return e&&e.__esModule?e:{default:e}}function h(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function m(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){h(o,r,i,a,s,"next",e)}function s(e){h(o,r,i,a,s,"throw",e)}a(void 0)}))}}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var b=function(){function e(e){var t=this;g(this,"eventEmitter",void 0),g(this,"editor",void 0),g(this,"syntax",void 0),g(this,"sidebar",void 0),g(this,"albumSelector",void 0),g(this,"imagePicker",void 0),g(this,"fotolifeDiskSize",void 0),g(this,"hasInitialized",!1),g(this,"$element",void 0),g(this,"$items",void 0),g(this,"$header",void 0),this.$element=e.container,this.eventEmitter=new i.EventEmitter,this.editor=e.editor,this.syntax=this.editor.syntaxForInsertLines,this.sidebar=e.sidebar,this.albumSelector=new c.AlbumSelector(this.$element.get()[0]),this.imagePicker=new u.ImagePicker({container:this.$element,editor:this.editor,selectors:this.selectors,showLoadingWhilePasting:!0,convertItemsToFotolifeSyntaxes:function(e){return t.convertItemsToFotolifeSyntaxes(e)},onPasteSuccess:this.onPasteSuccess}),this.fotolifeDiskSize=new s.DiskSize(this.$element,(function(){return t.resize()})),this.$items=this.$element.find(this.selectors.items),this.$header=this.$element.find(this.selectors.header),this.setupEvents(),this.resize(),this.sidebar.type===this.type&&this.init()}var t,n,p,h=e.prototype;return h.setupEvents=function(){var e=this;this.albumSelector.on("changeAlbum",(function(t){e.load(t)}));var t=function(t){t===e.type&&e.resize()};this.sidebar.on("resize",t),this.sidebar.on("tabChange",t),this.on("resize",(function(){return e.resize()})),this.sidebar.on("openByType",(function(t){t===e.type&&e.init()}))},h.init=function(){this.albumSelector.init(),this.hasInitialized||(this.hasInitialized=!0,this.load(null))},h.load=function(){var e=m(regeneratorRuntime.mark((function e(t,n){var r,i,o,a,s,u,c=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=void 0===n)&&this.imagePicker.showLoading(),e.prev=2,e.next=5,(0,d.fetchMediaItems)(t,50,n);case 5:i=e.sent,o=i.mediaItems,a=i.nextPageToken,s=o.map((function(e){return new l.Item({image:(t=e.baseUrl,t+"=w500-h500"),attributes:c.convertMediaItemToItemAttributes(e),isDisabled:!e.isImage},!1);var t})),u=void 0===a?void 0:function(){c.load(t,a)},this.imagePicker.renderItems(s,r,u),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),this.imagePicker.showLoadingError();case 16:case"end":return e.stop()}}),e,this,[[2,13]])})));return function(t,n){return e.apply(this,arguments)}}(),h.resize=function(){var e=(0,r.default)("#editor-main").offset();if(void 0!==e){var t=(0,r.default)(window).height()-e.top,n=this.$header.outerHeight(!0);this.imagePicker.resize(t,n)}},h.convertMediaItemToItemAttributes=function(e){return new Map([["id",e.id],["baseUrl",e.baseUrl],["isImage",e.isImage?"true":"false"]])},h.convertItemsToFotolifeSyntaxes=function(){var e=m(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.filter((function(e){return void 0!==e.dataset.id})).map((function(e){return{id:e.dataset.id,baseUrl:e.dataset.baseUrl||"",isImage:"true"===e.dataset.isImage}})),e.prev=1,e.next=4,(0,f.uploadMediaItems)(n);case 4:return e.abrupt("return",e.sent);case 7:return e.prev=7,e.t0=e.catch(1),this.fotolifeDiskSize.showUploadErrorAlert(e.t0),e.abrupt("return",[]);case 11:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(t){return e.apply(this,arguments)}}(),h.onPasteSuccess=function(){(0,a.fetchFotolifeInfo)((0,o.default)("name")).then((function(e){s.DiskSize.renderDiskSizeGraph(e.disksize,e.maxdisksize)}))},h.on=function(){var e;(e=this.eventEmitter).on.apply(e,arguments)},h.emit=function(){var e;(e=this.eventEmitter).emit.apply(e,arguments)},t=e,(n=[{key:"selectors",get:function(){return{items:".js-items",pasteButton:".js-paste-button",footerButtons:".js-footer-buttons",header:".js-header"}}},{key:"type",get:function(){return"editor-google-picker"}}])&&v(t.prototype,n),p&&v(t,p),e}();t.GooglePhotos=b},50121:function(e,t,n){t.__esModule=!0,t.uploadMediaItems=void 0,n(35666),n(57327),n(47042),n(92222),n(88674),n(41539);var r=n(4707),i=n(97050);function o(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}var a=function(){var e,t=(e=regeneratorRuntime.mark((function e(t){var n,o,a,s,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.filter((function(e){return e.isImage})),o=[],a=0;case 3:if(!(a<n.length)){e.next=13;break}return s=n.slice(a,a+5),e.t0=o,e.next=8,(0,r.uploadToFotolife)(s);case 8:e.t1=e.sent,o=e.t0.concat.call(e.t0,e.t1);case 10:a+=5,e.next=3;break;case 13:return u=o.reduce((function(e,t){return e.then((function(e){return new Promise((function(n){(0,i.extractFotolifeSyntax)(t).done((function(t){n(void 0===t?e:[].concat(e,[t]))})).fail((function(){n(e)}))}))}))}),Promise.resolve([])),e.abrupt("return",u);case 15:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function s(e){o(a,r,i,s,u,"next",e)}function u(e){o(a,r,i,s,u,"throw",e)}s(void 0)}))});return function(e){return t.apply(this,arguments)}}();t.uploadMediaItems=a},90036:function(e,t,n){n(69826),n(21249);var r=n(10714),i=n(57753);function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var s=n(73609),u=n(41960),l=n(81378),c=function(e){var t,n;function i(t){var n;return(n=e.call(this,t)||this).$container=t.container,n.$searchPref=n.$container.find(".gourmet-pref"),n.$searchInput=n.$container.find(".gourmet-keyword-input"),n.$searchSubmit=n.$container.find(".gourmet-keyword-submit"),n.$description=n.$container.find(".gourmet-description"),n.$noResult=n.$container.find(".no-result"),n.$formatsContainer=n.$container.find(".gourmet-formats"),n.gourmetSearcher=new l({$searchInput:n.$searchInput,$searchPref:n.$searchPref}),n.restoreSelectedPref(),n.bindEvents(),n}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,a(t,n);var c,d,f,p=i.prototype;return p.restoreSelectedPref=function(){try{var e=localStorage[this.prefLocalStorageKey];e&&this.$searchPref.find("option[value="+e+"]").first().prop("selected",!0)}catch(e){}},p.bindEvents=function(){var t=this;e.prototype.bindEvents.call(this),this.$searchPref.on("change",(function(){try{localStorage[t.prefLocalStorageKey]=t.$searchPref.val()}catch(e){}})),this.$searchSubmit.on("click",(function(){t.requestReload()})),this.$searchInput.on("keydown",(function(e){return"RET"!==u(e)||(t.requestReload(),!1)})),this.$searchInput.on("focus",(function(){t.$description.hide()})),this.$formatsContainer.on("change",(function(e){var n=s(e.target);t.$formatsContainer.find("label.selected").removeClass("selected"),n.closest("label").addClass("selected")}))},p.loadItems=function(e){var t=this,n=s.Deferred();return e?this.gourmetSearcher.forward():(this.gourmetSearcher.reset(),this.itemsReachedEnd=!1),this.gourmetSearcher.load().done((function(e){n.resolve(e)})).fail((function(){n.reject()})).always((function(){t.itemsReachedEnd=!t.gourmetSearcher.hasNext})),n},p.loadItemsFinishedHandler=function(){this.gourmetSearcher.$searchInput.val()&&0===this.getItemsOnPage().length&&this.$noResult.show()},p.requestReload=function(){this.$noResult.hide(),e.prototype.requestReload.call(this)},p.insertItems=function(e){var t=this.$formatsContainer.find("input:checked").val(),n=e.map((function(e){return"["+e.attr("data-url")+":"+t+"]"}));r.EditorConnector.insertLines({hatena:n,markdown:n,html:n})},c=i,(d=[{key:"type",get:function(){return"editor-gourmet"}},{key:"serviceName",get:function(){return"Gourmet"}},{key:"enableAutoPager",get:function(){return!0}},{key:"prefLocalStorageKey",get:function(){return"MyCuration.Gourmet.Pref"}}])&&o(c.prototype,d),f&&o(c,f),i}(i.MyCuration);e.exports=c},81378:function(e,t,n){n(41539),n(66992),n(33948);var r=n(73609),i=function(){function e(e){if(this.$searchInput=e.$searchInput,this.$searchPref=e.$searchPref,!this.$searchInput||0===this.$searchInput.length)throw new TypeError("$searchInput required");if(!this.$searchPref||0===this.$searchPref.length)throw new TypeError("$searchPref required");this.searchKeyword="",this.searchPref="",this.page=1,this.hasNext=!0}var t=e.prototype;return t.load=function(){var e=this,t=r.Deferred();return this.searchKeyword?(r.ajax({url:"/api/gourmet/search",type:"GET",data:{word:this.searchKeyword,pref:this.searchPref,page:this.page},dataType:"json"}).done((function(n){0===n.entries.length&&(e.hasNext=!1),t.resolve(n)})).fail((function(){e.hasNext=!1,t.reject()})),t):(t.reject(),t)},t.forward=function(){this.page++},t.reset=function(){this.searchKeyword=this.$searchInput.val(),this.searchPref=this.$searchPref.val(),this.page=1,this.hasNext=!0},e}();e.exports=i},86795:function(e,t,n){n(69826),n(69600);var r,i=(r=n(20996))&&r.__esModule?r:{default:r},o=n(10714),a=n(92477);var s=n(73609),u=n(13469),l=n(81191).trackEvent,c=function(){this.init.apply(this,arguments)};c.prototype={init:function(e){this.type="editor-hatena-bookmark",this.$container=e.container,this.$container.get(0)&&(this.$header=this.$container.find(".header"),this.$itemsContainer=this.$container.find(".items"),this.$indicator=this.$container.find(".indicator"),this.template=u.template(this.$container.find(".template").html()),this.$errorMessage=this.$container.find(".error-message"),this.$disabledMessage=this.$container.find(".disabled-message"),this.$footer=this.$container.find(".footer"),this.$pasteButton=this.$container.find(".paste-button"),this.sidebar=e.sidebar,this.loadedPage=0,this.bindEvents(),this.resize(),this.loadItems(1))},bindEvents:function(){var e=this,t=this,n=function(t){t===e.type&&(e.resize(),e.loadItems(1))};this.sidebar.on("resize",n),this.sidebar.on("tabChange",n),t.$itemsContainer.on("click",".item",(function(e){if(!(s(e.target).is("a")||s(e.target).parents("a").length>0))return s(this).toggleClass("selected"),t.selectedItemsChanged(),!1})),t.$container.on("dblclick",".item",(function(e){if(!(s(e.target).is("a")||s(e.target).parents("a").length>0))return t.insertItems([s(this)]),s(this).removeClass("selected"),t.selectedItemsChanged(),l(t.$pasteButton.attr("data-track-name")),!1})),t.$pasteButton.click((function(e){var n=[];t.selectedItems().each((function(){n.push(s(this)),s(this).removeClass("selected")})),t.insertItems(n.reverse()),t.selectedItemsChanged()})),t.$itemsContainer.scroll(u.throttle((function(){(t.$itemsContainer.scrollTop()+t.$itemsContainer.height())/t.$itemsContainer[0].scrollHeight>.7&&t.loadItems(t.loadedPage+1)}),100))},resize:function(){var e=this,t=s(window).height()-s("#editor-main").offset().top;e.$itemsContainer.height(t-e.$header.outerHeight(!0)-e.$footer.outerHeight(!0))},selectedItemsChanged:function(){var e=this;e.selectedItems().length>0?e.$pasteButton.removeClass("disabled").addClass("enabled").prop("disabled",!1):e.$pasteButton.removeClass("enabled").addClass("disabled").prop("disabled",!0)},selectedItems:function(){return this.$itemsContainer.find(".selected")},loadItems:function(e){var t=this;t.isLoading||t.$container.is(":visible")&&(e>10||t.failed||t.loadedPage>e||(t.isLoading=!0,t.$indicator.show(),t.$errorMessage.hide(),s.ajax({url:"/api/hatena_bookmark/bookmarks?page="+e,type:"GET",dataType:"json"}).done((function(n){t.$errorMessage.hide(),1!==e||0!==n.length?t.showItems(n):t.showDisabledMessage()})).fail((function(e){t.$errorMessage.show(),t.failed=!0})).always((function(){t.$indicator.hide(),t.isLoading=!1})),t.loadedPage=e))},showDisabledMessage:function(){var e=this;e.$disabledMessage.show(),e.$itemsContainer.hide(),e.$footer.hide(),e.failed=!0},showItems:function(e){var t=this,n="";u.each(e,(function(e){n+=t.template({item:e})})),t.$indicator.before(n),i.default.updateTimestamps(t.$container[0])},insertItems:function(e){var t=[];u.each(e,(function(e){var n=e.attr("data-comment-url"),r=e.attr("data-permalink"),i=e.attr("data-description");i&&i.length>0?t.push("["+n+":embed]"):t.push("["+r+":embed:cite]")}));var n={html:t,hatena:t,markdown:t};"html"===s("#syntax").val()?(0,a.extractSyntax)(t.join("\n")).done((function(e){n.html=["",e.html,""]})).always((function(){o.EditorConnector.insertLines(n)})):o.EditorConnector.insertLines(n)}},e.exports=c},22117:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.Home=void 0,n(69826);var r=u(n(73609)),i=u(n(57942)),o=n(55992),a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(347));function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}function u(e){return e&&e.__esModule?e:{default:e}}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c=function(){function e(e){l(this,"type",void 0),l(this,"$element",void 0),l(this,"sidebar",void 0),l(this,"$header",void 0),l(this,"$services",void 0),this.type="editor-home",this.$element=e.container,this.sidebar=e.sidebar,this.$header=this.$element.find(".header"),this.$services=this.$element.find(".services"),this.setupButtons(),this.setupButtonActive(),this.bindEvents()}var t=e.prototype;return t.bindEvents=function(){var e=this;this.$element.on("click",".select-service",(function(t){var n=(0,r.default)(t.currentTarget);e.sidebar.emit("openByType",n.attr("data-support-type")),t.preventDefault()}));var t=function(t){t===e.type&&e.resize()};this.sidebar.on("resize",t),this.sidebar.on("tabChange",t)},t.resize=function(){this.$services.height(this.$element.height()-this.$header.outerHeight(!0))},t.setupButtons=function(){var e=this;this.$element.on("change","input",(function(t){var n=(0,r.default)(t.currentTarget),s=n.closest(".service").attr("data-service-id"),u=n.prop("checked")?1:0,l=(0,o.protocolRelativeAdminUserBlogUrl)("/edit_sidebar_button");a.default.post(l,{service_id:s,show:u,rkm:(0,i.default)("rkm"),rkc:(0,i.default)("rkc")},{transformRequest:a.formDataRequest}).then((function(){e.sidebar.emit("reloadSidebarButtons")}))}))},t.setupButtonActive=function(){this.$element.on("mouseenter",".about",(function(e){(0,r.default)(e.currentTarget).find(".curation-itemlist").addClass("is-active")})).on("mouseleave",".about",(function(e){(0,r.default)(e.currentTarget).find(".curation-itemlist").removeClass("is-active")}))},e}();t.Home=c},49573:function(e,t,n){n(47042),n(68309),n(91038),n(78783),n(82526),n(41817),n(32165),n(66992),n(33948),t.__esModule=!0,t.ImagePicker=void 0,n(69826),n(88674),n(41539),n(21249),n(69600),n(4723),n(74916),n(9653);var r=n(55992),i=u(n(20996)),o=n(29696),a=u(n(73609)),s=u(n(13469));function u(e){return e&&e.__esModule?e:{default:e}}function l(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var p=n(81191),h=n(19165),m=[1,2,3],v=function(e){return e.sort((function(e,t){return parseInt((0,a.default)(e).attr("item-order"),10)-parseInt((0,a.default)(t).attr("item-order"),10)}))},g=function(){function e(e){f(this,"editor",void 0),f(this,"syntax",void 0),f(this,"storageKey",void 0),f(this,"showDetailSettingsCheckboxKey",void 0),f(this,"showLoadingWhilePasting",void 0),f(this,"convertItemsToFotolifeSyntaxes",void 0),f(this,"onPasteSuccess",void 0),f(this,"imageLayout",void 0),f(this,"clickOrder",void 0),f(this,"$element",void 0),f(this,"$items",void 0),f(this,"$pasteButton",void 0),f(this,"$footerButtons",void 0),f(this,"$gridDropdown",void 0),f(this,"$gridDropdownToggle",void 0),f(this,"$showDetailSettingsCheckbox",void 0),f(this,"showDetailSettingsCheckboxSelector",void 0),this.$element=e.container,this.editor=e.editor,this.syntax=this.editor.syntaxForInsertLines,this.storageKey=e.storageKey,this.showDetailSettingsCheckboxKey=e.showDetailSettingsCheckboxKey,this.showLoadingWhilePasting=e.showLoadingWhilePasting,this.convertItemsToFotolifeSyntaxes=e.convertItemsToFotolifeSyntaxes,this.onPasteSuccess=e.onPasteSuccess;var t=e.selectors,n=t.items,r=t.pasteButton,i=t.footerButtons,o=t.gridDropdown,a=t.gridDropdownToggle,s=t.showDetailSettingsCheckbox;if(this.$items=this.$element.find(n),this.$pasteButton=this.$element.find(r),this.$footerButtons=this.$element.find(i),this.$gridDropdown=o?this.$element.find(o):void 0,this.$gridDropdownToggle=a?this.$element.find(a):void 0,this.$showDetailSettingsCheckbox=s?this.$element.find(s):void 0,this.showDetailSettingsCheckboxSelector=s,this._setupEvents(),this.imageLayout="column",this.clickOrder=0,this.$showDetailSettingsCheckbox&&this.showDetailSettingsCheckboxKey){var u=!1!==h.load(this.showDetailSettingsCheckboxKey);this.$showDetailSettingsCheckbox.prop("checked",u)}}var t,n,u,c=e.prototype;return c._setupEvents=function(){var e=this;this.$items.on("click",".item",(function(t){var n=(0,a.default)(t.currentTarget);n.hasClass("disabled")||(n.toggleClass("selected"),n.is(".selected")?n.attr("item-order",""+e.clickOrder++):n.find(".item-order-label").remove(),e.$items.find(".selected").length?e.$pasteButton.removeClass("disabled").addClass("enable"):e.$pasteButton.removeClass("enable").addClass("disabled"),e._updateOrderLabel())})),this.$items.on("dblclick",".item",(function(t){var n=(0,a.default)(t.currentTarget);if(!n.hasClass("disabled")){n.removeClass("selected"),n.find(".item-order-label").remove();var r=t.currentTarget,i=e.convertItemsToFotolifeSyntaxes([r]);e.showLoadingWhilePasting&&(0,o.waitForPromise)(r,i),i.then((function(t){var n=t[0];e.editor.insert(n["html"===e.syntax?"html":"syntax"]),e._onPasteSuccess()})),p.trackEvent(e.$pasteButton.attr("data-track-name")),e._updateOrderLabel()}})),this.$pasteButton.addClass("disabled").on("click",(function(){var t=e.$items.find(".item.selected").get(),n=e.convertItemsToFotolifeSyntaxes(v(t));if(e.showLoadingWhilePasting)for(var r,i=l(t);!(r=i()).done;){var a=r.value;(0,o.waitForPromise)(a,n)}return n.then((function(t){e.pasteItems({items:t}).then(e._onPasteSuccess.bind(e),(function(){}))})),!1})),this.$footerButtons.on("change",".fotolife-layout",(function(t){(0,a.default)(t.currentTarget).find("label.selected").removeClass("selected");var n=(0,a.default)(t.currentTarget).find("input:checked");n.closest("label").addClass("selected"),e.imageLayout=n.val()})),this.$showDetailSettingsCheckbox&&this.showDetailSettingsCheckboxKey&&this.$footerButtons.on("change",this.showDetailSettingsCheckboxSelector,(function(t){var n=(0,a.default)(t.currentTarget).prop("checked");h.save(e.showDetailSettingsCheckboxKey,n),p.trackEvent("EmbedBoxFotoCaption.showFromPaste.setEnable."+n)})),this.$gridDropdown&&this._setupGridDropdownEvents()},c.pasteItems=function(e){var t=this,n=e.items,r=e.isUploadError;if(!n.length)return r?Promise.resolve():Promise.reject("No images to paste");var i="",o=n.map((function(e){return e.image})),a="row"===this.imageLayout&&n.length>1;return i=a?this._generateRowLayoutSyntax(n):n.map((function(e){return"html"===t.syntax?e.html:e.syntax})).join(""),new Promise((function(e){if(t.$element.find(".curation-embed-config input").prop("checked"))t.editor.emit("paste-foto",{syntax:i,onSuccess:e,thumbnailUrls:o,isUploadError:r});else{var n="html"===t.editor.mode;t.editor.insert(i+(n?"<br>":"")),e()}}))},c._onPasteSuccess=function(){this.$items.find(".item.selected").removeClass("selected").find(".item-order-label").remove(),this.clickOrder=0,this.$pasteButton.removeClass("enable").addClass("disabled"),this.onPasteSuccess&&this.onPasteSuccess()},c._generateRowLayoutSyntax=function(e){var t=this;return'<div class="images-row mceNonEditable">'+e.map((function(e){if("html"===t.syntax){var n=(0,a.default)(e.html).find("img"),r=(0,a.default)(a.default.parseHTML('<div><div class="images-row-item"></div></div>'));return r.find(".images-row-item").append(n),r.get(0).innerHTML}return e.syntax})).join("")+"</div>"},c._updateOrderLabel=function(){s.default.debounce(this._putOrDeleteOrderLabel,250).call(this)},c._putOrDeleteOrderLabel=function(){var e=this.$items.find(".item.selected");(0,a.default)(v(e.get())).each(e.length>1?function(e,t){var n=(0,a.default)(t).find(".item-order-label");n[0]?n.text(""+(e+1)):(0,a.default)(t).append((0,a.default)(a.default.parseHTML('<div class="item-order-label">'+(e+1)+"</div>")))}:function(e,t){(0,a.default)(t).find(".item-order-label").remove()})},c._setFotoColumn=function(e){var t=this;if(m.forEach((function(e){return t.$items.removeClass("image-picker-grid-col-"+e)})),this.$items.addClass("image-picker-grid-col-"+e),this.$gridDropdownToggle){this.$gridDropdownToggle.children("i").attr("class",["blogicon-grid-vertical","blogicon-grid","blogicon-grid-3x3"][e-1])}this.$gridDropdown&&this.$gridDropdown.removeClass("is-open")},c._changeFotoResolution=function(e){var t=1===e||2===e;this.$items.children(".item").each((function(e,n){var r=(0,a.default)(n);if(!r.hasClass("pager-next")){var i=t?r.data("hires-image"):r.data("image");(0,o.loadImage)(i,n)}}))},c._setupGridDropdownEvents=function(){var e=this;this.$gridDropdownToggle&&this.$gridDropdown&&(this.$gridDropdownToggle.on("click",(function(){e.$gridDropdown&&e.$gridDropdown.toggleClass("is-open")})),this.$gridDropdown.on("click",(function(t){var n=(0,a.default)(t.target).closest("li").attr("class").match(/^js-fotolife-grid-(1|2|3)$/);if(null!==n){var r=Number(n[1]);e._setFotoColumn(r),e._changeFotoResolution(r),void 0!==e.storageKey&&h.save(e.storageKey,r)}})),void 0!==this.storageKey&&this._setFotoColumn(h.load(this.storageKey)))},c.showLoading=function(){this.$items.empty();var e=document.createElement("div");e.classList.add("editor-sidebar_loading-indicator");var t=document.createElement("img");t.classList.add("loading-spinner"),t.src=(0,r.staticUrl)("/images/loading.gif"),t.alt="",e.appendChild(t),e.appendChild(document.createTextNode(i.default.text("loading"))),this.$items.append(e)},c.showLoadingError=function(e){this.$items.empty();var t=document.createElement("p");t.textContent=e||i.default.text("edit_form.get_data_failed"),this.$items.append(t)},c.addItem=function(e){this.$items.prepend((0,a.default)(e.element))},c.renderItems=function(e,t,n){t&&this.$items.empty(),this.$items.append(e.map((function(e){return e.element}))),n&&(0,a.default)('<div class="item pager-next"/>').on("click",(function(e){return(0,a.default)(e.currentTarget).remove(),n(),!1})).appendTo(this.$items)},c.resize=function(e,t){this.$items.height(e-t-this.$footerButtons.outerHeight(!0)-2*(this.$items.outerHeight(!0)-this.$items.height()))},t=e,(n=[{key:"useHires",get:function(){if(void 0===this.storageKey)return!1;var e=h.load(this.storageKey);return 1===e||2===e}}])&&d(t.prototype,n),u&&d(t,u),e}();t.ImagePicker=g},62433:function(e,t,n){t.__esModule=!0,t.Item=void 0,n(51532),n(41539),n(78783),n(66992),n(33948),n(91038),n(54747);var r,i=n(29696),o=(r=n(20996))&&r.__esModule?r:{default:r};function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s=function(){function e(e,t){a(this,"image",void 0),a(this,"hiresImage",void 0),a(this,"attributes",void 0),a(this,"isUploading",void 0),a(this,"percent",void 0),a(this,"barWidth",void 0),a(this,"element",void 0),this.image=e.image,this.hiresImage=e.hires_thumbnail,this.attributes=e.attributes||new Map,this.isUploading=!1,this.percent=o.default.text("uploading"),this.barWidth="0",this.element=this.createElement(e.isDisabled),this.render(t)}var t=e.prototype;return t.createElement=function(e){void 0===e&&(e=!1);var t=document.createElement("div");return t.classList.add("item"),e&&t.classList.add("disabled"),t},t.getUploadingHTMLString=function(e){return'<div class="progress"><div class="percent">'+e.percent+'</div><div class="bar" style="width: '+e.width+'"></div></div>'},t.render=function(e){var t=this;void 0===e&&(e=!1);for(var n=0,r=Array.from(this.attributes.entries());n<r.length;n++){var o=r[n],a=o[0],s=o[1];this.element.dataset[a]=s}if(this.hiresImage&&(this.element.dataset.hiresImage=this.hiresImage),Array.from(this.element.childNodes).forEach((function(e){return t.element.removeChild(e)})),(0,i.loadImage)(e&&this.hiresImage?this.hiresImage:this.image,this.element,!0),this.isUploading){var u=this.getUploadingHTMLString({percent:this.percent,width:this.barWidth});this.element.insertAdjacentHTML("beforeend",u),this.element.classList.add("is-uploading")}else this.element.classList.remove("is-uploading")},t.listenTo=function(e,t,n){var r=this;this.isUploading=!0;var i=0,a=0,s=function(e){r.barWidth=Math.min(e,100)+"%",r.percent=o.default.text("uploading"),r.render()};e.on("error",(function(e){clearInterval(i),r.element.parentNode&&r.element.parentNode.removeChild(r.element),t.emit("error",e)})),e.on("disk_full",(function(e){clearInterval(i),r.element.parentNode&&r.element.parentNode.removeChild(r.element),t.emit("disk_full",e)})),e.on("progress",(function(e){var t=.9*e.percent;100===e.percent?(clearInterval(i),i=window.setInterval((function(){s(t+(a+=.1))}),100)):s(t)})),e.on("success",(function(e){clearInterval(i),r.isUploading=!1,r.image=e.image,r.attributes=n(e),r.render(),t.emit("success",e)}))},e}();t.Item=s},29696:function(e,t,n){t.__esModule=!0,t.waitForPromise=t.loadImage=void 0;var r=n(55992);t.loadImage=function(e,t,n){void 0===n&&(n=!1),n&&t.classList.add("is-loading");var i=document.createElement("div");i.classList.add("image");var o=document.createElement("img");if(o.classList.add("loading-spinner"),t.appendChild(i),t.appendChild(o),e){var a=new Image;a.onload=function(){t.classList.remove("is-loading")},a.src=e,i.style.backgroundImage="url('"+a.src+"')"}o.src=(0,r.staticUrl)("/images/loading.gif")};t.waitForPromise=function(e,t){e.classList.add("is-loading"),t.then((function(){e.classList.remove("is-loading")}))}},46171:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.InfiniteScroll=void 0,n(92222),n(35192),n(9653);var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=i(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=o?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(67294));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(i=function(e){return e?n:t})(e)}function o(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u=n(13469),l=100,c=300,d={position:"absolute",top:0,left:0,width:"100%",height:"100%",margin:0,padding:0,overflowY:"auto"},f={width:"100%"},p=function(e){var t,n;function i(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return s(o(t=e.call.apply(e,[this].concat(r))||this),"_interval",c),s(o(t),"_padding",l),s(o(t),"_pos",0),s(o(t),"_onScroll",void 0),s(o(t),"_outer",null),t}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,a(t,n);var p=i.prototype;return p.componentDidMount=function(){var e=this;this._interval=Number.isFinite(this.props.interval)?+this.props.interval:c,this._padding=Number.isFinite(this.props.padding)?+this.props.padding:l,this._pos=0,this._onScroll=u.throttle((function(t){return e.onScroll(t)}),this._interval),this._onScroll&&this._outer.addEventListener("scroll",this._onScroll)},p.componentWillUnmount=function(){this._outer.removeEventListener("scroll",this._onScroll),this._onScroll=void 0,this._pos=0},p.onScroll=function(e){if(!this.props.disabled){var t=e.target,n=this._pos;if(this._pos=t.scrollTop,!(this._pos-n<=0)){var r=t.scrollHeight-(t.clientHeight+t.scrollTop);this._padding<=r||this.props.onScroll()}}},p.render=function(){var e=this;return r.createElement("div",{className:"InfiniteScroll",ref:function(t){e._outer=t},style:d,onScroll:this._onScroll},r.createElement("div",{className:"InfiniteScroll__Inner",style:f},this.props.children))},i}(r.Component);t.InfiniteScroll=p,s(p,"defaultProps",{padding:l,interval:c,disabled:!1})},30871:function(e,t,n){n(47042),n(68309),n(91038),n(78783),n(82526),n(41817),n(32165),t.__esModule=!0,t.Instagram=void 0,n(41539),n(66992),n(33948),n(69826);var r,i=(r=n(73609))&&r.__esModule?r:{default:r},o=n(92477),a=n(70879),s=n(10714);function u(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=function(e){var t,n;function r(t){var n;return n=e.call(this,t)||this,(0,i.default)(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(n)).on("items-appended",(function(){n.setPaddingLeft()})),n.resize(),n.bindEvents(),n}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,d(t,n);var l,f,p,h=r.prototype;return h.loadItems=function(e){var t=this,n=e?this.$itemsContainer.attr("data-after-cursor"):void 0,r={after:void 0!==n&&""!==n?n:void 0};return i.default.ajax({url:"/api/instagram/recent",data:r,type:"GET",dataType:"json"}).fail((function(){t.pleaseReAuthorize()})).done((function(e){return e&&e.data&&(e.entries=e.data),e.paging&&e.paging.cursors.after?t.$itemsContainer.attr("data-after-cursor",e.paging.cursors.after):t.itemsReachedEnd=!0,e}))},h.pleaseReAuthorize=function(){this.$container.find(".disabled-box").show()},h.insertItems=function(e){for(var t,n={hatena:[],markdown:[],html:[]},r=u(e);!(t=r()).done;){var i=t.value.attr("data-permalink");n.hatena.push("["+i+":embed]"),n.markdown.push("["+i+":embed]")}(0,o.extractSyntax)(n.hatena).done((function(e){n.html=[e.html]})).fail((function(e){n.html=n.hatena,(0,a.BUG)(e)})).always((function(){s.EditorConnector.insertLines(n)}))},h.setPaddingLeft=function(){var e=this.$container.find(".items"),t=e.find(".item");if(0!==t.length){var n=t.eq(0),r=n.position().top,o=n.position().left,a=o+n.outerWidth();t.each((function(e,t){var n=(0,i.default)(t);if(n.position().top!==r)return!1;a=n.position().left+n.outerWidth()}));var s=a-o,u=(e.width()-s)/2;e.css({"padding-left":u})}},l=r,(f=[{key:"type",get:function(){return"editor-instagram"}},{key:"serviceName",get:function(){return"Instagram"}},{key:"enableAutoPager",get:function(){return!0}},{key:"pasteReverseOrder",get:function(){return!0}}])&&c(l.prototype,f),p&&c(l,p),r}(n(57753).MyCuration);t.Instagram=f},35227:function(e,t,n){n(69826),n(23123),n(74916),n(19601),n(54747);var r=n(70879),i=n(92477),o=n(10714),a=n(57753);function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var l=n(73609),c=n(13469),d=n(41960),f=function(e){var t,n;function a(t){var n;return(n=e.call(this,t)||this)._templatesByType={default:c.template(n.$container.find(".template").html()),artist:c.template(n.$container.find(".template-artist").html()),collection:c.template(n.$container.find(".template-collection").html()),audiobook:c.template(n.$container.find(".template-collection").html())},n.bindEvents(),n}n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,u(t,n);var f,p,h,m=a.prototype;return m.bindEvents=function(){var t=this;e.prototype.bindEvents.call(this),this.$submit=this.$container.find(".itunes-keyword-submit"),this.$media=this.$container.find(".itunes-media"),this.$keyword=this.$container.find(".itunes-keyword"),this.$welcomeMessage=this.$container.find(".items-welcome"),this.$submit.on("click",(function(){return t.requestReload(),!1})),this.$media.on("change",(function(){return t.requestReload(),!1})),this.$keyword.on("keydown",(function(e){if("RET"===d(e))return t.requestReload(),!1}))},m.willRequestLoadItems=function(){return""!==this.$keyword.val()},m.loadItems=function(){this.$welcomeMessage.addClass("disable");var e=this.$keyword.val(),t=this.$media.val().split(":"),n={term:e,media:t[0],entity:t[1]};return l.ajax({url:"/api/itunes/search",data:n,type:"GET",dataType:"json"})},m.renderItem=function(e){var t=e.wrapperType||"default";return this._templateByType(t)({item:Object.assign({},e,{_formattedPrice:this._renderPrice(e),_genre:this._renderGenre(e)})})},m._renderPrice=function(e){if(void 0!==e.formattedPrice)return e.formattedPrice;if(void 0!==e.trackPrice||void 0!==e.collectionPrice){var t=e.trackPrice||e.collectionPrice,n=e.currency;return t<0?"":"JPY"===n?"¥"+t:n+" "+t}return""},m._renderGenre=function(e){return void 0!==e.genres&&Array.isArray(e.genres)&&e.genres.length>0?e.genres[0]:void 0!==e.primaryGenreName?e.primaryGenreName:""},m._templateByType=function(e){return this._templatesByType[e]||this._templatesByType.default},m.insertItems=function(e){var t={hatena:[],markdown:[]};e.forEach((function(e){var n="["+e.attr("data-permalink")+":embed]";t.hatena.push(n),t.markdown.push(n)})),(0,i.extractSyntax)(t.hatena).done((function(e){t.html=["",e.html,""]})).fail((function(e){t.html=t.hatena,(0,r.BUG)(e)})).always((function(){(o.EditorConnector.isiOS()||o.EditorConnector.isAndroid())&&(t.html=t.hatena),o.EditorConnector.insertLines(t)}))},f=a,(p=[{key:"type",get:function(){return"editor-itunes"}},{key:"serviceName",get:function(){return"Itunes"}},{key:"enableAutoPager",get:function(){return!1}},{key:"pasteReverseOrder",get:function(){return!1}}])&&s(f.prototype,p),h&&s(f,h),a}(a.MyCuration);e.exports=f},90381:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.LoadingIndicator=void 0;var r,i=u(n(67294)),o=u(n(55992)),a=(r=n(20996))&&r.__esModule?r:{default:r};function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}function u(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}t.LoadingIndicator=function(e){var t=e.text;return i.createElement("div",{className:"editor-sidebar_loading-indicator"},i.createElement("img",{src:o.staticUrl("/images/loading.gif"),alt:"",className:"loading-spinner"}),null!=t?t:a.default.text("loading"))}},25916:function(e,t,n){n(69826),n(54747);var r=n(57753);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var a=n(73609),s=n(13469),u=n(17187).EventEmitter,l=n(62439),c=function(e){var t,n;function r(t){var n;(n=e.call(this,t)||this).editor=t.editor,n.emitter=new u,n.userManager=new l({container:n.$container,emitter:n.emitter}),n.emitter.on("userRegistered",(function(){n.resetUser(),n.requestLoadItems(),n.resize()})),n.emitter.on("userUnregistered",(function(){n.resetUser(),n.resize()}));var r=n.$container.find(".editor-template");return n.editorTemplate=s.template(r.html()),n.bindEvents(),n}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,o(t,n);var c,d,f,p=r.prototype;return p.loadItems=function(e){var t=this,n=a.Deferred();if(!this.userManager||!this.userManager.getUser())return n.reject(),n;var r=this.userManager.getUser();return e&&r.forward(),r.load().done((function(e){var t=e.photos;t.forEach((function(e){e.thumbnail_url=e.url+"=s72"})),n.resolve({entries:t})})).fail((function(){n.reject(),t.itemsReachedEnd=!0})),n},p.insertItems=function(e){var t=this,n=[];s.each(e,(function(e){var r=e.attr("data-permalink"),i=e.attr("data-image-url"),o=e.attr("data-title");"html"===t.editor.getSyntax()?n.push(t.editorTemplate({item:{permalink_url:r,image_url:i,title:o}})):(n.push("["+r+":image="+i+"]"),o&&n.push(o))})),this.editor.insertLines(n)},p.resetUser=function(){this.itemsReachedEnd=!1,this.removeItems(),this.userManager&&this.userManager.getUser()&&this.userManager.getUser().rewind()},c=r,(d=[{key:"type",get:function(){return"editor-miil"}},{key:"serviceName",get:function(){return"Miil"}},{key:"enableAutoPager",get:function(){return!0}},{key:"pasteReverseOrder",get:function(){return!0}}])&&i(c.prototype,d),f&&i(c,f),r}(r.MyCuration);e.exports=c},6702:function(e,t,n){n(68309),n(4723),n(74916);var r=n(73609),i=n(22592),o=function(){function e(e){var t=this;this.name=e,this.photosLoaderRoot=new i((function(e){return t._photosLoaderBody(e)})),this.photosLoader=this.photosLoaderRoot}var t=e.prototype;return t.getName=function(){return this.name},t.getImage=function(){return this.basicData.photos[0].user.user_icon_url},t.load=function(){return this.photosLoader.promise()},t.forward=function(){this.photosLoader=this.photosLoader.next()},t.rewind=function(){this.photosLoader=this.photosLoaderRoot},t.exists=function(){return"resolved"===this.photosLoaderRoot.promise().state()},t._photosURL=function(e){return"http://api.miil.me/api/users/"+this.name+"/photos/public.json?"+r.param(e)},t._getNextPageFromReceivedData=function(e){if(e&&e.next_url){var t=e.next_url.match(/page=(\d+)/);if(t)return t[1]}},t._photosLoaderBody=function(e){var t=this,n=r.Deferred(),i=r.Deferred();return e?e.promise().done((function(e){var n=t._getNextPageFromReceivedData(e);n||i.reject(),i.resolve(n)})).fail((function(){i.reject()})):i.resolve(),i.done((function(e){var i={};e&&(i.page=e),r.ajax({url:"/api/external/json",type:"GET",dataType:"json",data:{url:t._photosURL(i)}}).done((function(e){e&&e.photos&&e.photos.length>0?(t.basicData||(t.basicData=e),n.resolve(e)):n.reject()})).fail((function(){n.reject()}))})).fail((function(){n.reject()})),n},e}();e.exports=o},53750:function(e,t,n){var r=n(73609),i=n(6702),o=function(){function e(){this.users={}}return e.prototype.loadUser=function(e){var t=this,n=r.Deferred();return this.users[e]||(this.users[e]=new i(e)),this.users[e].load().always((function(){n.resolve(t.users[e])})),n},e}();e.exports=o},62439:function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n(69826);var i=n(41960),o=n(19165),a=n(53750),s=function(){function e(e){this.$container=e.container,this.$input=this.$container.find(".miil-user-name"),this.$registerButton=this.$container.find(".register-button"),this.$unregisterButton=this.$container.find(".unregister-button"),this.$userImage=this.$container.find(".user-image"),this.$name=this.$container.find(".user-name"),this.$nameLink=this.$container.find(".user-name-link"),this.$userNotFound=this.$container.find(".user-not-found-error"),this.emitter=e.emitter,this.userLoader=new a,this.bindEvents(),this.$input.val(this.loadUserName()),this.tryRegisterFromInput()}var t,n,s,u=e.prototype;return u.bindEvents=function(){var e=this;this.$registerButton.on("click",(function(){return e.tryRegisterFromInput(),!1})),this.$input.on("keydown",(function(t){if("RET"===i(t))return e.tryRegisterFromInput(),!1})),this.$unregisterButton.on("click",(function(){return e.unregister(),!1}))},u.tryRegisterFromInput=function(){var e=this.$input.val();e&&this.tryRegister(e)},u.getUser=function(){return this.currentUser},u.tryRegister=function(e){var t=this;this.userLoader.loadUser(e).done((function(e){e.exists()?t.onUserFound(e):(t.unregister(),t.$userNotFound.show())}))},u.onUserFound=function(e){this.currentUser=e,this.setUserImage(e.getImage()||this.DEFAULT_UESR_IMAGE),this.$name.text(e.getName()),this.$nameLink.attr("href","http://miil.me/u/"+e.getName()),this.saveUserName(e.getName()),this.$userNotFound.hide(),this.$container.addClass("registered"),this.emitter.emit("userRegistered")},u.unregister=function(){this.currentUser=null,this.$input.focus(),this.setUserImage(this.DEFAULT_UESR_IMAGE),this.saveUserName(""),this.$userNotFound.hide(),this.$container.removeClass("registered"),this.emitter.emit("userUnregistered")},u.setUserImage=function(e){this.$userImage.attr("src",e)},u.saveUserName=function(e){o.save("miil-user-name",e)},u.loadUserName=function(){return o.load("miil-user-name")||""},t=e,(n=[{key:"DEFAULT_UESR_IMAGE",get:function(){return"http://assets.miil.me/images/pc/user.jpg"}}])&&r(t.prototype,n),s&&r(t,s),e}();e.exports=s},16907:function(e,t,n){e.exports=n(25916)},57753:function(e,t,n){t.__esModule=!0,t.MyCuration=void 0,n(69826),n(41539),n(66992),n(33948),n(69600),n(21249);var r=s(n(73609)),i=s(n(13469)),o=s(n(20996)),a=n(34327);function s(e){return e&&e.__esModule?e:{default:e}}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c=n(81191).trackEvent,d=function(){function e(e){l(this,"editor",void 0),l(this,"sidebar",void 0),l(this,"$container",void 0),l(this,"$header",void 0),l(this,"$itemsContainer",void 0),l(this,"$tabsContainer",void 0),l(this,"$indicator",void 0),l(this,"$errorMessage",void 0),l(this,"$disabledMessage",void 0),l(this,"$footer",void 0),l(this,"$pasteButton",void 0),l(this,"template",void 0),l(this,"loadedPage",void 0),l(this,"itemsReachedEnd",void 0),l(this,"tabs",void 0),l(this,"isLoading",void 0),this.editor=e.editor,this.sidebar=e.sidebar,this.$container=e.container,this.$header=this.$container.find(".header"),this.$itemsContainer=this.$container.find(".items"),this.$tabsContainer=this.$container.find(".tab-container"),this.$indicator=this.$container.find(".indicator"),this.$errorMessage=this.$container.find(".error-message"),this.$disabledMessage=this.$container.find(".disabled-message"),this.$footer=this.$container.find(".footer"),this.$pasteButton=this.$container.find(".paste-button");var t=this.$container.find(".template");if(this.template=i.default.template(t.html()),this.loadedPage=0,this.itemsReachedEnd=!1,this.$container.get(0)&&!t.get(0))throw new Error("No template found for MyCuration subclass")}var t,n,s,d=e.prototype;return d.bindEvents=function(){var e=this,t=function(t){t===e.type&&(e.resize(),e.requestLoadItems())};this.sidebar.on("resize",t),this.sidebar.on("tabChange",t),this.$itemsContainer.on("click",".item",(function(t){if(!((0,r.default)(t.target).is("a")||(0,r.default)(t.target).parents("a").length>0))return(0,r.default)(t.currentTarget).toggleClass("selected"),e.selectedItemsChanged(),!1})),this.$container.on("dblclick",".item",(function(t){if(!((0,r.default)(t.target).is("a")||(0,r.default)(t.target).parents("a").length>0)){var n=(0,r.default)(t.currentTarget);return e.insertItems([n]),n.removeClass("selected"),e.selectedItemsChanged(),c(e.$pasteButton.attr("data-track-name")),!1}})),this.$pasteButton.on("click",(function(){var t=[];e.selectedItems().each((function(e,n){var i=(0,r.default)(n);t.push(i),i.removeClass("selected")})),e.insertItems(e.pasteReverseOrder?t.reverse():t),e.selectedItemsChanged()})),this.tabs=new a.MyCurationTab({container:this.$tabsContainer,backupKey:this.serviceName}),this.tabs.on("tabChange",(function(){e.removeItems(),e.requestLoadItems()})),this.enableAutoPager&&this.$itemsContainer.on("scroll",i.default.throttle((function(){(e.$itemsContainer.scrollTop()+e.$itemsContainer.height())/e.$itemsContainer[0].scrollHeight>.7&&!e.itemsReachedEnd&&e.requestLoadItems(!0)}),100))},d.resize=function(){var e=(0,r.default)(window).height(),t=(parseInt(this.$itemsContainer.css("padding-top"),10)||0)+(parseInt(this.$itemsContainer.css("padding-bottom"),10)||0);this.$itemsContainer.height(e-this.$container.offset().top-this.$header.outerHeight(!0)-this.$footer.outerHeight(!0)-t)},d.selectedItemsChanged=function(){this.selectedItems().length>0?this.$pasteButton.removeClass("disabled").addClass("enabled").prop("disabled",!1):this.$pasteButton.removeClass("enabled").addClass("disabled").prop("disabled",!0)},d.selectedItems=function(){return this.$itemsContainer.find(".selected")},d.requestLoadItems=function(e){void 0===e&&(e=!1),this.isLoading||this.$container.is(":visible")&&(!e&&this.getItemsOnPage().length>0||this._requestLoadItems(e))},d.willRequestLoadItems=function(e){return!0},d._requestLoadItems=function(e){var t=this;void 0===e&&(e=!1),this.willRequestLoadItems(e)&&(this.isLoading=!0,this.$indicator.show(),this.$errorMessage.hide(),this.loadItems(e).done((function(e){t.showItems(e.entries)})).fail((function(e){t.$errorMessage.show()})).always((function(){t.$indicator.hide(),t.isLoading=!1,t.loadItemsFinishedHandler()})))},d.loadItemsFinishedHandler=function(){},d.requestReload=function(e){this.isLoading||(this.removeItems(),this._requestLoadItems())},d.getItemsOnPage=function(){return this.$itemsContainer.find(".item")},d.removeItems=function(){this.getItemsOnPage().remove()},d.showItems=function(e){var t=this,n=e.map((function(e){return t.renderItem(e)})).join("");this.$indicator.before(n),o.default.updateTimestamps(this.$container[0]),(0,r.default)(this).triggerHandler("items-appended")},d.renderItem=function(e){return this.template({item:e})},d.insertItems=function(e){var t=e.map((function(e){return"["+e.attr("data-permalink")+":embed]"}));this.editor.insertLines(t)},t=e,(n=[{key:"type",get:function(){return null}},{key:"enableAutoPager",get:function(){return!1}},{key:"pasteReverseOrder",get:function(){return!1}}])&&u(t.prototype,n),s&&u(t,s),e}();t.MyCuration=d},34327:function(e,t,n){t.__esModule=!0,t.MyCurationTab=void 0,n(41539),n(66992),n(33948),n(21249),n(69826);var r=o(n(73609)),i=o(n(13469));function o(e){return e&&e.__esModule?e:{default:e}}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=function(e){var t,n;function o(t){var n;u(a(n=e.call(this)||this),"$container",void 0),u(a(n),"backupKey",void 0),u(a(n),"localStorageKey",void 0),u(a(n),"value",void 0),u(a(n),"values",void 0),n.$container=t.container,n.backupKey=t.backupKey,n.localStorageKey="MyCuration.Tab."+n.backupKey,n.values=n.$container.find("input").toArray().map((function(e){return(0,r.default)(e).val()})),n.$container.on("change","input",(function(e){var t=(0,r.default)(e.currentTarget);n.$container.find("label.selected").removeClass("selected"),t.closest("label").addClass("selected");var i=t.val();n.value=i;try{localStorage[n.localStorageKey]=i}catch(e){}n.emit("tabChange")}));try{localStorage[n.localStorageKey]&&n.set(localStorage[n.localStorageKey])}catch(e){}return n}n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,s(t,n);var l=o.prototype;return l.get=function(){return this.value||this.values[0]},l.set=function(e){i.default.include(this.values,e)&&this.$container.find('input[value="'+e+'"]').click()},o}(n(17187).EventEmitter);t.MyCurationTab=l},84540:function(e,t,n){n(69826),n(73210),n(15306),n(74916),n(24603),n(39714),n(47042);var r=n(70879),i=n(92477),o=n(10714),a=n(73609),s=n(13469),u=n(41960),l=n(81191).trackEvent,c=function(){this.init.apply(this,arguments)};c.prototype={init:function(e){this.type="editor-nicovideo",this.editor=e.editor,this.$container=e.container,this.$itemsContainer=this.$container.find(".items"),this.$input=this.$container.find(".nicovideo-keyword"),this.$inputReset=this.$container.find(".input-text-reset"),this.$pasteButton=this.$container.find(".paste-button"),this.$formatPlayer=this.$container.find(".nicovideo-formats label.player"),this.$formatThumbnail=this.$container.find(".nicovideo-formats label.thumbnail"),this.setupFormatSwitcher(".nicovideo-formats"),this.bindEvents()},bindEvents:function(){var e=this;e.$input.keyup(s.debounce((function(){0!==e.$input.val().length&&e.updateThumb()}),500)),e.$input.keydown((function(t){if("RET"===u(t))return e.findItem().length>0&&(e.insertItem(),l(e.$pasteButton.attr("data-track-name"))),!1})),e.$pasteButton.click((function(){e.insertItem()})),e.setupInputReset()},setupInputReset:function(){var e=this;e.$inputReset.click((function(){return e.$input.val(""),e.$input.focus(),e.$inputReset.hide(),!1})),e.$input.keyup((function(t){e.$input.val().length>0?e.$inputReset.show():e.$inputReset.hide()}))},findItem:function(){return this.$container.find(".items > .item")},itemChanged:function(){var e=this,t=e.findItem();if(0!==t.length){e.setPasteButtonStatus(!0);var n=e.$formatPlayer,r=e.$formatThumbnail;"video"===t.data("type")?(n.addClass("format-left"),r.removeClass("format-left"),n.show()):(n.removeClass("format-left"),r.addClass("format-left"),n.is(".selected")&&(n.removeClass("selected"),n.find("input").prop("checked",!1),r.addClass("selected"),r.find("input").prop("checked",!0)),n.hide())}else e.setPasteButtonStatus(!1)},setPasteButtonStatus:function(e){e?this.$pasteButton.removeClass("disabled").addClass("enabled").prop("disabled",!1):this.$pasteButton.addClass("disabled").removeClass("enabled").prop("disabled",!0)},updateThumb:function(){var e=this,t=e.$input.val(),n=e.removeParamsFromURL(t),r=e.detectInfo(n);if(r){var i=e.renderPreviewTemplate(r.type,{id:r.id}),o=a(a.trim(i));o.data("type",r.type),o.data("id",r.id),e.$itemsContainer.html(o),e.itemChanged()}},removeParamsFromURL:function(e){return e.replace(/\?.*$/,"")},detectInfo:function(e){var t=this;return t.isNicovideoID(e)?t.detectInfoFromID(e):t.detectInfoFromURL(e)},detectInfoFromID:function(e){return{id:e,type:this.detectIDType(e)}},detectInfoFromURL:function(e){var t={video:new RegExp("nicovideo.jp/watch/(\\w{0,2}\\d+)$"),community:new RegExp("com.nicovideo.jp/community/(co\\d+)$")},n=!1;return s.find(t,(function(t,r){var i=t.exec(e);return!!i&&(n={id:i[1],type:r},!0)})),n},isNicovideoID:function(e){return/^(\w{2})?\d+$/.test(e)},detectIDType:function(e){return"co"===e.slice(0,2)?"community":"video"},renderPreviewTemplate:function(e,t){var n=this.$container.find(".template-nicovideo-preview-"+e).html();return s.template(n)(t)},renderTemplate:function(e,t,n){var r=this.$container.find(".template-nicovideo-"+e+"-"+t),i=a.trim(r.html());return s.template(i)(n)},insertItem:function(){var e=this,t=[],n=e.$container.find('[name="nicovideo-format"]:checked').val(),a=e.findItem(),s=e.renderTemplate(a.data("type"),n,{id:a.data("id")});t.push(s);var u={html:t,hatena:t,markdown:t};"html"===e.editor.mode&&"link"===n?(0,i.extractSyntax)(t).done((function(e){u.html=[e.html],o.EditorConnector.insertLines(u)})).fail((function(e){(0,r.BUG)(e),o.EditorConnector.insertLines(u)})):o.EditorConnector.insertLines(u)},setupFormatSwitcher:function(e){var t=this.$container.find(e);t.on("change",(function(e){var n=a(e.target);t.find("label.selected").removeClass("selected"),n.closest("label").addClass("selected")}))}},e.exports=c},27934:function(e,t,n){t.__esModule=!0,t.Paint=void 0,n(92222);var r,i=(r=n(64722))&&r.__esModule?r:{default:r},o=n(97927);function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u=function(e){var t,n,r,i,u;function l(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return"editor-paint"===(t=e.call.apply(e,[this].concat(r))||this).type&&t.on("success",(function(e){t.editor.insert("html"===t.syntax?e.html:e.syntax)})),t}return n=e,(t=l).prototype=Object.create(n.prototype),t.prototype.constructor=t,s(t,n),l.prototype.createUploadForm=function(){return new o.PaintUploadForm(this)},r=l,(i=[{key:"selectors",get:function(){return{items:"#paint-items",pasteButton:"#paint-button-paste",footerButtons:"#paint-footer-buttons",uploadForm:"#paint-uploader",uploadFormWrapper:"#paint-uploader-wrapper"}}},{key:"type",get:function(){return"editor-paint"}},{key:"defaultFolder",get:function(){return"Hatena Blog Illust"}}])&&a(r.prototype,i),u&&a(r,u),l}(i.default);t.Paint=u},97927:function(e,t,n){n(88674),n(41539),t.__esModule=!0,t.PaintUploadForm=void 0,n(35666);var r,i=(r=n(67294))&&r.__esModule?r:{default:r},o=n(73380),a=n(86340),s=n(21650);function u(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){u(o,r,i,a,s,"next",e)}function s(e){u(o,r,i,a,s,"throw",e)}a(void 0)}))}}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=function(){function e(e){c(this,"parent",void 0),c(this,"_fotoSize",s.Uploader.DEFAULT_SIZE),this.parent=e,this.initEvents()}var t=e.prototype;return t.upload=function(){var e=l(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new s.Uploader,this.parent.emit("upload",n),e.next=4,n.uploadPaint(t.base64String,t.ext);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.fotoSize=function(){return this._fotoSize},t.initEvents=function(){var e=this,t=document.getElementById("js-canvas-open-button");t&&(0,o.safeRender)(i.default.createElement(a.PaintApp,{uploader:function(){var t=l(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.upload(n);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}),t)},e}();t.PaintUploadForm=d},41268:function(e,t,n){var r;t.__esModule=!0,t.setCanvasSize=t.requestChangeCanvasSize=t.setColor=t.setPenSize=t.setMode=t.togglePaintWindow=t.toggleColorPicker=t.uploaded=t.upload=t.exportData=t.hide=t.clearHistory=t.clear=t.redo=t.undo=void 0;var i=(0,((r=n(99308))&&r.__esModule?r:{default:r}).default)(),o=i("UNDO");t.undo=o;var a=i("REDO");t.redo=a;var s=i("CLEAR");t.clear=s;var u=i("CLEAR_HISTORY");t.clearHistory=u;var l=i("HIDE");t.hide=l;var c=i("EXPORT_DATA");t.exportData=c;var d=i("UPLOAD");t.upload=d;var f=i("UPLOADED");t.uploaded=f;var p=i("TOGGLE_COLOR_PICKER");t.toggleColorPicker=p;var h=i("TOGGLE_PAINT_WINDOW");t.togglePaintWindow=h;var m=i("SET_MODE");t.setMode=m;var v=i("SET_PEN_SIZE");t.setPenSize=v;var g=i("SET_COLOR");t.setColor=g;var b=i("REQUEST_CHANGE_CANVAS_SIZE");t.requestChangeCanvasSize=b;var y=i("SET_CANVAS_SIZE");t.setCanvasSize=y},4995:function(e,t,n){t.__esModule=!0,t.noopController=t.INITIAL_STATE=t.backgroundColor=t.defaultColor=t.defaultPenSize=t.defaultCanvasSize=t.defaultMode=t.CanvasSizes=void 0;var r,i=n(55854),o=((r={})[i.CanvasSizeEnum.Small]={width:360,height:240},r[i.CanvasSizeEnum.Medium]={width:540,height:360},r[i.CanvasSizeEnum.Large]={width:720,height:480},r);t.CanvasSizes=o;var a=i.PaintingMode.Pen;t.defaultMode=a;var s=i.CanvasSizeEnum.Small;t.defaultCanvasSize=s;t.defaultPenSize=2;var u="#000";t.defaultColor=u;t.backgroundColor="#fff";var l={paintingMode:a,penSize:2,canvasSize:s,penColor:u,isColorPickerHide:!0,isWindowHide:!0,isUploading:!1};t.INITIAL_STATE=l;var c=function(){},d={redo:c,undo:c,clear:c,clearHistory:c,exportData:c};t.noopController=d},21022:function(e,t,n){t.__esModule=!0,t.CanvasOpenButton=void 0;var r=s(n(67294)),i=n(20672),o=s(n(20996)),a=n(41268);function s(e){return e&&e.__esModule?e:{default:e}}t.CanvasOpenButton=function(e){var t=e.clickHandler,n=(0,i.useDispatch)();return r.default.createElement("button",{className:"canvas-open-button submit",onClick:function(){t(),n((0,a.togglePaintWindow)())},style:{border:"none",appearance:"none",width:"100%"},type:"button"},r.default.createElement("i",{className:"blogicon-plus"}),o.default.text("admin.paint"))}},89739:function(e,t,n){n(4129),n(38880),t.__esModule=!0,t.LazyPaintModalLoader=void 0,n(88674),n(41539),n(78783),n(66992),n(33948);var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=u(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),o=n(90381),a=(r=n(20996))&&r.__esModule?r:{default:r},s=n(54040);function u(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(u=function(e){return e?n:t})(e)}var l=(0,i.lazy)((function(){return n.e(277).then(n.bind(n,57905)).then((function(e){return{default:e.PaintAppContainer}}))}));t.LazyPaintModalLoader=function(){return i.default.createElement(i.Suspense,{fallback:i.default.createElement(o.LoadingIndicator,{text:a.default.text("loading")})},i.default.createElement(s.PaintWindowPortal,{targetID:"paint-window-container"},i.default.createElement(l,null)))}},86340:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.PaintApp=void 0;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),i=n(58322),o=n(21022),a=n(89739);function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}t.PaintApp=function(e){var t=e.uploader,n=(0,r.useState)(!1),s=n[0],u=n[1];return r.default.createElement(i.PaintAppContextProvider,{uploader:t},r.default.createElement(o.CanvasOpenButton,{clickHandler:function(){u(!0)}}),s&&r.default.createElement(a.LazyPaintModalLoader,null))}},54040:function(e,t,n){t.__esModule=!0,t.PaintWindowPortal=void 0;var r,i=n(73935),o=(r=n(67294))&&r.__esModule?r:{default:r},a=n(20672);t.PaintWindowPortal=function(e){var t=e.children,n=e.targetID,r=document.getElementById(n),s=(0,a.useSelector)((function(e){return e.isWindowHide}));return o.default.createElement("div",null,r&&(0,i.createPortal)(o.default.createElement("div",{style:{display:s?"none":"block"}},t),r))}},6731:function(e,t,n){t.__esModule=!0,t.CanvasControllerContext=void 0;var r=n(67294),i=n(4995),o=(0,r.createContext)({setController:function(){},getController:function(){return i.noopController}});t.CanvasControllerContext=o},20672:function(e,t,n){t.__esModule=!0,t.useSelector=t.useDispatch=t.PaintReduxContext=t.paintAppStore=void 0;var r=n(14890),i=n(92951),o=n(67294),a=n(74308),s=n(4995),u=(0,r.createStore)(i.reducer);t.paintAppStore=u;var l=(0,o.createContext)({store:u,storeState:s.INITIAL_STATE});t.PaintReduxContext=l;var c=(0,a.createDispatchHook)(l);t.useDispatch=c;var d=(0,a.createSelectorHook)(l);t.useSelector=d},58322:function(e,t,n){t.__esModule=!0,t.PaintAppContextProvider=void 0;var r,i=(r=n(67294))&&r.__esModule?r:{default:r},o=n(6731),a=n(20672),s=n(61081);t.PaintAppContextProvider=function(e){var t=e.children,n=e.uploader,r=(0,s.usePaintAppContext)(n),u=r.paintReduxContextValue,l=r.canvasControllersContextValue;return i.default.createElement(a.PaintReduxContext.Provider,{value:u},i.default.createElement(o.CanvasControllerContext.Provider,{value:l},t))}},33477:function(e,t,n){t.__esModule=!0,t.useControllersContextValue=void 0;var r=n(67294),i=n(4995);t.useControllersContextValue=function(){var e=(0,r.useRef)(i.noopController);return{setController:(0,r.useCallback)((function(t){e.current=t}),[]),getController:(0,r.useCallback)((function(){return e.current}),[])}}},61081:function(e,t,n){t.__esModule=!0,t.usePaintAppContext=void 0;var r=n(14890),i=n(67294),o=n(92951),a=n(4995),s=n(43452),u=n(33477),l=n(65400);t.usePaintAppContext=function(e){var t=(0,u.useControllersContextValue)();return{paintReduxContextValue:(0,i.useState)((function(){return{store:(0,r.createStore)(o.reducer,(0,l.composeEnhancers)((0,r.applyMiddleware)((0,s.paintAppMiddleware)(t.getController,e)))),storeState:a.INITIAL_STATE}}))[0],canvasControllersContextValue:t}}},89172:function(e,t,n){t.__esModule=!0,t.Paint=void 0;var r=n(27934);t.Paint=r.Paint},43452:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.paintAppMiddleware=void 0;var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=u(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(41268)),o=n(42031),a=(r=n(20996))&&r.__esModule?r:{default:r},s=n(4995);function u(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(u=function(e){return e?n:t})(e)}t.paintAppMiddleware=function(e,t){return(0,o.middleware)().case(i.redo,(function(t,n,r){e().redo(),n(r)})).case(i.undo,(function(t,n,r){e().undo(),n(r)})).case(i.clear,(function(t,n,r){e().clear(),n(r)})).case(i.clearHistory,(function(t,n,r){e().clearHistory(),n(r)})).case(i.exportData,(function(t,n,r){e().exportData(),n(r)})).case(i.upload,(function(e,n,r){e.getState().isUploading||(t(r.payload).then((function(){e.dispatch(i.clear()),e.dispatch(i.clearHistory()),e.dispatch(i.hide()),e.dispatch(i.uploaded())})),n(r))})).case(i.requestChangeCanvasSize,(function(e,t,n){s.CanvasSizes[e.getState().canvasSize].width<s.CanvasSizes[n.payload.size].width||confirm(a.default.text("admin.paint.resize_canvas.confirm"))?t(i.setCanvasSize(n.payload)):t(n)}))}},92951:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.reducer=void 0,n(19601);var r=n(76983),i=n(4995),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(41268));function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}var s=(0,r.reducerWithInitialState)(i.INITIAL_STATE).case(o.toggleColorPicker,(function(e){return Object.assign({},e,{isColorPickerHide:!e.isColorPickerHide})})).case(o.togglePaintWindow,(function(e){return Object.assign({},e,{isWindowHide:!e.isWindowHide})})).case(o.hide,(function(e){return Object.assign({},e,{isWindowHide:!0})})).case(o.setMode,(function(e,t){return Object.assign({},e,{paintingMode:t.mode})})).case(o.setPenSize,(function(e,t){return Object.assign({},e,{penSize:t.size})})).case(o.setColor,(function(e,t){return Object.assign({},e,{penColor:t.color})})).case(o.setCanvasSize,(function(e,t){return Object.assign({},e,{canvasSize:t.size})})).case(o.upload,(function(e){return Object.assign({},e,{isUploading:!0})})).case(o.uploaded,(function(e){return Object.assign({},e,{isUploading:!1})})).build();t.reducer=s},55854:function(e,t){var n,r;t.__esModule=!0,t.CanvasSizeEnum=t.PaintingMode=void 0,t.PaintingMode=n,function(e){e.Pen="PEN",e.TransparentPen="TRANSPARENT_PEN",e.Eraser="ERASER",e.Filler="FILLER",e.Eyedropper="EYEDROPPER"}(n||(t.PaintingMode=n={})),t.CanvasSizeEnum=r,function(e){e.Small="small",e.Medium="medium",e.Large="large"}(r||(t.CanvasSizeEnum=r={}))},7902:function(e,t,n){t.__esModule=!0,t.Pixiv=void 0,n(69826),n(41539),n(66992),n(33948),n(54747);var r,i=n(10714),o=n(70879),a=n(57753),s=(r=n(73609))&&r.__esModule?r:{default:r},u=n(92477),l=n(96486);function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h=function(e){var t,n;function r(t){var n;p(d(n=e.call(this,t)||this),"page",void 0),p(d(n),"editorTemplate",void 0),p(d(n),"$container",void 0),n.page=1,n.$container=t.container;var r=n.$container.find(".editor-template");return n.editorTemplate=(0,l.template)(r.html()),n.bindEvents(),n}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,f(t,n);var a,h,m,v=r.prototype;return v.loadItems=function(){var e=this;return s.default.ajax({url:"/api/pixiv/my_works",data:{page:this.page}}).done((function(t){e.itemsReachedEnd=!(t.entries&&t.entries.length>0),e.page++})).fail((function(){e.pleaseReAuthorize(),e.itemsReachedEnd=!0}))},v.pleaseReAuthorize=function(){this.$container.find(".disabled-box").show()},v.insertItems=function(e){var t=this,n=[];e.forEach((function(e){var r=e.attr("data-permalink");n.push(t.editorTemplate({item:{id:e.attr("data-id"),image_url:e.attr("data-image-url")}})),n.push("["+r+":title]")}));var r=n;(0,u.extractSyntax)(n).done((function(e){e&&(r=[e.html])})).fail((function(e){(0,o.BUG)(e)})).always((function(){i.EditorConnector.insertLines({hatena:n,markdown:n,html:r})}))},a=r,(h=[{key:"type",get:function(){return"editor-pixiv"}},{key:"serviceName",get:function(){return"Pixiv"}},{key:"enableAutoPager",get:function(){return!0}}])&&c(a.prototype,h),m&&c(a,m),r}(a.MyCuration);t.Pixiv=h},71142:function(e,t){t.__esModule=!0,t.setFilterQuery=t.unselectProfileCardAt=t.selectProfileCard=t.setSelectedProfileCards=t.receiveProfileCards=t.requestProfileCards=void 0;t.requestProfileCards=function(){return{type:"REQUEST_PROFILE_CARDS"}};t.receiveProfileCards=function(e){return{type:"RECEIVE_PROFILE_CARDS",profileCards:e}};t.setSelectedProfileCards=function(e){return{type:"SET_SELECTED_PROFILE_CARDS",uuids:e}};t.selectProfileCard=function(e){return{type:"SELECT_PROFILE_CARD",uuid:e}};t.unselectProfileCardAt=function(e){return{type:"UNSELECT_PROFILE_CARD_AT",index:e}};t.setFilterQuery=function(e){return{type:"SET_FILTER_QUERY",query:e}}},89011:function(e,t,n){t.__esModule=!0,t.AllProfileCardsList=void 0,n(21249);var r=u(n(67294)),i=u(n(20996)),o=n(98274),a=n(41514),s=n(81832);function u(e){return e&&e.__esModule?e:{default:e}}t.AllProfileCardsList=function(e){var t=e.profileCards,n=e.onItemClick,u=e.onFilterQueryChange;return r.default.createElement("div",{className:"all-profile-cards-container"},r.default.createElement("h3",null,i.default.text("edit_form.profile_card.all_profile_cards")),r.default.createElement(o.FilterQueryForm,{onFilterQueryChange:u}),r.default.createElement("div",{className:"all-profile-cards"},t instanceof Array?r.default.createElement("ul",{className:"all-profile-cards-list"},t.map((function(e,t){return r.default.createElement(a.ProfileCardCell,{key:"cell-"+t+"-"+e.uuid,profileCard:e,onItemClick:function(){return n(e.uuid)}})}))):r.default.createElement(s.ProfileCardsEmptyReasonExplanation,{reason:t})))}},64793:function(e,t,n){t.__esModule=!0,t.Body=void 0;var r,i=(r=n(67294))&&r.__esModule?r:{default:r},o=n(96938),a=n(82748);t.Body=function(){return i.default.createElement("div",{className:"editor-sidebar-profile_card__body"},i.default.createElement(a.SelectedProfileCardsListContainer,null),i.default.createElement(o.AllProfileCardsListContainer,null))}},98274:function(e,t,n){t.__esModule=!0,t.FilterQueryForm=void 0;var r=a(n(67294)),i=a(n(20996)),o=a(n(70881));function a(e){return e&&e.__esModule?e:{default:e}}t.FilterQueryForm=function(e){var t=e.onFilterQueryChange;return r.default.createElement(o.default,{placeholder:i.default.text("edit_form.profile_card.filter_placeholder"),onSubmit:function(e){return t(e)}})}},94766:function(e,t,n){t.__esModule=!0,t.Header=void 0;var r=o(n(67294)),i=o(n(20996));function o(e){return e&&e.__esModule?e:{default:e}}var a=n(91269);t.Header=function(){var e=a.get("editor.canManageProfileCards");return r.default.createElement("div",{className:"editor-sidebar-profile_card__header"},r.default.createElement("h2",null,i.default.text("edit_form.profile_card")),r.default.createElement("p",null,i.default.text("edit_form.profile_card.description")),e?r.default.createElement("div",{className:"profile-cards-edit-link test-profile-cards-edit-link"},r.default.createElement("a",{href:"./profile_cards",target:"_blank",rel:"noopener"},i.default.text("edit_form.profile_card.config_link"))):r.default.createElement("p",{className:"profile-cards-edit-permission-required test-profile-cards-edit-permission-required"},i.default.text("edit_form.profile_card.edit_permission_required")))}},41514:function(e,t,n){t.__esModule=!0,t.ProfileCardCell=void 0;var r=o(n(67294)),i=o(n(20996));function o(e){return e&&e.__esModule?e:{default:e}}t.ProfileCardCell=function(e){var t=e.profileCard,n=e.onItemClick;return r.default.createElement("li",{className:"profile-card-list-item",onClick:n},r.default.createElement("h4",null,t.title),r.default.createElement("p",null,t.body_preview),t.author&&r.default.createElement("p",null,i.default.text("admin.profile_cards.author")," ",t.author))}},81832:function(e,t,n){t.__esModule=!0,t.ProfileCardsEmptyReasonExplanation=void 0;var r=o(n(67294)),i=o(n(20996));function o(e){return e&&e.__esModule?e:{default:e}}t.ProfileCardsEmptyReasonExplanation=function(e){var t=e.reason;return"initial_fetch_not_finished"===t.emptyReason?r.default.createElement("p",{className:"all-profile-cards-list-no-profileCards"},i.default.text("loading")):"no_matched_profile_cards"===t.emptyReason?r.default.createElement("p",{className:"all-profile-cards-list-no-profileCards"},i.default.text("edit_form.profile_card.no_matched_profile_cards")):r.default.createElement("p",{className:"all-profile-cards-list-no-profileCards"},i.default.text("edit_form.profile_card.no_profile_cards"),r.default.createElement("a",{href:"./profile_cards",target:"_blank",rel:"noopener noreferrer"},i.default.text("edit_form.profile_card.config_link")))}},12934:function(e,t,n){t.__esModule=!0,t.SelectedProfileCardCell=void 0;var r,i=(r=n(67294))&&r.__esModule?r:{default:r};t.SelectedProfileCardCell=function(e){var t=e.profileCard,n=e.onItemUnselect;return i.default.createElement("li",{className:"selected-profile-cards-items"},i.default.createElement("h4",{className:"selected-profile-cards-items-title"},t.title),i.default.createElement("input",{type:"hidden",name:"profile_card",value:t.uuid}),i.default.createElement("button",{type:"button",onClick:n,className:"selected-profile-cards-items-button"},i.default.createElement("i",{className:"blogicon-close"})))}},85013:function(e,t,n){t.__esModule=!0,t.SelectedProfileCardsList=void 0,n(21249);var r=a(n(67294)),i=a(n(20996)),o=n(12934);function a(e){return e&&e.__esModule?e:{default:e}}t.SelectedProfileCardsList=function(e){var t=e.selectedProfileCards,n=e.onItemUnselect;return r.default.createElement("div",{className:"selected-profile-cards-container"},r.default.createElement("h3",null,i.default.text("edit_form.profile_card.selected")," (",t.length,")"),r.default.createElement("div",{className:"selected-profile-cards"},r.default.createElement("input",{type:"hidden",name:"should_update_profile_cards",value:"1"}),t.length>0?r.default.createElement("ul",{className:"selected-profile-cards-list"},t.map((function(e,t){return r.default.createElement(o.SelectedProfileCardCell,{key:"selected-list-"+t+"-"+e.uuid,profileCard:e,onItemUnselect:function(){return n(t)}})}))):r.default.createElement("div",null,r.default.createElement("div",{className:"selected-profile-cards-selectarea"},i.default.text("edit_form.profile_card.no_selected_cards")))))}},96938:function(e,t,n){t.__esModule=!0,t.AllProfileCardsListContainer=void 0,n(26699),n(32023),n(21249),n(47941),n(57327);var r,i=(r=n(67294))&&r.__esModule?r:{default:r},o=n(74308),a=n(89011),s=n(71142);var u=function(e){if(!e.isInitialFetchFinished)return{profileCards:{emptyReason:"initial_fetch_not_finished"}};var t=Object.keys(e.profileCards).map((function(t){return e.profileCards[t]}));if(0===t.length)return{profileCards:{emptyReason:"no_profile_cards"}};if(""===e.filterQuery)return{profileCards:t};var n=t.filter((function(t){return function(e,t){return t.title.includes(e)||t.body.includes(e)}(e.filterQuery,t)}));return 0===n.length?{profileCards:{emptyReason:"no_matched_profile_cards"}}:{profileCards:n}};t.AllProfileCardsListContainer=function(){var e=(0,o.useDispatch)(),t=(0,o.useSelector)(u).profileCards;return i.default.createElement(a.AllProfileCardsList,{profileCards:t,onFilterQueryChange:function(t){e((0,s.setFilterQuery)(t))},onItemClick:function(t){e((0,s.selectProfileCard)(t))}})}},67436:function(e,t,n){t.__esModule=!0,t.default=void 0;var r,i=(r=n(67294))&&r.__esModule?r:{default:r},o=n(64793),a=n(94766),s=n(67756);var u=function(){return(0,s.useApp)(),i.default.createElement("div",{className:"editor-sidebar-profile_card"},i.default.createElement(a.Header,null),i.default.createElement(o.Body,null))};t.default=u},82748:function(e,t,n){t.__esModule=!0,t.SelectedProfileCardsListContainer=void 0,n(21249);var r,i=(r=n(67294))&&r.__esModule?r:{default:r},o=n(74308),a=n(85013),s=n(71142);t.SelectedProfileCardsListContainer=function(){var e=(0,o.useSelector)((function(e){return{selectedProfileCards:e.isInitialFetchFinished?e.selectedProfileCardUuids.map((function(t){return e.profileCards[t]})):[]}})).selectedProfileCards,t=(0,o.useDispatch)();return i.default.createElement(a.SelectedProfileCardsList,{selectedProfileCards:e,onItemUnselect:function(e){t((0,s.unselectProfileCardAt)(e))}})}},67756:function(e,t,n){t.__esModule=!0,t.useApp=void 0;var r=n(15849),i=n(34498),o=n(91269);t.useApp=function(){var e=(0,r.useFetchProfileCard)()[0],t=e.loading,n=e.error,a=e.data;(0,i.useAppEffects)({loading:t,error:n,data:a,attachedProfileCardUUIDs:o.get("editor.attachedProfileCards")||[]})}},34498:function(e,t,n){t.__esModule=!0,t.useAppEffects=void 0,n(41539),n(66992),n(33948);var r=n(74308),i=n(67294),o=n(71142);t.useAppEffects=function(e){var t=e.loading,n=e.error,a=e.data,s=e.attachedProfileCardUUIDs,u=(0,r.useDispatch)();(0,i.useEffect)((function(){u((0,o.requestProfileCards)())}),[u]),(0,i.useEffect)((function(){u((0,o.setSelectedProfileCards)(s))}),[u,s]),(0,i.useEffect)((function(){if(!t&&!n){if(!a)throw new TypeError("'data' doesn't exist");u((0,o.receiveProfileCards)(a.entries))}}),[t,n,a,u])}},15849:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.useFetchProfileCard=void 0;var r=n(91289),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=o(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(55992));function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(o=function(e){return e?n:t})(e)}t.useFetchProfileCard=function(){return(0,r.useXHR)({url:i.protocolRelativeAdminUserBlogUrl("/profile_cards.json"),responseType:"json"})}},42585:function(e,t,n){t.__esModule=!0,t.default=void 0;var r=c(n(67294)),i=n(73380),o=n(74308),a=n(14890),s=c(n(67436)),u=c(n(60143)),l=n(65400);function c(e){return e&&e.__esModule?e:{default:e}}var d={init:function(e){var t=(0,a.createStore)(u.default,(0,l.composeEnhancers)());(0,i.safeRender)(r.default.createElement(o.Provider,{store:t},r.default.createElement(s.default,null)),e)}};t.default=d},83255:function(e,t){t.__esModule=!0,t.default=void 0;t.default=function(e,t){switch(void 0===e&&(e=""),t.type){case"SET_FILTER_QUERY":return t.query;default:return e}}},60143:function(e,t,n){t.__esModule=!0,t.default=void 0;var r=n(14890),i=l(n(83255)),o=l(n(71623)),a=l(n(99350)),s=l(n(55162)),u=l(n(92061));function l(e){return e&&e.__esModule?e:{default:e}}var c=(0,r.combineReducers)({filterQuery:i.default,isFetching:o.default,isInitialFetchFinished:a.default,profileCards:s.default,selectedProfileCardUuids:u.default});t.default=c},71623:function(e,t){t.__esModule=!0,t.default=void 0;t.default=function(e,t){switch(void 0===e&&(e=!1),t.type){case"REQUEST_PROFILE_CARDS":return!0;case"RECEIVE_PROFILE_CARDS":return!1;default:return e}}},99350:function(e,t){t.__esModule=!0,t.default=void 0;t.default=function(e,t){switch(void 0===e&&(e=!1),t.type){case"RECEIVE_PROFILE_CARDS":return!0;default:return e}}},55162:function(e,t){t.__esModule=!0,t.default=void 0;t.default=function(e,t){switch(void 0===e&&(e={}),t.type){case"RECEIVE_PROFILE_CARDS":return t.profileCards.reduce((function(e,t){return e[t.uuid]=t,e}),{});default:return e}}},92061:function(e,t,n){t.__esModule=!0,t.default=void 0,n(92222),n(40561);t.default=function(e,t){switch(void 0===e&&(e=[]),t.type){case"SET_SELECTED_PROFILE_CARDS":return t.uuids;case"SELECT_PROFILE_CARD":return[].concat(e,[t.uuid]);case"UNSELECT_PROFILE_CARD_AT":var n=[].concat(e);return n.splice(t.index,1),n;default:return e}}},77667:function(e){e.exports={actions:{SET_EDITOR:"PROMOTION:SET_EDITOR",LOAD_ENTRIES:"ENTRIES:LOAD_ENTRIES_ENTRY",SHUFFLE_ENTRIES:"ENTRIES:SHUFFLE_ENTRIES",SHOW_ENTRY:"ENTRIES:SHOW_ENTRY",CLOSE_ENTRY:"ENTRIES:CLOSE_ENTRY",FILL_KEYWORD:"ENTRIES:FILL_KEYWORD",FILLIN:"ENTRIES:FILLIN",LOAD_ODAIS:"ODAI:LOAD_ODAIS",SELECT_ODAI:"ODAI:SELECT_ODAI",TURN_SLOT:"ODAI:TURN_SLOT",TOGGLE_KILLED:"ODAI:TOGGLE_KILLED",TOGGLE_ACTIVE:"ODAI:TOGGLE_ACTIVE",SHOW_WINDOW:"PROMOTION:SHOW_WINDOW",HIDE_WINDOW:"PROMOTION:HIDE_WINDOW",SET_PAGE:"PROMOTION:SET_PAGE"},pageIds:{ENTRIES_PAGE:"ENTRIES_PAGE",ODAI_SLOT_PAGE:"ODAI_SLOT_PAGE"}}},14674:function(e,t,n){n(21249);var r=n(10714);function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var o=n(73609),a=n(77667).actions,s=n(73287),u=n(81191).trackEvent,l=n(91269),c=n(79065),d=function(e){var t,n;function s(){return e.apply(this,arguments)||this}n=e,(t=s).prototype=Object.create(n.prototype),t.prototype.constructor=t,i(t,n);var d=s.prototype;return d.init=function(){var e=l.get("editor.promotion.entries").map((function(e){return c(e)}));this.emit(a.LOAD_ENTRIES,e)},d.setEditor=function(e){this.emit(a.SET_EDITOR,e)},d.shuffleEntries=function(e){this.emit(a.SHUFFLE_ENTRIES,e)},d.isShownEntry=function(e){return!localStorage["Hatena.Diary.Promotion.Entry.closed."+e]},d.showEntry=function(e){try{localStorage["Hatena.Diary.Promotion.Entry.read."+e]=!0}catch(e){}u("Promotion.Entry.Show."+e),this.emit(a.SHOW_ENTRY,e)},d.closeEntry=function(e){try{localStorage["Hatena.Diary.Promotion.Entry.closed."+e]=!0}catch(e){}this.emit(a.CLOSE_ENTRY,e),o(".tipsy > *").remove(),setTimeout((function(){return r.EditorConnector.emit("resizeRequired")}),0)},d.fillKeyword=function(e){var t=[e];r.EditorConnector.insertLines({html:t,hatena:t,markdown:t})},d.fillin=function(e){o.ajax({url:"/api/fill_ins/"+e,type:"GET"}).then((function(e){r.EditorConnector.insertLines(e)}))},s}(s.Actions);e.exports=new d},26567:function(e,t,n){function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var i=n(77667).actions,o=function(e){var t,n;function o(){return e.apply(this,arguments)||this}n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,r(t,n);var a=o.prototype;return a.setEditor=function(e){this.emit(i.SET_EDITOR,e)},a.showWindow=function(){this.emit(i.SHOW_WINDOW)},a.hideWindow=function(){this.emit(i.HIDE_WINDOW)},a.setPage=function(e){this.emit(i.SET_PAGE,e)},o}(n(73287).Actions);e.exports=new o},40746:function(e,t,n){var r=a(n(20996)),i=a(n(57942)),o=n(10714);function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u=n(73609),l=n(77667).actions,c=n(73287),d=function(e){var t,n;function a(){return e.apply(this,arguments)||this}n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,s(t,n);var c=a.prototype;return c.init=function(){this.emit(l.TOGGLE_KILLED,function(){try{return!!localStorage["Hatena.Diary.Promotion.OdaiSlot.isKilled"]||!1}catch(e){}return!1}()),this.emit(l.TOGGLE_ACTIVE,function(){try{if("false"===localStorage["Hatena.Diary.Promotion.OdaiSlot.isActive"])return!1}catch(e){}return!0}())},c.setEditor=function(e){this.emit(l.SET_EDITOR,e)},c.loadOdais=function(){var e=this;u.get("/api/odais?type=official").then((function(t){e.emit(l.LOAD_ODAIS,t.odais)})).fail((function(e){throw e}))},c.selectOdai=function(e){var t=r.default.text("admin.odai.fillin",e.title),n=["[http:"+(0,i.default)("admin-domain")+"/-/odai/"+e.uuid+":title="+t+"]"];o.EditorConnector.insertLines({html:n,hatena:n,markdown:n})},c.turnSlot=function(){this.emit(l.TURN_SLOT)},c.killOdaiSlot=function(){u(".tipsy > *").remove();try{localStorage["Hatena.Diary.Promotion.OdaiSlot.isKilled"]=!0}catch(e){}this.emit(l.TOGGLE_KILLED,!0)},c.setInactive=function(){try{localStorage["Hatena.Diary.Promotion.OdaiSlot.isActive"]=!1}catch(e){}this.emit(l.TOGGLE_ACTIVE,!1)},a}(c.Actions);e.exports=new d},45326:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.EntriesPage=void 0,n(21249);var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=o(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(67294)),i=n(24846);function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(o=function(e){return e?n:t})(e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var s=n(14674),u=function(e){var t,n;function o(){return e.apply(this,arguments)||this}n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,a(t,n);var u=o.prototype;return u.render=function(){return r.createElement("div",{className:"promotion-entries "+this.props.device},r.createElement("div",{className:"promotion-entries-wrapper "+this.props.device},this.renderEntries()),r.createElement("div",{className:"promotion-entries-pagers center "+this.props.device},r.createElement("div",{className:"btn-group"},this.renderPagers())))},u.renderEntries=function(){var e=this;return this.props.entryIds.map((function(t){return r.createElement(i.PromotionContent,{entry:e.props.entities[t],key:t,device:e.props.device,isSelected:e.isEntrySelected(t)})}))},u.renderPagers=function(){var e=this,t=this.props,n=t.entities,i=t.entryIds;if(!(i.length<2))return i.map((function(t,i){var o=n[t],a="promotion-entries-pager btn";return a+=e.isEntrySelected(t)?" selected":"",r.createElement("span",{className:a,"data-target-promotion-index":i,tabIndex:0,key:o.id,onClick:function(){return e.showEntry(o.id)}},i+1)}))},u.isEntrySelected=function(e){return!(!this.props.currentEntryId||e!==this.props.currentEntryId)},u.showEntry=function(e){s.showEntry(e)},o}(r.Component);t.EntriesPage=u},27180:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.EntryButton=void 0;var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),o=(r=n(20996))&&r.__esModule?r:{default:r};function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u=n(26567),l=n(14674),c=n(77667).pageIds,d=function(e){var t,n;function r(){return e.apply(this,arguments)||this}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,s(t,n);var a=r.prototype;return a.showEntry=function(){l.showEntry(this.props.entry.id),u.setPage(c.ENTRIES_PAGE),u.showWindow()},a.closeEntry=function(e){l.closeEntry(this.props.entry.id),e.stopPropagation()},a.render=function(){var e=this;if(this.props.entry.isClosed)return i.createElement("span",null);var t="promotion-button";return this.props.entry.isRead||(t+=" is-active"),i.createElement("span",{tabIndex:-1,className:t,"data-track-name":"editor-toolbar-button-promotion-"+this.props.trackingId,onClick:function(){return e.showEntry()}},i.createElement("span",{className:"promotion-label"},"<NEW>"),i.createElement("span",{className:"promotion-entry-title"},this.props.entry.title),i.createElement("i",{className:"blogicon-close promotion-cancel-button tipsy-top",title:o.default.text("close"),onClick:function(t){return e.closeEntry(t)}}))},r}(i.Component);t.EntryButton=d},86763:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.OdaiSlotButton=void 0;var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),o=(r=n(20996))&&r.__esModule?r:{default:r};function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u=n(26567),l=n(40746),c=n(77667).pageIds,d=function(e){var t,n;function r(){return e.apply(this,arguments)||this}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,s(t,n);var a=r.prototype;return a.showOdaiSlot=function(){u.setPage(c.ODAI_SLOT_PAGE),u.showWindow(),l.turnSlot(),l.setInactive()},a.killOdaiSlot=function(e){l.killOdaiSlot(),e.stopPropagation()},a.render=function(){var e=this;if(this.props.isKilled)return i.createElement("span",null);var t="odaislot-button";return this.props.isActive&&(t+=" is-active"),i.createElement("span",{tabIndex:-1,className:t,"data-track-name":"editor-toolbar-button-odaislot",onClick:function(){return e.showOdaiSlot()}},i.createElement("span",{className:"odaislot-label"},"<NEW>"),i.createElement("span",{className:"odaislot-title"},o.default.text("admin.odai.odai_slot")),i.createElement("i",{className:"blogicon-close odaislot-cancel-button tipsy-top",title:o.default.text("close"),onClick:function(t){return e.killOdaiSlot(t)}}))},r}(i.Component);t.OdaiSlotButton=d},62142:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.OdaiSlotPage=void 0,n(47042),n(21249);var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),o=(r=n(20996))&&r.__esModule?r:{default:r};function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u=n(54102),l=n(40746),c=n(26567),d=function(){if(!document.body)return"";var e=document.createElement("div");return e.style.top="-9999px",e.style.zIndex="-9999",document.addEventListener("DOMContentLoaded",(function(){document.body.appendChild(e)})),function(t,n,r){e.className=t,e.innerHTML="a";var i=e.offsetHeight*r;e.innerHTML=n;for(var o=0;e.offsetHeight>i;)o++,e.innerHTML=n.slice(0,-o)+"…";return 0===o?n:n.slice(0,-o)+"…"}}(),f=function(e){var t,n;function r(t){return e.call(this,t)||this}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,s(t,n);var a=r.prototype;return a.turnSlot=function(){l.turnSlot()},a.selectOdai=function(){var e=this.props.entities[this.props.randomOdaiId];e&&(l.selectOdai(e),c.hideWindow())},a.renderOdaiSlot=function(){var e=this,t=this.props.entities[this.props.randomOdaiId];if(t){var n=o.default.text("admin.odai.slot_description_head"),r=o.default.text("admin.odai.slot_description_foot"),a=[o.default.text("admin.odai.slot_description_1"),o.default.text("admin.odai.slot_description_2")],s=this.props.device,l=""===d?"":d("promotion-odaislot-randomodai-title-inner "+s,t.title,2);return i.createElement("div",null,i.createElement("div",{className:"promotion-odaislot-header"},i.createElement("span",null,i.createElement("i",{className:"blogicon-odaislot lg"}),o.default.text("admin.odai.odai_slot"))),i.createElement("div",{className:"promotion-odaislot-tagline "+s},i.createElement(u,{body:n})),i.createElement("div",{className:"promotion-odaislot-description "+s},i.createElement("ul",null,a.map((function(e,t){return i.createElement("li",{key:t},i.createElement(u,{body:e}))})))),i.createElement("div",{className:"promotion-odaislot-randomodai "+s},i.createElement("span",{className:"promotion-odaislot-randomodai-title "+s},i.createElement("span",{className:"promotion-odaislot-randomodai-title-inner "+s},l)),i.createElement("div",{className:"promotion-odaislot-randomodai-slotbutton "+s,onClick:function(){return e.turnSlot()}},i.createElement("i",{className:"blogicon-repeat tipsy-top",title:o.default.text("admin.odai.turn")}))),i.createElement("div",{className:"promotion-odaislot-insertbutton-wrapper"},i.createElement("button",{type:"button",className:"promotion-odaislot-insertbutton",onClick:function(){return e.selectOdai()}},o.default.text("admin.odai.insert"))),i.createElement("div",{className:"promotion-odaislot-footer"},i.createElement("p",null,r)))}},a.render=function(){return i.createElement("div",{className:"promotion-odaislot "+this.props.device},this.renderOdaiSlot())},r}(i.Component);t.OdaiSlotPage=f},18040:function(e,t,n){n(4129),n(78783),n(38880),t.__esModule=!0,t.PageSwitcher=void 0,n(41539),n(66992),n(33948);var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=u(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),o=(r=n(20996))&&r.__esModule?r:{default:r},a=n(45326),s=n(62142);function u(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(u=function(e){return e?n:t})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var c=n(26567),d=n(14674),f=n(77667).pageIds,p=function(e){var t,n;function r(){return e.apply(this,arguments)||this}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,l(t,n);var u=r.prototype;return u.openOdaiSlotPage=function(e){e.preventDefault(),c.setPage(f.ODAI_SLOT_PAGE)},u.openEntriesPage=function(e){e.preventDefault();var t=this.props.entries.entryIds[0];d.showEntry(t),c.setPage(f.ENTRIES_PAGE)},u.renderPage=function(){var e=this.props,t=e.entries,n=e.odai,r=e.device,o=e.currentPage;return o===f.ENTRIES_PAGE?i.createElement(a.EntriesPage,{device:r,entities:t.entities,entryIds:t.entryIds,currentEntryId:t.currentEntryId}):o===f.ODAI_SLOT_PAGE?i.createElement(s.OdaiSlotPage,{device:r,entities:n.entities,randomOdaiId:n.randomOdaiId}):void 0},u.renderSwitch=function(){return this.props.currentPage===f.ENTRIES_PAGE?this.renderOdaiSlotSwitch():this.props.currentPage===f.ODAI_SLOT_PAGE?this.renderEntriesSwitch():void 0},u.renderOdaiSlotSwitch=function(){var e=this;return 0===this.props.odai.odaiIds.length?null:i.createElement("div",{className:"promotion-pages-switch"},i.createElement("div",{className:"promotion-pages-switch-link "+this.props.device},i.createElement("a",{href:"#",onClick:function(t){return e.openOdaiSlotPage(t)}},o.default.text("admin.odai.open_slot")," >")))},u.renderEntriesSwitch=function(){var e=this;return 0===this.props.entries.entryIds.length?null:i.createElement("div",{className:"promotion-pages-switch"},i.createElement("div",{className:"promotion-pages-switch-link "+this.props.device},i.createElement("a",{href:"#",onClick:function(t){return e.openEntriesPage(t)}},"< ",o.default.text("admin.odai.leave_slot"))))},u.render=function(){return i.createElement("div",{className:"promotion-pages "+this.props.device},this.renderPage(),this.renderSwitch())},r}(i.Component);t.PageSwitcher=p},48353:function(e,t,n){n(4129),n(78783),n(38880),t.__esModule=!0,t.PromotionBar=void 0,n(92222),n(41539),n(66992),n(33948),n(21249);var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=u(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),o=n(27180),a=n(86763),s=(r=n(20996))&&r.__esModule?r:{default:r};function u(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(u=function(e){return e?n:t})(e)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var f=n(26567),p=n(14674),h=n(77667).pageIds,m=function(e){var t,n;function r(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return d(l(t=e.call.apply(e,[this].concat(r))||this),"odaiSlotBar",null),d(l(t),"first",void 0),d(l(t),"second",void 0),t}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,c(t,n);var u=r.prototype;return u.renderEntryButton=function(e,t){var n=this,r=this.props.entries.entities[e];if(r){var a=0===t?"first":"second";return i.createElement(o.EntryButton,{entry:r,trackingId:a,ref:function(e){n[a]=e},key:r.id})}},u.showMoreEntry=function(){p.showEntry(this.props.entries.entryIds[0]),f.setPage(h.ENTRIES_PAGE),f.showWindow()},u.render=function(){var e=this,t=this.props,n=t.odai,r=t.entries,o="promotion-bar-view-more"+(r.activeEntryIds.some((function(e){return p.isShownEntry(e)}))?"":"--hidden");return i.createElement("div",{className:"promotion-bar"},i.createElement("div",{className:"promotion-bar-items"},i.createElement("span",null,r.activeEntryIds.map((function(t,n){return e.renderEntryButton(t,n)}))),i.createElement("span",{className:"odaislot-bar--hidden",ref:function(t){e.odaiSlotBar=t}},i.createElement(a.OdaiSlotButton,{isActive:n.isActive,isKilled:n.isKilled}))),i.createElement("div",{className:o},i.createElement("div",{className:"promotion-view-more-button",onClick:function(){return e.showMoreEntry()}},s.default.text("epic.view_more"))))},r}(i.Component);t.PromotionBar=m},24846:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.PromotionContent=void 0;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=i(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=o?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(67294));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(i=function(e){return e?n:t})(e)}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var a=n(26567),s=n(14674),u=function(e){var t,n;function i(){return e.apply(this,arguments)||this}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,o(t,n);var u=i.prototype;return u.render=function(){var e=this,t="promotion-entry";t+=this.props.isSelected?" selected":"",t+=" "+this.props.device;return r.createElement("div",{className:t,onClick:function(t){return e.onClick(t)}},r.createElement("div",{dangerouslySetInnerHTML:{__html:e.props.entry.body}}))},u.onClick=function(e){var t=e.target,n=t.getAttribute("data-keyword"),r=t.getAttribute("data-fillin-id");(n||r)&&(n&&(s.fillKeyword(n),a.hideWindow()),r&&(s.fillin(r),a.hideWindow()),e.preventDefault(),e.stopPropagation())},i}(r.Component);t.PromotionContent=u},81761:function(e,t,n){n(4129),n(78783),n(38880),t.__esModule=!0,t.PromotionModal=void 0,n(41539),n(66992),n(33948);var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=c(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),o=n(99240),a=n(18040),s=n(61663),u=(r=n(20996))&&r.__esModule?r:{default:r},l=n(55992);function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(c=function(e){return e?n:t})(e)}var d=n(26567);t.PromotionModal=function(e){var t=e.currentPage,n=e.entries,r=e.isWindowVisible,a=e.odai,s=(0,i.useCallback)((function(){d.hideWindow()}),[]);return i.default.createElement(o.CSSTransition,{classNames:"fade",timeout:300,appear:!0,in:r,mountOnEnter:!0,unmountOnExit:!0},i.default.createElement(f,null,i.default.createElement(p,{closeHandler:s,currentPage:t,entries:n,odai:a})))};var f=function(e){var t=e.children;return i.default.createElement("div",{className:"promotion-wrapper"},i.default.createElement("div",{className:"promotion-background"}),t)},p=function(e){var t=e.closeHandler,n=e.odai,r=e.currentPage,o=e.entries,c=(0,i.useRef)(null);return(0,s.useOnClickOutside)(c,t),i.default.createElement("div",{className:"promotion-window",ref:c},i.default.createElement("button",{className:"promotion-window-close","aria-label":u.default.text("close"),onClick:t,type:"button"},i.default.createElement("img",{src:(0,l.staticUrl)("/images/admin/close.svg"),alt:u.default.text("close")})),i.default.createElement(a.PageSwitcher,{entries:o,odai:n,device:"PC",currentPage:r}))}},97814:function(e,t,n){n(4129),n(78783),n(38880),t.__esModule=!0,t.PromotionPC=void 0,n(41539),n(66992),n(33948);var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),i=n(48353),o=n(81761);function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u=function(e){var t,n;function a(t){var n,r,i,o;return n=e.call(this,t)||this,r=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(n),o=function(){n.setState(n.props.store.getState())},(i="updateState")in r?Object.defineProperty(r,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[i]=o,n.state=t.store.getState(),n}n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,s(t,n);var u=a.prototype;return u.componentDidMount=function(){this.props.store.on("change",this.updateState)},u.componentWillUnmount=function(){this.props.store.removeListener("change",this.updateState)},u.render=function(){return r.createElement("div",null,r.createElement(i.PromotionBar,{odai:this.state.odai,entries:this.state.entries}),r.createElement(o.PromotionModal,{odai:this.state.odai,entries:this.state.entries,isWindowVisible:this.state.modal.isWindowVisible,currentPage:this.state.modal.currentPage}))},a}(r.Component);t.PromotionPC=u},58972:function(e,t,n){n(4129),n(78783),n(38880),t.__esModule=!0,t.PromotionTouch=void 0,n(41539),n(66992),n(33948);var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=o(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(67294)),i=n(18040);function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(o=function(e){return e?n:t})(e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var s=function(e){var t,n;function o(t){var n,r,i,o;return n=e.call(this,t)||this,r=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(n),o=function(){n.setState(n.props.store.getState())},(i="updateState")in r?Object.defineProperty(r,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[i]=o,n.state=t.store.getState(),n}n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,a(t,n);var s=o.prototype;return s.componentDidMount=function(){this.props.store.on("change",this.updateState)},s.componentWillUnmount=function(){this.props.store.removeListener("change",this.updateState)},s.render=function(){return r.createElement(i.PageSwitcher,{entries:this.state.entries,odai:this.state.odai,device:"Touch",currentPage:this.state.modal.currentPage})},o}(r.Component);t.PromotionTouch=s},79065:function(e,t,n){n(19601);var r=function(e){try{return!!localStorage["Hatena.Diary.Promotion.Entry.read."+e]}catch(e){}return!1},i=function(e){try{return!!localStorage["Hatena.Diary.Promotion.Entry.closed."+e]}catch(e){}return!1};e.exports=function(e){return Object.assign({},e,{isRead:r(e.id),isClosed:i(e.id)})}},35961:function(e,t,n){t.__esModule=!0,t.init=void 0;var r,i=(r=n(67294))&&r.__esModule?r:{default:r},o=n(73380),a=n(97814);var s=n(91269),u=n(73287).Store,l=n(14674),c=n(40746),d=n(50525),f=function(e){if(e&&s.get("editor.promotion.enabled")){var t=new u(d);(0,o.safeRender)(i.default.createElement(a.PromotionPC,{store:t}),e),l.init(),c.init(),c.loadOdais()}};t.init=f},95932:function(e,t,n){n(21249),n(57327),n(92222),n(19601);var r=n(13469),i=n(77289),o=n(35340),a=n(77667).actions,s={entities:{},entryIds:[],activeEntryIds:[],currentEntryId:null};function u(e){var t=e.entryIds.map((function(t){return e.entities[t]})),n=t.filter((function(e){return!e.isRead&&!e.isClosed})),i=t.filter((function(e){return e.isRead&&!e.isClosed}));return r.first(n.concat(r.shuffle(i)),4).map((function(e){return e.id}))}function l(e){return Object.assign({},e,{activeEntryIds:u(e)})}e.exports=function(e,t){switch(void 0===e&&(e=s),t.type){case a.LOAD_ENTRIES:return function(e,t){return l(Object.assign({},e,{entities:i(t,"id"),entryIds:t.map((function(e){return e.id}))}))}(e,t.payload);case a.SHUFFLE_ENTRIES:return l(e);case a.SHOW_ENTRY:return function(e,t){if(!e.entities[t])return e;var n=o(e);return n.entities[t].isRead=!0,n.currentEntryId=t,n}(e,t.payload);case a.CLOSE_ENTRY:return function(e,t){if(!e.entities[t])return e;var n=o(e);return n.entities[t].isClosed=!0,n}(e,t.payload);default:return e}}},50525:function(e,t,n){var r=s(n(76490)),i=s(n(95932)),o=s(n(76128)),a=s(n(76985));function s(e){return e&&e.__esModule?e:{default:e}}e.exports=(0,r.default)({entries:i.default,odai:o.default,modal:a.default})},76985:function(e,t,n){n(19601);var r=n(77667).actions,i={isWindowVisible:!1,currentPage:n(77667).pageIds.ENTRIES_PAGE};e.exports=function(e,t){switch(void 0===e&&(e=i),t.type){case r.SHOW_WINDOW:return function(e){return Object.assign({},e,{isWindowVisible:!0})}(e);case r.HIDE_WINDOW:return function(e){return Object.assign({},e,{isWindowVisible:!1})}(e);case r.SET_PAGE:return function(e,t){return Object.assign({},e,{currentPage:t})}(e,t.payload);default:return e}}},76128:function(e,t,n){n(19601),n(21249);var r=n(13469),i=n(77667).actions,o=n(77289),a={entities:{},odaiIds:[],randomOdaiId:null,slotCount:0,isKilled:!0,isActive:!1};function s(e){return e.slotCount===e.odaiIds.length?Object.assign({},e,{odaiIds:r.shuffle(e.odaiIds),slotCount:0}):Object.assign({},e,{randomOdaiId:e.odaiIds[e.slotCount],slotCount:e.slotCount+1})}e.exports=function(e,t){switch(void 0===e&&(e=a),t.type){case i.LOAD_ODAIS:return function(e,t){return s(Object.assign({},e,{entities:o(t,"uuid"),odaiIds:r.shuffle(t.map((function(e){return e.uuid})))}))}(e,t.payload);case i.TURN_SLOT:return s(e);case i.TOGGLE_KILLED:return function(e,t){return Object.assign({},e,{isKilled:t})}(e,t.payload);case i.TOGGLE_ACTIVE:return function(e,t){return Object.assign({},e,{isActive:t})}(e,t.payload);default:return e}}},72461:function(e,t,n){n(69826),n(41539),n(66992),n(33948);var r,i=n(70879),o=n(10714),a=n(92477),s=(r=n(57942))&&r.__esModule?r:{default:r},u=n(64292),l=n(57753);function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=n(73609),p=n(13469),h=n(41960),m=p.template('<blockquote cite="<%- url %>" data-uuid="<%- uuid %>"><p><%- body %></p><cite><a href="<%- url %>"><%- title %></a></cite></blockquote>'),v=function(e){var t,n;function r(t){var n;return(n=e.call(this,t)||this).$indicator=t.container.find(".indicator"),n.bindEvents(),n}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,d(t,n);var l,v,g,b=r.prototype;return b.bindEvents=function(){var t=this;e.prototype.bindEvents.call(this),this.$submit=this.$container.find(".quote-keyword-submit"),this.$keyword=this.$container.find(".quote-keyword"),this.$submit.on("click",(function(){return t.initLoadCondition(),t.requestReload(),!1})),this.$keyword.on("keydown",(function(e){if("RET"===h(e))return t.initLoadCondition(),t.requestReload(),!1})),this.$itemsContainer.on("click",".js-button-quote-delete",(function(e){var t=f(e.target).attr("data-uuid");f.ajax({url:"/api/quotes/delete",cache:!1,type:"post",dataType:"json",data:{uuid:t,rkm:(0,s.default)("rkm"),rkc:(0,s.default)("rkc")}}).done((function(){f('.item[data-uuid="'+t+'"]').remove()}))}))},b.initLoadCondition=function(){this.itemsReachedEnd=!1,this.untilEpoch=null},b.willRequestLoadItems=function(){return!0},b.loadItems=function(){var e=this;return f.ajax({url:"/api/quotes",type:"GET",dataType:"json"}).then((function(t){return t.entries.length>0?(e.itemsReachedEnd=!0,f.Deferred().resolve(t)):f.Deferred().reject()}))},b.renderItem=function(e){return e.datetimeEpoch=Date.parse(e.datetime),this.template({entry:e,trim:u.trimString})},b.insertItems=function(e){var t={hatena:[],markdown:[]};p.each(e,(function(e){var n=e.attr("data-title")||"■",r=e.attr("data-blog")||"";""!==r&&(r=" - "+r);var i=m({uuid:e.attr("data-uuid")||"",url:e.attr("data-url"),body:e.attr("data-body"),title:n+r});t.hatena.push(">"+i+"<"),t.markdown.push(i)})),(0,a.extractSyntax)(t.hatena).done((function(e){t.html=["",e.html,""]})).fail((function(e){t.html=t.hatena,(0,i.BUG)(e)})).always((function(){(o.EditorConnector.isiOS()||o.EditorConnector.isAndroid())&&(t.html=t.hatena),o.EditorConnector.insertLines(t)}))},b.fillInFirstItem=function(){if("#auto_fillin"===location.hash){var e=this.$container.find(".item").first();e.length>0&&this.insertItems([e])}},b.fillInReQuote=function(){try{var e=localStorage.getItem("ReQuote");if(void 0===e)return;var t=JSON.parse(e),n=f("<div>").attr({"data-url":t.url,"data-title":t.title,"data-body":t.body,"data-blog":""});this.insertItems([n]),localStorage.removeItem("ReQuote")}catch(e){}},b.loadItemsFinishedHandler=function(){this.fillInReQuote(),this.fillInFirstItem()},l=r,(v=[{key:"type",get:function(){return"editor-quote"}},{key:"serviceName",get:function(){return"Quote"}},{key:"enableAutoPager",get:function(){return!0}},{key:"pasteReverseOrder",get:function(){return!0}}])&&c(l.prototype,v),g&&c(l,g),r}(l.MyCuration);e.exports=v},11500:function(e,t){t.__esModule=!0,t.ERROR_MSGID=t.KNOWN_ERRORS=void 0;t.KNOWN_ERRORS={400:!0,429:!0};t.ERROR_MSGID={429:"edit_form.rakuten.api_limit_exceeded"}},66316:function(e,t,n){n(66992),n(33948),n(47042),n(68309),n(91038),n(78783),n(82526),n(41817),n(32165),t.__esModule=!0,t.RakutenViewModel=void 0,n(19601),n(4723),n(74916),n(88674),n(41539),n(92222),n(57327),n(47941),n(21249);var r=n(17187),i=n(13469),o=n(10714),a=n(12495);function s(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var c=n(81191),d=function(e){var t,n;function r(){var t,n,r,i;return t=e.call(this)||this,n=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t),i=void 0,(r="state")in n?Object.defineProperty(n,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[r]=i,t.state={items:[],selectedItemCodes:{},keyword:null,page:1,error:null,isLoading:!1},t}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,l(t,n);var u=r.prototype;return u.setState=function(e){this.state=Object.assign({},this.state,e),this.emit("change")},u.getState=function(){return Object.assign({},this.state)},u.searchItems=function(e){var t=this;if(!e.match(/^\s*$/))return this.setState({keyword:e,isLoading:!0}),(0,a.fetchAPI)({keyword:e}).then((function(e){return t.setState({items:e,page:1,error:null})})).catch((function(e){return t.setState({error:e})})).then((function(){return t.setState({isLoading:!1})}))},u.loadNextItems=function(){var e=this;if(this.state.error)return Promise.resolve();this.setState({isLoading:!0});var t=this.state.keyword,n=this.state.page+1;return(0,a.fetchAPI)({keyword:t,page:n}).then((function(t){return e.setState({items:e.state.items.concat(t),page:n})})).catch((function(t){return e.setState({error:t})})).then((function(){return e.setState({isLoading:!1})}))},u.toggleItemSelection=function(e){var t;this.setState({selectedItemCodes:Object.assign({},this.state.selectedItemCodes,(t={},t[e.itemCode]=!this.state.selectedItemCodes[e.itemCode],t))})},u.insertSelectedItems=function(){for(var e,t=this,n={},r=s(this.state.items);!(e=r()).done;){var i=e.value;n[i.itemCode]=i}var a=Object.keys(this.state.selectedItemCodes).filter((function(e){return t.state.selectedItemCodes[e]})).map((function(e){return"[rakuten:"+e+":detail]"}));o.EditorConnector.insertLines({html:a,hatena:a,markdown:a}),c.trackEvent("curation-rakuten-insert-item"),this.setState({selectedItemCodes:{}})},u.insertItem=function(e){var t=["[rakuten:"+e.itemCode+":detail]"];o.EditorConnector.insertLines({html:t,hatena:t,markdown:t}),c.trackEvent("curation-rakuten-insert-item"),this.isItemSelected(e)&&this.toggleItemSelection(e)},u.isItemSelected=function(e){return!!this.state.selectedItemCodes[e.itemCode]},u.hasSelectedItems=function(){return 0!==(0,i.values)(this.state.selectedItemCodes).filter((function(e){return e})).length},r}(r.EventEmitter);t.RakutenViewModel=d},77018:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.ErrorMessage=void 0;var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),o=(r=n(20996))&&r.__esModule?r:{default:r},a=n(11500);function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var l=function(e){var t,n;function r(){return e.apply(this,arguments)||this}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,u(t,n),r.prototype.render=function(){if(!this.props.error)return null;var e=a.ERROR_MSGID[this.props.error];return e?i.createElement("div",{className:"editor-rakuten-error"},o.default.text(e)):null},r}(i.Component);t.ErrorMessage=l},73544:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.Footer=void 0;var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),o=(r=n(9825))&&r.__esModule?r:{default:r};function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u=function(e){var t,n;function r(){return e.apply(this,arguments)||this}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,s(t,n),r.prototype.render=function(){var e=!this.props.hasSelectedItems;return i.createElement("div",{className:"editor-rakuten-footer"},i.createElement(o.default,{disabled:e,onClick:this.props.onSubmit}))},r}(i.Component);t.Footer=u},34184:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.Item=void 0;var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),o=n(64292),a=(r=n(20996))&&r.__esModule?r:{default:r};function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}t.Item=function(e){var t=e.item,n=e.isSelected,r=e.onSelect,s=e.onDoubleClick;return i.createElement("div",{className:"editor-rakuten-item item "+(n?"selected":""),onClick:r,onDoubleClick:s},i.createElement("div",{className:"editor-rakuten-item__inner"},i.createElement(u,{item:t}),i.createElement("div",{className:"editor-rakuten-item__right"},i.createElement("span",{className:"editor-rakuten-item__name"},(0,o.trimString)(t.itemName,60)),i.createElement("span",{className:"editor-rakuten-item__price"},a.default.text("edit_form.rakuten.price",t.itemPrice)),i.createElement("span",{className:"editor-rakuten-item__shop-name"},t.shopName))))};var u=function(e){var t=e.item;return t.imageFlag?i.createElement("div",{className:"editor-rakuten-item__thumbnail"},i.createElement("img",{src:t.smallImageUrls[0]})):null}},21931:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.RakutenSidebar=void 0,n(21249);var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=f(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),i=d(n(20996)),o=n(46171),a=d(n(70881)),s=n(90381),u=n(73544),l=n(34184),c=n(77018);function d(e){return e&&e.__esModule?e:{default:e}}function f(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(f=function(e){return e?n:t})(e)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var v=function(e){return r.createElement("div",{className:"editor-rakuten-items-message"},e.children)},g=function(e){var t,n;function d(t){var n;return m(p(n=e.call(this,t)||this),"state",void 0),m(p(n),"update",void 0),n.state=t.vm.getState(),n}n=e,(t=d).prototype=Object.create(n.prototype),t.prototype.constructor=t,h(t,n);var f=d.prototype;return f.componentDidMount=function(){var e=this;this.update=function(){return e.setState(e.props.vm.getState())},this.props.vm.on("change",this.update)},f.componentWillUnmount=function(){this.props.vm.removeListener("change",this.update),this.update=null},f.render=function(){var e=this,t=this.state,n=t.items,d=t.keyword,f=null===d,p=this.state.isLoading,h=!f&&!p&&0===n.length;return r.createElement("div",{className:"editor-rakuten-content"},r.createElement("div",{className:"editor-rakuten-header"},r.createElement("h2",null,i.default.text("edit_form.rakuten")),r.createElement(a.default,{placeholder:i.default.text("edit_form.rakuten.placeholder"),onSubmit:function(t){return e.props.vm.searchItems(t)}}),r.createElement(c.ErrorMessage,{error:this.state.error})),r.createElement("div",{className:"editor-rakuten-main"},r.createElement(o.InfiniteScroll,{onScroll:function(){return e.props.vm.loadNextItems()},interval:1e3},r.createElement("div",{className:"editor-rakuten-items"},n.map((function(t,n){return r.createElement(l.Item,{item:t,key:n,isSelected:e.props.vm.isItemSelected(t),onSelect:function(){return e.props.vm.toggleItemSelection(t)},onDoubleClick:function(){return e.props.vm.insertItem(t)}})})),f?r.createElement(v,null,i.default.text("edit_form.rakuten.description")):null,h?r.createElement(v,null,i.default.text("edit_form.rakuten.empty",d)):null,p?r.createElement(s.LoadingIndicator,null):null))),r.createElement(u.Footer,{hasSelectedItems:this.props.vm.hasSelectedItems(),onSubmit:function(){return e.props.vm.insertSelectedItems()}}))},d}(r.Component);t.RakutenSidebar=g},12495:function(e,t,n){t.__esModule=!0,t.fetchAPI=function(e){return i.default.get("/api/rakuten",{params:e}).then((function(e){if(e.data.error)throw e.data.error;return e.data.Items})).catch((function(e){if(a.KNOWN_ERRORS[e.message])throw e;(0,o.BUG)(e)}))};var r,i=(r=n(347))&&r.__esModule?r:{default:r},o=n(70879),a=n(11500)},40555:function(e,t,n){t.__esModule=!0,t.Rakuten=void 0;var r,i=(r=n(67294))&&r.__esModule?r:{default:r},o=n(73380),a=n(21931),s=n(66316);t.Rakuten=function(e){var t=new s.RakutenViewModel;(0,o.safeRender)(i.default.createElement(a.RakutenSidebar,{vm:t}),e)}},80417:function(e,t,n){n(88674),n(41539),t.__esModule=!0,t.SidebarButtons=void 0,n(35666),n(69826),n(54747),n(47042),n(73210);var r=s(n(73609)),i=s(n(13469)),o=s(n(347)),a=n(55992);function s(e){return e&&e.__esModule?e:{default:e}}function u(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){u(o,r,i,a,s,"next",e)}function s(e){u(o,r,i,a,s,"throw",e)}a(void 0)}))}}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=n(91269),f=function(){function e(e,t,n){c(this,"$element",void 0),c(this,"parent",void 0),c(this,"publicationType",void 0),c(this,"$visibleButtonsContainer",void 0),c(this,"$overflowButtonsContainer",void 0),c(this,"$toggleButton",void 0),c(this,"$othersButton",void 0),c(this,"$addButton",void 0),c(this,"buttonSize",void 0),c(this,"services",void 0),c(this,"activeService",void 0),c(this,"template",void 0),c(this,"$othersButtonTipsy",void 0),this.$element=e,this.parent=t,this.publicationType=n,this.$visibleButtonsContainer=this.$element.find(".curation-bar-itemlist-visible"),this.$overflowButtonsContainer=this.$element.find(".curation-bar-itemlist-overflow"),this.$toggleButton=this.$element.find(".curation-bar-toggle"),this.$othersButton=this.$element.find(".editor-others"),this.$addButton=this.$element.find(".curation-add-button"),this.buttonSize=this.$othersButton.height(),this.services=d.get("editor.sidebarServices"),this.activeService="editor-home",this.template=i.default.template(this.$element.find(".template").html()),this.render(),this.initEvents()}var t=e.prototype;return t.initEvents=function(){var e=this;this.$toggleButton.on("click",(function(){e.parent.emit("toggle")})),this.$othersButton.on("click",(function(){e.toggleOverflow()})),this.$element.on("click","[data-support-type]",(function(t){var n=(0,r.default)(t.currentTarget);e.parent.emit("openByType",n.attr("data-support-type"))})),this.parent.on("tabChange",(function(t){return e.onTabChange(t)})),this.parent.on("resize",(function(){return e.render()})),this.parent.on("reloadSidebarButtons",l(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.reloadSidebarServices();case 2:e.render();case 3:case"end":return t.stop()}}),t)}))))},t.onTabChange=function(e){this.activeService=e,this.activateButton()},t.reloadSidebarServices=function(){var e=l(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,a.protocolRelativeAdminUserBlogUrl)("/edit_sidebar_buttons.json"),e.next=3,o.default.get(t,{params:{publication_type:this.publicationType}});case 3:n=e.sent,this.services=n.data;case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.activateButton=function(){var e=this;this.$visibleButtonsContainer.children().each((function(t,n){var i=(0,r.default)(n);i.toggleClass("is-active",i.attr("data-support-type")===e.activeService)})),this.$overflowButtonsContainer.children().each((function(t,n){var i=(0,r.default)(n);i.toggleClass("is-active",i.attr("data-support-type")===e.activeService)}))},t.render=function(){var e=this;this.$visibleButtonsContainer.empty(),this.$overflowButtonsContainer.empty(),this.$othersButton.show(),this.services.forEach((function(t){t.showShortcut&&e.$visibleButtonsContainer.append(e.renderButton(t))}));var t=this.$addButton[0].getBoundingClientRect().bottom-(0,r.default)(window).height();if(t>0){var n=Math.floor(t/this.buttonSize)+1,i=this.$visibleButtonsContainer.children().slice(-n);this.$overflowButtonsContainer.append(i),this.fixOverflowPosition()}else this.$othersButton.hide();this.activateButton()},t.renderButton=function(e){var t=this.template(e);return(0,r.default)(t.trim())},t.toggleOverflow=function(){this.$othersButton.toggleClass("is-active tipsy-left"),this.$overflowButtonsContainer.toggleClass("is-active"),this.$overflowButtonsContainer.hasClass("is-active")&&this.fixOverflowPosition(),this.$othersButtonTipsy=this.$othersButtonTipsy||(0,r.default)(".tipsy > *"),this.$othersButtonTipsy.toggle()},t.fixOverflowPosition=function(){var e=this.$element.offset().top,t=this.$othersButton.offset().top-e+this.$othersButton.outerHeight()-this.$overflowButtonsContainer.height();this.$overflowButtonsContainer.css({top:t})},e}();t.SidebarButtons=f},9825:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.default=void 0;var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),o=(r=n(20996))&&r.__esModule?r:{default:r};function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u=function(e){var t,n;function r(){return e.apply(this,arguments)||this}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,s(t,n),r.prototype.render=function(){var e="paste-button btn "+(this.props.disabled?"disabled":"enabled");return i.createElement("div",{className:"editor-sidebar-insert-button"},i.createElement("button",{className:e,type:"button","data-track-name":this.props.trackingId,disabled:this.props.disabled,onClick:this.props.onClick},o.default.text("edit_form.paste")))},r}(i.Component);t.default=u},70881:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.default=void 0;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=i(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=o?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(67294));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(i=function(e){return e?n:t})(e)}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var a=n(41960),s=function(e){var t,n;function i(t){var n;return(n=e.call(this,t)||this).state={value:""},n}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,o(t,n);var s=i.prototype;return s.onChange=function(e){this.setState({value:e.target.value})},s.onKeyPress=function(e){"RET"===a(e)&&(e.preventDefault(),this.submit())},s.submit=function(){this.props.onSubmit(this.state.value)},s.render=function(){var e=this;return r.createElement("div",{className:"sidebar-search-form"},r.createElement("input",{type:"text",placeholder:this.props.placeholder,className:"sidebar-search-form__input",onKeyPress:function(t){return e.onKeyPress(t)},onChange:function(t){return e.onChange(t)}}),r.createElement("button",{type:"button",className:"sidebar-search-form__submit",onClick:function(){return e.submit()}},r.createElement("i",{className:"blogicon-search"})))},i}(r.Component);t.default=s},13605:function(e,t,n){var r,i=(r=n(73609))&&r.__esModule?r:{default:r},o=n(13469);function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var s=function(e){var t,n;function r(){var t;return(t=e.call(this)||this).type=document.querySelector(".curation-tab-content").id,(0,i.default)("input").on("blur",(function(){return t.emit("resize",t.type)})),(0,i.default)(window).on("resize",(0,o.debounce)((function(){return t.emit("resize",t.type)}),100)),t}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,a(t,n),r}(n(17187).EventEmitter);e.exports=s},6686:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.default=void 0;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),i=a(n(78101)),o=a(n(61016));function a(e){return e&&e.__esModule?e:{default:e}}function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var l=function(e){var t,n;function a(){return e.apply(this,arguments)||this}return n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,u(t,n),a.prototype.render=function(){var e=this,t="editor-sidebar-user-association";return this.props.user?r.createElement("div",{className:t},r.createElement(o.default,{user:this.props.user,onUnregister:function(){return e.props.onUnregister()}})):r.createElement("div",{className:t},r.createElement(i.default,{placeholder:this.props.placeholder,onRegister:function(t){return e.props.onRegister(t)}}))},a}(r.Component);t.default=l},78101:function(e,t,n){t.__esModule=!0,t.default=void 0;var r=o(n(67294)),i=o(n(20996));function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var s=n(41960),u=function(e){var t,n;function o(t){var n;return(n=e.call(this,t)||this).state={value:""},n}n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,a(t,n);var u=o.prototype;return u.render=function(){var e=this;return r.default.createElement("div",{className:"user-form"},r.default.createElement("input",{type:"text",className:"user-form-name",placeholder:this.props.placeholder,onKeyPress:function(t){return e.onKeyPress(t)},onChange:function(t){return e.onChange(t)},value:this.state.value}),r.default.createElement("button",{type:"button",className:"user-form-name-submit",onClick:function(){return e.register()}},i.default.text("edit_form.flickr.register")))},u.onChange=function(e){this.setState({value:e.target.value})},u.onKeyPress=function(e){"RET"===s(e)&&(e.preventDefault(),this.register())},u.register=function(){this.props.onRegister(this.state.value)},o}(r.default.Component);t.default=u},61016:function(e,t,n){t.__esModule=!0,t.default=void 0,n(68309);var r,i=(r=n(67294))&&r.__esModule?r:{default:r};var o=function(e){var t=e.user,n=e.onUnregister;return i.default.createElement("div",{className:"user-info"},i.default.createElement("div",{className:"user-info-icon"},i.default.createElement("a",{href:t.uri},i.default.createElement("img",{src:t.icon,alt:"",className:"user-image"}))),i.default.createElement("div",{className:"user-info-name"},i.default.createElement("a",{href:t.uri,target:"_blank",rel:"noopener noreferrer"},t.name)),i.default.createElement("button",{type:"button",className:"user-info-unregister-button",onClick:function(){return n()}},i.default.createElement("i",{className:"blogicon-close"})))};t.default=o},56489:function(e,t){t.__esModule=!0,t.setFilterQuery=t.deleteSnippet=t.updatedExistingSnippet=t.createdNewSnippet=t.saveSnippet=t.updateEditingSnippet=t.setEditingSnippet=t.openSnippetEditingModal=t.extractSelectionToSnippet=t.insertSnippet=t.insertSelectedSnippet=t.setSelectedSnippet=t.receiveSnippets=t.requestSnippets=t.setBodyLengthLimit=t.setTitleLengthLimit=t.setSnippetCountLimit=t.setCanManageSnippets=t.initializeState=void 0;t.initializeState=function(){return{type:"INITIALIZE_STATE"}};t.setCanManageSnippets=function(e){return{canManageSnippets:e,type:"SET_CAN_MANAGE_SNIPPETS"}};t.setSnippetCountLimit=function(e){return{snippetCountLimit:e,type:"SET_SNIPPET_COUNT_LIMIT"}};t.setTitleLengthLimit=function(e){return{titleLengthLimit:e,type:"SET_TITLE_LENGTH_LIMIT"}};t.setBodyLengthLimit=function(e){return{bodyLengthLimit:e,type:"SET_BODY_LENGTH_LIMIT"}};t.requestSnippets=function(){return{type:"REQUEST_SNIPPETS"}};t.receiveSnippets=function(e){return{receivedSnippets:e,type:"RECEIVE_SNIPPETS"}};t.setSelectedSnippet=function(e){return{selectedSnippet:e,type:"SET_SELECTED_SNIPPET"}};t.insertSelectedSnippet=function(e){return{editor:e,type:"INSERT_SELECTED_SNIPPET"}};t.insertSnippet=function(e,t){return{editor:e,snippet:t,type:"INSERT_SNIPPET"}};t.extractSelectionToSnippet=function(e){return{editor:e,type:"EXTRACT_SELECTION_TO_SNIPPET"}};t.openSnippetEditingModal=function(e,t){return{editor:e,snippet:t,type:"OPEN_SNIPPET_EDITING_MODAL"}};t.setEditingSnippet=function(e){return{editingSnippet:e,type:"SET_EDITING_SNIPPET"}};t.updateEditingSnippet=function(e){return{type:"UPDATE_EDITING_SNIPPET",updatingEditingSnippet:e}};t.saveSnippet=function(){return{type:"SAVE_SNIPPET"}};t.createdNewSnippet=function(e){return{createdSnippet:e,type:"CREATED_NEW_SNIPPET"}};t.updatedExistingSnippet=function(e){return{type:"UPDATED_EXISTING_SNIPPET",updatedSnippet:e}};t.deleteSnippet=function(e){return{deletingSnippet:e,type:"DELETE_SNIPPET"}};t.setFilterQuery=function(e){return{query:e,type:"SET_FILTER_QUERY"}}},78983:function(e,t,n){t.__esModule=!0,t.deleteSnippet=t.updateSnippet=t.createSnippet=t.getSnippets=void 0,n(88674),n(41539);var r=o(n(57942)),i=o(n(347));function o(e){return e&&e.__esModule?e:{default:e}}t.getSnippets=function(){var e=(0,r.default)("blog-uuid");return e?i.default.get("/api/snippets",{params:{blogId:e},responseType:"json"}).then((function(e){return e.data.snippets})):Promise.reject("failed to retrieve blog")};t.createSnippet=function(e){var t=(0,r.default)("blog-uuid");if(!t)return Promise.reject("failed to retrieve blog");var n=(0,r.default)("rkm"),o=(0,r.default)("rkc");if(!n||!o)return Promise.reject("Failed to retrieve credentials");var a=new FormData;return a.append("title",e.title),a.append("body",e.body),a.append("blogId",t),a.append("rkm",n),a.append("rkc",o),i.default.post("/api/snippets",a,{responseType:"json"}).then((function(e){return e.data.snippet}))};t.updateSnippet=function(e){if(!(0,r.default)("blog-uuid"))return Promise.reject("failed to retrieve blog");var t=(0,r.default)("rkm"),n=(0,r.default)("rkc");if(!t||!n)return Promise.reject("Failed to retrieve credentials");var o=new FormData;return o.append("title",e.title),o.append("body",e.body),o.append("rkm",t),o.append("rkc",n),i.default.post("/api/snippets/"+e.uuid,o)};t.deleteSnippet=function(e){if(!(0,r.default)("blog-uuid"))return Promise.reject("failed to retrieve blog");var t=(0,r.default)("rkm"),n=(0,r.default)("rkc");return i.default.delete("/api/snippets/"+e.uuid,{params:{rkc:n,rkm:t}})}},24409:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.default=void 0;var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=p(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),o=(r=n(20996))&&r.__esModule?r:{default:r},a=n(67702),s=n(8881),u=n(23356),l=n(49872),c=n(27942),d=n(45977),f=n(75152);function p(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(p=function(e){return e?n:t})(e)}var h=function(e){var t=e.editor;return i.createElement("div",{className:"editor-sidebar-snippet"},i.createElement("div",{className:"editor-sidebar-snippet_header"},i.createElement("h2",null,o.default.text("edit_form.snippet")),i.createElement(s.DescriptionContainer,null),i.createElement(u.ExtractSelectionButtonContainer,{editor:t}),i.createElement(c.SnippetListHeaderContainer,null),i.createElement(f.FilterQueryFormContainer,null),i.createElement(d.SnippetEditorModalContainer,null)),i.createElement(a.BodyContainer,{editor:t}),i.createElement("div",{className:"editor-sidebar-snippet_footer"},i.createElement(l.PasteSnippetButtonContainer,{editor:t})))};t.default=h},97203:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.Body=void 0;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=o(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(67294)),i=n(8958);function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(o=function(e){return e?n:t})(e)}t.Body=function(e){var t=e.editor;return r.createElement("div",{className:"editor-sidebar-snippet_body"},r.createElement(i.SnippetsListContainer,{editor:t}))}},52796:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.Description=void 0;var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),o=(r=n(20996))&&r.__esModule?r:{default:r};function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}t.Description=function(e){var t=e.snippetCountLimit;return i.createElement("p",null,o.default.textN("edit_form.snippet.description",t,t))}},64592:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.default=void 0;var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),o=(r=n(20996))&&r.__esModule?r:{default:r};function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c=function(e){var t,n;function r(t){var n;return l(s(n=e.call(this,t)||this),"toggleButton",null),l(s(n),"handleDocumentClick",void 0),n.state={isOpen:!1},n.handleDocumentClick=n.forceCloseDropdownMenu.bind(s(n)),n}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,u(t,n);var a=r.prototype;return a.componentDidMount=function(){document.addEventListener("click",this.handleDocumentClick,!1)},a.componentWillUnmount=function(){document.removeEventListener("click",this.handleDocumentClick,!1)},a.render=function(){var e=this,t=this.state.isOpen;return i.createElement("div",{className:"editor-sidebar-snippet_dropdown-section"},i.createElement("div",{className:"dropdown-window-wrapper"},i.createElement("button",{type:"button",className:"dropdown-window-btn",onClick:function(t){return e.toggleDropdownMenu(t)},onDoubleClick:function(e){return e.preventDefault()},ref:function(t){e.toggleButton=t}},i.createElement("i",{className:"blogicon-others"})),i.createElement("div",{className:"dropdown-list-container "+(t?"is-open":"")},i.createElement("ul",{className:"list"},i.createElement("li",{className:"dropdown-snippetsList-update"},i.createElement("button",{type:"button",onClick:function(t){return e.props.onUpdate(t,e.props.snippet)}},i.createElement("i",{className:"blogicon-edit"})," ",o.default.text("edit_form.edit"))),i.createElement("li",{className:"dropdown-snippetsList-delete"},i.createElement("button",{type:"button",onClick:function(t){return e.props.onDelete(t,e.props.snippet)}},i.createElement("i",{className:"blogicon-close"})," ",o.default.text("edit_form.delete")))))))},a.toggleDropdownMenu=function(e){e.preventDefault(),this.setState({isOpen:!this.state.isOpen})},a.forceCloseDropdownMenu=function(e){this.toggleButton.contains(e.target)||this.setState({isOpen:!1})},r}(i.PureComponent);t.default=c},54249:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.EditingSnippetPreview=void 0;var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),o=(r=n(20996))&&r.__esModule?r:{default:r};function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}t.EditingSnippetPreview=function(e){var t=e.editingSnippet,n=e.titleLengthLimit,r=e.bodyLengthLimit,a=e.titleValidationResult,s=e.bodyValidationResult,u=e.onUpdateEditingSnippetBody,l=e.onUpdateEditingSnippetTitle,c=e.savingState,d=e.onSave,f=e.onCancel,p=function(e,t){switch(t){case"TOO_LONG":return o.default.textN("edit_form.snippet.field.too_long",e,o.default.formatNumber(e));default:return null}}(n,a),h=function(e,t){switch(t){case"TOO_LONG":return o.default.textN("edit_form.snippet.field.too_long",e,o.default.formatNumber(e));default:return null}}(r,s);return i.createElement("div",{className:"editor-sidebar-snippet_preview-container"},i.createElement("div",{className:"preview-header"},i.createElement("h4",null,o.default.text(t.uuid?"edit_form.snippet.update":"edit_form.snippet.save")),i.createElement("button",{type:"button",className:"preview-close",onClick:f},i.createElement("i",{className:"blogicon-close"}))),i.createElement("div",{className:"preview-body"},i.createElement("input",{type:"text",className:p?"error-input":"",value:t.title,placeholder:o.default.text("edit_form.title"),onChange:function(e){return l(e.currentTarget.value)}}),p&&i.createElement("p",null,p),i.createElement("textarea",{className:""+(h&&"error-input"),value:t.body,onChange:function(e){return u(e.currentTarget.value)}}),h&&i.createElement("p",null,h)),i.createElement("div",{className:"preview-footer"},i.createElement("button",{type:"submit",onClick:d,className:"preview-btn btn-submit "+("savable"!==c?"disabled":""),disabled:"savable"!==c},o.default.text(function(e){switch(e){case"saving":return"edit_form.saving";default:return"edit_form.save"}}(c))),i.createElement("button",{type:"submit",onClick:f,className:"preview-btn"},o.default.text("cancel"))))}},72048:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.ExtractSelectionButton=void 0;var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),o=(r=n(20996))&&r.__esModule?r:{default:r};function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}t.ExtractSelectionButton=function(e){var t=e.canManageSnippets,n=e.enabled,r=e.onClick;return t?i.createElement("button",{type:"button",className:"editor-sidebar-snippet_btn "+(n?"":"disabled"),onClick:r,disabled:!n},o.default.text("edit_form.snippet.save")):null}},66219:function(e,t,n){t.__esModule=!0,t.FilterQueryForm=void 0;var r=a(n(67294)),i=a(n(20996)),o=a(n(70881));function a(e){return e&&e.__esModule?e:{default:e}}t.FilterQueryForm=function(e){var t=e.onFilterQueryChange;return r.default.createElement(o.default,{placeholder:i.default.text("edit_form.snippet.filter_placeholder"),onSubmit:function(e){return t(e)}})}},13859:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.PasteSnippetButton=void 0;var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),o=(r=n(20996))&&r.__esModule?r:{default:r};function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}t.PasteSnippetButton=function(e){var t=e.selectedSnippet,n=e.onClick;return i.createElement("button",{type:"submit",disabled:!t,onClick:function(e){return n(e)},className:"editor-sidebar-snippet_btn "+(t?"enabled":"disabled")},o.default.text("edit_form.snippet.paste"))}},20661:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.SnippetEditorModal=void 0;var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),o=(r=n(83253))&&r.__esModule?r:{default:r},a=n(98703);function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}t.SnippetEditorModal=function(e){var t=e.isOpen,n=e.onRequestClose;return i.createElement(o.default,{isOpen:t,className:"editor-sidebar-snippet_preview",overlayClassName:"editor-sidebar-snippet_preview-overlay",portalClassName:"editor-sidebar-snippet_preview-portal",shouldCloseOnOverlayClick:!0,onRequestClose:n},i.createElement(a.EditingSnippetPreviewContainer,null))}},51159:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.SnippetListElement=void 0;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),i=a(n(20996)),o=a(n(64592));function a(e){return e&&e.__esModule?e:{default:e}}function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}t.SnippetListElement=function(e){var t=e.snippet,n=e.isSelected,a=e.onClickSnippet,s=e.onDoubleClickSnippet,u=e.onUpdate,l=e.onDelete,c=e.canManageSnippets;return r.createElement("div",{className:"editor-sidebar-snippet_snippetsList-item "+(n?"is-selected":""),onClick:function(e){return a(e,t)},onDoubleClick:function(e){return s(e,t)}},r.createElement("div",{className:"editor-sidebar-snippet_snippetsList-title"},t.title||i.default.text("edit_form.snippet.no_title")),c&&r.createElement(o.default,{snippet:t,onUpdate:u,onDelete:l}))}},82623:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.SnippetListHeader=void 0;var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),o=(r=n(20996))&&r.__esModule?r:{default:r};function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}t.SnippetListHeader=function(e){var t=e.snippetCount;return i.createElement("h3",null,o.default.text("edit_form.snippet.list.header",t))}},59981:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.SnippetsList=void 0,n(21249);var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),i=n(90381),o=n(51159);function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}t.SnippetsList=function(e){return r.createElement("div",{className:"editor-sidebar-snippet_snippetsList"},function(e){var t=e.snippets,n=e.snippetsLoadingStatus,a=e.selectedSnippet,s=e.canManageSnippets,u=e.onSelectSnippet,l=e.onDoubleClickSnippet,c=e.onUpdateSnippet,d=e.onDeleteSnippet;switch(n){case"initial":case"loading":return r.createElement(i.LoadingIndicator,null);case"failed":return"failed to load";case"loaded":default:return t.map((function(e){return r.createElement(o.SnippetListElement,{key:e.uuid,snippet:e,isSelected:!!a&&a.uuid===e.uuid,onClickSnippet:u,onDoubleClickSnippet:l,onUpdate:c,onDelete:d,canManageSnippets:s})}))}}(e))}},67702:function(e,t,n){t.__esModule=!0,t.BodyContainer=void 0;var r=n(74308),i=n(97203),o=(0,r.connect)((function(e,t){return{editor:t.editor}}))(i.Body);t.BodyContainer=o},8881:function(e,t,n){t.__esModule=!0,t.DescriptionContainer=void 0;var r=n(74308),i=n(52796),o=(0,r.connect)((function(e){return{snippetCountLimit:e.snippetCountLimit}}))(i.Description);t.DescriptionContainer=o},98703:function(e,t,n){t.__esModule=!0,t.EditingSnippetPreviewContainer=void 0;var r=n(74308),i=n(56489),o=n(54249),a=n(71717),s=(0,r.connect)((function(e){var t,n,r,i,o;return{editingSnippet:e.editingSnippet,titleLengthLimit:e.titleLengthLimit,bodyLengthLimit:e.bodyLengthLimit,titleValidationResult:(0,a.validateTitle)((null===(t=e.editingSnippet)||void 0===t?void 0:t.title)||"",e.titleLengthLimit),bodyValidationResult:(0,a.validateBody)((null===(n=e.editingSnippet)||void 0===n?void 0:n.body)||"",e.bodyLengthLimit),savingState:(r=e.editingSnippet,i=e.titleLengthLimit,o=e.bodyLengthLimit,r?r.isSaving?"saving":(0,a.isSavable)(r,i,o)?"savable":"unsavable":"unsavable")}}),(function(e){return{onCancel:function(t){t.preventDefault(),e((0,i.setEditingSnippet)(null))},onSave:function(t){t.preventDefault(),e((0,i.saveSnippet)())},onUpdateEditingSnippetBody:function(t){e((0,i.updateEditingSnippet)({body:t}))},onUpdateEditingSnippetTitle:function(t){e((0,i.updateEditingSnippet)({title:t}))}}}))(o.EditingSnippetPreview);t.EditingSnippetPreviewContainer=s},23356:function(e,t,n){t.__esModule=!0,t.ExtractSelectionButtonContainer=void 0;var r=n(74308),i=n(56489),o=n(72048),a=(0,r.connect)((function(e){var t=e.snippets.data.length>=e.snippetCountLimit;return{canManageSnippets:e.canManageSnippets,enabled:!t}}),(function(e,t){return{onClick:function(n){n.preventDefault(),e((0,i.extractSelectionToSnippet)(t.editor))}}}))(o.ExtractSelectionButton);t.ExtractSelectionButtonContainer=a},75152:function(e,t,n){t.__esModule=!0,t.FilterQueryFormContainer=void 0;var r=n(74308),i=n(66219),o=n(56489),a=(0,r.connect)(null,(function(e){return{onFilterQueryChange:function(t){return e((0,o.setFilterQuery)(t))}}}))(i.FilterQueryForm);t.FilterQueryFormContainer=a},49872:function(e,t,n){t.__esModule=!0,t.PasteSnippetButtonContainer=void 0;var r=n(74308),i=n(13859),o=n(56489),a=(0,r.connect)((function(e){return{selectedSnippet:e.selectedSnippet}}),(function(e,t){return{onClick:function(n){n.preventDefault(),e((0,o.insertSelectedSnippet)(t.editor))}}}))(i.PasteSnippetButton);t.PasteSnippetButtonContainer=a},45977:function(e,t,n){t.__esModule=!0,t.SnippetEditorModalContainer=void 0;var r=n(74308),i=n(56489),o=n(20661),a=(0,r.connect)((function(e){return{isOpen:!!e.editingSnippet}}),(function(e){return{onRequestClose:function(){e((0,i.setEditingSnippet)(null))}}}))(o.SnippetEditorModal);t.SnippetEditorModalContainer=a},27942:function(e,t,n){t.__esModule=!0,t.SnippetListHeaderContainer=void 0;var r=n(74308),i=n(82623),o=(0,r.connect)((function(e){return{snippetCount:e.snippets.data.length}}))(i.SnippetListHeader);t.SnippetListHeaderContainer=o},8958:function(e,t,n){t.__esModule=!0,t.SnippetsListContainer=void 0,n(26699),n(32023),n(57327);var r,i=n(74308),o=(r=n(20996))&&r.__esModule?r:{default:r},a=n(56489),s=n(59981);var u=(0,i.connect)((function(e){var t=e.snippets.data,n=e.filterQuery;if(""===n)return{canManageSnippets:e.canManageSnippets,selectedSnippet:e.selectedSnippet,snippets:t,snippetsLoadingStatus:e.snippets.loadingStatus};var r=t.filter((function(e){return function(e,t){var n=e.toLowerCase();return t.title.toLowerCase().includes(n)||t.body.toLowerCase().includes(n)}(n,e)}));return{canManageSnippets:e.canManageSnippets,selectedSnippet:e.selectedSnippet,snippets:r,snippetsLoadingStatus:e.snippets.loadingStatus}}),(function(e,t){return{onDeleteSnippet:function(t,n){var r;t.preventDefault(),r=n.title||o.default.text("edit_form.snippet.no_title"),window.confirm(o.default.text("edit_form.snippet.delete.confirm",r))&&e((0,a.deleteSnippet)(n))},onDoubleClickSnippet:function(n,r){n.defaultPrevented||(n.preventDefault(),e((0,a.insertSnippet)(t.editor,r)))},onSelectSnippet:function(t,n){t.defaultPrevented||(t.preventDefault(),e((0,a.setSelectedSnippet)(n)))},onUpdateSnippet:function(n,r){n.preventDefault(),e((0,a.openSnippetEditingModal)(t.editor,r))}}}))(s.SnippetsList);t.SnippetsListContainer=u},34253:function(e,t){t.__esModule=!0,t.insertSnippetToEditor=t.extractSelectionFromEditor=void 0;t.extractSelectionFromEditor=function(e){return e.getSelectionSource()};t.insertSnippetToEditor=function(e,t){t.insert(e.body)}},20246:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.default=void 0;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=f(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),i=n(73380),o=n(74308),a=n(14890),s=d(n(30797)),u=d(n(24409)),l=d(n(56015)),c=d(n(13594));function d(e){return e&&e.__esModule?e:{default:e}}function f(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(f=function(e){return e?n:t})(e)}var p={init:function(e,t){var n=(0,s.default)(),d=(0,a.createStore)(l.default,(0,a.applyMiddleware)(n));n.run(c.default),(0,i.safeRender)(r.createElement(o.Provider,{store:d},r.createElement(u.default,{editor:t})),e)}};t.default=p},56015:function(e,t,n){t.__esModule=!0,t.default=void 0,n(34553),n(92222),n(40561),n(47042),n(19601);var r=n(14890),i=(0,r.combineReducers)({canManageSnippets:function(e,t){switch(void 0===e&&(e=!1),t.type){case"SET_CAN_MANAGE_SNIPPETS":return t.canManageSnippets;default:return e}},snippetCountLimit:function(e,t){switch(void 0===e&&(e=0),t.type){case"SET_SNIPPET_COUNT_LIMIT":return t.snippetCountLimit;default:return e}},titleLengthLimit:function(e,t){switch(void 0===e&&(e=0),t.type){case"SET_TITLE_LENGTH_LIMIT":return t.titleLengthLimit;default:return e}},bodyLengthLimit:function(e,t){switch(void 0===e&&(e=0),t.type){case"SET_BODY_LENGTH_LIMIT":return t.bodyLengthLimit;default:return e}},editingSnippet:function(e,t){switch(void 0===e&&(e=null),t.type){case"SET_EDITING_SNIPPET":return t.editingSnippet;case"UPDATE_EDITING_SNIPPET":return Object.assign({},e,t.updatingEditingSnippet);case"CREATED_NEW_SNIPPET":case"UPDATED_EXISTING_SNIPPET":return null;case"SAVE_SNIPPET":return Object.assign({},null===e?{title:"",body:""}:e,{isSaving:!0});default:return e}},selectedSnippet:function(e,t){switch(void 0===e&&(e=null),t.type){case"SET_SELECTED_SNIPPET":return e&&null!==t.selectedSnippet&&e.uuid===t.selectedSnippet.uuid?null:t.selectedSnippet;default:return e}},filterQuery:function(e,t){switch(void 0===e&&(e=""),t.type){case"SET_FILTER_QUERY":return t.query;default:return e}},snippets:(0,r.combineReducers)({data:function(e,t){switch(void 0===e&&(e=[]),t.type){case"RECEIVE_SNIPPETS":return t.receivedSnippets;case"CREATED_NEW_SNIPPET":return[t.createdSnippet].concat(e);case"UPDATED_EXISTING_SNIPPET":return n=t.updatedSnippet,i=(r=e).findIndex((function(e){return e.uuid===n.uuid})),[].concat(r.slice(0,i),[n],r.slice(i+1));case"DELETE_SNIPPET":return function(e,t){var n=t.findIndex((function(t){return t.uuid===e.uuid})),r=[].concat(t);return r.splice(n,1),r}(t.deletingSnippet,e);default:return e}var n,r,i},loadingStatus:function(e,t){switch(void 0===e&&(e="initial"),t.type){case"REQUEST_SNIPPETS":return"loading";case"RECEIVE_SNIPPETS":return"loaded";default:return e}}})});t.default=i},13594:function(e,t,n){t.__esModule=!0,t.takeInsertSnippet=N,t.default=q,n(35666);var r=n(34857),i=n(56489),o=n(78983),a=n(34253),s=regeneratorRuntime.mark(O),u=regeneratorRuntime.mark(x),l=regeneratorRuntime.mark(j),c=regeneratorRuntime.mark(M),d=regeneratorRuntime.mark($),f=regeneratorRuntime.mark(T),p=regeneratorRuntime.mark(I),h=regeneratorRuntime.mark(D),m=regeneratorRuntime.mark(L),v=regeneratorRuntime.mark(N),g=regeneratorRuntime.mark(A),b=regeneratorRuntime.mark(B),y=regeneratorRuntime.mark(F),_=regeneratorRuntime.mark(U),w=regeneratorRuntime.mark(W),E=regeneratorRuntime.mark(H),S=regeneratorRuntime.mark(z),C=regeneratorRuntime.mark(q),k=n(91269);function O(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,r.call)(o.deleteSnippet,e.deletingSnippet);case 2:case"end":return t.stop()}}),s)}function x(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,r.takeEvery)("DELETE_SNIPPET",O);case 2:case"end":return e.stop()}}),u)}var P=function(e){return e.editingSnippet};function j(){var e,t;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,r.select)(P);case 2:return e=n.sent,n.next=5,(0,r.call)(o.createSnippet,e);case 5:return t=n.sent,n.next=8,(0,r.put)((0,i.createdNewSnippet)(t));case 8:case"end":return n.stop()}}),l)}function M(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,r.select)(P);case 2:return e=t.sent,t.next=5,(0,r.call)(o.updateSnippet,e);case 5:return t.next=7,(0,r.put)((0,i.updatedExistingSnippet)(e));case 7:case"end":return t.stop()}}),c)}function $(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,r.select)(P);case 2:if(!e.sent.uuid){e.next=8;break}return e.next=6,(0,r.fork)(M);case 6:e.next=10;break;case 8:return e.next=10,(0,r.fork)(j);case 10:case"end":return e.stop()}}),d)}function T(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,r.takeEvery)("SAVE_SNIPPET",$);case 2:case"end":return e.stop()}}),f)}function I(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,r.call)(o.getSnippets);case 2:return e=t.sent,t.next=5,(0,r.put)((0,i.receiveSnippets)(e));case 5:case"end":return t.stop()}}),p)}function D(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,r.takeEvery)("REQUEST_SNIPPETS",I);case 2:case"end":return e.stop()}}),h)}function L(e){var t,n;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return t=e.editor,n=e.snippet,i.next=3,(0,r.call)(a.insertSnippetToEditor,n,t);case 3:case"end":return i.stop()}}),m)}function N(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,r.takeEvery)("INSERT_SNIPPET",L);case 2:case"end":return e.stop()}}),v)}var R=function(e){return e.selectedSnippet};function A(e){var t,n;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,(0,r.select)(R);case 2:if(!(t=o.sent)){o.next=9;break}return n=e.editor,o.next=7,(0,r.call)(a.insertSnippetToEditor,t,n);case 7:return o.next=9,(0,r.put)((0,i.setSelectedSnippet)(null));case 9:case"end":return o.stop()}}),g)}function B(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,r.takeEvery)("INSERT_SELECTED_SNIPPET",A);case 2:case"end":return e.stop()}}),b)}function F(e){var t,n;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return t=e.editor,o.next=3,(0,r.call)(a.extractSelectionFromEditor,t);case 3:return n=o.sent,o.next=6,(0,r.put)((0,i.setEditingSnippet)({body:n,isSaving:!1,title:"",uuid:void 0}));case 6:case"end":return o.stop()}}),y)}function U(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,r.takeEvery)("EXTRACT_SELECTION_TO_SNIPPET",F);case 2:case"end":return e.stop()}}),_)}function W(e){var t;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.editor,t=e.snippet,n.next=3,(0,r.put)((0,i.setEditingSnippet)({body:t.body,isSaving:!1,title:t.title,uuid:t.uuid}));case 3:case"end":return n.stop()}}),w)}function H(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,r.takeEvery)("OPEN_SNIPPET_EDITING_MODAL",W);case 2:case"end":return e.stop()}}),E)}function z(){var e,t,n,o;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,r.put)((0,i.initializeState)());case 2:return a.next=4,(0,r.call)((function(){return k.get("editor.entryOption").canManageSnippets}));case 4:return e=a.sent,a.next=7,(0,r.put)((0,i.setCanManageSnippets)(e));case 7:return a.next=9,(0,r.call)((function(){return k.get("editor.entryOption").snippetCountLimit}));case 9:return t=a.sent,a.next=12,(0,r.put)((0,i.setSnippetCountLimit)(t));case 12:return a.next=14,(0,r.call)((function(){return k.get("editor.entryOption").snippetTitleLengthLimit}));case 14:return n=a.sent,a.next=17,(0,r.put)((0,i.setTitleLengthLimit)(n));case 17:return a.next=19,(0,r.call)((function(){return k.get("editor.entryOption").snippetBodyLengthLimit}));case 19:return o=a.sent,a.next=22,(0,r.put)((0,i.setBodyLengthLimit)(o));case 22:return a.next=24,(0,r.put)((0,i.requestSnippets)());case 24:case"end":return a.stop()}}),S)}function q(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,r.fork)(z);case 2:return e.next=4,(0,r.fork)(D);case 4:return e.next=6,(0,r.fork)(T);case 6:return e.next=8,(0,r.fork)(x);case 8:return e.next=10,(0,r.fork)(B);case 10:return e.next=12,(0,r.fork)(N);case 12:return e.next=14,(0,r.fork)(U);case 14:return e.next=16,(0,r.fork)(H);case 16:case"end":return e.stop()}}),C)}},71717:function(e,t,n){t.__esModule=!0,t.isSavable=t.validateBody=t.validateTitle=void 0;var r=n(96341),i=function(e,t){return(0,r.characterLength)(e)<=t?"OK":"TOO_LONG"};t.validateTitle=i;var o=function(e,t){return 0===(0,r.characterLength)(e)?"EMPTY":(0,r.characterLength)(e)<=t?"OK":"TOO_LONG"};t.validateBody=o;t.isSavable=function(e,t,n){return"OK"===i(e.title,t)&&"OK"===o(e.body,n)}},89673:function(e,t,n){t.__esModule=!0,t.EditTagButton=void 0;var r=o(n(67294)),i=o(n(20996));function o(e){return e&&e.__esModule?e:{default:e}}t.EditTagButton=function(e){var t=e.onButtonClick;return r.default.createElement("button",{type:"button",className:"btn editor-tag-editor_editTag",onClick:t},i.default.text("admin.edit.tag.add_tag"))}},64027:function(e,t,n){t.__esModule=!0,t.FooterTagsList=void 0,n(21249);var r,i=(r=n(67294))&&r.__esModule?r:{default:r};t.FooterTagsList=function(e){var t=e.tags,n=e.onClick;return i.default.createElement("ul",{className:"editor-tag-editor_tag-list",onClick:n},t.map((function(e){return i.default.createElement("li",{key:e},"#",e)})))}},33307:function(e,t,n){t.__esModule=!0,t.FormElementsToBeSubmitted=void 0,n(21249);var r,i=(r=n(67294))&&r.__esModule?r:{default:r};t.FormElementsToBeSubmitted=function(e){var t=e.tagNames;return i.default.createElement(i.default.Fragment,null,i.default.createElement("input",{type:"hidden",name:"should_update_kotoba_tags",value:"1"}),t.map((function(e){return i.default.createElement("input",{type:"hidden",name:"kotoba_tag_name",value:e,key:e})})))}},7070:function(e,t,n){t.__esModule=!0,t.OshiraseModalInner=void 0;var r=o(n(67294)),i=o(n(20996));function o(e){return e&&e.__esModule?e:{default:e}}t.OshiraseModalInner=function(e){var t=e.onClickContinue;return r.default.createElement(r.default.Fragment,null,r.default.createElement("div",{className:"oshirase-tag-guide"},r.default.createElement("div",{className:"header"},r.default.createElement("span",null,i.default.text("epic.new_feature")),r.default.createElement("h2",null,i.default.text("epic.kotoba_modal.desc.heading")),r.default.createElement("p",null,r.default.createElement("strong",null,i.default.text("epic.kotoba_modal.desc.1")),i.default.text("epic.kotoba_modal.desc.2"),r.default.createElement("br",null),i.default.text("epic.kotoba_modal.desc.3"))),r.default.createElement("button",{type:"button",onClick:t,className:"btn btn-primary","aria-label":i.default.text("epic.try_use")},i.default.text("epic.try_use")),r.default.createElement("a",{href:"https://staff.hatenablog.com/entry/about-tag-guide",className:"about-tag-link",target:"_blank",rel:"noopener"},i.default.text("epic.show_detail"))))}},62728:function(e,t,n){t.__esModule=!0,t.OshirasePopOver=void 0;var r=o(n(67294)),i=o(n(20996));function o(e){return e&&e.__esModule?e:{default:e}}t.OshirasePopOver=function(e){var t=e.onDismiss;return r.default.createElement("div",{className:"editor-tag-editor_popover popover-bottom-left"},r.default.createElement("p",null,i.default.text("admin.edit.tag.desc")),r.default.createElement("div",{className:"popover-button"},r.default.createElement("button",{type:"button",className:"btn btn-ghost btn-ghost-wh",onClick:t,"aria-label":i.default.text("close")},"OK")))}},85993:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.SortableTag=void 0;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=i(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=o?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(67294));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(i=function(e){return e?n:t})(e)}var o=(0,n(4205).SortableElement)((function(e){var t=e.tag,n=e.onClickRemoveBtn;return r.createElement("div",{className:"editor-tag-editor_sortableTag","data-category-name":t},r.createElement("span",{className:"name"},"#",t),r.createElement("button",{type:"button",className:"RemoveBtn",onClick:n},r.createElement("i",{className:"blogicon-close"})),r.createElement("input",{type:"hidden",name:"tag",value:t,"data-with-backup":!0}))}));t.SortableTag=o},13483:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.SortableTags=void 0,n(21249);var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),i=n(4205),o=n(85993);function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}var s=(0,i.SortableContainer)((function(e){var t=e.tags,n=e.onClickRemoveBtn;return r.createElement("div",{className:"editor-tag-editor_sortableTags"},t.map((function(e,t){return r.createElement(o.SortableTag,{key:t+"-"+e,index:t,tag:e,onClickRemoveBtn:function(){return n(t)}})})))}));t.SortableTags=s},99507:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.TagEditor=void 0;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=m(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),i=n(89673),o=h(n(83253)),a=n(74622),s=n(64027),u=h(n(20996)),l=n(33307),c=n(7070),d=n(62728),f=n(25680),p=n(55992);function h(e){return e&&e.__esModule?e:{default:e}}function m(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(m=function(e){return e?n:t})(e)}t.TagEditor=function(e){var t=e.appElement,n=e.initialTags,h=e.maxTagCountPerEntry,m=e.maxTagNameLength,v=(0,r.useState)(!1),g=v[0],b=v[1],y=(0,r.useState)(!1),_=y[0],w=y[1],E=(0,f.useStateWithConfigStorage)("tag-editor-modal-oshirase-seen",!1),S=E[0],C=E[1],k=(0,f.useStateWithConfigStorage)("tag-editor-oshirase-popup-dismissed",!1),O=k[0],x=k[1],P=(0,r.useState)(n),j=P[0],M=P[1],$=function(){return b(!1)},T=function(){return b(!0)};return o.default.setAppElement(t),r.default.createElement("div",{className:"editor-tag-editor_wrapper"},r.default.createElement("div",{className:"editor-tag-editor_popover-wrapper"},!O&&r.default.createElement(d.OshirasePopOver,{onDismiss:function(){x(!0)}}),r.default.createElement(i.EditTagButton,{onButtonClick:function(){S?T():w(!0)}})),r.default.createElement(s.FooterTagsList,{tags:j,onClick:T}),r.default.createElement(l.FormElementsToBeSubmitted,{tagNames:j}),r.default.createElement(o.default,{isOpen:_,onRequestClose:function(){return w(!1)},className:"editor-tag-editor_modal oshirase-tag-guide_modal",overlayClassName:"editor-tag-editor_overlay"},r.default.createElement(c.OshiraseModalInner,{onClickContinue:function(){C(!0),w(!1),b(!0)}})),r.default.createElement(o.default,{isOpen:g,onRequestClose:$,className:"editor-tag-editor_modal",overlayClassName:"editor-tag-editor_overlay"},r.default.createElement(a.TagEditorModalInner,{tags:j,setTags:M,maxTagNameLength:m,maxTagCountPerEntry:h}),r.default.createElement("button",{className:"editor-tag-editor_close","aria-label":u.default.text("close"),onClick:$,type:"button"},r.default.createElement("img",{src:(0,p.staticUrl)("/images/admin/close.svg"),alt:u.default.text("close")}))))}},74622:function(e,t,n){t.__esModule=!0,t.TagEditorModalInner=void 0;var r=s(n(67294)),i=s(n(20996)),o=n(94054),a=n(55992);function s(e){return e&&e.__esModule?e:{default:e}}t.TagEditorModalInner=function(e){var t=e.tags,n=e.setTags,s=e.maxTagNameLength,u=e.maxTagCountPerEntry;return r.default.createElement("div",{className:"editor-tag-editor"},r.default.createElement("div",{className:"header"},r.default.createElement("h2",null,i.default.text("admin.edit.tag.edit_tag.heading")),r.default.createElement("p",null,i.default.text("admin.edit.tag.edit_tag.description"))),r.default.createElement(o.TagsListInput,{tags:t,setTags:n,maxTagNameLength:s,maxTagCountPerEntry:u}),r.default.createElement("aside",{className:"hints"},r.default.createElement("h3",null,i.default.text("admin.edit.tag.hints")),r.default.createElement("ul",null,r.default.createElement("li",null,i.default.text("admin.edit.tag.hints.tag_content")),r.default.createElement("li",null,i.default.text("admin.edit.tag.hints.number_of_tags")),r.default.createElement("li",null,r.default.createElement("a",{href:(0,a.helpUrl)("/entry/tag-guideline"),target:"_blank",rel:"noopener"},i.default.text("admin.edit.tag.hints.guideline.with_link")),i.default.text("admin.edit.tag.hints.guideline")))))}},94054:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.TagsListInput=void 0,n(34553),n(92222),n(40561),n(47042);var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=f(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),i=n(4205),o=d(n(26307)),a=d(n(20996)),s=n(41205),u=n(13483),l=n(2403),c=n(62420);function d(e){return e&&e.__esModule?e:{default:e}}function f(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(f=function(e){return e?n:t})(e)}t.TagsListInput=function(e){var t=e.tags,n=e.setTags,d=e.maxTagNameLength,f=e.maxTagCountPerEntry,p=r.default.useRef(null),h=function(e){var t=e.maxTagCountPerEntry,n=e.maxTagNameLength,i=e.tags,o=(0,r.useState)(""),s=o[0],u=o[1],l=(0,r.useState)([]),c=l[0],d=l[1],f=i.length<t,p=(0,r.useState)(),h=p[0],m=p[1];return(0,r.useEffect)((function(){f?s.length>n?m(a.default.text("epic.kotoba.max_tag_name_length",n)):m(void 0):m(a.default.text("epic.kotoba.max_tags_per_entry",t))}),[i,s,f,t,n]),{setInputValue:u,suggestions:c,setSuggestions:d,error:h,canAddMoreTags:f}}({maxTagCountPerEntry:f,maxTagNameLength:d,tags:t}),m=h.setInputValue,v=h.suggestions,g=h.setSuggestions,b=h.error,y=h.canAddMoreTags,_=r.default.useRef(null);return r.default.createElement(r.default.Fragment,null,b&&r.default.createElement(c.ValidationError,{error:b}),r.default.createElement("div",{className:"tagsListInput",onClick:function(){var e,t;return null===(e=p.current)||void 0===e||null===(t=e.input)||void 0===t?void 0:t.focus()},ref:_},r.default.createElement(u.SortableTags,{tags:t,onClickRemoveBtn:function(e){var r=[].concat(t);r.splice(e,1),n(r)},onSortStart:function(){o.default.on()},onSortEnd:function(e){var r=e.oldIndex,a=e.newIndex;n((0,i.arrayMove)(t,r,a)),o.default.off()},helperClass:"sortableHelper",axis:"xy",distance:5}),y&&r.default.createElement(s.AutoCompleteInput,{ref:p,inputProps:{className:"input",autoComplete:"off",placeholder:a.default.text("admin.edit.tag.input.placeholder")},suggestions:v,onSubmit:function(e){e.length>d||(!function(e){var r=t.findIndex((function(t){return t===e}));if(-1===r)n([].concat(t,[e]));else if(r===t.length-1);else{var i=[].concat(t);i.splice(r,1),n([].concat(i,[e]))}}(e),p.current&&p.current.reset())},onCancel:function(){return n(t.slice(0,-1))},onChangeValue:function(e){var t;m(e),t=e,(0,l.getTagSuggestionsForInput)(t).then((function(e){g(e),p.current&&p.current.updateSuggestionList()}))},filter:!1,inputPrefix:"#",getSuggestionsListBaseRect:function(){var e;return null===(e=_.current)||void 0===e?void 0:e.getBoundingClientRect()}})))}},62420:function(e,t,n){t.__esModule=!0,t.ValidationError=void 0;var r,i=(r=n(67294))&&r.__esModule?r:{default:r};t.ValidationError=function(e){var t=e.error;return i.default.createElement("div",{className:"alert-box"},t)}},2403:function(e,t,n){t.__esModule=!0,t.getTagSuggestionsForInput=void 0,n(88674),n(41539),n(4723),n(74916),n(21249),n(68309);var r,i=n(96341),o=(r=n(347))&&r.__esModule?r:{default:r};var a=n(91269),s="",u=Promise.resolve([]);t.getTagSuggestionsForInput=function(e){var t=e.match(/^(.*[^A-Za-z\uFF21-\uFF3A\uFF41-\uFF5A])[A-Za-z\uFF21-\uFF3A\uFF41-\uFF5A]{1,3}$/),n=t?t[1]:e;if((0,i.characterLength)(n)<=1)return Promise.resolve([]);if(n===s)return u;var r=a.get("editor.tags.graphqlUrl"),l=a.get("editor.tags.queryApiKey"),c=o.default.post(r,{query:"\n        query TagSuggestionQuery($nameHint: String!) {\n          suggestedTags(nameHint: $nameHint) {\n            nodes {\n              name\n            }\n          }\n        }\n      ",variables:{nameHint:n}},{headers:{Authorization:"Bearer "+l}}).then((function(e){return e.data.data.suggestedTags.nodes.map((function(e){return e.name}))}));return s=n,u=c,c}},16686:function(e,t,n){t.__esModule=!0,t.initTagEditor=void 0;var r,i=(r=n(67294))&&r.__esModule?r:{default:r},o=n(73380),a=n(99507);var s=n(91269);t.initTagEditor=function(e,t){var n=s.get("editor.associatedTags")||[],r=s.get("editor.maxTagNameLength"),u=s.get("editor.maxTagCountPerEntry");(0,o.safeRender)(i.default.createElement(a.TagEditor,{appElement:t,initialTags:n,maxTagNameLength:r,maxTagCountPerEntry:u}),e)}},42740:function(e,t,n){n(4129),n(38880),t.__esModule=!0,t.Twitter=void 0,n(35666),n(51532),n(41539),n(78783),n(66992),n(33948),n(70189),n(69826),n(54747),n(69600),n(21249),n(15306),n(74916),n(88674);var r=c(n(73609)),i=c(n(13469)),o=c(n(30381)),a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=l(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(55992)),s=c(n(37119)),u=n(10714);function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(l=function(e){return e?n:t})(e)}function c(e){return e&&e.__esModule?e:{default:e}}function d(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function f(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){d(o,r,i,a,s,"next",e)}function s(e){d(o,r,i,a,s,"throw",e)}a(void 0)}))}}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h=n(81191).trackEvent,m=new Map,v=function(){function e(e){if(p(this,"pasteReverseOrder",void 0),p(this,"type",void 0),p(this,"ajaxGetOrCacheCache",void 0),p(this,"$container",void 0),p(this,"$itemsContainer",void 0),p(this,"$indicator",void 0),p(this,"itemTemplate",void 0),p(this,"$pasteButton",void 0),p(this,"$listTypeContainer",void 0),p(this,"$formatsContainer",void 0),p(this,"$reloadButton",void 0),p(this,"$errorMessage",void 0),p(this,"$detailOnlyMessage",void 0),p(this,"$header",void 0),p(this,"$footer",void 0),p(this,"sidebar",void 0),p(this,"selectedTweetIDs",void 0),p(this,"listType","tweets"),p(this,"isLoading",!1),this.pasteReverseOrder=!0,this.type="editor-twitter",this.ajaxGetOrCacheCache=m,this.selectedTweetIDs=new Set,this.$container=e.$container,this.$container.length<=0)throw new Error("container has no elements");this.$itemsContainer=this.$container.find(".twitter-items"),this.$indicator=this.$container.find(".indicator"),this.itemTemplate=i.default.template((0,r.default)(".twitter-item-template").html()),this.$pasteButton=this.$container.find(".twitter-paste-button"),this.$listTypeContainer=this.$container.find(".twitter-list-type-container"),this.$formatsContainer=this.$container.find(".twitter-formats"),this.$reloadButton=this.$container.find(".reload"),this.$errorMessage=this.$container.find(".error"),this.$detailOnlyMessage=this.$container.find(".twitter-formats-detail-only"),this.$header=this.$container.find(".twitter-header"),this.$footer=this.$container.find(".twitter-footer"),this.sidebar=e.sidebar,this.bindEvents(),this.resize(),this.loadTweets()}var t=e.prototype;return t.bindEvents=function(){var e=this,t=function(t){t===e.type&&(e.resize(),e.loadTweets())};this.sidebar.on("resize",t),this.sidebar.on("tabChange",t),this.$itemsContainer.on("click",".twitter-item",(function(t){var n=(0,r.default)(t.currentTarget),i=n.attr("data-id-str");(0,r.default)(t.target).closest("a").length||n.hasClass("private")||e.toggleSelectTweet(i)})),this.$container.on("dblclick",".twitter-item",(function(t){var n=(0,r.default)(t.currentTarget),i=n.attr("data-id-str");(0,r.default)(t.target).closest("a").length||n.hasClass("private")||(e.insertSyntaxes([{id_str:i,screen_name:n.attr("data-screen-name"),text:n.attr("data-text")}]),e.deselectTweet(i),h(e.$pasteButton.attr("data-track-name")),t.stopPropagation(),t.preventDefault())})),this.$pasteButton.on("click",(function(){var t=[];e.selectedTweetIDs.forEach((function(n){var r=e.$itemsContainer.find('[data-id-str="'+n+'"]');t.push({id_str:n,screen_name:r.attr("data-screen-name"),text:r.attr("data-text"),created_at:r.attr("data-created-at")})})),t.sort((function(e,t){return(0,o.default)(e.created_at).diff(t.created_at)})),e.insertSyntaxes(t),e.clearSelectedTweet()})),this.$listTypeContainer.on("change","input",(function(t){var n=(0,r.default)(t.currentTarget);e.getListType()!==n.val()&&(e.setListType(n.val()),e.$listTypeContainer.find("label.selected").removeClass("selected"),n.closest("label").addClass("selected"),e.loadTweets(),e.clearSelectedTweet())})),(0,s.default)({$container:this.$formatsContainer,key:"twitter-format",onchange:function(t){e.$formatsContainer.find("label.selected").removeClass("selected"),t.closest("label").addClass("selected")}}),(0,s.default)({$container:this.$listTypeContainer,key:"twitter-list-type",onchange:function(t){e.setListType(t.val()),e.$listTypeContainer.find("label.selected").removeClass("selected"),t.closest("label").addClass("selected"),e.loadTweets(),e.clearSelectedTweet(),"tweets"===t.val()?(e.$formatsContainer.css("visibility","visible"),e.$detailOnlyMessage.hide()):(e.$formatsContainer.css("visibility","hidden"),e.$detailOnlyMessage.show())}}),this.$reloadButton.on("click",(function(){e.loadTweets(null,!0)})),this.$itemsContainer.on("scroll",i.default.throttle((function(){(e.$itemsContainer.scrollTop()+e.$itemsContainer.height())/e.$itemsContainer[0].scrollHeight>.7&&e.loadMore()}),100))},t.resize=function(){var e=(0,r.default)(window).height(),t=0;t+=parseFloat(this.$itemsContainer.css("padding-top"))||0,t+=parseFloat(this.$itemsContainer.css("padding-bottom"))||0;var n=this.$container.offset();void 0!==n&&this.$itemsContainer.height(e-n.top-this.$header.outerHeight(!0)-this.$footer.outerHeight(!0)-t)},t.setListType=function(e){/^(tweets|favorites|timeline)$/.test(e)&&(this.listType=e)},t.getListType=function(){return this.listType},t.selectTweet=function(e){this.selectedTweetIDs.add(e),this.selectedItemsChanged()},t.deselectTweet=function(e){this.selectedTweetIDs.delete(e),this.selectedItemsChanged()},t.toggleSelectTweet=function(e){this.isSelectedTweet(e)?this.deselectTweet(e):this.selectTweet(e)},t.isSelectedTweet=function(e){return this.selectedTweetIDs.has(e)},t.clearSelectedTweet=function(){this.selectedTweetIDs.clear(),this.selectedItemsChanged()},t.selectedItemsChanged=function(){this.selectedTweetIDs.size>0?this.$pasteButton.removeClass("disabled").addClass("enabled").prop("disabled",!1):this.$pasteButton.removeClass("enabled").addClass("disabled").prop("disabled",!0),this.markSelectedItems()},t.markSelectedItems=function(){var e=this;0!==this.selectedTweetIDs.size?this.$itemsContainer.find(".twitter-item").each((function(t,n){var i=(0,r.default)(n),o=i.attr("data-id-str");e.isSelectedTweet(o)?i.addClass("selected"):i.removeClass("selected")})):this.$itemsContainer.find(".twitter-item.selected").removeClass("selected")},t.loadTweets=function(){var e=f(regeneratorRuntime.mark((function e(t,n){var r,o,s,u=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isLoading){e.next=2;break}return e.abrupt("return");case 2:if(this.$container.is(":visible")){e.next=4;break}return e.abrupt("return");case 4:return this.isLoading=!0,this.$indicator.show(),t||this.$itemsContainer.find(".twitter-item").remove(),r=this.getListType(),o=a.protocolRelativeAdminUrl("/api/twitter/"+r+(t?"?max_id="+t:"")),e.prev=9,e.next=12,this.ajaxGetOrCache(o,n);case 12:if(s=e.sent,this.getListType()===r){e.next=16;break}return i.default.defer((function(){u.loadTweets()})),e.abrupt("return");case 16:t&&s.shift(),n&&this.clearSelectedTweet(),this.showItems(s),this.$errorMessage.hide(),e.next=25;break;case 22:e.prev=22,e.t0=e.catch(9),this.$errorMessage.show();case 25:return e.prev=25,this.$indicator.hide(),this.isLoading=!1,e.finish(25);case 29:case"end":return e.stop()}}),e,this,[[9,22,25,29]])})));return function(t,n){return e.apply(this,arguments)}}(),t.showItems=function(e){var t=this;e.forEach((function(e){e.text=i.default.unescape(e.text)}));var n=e.map((function(e){return t.itemTemplate({item:e})})).join("");this.$indicator.before(n),this.markSelectedItems()},t.loadMore=function(){var e=this.$itemsContainer.find(".twitter-item:last");if(e.length){var t=e.attr("data-id-str");this.loadTweets(t)}},t.insertSyntaxes=function(e){var t=this,n=this.getFormat(),r=[],i=[];e.forEach((function(e){var o=t.createSyntax(e,n,!1);o&&r.push(o);var a=t.createSyntax(e,n,!0);a&&i.push(a)})),u.EditorConnector.insertLines({html:r,hatena:r,markdown:i})},t.createSyntax=function(e,t,n){if("detail"===t){var r=e.screen_name;n&&(r=r.replace(/_(.*?)_/g,"\\_$1\\_"));var i=e.text;return i=i.replace(/[[\]\n]/g,"").replace(/([*`_])/g,"\\$1"),"[https://twitter.com/"+r+"/status/"+e.id_str+":embed#"+i+"]"}return"text"===t?e.text:void 0},t.getFormat=function(){return"tweets"===this.getListType()?this.$container.find('[name="twitter-format"]:checked').val():"detail"},t.ajaxGetOrCache=function(){var e=f(regeneratorRuntime.mark((function e(t,n){var i,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n||!this.ajaxGetOrCacheCache.has(t)){e.next=3;break}return i=this.ajaxGetOrCacheCache.get(t),e.abrupt("return",Promise.resolve(i));case 3:return e.abrupt("return",new Promise((function(e,n){r.default.ajax({url:t}).done((function(n){o.ajaxGetOrCacheCache.set(t,n),e(n)})).fail((function(){n()}))})));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),e}();t.Twitter=v},95594:function(e,t,n){t.__esModule=!0,t.Item=void 0;var r=a(n(67294)),i=a(n(20996)),o=n(74868);function a(e){return e&&e.__esModule?e:{default:e}}t.Item=function(e){var t=e.item.thumbnails.medium;return r.default.createElement("div",{className:"editor-youtube_item item "+(e.isSelected?"selected":""),tabIndex:0,onClick:e.onClick,onDoubleClick:e.onDoubleClick,onKeyPress:e.onKeyPress},r.default.createElement("div",{className:"thumbnail-wrapper"},r.default.createElement("img",{className:"thumbnail",src:t.url,width:t.width,height:t.height,alt:""}),r.default.createElement("span",{className:"duration"},(0,o.formatDuration)(e.item.duration))),r.default.createElement("div",{className:"info-container"},r.default.createElement("p",{className:"title"},e.item.title),r.default.createElement("p",{className:"channel-title"},e.item.channelTitle),r.default.createElement("span",{className:"views"},i.default.textN("edit_form.youtube.view_count",e.item.viewCount,i.default.formatNumber(e.item.viewCount))),r.default.createElement("span",{className:"published-at"},i.default.deltaDatetime(e.item.publishedAt))))}},83369:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.YouTubeSidebar=void 0,n(64765),n(74916),n(21249),n(26699),n(32023);var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=f(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294)),i=d(n(20996)),o=n(46171),a=d(n(70881)),s=n(90381),u=n(82523),l=d(n(9825)),c=n(95594);function d(e){return e&&e.__esModule?e:{default:e}}function f(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(f=function(e){return e?n:t})(e)}t.YouTubeSidebar=function(){var e=(0,u.useYouTubeVideoSearch)(20),t=e.videos,n=e.selectedVideoIds,d=e.error,f=e.isInitial,p=e.isLoading,h=e.search,m=e.loadMore,v=e.toggleVideoSelection,g=e.insertVideo,b=e.insertVideos,y=(0,r.useCallback)((function(e,t){"RET"===keyString(e.nativeEvent)&&(e.preventDefault(),v(t))}),[v]);return r.default.createElement("div",{className:"editor-youtube-content"},r.default.createElement("div",{className:"editor-youtube-header"},r.default.createElement("h2",null,i.default.text("edit_form.youtube")),r.default.createElement(a.default,{placeholder:i.default.text("edit_form.youtube.placeholder"),onSubmit:h})),r.default.createElement("div",{className:"editor-youtube-main"},r.default.createElement(o.InfiniteScroll,{onScroll:m,interval:1e3},r.default.createElement("div",{className:"editor-youtube-items"},f&&r.default.createElement("div",{className:"editor-youtube-items-message"},i.default.text("edit_form.youtube.description")),t&&t.map((function(e){return r.default.createElement(c.Item,{key:e.id,item:e,isSelected:n.includes(e.id),onClick:function(){return v(e.id)},onDoubleClick:function(){return g(e)},onKeyPress:function(t){return y(t,e.id)}})})),!(f||p||d)&&0===t.length&&r.default.createElement("div",{className:"editor-youtube-items-message"},i.default.text("edit_form.youtube.not_found")),p&&r.default.createElement(s.LoadingIndicator,null),d&&r.default.createElement("div",{className:"editor-youtube-items-message"},i.default.text("edit_form.youtube.failed_to_fetch"),r.default.createElement("br",null),i.default.text("edit_form.youtube.failed_to_fetch_details")," ",r.default.createElement("a",{href:"https://www.youtube.com/",target:"_blank"},i.default.text("edit_form.youtube.go_to_youtube")))))),r.default.createElement("div",{className:"editor-sidebar-youtube_footer"},r.default.createElement(l.default,{disabled:0===n.length,onClick:b})))}},13334:function(e,t,n){t.__esModule=!0,t.searchVideos=void 0,n(35666),n(21249),n(19601),n(88674),n(41539);var r,i=(r=n(347))&&r.__esModule?r:{default:r};function o(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}var a=function(){var e,t=(e=regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",i.default.get("/api/youtube/search",{params:{query:t,page_size:n,page_token:r},responseType:"json"}).then((function(e){return{videos:e.data.videos.map((function(e){return Object.assign({},e,{channelTitle:e.channel_title,publishedAt:new Date(e.published_at),viewCount:e.view_count})})),nextPageToken:e.data.next_page_token}})));case 1:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function s(e){o(a,r,i,s,u,"next",e)}function u(e){o(a,r,i,s,u,"throw",e)}s(void 0)}))});return function(e,n,r){return t.apply(this,arguments)}}();t.searchVideos=a},82523:function(e,t,n){n(47042),n(68309),n(91038),n(82526),n(41817),n(32165),t.__esModule=!0,t.useYouTubeVideoSearch=void 0,n(70189),n(41539),n(78783),n(66992),n(33948),n(21249),n(57327),n(92222),n(26699),n(32023);var r=n(67294),i=n(13334),o=n(13297);function a(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var u=n(81191);t.useYouTubeVideoSearch=function(e){var t=(0,r.useState)(""),n=t[0],s=t[1],l=(0,r.useState)([]),c=l[0],d=l[1],f=(0,r.useRef)(new Set),p=(0,r.useState)([]),h=p[0],m=p[1],v=(0,r.useState)(null),g=v[0],b=v[1],y=(0,r.useState)(!0),_=y[0],w=y[1],E=(0,r.useState)(!1),S=E[0],C=E[1],k=(0,r.useRef)(null),O=(0,r.useCallback)((function(t){s(t),w(!1),C(!0),d([]),m([]),b(null),(0,i.searchVideos)(t,e).then((function(e){k.current=e.nextPageToken,C(!1),d(e.videos),f.current=new Set(e.videos.map((function(e){return e.id}))),b(null)})).catch((function(e){C(!1),b(e),u.trackEvent("curation-youtube-search-failed")})),u.trackEvent("curation-youtube-search")}),[e]),x=(0,r.useCallback)((function(){k.current&&!S&&(C(!0),(0,i.searchVideos)(n,e,k.current).then((function(e){k.current=e.nextPageToken,C(!1),d((function(t){for(var n,r=e.videos.filter((function(e){return!f.current.has(e.id)})),i=a(r);!(n=i()).done;){var o=n.value;f.current.add(o.id)}return t.concat(r)})),b(null)})).catch((function(e){C(!1),b(e),u.trackEvent("curation-youtube-load-more-failed")})),u.trackEvent("curation-youtube-load-more"))}),[S,n,e]),P=(0,r.useCallback)((function(e){(0,o.insertVideo)(e)}),[]),j=(0,r.useCallback)((function(){(0,o.insertVideos)(c,h),m([])}),[c,h]);return{videos:c,selectedVideoIds:h,error:g,isInitial:_,isLoading:S,search:O,loadMore:x,toggleVideoSelection:function(e){m((function(t){return t.includes(e)?t.filter((function(t){return t!==e})):[].concat(t,[e])}))},insertVideo:P,insertVideos:j}}},84525:function(e,t,n){t.__esModule=!0,t.YouTube=void 0;var r,i=(r=n(67294))&&r.__esModule?r:{default:r},o=n(73380),a=n(83369);t.YouTube=function(e){(0,o.safeRender)(i.default.createElement(a.YouTubeSidebar,null),e)}},13297:function(e,t,n){n(47042),n(41539),n(68309),n(91038),n(78783),n(82526),n(41817),n(32165),n(66992),n(33948),t.__esModule=!0,t.insertVideos=t.insertVideo=void 0,n(21249);var r,i=(r=n(13469))&&r.__esModule?r:{default:r},o=n(57525),a=n(10714);function s(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var l=n(81191),c=function(e){var t="https://www.youtube.com/watch?v="+e.id,n="https://www.youtube.com/embed/"+e.id+"?enablejsapi=1";return'<iframe src="'+i.default.escape(n)+'" width="560" height="315" frameborder="0" allowfullscreen></iframe><br><a href="'+i.default.escape(t)+'">www.youtube.com</a>'};t.insertVideo=function(e){var t=[c(e)];a.EditorConnector.insertLines({html:t,hatena:t,markdown:t}),o.YouTubeEmbed.updatePlayers(),l.trackEvent("curation-youtube-insert-item")};t.insertVideos=function(e,t){for(var n,r={},i=s(e);!(n=i()).done;){var u=n.value;r[u.id]=u}var d=t.map((function(e){return c(r[e])}));a.EditorConnector.insertLines({html:d,hatena:d,markdown:d}),o.YouTubeEmbed.updatePlayers(),l.trackEvent("curation-youtube-insert-item")}},77102:function(e,t,n){t.__esModule=!0,t.Dropdown=void 0;var r,i=(r=n(73609))&&r.__esModule?r:{default:r};function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a=(0,i.default)("<div>").css({position:"fixed",top:0,left:0,width:"100%",height:"100%"});a.hide().appendTo(document.body),a.on("click",(function(e){a.hide();var t=document.elementFromPoint(e.pageX,e.pageY);null!==t&&(0,i.default)(t).click()}));var s=function(){function e(e,t){o(this,"$element",void 0),o(this,"$window",void 0),this.$element=e,this.$window=t,this.bindEvents()}var t=e.prototype;return t.bindEvents=function(){var e=this,t=function t(){e.$window.hide(),a.off("click",t)};this.$element.on("click",(function(n){n.preventDefault(),e.setPosition(),a.show(),e.$window.show(),a.on("click",t)})),this.$window.on("click",(function(){e.$window.hide(),a.hide()}))},t.setPosition=function(){var e=this.$element[0].getBoundingClientRect();this.$window.css({top:e.bottom,left:e.left})},e}();t.Dropdown=s},79751:function(e,t,n){n(4129),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.Editor=void 0,n(41539),n(39714),n(69826),n(73210),n(21249),n(64765),n(74916),n(23123),n(68309),n(15306);var r=n(17187),i=D(n(80129)),o=D(n(73609)),a=D(n(13469)),s=D(n(20996)),u=n(70879),l=I(n(55992)),c=D(n(83092)),d=D(n(64722)),f=n(89172),p=D(n(20246)),h=D(n(42585)),m=n(10714),v=n(85387),g=n(98960),b=n(77102),y=n(48881),_=n(19864),w=I(n(35961)),E=n(22117),S=n(73861),C=n(30189),k=n(43265),O=n(42740),x=n(30871),P=n(7902),j=n(40555),M=n(57833),$=n(84525);function T(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(T=function(e){return e?n:t})(e)}function I(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=T(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}function D(e){return e&&e.__esModule?e:{default:e}}function L(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function N(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function R(e,t){return(R=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function A(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var B=n(59662),F=n(41960),U=n(63488),W=n(84145),H=n(86585),z=n(83902),q=n(55540),G=n(86795),V=n(20489),K=n(31427),Q=n(16907),Y=n(90036),J=n(84540),X=n(72069),Z=n(52570),ee=n(35227),te=n(72461),ne=n(90542),re=function(e){var t,n;function r(t){var n;A(N(n=e.call(this)||this),"URLPattern",void 0),A(N(n),"id",void 0),A(N(n),"$form",void 0),A(N(n),"$editor",void 0),A(N(n),"$title",void 0),A(N(n),"$body",void 0),A(N(n),"$tabs",void 0),A(N(n),"$toolbar",void 0),A(N(n),"$subToolbar",void 0),A(N(n),"$preview",void 0),A(N(n),"$buttons",void 0),A(N(n),"$entryId",void 0),A(N(n),"$syntax",void 0),A(N(n),"$publicationType",void 0),A(N(n),"mode",void 0),A(N(n),"actions",void 0),A(N(n),"isSavingDraft",void 0),A(N(n),"$editarea",void 0),A(N(n),"$editareaHover",void 0),A(N(n),"backup",void 0),A(N(n),"tabs",void 0),A(N(n),"shareDraft",void 0),A(N(n),"preview",void 0),A(N(n),"previewDropdown",void 0),A(N(n),"syntaxSwitcher",void 0),A(N(n),"footer",void 0),A(N(n),"sidebar",void 0),A(N(n),"rakuten",void 0),n.URLPattern=/^https?:\/\/\S+$/;var r=Math.random().toString(32).substring(2);return n.id="editor-"+r,n.$form=(0,o.default)(t),n.$editor=(0,o.default)("#editor"),n.$title=n.$form.find('[name="title"]'),n.$body=n.$form.find('textarea[name="body"]'),n.$tabs=n.$form.find(".tabs"),n.$toolbar=n.$form.find(".toolbar"),n.$subToolbar=n.$form.find(".toolbar-sub"),n.$preview=n.$form.find("#preview"),n.$buttons=n.$form.find(".buttons"),n.$entryId=n.$form.find('input[name="entry"]'),n.$syntax=n.$form.find("#syntax"),n.$publicationType=n.$form.find('input[name="publication_type"]'),n.mode=n.$form.find('[name = "syntax"]').val(),n.actions=ne[n.mode],n.isSavingDraft=!1,n.$editarea=(0,o.default)('<div class="editarea"></div>').appendTo(n.$body.parent()),n.$editareaHover=(0,o.default)(('\n      <div class="editarea-hover">\n        <div class="editarea-hover-inner">\n          '+s.default.text("epic.editarea.hover")+"\n        </div>\n      </div>\n    ").trim()).appendTo(n.$editarea),n.on("initialize",(function(){n.backup=U.createMessage(n.$form,n.$editarea,N(n)),n.$form.on("backup-save",(function(){n.trigger("change")}))})),n.toolbarEnabled&&W.init(n.$toolbar,n.$subToolbar,N(n)),n.tabs=new c.default(n.$tabs),n.$tabs.on("tabsactivate",(function(e,t){var r=t.newPanel.attr("id");/preview/.test(r)?n.$title.hide():n.$title.show()})),n.shareDraft=new v.ShareDraft(N(n)),n.preview=new g.Preview(N(n)),n.setupPreviewDropdown(),n.syntaxSwitcher=new y.SyntaxSwitcher(n.$editor.find(".js-syntax-switcher"),n.$editor.find(".js-select-dropdown-window-syntax"),N(n)),n.footer=new _.Footer(N(n)),n.setupSidebar(),w.init(document.querySelector("#promotion")),(0,o.default)(window).on("resize",a.default.throttle((function(){n.emit("resize"),n.setHeight()}),50)),n.on("resizeRequired",(function(){return n.setHeight()})),n.setHeight(),B.isIE&&n.setupRestoreFocus(),n.$form.on("keydown",(function(e){n.handleSaveShortcutKeydown(e)})),m.EditorConnector.registerCurrentEditor(N(n)),n}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,R(t,n);var T,I,D,re=r.prototype;return re.handleSaveShortcutKeydown=function(e){var t=B.isMac?"W-s":"C-s";F(e)===t&&(e.preventDefault(),this.emit("saveShortcutKeydown"))},re.getTitle=function(){return this.$title.val()},re.setTitle=function(e){return this.$title.val(e)},re.getBody=function(){return this.$body.val()},re.getDateTime=function(){return this.$form.find('[name="datetime"]').val()},re.getAuthorName=function(){return this.$form.data("authorName")},re.getCategories=function(){return this.$form.find('input[name="category"]').get().map((function(e){return e.value}))},re.getCategoriesAsParamsArray=function(){return this.getCategories().map((function(e){return{name:"category",value:""+e}}))},re.getOgDescription=function(){return this.$form.find('textarea[name="og_description"]').val()},re.getSyntax=function(){return this.$syntax.val()},re.getPublicationType=function(){return this.$publicationType.val()},re.getLayout=function(){return this.$form.find(':input[name="layout"]:checked').val()},re.getCustomUrl=function(){return this.$form.find('input[name="customurl"]').val()},re.getProfileCardUuids=function(){return this.$form.find('input[name="profile_card"]').get().map((function(e){return e.value}))},re.getProfileCardsAsParamsArray=function(){return this.getProfileCardUuids().map((function(e){return{name:"profile_card",value:e}}))},re.getKotobaTagNames=function(){return this.$form.find('input[name="kotoba_tag_name"]').get().map((function(e){return e.value}))},re.getKotobaTagNamesAsParamsArray=function(){return this.getProfileCardUuids().map((function(e){return{name:"kotoba_tag_name",value:e}}))},re.getEntryId=function(){return this.$entryId.val()},re.setEntryId=function(e){if(!this.getEntryId()){var t=document.createElement("a");t.href=location.href;var n=i.default.parse(location.search.substring(1));n.entry=e,t.search=i.default.stringify(n);var r=t.href;history.replaceState(history.state,document.title,r)}this.$entryId.val(e)},re.setBackupId=function(e){this.$form.attr("data-backup-id",e)},re.handleImagePasteEvent=function(e){var t,n="clipboardData"in e?e.clipboardData:null===(t=e.originalEvent)||void 0===t?void 0:t.clipboardData;if(!n)return!1;if(n.getData("text/plain"))return!1;if(n.types&&n.types.length>0&&"image/tiff"===n.types[1])return e.preventDefault(),e.stopPropagation(),!1;var r=n.items,i=[];for(var a in r){var s=r[a];if("file"===s.kind){var u=s.getAsFile(),l=u.type.split(/\//)[1],c=new File([u],"a."+l);i.push(c)}}return i.length>0&&(this.sidebar.openByType("editor-fotolife"),(0,o.default)(document).trigger("uploadDroppedFiles",[i]),e.preventDefault(),e.stopPropagation(),!0)},re.getAllInputData=function(){var e=[];return this.$form.find("input[name], textarea[name]").each((function(t,n){var r=n;if("submit"!==r.type)if("checkbox"===r.type){if(!r.checked)return;e.push({name:r.name,value:r.checked})}else if("radio"===r.type){if(!r.checked)return;e.push({name:r.name,value:r.value})}else e.push({name:r.name,value:r.value})})),e},re.invokeAction=function(e,t){try{(0,u.LOG)("invokeAction: "+e),this.trigger("actionbefore",{action:e}),this.actions[e].call(this,t),this.trigger("actionafter",{action:e})}catch(e){(0,u.BUG)(e)}},re.bind=function(e,t){this.$form.on("editor."+e,t)},re.unbind=function(e,t){this.$form.off("editor."+e,t)},re.bindOnce=function(e,t){this.$form.one("editor."+e,t)},re.trigger=function(e,t){this.$form.trigger("editor."+e,t)},re.getCharacterCount=function(){return this.$body.val().length},re.getByteCount=function(){var e=this.$body.val();return encodeURIComponent(e).replace(/%../g,"x").length},re.setupRestoreFocus=function(){var e=this,t=null;setInterval((function(){e.isFocused()&&(t=e.getSelectionRange())}),100),(0,o.default)("#editor-support-container, .curation-tab-contents, .toolbar").on("click",(function(n){(0,o.default)(n.target).is("textarea, :text")||(e.focus(),t&&e.setSelectionRange(t))}))},re.setupPreviewDropdown=function(){var e=this.$tabs.find(".js-preview-dropdown"),t=this.$editor.find(".js-select-dropdown-window-preview");this.previewDropdown=new b.Dropdown(e,t)},re.setupSidebar=function(){var e=this;this.sidebar=new k.EditorSidebar(this);var t=(0,o.default)("#edit-form");((0,o.default)("#editor-beginner").length>0&&(this.sidebar.emit("openByType","editor-beginner"),(0,o.default)(".twitter-open-button").on("click",(function(){return e.sidebar.emit("openByType","editor-twitter"),!1}))),new E.Home({container:(0,o.default)("#editor-home"),sidebar:this.sidebar}),new z(t),new H(t,this,this.sidebar),new q({container:(0,o.default)("#editor-amazon-search"),sidebar:this.sidebar}),new G({container:(0,o.default)("#editor-hatena-bookmark"),sidebar:this.sidebar}),new d.default({editor:this,sidebar:this.sidebar,container:(0,o.default)("#editor-fotolife")}),new f.Paint({editor:this,sidebar:this.sidebar,container:(0,o.default)("#editor-paint")}),(0,o.default)("#editor-twitter").hasClass("enabled")&&new O.Twitter({$container:(0,o.default)("#editor-twitter"),sidebar:this.sidebar}),(0,o.default)("#editor-itunes.enabled").get(0))&&new ee({container:(0,o.default)("#editor-itunes"),sidebar:this.sidebar}).requestLoadItems();((0,o.default)("#editor-archive.enabled").get(0)&&V.init(document.querySelector("#editor-archive")),(0,o.default)("#editor-snippet").get(0)&&p.default.init(document.querySelector("#editor-snippet"),this),document.querySelector('#editor-home .service[data-service-id="profile-card"]')&&h.default.init(document.querySelector("#editor-profile-card")),(0,o.default)("#editor-instagram.enabled").get(0))&&new x.Instagram({editor:this,container:(0,o.default)("#editor-instagram"),sidebar:this.sidebar}).requestLoadItems();(0,o.default)("#editor-evernote.enabled").get(0)&&new K({editor:this,sidebar:this.sidebar,container:(0,o.default)("#editor-evernote")}).requestLoadItems();(0,o.default)("#editor-pixiv.enabled").get(0)&&new P.Pixiv({editor:this,container:(0,o.default)("#editor-pixiv"),sidebar:this.sidebar}).requestLoadItems();var n=document.querySelector("#editor-google-picker.enabled");n&&new S.GooglePhotos({editor:this,sidebar:this.sidebar,container:(0,o.default)(n)});var r=document.querySelector("#editor-google-picker-import-notice");r&&new C.GooglePickerImportNotice(this,r,"google-picker-import-notice");var i=document.querySelector("#editor-google-picker-import-confirmation-notice");i&&new C.GooglePickerImportNotice(this,i,"google-picker-import-confirmation-notice"),new Q({editor:this,sidebar:this.sidebar,container:(0,o.default)("#editor-miil")}).requestLoadItems(),new Y({container:(0,o.default)("#editor-gourmet"),sidebar:this.sidebar}).requestLoadItems(),new J({editor:this,container:(0,o.default)("#editor-nicovideo")}),new X({editor:this,sidebar:this.sidebar,container:(0,o.default)("#editor-gist")}).requestLoadItems(),new te({container:(0,o.default)("#editor-quote"),sidebar:this.sidebar}).requestLoadItems(),Z.init({container:document.querySelector("#editor-flickr"),sidebar:this.sidebar});var a=document.querySelector("#editor-rakuten");a?this.rakuten=new j.Rakuten(a):(0,u.BUG)("Rakuten container has no elements");var s=document.querySelector("#editor-dazn");s?new M.Dazn({container:s}):(0,u.BUG)("Dazn container has no elements");var l=document.querySelector("#editor-youtube");l&&new $.YouTube(l)},re.saveDraft=function(e){var t=this;if(this.isSavingDraft)return o.default.Deferred().reject();this.isSavingDraft=!0;var n=this.getAllInputData();n.push({name:"draft",value:!0}),e&&n.push({name:"without_preview_token",value:1});var r=l.protocolRelativeAdminUserBlogUrl("/draft");return this.emit("savingDraft"),o.default.ajax({url:r,type:"POST",dataType:"json",data:n}).done((function(e){t.setEntryId(e.uuid),t.setBackupId(e.backup_id),t.emit("saveDraft")})).fail((function(){t.emit("prepareSavingDraft"),window.alert(s.default.text("edit_form.failed_to_save_draft"))})).always((function(){t.isSavingDraft=!1}))},T=r,(I=[{key:"toolbarEnabled",get:function(){return!0}},{key:"syntaxForInsertLines",get:function(){return this.mode}}])&&L(T.prototype,I),D&&L(T,D),r}(r.EventEmitter);t.Editor=re},35541:function(e,t,n){n(69826),n(88674),n(41539),n(15306),n(74916),n(4723),n(54747),n(73210),n(24603),n(39714),n(21249),n(69600);var r=c(n(73609)),i=c(n(13469)),o=c(n(20996)),a=n(55992),s=c(n(57942)),u=n(79751),l=n(21650);function c(e){return e&&e.__esModule?e:{default:e}}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h=n(41960),m=n(59662),v=function(e){var t,n;function u(t){var n;return p(d(n=e.call(this,t)||this),"source",void 0),p(d(n),"currentTab",void 0),p(d(n),"ace",void 0),p(d(n),"tinymce",void 0),p(d(n),"isTinymceInitialized",void 0),p(d(n),"tinymceInitialized",void 0),p(d(n),"resolveTinymceInitialized",void 0),p(d(n),"isIMEComposing",void 0),p(d(n),"editorHTMLElement",void 0),n.source=n.$tabs.find("#source"),n.isTinymceInitialized=!1,n.tinymceInitialized=new Promise((function(e){n.resolveTinymceInitialized=e})),n.initWYSIWYG(),n.initAce(),n.currentTab="wysiwyg",n.isIMEComposing=!1,n.$tabs.on("tabsactivate",(function(e,t){var r=t.newPanel.attr("id");n.currentTab=r,/source/.test(r)?(setTimeout((function(){n.ace.resize(),n.ace.focus()}),0),n.writeBack(),n.setValue(n.$body.val()),n.syntaxSwitcher.disable()):/preview/.test(r)?(n.writeBack(),n.preview.updatePreview(),n.syntaxSwitcher.disable()):(n.setValue(n.$body.val()),n.tinymce.focus(),n.syntaxSwitcher.enable()),n.setHeight()})),n.bind("actionafter",(function(){n.writeBack()})),n.$form.bind("backup-restore",(function(){n.setValue(n.$body.val())})),n}n=e,(t=u).prototype=Object.create(n.prototype),t.prototype.constructor=t,f(t,n);var c=u.prototype;return c.initWYSIWYG=function(){var e=this;this.$editarea.show(),this.$body.appendTo(this.$editarea),document.body.focus(),tinymce.init({selector:"#"+this.$body.attr("id"),keep_styles:!1,custom_shortcuts:!1,height:"100%",width:"100%",body_class:"preview mce-inner-body",branding:!1,theme:"silver",skin:"oxide",toolbar:!1,menubar:!1,statusbar:!1,content_css:(0,a.staticUrl)("/css/editor-wysiwyg.css"),convert_urls:!1,placeholder:"",entity_encoding:"raw",extended_valid_elements:"*[*],#ins[*],#a[*],#audio[*],img[*],iframe[*]",valid_children:"+body[style]",cache_suffix:"?v="+tinymce.majorVersion+"."+tinymce.minorVersion,plugins:["pagebreak","paste","noneditable","lists"],paste_data_images:!1,pagebreak_separator:"\x3c!-- more --\x3e",paste_webkit_styles:"all",allow_unsafe_link_target:!0,paste_preprocess:function(t,n){e.onPastePreProcess(n)},setup:function(t){e.onTinymceSetup(t)},init_instance_callback:function(t){e.onTinymceInitialize(t)}})},c.onPastePreProcess=function(e){var t=e.content.replace(/^[\s]*/,"").replace(/[\s]*$/,"");if(t.match(this.URLPattern)){var n=e.content;this.emit("paste-url",n),e.content="",e.preventDefault(),e.stopPropagation()}t.match(/^(<[^>]+?>)+\[:contents\](<\/[^<]+?>)+$/)&&(e.content="[:contents]")},c.onTinymceSetup=function(e){var t=this;this.tinymce=e,e.on("submit",(function(e){var n=t.tinymce.getContent(),i=n;(0,r.default)("<iframe><p></p></iframe>").html().match(/&lt;/)&&((i=t.unescapeEntities(i))||(i=n)),(0,r.default)('<input type="hidden" name="unescaped_body"/>').val(i).appendTo(e.target)})),e.on("keydown",(function(e){t.handleSaveShortcutKeydown(e)})),this.tinymce.on("KeyUp",(function(e){var n=h(e);"RET"===n?t.newLine(e):"BS"===n&&t.backspace(e)})),this.tinymce.on("KeyUp",(function(){t.writeBack(),t.trigger("change")}))},c.onTinymceInitialize=function(e){var t=this;this.isIMEComposing=!1,(0,r.default)(this.tinymce.getBody()).on("compositionstart",(function(){t.isIMEComposing=!0})).on("compositionend",(function(){t.isIMEComposing=!1})),this.$editarea.find(".mce-edit-area").css({display:"block",width:"100%","min-height":"100%","border-width":"0px"}),this.editorHTMLElement=(0,r.default)(this.tinymce.getDoc()).find("html").eq(0),this.editorHTMLElement.css({height:"100%"}),this.setHeight();var n=(0,r.default)("<div>"),i=(0,r.default)("<a>");e.parser.addNodeFilter("iframe",(function(e){e.forEach((function(e){var t=e.attr("src");if(t){var r=n.html(t).text(),o=i.attr("href",r)[0].protocol;if("javascript:"===o||"data:"===o){var a="ignored:"+t;e.attr("src",a)}}}))})),e.parser.addNodeFilter("div",(function(e){e.forEach((function(e){e.attr("class")&&e.attr("class").match(/\bfreezed\b/)&&e.attr("contenteditable","false")}))})),e.serializer.addNodeFilter("div",(function(e){e.forEach((function(e){e.attr("class")&&e.attr("class").match(/\bfreezed\b/)&&e.attr("contenteditable",null)}))})),e.serializer.addNodeFilter("script",(function(e){e.forEach((function(e){var t=e.attr("type"),n=t&&t.match(/\bjson\b/),r=e.firstChild?e.firstChild.value:"";n&&r.length>0&&(e.firstChild.value=function(e){return e.replace(/^\/\/ <!\[CDATA\[/,"").replace(/\/\/ \]\]>$/,"")}(r))}))})),e.on("ObjectResized",(function(e){e.target.hasAttribute("height")&&e.target.removeAttribute("height")})),this.initDropper(),this.addKeyboardShortcuts(e),this.emit("initialize"),this.isTinymceInitialized=!0,this.resolveTinymceInitialized()},c.addKeyboardShortcuts=function(e){for(var t=function(t){["meta","ctrl"].forEach((function(n){e.addShortcut(n+"+"+t,"",["FormatBlock",!1,"h"+t])}))},n=1;n<=6;n++)t(n)},c.initDropper=function(){var e=this;if(!m.isIE||m.isIE11){var t=!1,n=i.default.debounce((function(){t||e.$editareaHover.addClass("dragging")}),20),o=function(e){e.stopPropagation(),e.preventDefault()},a=null,s=function(){null!==a&&(clearTimeout(a),a=null)},u=!1,c=(0,r.default)(this.tinymce.getDoc()),d=this.ace.container;c.add(d).on("dragstart",(function(){t=!0})).on("dragend",(function(){t=!1})).on("dragenter",(function(e){if(!t)if(null===a){if(!u){u=!0;var r=e.originalEvent;o(r),n()}}else s()})).on("dragenter","*",(function(e){if(!t)if(null===a){if(!u){u=!0;var r=e.originalEvent;o(r),n()}}else s()})).on("dragover",(function(e){if(!t)if(null===a){var n=e.originalEvent;o(n)}else s()})).on("dragleave",(function(n){t||(s(),a=window.setTimeout((function(){u=!1,e.$editareaHover.removeClass("dragging")}),50))})).on("drop",(function(n){if(!t){u=!1;var r=n.originalEvent;o(r),function(t){if(e.$editareaHover.removeClass("dragging"),function(e){return e.dataTransfer.files.length>0}(t))e.sidebar.openByType("editor-fotolife"),l.Uploader.uploadDroppedFiles(t);else{var n,r=(null===(n=t.dataTransfer)||void 0===n?void 0:n.getData("Text").trim())||"";r.match(e.URLPattern)&&e.emit("paste-url",r)}}(r)}})).on("paste",(function(t){e.handleImagePasteEvent(t)}))}},c.execCommand=function(e,t){var n=this;this.isTinymceInitialized?(this.tinymce&&this.tinymce.execCommand(e,!1,t),this.writeBack()):this.tinymceInitialized.then((function(){n.execCommand(e,t)}))},c.newLine=function(e){var t=this.tinymce.getDoc(),n=this.tinymce.selection,i=n.getNode(),o=(0,r.default)(i).closest("div.hatena-embed")[0];if(o){var a=o.nextSibling;a&&"p"===a.nodeName.toLowerCase()||((a=t.createElement("p")).appendChild(t.createElement("br")),o.parentNode.insertBefore(a,o.nextSibling));var s=n.getRng();s.setStart(a,0),s.setEnd(a,0),n.setRng(s),e.preventDefault()}},c.backspace=function(e){var t=this.tinymce.getDoc(),n=this.tinymce.selection,i=n.getNode(),o=(0,r.default)(i).closest("div.hatena-embed")[0];if(o){var a=o.previousSibling||t.body,s=n.getRng();s.selectNodeContents(a),s.collapse(!1),n.setRng(s),e.preventDefault(),o.parentNode.removeChild(o)}},c.initAce=function(){var e=this,t=document.createElement("div");(0,r.default)(t).css({position:"absolute",height:"100%",width:"100%",padding:"0px",margin:"0px"}),this.source.append(t);var n=ace.edit(t);n.commands.removeCommand("gotoline"),n.commands.removeCommand("indent"),n.commands.removeCommand("outdent"),n.commands.removeCommand("find"),n.renderer.setShowGutter(!1),n.renderer.setHScrollBarAlwaysVisible(!1),n.renderer.setPadding(5),n.renderer.setShowPrintMargin(!1),n.setHighlightActiveLine(!1),ace.require("ace/config").set("workerPath",(0,s.default)("admin-domain")+"/js/external/ace-builds");var i=new(0,ace.require("ace/mode/html").Mode);i.$modes["js-"].$behaviour.remove("braces"),i.$modes["js-"].$behaviour.remove("parens"),i.$modes["js-"].$behaviour.remove("string_dquotes");var o=n.getSession();o.setMode(i),o.setUseWrapMode(!0),o.setValue(this.$body.val()),o.on("change",(function(){var t=o.getValue();e.$body.val(t),e.tinymce&&e.tinymce.setContent(t)})),n.$blockScrolling=1/0,this.ace=n},c.setHeight=function(){this.currentTab=this.currentTab||"wysiwyg";var e=(0,r.default)(window).height()-this.$buttons.outerHeight(),t=(0,r.default)("#"+this.currentTab).offset().top;this.$editarea.height(e-this.$editarea.offset().top),this.$preview.height(e-t-2),(this.source||(0,r.default)("#source")).height(e-t-2)},c.focus=function(){this.writeBack(),this.tinymce&&this.tinymce.focus()},c.getSelectionRange=function(){return this.tinymce.selection.getRng()},c.setSelectionRange=function(e){0===e.start&&0===e.end?this.tinymce.selection.setCursorLocation():this.tinymce.selection.setRng(e)},c.isFocused=function(){return(0,r.default)(document.activeElement).is("#body_ifr")},c.setValue=function(e){var t=this.unescapeEntities(e);this.$body.val(t),this.execCommand("mceSetContent",t),this.ace.getSession().setValue(t)},c.unescapeEntities=function(e){var t=e;return["style","script","xmp","iframe","noembed","noframes","plaintext","noscript"].forEach((function(e){t=t.replace(new RegExp("<"+e+"(.*?)>(.*?)<\\/"+e+">","g"),(function(t,n,r){var i=r.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&amp;/g,"&");return"<"+e+n+">"+i+"</"+e+">"}))})),t},c.insert=function(e){switch(this.currentTab){case"wysiwyg":this.execCommand("mceInsertContent",e);break;case"source":this.ace.insert(e);break;case"preview":default:window.alert(o.default.text("edit_form.cannot_insert_in_preview_tab"))}},c.insertLines=function(e){var t=e.map((function(e){return"<p>"+e+"</p>"}));this.insert(t.join(""))},c.getCharacterCount=function(){var e=this.tinymce.getBody(),t=void 0===e.textContent?e.innerText:e.textContent;return(t=t.replace(/\s+/g," ")).length},c.insertAndSelectText=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=e.length);var r=this.tinymce.selection.getRng(),i=this.tinymce.getDoc().createTextNode(e);r.insertNode(i),r.setStart(i,t),r.setEnd(i,n),this.tinymce.selection.setRng(r)},c.writeBack=function(){this.isIMEComposing||this.tinymce&&this.tinymce.save()},c.isCollapsed=function(){return this.tinymce.selection.isCollapsed()},c.getSelectionText=function(){return this.tinymce.selection.getContent()},c.getSelectionSource=function(){return this.tinymce.selection.getContent()},c.createLink=function(e){this.tinymce.execCommand("CreateLink",!1,e)},c.formatBlock=function(e){var t=this.tinymce.selection.getNode();"body"!==t.tagName.toLowerCase()&&this.tinymce.selection.select(t),"p"!==e&&this.execCommand("FormatBlock","p"),this.execCommand("FormatBlock",e)},c.replace=function(e){this.tinymce.selection.setContent(e)},c.moveCaretToNodeEnd=function(e){this.tinymce.selection.select(e),this.tinymce.selection.collapse(!1)},c.insertBlockQuoteWithNewLine=function(){if(this.tinymce.selection.isCollapsed()){this.insert("<blockquote><p>&nbsp;</p></blockquote><p>&nbsp;</p>");var e=(0,r.default)(this.tinymce.selection.getNode()).prev("blockquote").find("p")[0];this.tinymce.selection.setCursorLocation(e,0)}else{this.insert("<blockquote><p>"+this.tinymce.selection.getContent()+"</p></blockquote><p>&nbsp;</p>");var t=(0,r.default)(this.tinymce.selection.getNode()).prev("blockquote")[0];this.tinymce.selection.select(t)}},c.formatBlockQuote=function(){if(m.isIE&&this.tinymce.selection.isCollapsed()){var e=this.tinymce.selection.getNode();this.tinymce.selection.select(e)}this.execCommand("mceBlockQuote")},u}(u.Editor);e.exports=v},96207:function(e,t,n){t.__esModule=!0,t.HatenaEditor=void 0,n(69826),n(15306),n(74916),n(4723),n(69600),n(23123),n(23157),n(27852),n(24603),n(39714),n(73210);var r=l(n(73609)),i=l(n(13469)),o=n(70879),a=n(79751),s=n(21650),u=n(38712);function l(e){return e&&e.__esModule?e:{default:e}}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var p=n(59662),h=n(81191),m=n(19165),v=function(e){var t,n;function a(t){var n;f(c(n=e.call(this,t)||this),"currentTab",void 0),f(c(n),"realtimePreview",void 0),f(c(n),"editorTextbox",void 0),n.$body.attr("style","position: absolute; height: 100%; width: 100%; padding: 0; margin: 0"),n.$body.appendTo(n.$editarea),n.currentTab="textarea",n.$tabs.on("tabsactivate",(function(e,t){var r=t.newPanel.attr("id");n.currentTab=r,/preview/.test(r)&&!n.preview.isOpeningWindow()?(n.preview.updatePreview(),n.syntaxSwitcher.disable()):(setTimeout((function(){n.focus()}),0),n.syntaxSwitcher.enable()),n.setHeight()})),n.bind("actionafter",(function(){n.focus()}));var r=n.$form.find("#realtime-preview"),a=n.$form.find("#realtime-preview-button"),s=n.$form.find("#realtime-preview-placeholder");return n.$editarea.append(r).append(a).append(s),n.realtimePreview=new u.RealtimePreview(c(n),r,s),m.load("does-show-realtime-preview")&&n.showRealtimePreview(),a.click((function(){r.is(":visible")?n.hideRealtimePreview():n.showRealtimePreview()})),n.setHeight(),n.$body.on("input propertychange",(function(){n.trigger("change")})),n.$body.on("paste",(function(e){try{if(n.handleImagePasteEvent(e))return e.preventDefault(),void e.stopPropagation()}catch(e){(0,o.BUG)(e,"upload pasted image filed(hatena or markdown)")}var t=e.originalEvent,r=(t.clipboardData?t.clipboardData.getData("text/plain"):window.clipboardData.getData("text")).replace(/^[\s]*/,"").replace(/[\s]*$/,"");if(r.match(n.URLPattern)&&!n.onInsertingLink()){var i=r;return n.emit("paste-url",i),e.preventDefault(),void e.stopPropagation()}})),n.initDropper(),i.default.defer((function(){n.emit("initialize")})),n}n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,d(t,n);var l=a.prototype;return l.setHeight=function(){this.currentTab=this.currentTab||"textarea";var e=(0,r.default)(window).height()-this.$buttons.outerHeight(),t=(0,r.default)("#"+this.currentTab).offset().top;this.$editarea.height(e-this.$editarea.offset().top),this.$preview.height(e-t-2),this.emit("resize")},l.focus=function(){this.$body.focus()},l.isFocused=function(){return this.$body.is(":focus")},l.setValue=function(e){this.$body.val(e)},l.getTextArea=function(){return this.$body[0]},l.getSelectionRange=function(){var e=this.getTextArea();return{start:e.selectionStart,end:e.selectionEnd}},l.setSelectionRange=function(e){this.getTextArea().setSelectionRange(e.start,e.end)},l.getSelectionText=function(e){return e=e||this.getSelectionRange(),this.$body.val().substring(e.start,e.end)},l.getSelectionSource=function(){return this.getSelectionText()},l.isCollapsed=function(){var e=this.getSelectionRange();return e.start===e.end},l.getCharacterAtCursor=function(){var e=this.getSelectionRange();return this.$body.val()[e.start-1]},l.onInsertingLink=function(){return i.default.include(["[",">",'"'],this.getCharacterAtCursor())},l.createLink=function(e){var t=this.getSelectionRange(),n=this.getSelectionText(),r=n.match(/\n/)?'<a href="'+i.default.escape(e)+'">'+n+"</a>":"["+e+":title="+n+"]",o=this.replace(r,t);this.setSelectionRange(o)},l.replace=function(e,t){return t=t||this.getSelectionRange(),this.replaceInternally(e,t),this.$body.trigger("input"),{start:t.start,end:t.start+e.length}},l.insert=function(e){var t=this.getSelectionRange(),n={start:t.end,end:t.end};return this.replaceInternally(e,n),this.setSelectionRange({start:t.end+e.length,end:t.end+e.length}),this.$body.trigger("input"),{start:t.end,end:t.end+e.length}},l.replaceInternally=function(e,t){var n=this.getTextArea(),r=n.scrollTop,i=n.scrollLeft;n.setSelectionRange(t.start,t.end),n.focus();var o=!1;try{o=document.execCommand("insertText",!1,e)}catch(e){}if(!o){var a=n.value;n.value=a.substring(0,t.start)+e+a.substring(t.end)}n.scrollTop=r,n.scrollLeft=i},l.insertLines=function(e){var t=this.getSelectionRange(),n=this.$body.val()[t.start-1],r="";"\n"===n||void 0===n||(r="\n"),this.insert(r+e.join("\n")+"\n")},l.modifyCurrentLine=function(e){for(var t=this.getSelectionRange(),n=this.$body.val().split(/\r?\n/),r=0,i=n.length,o=0;i>r&&!((o+=n[r].length+1)>t.start);)r++;var a=n[r],s=e(a),u=o-a.length-1,l={start:u,end:u+a.length},c=this.replace(s,l);this.setSelectionRange(c)},l.wrapString=function(e,t,n,r){var i,o=this.getSelectionText();return o.startsWith(e)&&o.endsWith(t)?(o=o.substring(e.length,o.length-t.length),i=this.replace(o)):n&&r&&o.startsWith(n)&&o.endsWith(r)?(o=o.substring(n.length,o.length-r.length),i=this.replace(o)):i=this.replace(e+o+t),this.setSelectionRange(i),i},l.wrapStringAround=function(e,t){var n=this.getSelectionText();this.wrapString(e,t),0===n.length&&this.moveCaret(e.length)},l.wrapStringAroundLabel=function(e,t,n){var r=this.getSelectionText();if(this.wrapStringAround(e,n),0===r.length){var i=this.replace(t);this.setSelectionRange(i)}},l.headingAction=function(e){this.modifyCurrentLine((function(t){return t.replace(/^[*]*(\s+)*/,e)}))},l.moveCaret=function(e){var t=this.getSelectionRange();t.start+=e,t.end=t.start,this.setSelectionRange(t)},l.toggleFontSize=function(e){var t,n=this.getSelectionText();/^(<span style="font-size: (\d+)%">)/.test(n)?(n=Math.floor(+RegExp.$2)===e?n.replace(RegExp.$1,"").replace(/<\/span>/,""):n.replace(RegExp.$1,'<span style="font-size: '+e+'%">'),t=this.replace(n)):t=this.replace('<span style="font-size: '+e+'%">'+n+"</span>");this.setSelectionRange(t)},l.removeFontSize=function(){var e,t=this.getSelectionText();/^(<span style="font-size: \d+%">)/.test(t)&&(t=t.replace(RegExp.$1,"").replace(/<\/span>/,""),e=this.replace(t),this.setSelectionRange(e))},l.showRealtimePreview=function(){h.trackEvent("RealtimePreview.on"),this.$editarea.addClass("realtime-preview"),this.realtimePreview.show(),m.save("does-show-realtime-preview",!0)},l.hideRealtimePreview=function(){h.trackEvent("RealtimePreview.off"),this.$editarea.removeClass("realtime-preview"),this.realtimePreview.hide(),m.save("does-show-realtime-preview",!1)},l.initDropper=function(){var e=this;if(!p.isIE||p.isIE11){this.editorTextbox=this.$editarea.find("#body").eq(0);var t=!1,n=function(e){e.stopPropagation(),e.preventDefault()};this.$editarea.on("dragstart",(function(){t=!0})).on("dragend",(function(){t=!1})).on("dragenter",(function(){t||(!0,e.$editareaHover.addClass("dragging"))})).on("dragleave",(function(){t||(!1,e.$editareaHover.removeClass("dragging"))})).on("dragover",(function(r){t||(e.$editareaHover.addClass("dragging"),n(r.originalEvent))})).on("drop",(function(r){if(!t){!1,e.$editareaHover.removeClass("dragging");var i=r.originalEvent;n(i),function(t){if(function(e){return e.dataTransfer.files.length>0}(t))e.sidebar.openByType("editor-fotolife"),s.Uploader.uploadDroppedFiles(t);else{var n=t.dataTransfer.getData("Text").trim();n.match(e.URLPattern)&&e.emit("paste-url",n)}}(i)}}))}},a}(a.Editor);t.HatenaEditor=v},34313:function(e,t,n){t.__esModule=!0,t.MarkdownEditor=void 0,n(4723),n(74916),n(15306),n(69600),n(26699);var r=n(96207),i=n(96486);function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var a=function(e){var t,n;function r(){return e.apply(this,arguments)||this}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,o(t,n);var a=r.prototype;return a.insertLines=function(e){var t=this.getSelectionRange(),n=this.$body.val().substr(t.start-2,t.start),r="";"\n\n"===n||""===n||(r=n.match(/\n$/)?"\n":"\n\n"),this.insert((r+e.join("\n\n")+"\n\n").replace(/\n+$/,"\n\n"))},a.headingAction=function(e){this.modifyCurrentLine((function(t){return t.replace(/^[#]*(\s+)*/,e)}))},a.createLink=function(e){var t,n=this.getSelectionRange(),r=this.getSelectionText();t=r.match(/\n/)?'<a href="'+(0,i.escape)(e)+'">'+r+"</a>":"["+r+"]("+e+")";var o=this.replace(t,n);this.setSelectionRange(o)},a.onInsertingLink=function(){return["(","[",'"'].includes(this.getCharacterAtCursor())},r}(r.HatenaEditor);t.MarkdownEditor=a},98960:function(e,t,n){t.__esModule=!0,t.Preview=void 0,n(92222),n(69720),n(54747);var r=a(n(73609)),i=a(n(57942)),o=a(n(76804));function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u=n(36500),l=n(28507),c=function(){function e(e){s(this,"editor",void 0),s(this,"device",void 0),s(this,"previewWindow",void 0),s(this,"$wrapper",void 0),s(this,"$closeWindowButton",void 0),s(this,"$newWindowDropdown",void 0),s(this,"$newWindowButton",void 0),s(this,"$reloadButton",void 0),s(this,"$toggleDevice",void 0),s(this,"forcePcView",void 0),this.editor=e,this.previewWindow=null,this.device="pc",this.$wrapper=(0,r.default)("#preview"),this.$closeWindowButton=(0,r.default)("#js-new-window-close-btn"),this.$newWindowDropdown=(0,r.default)(".js-select-dropdown-window-preview"),this.$newWindowButton=(0,r.default)(".js-dropdown-preview-in-new-window"),this.$reloadButton=(0,r.default)(".js-icon-preview-in-new-window-reload"),this.$toggleDevice=(0,r.default)(".editor-preview-device"),this.forcePcView=!!this.$wrapper.data("forcePcView"),this.initEvent()}var t=e.prototype;return t.initEvent=function(){var e=this;this.$newWindowButton.on("click",(function(){return e.previewInWindow()})),this.$reloadButton.on("click",(function(){return e.previewInWindow(),!1})),this.$toggleDevice.on("change",(function(t){return e.setDevice(t.currentTarget.value)})),u.createForParent().addEventListener("close-preview-window",(function(){e.closePreviewWindow()})),(0,r.default)(window).on("close-preview-window",(function(){e.closePreviewWindow()}))},t.isOpeningWindow=function(){return!!this.previewWindow&&!this.previewWindow.closed},t.appendPreviewHTML=function(e){var t=this,n=this.editor.getTitle(),o=this.editor.getBody(),a=this.editor.getOgDescription(),s=this.editor.getDateTime(),u=this.editor.getAuthorName(),l=this.editor.getPublicationType(),c=this.editor.getLayout(),d=this.editor.getCustomUrl(),f={url:"./preview",type:"post",dataType:"json",data:[{name:"title",value:n},{name:"body",value:o},{name:"og_description",value:a},{name:"datetime",value:s},{name:"author_name",value:u},{name:"publication_type",value:l},{name:"layout",value:c},{name:"customurl",value:d},{name:"rkm",value:(0,i.default)("rkm")},{name:"rkc",value:(0,i.default)("rkc")}].concat(this.editor.getCategoriesAsParamsArray()).concat(this.editor.getProfileCardsAsParamsArray()).concat(this.editor.getKotobaTagNamesAsParamsArray())};r.default.ajax(f).done((function(i){for(var f={title:n,body:o,og_description:a,datetime:s,author_name:u,publication_type:l,layout:c,customurl:d,device:t.device,syntax:t.editor.getSyntax(),datetime_tz:i.datetime_tz,signature:i.signature,editor_id:t.editor.id,token:i.preview_token,"force-pc-view":t.forcePcView?1:0},p=i.uri+("amp"===t.device?"?amp=1":""),h=(0,r.default)("<form method='POST' target=\""+e+'" action='+p+"/>"),m=0,v=Object.entries(f);m<v.length;m++){var g=v[m],b=g[0],y=g[1];(0,r.default)('<textarea name="'+b+'"/>').val(y).appendTo(h)}t.editor.getCategories().forEach((function(e){(0,r.default)('<textarea name="category"/>').val(e).appendTo(h)})),t.editor.getProfileCardUuids().forEach((function(e){(0,r.default)('<textarea name="profile_card"/>').val(e).appendTo(h)})),t.editor.getKotobaTagNames().forEach((function(e){(0,r.default)('<textarea name="kotoba_tag_name"/>').val(e).appendTo(h)})),h.appendTo(document.body),h.submit(),h.remove()}))},t.openPreviewWindow=function(){var e=this,t={width:screen.width/2,height:screen.height,top:0,left:screen.width/2};"touch"!==this.device&&"amp"!==this.device||(t.width=320,t.height=568);var n="scrollbars=1,"+(0,o.default)(t);this.previewWindow=window.open("","hatena-preview-new-window",n),l((function(){return e.previewWindow&&e.previewWindow.closed}),(function(){return e.updateWindowMode()})),this.$closeWindowButton.on("click",(function(){e.previewWindow&&e.previewWindow.close()})),this.updateWindowMode()},t.previewInWindow=function(){this.isOpeningWindow()||this.openPreviewWindow(),this.appendPreviewHTML("hatena-preview-new-window"),this.previewWindow&&this.previewWindow.focus()},t.previewInIframe=function(){this.$wrapper.toggleClass("is-device-touch","touch"===this.device||"amp"===this.device),this.appendPreviewHTML("hatena-preview-iframe")},t.closePreviewWindow=function(){this.isOpeningWindow()&&this.previewWindow&&this.previewWindow.close()},t.updateWindowMode=function(){var e=this.isOpeningWindow();this.$wrapper.toggleClass("is-opening-new-window",e),this.$newWindowDropdown.toggleClass("is-opening-new-window",e),this.$reloadButton.toggle(e),e&&this.previewInIframe()},t.updatePreview=function(){this.isOpeningWindow()?(this.closePreviewWindow(),this.previewInWindow()):this.previewInIframe()},t.setDevice=function(e){this.device=e,this.updatePreview()},e}();t.Preview=c},94114:function(e,t,n){t.__esModule=!0,t.RawEditor=void 0,n(69600),n(4723),n(74916),n(15306);var r=n(96207),i=n(92477),o=n(96486);function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u=function(e){var t,n;function r(){return e.apply(this,arguments)||this}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,s(t,n);var u,l,c,d=r.prototype;return d.insertLines=function(e){var t=e.join("\n");this.insert(t)},d.insert=function(t){var n=this;t.match(/^\[/)?(0,i.extractSyntax)(t).done((function(t){e.prototype.insert.call(n,t.html)})).fail((function(){e.prototype.insert.call(n,t)})):e.prototype.insert.call(this,t)},d.createLink=function(e){var t=this.getSelectionRange(),n=this.getSelectionText(),r='<a href="'+(0,o.escape)(e)+'">'+n+"</a>",i=this.replace(r,t);this.setSelectionRange(i)},d.onInsertingLink=function(){return'"'===this.getCharacterAtCursor()},u=r,(l=[{key:"toolbarEnabled",get:function(){return!1}},{key:"syntaxForInsertLines",get:function(){return"html"}}])&&a(u.prototype,l),c&&a(u,c),r}(r.HatenaEditor);t.RawEditor=u},38712:function(e,t,n){n(88674),n(41539),n(4129),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.RealtimePreview=void 0,n(35666),n(69826),n(4723),n(74916);var r=u(n(73609)),i=u(n(57942)),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(347)),a=n(55992);function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}function u(e){return e&&e.__esModule?e:{default:e}}function l(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=function(){function e(e,t,n){var r=this;c(this,"$container",void 0),c(this,"$rpPlaceholder",void 0),c(this,"$iframes",void 0),c(this,"isVisible",void 0),c(this,"onInput",void 0),c(this,"count",void 0),c(this,"interval",void 0),c(this,"timer",void 0),c(this,"editor",void 0),this.$container=t,this.$rpPlaceholder=n,this.$iframes=this.$container.find(".realtime-preview-iframe"),this.isVisible=!1,this.onInput=function(){return r._onInput()},this.count=0,this.interval=600,this.timer=window.setTimeout((function(){return r.update()}),this.interval),this.editor=e,this.$rpPlaceholder.css("z-index","-1")}var t=e.prototype;return t._onInput=function(){var e=this;window.clearTimeout(this.timer),this.timer=window.setTimeout((function(){e.update()}),this.interval)},t.show=function(){this.editor.bind("change",this.onInput),this.isVisible=!0,this.update()},t.hide=function(){this.editor.unbind("change",this.onInput),this.isVisible=!1},t.update=function(){var e,t=(e=regeneratorRuntime.mark((function e(){var t,n,s,u,l,c,d,f,p,h,m=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isVisible){e.next=2;break}return e.abrupt("return");case 2:return t=(0,r.default)(this.$iframes[this.count%2]),this.count++,n=(0,r.default)(this.$iframes[this.count%2]),s=this.editor.getBody(),u=(0,r.default)("#syntax").val(),e.next=9,o.default.post((0,a.protocolRelativeAdminUserBlogUrl)("/preview"),{body:s,editor_id:this.editor.id,rkm:(0,i.default)("rkm"),rkc:(0,i.default)("rkc")},{transformRequest:o.formDataRequest});case 9:l=e.sent,c=l.data,d=c.signature,f=c.uri_realtime,p=c.preview_token,h=(0,r.default)('<form method="POST" target="realtime-preview-iframe-'+this.count%2+'"></form>').attr("action",f),(0,r.default)("<textarea/>").attr("name","body").val(s).appendTo(h),(0,r.default)("<textarea/>").attr("name","syntax").val(u).appendTo(h),(0,r.default)("<textarea/>").attr("name","signature").val(d).appendTo(h),(0,r.default)("<textarea/>").attr("name","editor_id").val(this.editor.id).appendTo(h),(0,r.default)("<textarea/>").attr("name","token").val(p).appendTo(h),this.$iframes.off("load.ajaxsubmit").on("load.ajaxsubmit",(function(){s.match(/^\s*$/)?m.$rpPlaceholder.css("z-index","1"):m.$rpPlaceholder.css("z-index","-1"),n.css("z-index",1),t.css("z-index",-1)})),h.appendTo(document.body),h.submit(),h.remove();case 21:case"end":return e.stop()}}),e,this)})),function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){l(o,r,i,a,s,"next",e)}function s(e){l(o,r,i,a,s,"throw",e)}a(void 0)}))});return function(){return t.apply(this,arguments)}}(),e}();t.RealtimePreview=d},85387:function(e,t,n){t.__esModule=!0,t.ShareDraft=void 0,n(69826);var r,i=(r=n(73609))&&r.__esModule?r:{default:r},o=n(70879),a=n(55992);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u=n(91269),l=function(){function e(e){var t=this;s(this,"editor",void 0),s(this,"$shareButton",void 0),s(this,"$shareBoxWrapper",void 0),s(this,"$shareBox",void 0),s(this,"$tokenInput",void 0),s(this,"$closeButton",void 0),s(this,"$mask",void 0),s(this,"$draftLabel",void 0),s(this,"$scheduledLabel",void 0),s(this,"editorFooterElement",void 0),this.editor=e,this.$shareButton=(0,i.default)(".js-share-draft-button"),this.$shareBoxWrapper=(0,i.default)(".js-share-draft-box-wrapper"),this.$shareBox=(0,i.default)(".js-share-draft-box"),this.$tokenInput=this.$shareBox.find("input"),this.$closeButton=this.$shareBox.find(".btn-close"),this.$mask=this.$shareBoxWrapper.find(".mask"),this.editorFooterElement=document.querySelector(".js-editor-footer"),this.$shareButton.on("click",(function(){t.openShareDraftWindow()})),this.$closeButton.on("click",(function(){return t.closeShareDraftWindow(),!1})),this.$mask.on("click",(function(){return t.closeShareDraftWindow(),!1})),this.$draftLabel=(0,i.default)(".js-label-save-draft-and-share-preview"),this.$scheduledLabel=(0,i.default)(".js-label-save-scheduled-and-share-preview"),this.editor.on("toggleScheduledEntry",(function(e){t.toggleIsScheduledLabel(e)}));var n=u.get("editor.entryOption");this.toggleIsScheduledLabel(n.isScheduledEntry)}var t=e.prototype;return t.setWindowPosition=function(e){this.$shareBox.css(e)},t.getDraftWindowPositionBottom=function(){var e=window.getComputedStyle(this.editorFooterElement,null);return"calc("+e.height+" + "+e.paddingTop+")"},t.openShareDraftWindow=function(){var e=this;this.setWindowPosition({bottom:this.getDraftWindowPositionBottom()}),this.editor.saveDraft().done((function(t){e.$shareBoxWrapper.addClass("visible");var n=t.publication_type,r=t.token,i=(0,a.userBlogUrl)("/draft/"+n+"/"+r);e.$tokenInput.val(i).focus().select()})).fail((function(e,t,n){(0,o.BUG)(n,"ShareDraft")}))},t.closeShareDraftWindow=function(){this.$shareBoxWrapper.removeClass("visible")},t.toggleIsScheduledLabel=function(e){this.$draftLabel.toggle(!e),this.$scheduledLabel.toggle(e)},e}();t.ShareDraft=l},48881:function(e,t,n){t.__esModule=!0,t.SyntaxSwitcher=void 0,n(47042),n(64765),n(74916);var r=u(n(73609)),i=u(n(13469)),o=n(77102),a=u(n(20996)),s=u(n(1606));function u(e){return e&&e.__esModule?e:{default:e}}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c=n(1514),d=function(){function e(e,t,n){var i=this;l(this,"$syntaxSwitcher",void 0),l(this,"$dropdownWindow",void 0),l(this,"editor",void 0),l(this,"params",void 0),l(this,"syntaxSwitcher",void 0),this.$syntaxSwitcher=e,this.$dropdownWindow=t,this.editor=n,this.params=(0,s.default)(location.search.slice(1)),this.editor.on("savingDraft",(function(){i.$syntaxSwitcher.addClass("syntax-switcher-disabled")})),this.params.entry?this.$syntaxSwitcher.addClass("syntax-switcher-disabled"):(this.syntaxSwitcher=new o.Dropdown(this.$syntaxSwitcher,this.$dropdownWindow),this.$dropdownWindow.on("click",".js-dropdown-syntax",(function(e){""===i.editor.getBody()||window.confirm(a.default.text("epic.syntax_switch"))?i.switchSyntax((0,r.default)(e.currentTarget).data("syntax")):i.$dropdownWindow.toggle()})))}var t=e.prototype;return t.switchSyntax=function(e){(0,r.default)(document).trigger("clearBackup");var t=i.default.extend(this.params,{syntax:e,title:this.editor.getTitle()});this.editor.trigger("initialize"),location.href=c(t)},t.disable=function(){this.$dropdownWindow.hide(),this.$syntaxSwitcher.addClass("syntax-switcher-hidden")},t.enable=function(){this.$syntaxSwitcher.removeClass("syntax-switcher-hidden")},e}();t.SyntaxSwitcher=d},84145:function(e,t,n){n(69826),n(41539),n(39714);var r=n(77102),i=n(73609),o=n(81191),a=n(88792),s={init:function(e,t,n){var a=this;this.$toolbar=e,this.$subToolbar=t,this.$moreButton=i(".button-toolbar-more"),this.editor=n,this.$toolbar.on("click","button",(function(e){var t=i(e.currentTarget).attr("data-action");return t&&a.editor.invokeAction(t),!1})),this.$toolbar.find("button[data-action]").each((function(e,t){var n=i(t),r=n.attr("data-action");a.editor.actions[r]||(n.attr("disabled","disabled"),n.addClass("disabled"))})),this.$toolbar.find(".toolbar-select-button").each((function(e,t){var n=i(t).attr("data-dropdown-window-selector"),o=i("#editor").find(n);new r.Dropdown(i(t),o)})),i(".toolbar-select-dropdown-window").on("mousedown","[data-action]",(function(e){var t=i(e.currentTarget),n=t.attr("data-action");a.editor.invokeAction(n),o.trackEvent(t.attr("data-track-name"))})),this.setupColorPicker(),this.setupToolbarMore()},setupToolbarMore:function(){var e,t=this,n="Hatena.Diary.Editor.showSubToolbar";try{localStorage[n]=localStorage[n]||"true"}catch(e){}this.$moreButton.on("click",(function(e){e.preventDefault(),t.toggleSubToolbar();try{var r=!JSON.parse(localStorage[n]);localStorage[n]=r.toString()}catch(e){}}));try{e="true"===localStorage[n]}catch(t){e=!0}e&&this.toggleSubToolbar()},toggleSubToolbar:function(){this.$subToolbar.toggle(),this.$moreButton.toggleClass("is-hidden"),this.editor.emit("resizeRequired")},setupColorPicker:function(){var e=this,t=i(".js-hatena-diary-color-picker"),n=i('[data-action="color"]');this.colorPicker=new a(t),this.colorPicker.on("colorpick",(function(t){e.editor.invokeAction("pickColor",t)})),this.colorPickerDropdown=new r.Dropdown(n,t)}};e.exports=s},21650:function(e,t,n){t.__esModule=!0,t.Uploader=void 0,n(4723),n(74916),n(68309),n(69720),n(91038),n(78783);var r=s(n(73609)),i=n(70879),o=s(n(57942)),a=n(97050);function s(e){return e&&e.__esModule?e:{default:e}}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c="Hatena Blog",d="Hatena Blog Illust",f=function(){function e(){l(this,"handlers",void 0),l(this,"params",void 0),this.handlers={},this.params={}}var t,n,s,f=e.prototype;return f.on=function(e,t){this.handlers[e]||(this.handlers[e]=[]),this.handlers[e].push(t)},f.emit=function(e,t){for(var n=this.handlers[e]||[],r=0,o=n.length;r<o;r++)try{n[r](t)}catch(t){(0,i.BUG)("Error on emit["+e+"] "+t)}},f.setParams=function(e){this.params=e},f.upload=function(e,t){var n,s=this,u=r.default.Deferred();if(!(n=e.name).match(/\.(jpg|jpeg|gif|png|bmp)$/i)&&!n.match(/\.(mov|mpg|wmv|avi|flv|3gp|3g2)$/i)){var l=new TypeError("File not supported");return this.emit("error",l),u.reject(l)}null==t&&((0,i.BUG)(new Error("Uploader: invalid folder name")),t=c);var d=new FormData;d.append("rkm",(0,o.default)("rkm")),d.append("append","1"),d.append("fototitle",""),d.append("folder",t),d.append("image",e);for(var f=0,p=Object.entries(this.params);f<p.length;f++){var h=p[f],m=h[0],v=h[1];d.append(m,v)}var g=new XMLHttpRequest;return g.upload.addEventListener("progress",(function(e){var t=e.lengthComputable?e.loaded/e.total*100:NaN;s.emit("progress",{percent:t}),u.notify(t)}),!1),g.addEventListener("load",(function(e){if(s.emit("progress",{percent:100}),u.notify(100),200!==g.status)return 402===g.status&&s.emit("disk_full",e),s.emit("error",e),u.reject(e);var t;try{t=JSON.parse(g.responseText)}catch(e){}return null==t?(s.emit("error",e),u.reject(e)):void 0===t.hatena_syntax||void 0!==t.errmsg?(s.emit("error",t),u.reject(t)):void(0,a.extractFotolifeSyntax)(t.hatena_syntax).done((function(e){e&&(u.resolve(e),s.emit("success",e))})).fail((function(e){u.reject(e)}))}),!1),g.addEventListener("error",(function(e){s.emit("error",e),u.reject(e)}),!1),g.addEventListener("abort",(function(e){s.emit("error",e),u.reject(e)}),!1),g.open("POST","/f/"+(0,o.default)("name")+"/upbysmart?with_image_url=1"),g.setRequestHeader("X-Requested-With","XMLHttpRequest"),g.send(d),u.promise()},f.uploadPaint=function(e,t){var n=this,i=r.default.Deferred();return r.default.post("/f/"+(0,o.default)("name")+"/haiku",{rkm:(0,o.default)("rkm"),append:1,fototitle:"",folder:d,image:e,ext:t,model:"hatenablog"}).done((function(e){n.emit("progress",{percent:100}),(0,a.extractFotolifeSyntax)(e).done((function(e){e&&(i.resolve(e),n.emit("success",e))})).fail((function(e){i.reject(e)}))})).fail((function(e){n.emit("error",e),i.reject(e)})),i},e.uploadDroppedFiles=function(e){var t=e.dataTransfer;if(null!==t){var n=Array.from(t.files);(0,r.default)(document).trigger("uploadDroppedFiles",[n])}},t=e,s=[{key:"DEFAULT_SIZE",get:function(){return 1200}}],(n=null)&&u(t.prototype,n),s&&u(t,s),e}();t.Uploader=f},19165:function(e,t,n){var r=n(70879),i="hatenablog-editor-config-",o={save:function(e,t){try{localStorage.setItem(i+e,JSON.stringify([t]))}catch(e){(0,r.BUG)(e)}},load:function(e){var t;try{t=JSON.parse(localStorage.getItem(i+e)||"[]")[0]}catch(e){(0,r.BUG)(e)}return t}};e.exports=o},99303:function(e,t,n){t.__esModule=!0,t.createEditor=function(e){var t=e.find('[name="syntax"]').val();return(0,i.LOG)("init editor with mode: "+t),new l[t](e)},n(69826);var r,i=n(70879),o=(r=n(35541))&&r.__esModule?r:{default:r},a=n(96207),s=n(34313),u=n(94114);var l={html:o.default,hatena:a.HatenaEditor,markdown:s.MarkdownEditor,raw:u.RawEditor}},70782:function(e,t,n){t.__esModule=!0,t.fetchFotolifeInfo=void 0,n(35666),n(88674),n(41539);var r,i=(r=n(73609))&&r.__esModule?r:{default:r};function o(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}var a=function(){var e,t=(e=regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){i.default.ajax({url:"/f/"+t+"/api/info?mode=detail",type:"get",cache:!1,dataType:"json"}).done((function(t){t.error&&n(t.error),e(t)})).fail((function(){return n()}))})));case 1:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function s(e){o(a,r,i,s,u,"next",e)}function u(e){o(a,r,i,s,u,"throw",e)}s(void 0)}))});return function(e){return t.apply(this,arguments)}}();t.fetchFotolifeInfo=a},42999:function(e,t,n){var r=o(n(76804)),i=o(n(38600));function o(e){return e&&e.__esModule?e:{default:e}}var a=n(73609),s=n(36500),u=n(26410),l={init:function(){a(".manage-membership-button").click((function(e){var t=e.currentTarget.dataset.circleManagePopupSelector;if(t){var n,o,l,c=a(document.querySelector(t));return n=a("html").attr("data-admin-domain")+"/-/group/"+a("html").attr("data-circle-id")+"/membership",o="manage-membership",l=c,i.default.pipe((function(e){var t;if(e){var i={width:300,height:400};i.left=Math.floor((screen.width-i.width)/2),i.top=Math.floor((screen.height-i.height)/2);var c=window.open("",o,(0,r.default)(i));(t=s.createForWindow(c,n)).addEventListener("close",(function(){t.destroy(),c.close()}))}else{var d=a("<iframe frameborder=0>").appendTo(l);(t=s.createForFrame(d[0],n)).addEventListener("close",(function(){u.hide(l)})),t.addEventListener("resize",(function(e){e&&d.css(e)})),u.show(l,{destroy:function(){d.remove(),t.destroy()}})}return t})),!1}}))}};e.exports=l},9694:function(e,t,n){n(54747),n(91038),n(78783);e.exports=function(){this.footerToggles=document.querySelectorAll(".js-footer-box-heading"),Array.from(this.footerToggles).forEach((function(e){e.addEventListener("click",(function(){e.parentNode.classList.toggle("is-open")}))}))}},11166:function(e,t,n){t.__esModule=!0,t.CaseElementComponent=void 0,n(82526),n(41817);var r=o(n(67294)),i=o(n(20996));function o(e){return e&&e.__esModule?e:{default:e}}t.CaseElementComponent=function(e){var t=e.testCase,n=e.closed,o=e.onClick,a=t.is_success?"blog.proxy_test.result.success":"blog.proxy_test.result.failure",s=i.default.text(a),u=t.is_success?"text-success":"text-failed",l=n?"table close":"table",c=n?"blogicon-chevron-down":"blogicon-chevron-up";return r.default.createElement("div",{className:"box-admin-section"},r.default.createElement("h3",{onClick:o},r.default.createElement("i",{className:c}),r.default.createElement("span",{className:u},s),t.description),r.default.createElement("table",{className:l},r.default.createElement("tbody",null,r.default.createElement("tr",null,r.default.createElement("th",null,i.default.text("blog.proxy_test.result.request")),r.default.createElement("td",null,r.default.createElement("pre",null,r.default.createElement("code",null,t.request)))),r.default.createElement("tr",null,r.default.createElement("th",null,i.default.text("blog.proxy_test.result.response")),r.default.createElement("td",null,r.default.createElement("pre",null,r.default.createElement("code",null,t.response)))))))}},20115:function(e,t,n){t.__esModule=!0,t.InvokeButton=void 0;var r=o(n(67294)),i=o(n(20996));function o(e){return e&&e.__esModule?e:{default:e}}t.InvokeButton=function(e){var t=e.onClick,n=e.isExecuting;return r.default.createElement("div",null,r.default.createElement("button",{type:"submit",onClick:t,disabled:n,className:"btn btn-primary"},i.default.text(n?"blog.proxy_test.executing":"blog.proxy_test.execute")))}},2221:function(e,t,n){t.__esModule=!0,t.ProxyTestAppComponent=void 0;var r,i=(r=n(67294))&&r.__esModule?r:{default:r};t.ProxyTestAppComponent=function(e){var t=e.isInvoked,n=e.invoke,r=e.Fetcher,o=e.InvokeButton;return i.default.createElement("div",null,i.default.createElement(o,{isExecuting:t,onClick:n}),t&&i.default.createElement(r,null))}},70059:function(e,t,n){t.__esModule=!0,t.ResultElement=void 0,n(68309),n(21249);var r,i=(r=n(67294))&&r.__esModule?r:{default:r},o=n(63550);t.ResultElement=function(e){var t=e.result;return i.default.createElement("section",{className:"admin-section"},i.default.createElement("h2",null,t.name),t.cases.map((function(e,t){return i.default.createElement(o.CaseElement,{key:t,testCase:e})})))}},38489:function(e,t,n){t.__esModule=!0,t.ResultList=void 0,n(57327),n(21249);var r=a(n(67294)),i=a(n(20996)),o=n(70059);function a(e){return e&&e.__esModule?e:{default:e}}t.ResultList=function(e){var t=e.results,n=t.reduce((function(e,t){return{resultCount:e.resultCount+t.cases.length,failedCount:e.failedCount+t.cases.filter((function(e){return!e.is_success})).length}}),{resultCount:0,failedCount:0}),a=n.resultCount,s=n.failedCount,u="blog.proxy_test.result.notification."+(s?"failure":"success");return r.default.createElement("div",null,a?r.default.createElement("div",{className:"message-info"},i.default.text(u,a,s)):null,r.default.createElement("div",null,t.map((function(e,t){return r.default.createElement(o.ResultElement,{key:t,result:e})}))))}},99078:function(e,t,n){t.__esModule=!0,t.ResultListFetcherComponent=void 0;var r,i=(r=n(67294))&&r.__esModule?r:{default:r},o=n(38489);t.ResultListFetcherComponent=function(e){var t=e.data,n=e.loading,r=e.error;if(n)return null;if(r)return null;if(!t)throw new TypeError("'data' doesn't exist");return i.default.createElement(o.ResultList,{results:t.results})}},63550:function(e,t,n){t.__esModule=!0,t.CaseElement=void 0;var r,i=(r=n(67294))&&r.__esModule?r:{default:r},o=n(52429),a=n(11166);t.CaseElement=function(e){var t=e.testCase,n=(0,o.useToggleState)(t.is_success),r=n.isToggled,s=n.toggle;return i.default.createElement(a.CaseElementComponent,{testCase:t,closed:r,onClick:s})}},46728:function(e,t,n){t.__esModule=!0,t.ProxyTestApp=void 0,n(19601);var r,i=(r=n(67294))&&r.__esModule?r:{default:r},o=n(25120),a=n(74894),s=n(2221),u=n(20115);function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}t.ProxyTestApp=function(){var e=(0,a.useProxyTestAppHooks)();return i.default.createElement(s.ProxyTestAppComponent,l({},e,{Fetcher:o.ResultListFetcher,InvokeButton:u.InvokeButton}))}},25120:function(e,t,n){t.__esModule=!0,t.ResultListFetcher=void 0;var r,i=(r=n(67294))&&r.__esModule?r:{default:r},o=n(99078),a=n(8275);t.ResultListFetcher=function(){var e=(0,a.useProxyTestFetchEffect)()[0],t=e.data,n=e.loading,r=e.error;return i.default.createElement(o.ResultListFetcherComponent,{data:t,loading:n,error:r})}},8275:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.useProxyTestFetchEffect=void 0;var r=n(91289),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=o(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(55992));function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(o=function(e){return e?n:t})(e)}t.useProxyTestFetchEffect=function(){return(0,r.useXHR)({url:i.httpsAdminUserBlogUrl("/proxy_test/result"),responseType:"json"})}},17565:function(e,t,n){t.__esModule=!0,t.ProxyTest=void 0;var r,i=(r=n(67294))&&r.__esModule?r:{default:r},o=n(73380),a=n(46728);var s=function(){function e(){}return e.init=function(e){(0,o.safeRender)(i.default.createElement(a.ProxyTestApp,null),e)},e}();t.ProxyTest=s},35652:function(e,t,n){n(4723),n(74916),n(69826);var r,i=(r=n(57942))&&r.__esModule?r:{default:r};var o=n(73609),a=n(13469),s=n(36500),u=n(17187).EventEmitter,l=n(81191),c=n(75040),d=n(68871),f=60,p=10,h=n(97165),m=function(e,t,n){e.on("mouseover",(function(){var r={top:e.offset().top,left:e.offset().left+40};t.css(r),n.show()})),e.on("mouseout",(function(){n.hide()}))},v={targetArticle:{$el:null,title:"",uri:"",uuid:""},selectedText:"",quoteInfoLoaded:function(e){e.supported&&(v.init(e),v.Stock.init(e),e.stockable?h.init(e,this):g.init(this))},init:function(){var e,t,n=this;n.eventEmitter=new u,n.$el=o(".quote-box"),o(document).on("mousedown","body",(function(t){var r=o(t.target),i=n.getClosestArticle(r);e=n.getArticleURI(i)})),o(document).on("mouseup","body",(function(r){var i=o(r.target),s=n.getClosestArticle(i);if(t=n.getArticleURI(s),i.closest(o(".hatena-star-add-button")).length>0)return r.preventDefault(),void n.hideQuoteBox();a.defer((function(){var a=d();if(!(i.closest(n.$el).length>0||i.closest(o(".quote-stock-panel")).length>0)){if(!e||e!==t||!n.isValidSelected(i,a))return n.selectedText="",n.setTargetArticle(null),void n.hideQuoteBox();n.selectedText=a,n.setTargetArticle(s),n.showQuoteBox(s,r.pageY),n.emit("selectionChanged")}}))}))},isValidSelected:function(e,t){var n=t.match(/^\s*$/);return!(e.closest(".comment").length>0)&&!n},showQuoteBox:function(e,t){var n=this.$el,r=e.offset().left-f;r=Math.max(r,p),n.css({top:t,left:r}),n.show()},hideQuoteBox:function(){this.$el.hide()},on:function(){this.eventEmitter.on.apply(this.eventEmitter,arguments)},emit:function(){this.eventEmitter.emit.apply(this.eventEmitter,arguments)},getClosestArticle:function(e){var t=e.closest("article");if(t.length<=0){var n=c();void 0!==n.focusNode&&(t=o(n.focusNode).closest("article"))}return t},getArticleURI:function(e){return e.find(".entry-title .entry-title-link").attr("href")},getArticleTitle:function(e){return e.find(".entry-title .entry-title-link").text()},getArticleUUID:function(e){return e.attr("data-uuid")},setTargetArticle:function(e){var t=this;t.targetArticle=e?{$el:e,uri:t.getArticleURI(e),title:t.getArticleTitle(e),uuid:t.getArticleUUID(e)}:{$el:null,uri:"",title:"",uuid:""}}};v.Star={init:function(){if(Hatena.Star){var e=this,t=null;e.$starButton=o(".tooltip-quote-star"),e.$starMessageBox=o("#quote-star-message-box"),e.$starButton.show(),Hatena.Star.AddButton.prototype.addStar=a.wrap(Hatena.Star.AddButton.prototype.addStar,(function(e,t){this.selectedText=v.selectedText.substr(0,200),e.call(this,t),""!==this.selectedText&&l.trackEvent("hatena-star-add-quote")})),Hatena.Star.AddButton.prototype.setupObservers=a.wrap(Hatena.Star.AddButton.prototype.setupObservers,(function(t){t.call(this),new Ten.Observer(e.$starButton[0],"onclick",this,"beforeAddStar")})),Hatena.Star.AddButton.prototype.beforeAddStar=function(e){v.targetArticle.uuid===o(this.entry.entryNode).attr("data-uuid")&&this.addStar(e)},Hatena.Star.AddButton.prototype.receiveResult=a.wrap(Hatena.Star.AddButton.prototype.receiveResult,(function(n,r){var i={top:e.$starButton.offset().top,left:e.$starButton.offset().left+40};if(r.quote&&e.$starButton.is(":visible"))if(r.isGuest){var o={x:i.left,y:i.top};o.x+=10,o.y-=25,this.lastPosition=o}else e.$starMessageBox.stop().css(a.extend(i,{opacity:1})).show(),t&&clearTimeout(t),t=setTimeout((function(){e.$starMessageBox.fadeOut(1e3)}),1e3),l.trackEvent("hatena-star-add-select");n.call(this,r)}))}}},v.Stock={init:function(e){var t=this;return t.$stockButton=o(".tooltip-quote-stock"),t.$stockMessageBox=o("#quote-stock-message-box"),t.$stockSuccessMessage=o("#quote-stock-succeeded-message"),t.$stockFailMessage=o("#quote-stock-failed-message"),t.$stockCloseMessageButton=o(".quote-stock-close-message-button"),t.$stockShowEditorButton=o("#quote-stock-show-editor-button"),t.$unstockableMessageBox=o("#unstockable-quote-message-box"),t.$quoteLoginRequiredMessageBox=o("#quote-login-required-message"),t.$quoteLoginButton=o("#quote-login-button"),t.$stockButton.show(),e.should_navigate_to_login?(t.$stockButton.on("click",(function(){var e={top:t.$stockButton.offset().top,left:t.$stockButton.offset().left+40};t.$stockMessageBox.css(e),t.$quoteLoginRequiredMessageBox.show()})),t.$quoteLoginButton.on("click",(function(){var e,t;e=(0,i.default)("admin-domain")+"/go?blog="+encodeURIComponent(v.targetArticle.uri),t="https://www.hatena.ne.jp/login?location="+encodeURIComponent(e),location.href=t})),t.$stockCloseMessageButton.on("click",(function(){t.$quoteLoginRequiredMessageBox.hide()})),!1):e.stockable?void t.setupQuoteStockButton():(m(t.$stockButton,t.$stockMessageBox,t.$unstockableMessageBox),!1)},setupQuoteStockButton:function(){var e=this;e.$stockButton.on("click",(function(){var t={top:e.$stockButton.offset().top,left:e.$stockButton.offset().left+40};e.$stockMessageBox.css(t),s.send("stockQuote",{uri:v.targetArticle.uri,title:v.targetArticle.title,selected_text:v.selectedText})})),s.addEventListener("successStockQuote",(function(){e.$stockSuccessMessage.show()})),s.addEventListener("failStockQuote",(function(){e.$stockFailMessage.show()})),e.$stockShowEditorButton.on("click",(function(){e.$stockSuccessMessage.hide(),s.send("quote-edit-entry",{})})),e.$stockCloseMessageButton.on("click",(function(){e.$stockSuccessMessage.hide(),e.$stockFailMessage.hide()}))}};var g={init:function(e){this.quote=e,this.$tweetButton=this.quote.$el.find(".js-tooltip-quote-tweet"),this.$tweetAnchor=this.quote.$el.find(".js-tooltip-quote-tweet"),this.$stockMessageBox=o("#quote-stock-message-box"),this.$unstockableErrorBox=o("#unstockable-quote-message-box"),this.$tweetButton.show(),m(this.$tweetButton,this.$stockMessageBox,this.$unstockableErrorBox)}};e.exports=v},83401:function(e,t,n){n(69826),n(15306),n(74916);var r=l(n(73609)),i=l(n(13469)),o=n(17187),a=l(n(57942)),s=n(44343),u=n(55834);function l(e){return e&&e.__esModule?e:{default:e}}var c=n(36500),d=n(81191),f=n(75040),p=n(68871),h=n(97165),m=new s.ShortenText((0,r.default)("#quote-text"),{}),v=i.default.throttle((function(){m.execute()}),800),g=function(e){e.stop().show().css("opacity",1).delay(1e3).fadeOut(1e3)},b={targetArticle:{$el:null,uri:"",title:"",uuid:""},selectedText:"",init:function(e){if(e.supported){var t=this,n=f();t.eventEmitter=new o.EventEmitter,t.$el=(0,r.default)("#quote-base"),t.$box=(0,r.default)("#quote-box"),t.$quoteText=(0,r.default)("#quote-text"),t.$loginRequiredLink=(0,r.default)(".quote-login-link"),t.$loginRequiredMessage=(0,r.default)("#quote-login-required");var i,s,l=(0,r.default)("article").first();t.targetArticle={$el:l,uri:l.find(".entry-title a").attr("href"),title:l.find(".entry-title a").text(),uuid:l.attr("data-uuid")},t.$el.on("touchend",(function(e){e.preventDefault()})),(0,r.default)(window).on("resize",(function(e){v()})),(0,r.default)("#container").on("click",(function(e){t.hideQuoteBox(e)})),(0,r.default)(document).on("selectionchange",(function(){if(!(n.rangeCount<1)){var e=(0,r.default)(n.anchorNode).parents("article").length>0,i=(0,r.default)(n.anchorNode).parents(".comment").length>0;e&&!i&&(t.selectedText=p().replace(/(^\s+)|(\s+$)/g,""),0!==t.selectedText.length&&(t.showQuoteBox(),t.emit("selectionChanged")))}})),e.should_navigate_to_login&&(i=(0,a.default)("admin-domain")+"/go?blog="+encodeURIComponent(t.targetArticle.uri),s="https://www.hatena.ne.jp/login?location="+encodeURIComponent(i),t.$loginRequiredLink.attr("href",s),t.$loginRequiredLink.on("touchend",(function(){location.href=s})),t.$loginRequiredMessage.show()),(0,u.hasFlagVariant)("new-starjs")||y.init(e),_.init(e),e.stockable?h.init(e,this):w.init(this)}},showQuoteBox:function(){this.$el.show(),m.init(this.selectedText),v()},hideQuoteBox:function(e){var t=this;t.isBoxTouched(e.target)||(t.$el.hide(),t.$quoteText.text(""),t.selectedText="")},on:function(){this.eventEmitter.on.apply(this.eventEmitter,arguments)},emit:function(){this.eventEmitter.emit.apply(this.eventEmitter,arguments)},isBoxTouched:function(e){return(0,r.default)(e).closest(this.$box).length>0}},y={init:function(e){var t=this;return t.$starButton=(0,r.default)("#quote-star-button"),t.$messageBox=(0,r.default)("#quote-star-result"),t.$errorBox=(0,r.default)("#quote-star-error"),!e.should_navigate_to_login&&(e.star_addable?(t.$starButton.addClass("available"),void t.setupQuoteStarButtonEvents()):(t.$starButton.on("touchend",(function(){return g(t.$errorBox)})),!1))},setupQuoteStarButtonEvents:function(){var e=this;Hatena.Star.AddButton.SmartPhone.prototype.addStar=i.default.wrap(Hatena.Star.AddButton.SmartPhone.prototype.addStar,(function(e,t){this.selectedText=b.selectedText.substr(0,200),e.call(this,t),""!==this.selectedText&&d.trackEvent("hatena-star-add-quote-smartphone")})),Hatena.Star.AddButton.SmartPhone.prototype.setupObservers=i.default.wrap(Hatena.Star.AddButton.SmartPhone.prototype.setupObservers,(function(t){t.call(this),new Ten.Observer(e.$starButton[0],"ontouchend",this,"beforeAddStar")})),Hatena.Star.AddButton.SmartPhone.prototype.beforeAddStar=function(e){(0,r.default)(this.entry.entryNode).attr("data-uuid")===b.targetArticle.uuid&&(Hatena.Star.AddButton.SmartPhone.AddStarPath="star.add.json",this.addStar(e),Hatena.Star.AddButton.SmartPhone.AddStarPath="star.add_multi.json")},Hatena.Star.AddButton.prototype.receiveResult=i.default.wrap(Hatena.Star.AddButton.prototype.receiveResult,(function(t,n){n.quote&&(g(e.$messageBox),d.trackEvent("hatena-star-add-select-smartphone")),t.call(this,n)}))}},_={init:function(e){var t=this;return!e.should_navigate_to_login&&(t.$stockButton=(0,r.default)("#quote-stock-button"),t.$successMessageBox=(0,r.default)("#quote-stock-result"),t.$unstockableErrorBox=(0,r.default)("#quote-unstockable-error"),t.$errorBox=(0,r.default)("#quote-stock-error"),e.stockable?(t.$stockButton.addClass("available"),void t.setupQuoteStockButtonEvents()):(t.$stockButton.on("touchend",(function(){return g(t.$unstockableErrorBox)})),!1))},setupQuoteStockButtonEvents:function(){var e=this;e.$stockButton.on("touchend",(function(){c.send("stockQuote",{uri:b.targetArticle.uri,title:b.targetArticle.title,selected_text:b.selectedText})})),c.addEventListener("successStockQuote",(function(){e.closeAllMessageBoxes(),g(e.$successMessageBox)})),c.addEventListener("failStockQuote",(function(){e.closeAllMessageBoxes(),g(e.$errorBox)}))},closeAllMessageBoxes:function(){this.$successMessageBox.hide()}},w={init:function(e){var t=this;this.quote=e,this.$unstockableErrorBox=this.quote.$el.find("#quote-unstockable-error"),this.$tweetButton=this.quote.$el.find(".js-tweet-quote"),this.$tweetButton.on("touchend",(function(){return g(t.$unstockableErrorBox)}))}};e.exports=b},97165:function(e,t,n){n(69826);var r,i=(r=n(76804))&&r.__esModule?r:{default:r};var o=n(73609),a={init:function(e,t){var n=this;this.quote=t,this.state={},this.$tweetContainer=this.quote.$el.find(".js-tooltip-quote-tweet"),this.$tweetButton=this.quote.$el.find(".js-tweet-quote"),this.$tweetButton.on("click touchend",(function(){return n.tweet()})),this.quote.on("selectionChanged",(function(){n.update(),n.render()}))},update:function(){var e="https://twitter.com/share?"+o.param({url:this.quote.targetArticle.uri,text:"“"+this.quote.selectedText+"”"});this.state={href:e}},render:function(){this.$tweetButton.attr("href",this.state.href),this.$tweetContainer.addClass("available").show()},tweet:function(){var e={width:550,height:420};e.left=Math.floor((screen.width-e.width)/2),e.top=Math.floor((screen.height-e.height)/2);var t=(0,i.default)(e);return window.open(this.state.href,"Quote.Tweet",t),!1}};e.exports=a},83521:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.Dropdown=void 0,n(21249);var r,i=n(61663),o=(r=n(86010))&&r.__esModule?r:{default:r},a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(67294));function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}t.Dropdown=function(e){var t=e.items,n=(0,a.useState)(!1),r=n[0],s=n[1],u=(0,a.useRef)(null),l=(0,a.useCallback)((function(){s(!1)}),[]);return(0,i.useOnClickOutside)(u,l),a.default.createElement("div",{className:"dropdown-window-wrapper",ref:u},a.default.createElement("button",{type:"button",className:"dropdown-toggle edit-dropdown-toggle test-dropdown-button",onClick:function(){s(!r)},onDoubleClick:function(e){e.preventDefault()}},a.default.createElement("i",{className:"blogicon-others"})),a.default.createElement("div",{className:(0,o.default)(["entries-edit-dropdown-window","dropdown-window",{"is-open":r}])},a.default.createElement("ul",{className:"list"},t.map((function(e){return a.default.createElement("li",{key:e.label},a.default.createElement("button",{type:"button",className:e.className,onClick:function(t){s(!1),e.onClick&&e.onClick(t)}},e.icon&&a.default.createElement("i",{className:e.icon}),e.icon&&" ",e.label))})))))}},49383:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.Tabs=void 0,n(21249),n(68309);var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=i(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=o?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(67294));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(i=function(e){return e?n:t})(e)}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var a=n(19165),s=function(e){var t,n;function i(t){var n;return(n=e.call(this,t)||this).state={currentTab:""},n}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,o(t,n);var s=i.prototype;return s.componentDidMount=function(){var e=a.load(this.props.localStoragePrefix),t=this.props.tabs.some((function(t){return t.key===e}))?e:this.props.tabs[0].key;this._updateState(t)},s._updateState=function(e){this.setState({currentTab:e})},s.render=function(){return r.createElement("div",{className:"react-tabs"+(this.props.className?" "+this.props.className:"")},r.createElement("div",{className:"react-tabs-list"},this._renderTabListItems()),r.createElement("div",{className:"react-tabs-contents"},this._renderTabContents()))},s._renderTabListItems=function(){var e=this;return this.props.tabs.map((function(t){var n=t.key===e.state.currentTab;return r.createElement("div",{key:"-"+t.key,className:"react-tabs-list-item"+(n?" active":""),onClick:function(){return e._onClick(t)}},t.name)}))},s._renderTabContents=function(){var e=this;return this.props.tabs.map((function(t){var n=t&&t.component?t.component:null;return r.createElement("div",{key:"-"+t.key,className:"react-tabs-content",style:t.key===e.state.currentTab?void 0:{display:"none"}},n&&r.createElement(n,t.props))}))},s._onClick=function(e){this._updateState(e.key),a.save(this.props.localStoragePrefix,e.key),this.props.onSelect&&this.props.onSelect.call(null,e.key)},i}(r.Component);t.Tabs=s},46852:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.HatenaIDWithNickname=void 0,n(21249);var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=i(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=o?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n(67294));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(i=function(e){return e?n:t})(e)}t.HatenaIDWithNickname=function(e){var t=e.loading,n=e.nickname,i=e.hatenaId,o=e.authors;return t?r.default.createElement(r.default.Fragment,null,i):null!=o&&o.length?r.default.createElement(r.default.Fragment,null,o.map((function(e,t){return r.default.createElement(r.Fragment,{key:t},t?r.default.createElement("span",{className:"user-name-delimiter"},", "):null,r.default.createElement("span",{className:"user-name-author"},e))}))):n?r.default.createElement(r.default.Fragment,null,r.default.createElement("span",{className:"user-name-nickname"},n)," ",r.default.createElement("span",{className:"user-name-paren"},"("),r.default.createElement("span",{className:"user-name-hatena-id"},"id:",i),r.default.createElement("span",{className:"user-name-paren"},")")):r.default.createElement(r.default.Fragment,null,i)}},76932:function(e,t,n){t.__esModule=!0,t.Nickname=void 0;var r,i=(r=n(67294))&&r.__esModule?r:{default:r},o=n(76386),a=n(46852);t.Nickname=function(e){var t=e.dataloader,n=e.hatenaID,r=e.authors,s=(0,o.useFetchNickname)({dataloader:t,hatenaID:n}),u=s.loading,l=s.result;return i.default.createElement(a.HatenaIDWithNickname,{nickname:null==l?void 0:l.nickname,hatenaId:n,loading:u,authors:r})}},68853:function(e,t,n){n(4129),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.createNicknameDataloader=void 0,n(35666),n(21249),n(88674),n(41539);var r,i=(r=n(45933))&&r.__esModule?r:{default:r},o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(347));function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}function s(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}var u=function(){var e,t=(e=regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.default.get("https://pf-api.hatena.com/profile/profiles",{responseType:"json",params:{name:t},transformRequest:o.removeXRequestWith,paramsSerializer:o.traditionalDataRequest});case 2:return n=e.sent,e.abrupt("return",t.map((function(e){return n.data[e]||new Error("hatenaID:"+e+" is not found")})));case 4:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){s(o,r,i,a,u,"next",e)}function u(e){s(o,r,i,a,u,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}();t.createNicknameDataloader=function(){return new i.default(u,{maxBatchSize:20})}},76386:function(e,t,n){t.__esModule=!0,t.useFetchNickname=void 0;var r=n(84793);t.useFetchNickname=function(e){var t=e.dataloader,n=e.hatenaID;return(0,r.useAsync)((function(){return t.load(n)}),[t,n])}},61663:function(e,t,n){t.__esModule=!0,t.useOnClickOutside=void 0;var r=n(67294);t.useOnClickOutside=function(e,t){(0,r.useEffect)((function(){var n=function(n){e.current&&!e.current.contains(n.target)&&t()};return document.addEventListener("click",n),function(){document.removeEventListener("click",n)}}),[e,t])}},25680:function(e,t,n){t.__esModule=!0,t.useStateWithConfigStorage=void 0;var r=n(67294),i=n(19165);t.useStateWithConfigStorage=function(e,t){var n,o=(0,r.useState)(null!==(n=i.load(e))&&void 0!==n?n:t),a=o[0],s=o[1];return(0,r.useEffect)((function(){i.save(e,a)}),[e,a]),[a,s]}},52429:function(e,t,n){t.__esModule=!0,t.useToggleState=void 0;var r=n(67294);t.useToggleState=function(e){var t=(0,r.useState)(e),n=t[0],i=t[1],o=(0,r.useCallback)((function(){i(!n)}),[n]);return{isToggled:n,toggle:o}}},7307:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.Star=void 0,n(68309),n(15306),n(74916),n(15218),n(69826);var r=f(n(73609)),i=f(n(13469)),o=f(n(57942)),a=f(n(20996)),s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=d(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(55992)),u=n(55834),l=f(n(76804)),c=n(78899);function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(d=function(e){return e?n:t})(e)}function f(e){return e&&e.__esModule?e:{default:e}}var p=n(81191),h=n(28507);(0,u.hasFlagVariant)("new-starjs")||function(){if(Hatena.Star){var e={entryNodes:{"article.entry":{uri:".hatena-star-metadata .hatena-star-permalink",title:".hatena-star-metadata .hatena-star-permalink",container:"div.hatena-star-container"},"section.archive-entry":{uri:".hatena-star-metadata .hatena-star-permalink",title:".hatena-star-metadata .hatena-star-permalink",container:"span.star-container"},".entry-article":{uri:".hatena-star-metadata .hatena-star-permalink",title:".hatena-star-metadata .hatena-star-permalink",container:"div.hatena-star-container"},"li.entry-comment":{uri:"p.comment-metadata a.permalink",title:"div.comment-content",container:".comment-metadata"}}},t={entryNodes:{"li.entry-comment":{uri:"p.comment-metadata a.permalink",title:"div.comment-content::-ten-truncate",container:".comment-metadata"}}};Hatena.Star.SiteConfig=e,Hatena.Star.EntryLoader.intoCommentScope=function(n){Hatena.Star.SiteConfig=t,n(),Hatena.Star.SiteConfig=e},Hatena.Star.User.prototype.userPage=function(){return(0,o.default)("admin-domain")+"/"+this.name+"/"};var n=s.staticUrl("/images/theme/star/hatena-star-add-button.svg");Hatena.Star.AddButton.ImgSrc=n,Hatena.Star.AddButton.SmartPhone.ImgSrc=n,Hatena.Star.noComments=!0}}();var m={initBigStar:function(){Hatena.Star&&(Hatena.Star.Star.prototype.generateImg=function(){var e,t=Hatena.Star.Star.getImage(this.container);if(t.alt=this.screen_name,t.title="",this.color&&"yellow"!==this.color&&"temp"!==this.color&&(t.alt=t.alt+" ("+this.color+")"),this.img=t,this.screen_name){if(Hatena.Star.Star.gotImage[this.screen_name]||(Hatena.Star.Star.gotImage[this.screen_name]={}),!Hatena.Star.Star.gotImage[this.screen_name][this.color]){var n=document.createElement("span");n.className="hatena-big-star-star-container";var r=document.createElement("img");r.src=(e=this.screen_name,"https://cdn.profile-image.st-hatena.com/users/"+encodeURI(e)+"/profile.png"),r.setAttribute("tabIndex","0"),r.className="hatena-star-user",r.style.padding="0",r.style.border="none",n.appendChild(r),n.appendChild(t),Hatena.Star.Star.gotImage[this.screen_name][this.color]=n}this.img=Hatena.Star.Star.gotImage[this.screen_name][this.color].cloneNode(!0)}},Hatena.Star.AddButton.prototype.showColorPallet=function(){this.clearSelectedColorTimer(),this.pallet||(this.pallet=new Hatena.Star.Pallet);var e=Ten.Geometry.getElementPosition(this.img);e.x+=2,e.y+=22,this.pallet.showPallet(e,this)},Hatena.Star.AddButton.SmartPhone.prototype.showColorPallet=function(){this.clearSelectedColorTimer(),this.pallet||(this.pallet=new Hatena.Star.Pallet.SmartPhone);var e=Ten.Geometry.getElementPosition(this.img);e.x=Ten.Browser.isDSi?5:15,e.y+=30,this.pallet.showPallet(e,this),this.pallet.show(Hatena.Star.UseAnimation?{x:0,y:0}:e)},Hatena.Star.AddButton.prototype.addStar=i.default.wrap(Hatena.Star.AddButton.prototype.addStar,(function(e,t){e.apply(this,[t]),p.trackEvent("hatena-star-add")})),Hatena.Star.AddButton.SmartPhone.prototype.addStar=i.default.wrap(Hatena.Star.AddButton.SmartPhone.prototype.addStar,(function(e,t){e.apply(this,[t]),p.trackEvent("hatena-star-add-smartphone")})))},initStarNavigation:function(){if(Hatena.Star){var e=(0,r.default)("<div>").addClass("star-navigation-tooltip").append((0,r.default)("<p>").text(a.default.text("star-navigation-message")));r.default.getJSON("https://www.hatena.ne.jp/notify/notices.count.json?services=1&callback=?",(function(t){if(!t.services.s){Hatena.Star.AddButton.prototype.addStar=i.default.wrap(Hatena.Star.AddButton.prototype.addStar,(function(e,t){e.apply(this,[t]),p.trackEvent("hatena-star-add-first")}));var n="Hatena.Diary.Blogs.StarNavigation.Read",o=function(e){try{localStorage[n]=e?"already":"not yet"}catch(e){}};if(!function(){try{return"already"===localStorage[n]}catch(e){return!1}}()){!function e(t){setTimeout((function(){0===(0,r.default)(".hatena-star-add-button").length?e(t):t()}),200)}((function(){(0,r.default)(".hatena-star-container").after(e),(0,r.default)(".star-navigation-tooltip").click((function(){o(!0),(0,r.default)(this).fadeOut(1e3)})),(0,r.default)(".hatena-star-add-button").click((function(){o(!0),(0,r.default)(".star-navigation-tooltip").fadeOut(1e3)}))}))}}}))}},initDeleteStar:function(){Hatena.Star&&(Hatena.Star.Star.prototype.setImgObservers=function(){var e=this;new Ten.Observer(e.img,"onmouseover",e,"showName"),new Ten.Observer(e.img,"onmouseout",e,"hideName")},Hatena.Star.Star.prototype.asElement=i.default.wrap(Hatena.Star.Star.prototype.asElement,(function(e){var t=this,n=e.call(t);if(!Hatena.Star.Config.isStarDeletable)return n;var o=i.default.once((function(){var e=r.default.Deferred(),n=Hatena.Star.BaseURL.replace(/^http:/,Hatena.Star.BaseURLProtocol)+"star.deletable.json",i={name:t.name,uri:t.entry.uri,color:t.color?t.color:void 0,quote:t.quote?t.quote:void 0};return r.default.ajax({type:"get",dataType:"jsonp",url:n,data:i}).done((function(t){t.result&&(t.message||t.confirm_html)?e.resolve(t):e.reject(t)})),e})),a=(0,r.default)(t.anchor);return a.hover((function(){o().done((function(e){var n=(0,r.default)("<img>").addClass("star-delete-button").attr("src",s.staticUrl("/images/theme/star/star-delete.svg"));a.append(n);var i=n.position();n.css({left:i.left-9,top:i.top}),n.click((function(){if(e.confirm_html){var n=Ten.Geometry.getElementPosition(t.anchor);(new Hatena.Star.DeleteConfirmScreen).showConfirm(e.confirm_html,t,n)}else confirm(e.message)&&t.deleteStar();return!1}))}))}),(function(){(0,r.default)(this).find(".star-delete-button").remove()})),n})))},initStarForThirdPartyCookiesDisabled:function(){h((function(){return Hatena.Star}),(function(){i.default.extend(Hatena.Star.AddButton.prototype,{addStar:function(){var e=this,t="https://s.hatena.ne.jp/star.add?"+r.default.param({uri:e.entry.uri,location:(0,o.default)("admin-domain")+"/-/close"}),n={width:500,height:200,left:Math.floor((screen.width-500)/2),top:Math.floor((screen.height-200)/2)},i=(0,l.default)(n),a=window.open(t,"add_star",i);h((function(){return null==a?void 0:a.closed}),(function(){(0,c.updateDynamicPieces)((0,r.default)(e.entry.entryNode.parentNode))}))},showColorPallet:function(){},showColorPalletDelay:function(){}})}))},setDetailURLForTouch:function(){Hatena.Star&&(Hatena.Star.getSmartPhoneDetailURL=function(e){return s.httpsAdminUrl("/"+e.screen_name+"/")})}};t.Star=m},21655:function(e,t,n){t.__esModule=!0,t.SubscribeButtonAdmin=void 0;var r=n(26464),i=a(n(13469)),o=a(n(57942));function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u=function(e){var t,n;function r(t,n,r){var i;return(i=e.call(this,t,n,r)||this).initMessages(),i}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,s(t,n);var a=r.prototype;return a.initMessages=function(){var e=this;window.addEventListener("storage",(function(t){if("subscription"===t.key){var n=JSON.parse(t.newValue||"")[e.blog.blogUrl];n!==e.user.isSubscribing&&(!0===n&&e.subscribe(),!1===n&&e.unsubscribe())}}))},a.openSubscribeWindow=function(){var e=location.href,t=encodeURIComponent(e),n=(0,o.default)("admin-domain")+"/"+(0,o.default)("author")+"/"+(0,o.default)("blog")+"/subscribe?from_url="+t+"&utm_source=iframe_subscribe_button&utm_medium=button&utm_campaign=subscribe_blog";window.open(n)},a.toggleState=function(){this.user.isSubscribing?(this.unsubscribe(),r.setSubscription(this.blog.blogUrl,!1)):(this.subscribe(),r.setSubscription(this.blog.blogUrl,!0))},r.setSubscription=function(e,t){var n=JSON.parse(window.localStorage.getItem("subscription")||"");(n=i.default.isObject(n)?n:{})[e]=t,window.localStorage.setItem("subscription",JSON.stringify(n))},r}(r.SubscribeButton);t.SubscribeButtonAdmin=u},26464:function(e,t,n){t.__esModule=!0,t.SubscribeButton=void 0,n(69826);var r=o(n(73609)),i=o(n(57942));function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s=function(){function e(e){a(this,"isSubscribing",void 0),a(this,"isGuest",void 0),this.isSubscribing=e.isSubscribing||!1,this.isGuest=e.isGuest||!1}return e.prototype.toggle=function(){this.isSubscribing=!this.isSubscribing},e}(),u=function(){function e(e){a(this,"subscribersCount",void 0),a(this,"blogUrl",void 0),a(this,"blogName",void 0),a(this,"requestUrl",void 0),this.subscribersCount=+((null==e?void 0:e.subscribersCount)||0),this.blogUrl=e.blogUrl,this.blogName=e.blogName,this.requestUrl=e.requestUrl}var t=e.prototype;return t.requestUpdate=function(e){return r.default.ajax({type:"POST",url:this.requestUrl,data:{rkm:(0,i.default)("rkm"),rkc:(0,i.default)("rkc"),delete:e.isSubscribing?1:0}})},t.updateSubscribersCount=function(e){this.subscribersCount+=e.isSubscribing?1:-1},e}(),l=function(){function e(e,t,n){a(this,"$el",void 0),a(this,"user",void 0),a(this,"blog",void 0),a(this,"$subscribeBtn",void 0),a(this,"$subscriptionCount",void 0),a(this,"$subscriptionCountBox",void 0),this.$el=e,this.user=new s(t),this.blog=new u(n),this.$subscribeBtn=this.$el.find(".js-hatena-follow-button"),this.$subscriptionCount=this.$el.find(".js-subscription-count"),this.$subscriptionCountBox=this.$el.find(".js-subscription-count-box"),this.updateViews(),this.initEvents()}var t=e.prototype;return t.initEvents=function(){var e=this;this.$subscribeBtn.on("mouseenter",(function(){e.$subscribeBtn.addClass("hover")})).on("mouseleave",(function(){e.$subscribeBtn.removeClass("hover")})).on("click",(function(){var t=e.$subscribeBtn.offset();return t.top+=e.$subscribeBtn.height(),e.openSubscribeWindow(t),!1}))},t.updateViews=function(){var e=this.user.isSubscribing;this.$subscribeBtn.addClass(e?"subscribing":"unsubscribing").removeClass(e?"unsubscribing":"subscribing"),this.$subscribeBtn.removeClass("hover"),this.updateCountBox()},t.updateCountBox=function(){this.blog.subscribersCount>=1?(this.$subscriptionCountBox.show(),this.$subscriptionCount.text(this.blog.subscribersCount)):this.$subscriptionCountBox.hide()},t.subscribe=function(){this.user.isSubscribing=!0,this.blog.subscribersCount++,this.updateViews()},t.unsubscribe=function(){this.user.isSubscribing=!1,this.blog.subscribersCount--,this.updateViews()},e}();t.SubscribeButton=l},74302:function(e,t,n){t.__esModule=!0,t.SubscribeButtonBlogs=void 0;var r=n(26464),i=s(n(73609)),o=s(n(57942)),a=s(n(76804));function s(e){return e&&e.__esModule?e:{default:e}}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=n(36500),f=function(e){var t,n;function r(t,n,r,i,o){var a;return c(u(a=e.call(this,t,n,r)||this),"messenger",void 0),c(u(a),"utmSource",void 0),a.utmSource=o,a.messenger=i,a.initMessages(),a}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,l(t,n);var s=r.prototype;return s.initMessages=function(){var e=this;this.messenger.addEventListener("subscription",(function(t){var n=t[e.blog.blogUrl];n!==e.user.isSubscribing&&(!0===n&&e.subscribe(),!1===n&&e.unsubscribe())}))},s.openSubscribeWindow=function(e,t){var n=location.href,r=encodeURIComponent(n),i=encodeURIComponent(this.utmSource),a=(0,o.default)("admin-domain")+"/"+(0,o.default)("author")+"/"+(0,o.default)("blog")+"/subscribe?from_url="+r+"&utm_source="+i+"&utm_medium=button&utm_campaign=subscribe_blog";window.open(a)},s.subscribeButtonHandlerWindow=function(e){var t=this,n={width:300,height:150};n.left=Math.floor((screen.width-n.width)/2),n.top=Math.floor((screen.height-n.height)/2);var r=window.open("","subscribe",(0,a.default)(n)),o=d.createForWindow(r,e);o.addEventListener("done",(function(){t.toggleState(),s()}));var s=function(){o.destroy(),null==r||r.close()};o.addEventListener("close",s),(0,i.default)(document.body).one("focus",s)},s.toggleState=function(){var e={};e[this.blog.blogUrl]=!this.user.isSubscribing,this.messenger.send("subscription",e)},r}(r.SubscribeButton);t.SubscribeButtonBlogs=f},92901:function(e,t,n){var r=n(21655),i=n(74302);e.exports={Admin:r.SubscribeButtonAdmin,Blogs:i.SubscribeButtonBlogs}},51525:function(e,t,n){t.__esModule=!0,t.SENTRY_IGNORE_ERRORS=t.excludeEventDefinedByUser=void 0,n(41539),n(66992),n(33948),n(24603),n(74916),n(39714);t.excludeEventDefinedByUser=function(e,t){var n=e.exception&&e.exception.values&&e.exception.values[0]?e.exception.values[0].stacktrace:null,r=n?n.frames:null;if(r&&r.length>0){var i=r[r.length-1].filename;if(i&&new RegExp("^"+t).test(i))return e}return null};t.SENTRY_IGNORE_ERRORS=[/execute code from a freed script/,/SecurityError.*Blocked.*/,/TypeError.*valve.*/,/.*t\[0\] is undefined.*/,/.*evaluating 'e\.offset\(\)\.left'.*/,/.*Unable to get property 'left' of undefined.*/,/.*Cannot read property 'left' of undefined.*/,/.*TypeError: e\.offset\(\.\.\.\) is undefined.*/,/'_checkRecommendVisibleMain' is undefined/,/.*_checkRecommendVisibleMain.*/,/.*undefined is not an object \(evaluating 'document\.getElementsByTagName\('video'\)\[0\]\.src'\).*/]},37119:function(e,t,n){t.__esModule=!0,t.default=void 0,n(69826);var r,i=(r=n(73609))&&r.__esModule?r:{default:r};var o=function(e){var t=e.$container,n=e.key,r=e.onchange;if(localStorage){var o="Hatena.Diary.Util.backupTab."+n;!function(){var e=localStorage[o];if(void 0!==e){var n=t.find('input[value="'+e+'"]');n.trigger("click"),r(n)}}(),t.on("change","input",(function(e){var t,n=(0,i.default)(e.currentTarget);t=n.val(),localStorage[o]=t,r(n)}))}};t.default=o},60361:function(e,t,n){t.__esModule=!0,t.bookmarkLoader=void 0,n(88674),n(41539),n(60285),n(78783),n(66992),n(33948),n(54747);var r=o(n(347)),i=o(n(51068));function o(e){return e&&e.__esModule?e:{default:e}}var a={loadBlogBookmarksCount:function(e){return r.default.get("/api/hatena_bookmark/blog_bookmarks_count",{params:{blog_id:e},responseType:"json"})},loadEntriesBookmarksCount:function(e,t){return r.default.get("/api/hatena_bookmark/entries_bookmarks_count",{params:{blog_id:e,e:t},responseType:"json"})},loadEntryBookmarksCountDirectly:function(e){return r.default.get("https://bookmark.hatenaapis.com/count/entry",{adapter:i.default,params:{url:e}})},loadEntriesBookmarksCountDirectly:function(e){if(e.length>50)throw new Error("you can only specify up to 50 urls");if(0===e.length)return Promise.resolve({data:{},status:200});var t=new URL("https://bookmark.hatenaapis.com/count/entries");return e.forEach((function(e){t.searchParams.append("url",e)})),r.default.get(t.href,{adapter:i.default})}};t.bookmarkLoader=a},86965:function(e,t,n){t.__esModule=!0,t.canonicalizeColor=void 0,n(4723),n(74916),n(47042),n(41539),n(39714);t.canonicalizeColor=function(e){var t,n="";if(t=e.match(/#([0-9a-f]{6})/i))n=t[1];else if(t=e.match(/#([0-9a-f])([0-9a-f])([0-9a-f])/i))n=t[1]+t[1]+t[2]+t[2]+t[3]+t[3];else if(t=e.match(/rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d+)\s*)?/)){n=t[4]&&0==+t[4]?"":("0"+(+t[1]).toString(16)).slice(-2)+("0"+(+t[2]).toString(16)).slice(-2)+("0"+(+t[3]).toString(16)).slice(-2)}return n.toLowerCase()}},96341:function(e,t,n){t.__esModule=!0,t.characterLength=void 0,n(15306),n(74916);t.characterLength=function(e){return e.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"_").length}},76490:function(e,t,n){n(47941),n(54747),e.exports=function(e){var t=Object.keys(e);return function(n,r){void 0===n&&(n={});var i={};return t.forEach((function(t){var o=e[t];i[t]=o(n[t],r)})),i}}},35340:function(e){e.exports=function(e){return JSON.parse(JSON.stringify(e))}},61875:function(e){e.exports=function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&!Object.prototype.hasOwnProperty.call(e,n)&&(e[n]=t[n])}},24367:function(e,t,n){t.__esModule=!0,t.formatCategoryName=void 0,n(15306),n(74916),n(73210);t.formatCategoryName=function(e){return e.trim().replace(/[\r\n]+/g,"")}},849:function(e,t,n){t.__esModule=!0,t.default=void 0,n(23123),n(74916),n(41539),n(39714);var r=function(e){return e.toString().split("").reverse().reduce((function(e,t,n){return 0!==n&&n%3==0?t+","+e:t+e}))};t.default=r},74868:function(e,t,n){t.__esModule=!0,t.formatDuration=void 0,n(41539),n(39714);t.formatDuration=function(e){var t=Math.floor(e/3600),n=Math.floor(e%3600/60),r=Math.floor(e%3600%60),i=t.toString(),o=n.toString(),a=r.toString(),s="";return t>0&&(s+=i+":",n<10&&(o="0"+o)),r<10&&(a="0"+a),s+=o+":"+a}},75040:function(e){e.exports=function(){return window.getSelection?window.getSelection():document.getSelection?document.getSelection():{}}},68871:function(e){e.exports=function(){return window.getSelection?""+(window.getSelection()||""):document.getSelection?document.getSelection():document.selection?document.selection.createRange().text:""}},77289:function(e,t,n){n(54747),e.exports=function(e,t){var n={};return e.forEach((function(e){n[e[t]]=e})),n}},46955:function(e,t,n){t.__esModule=!0,t.inheritGA=void 0,n(64765),n(74916);var r,i=(r=n(80129))&&r.__esModule?r:{default:r};t.inheritGA=function(e,t){var n=document.createElement("a");if(n.href=e,!n.search)return t;var r=i.default.parse(n.search.substring(1))._ga;if(!r)return t;var o=document.createElement("a");o.href=t;var a=i.default.parse(o.search.substring(1));return a._ga=r,o.search=i.default.stringify(a),o.href}},72005:function(e,t,n){var r=n(70879),i=n(73609);e.exports=function(e,t){var n=i(e.children()[0]);if(0!==n.length){var o=i(document),a=i("#container"),s=function(){var r=e.offset(),i=o.scrollTop(),s=n.height(),u=a.offset().top,l=a.height();i+u<r.top?n.css({position:"static"}):!t||i<l-s?n.css({position:"fixed",top:u,left:r.left}):n.css({position:"absolute",top:u+l-s,left:r.left})};i(window).scroll(s).resize((function(){var t=e.offset();n.css({left:t.left})})),s()}else(0,r.BUG)("ad element not found: "+e.html(),"followedAd")}},43652:function(e,t){t.__esModule=!0,t.isIframe=void 0;t.isIframe=function(e){return e.parent!==e}},42807:function(e,t,n){n(21249);var r=n(73609),i=n(13469);e.exports=function(e){var t,n=r.Deferred(),o=0,a=function(){++o===e.length&&n.resolve(t)},s=function(){n.reject(t)};return t=i.map(e,(function(e){var t=r("<img>");return t.on("load",a).on("error",s).attr("src",e),t[0]})),n.promise()}},34418:function(e,t,n){n(40561),n(69826);var r=n(73609),i=n(13469),o=i.template('<span class="user-name-nickname"><%- nickname %></span> <span class="user-name-paren">(</span><span class="user-name-hatena-id">id:<%- hatenaId %></span><span class="user-name-paren">)</span>'),a=function e(t,n){var i=n.splice(0,20);r.ajax({url:"https://pf-api.hatena.com/profile/profiles",dataType:"json",data:{name:i},traditional:!0}).done((function(i){!function(e,t){e.each((function(){var e=r(this),n=e.attr("data-user-name");if(t[n]&&t[n].nickname){var i=o({nickname:t[n].nickname,hatenaId:n});e.html(i)}}))}(t,i),n.length>0&&e(t,n)}))};e.exports=function(e){var t=e.find("[data-load-nickname]"),n=[];t.each((function(){var e=r(this).attr("data-user-name");n.push(e)})),0!==(n=i.uniq(n)).length&&a(t,n)}},1514:function(e,t,n){var r=n(73609),i=n(13469);e.exports=function(e){return i.each(e,(function(t,n){i.isArray(t)&&1===t.length&&(e[n]=t[0])})),location.pathname+"?"+r.param(e)}},10665:function(e,t,n){t.__esModule=!0,t.migrateOldStyleYoutubeURL=void 0,n(4723),n(74916),n(23123),n(15306);t.migrateOldStyleYoutubeURL=function(e,t){return e.match(/\/v\//i)&&(e=(e=e.split(/[?&]/)[0]).replace(/\/v\//i,"/embed/")),e=e.replace("youtube.googleapis.com","www.youtube.com"),"https:"!==t&&(e=e.replace(/^https:/,"")),e}},74350:function(e,t,n){n(4723),n(74916);n(73609);var r=n(13469);e.exports=function(e){e.need_comrule2013&&r.defer((function(){var e=location.hostname.match(/\.hatena\.[^:]+/)[0];window.top.location.href="http://www"+e+"/login?need_comrule2013=1"}))}},23218:function(e,t,n){t.__esModule=!0,t.default=void 0,n(4723),n(74916);t.default=function(e){var t=e.match(/(\d+)-(\d+)-(\d+)T(\d+):(\d+):(\d+)(?:([+|-])(\d+):(\d+)|Z)/);if(!t)return null;var n=new Date(Date.UTC(+t[1],+t[2]-1,+t[3],+t[4],+t[5],+t[6]));return"+"===t[7]?n.setHours(n.getHours()-+t[8],n.getMinutes()-+t[9]):"-"===t[7]&&n.setHours(n.getHours()+ +t[8],n.getMinutes()+ +t[9]),n}},76804:function(e,t,n){t.__esModule=!0,t.default=void 0,n(69600),n(21249),n(47941);var r=function(e){return Object.keys(e).map((function(t){return t+"="+e[t]})).join(",")};t.default=r},1780:function(e,t,n){n(69826);var r=n(13469);e.exports=function(e){r.defer((function(){e.find(":submit").prop("disabled",!0)}))}},847:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),t.__esModule=!0,t.renderNicknames=void 0,n(54747);var r,i=(r=n(67294))&&r.__esModule?r:{default:r},o=n(73380),a=n(68853),s=n(76932),u=n(70879),l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=c(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(78558));function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(c=function(e){return e?n:t})(e)}var d=l.array(l.string());t.renderNicknames=function(e){if(e){var t=e.querySelectorAll("[data-load-nickname]"),n=(0,a.createNicknameDataloader)();t.forEach((function(e){var t=e.getAttribute("data-user-name"),r=function(e){if(!e)return[];try{return d.parse(JSON.parse(e))}catch(e){return(0,u.BUG)(e,"renderNicknames: input invalid data attribute"),[]}}(e.getAttribute("data-authors"));t&&(0,o.safeRender)(i.default.createElement(s.Nickname,{dataloader:n,hatenaID:t,authors:r}),e)}))}}},82667:function(e,t,n){t.__esModule=!0,t.replaceYoutubeURL=void 0,n(69826);var r,i=(r=n(73609))&&r.__esModule?r:{default:r},o=n(10665);t.replaceYoutubeURL=function(e){var t=e.get(0).ownerDocument.location.protocol;e.find('iframe[src*="youtube.com/"],iframe[src*="youtube.googleapis.com/"]').each((function(e,n){var r=(0,i.default)(n),a=r.attr("src"),s=(0,o.migrateOldStyleYoutubeURL)(a,t);a!==s&&r.attr("src",s)}))}},67279:function(e,t,n){var r=n(36500);e.exports=function(){var e=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight);r.send("resize",{height:e})}},44343:function(e,t,n){function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}t.__esModule=!0,t.ShortenText=void 0,n(19601),n(47042);var i=function(){function e(e,t){r(this,"options",void 0),r(this,"$el",void 0),r(this,"originalText",""),this.options=Object.assign({symbol:"...",reduce:1},t),this.$el=e,this.$el.css({overflow:"hidden"})}var t=e.prototype;return t.init=function(e){this.originalText=e},t.execute=function(){var e=this.originalText,t=this.$el,n=t.clone();n.attr("id","").css({display:"none",position:"absolute",overflow:"visible",width:t.css("width"),height:"auto"}).text(e),t.after(n);var r=e,i=e;if(n.height()>t.height())for(;r.length>0&&n.height()>t.height();){var o=this.shorten(r);r=o[0],i=o[1],n.text(i)}t.text(i),n.remove()},t.shorten=function(e){var t=this.options,n=[e.slice(0,Math.floor((e.length-t.reduce)/2)),t.symbol,e.slice(Math.floor((e.length-t.reduce)/2)+t.reduce,e.length)];return[n[0]+n[2],n[0]+n[1]+n[2]]},e}();t.ShortenText=i},48379:function(e,t,n){t.__esModule=!0,t.showBookmarkCounts=void 0,n(35666),n(91038),n(78783),n(54747),n(88674),n(41539);var r=n(60361);function i(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}var o=function(){var e,t=(e=regeneratorRuntime.mark((function e(){var t,n,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=document.querySelectorAll(".js-bookmark-count"),n=Array.from(t,(function(e){return e.getAttribute("data-entry-url")||""})),e.next=4,r.bookmarkLoader.loadEntriesBookmarksCountDirectly(n);case 4:i=e.sent,o=i.data,t.forEach((function(e){var t=e.getAttribute("data-entry-url")||"",n=o[t];n&&(e.textContent=String(n))}));case 7:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function s(e){i(a,r,o,s,u,"next",e)}function u(e){i(a,r,o,s,u,"throw",e)}s(void 0)}))});return function(){return t.apply(this,arguments)}}();t.showBookmarkCounts=o},32920:function(e,t,n){var r=n(73609),i=n(13469),o=n(26410);e.exports=function(e){var t=r('<div class="hatena-globalheader-window message"><div class="message">'+i.escape(e)+"</div></div>").css({width:200,height:"auto",right:"auto",left:(r(window).width()-200)/2}).appendTo(document.body);o.show(t,{destroy:function(){t.remove()}})}},9467:function(e,t,n){t.__esModule=!0,t.starLoader=void 0;var r,i=(r=n(347))&&r.__esModule?r:{default:r};var o={loadBlogStarsCounts:function(e){return(0,i.default)({method:"get",url:"/api/hatena_star/blog_stars_counts",params:{blog_id:e},responseType:"json"})},loadEntriesStarsCount:function(e,t){return(0,i.default)({method:"get",url:"/api/hatena_star/entries_stars_count",params:{blog_id:e,e:t},responseType:"json"})}};t.starLoader=o},26307:function(e,t){t.__esModule=!0,t.default=void 0;var n="text-unselectable",r=document.body,i={on:function(){r&&r.classList.add(n)},off:function(){r&&r.classList.remove(n)}};t.default=i},78899:function(e,t,n){t.__esModule=!0,t.updateDynamicPieces=void 0,n(69826);var r,i=(r=n(20996))&&r.__esModule?r:{default:r},o=n(847),a=n(55834);var s=n(50477);t.updateDynamicPieces=function(e){i.default.updateTimestamps(e[0]),(0,a.hasFlagVariant)("new-starjs")?document.dispatchEvent(new Event("hatena:star:requestrendering")):Hatena.Star&&Hatena.Star.WindowObserver.loaded&&(e.find("span.hatena-star-comment-container, span.hatena-star-star-container").remove(),Hatena.Star.EntryLoader.loadNewEntries(e[0])),(0,o.renderNicknames)(e.get(0)),s.load(e)}},28507:function(e){e.exports=function(e,t,n){n||(n=500);var r=function(){return!!e()&&(t(),!0)};if(!r())var i=setInterval((function(){r()&&clearInterval(i)}),n)}},74126:function(e,t,n){var r,i=(r=n(57942))&&r.__esModule?r:{default:r};n(5010);var o=n(13469);window._=o,window.Messenger=n(36500),window.keyString=n(41960),window.Hatena=window.Hatena||{},n.p=(0,i.default)("static-domain")+"/js/",window.Hatena.Diary=o.extend(window.Hatena.Diary||{},{AppAPI:n(39769),GlobalHeader:n(75225),GlobalHeaderPage:n(11229)}),n(56412).setControllers(n(26065)),n(34157)()},34157:function(e,t,n){n(4129),n(41539),n(78783),n(66992),n(33948),n(38880),n(9653);var r,i=n(70879),o=(r=n(57942))&&r.__esModule?r:{default:r},a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=l(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(n(33646)),s=n(40533),u=n(51525);function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(l=function(e){return e?n:t})(e)}var c=n(73609),d=n(13469),f=n(81191),p=n(91269),h=n(37914),m=n(56412),v=n(85814),g=n(6220),b=!1;e.exports=function(){c((function(){b||(b=!0,p.load(),m.loadPage(),f.setupTrack(),g(),v())})),h.domainType()===h.Admin&&(window.onerror=d.once((function(e,t,n,r){(0,i.BUG)(e+" at "+n+":"+r,"window.onerror",{reportToSentry:!1})})));var e=(0,o.default)("sentry-dsn");e&&(a.init({dsn:e,ignoreErrors:u.SENTRY_IGNORE_ERRORS,release:(0,o.default)("version"),sampleRate:Number((0,o.default)("sentry-sample-rate")),environment:(0,o.default)("sentry-environment"),integrations:[new s.Dedupe],beforeSend:function(e,t){return(0,u.excludeEventDefinedByUser)(e,(0,o.default)("static-domain"))}}),a.configureScope((function(e){e.setTag("epic.domain",(0,o.default)("router-type")||"unknown"),e.setTag("epic.page",(0,o.default)("page")||"unknown")})))}},99057:function(e,t){t.__esModule=!0,t.pushToDataLayer=void 0;t.pushToDataLayer=function(e){window.dataLayer||(window.dataLayer=[]),window.dataLayer.push(e)}},83187:function(e){"use strict";e.exports=__hatena_locale_texts__},73609:function(e){"use strict";e.exports=jQuery}},i={};function o(e){var t=i[e];if(void 0!==t)return t.exports;var n=i[e]={id:e,loaded:!1,exports:{}};return r[e].call(n.exports,n,n.exports,o),n.loaded=!0,n.exports}o.m=r,e=[],o.O=function(t,n,r,i){if(!n){var a=1/0;for(l=0;l<e.length;l++){n=e[l][0],r=e[l][1],i=e[l][2];for(var s=!0,u=0;u<n.length;u++)(!1&i||a>=i)&&Object.keys(o.O).every((function(e){return o.O[e](n[u])}))?n.splice(u--,1):(s=!1,i<a&&(a=i));s&&(e.splice(l--,1),t=r())}return t}i=i||0;for(var l=e.length;l>0&&e[l-1][2]>i;l--)e[l]=e[l-1];e[l]=[n,r,i]},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,{a:t}),t},o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.f={},o.e=function(e){return Promise.all(Object.keys(o.f).reduce((function(t,n){return o.f[n](e,t),t}),[]))},o.u=function(e){return{277:"paint-app.chunk",836:"file-uploader.chunk"}[e]+".js?chunkhash="+{277:"ef5d99d19d5f0264525cffec37236111",836:"bb254331cdd6fbdf685a28cd71506059"}[e]},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.hmd=function(e){return(e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t={},n="Hatena-Epic:",o.l=function(e,r,i,a){if(t[e])t[e].push(r);else{var s,u;if(void 0!==i)for(var l=document.getElementsByTagName("script"),c=0;c<l.length;c++){var d=l[c];if(d.getAttribute("src")==e||d.getAttribute("data-webpack")==n+i){s=d;break}}s||(u=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,o.nc&&s.setAttribute("nonce",o.nc),s.setAttribute("data-webpack",n+i),s.src=e),t[e]=[r];var f=function(n,r){s.onerror=s.onload=null,clearTimeout(p);var i=t[e];if(delete t[e],s.parentNode&&s.parentNode.removeChild(s),i&&i.forEach((function(e){return e(r)})),n)return n(r)},p=setTimeout(f.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=f.bind(null,s.onerror),s.onload=f.bind(null,s.onload),u&&document.head.appendChild(s)}},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},o.j=507,function(){var e;o.g.importScripts&&(e=o.g.location+"");var t=o.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");n.length&&(e=n[n.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),o.p=e}(),function(){var e={507:0};o.f.j=function(t,n){var r=o.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var i=new Promise((function(n,i){r=e[t]=[n,i]}));n.push(r[2]=i);var a=o.p+o.u(t),s=new Error;o.l(a,(function(n){if(o.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var i=n&&("load"===n.type?"missing":n.type),a=n&&n.target&&n.target.src;s.message="Loading chunk "+t+" failed.\n("+i+": "+a+")",s.name="ChunkLoadError",s.type=i,s.request=a,r[1](s)}}),"chunk-"+t,t)}},o.O.j=function(t){return 0===e[t]};var t=function(t,n){var r,i,a=n[0],s=n[1],u=n[2],l=0;for(r in s)o.o(s,r)&&(o.m[r]=s[r]);if(u)var c=u(o);for(t&&t(n);l<a.length;l++)i=a[l],o.o(e,i)&&e[i]&&e[i][0](),e[a[l]]=0;return o.O(c)},n=self.webpackChunkHatena_Epic=self.webpackChunkHatena_Epic||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var a=o.O(void 0,[736],(function(){return o(74126)}));a=o.O(a)}();