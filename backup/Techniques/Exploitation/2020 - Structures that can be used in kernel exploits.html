<!DOCTYPE html>
<!-- saved from url=(0056)https://ptr-yudai.hatenablog.com/entry/2020/03/16/165628 -->
<html lang="ja" data-admin-domain="//blog.hatena.ne.jp" data-admin-origin="https://blog.hatena.ne.jp" data-author="ptr-yudai" data-avail-langs="ja en" data-blog="ptr-yudai.hatenablog.com" data-blog-host="ptr-yudai.hatenablog.com" data-blog-is-public="1" data-blog-name="CTFするぞ" data-blog-owner="ptr-yudai" data-blog-uri="https://ptr-yudai.hatenablog.com/" data-blog-uuid="10257846132615356977" data-blogs-uri-base="https://ptr-yudai.hatenablog.com" data-brand="hatenablog" data-data-layer="{&quot;hatenablog&quot;:{&quot;admin&quot;:{},&quot;blog&quot;:{&quot;is_sleeping&quot;:&quot;false&quot;,&quot;owner_name&quot;:&quot;ptr-yudai&quot;,&quot;content_seems_japanese&quot;:&quot;true&quot;,&quot;is_public&quot;:&quot;true&quot;,&quot;disable_ads&quot;:&quot;&quot;,&quot;is_responsive_view&quot;:&quot;true&quot;,&quot;enable_ads&quot;:&quot;true&quot;,&quot;uri&quot;:&quot;https://ptr-yudai.hatenablog.com/&quot;,&quot;enable_keyword_link&quot;:&quot;true&quot;,&quot;lang&quot;:&quot;ja&quot;,&quot;name&quot;:&quot;CTF\u3059\u308b\u305e&quot;,&quot;force_pc_view&quot;:&quot;true&quot;,&quot;entry_show_footer_related_entries&quot;:&quot;false&quot;},&quot;pro&quot;:&quot;free&quot;,&quot;page_id&quot;:&quot;entry&quot;,&quot;brand&quot;:&quot;hatenablog&quot;,&quot;analytics&quot;:{&quot;non_sampling_property_id&quot;:&quot;&quot;,&quot;brand_property_id&quot;:&quot;&quot;,&quot;separated_property_id&quot;:&quot;UA-29716941-23&quot;,&quot;property_id&quot;:&quot;UA-136430147-1&quot;},&quot;router_type&quot;:&quot;blogs&quot;,&quot;permalink_entry&quot;:{&quot;author_name&quot;:&quot;ptr-yudai&quot;,&quot;title&quot;:&quot;Kernel Exploit\u3067\u4f7f\u3048\u308b\u69cb\u9020\u4f53\u96c6&quot;,&quot;uri&quot;:&quot;https://ptr-yudai.hatenablog.com/entry/2020/03/16/165628&quot;,&quot;categories&quot;:&quot;Exploit&quot;,&quot;date&quot;:&quot;2020-03-16&quot;,&quot;hour&quot;:&quot;16&quot;}}}" data-device="pc" data-dont-recommend-pro="false" data-global-domain="https://hatenablog.com" data-globalheader-color="b" data-globalheader-type="pc" data-has-touch-view="1" data-help-url="https://help.hatenablog.com" data-no-suggest-touch-view="1" data-page="entry" data-parts-domain="https://hatenablog-parts.com" data-plus-available="" data-pro="false" data-router-type="blogs" data-sentry-dsn="https://03a33e4781a24cf2885099fed222b56d@sentry.io/1195218" data-sentry-environment="production" data-sentry-sample-rate="0.1" data-static-domain="https://cdn.blog.st-hatena.com" data-version="430259ab8ce45790e2f4b723542a620b" data-initial-state="{}"><head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script type="text/javascript" async="" src="./2020 - Structures that can be used in kernel exploits_files/publishertag.prebid.js.下載"></script><script type="text/javascript" async="" src="./2020 - Structures that can be used in kernel exploits_files/segment"></script><script async="" src="./2020 - Structures that can be used in kernel exploits_files/tdim-0.11.2.js.下載"></script><script async="" src="./2020 - Structures that can be used in kernel exploits_files/gtm.js(1).下載"></script><script async="" src="./2020 - Structures that can be used in kernel exploits_files/log.js.下載"></script><script type="text/javascript" async="" src="./2020 - Structures that can be used in kernel exploits_files/segment(1)"></script><script type="text/javascript" async="" src="./2020 - Structures that can be used in kernel exploits_files/get"></script><script async="" src="./2020 - Structures that can be used in kernel exploits_files/tracker.min.js.下載"></script><script type="text/javascript" async="" src="./2020 - Structures that can be used in kernel exploits_files/gtm.js(2).下載"></script><script type="text/javascript" async="" src="./2020 - Structures that can be used in kernel exploits_files/audience"></script><script type="text/javascript" async="" src="./2020 - Structures that can be used in kernel exploits_files/analytics.js.下載"></script><script type="text/javascript" id="www-widgetapi-script" src="./2020 - Structures that can be used in kernel exploits_files/www-widgetapi.js.下載" async=""></script><script type="text/javascript" async="" src="./2020 - Structures that can be used in kernel exploits_files/recaptcha__zh_tw.js.下載" crossorigin="anonymous" integrity="sha384-hR3VRaqfxKhcqcNEbDZ8Pxj7CCkilFkn9ncTAW+JsyYR9gpOPsTcFdzSznYj1sSs"></script><script src="./2020 - Structures that can be used in kernel exploits_files/iframe_api"></script><script async="" src="./2020 - Structures that can be used in kernel exploits_files/notices.count.json"></script>
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">


  



  

  <meta name="robots" content="max-image-preview:large">


  
  <meta http-equiv="X-UA-Compatible" content="IE=7; IE=9; IE=10; IE=11">
  <title>Kernel Exploitで使える構造体集 - CTFするぞ</title>

  
  <link rel="canonical" href="https://ptr-yudai.hatenablog.com/entry/2020/03/16/165628">



  
  

<meta itemprop="name" content="Kernel Exploitで使える構造体集 - CTFするぞ">

  <meta itemprop="image" content="https://cdn.blog.st-hatena.com/images/theme/og-image-1500.png">


  <meta property="og:title" content="Kernel Exploitで使える構造体集 - CTFするぞ">
<meta property="og:type" content="article">
  <meta property="og:url" content="https://ptr-yudai.hatenablog.com/entry/2020/03/16/165628">

  <meta property="og:image" content="https://ogimage.blog.st-hatena.com/10257846132615356977/26006613517371884/1584346155">

<meta property="og:image:alt" content="Kernel Exploitで使える構造体集 - CTFするぞ">
    <meta property="og:description" content="はじめに Kernel Exploitを勉強し初めて2ヶ月ほどが経ちました。 やっていて思うのは、カーネルランドのUAFやヒープオーバーフローなどは非常に強力だということです。 しかし、脆弱なドライバが提供する機能以外に、カーネルや他のドライバが提供する機能を利用することが多いので、多くの知識が無いと上手く攻撃できなかったり、成功確率が下がったりします。 例えばkUAFはとても便利なのですが、UAF対象のオブジェクトのサイズが固定の場合は、kmallocでサイズが一致してかつ「使える」オブジェクトを探す必要があります。 この記事では、そのような「使える」オブジェクトをまとめようと思います。 と…">
<meta property="og:site_name" content="CTFするぞ">

  <meta property="article:published_time" content="1584345388">

    <meta property="article:tag" content="Exploit">
      <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://ogimage.blog.st-hatena.com/10257846132615356977/26006613517371884/1584346155">  <meta name="twitter:title" content="Kernel Exploitで使える構造体集 - CTFするぞ">    <meta name="twitter:description" content="はじめに Kernel Exploitを勉強し初めて2ヶ月ほどが経ちました。 やっていて思うのは、カーネルランドのUAFやヒープオーバーフローなどは非常に強力だということです。 しかし、脆弱なドライバが提供する機能以外に、カーネルや他のドライバが提供する機能を利用することが多いので、多くの知識が無いと上手く攻撃できなか…">  <meta name="twitter:app:name:iphone" content="はてなブログアプリ">
  <meta name="twitter:app:id:iphone" content="583299321">
  <meta name="twitter:app:url:iphone" content="hatenablog:///open?uri=https%3A%2F%2Fptr-yudai.hatenablog.com%2Fentry%2F2020%2F03%2F16%2F165628">
  
    <meta name="description" content="はじめに Kernel Exploitを勉強し初めて2ヶ月ほどが経ちました。 やっていて思うのは、カーネルランドのUAFやヒープオーバーフローなどは非常に強力だということです。 しかし、脆弱なドライバが提供する機能以外に、カーネルや他のドライバが提供する機能を利用することが多いので、多くの知識が無いと上手く攻撃できなかったり、成功確率が下がったりします。 例えばkUAFはとても便利なのですが、UAF対象のオブジェクトのサイズが固定の場合は、kmallocでサイズが一致してかつ「使える」オブジェクトを探す必要があります。 この記事では、そのような「使える」オブジェクトをまとめようと思います。 と…">
    <meta name="keywords" content="ctf,writeup,pwn">


  
<script async="" src="./2020 - Structures that can be used in kernel exploits_files/gtm.js.下載"></script><script id="embed-gtm-data-layer-loader" data-data-layer-page-specific="{&quot;hatenablog&quot;:{&quot;blogs_permalink&quot;:{&quot;brand_hide_afc&quot;:&quot;false&quot;,&quot;blog_hide_afc_field&quot;:&quot;false&quot;,&quot;is_blog_sleeping&quot;:&quot;false&quot;,&quot;has_related_entries_with_elasticsearch&quot;:&quot;false&quot;,&quot;entry_afc_issued&quot;:&quot;false&quot;,&quot;blog_afc_issued&quot;:&quot;false&quot;,&quot;blog_struct_hide_afc&quot;:&quot;false&quot;,&quot;is_author_pro&quot;:&quot;false&quot;,&quot;blog_hide_afc_func&quot;:&quot;false&quot;}}}">
(function() {
  function loadDataLayer(elem, attrName) {
    if (!elem) { return {}; }
    var json = elem.getAttribute(attrName);
    if (!json) { return {}; }
    return JSON.parse(json);
  }

  var globalVariables = loadDataLayer(
    document.documentElement,
    'data-data-layer'
  );
  var pageSpecificVariables = loadDataLayer(
    document.getElementById('embed-gtm-data-layer-loader'),
    'data-data-layer-page-specific'
  );

  var variables = [globalVariables, pageSpecificVariables];

  if (!window.dataLayer) {
    window.dataLayer = [];
  }

  for (var i = 0; i < variables.length; i++) {
    window.dataLayer.push(variables[i]);
  }
})();
</script>

<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-P4CXTW');</script>
<!-- End Google Tag Manager -->




  <link rel="shortcut icon" href="https://ptr-yudai.hatenablog.com/icon/favicon">
<link rel="apple-touch-icon" href="https://ptr-yudai.hatenablog.com/icon/touch">
<link rel="icon" sizes="192x192" href="https://ptr-yudai.hatenablog.com/icon/link">

  

<link rel="alternate" type="application/atom+xml" title="Atom" href="https://ptr-yudai.hatenablog.com/feed">
<link rel="alternate" type="application/rss+xml" title="RSS2.0" href="https://ptr-yudai.hatenablog.com/rss">
<link rel="alternate" type="application/json+oembed" href="https://hatenablog.com/oembed?url=https%3A%2F%2Fptr-yudai.hatenablog.com%2Fentry%2F2020%2F03%2F16%2F165628&amp;format=json" title="oEmbed Profile of Kernel Exploitで使える構造体集">
<link rel="alternate" type="text/xml+oembed" href="https://hatenablog.com/oembed?url=https%3A%2F%2Fptr-yudai.hatenablog.com%2Fentry%2F2020%2F03%2F16%2F165628&amp;format=xml" title="oEmbed Profile of Kernel Exploitで使える構造体集">
  
  <link rel="author" href="http://www.hatena.ne.jp/ptr-yudai/">

  


  
    <link rel="stylesheet" type="text/css" href="./2020 - Structures that can be used in kernel exploits_files/blog.css">

    
  <link rel="stylesheet" type="text/css" href="./2020 - Structures that can be used in kernel exploits_files/c0f44be63a91e4749ab3f02c116cb5a14385a10e">
  
  

  

  
<script> </script>

  
<style>
  div#google_afc_user,
  div.google-afc-user-container,
  div.google_afc_image,
  div.google_afc_blocklink {
      display: block !important;
  }
</style>


  
    <script src="./2020 - Structures that can be used in kernel exploits_files/valve.js.下載" async=""></script>
<script id="test-valve-definition">
  var valve = window.valve || [];

  valve.push(function(v) {
    v.config({
      service: 'blog',
      content: {
        result: 'adtrust',
        documentIds: ["blog:entry:26006613517371884"]
      }
    });
    v.defineDFPSlot({"lazy":"","sizes":[[300,250],[336,280],[468,60],"fluid"],"slotId":"google_afc_user_container_0","unit":"/4374287/blog_user"});
    v.sealDFPSlots();
  });
</script>

  

  
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","dateModified":"2020-03-16T17:09:15+09:00","datePublished":"2020-03-16T16:56:28+09:00","headline":"Kernel Exploitで使える構造体集","image":["https://cdn.blog.st-hatena.com/images/theme/og-image-1500.png"]}</script>

  

  <script type="text/javascript" async="" src="./2020 - Structures that can be used in kernel exploits_files/MathJax.js.下載">
</script>
<script type="text/javascript" async="" src="./2020 - Structures that can be used in kernel exploits_files/apstag.js.下載"></script><script type="text/javascript" async="" src="./2020 - Structures that can be used in kernel exploits_files/pwt.js.下載"></script><script type="text/javascript" async="" src="./2020 - Structures that can be used in kernel exploits_files/itm.js.下載"></script><script type="text/javascript" async="" src="./2020 - Structures that can be used in kernel exploits_files/gpt.js.下載"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><meta http-equiv="origin-trial" content="AxujKG9INjsZ8/gUq8+dTruNvk7RjZQ1oFhhgQbcTJKDnZfbzSTE81wvC2Hzaf3TW4avA76LTZEMdiedF1vIbA4AAABueyJvcmlnaW4iOiJodHRwczovL2ltYXNkay5nb29nbGVhcGlzLmNvbTo0NDMiLCJmZWF0dXJlIjoiVHJ1c3RUb2tlbnMiLCJleHBpcnkiOjE2NTI3NzQ0MDAsImlzVGhpcmRQYXJ0eSI6dHJ1ZX0="><meta http-equiv="origin-trial" content="Azuce85ORtSnWe1MZDTv68qpaW3iHyfL9YbLRy0cwcCZwVnePnOmkUJlG8HGikmOwhZU22dElCcfrfX2HhrBPAkAAAB7eyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiVHJ1c3RUb2tlbnMiLCJleHBpcnkiOjE2NTI3NzQ0MDAsImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"><meta http-equiv="origin-trial" content="A16nvcdeoOAqrJcmjLRpl1I6f3McDD8EfofAYTt/P/H4/AWwB99nxiPp6kA0fXoiZav908Z8etuL16laFPUdfQsAAACBeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXRhZ3NlcnZpY2VzLmNvbTo0NDMiLCJmZWF0dXJlIjoiVHJ1c3RUb2tlbnMiLCJleHBpcnkiOjE2NTI3NzQ0MDAsImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"><meta http-equiv="origin-trial" content="AxBHdr0J44vFBQtZUqX9sjiqf5yWZ/OcHRcRMN3H9TH+t90V/j3ENW6C8+igBZFXMJ7G3Pr8Dd13632aLng42wgAAACBeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiVHJ1c3RUb2tlbnMiLCJleHBpcnkiOjE2NTI3NzQ0MDAsImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"><meta http-equiv="origin-trial" content="A88BWHFjcawUfKU3lIejLoryXoyjooBXLgWmGh+hNcqMK44cugvsI5YZbNarYvi3roc1fYbHA1AVbhAtuHZflgEAAAB2eyJvcmlnaW4iOiJodHRwczovL2dvb2dsZS5jb206NDQzIiwiZmVhdHVyZSI6IlRydXN0VG9rZW5zIiwiZXhwaXJ5IjoxNjUyNzc0NDAwLCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><meta http-equiv="origin-trial" content="A8FHS1NmdCwGqD9DwOicnHHY+y27kdWfxKa0YHSGDfv0CSpDKRHTQdQmZVPDUdaFWUsxdgVxlwAd6o+dhJykPA0AAACWeyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiQ29udmVyc2lvbk1lYXN1cmVtZW50IiwiZXhwaXJ5IjoxNjQzMTU1MTk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlLCJ1c2FnZSI6InN1YnNldCJ9"><meta http-equiv="origin-trial" content="A8zdXi6dr1hwXEUjQrYiyYQGlU3557y5QWDnN0Lwgj9ePt66XMEvNkVWOEOWPd7TP9sBQ25X0Q15Lr1Nn4oGFQkAAACceyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiQ29udmVyc2lvbk1lYXN1cmVtZW50IiwiZXhwaXJ5IjoxNjQzMTU1MTk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlLCJ1c2FnZSI6InN1YnNldCJ9"><meta http-equiv="origin-trial" content="A4/Htern2udN9w3yJK9QgWQxQFruxOXsXL7cW60DyCl0EZFGCSme/J33Q/WzF7bBkVvhEWDlcBiUyZaim5CpFQwAAACceyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXRhZ3NlcnZpY2VzLmNvbTo0NDMiLCJmZWF0dXJlIjoiQ29udmVyc2lvbk1lYXN1cmVtZW50IiwiZXhwaXJ5IjoxNjQzMTU1MTk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlLCJ1c2FnZSI6InN1YnNldCJ9"><script src="./2020 - Structures that can be used in kernel exploits_files/pubads_impl_2021111701.js.下載" async=""></script><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover, .MJXp-munder {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > *, .MJXp-munder > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><meta http-equiv="origin-trial" content="A3v9QjmVUCOO7YqFMKHP/NKbn6kY1G1pa2S1TfeXJZUD/tysMONTy6lV0Jkou3rrCjSKRGbqTrgTaZkm1XJ7pQUAAACKeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXRhZ21hbmFnZXIuY29tOjQ0MyIsImZlYXR1cmUiOiJDb252ZXJzaW9uTWVhc3VyZW1lbnQiLCJleHBpcnkiOjE2NDMxNTUxOTksImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"><script type="text/javascript" async="" src="./2020 - Structures that can be used in kernel exploits_files/hatena_bigmining.js.下載"></script><script src="./2020 - Structures that can be used in kernel exploits_files/entries.json" type="text/javascript"></script></head>

  <body class="page-entry enable-bottom-editarea category-Exploit"><div id="MathJax_Message" style="display: none;"></div>
    

    
    
    
    
      <nav class="
        blog-controlls
        
      ">
        <div class="blog-controlls-subscribe" data-test-blog-controlls-subscribe="">
          <a href="https://blog.hatena.ne.jp/ptr-yudai/ptr-yudai.hatenablog.com/subscribe?utm_medium=button&amp;utm_source=blogs_topright_button&amp;utm_campaign=subscribe_blog" class="blog-controlls-subscribe-btn">
            読者になる
          </a>
        </div>
      </nav>
    

    <div id="globalheader-container" data-brand="hatenablog">
  <iframe id="globalheader" height="37" frameborder="0" allowtransparency="true" src="./2020 - Structures that can be used in kernel exploits_files/saved_resource.html"></iframe>
</div>


    <div id="container">
      <div id="container-inner">
        <header id="blog-title" data-brand="hatenablog">
  <div id="blog-title-inner">
    <div id="blog-title-content">
      <h1 id="title"><a href="https://ptr-yudai.hatenablog.com/">CTFするぞ</a></h1>
      
        <h2 id="blog-description">CTF以外のことも書くよ</h2>
      
    </div>
  </div>
</header>

        

        
        




<div id="content" class="hfeed">
  <div id="content-inner">
    <div id="wrapper">
      <div id="main">
        <div id="main-inner">
          


          
  
  <!-- google_ad_section_start -->
  <!-- rakuten_ad_target_begin -->
  
  
  

  

  
    
      
        <article class="entry hentry test-hentry js-entry-article date-first autopagerize_page_element chars-6000 words-400 mode-markdown entry-odd" id="entry-26006613517371884" data-keyword-campaign="" data-uuid="26006613517371884" data-publication-type="entry">
  <div class="entry-inner">
    <header class="entry-header">
  
    <div class="date entry-date first">
    <a href="https://ptr-yudai.hatenablog.com/archive/2020/03/16" rel="nofollow">
      <time datetime="2020-03-16T07:56:28Z" title="2020-03-16T07:56:28Z">
        <span class="date-year">2020</span><span class="hyphen">-</span><span class="date-month">03</span><span class="hyphen">-</span><span class="date-day">16</span>
      </time>
    </a>
  </div>
  <h1 class="entry-title">
  <a href="https://ptr-yudai.hatenablog.com/entry/2020/03/16/165628" class="entry-title-link bookmark">Kernel Exploitで使える構造体集</a>
</h1>

  
  

  <div class="entry-categories categories">
    
    <a href="https://ptr-yudai.hatenablog.com/archive/category/Exploit" class="entry-category-link category-Exploit">Exploit</a>
    
  </div>


  

  

</header>

    


    <div class="entry-content">
  
    <h1 id="はじめに">はじめに</h1>

<p>Kernel Exploitを勉強し初めて2ヶ月ほどが経ちました。
やっていて思うのは、<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%AB%A1%BC%A5%CD%A5%EB">カーネル</a>ランドのUAFやヒープオーバーフローなどは非常に強力だということです。
しかし、脆弱なドライバが提供する機能以外に、<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%AB%A1%BC%A5%CD%A5%EB">カーネル</a>や他のドライバが提供する機能を利用することが多いので、多くの知識が無いと上手く攻撃できなかったり、成功確率が下がったりします。
例えばkUAFはとても便利なのですが、UAF対象のオブジェクトのサイズが固定の場合は、kmallocでサイズが一致してかつ「使える」オブジェクトを探す必要があります。
この記事では、そのような「使える」オブジェクトをまとめようと思います。
といっても私はKernel Exploitに関しては素人なので間違いが多いかもしれませんし、定石みたいなものを見逃しているかもしれません。
間違っている部分の指摘や、他に知っているオブジェクトがあれば是非コメントや<a class="keyword" href="http://d.hatena.ne.jp/keyword/Twitter">Twitter</a>などで教えてください。</p>

<p>実験環境や書いたコードは以下の<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%EA%A5%DD%A5%B8%A5%C8%A5%EA">リポジトリ</a>にまとめます。</p>

<p><iframe src="./2020 - Structures that can be used in kernel exploits_files/embed.html" title="Bitbucket" class="embed-card embed-webcard" scrolling="no" frameborder="0" style="display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;"></iframe><cite class="hatena-citation"><a href="https://bitbucket.org/ptr-yudai/kexp-objects">bitbucket.org</a></cite></p>

<p>なお、検証には<a class="keyword" href="http://d.hatena.ne.jp/keyword/Linux">Linux</a> Kernel 4.19.98を使いました。</p>

<ul class="table-of-contents">
    <li><a href="https://ptr-yudai.hatenablog.com/entry/2020/03/16/165628#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB">はじめに</a></li>
    <li><a href="https://ptr-yudai.hatenablog.com/entry/2020/03/16/165628#LeakAARAAWRIP%E5%88%B6%E5%BE%A1%E3%81%AB%E4%BD%BF%E3%81%88%E3%82%8B%E6%A7%8B%E9%80%A0%E4%BD%93%E4%B8%80%E8%A6%A7">Leak/AAR/AAW/RIP制御に使える構造体一覧</a><ul>
            <li><a href="https://ptr-yudai.hatenablog.com/entry/2020/03/16/165628#shm_file_data">shm_file_data</a></li>
            <li><a href="https://ptr-yudai.hatenablog.com/entry/2020/03/16/165628#seq_operations">seq_operations</a></li>
            <li><a href="https://ptr-yudai.hatenablog.com/entry/2020/03/16/165628#msg_msg-user-supplied-data">msg_msg (+user-supplied data)</a></li>
            <li><a href="https://ptr-yudai.hatenablog.com/entry/2020/03/16/165628#subprocess_info">subprocess_info</a></li>
            <li><a href="https://ptr-yudai.hatenablog.com/entry/2020/03/16/165628#cred">cred</a></li>
            <li><a href="https://ptr-yudai.hatenablog.com/entry/2020/03/16/165628#file">file</a></li>
            <li><a href="https://ptr-yudai.hatenablog.com/entry/2020/03/16/165628#timerfd_ctx">timerfd_ctx</a></li>
            <li><a href="https://ptr-yudai.hatenablog.com/entry/2020/03/16/165628#tty_struct">tty_struct</a></li>
        </ul>
    </li>
    <li><a href="https://ptr-yudai.hatenablog.com/entry/2020/03/16/165628#%E4%BB%BB%E6%84%8F%E3%83%87%E3%83%BC%E3%82%BF%E6%9B%B8%E3%81%8D%E8%BE%BC%E3%81%BFHeap-Spray%E3%81%AB%E4%BD%BF%E3%81%88%E3%82%8B%E6%A7%8B%E9%80%A0%E4%BD%93">任意データ書き込み/Heap Sprayに使える構造体</a><ul>
            <li><a href="https://ptr-yudai.hatenablog.com/entry/2020/03/16/165628#msg_msg">msg_msg</a></li>
            <li><a href="https://ptr-yudai.hatenablog.com/entry/2020/03/16/165628#setxattr">setxattr</a></li>
            <li><a href="https://ptr-yudai.hatenablog.com/entry/2020/03/16/165628#sendmsg">sendmsg</a></li>
        </ul>
    </li>
    <li><a href="https://ptr-yudai.hatenablog.com/entry/2020/03/16/165628#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE">参考文献</a></li>
</ul>

<h1 id="LeakAARAAWRIP制御に使える構造体一覧">Leak/AAR/<a class="keyword" href="http://d.hatena.ne.jp/keyword/AAW">AAW</a>/RIP制御に使える構造体一覧</h1>

<p>構造体なんて腐るほどありますが、とにかくサイズごとに使えるものを網羅したいです。
他に知ってるのあったら教えてください。
現状kmalloc-8、kmalloc-16、kmalloc-64、kmalloc-512あたりが未開拓です。</p>

<h2 id="shm_file_data">shm_file_data</h2>

<ul>
<li>サイズ：0x20 (kmalloc-32)</li>
<li>base：<code>ns</code>, <code>vm_ops</code>が<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%AB%A1%BC%A5%CD%A5%EB">カーネル</a>のデータ領域を指しているのでリーク可能。</li>
<li>heap：<code>file</code> がヒープ領域を指しているのでリーク可能。</li>
<li>stack：リークできない。</li>
<li>RIP：たぶん取れない。</li>
<li>確保：<code>shmat</code>で共有メモリをマップする。</li>
<li>解放：<code>shmctl</code>とかで破棄するのかな？</li>
<li>備考：<code>vm_ops</code>を書き換えてみたが、<code>shmget</code>等で偽のvtableの関数ポインタが呼ばれる様子は特になかった。</li>
<li>参考：<a href="https://elixir.bootlin.com/linux/v4.19.98/source/ipc/shm.c#L74">https://elixir.bootlin.com/linux/v4.19.98/source/ipc/shm.c#L74</a></li>
</ul>


<pre class="code" data-lang="" data-unlink="">0x0000: 0x0000000000000000
0x0008: 0xffffffff82292ae0
0x0010: 0xffff88800ea09700
0x0018: 0xffffffff81e15540
[+] kbase = 0xffffffff81000000
[+] kheap = 0xffff88800ea09700</pre>


<h2 id="seq_operations">seq_operations</h2>

<ul>
<li>サイズ：0x20 (kmalloc-32)</li>
<li>base：4つの関数ポインタから好きなものを使ってリーク可能。</li>
<li>heap：リークできない。</li>
<li>stack：リークできない。</li>
<li>RIP：例えば <code>start</code> を書き換えてreadを呼べばRIPがポン！ってなる。</li>
<li>確保：<code>single_open</code>を使うファイルを開く。<code>/proc/self/stat</code>とか。</li>
<li>解放：<code>close</code>する。</li>
<li>参考：<a href="https://elixir.bootlin.com/linux/v4.19.98/source/include/linux/seq_file.h#L32">https://elixir.bootlin.com/linux/v4.19.98/source/include/linux/seq_file.h#L32</a></li>
</ul>


<pre class="code" data-lang="" data-unlink="">0x0000: 0xffffffff811c5f70
0x0008: 0xffffffff811c5f90
0x0010: 0xffffffff811c5f80
0x0018: 0xffffffff8120c3f0
[+] kbase = 0xffffffff81000000
Press enter to continue...
[    6.801190] BUG: unable to handle kernel paging request at 00000000deadbeef</pre>


<h2 id="msg_msg-user-supplied-data">msg_msg (+user-supplied data)</h2>

<ul>
<li>サイズ：0x31〜0x1000 (kmalloc-64以上)</li>
<li>base：リークできない。</li>
<li>heap：<code>next</code>が前にmsgsndされたメッセージを指しているのでリーク可能。前にmsgsndしたデータのサイズに対応するSLUB上のアドレスを指すので便利。</li>
<li>stack：リークできない。</li>
<li>RIP：取れない。</li>
<li>確保：<code>msgget</code>して<code>msgsnd</code>する。</li>
<li>解放：<code>msgrcv</code>する。ただし最初に<code>msgsnd</code>したものから順番に受信されるのでkfreeの順番も送信した順番になる。</li>
<li>備考：サイズ可変で任意データを書き込めるので便利だが、最初の48バイトは構造体で使われるので書き換えられない。UAFでreadのみ可能なとき、これでヒープのアドレスをリークした後にヒープ上にデータを用意するなどが可能。ヒープスプレーにもよく使われている模様。</li>
<li>参考：<a href="https://elixir.bootlin.com/linux/v4.19.98/source/include/linux/msg.h#L9">https://elixir.bootlin.com/linux/v4.19.98/source/include/linux/msg.h#L9</a></li>
</ul>


<pre class="code" data-lang="" data-unlink="">0x0000: 0xffff88800e1661c0
0x0008: 0xffff88800e1661c0
0x0010: 0x0000000000000001
0x0018: 0x0000000000000020
0x0020: 0x0000000000000000
0x0028: 0xffff88800e8c7f90
0x0030: 0x4242424241414141
0x0038: 0x4444444443434343
0x0040: 0x4646464645454545
0x0048: 0x0000000000000046
[+] kheap = 0xffff88800e1661c0</pre>


<h2 id="subprocess_info">subprocess_info</h2>

<ul>
<li>サイズ：0x60 (kmalloc-128)</li>
<li>base：<code>work.func</code>が<code>call_usermodehelper_exec_work</code>を指しているのでリーク可能。</li>
<li>heap：リーク可能だがどのSLUBのデータかは未検証。</li>
<li>stack：リークできない。</li>
<li>RIP：race condition等で、確保中に<code>cleanup</code> を書き換えるとRIPが取れる。（これって<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%C8%A5%EA%A5%D3%A5%A2">トリビア</a>になりませんか？）</li>
<li>確保：いろいろありそうだけど確認済みなのは<code>socket(22, AF_INET, 0);</code>などで不明な<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%D7%A5%ED%A5%C8%A5%B3%A5%EB">プロトコル</a>を指定する方法。</li>
<li>解放：確保と同一パスで解放される。</li>
<li>備考：データ書き込めないし使えねーと思ったが、<code>info-&gt;cleanup</code>を設定してから<code>if (info-&gt;cleanup) info-&gt;cleanup(info);</code>までに時間があるので、race conditionで高い確率でRIPを取れることに検証成功。ただし、なぜかこれでROPしてもユーザーランドに復帰後fsを使う箇所やsyscallで死ぬ。<a class="keyword" href="http://d.hatena.ne.jp/keyword/SMAP">SMAP</a>が無効ならfdをユーザーランドに書き換えてuserfaultfdと組み合わせてcleanupを上書き可能だと思う。</li>
<li>参考：<a href="https://elixir.bootlin.com/linux/v4.19.98/source/include/linux/umh.h#L19">https://elixir.bootlin.com/linux/v4.19.98/source/include/linux/umh.h#L19</a></li>
</ul>


<pre class="code" data-lang="" data-unlink="">0x0000: 0xffff88800f254380
0x0008: 0xffff88800f254e88
0x0010: 0xffff88800f254e88
0x0018: 0xffffffff81071380
0x0020: 0x0000000000000000
0x0028: 0xffffffff82242260
0x0030: 0xffff88800e0e3b40
0x0038: 0xffffffff82242180
0x0040: 0x0000000000000000
0x0048: 0x0000010000000006
0x0050: 0x0000000000000407
0x0058: 0x0000000000000000
[+] kbase = 0xffffffff81000000
[+] kheap = 0xffff88800f254380
Press enter to continue...
[    6.801190] BUG: unable to handle kernel paging request at 00000000deadbeef</pre>


<h2 id="cred">cred</h2>

<ul>
<li>サイズ：0xa8 (kmalloc-192)</li>
<li>base：リークできなさそう。</li>
<li>heap： <code>session_keyring</code>等からリーク可能。対象のSLUBは未調査。</li>
<li>stack：リークできなさそう。</li>
<li>RIP：取れない。</li>
<li>確保：forkする。</li>
<li>解放：作ったプロセスをexitする。</li>
<li>備考：uid, <a class="keyword" href="http://d.hatena.ne.jp/keyword/gid">gid</a>等を持つので、0埋めできれば権限昇格できる。ただし、検証した4.19.98では<code>cred</code>はkmallocに入っていない気がする。</li>
<li>参考：<a href="https://elixir.bootlin.com/linux/v4.19.98/source/include/linux/cred.h#L116">https://elixir.bootlin.com/linux/v4.19.98/source/include/linux/cred.h#L116</a></li>
</ul>


<h2 id="file">file</h2>

<ul>
<li>サイズ：? (kmalloc-256)</li>
<li>base：<code>f_op</code>が<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%AB%A1%BC%A5%CD%A5%EB">カーネル</a>のデータ領域を指しているのでリーク可能。</li>
<li>heap：未検証。まぁいけるやろ。</li>
<li>stack：未検証。</li>
<li>確保：<code>shmget</code>で共有メモリを作成する。</li>
<li>解放：<code>shmctl</code>で破棄する。</li>
<li>備考：<code>f_op</code>を書き換えて<code>shmctl</code>等を呼べばRIP制御が可能。ただ、UAF後にfile構造体がなぜかoverlapしなかったので検証に失敗。</li>
<li>参考：<a href="https://elixir.bootlin.com/linux/v4.19.98/source/include/linux/fs.h#L891">https://elixir.bootlin.com/linux/v4.19.98/source/include/linux/fs.h#L891</a></li>
</ul>


<h2 id="timerfd_ctx">timerfd_ctx</h2>

<ul>
<li>サイズ：? (kmalloc-256)</li>
<li>base：<code>tmr.function</code>が<code>timerfd_tmrproc</code>を指しているのでリーク可能。</li>
<li>heap：<code>tmr.base</code>などからリーク可能。</li>
<li>stack：リークできない。</li>
<li>RIP：取れそうで取れなさそう。</li>
<li>確保：<code>timerfd_create</code>を呼ぶ。</li>
<li>解放：tfdを<code>close</code>する？</li>
<li>参考：<a href="https://elixir.bootlin.com/linux/v4.19.98/source/fs/timerfd.c#L30">https://elixir.bootlin.com/linux/v4.19.98/source/fs/timerfd.c#L30</a></li>
</ul>


<pre class="code" data-lang="" data-unlink="">0x0000: 0xffff88800e216100
0x0008: 0x0000000000000000
0x0010: 0x0000000000000000
0x0018: 0x000000183ca77938
0x0020: 0x000000183ca77938
0x0028: 0xffffffff811e7ef0
0x0030: 0xffff88800f41ba80
...
[+] kbase = 0xffffffff81000000
[+] kbase = 0xffff88800f41ba80</pre>


<h2 id="tty_struct">tty_struct</h2>

<ul>
<li>サイズ：0x2e0 (kmalloc-1024)</li>
<li>base：<code>ops</code>が <code>ptm_unix98_ops</code> を指しているのでリーク可能。それ以外にも2箇所ほどkernelのdata領域を指していた。</li>
<li>heap：<code>dev</code>, <code>driver</code>など多くのオブジェクトがヒープや自身のメンバを指しているのでリーク可能。対象のSLUBは未調査。</li>
<li>stack：リークできなさそう。</li>
<li>確保：<code>/dev/ptmx</code>を開く。</li>
<li>解放：開いたptmxを閉じる。</li>
<li>備考：<code>ops</code>を書き換えることでRIPが制御可能。</li>
<li>参考：<a href="https://elixir.bootlin.com/linux/v4.19.98/source/include/linux/tty.h#L283">https://elixir.bootlin.com/linux/v4.19.98/source/include/linux/tty.h#L283</a></li>
</ul>


<pre class="code" data-lang="" data-unlink="">0x0000: 0x0000000100005401
0x0008: 0x0000000000000000
0x0010: 0xffff88800f1ed840
0x0018: 0xffffffff81e65900
0x0020: 0x0000000000000000
...
[+] kbase = 0xffffffff81000000
[+] kheap = 0xffff88800f1ed840
Press enter to continue...
[    5.413411] BUG: unable to handle kernel paging request at 00000000deadbeef</pre>


<h1 id="任意データ書き込みHeap-Sprayに使える構造体">任意データ書き込み/Heap Sprayに使える構造体</h1>

<h2 id="msg_msg">msg_msg</h2>

<p>説明済み</p>

<h2 id="setxattr">setxattr</h2>

<ul>
<li>サイズ：任意（&lt;=65536）</li>
<li>確保：<code>setxattr</code>を呼び出す。<code>value</code>に書き込みたい値のポインタを入れ、<code>size</code>を指定する。</li>
<li>解放：確保と同一パスで解放される。</li>
<li>備考：userfaultfdと組み合わせて使う。msgsndでは先頭48バイトが書き換えられないので、それに対応したい場合に便利。ヒープスプレーにも使える。</li>
</ul>


<h2 id="sendmsg">sendmsg</h2>

<ul>
<li>サイズ：任意（&gt;=2）</li>
<li>確保：<code>sendmsg</code>を呼び出す。<code>msg.msg_control</code>にポインタ、<code>msg.msg_controllen</code>にサイズを入れる。</li>
<li>解放：確保と同一パスで解放される。</li>
<li>備考：setxattrと同じでuserfaultfdと組み合わせる。</li>
</ul>


<h1 id="参考文献">参考文献</h1>

<p>[1] <a href="https://elixir.bootlin.com/linux/v4.19.98/source">https://elixir.bootlin.com/linux/v4.19.98/source</a></p>

<p>[2] <a href="https://duasynt.com/blog/linux-kernel-heap-spray">https://duasynt.com/blog/linux-kernel-heap-spray</a></p>

<p>[3] <a href="https://hama.hatenadiary.jp/entry/2018/12/01/000000">https://hama.hatenadiary.jp/entry/2018/12/01/000000</a></p>

<p>[4] <a href="https://smallkirby.hatenablog.com/entry/2019/11/19/225504">https://smallkirby.hatenablog.com/entry/2019/11/19/225504</a></p>

    

  
</div>

    
  <footer class="entry-footer">
    
    <div class="entry-tags-wrapper">
  <div class="entry-tags">  </div>
</div>

    <p class="entry-footer-section">
  <span class="author vcard"><span class="fn" data-load-nickname="1" data-user-name="ptr-yudai">ptr-yudai</span></span>
  <span class="entry-footer-time"><a href="https://ptr-yudai.hatenablog.com/entry/2020/03/16/165628"><time data-relative="" datetime="2020-03-16T07:56:28Z" title="2020-03-16T07:56:28Z" class="updated">1年前</time></a></span>
</p>

    
  
  
    <div class="hatena-star-container">
    <span class="hatena-star-comment-container"><img src="./2020 - Structures that can be used in kernel exploits_files/comment.gif" tabindex="0" alt="Comments" title="Comments" class="hatena-star-comment-button" style="cursor: pointer; margin: 0px; padding: 0px; border: none; vertical-align: middle; display: none;"></span><span class="hatena-star-star-container"><img src="./2020 - Structures that can be used in kernel exploits_files/hatena-star-add-button.svg" tabindex="0" alt="Add Star" title="Add Star" class="hatena-star-add-button" style="cursor: pointer; margin: 0px 3px; padding: 0px; border: none; vertical-align: middle;"><a href="https://blog.hatena.ne.jp/cookie-s/"><span class="hatena-big-star-star-container"><img src="./2020 - Structures that can be used in kernel exploits_files/profile.png" tabindex="0" class="hatena-star-user" style="padding: 0px; border: none;"><img src="./2020 - Structures that can be used in kernel exploits_files/star.gif" tabindex="0" class="hatena-star-star" style="padding: 0px; border: none;" alt="cookie-s" title=""></span></a><a href="https://blog.hatena.ne.jp/cookie-s/"><span class="hatena-big-star-star-container"><img src="./2020 - Structures that can be used in kernel exploits_files/profile.png" tabindex="0" class="hatena-star-user" style="padding: 0px; border: none;"><img src="./2020 - Structures that can be used in kernel exploits_files/star.gif" tabindex="0" class="hatena-star-star" style="padding: 0px; border: none;" alt="cookie-s" title=""></span></a><a href="https://blog.hatena.ne.jp/cookie-s/"><span class="hatena-big-star-star-container"><img src="./2020 - Structures that can be used in kernel exploits_files/profile.png" tabindex="0" class="hatena-star-user" style="padding: 0px; border: none;"><img src="./2020 - Structures that can be used in kernel exploits_files/star.gif" tabindex="0" class="hatena-star-star" style="padding: 0px; border: none;" alt="cookie-s" title=""></span></a><a href="https://blog.hatena.ne.jp/cookie-s/"><span class="hatena-big-star-star-container"><img src="./2020 - Structures that can be used in kernel exploits_files/profile.png" tabindex="0" class="hatena-star-user" style="padding: 0px; border: none;"><img src="./2020 - Structures that can be used in kernel exploits_files/star.gif" tabindex="0" class="hatena-star-star" style="padding: 0px; border: none;" alt="cookie-s" title=""></span></a><a href="https://blog.hatena.ne.jp/cookie-s/"><span class="hatena-big-star-star-container"><img src="./2020 - Structures that can be used in kernel exploits_files/profile.png" tabindex="0" class="hatena-star-user" style="padding: 0px; border: none;"><img src="./2020 - Structures that can be used in kernel exploits_files/star.gif" tabindex="0" class="hatena-star-star" style="padding: 0px; border: none;" alt="cookie-s" title=""></span></a><a href="https://blog.hatena.ne.jp/cookie-s/"><span class="hatena-big-star-star-container"><img src="./2020 - Structures that can be used in kernel exploits_files/profile.png" tabindex="0" class="hatena-star-user" style="padding: 0px; border: none;"><img src="./2020 - Structures that can be used in kernel exploits_files/star.gif" tabindex="0" class="hatena-star-star" style="padding: 0px; border: none;" alt="cookie-s" title=""></span></a><a href="https://blog.hatena.ne.jp/smallkirby/"><span class="hatena-big-star-star-container"><img src="./2020 - Structures that can be used in kernel exploits_files/profile(1).png" tabindex="0" class="hatena-star-user" style="padding: 0px; border: none;"><img src="./2020 - Structures that can be used in kernel exploits_files/star.gif" tabindex="0" class="hatena-star-star" style="padding: 0px; border: none;" alt="smallkirby" title=""></span></a><a href="https://blog.hatena.ne.jp/h_noson/"><span class="hatena-big-star-star-container"><img src="./2020 - Structures that can be used in kernel exploits_files/profile(2).png" tabindex="0" class="hatena-star-user" style="padding: 0px; border: none;"><img src="./2020 - Structures that can be used in kernel exploits_files/star.gif" tabindex="0" class="hatena-star-star" style="padding: 0px; border: none;" alt="h_noson" title=""></span></a></span></div>
    <div class="hatena-star-metadata" style="display: none">
      <a class="hatena-star-permalink" href="https://ptr-yudai.hatenablog.com/entry/2020/03/16/165628">Kernel Exploitで使える構造体集</a>
    </div>
  


    
<div class="social-buttons">
  
  
  
  
  
  
  
</div>

    
  
  
    
    <div class="google-afc-image test-google-rectangle-ads">      
      
      <div id="google_afc_user_container_0" class="google-afc-user-container google_afc_blocklink2_5 google_afc_boder" data-test-unit="/4374287/blog_user"></div>
      
        <a href="http://blog.hatena.ne.jp/guide/pro" class="open-pro-modal" data-guide-pro-modal-ad-url="https://hatenablog.com/guide/pro/modal/ad">広告を非表示にする</a>
      
    </div>
  
  


    <div class="customized-footer">
      

        

        
        

      
    </div>
    
  <div class="comment-box js-comment-box">
    
    <ul class="comment js-comment">
      <li class="read-more-comments" style="display: none;"><a>もっと読む</a></li>
    </ul>
    
      <a class="leave-comment-title js-leave-comment-title" style="display: inline;">コメントを書く</a>
    
  </div>

  </footer>

  </div>
</article>

      
      
    
  

  
  <!-- rakuten_ad_target_end -->
  <!-- google_ad_section_end -->
  
  
  
  <div class="pager pager-permalink permalink">
    
      
      <span class="pager-prev">
        <a href="https://ptr-yudai.hatenablog.com/entry/2020/03/17/085604" rel="prev">
          <span class="pager-arrow">« </span>
          SuSeC CTF 2020 Pwn Writeups
        </a>
      </span>
    
    
      
      <span class="pager-next">
        <a href="https://ptr-yudai.hatenablog.com/entry/2020/03/15/205402" rel="next">
          CONFidence CTF 2020 Teaser Writeups
          <span class="pager-arrow"> »</span>
        </a>
      </span>
    
  </div>


  



        </div>
      </div>

      <aside id="box1">
  <div id="box1-inner">
  </div>
</aside>

    </div><!-- #wrapper -->

    
<aside id="box2">
  
  <div id="box2-inner">
    
      

<div class="hatena-module hatena-module-profile">
  <div class="hatena-module-title">
    プロフィール
  </div>
  <div class="hatena-module-body">
    
    <a href="https://ptr-yudai.hatenablog.com/about" class="profile-icon-link">
      <img src="./2020 - Structures that can be used in kernel exploits_files/profile(3).png" alt="id:ptr-yudai" class="profile-icon">
    </a>
    

    

    

    
    <div class="profile-description">
      <p>🍣 sushi 🍣</p>

    </div>
    

    
      <div class="hatena-follow-button-box btn-subscribe js-hatena-follow-button-box">

  <a href="https://ptr-yudai.hatenablog.com/entry/2020/03/16/165628#" class="hatena-follow-button js-hatena-follow-button unsubscribing">
    <span class="subscribing">
      <span class="foreground">読者です</span>
      <span class="background">読者をやめる</span>
    </span>
    <span class="unsubscribing" data-track-name="profile-widget-subscribe-button" data-track-once="">
      <span class="foreground">読者になる</span>
      <span class="background">読者になる</span>
    </span>
  </a>
  <div class="subscription-count-box js-subscription-count-box" style="display: block;">
    <i></i>
    <u></u>
    <span class="subscription-count js-subscription-count">73</span>
  </div>
</div>

    

    

    <div class="profile-about">
      <a href="https://ptr-yudai.hatenablog.com/about">このブログについて</a>
    </div>

  </div>
</div>

    
      <div class="hatena-module hatena-module-search-box">
  <div class="hatena-module-title">
    検索
  </div>
  <div class="hatena-module-body">
    <form class="search-form" role="search" action="https://ptr-yudai.hatenablog.com/search" method="get">
  <input type="text" name="q" class="search-module-input" value="" placeholder="記事を検索" required="">
  <input type="submit" value="検索" class="search-module-button">
</form>

  </div>
</div>

    
      

<div class="hatena-module hatena-module-archive" data-archive-type="default" data-archive-url="https://ptr-yudai.hatenablog.com/archive">
  <div class="hatena-module-title">
    <a href="https://ptr-yudai.hatenablog.com/archive">月別アーカイブ</a>
  </div>
  <div class="hatena-module-body">
  

  
    
    
      <ul class="hatena-urllist">
        
          <li class="archive-module-year archive-module-year-hidden" data-year="2021">
            <div class="archive-module-button">
              <span class="archive-module-hide-button">▼</span>
              <span class="archive-module-show-button">▶</span>
            </div>
            <a href="https://ptr-yudai.hatenablog.com/archive/2021" class="archive-module-year-title">
              2021 (18)
            </a>
            <ul class="archive-module-months">
              
                <li class="archive-module-month">
                  <a href="https://ptr-yudai.hatenablog.com/archive/2021/11" class="archive-module-month-title">
                    2021 / 11 (3)
                  </a>
                </li>
              
                <li class="archive-module-month">
                  <a href="https://ptr-yudai.hatenablog.com/archive/2021/10" class="archive-module-month-title">
                    2021 / 10 (2)
                  </a>
                </li>
              
                <li class="archive-module-month">
                  <a href="https://ptr-yudai.hatenablog.com/archive/2021/8" class="archive-module-month-title">
                    2021 / 8 (1)
                  </a>
                </li>
              
                <li class="archive-module-month">
                  <a href="https://ptr-yudai.hatenablog.com/archive/2021/7" class="archive-module-month-title">
                    2021 / 7 (2)
                  </a>
                </li>
              
                <li class="archive-module-month">
                  <a href="https://ptr-yudai.hatenablog.com/archive/2021/5" class="archive-module-month-title">
                    2021 / 5 (3)
                  </a>
                </li>
              
                <li class="archive-module-month">
                  <a href="https://ptr-yudai.hatenablog.com/archive/2021/4" class="archive-module-month-title">
                    2021 / 4 (2)
                  </a>
                </li>
              
                <li class="archive-module-month">
                  <a href="https://ptr-yudai.hatenablog.com/archive/2021/3" class="archive-module-month-title">
                    2021 / 3 (3)
                  </a>
                </li>
              
                <li class="archive-module-month">
                  <a href="https://ptr-yudai.hatenablog.com/archive/2021/2" class="archive-module-month-title">
                    2021 / 2 (2)
                  </a>
                </li>
              
            </ul>
          </li>
        
          <li class="archive-module-year" data-year="2020">
            <div class="archive-module-button">
              <span class="archive-module-hide-button">▼</span>
              <span class="archive-module-show-button">▶</span>
            </div>
            <a href="https://ptr-yudai.hatenablog.com/archive/2020" class="archive-module-year-title">
              2020 (43)
            </a>
            <ul class="archive-module-months">
              
                <li class="archive-module-month">
                  <a href="https://ptr-yudai.hatenablog.com/archive/2020/12" class="archive-module-month-title">
                    2020 / 12 (5)
                  </a>
                </li>
              
                <li class="archive-module-month">
                  <a href="https://ptr-yudai.hatenablog.com/archive/2020/11" class="archive-module-month-title">
                    2020 / 11 (2)
                  </a>
                </li>
              
                <li class="archive-module-month">
                  <a href="https://ptr-yudai.hatenablog.com/archive/2020/10" class="archive-module-month-title">
                    2020 / 10 (1)
                  </a>
                </li>
              
                <li class="archive-module-month">
                  <a href="https://ptr-yudai.hatenablog.com/archive/2020/9" class="archive-module-month-title">
                    2020 / 9 (4)
                  </a>
                </li>
              
                <li class="archive-module-month">
                  <a href="https://ptr-yudai.hatenablog.com/archive/2020/8" class="archive-module-month-title">
                    2020 / 8 (2)
                  </a>
                </li>
              
                <li class="archive-module-month">
                  <a href="https://ptr-yudai.hatenablog.com/archive/2020/7" class="archive-module-month-title">
                    2020 / 7 (4)
                  </a>
                </li>
              
                <li class="archive-module-month">
                  <a href="https://ptr-yudai.hatenablog.com/archive/2020/6" class="archive-module-month-title">
                    2020 / 6 (2)
                  </a>
                </li>
              
                <li class="archive-module-month">
                  <a href="https://ptr-yudai.hatenablog.com/archive/2020/5" class="archive-module-month-title">
                    2020 / 5 (2)
                  </a>
                </li>
              
                <li class="archive-module-month">
                  <a href="https://ptr-yudai.hatenablog.com/archive/2020/4" class="archive-module-month-title">
                    2020 / 4 (6)
                  </a>
                </li>
              
                <li class="archive-module-month">
                  <a href="https://ptr-yudai.hatenablog.com/archive/2020/3" class="archive-module-month-title">
                    2020 / 3 (7)
                  </a>
                </li>
              
                <li class="archive-module-month">
                  <a href="https://ptr-yudai.hatenablog.com/archive/2020/2" class="archive-module-month-title">
                    2020 / 2 (3)
                  </a>
                </li>
              
                <li class="archive-module-month">
                  <a href="https://ptr-yudai.hatenablog.com/archive/2020/1" class="archive-module-month-title">
                    2020 / 1 (5)
                  </a>
                </li>
              
            </ul>
          </li>
        
          <li class="archive-module-year archive-module-year-hidden" data-year="2019">
            <div class="archive-module-button">
              <span class="archive-module-hide-button">▼</span>
              <span class="archive-module-show-button">▶</span>
            </div>
            <a href="https://ptr-yudai.hatenablog.com/archive/2019" class="archive-module-year-title">
              2019 (55)
            </a>
            <ul class="archive-module-months">
              
                <li class="archive-module-month">
                  <a href="https://ptr-yudai.hatenablog.com/archive/2019/12" class="archive-module-month-title">
                    2019 / 12 (6)
                  </a>
                </li>
              
                <li class="archive-module-month">
                  <a href="https://ptr-yudai.hatenablog.com/archive/2019/11" class="archive-module-month-title">
                    2019 / 11 (3)
                  </a>
                </li>
              
                <li class="archive-module-month">
                  <a href="https://ptr-yudai.hatenablog.com/archive/2019/10" class="archive-module-month-title">
                    2019 / 10 (6)
                  </a>
                </li>
              
                <li class="archive-module-month">
                  <a href="https://ptr-yudai.hatenablog.com/archive/2019/9" class="archive-module-month-title">
                    2019 / 9 (2)
                  </a>
                </li>
              
                <li class="archive-module-month">
                  <a href="https://ptr-yudai.hatenablog.com/archive/2019/8" class="archive-module-month-title">
                    2019 / 8 (3)
                  </a>
                </li>
              
                <li class="archive-module-month">
                  <a href="https://ptr-yudai.hatenablog.com/archive/2019/7" class="archive-module-month-title">
                    2019 / 7 (2)
                  </a>
                </li>
              
                <li class="archive-module-month">
                  <a href="https://ptr-yudai.hatenablog.com/archive/2019/6" class="archive-module-month-title">
                    2019 / 6 (4)
                  </a>
                </li>
              
                <li class="archive-module-month">
                  <a href="https://ptr-yudai.hatenablog.com/archive/2019/5" class="archive-module-month-title">
                    2019 / 5 (5)
                  </a>
                </li>
              
                <li class="archive-module-month">
                  <a href="https://ptr-yudai.hatenablog.com/archive/2019/4" class="archive-module-month-title">
                    2019 / 4 (7)
                  </a>
                </li>
              
                <li class="archive-module-month">
                  <a href="https://ptr-yudai.hatenablog.com/archive/2019/3" class="archive-module-month-title">
                    2019 / 3 (5)
                  </a>
                </li>
              
                <li class="archive-module-month">
                  <a href="https://ptr-yudai.hatenablog.com/archive/2019/2" class="archive-module-month-title">
                    2019 / 2 (1)
                  </a>
                </li>
              
                <li class="archive-module-month">
                  <a href="https://ptr-yudai.hatenablog.com/archive/2019/1" class="archive-module-month-title">
                    2019 / 1 (11)
                  </a>
                </li>
              
            </ul>
          </li>
        
          <li class="archive-module-year archive-module-year-hidden" data-year="2018">
            <div class="archive-module-button">
              <span class="archive-module-hide-button">▼</span>
              <span class="archive-module-show-button">▶</span>
            </div>
            <a href="https://ptr-yudai.hatenablog.com/archive/2018" class="archive-module-year-title">
              2018 (9)
            </a>
            <ul class="archive-module-months">
              
                <li class="archive-module-month">
                  <a href="https://ptr-yudai.hatenablog.com/archive/2018/12" class="archive-module-month-title">
                    2018 / 12 (1)
                  </a>
                </li>
              
                <li class="archive-module-month">
                  <a href="https://ptr-yudai.hatenablog.com/archive/2018/11" class="archive-module-month-title">
                    2018 / 11 (2)
                  </a>
                </li>
              
                <li class="archive-module-month">
                  <a href="https://ptr-yudai.hatenablog.com/archive/2018/10" class="archive-module-month-title">
                    2018 / 10 (3)
                  </a>
                </li>
              
                <li class="archive-module-month">
                  <a href="https://ptr-yudai.hatenablog.com/archive/2018/9" class="archive-module-month-title">
                    2018 / 9 (2)
                  </a>
                </li>
              
                <li class="archive-module-month">
                  <a href="https://ptr-yudai.hatenablog.com/archive/2018/8" class="archive-module-month-title">
                    2018 / 8 (1)
                  </a>
                </li>
              
            </ul>
          </li>
        
      </ul>
    
  


</div>
</div>

    
    
  </div>
</aside>


  </div>
</div>




        

        
  <div id="bottom-editarea">
    <script>
var codeBlocks = document.getElementsByClassName('code');
[].forEach.call(codeBlocks, function(e) {
    if (!/lang/.test(e.className)) {
        return;
    }

    var lines = e.innerHTML.split(/\n/);
    var codeBlock = "";
    lines.forEach(function(line){
        if(line != ""){
            codeBlock += '<div class="code-line">' + line + '</div>'      
        }
    })
    e.innerHTML = codeBlock;
    e.classList.add("code-lang");
});
</script>

  </div>


      </div>
    </div>
    
<footer id="footer" data-brand="hatenablog">
  <div id="footer-inner">
    
      <div style="display: block !important;" class="guest-footer js-guide-register test-blogs-register-guide" data-action="guide-register">
  <div class="guest-footer-content">
    <h3>はてなブログをはじめよう！</h3>
    <p>ptr-yudaiさんは、はてなブログを使っています。あなたもはてなブログをはじめてみませんか？</p>
    <div class="guest-footer-btn-container">
      <div class="guest-footer-btn">
        <a class="btn btn-register js-inherit-ga" href="https://blog.hatena.ne.jp/register?via=200227" target="_blank">はてなブログをはじめる（無料）</a>
      </div>
      <div class="guest-footer-btn">
        <a href="https://hatenablog.com/guide" target="_blank">はてなブログとは</a>
      </div>
    </div>
  </div>
</div>

    
    <address class="footer-address">
      <a href="https://ptr-yudai.hatenablog.com/">
        <img src="./2020 - Structures that can be used in kernel exploits_files/https___cdn.user.blog.st-hatena.com_blog_custom_icon_153103571_1535456424487441" width="16" height="16" alt="CTFするぞ">
        <span class="footer-address-name">CTFするぞ</span>
      </a>
    </address>
    <p class="services">
      Powered by <a href="https://hatenablog.com/">Hatena Blog</a>
      |
        <a href="https://blog.hatena.ne.jp/-/abuse_report?target_url=https%3A%2F%2Fptr-yudai.hatenablog.com%2Fentry%2F2020%2F03%2F16%2F165628" class="report-abuse-link test-report-abuse-link" target="_blank">ブログを報告する</a>
    </p>
  </div>
</footer>


    

    
  
    <script src="./2020 - Structures that can be used in kernel exploits_files/HatenaStar.js.下載"></script>
  


    
    

<div class="quote-box">
   
    <div class="tooltip-quote tooltip-quote-star" style="display: block;">
      <i class="blogicon-star" title="引用スターをつける"></i>
    </div>
  
  <div class="tooltip-quote tooltip-quote-stock">
    <i class="blogicon-quote" title="引用をストック"></i>
  </div>
  <div class="tooltip-quote tooltip-quote-tweet js-tooltip-quote-tweet">
    <a class="js-tweet-quote" target="_blank" data-track-name="quote-tweet" data-track-once=""><i class="blogicon-twitter" title="引用してツイートする"></i></a>
  </div>
</div>

 
  <div class="message-box" id="quote-star-message-box" style="display: none; position: absolute;">
    スターをつけました
  </div>


<div class="quote-stock-panel" id="quote-stock-message-box" style="position: absolute; z-index: 3000">
  <div class="message-box" id="quote-stock-succeeded-message" style="display: none">
    <p>引用をストックしました</p>
    <button class="btn btn-primary" id="quote-stock-show-editor-button" data-track-name="curation-quote-edit-button">ストック一覧を見る</button>
    <button class="btn quote-stock-close-message-button">閉じる</button>
  </div>

  <div class="message-box" id="quote-login-required-message" style="display: none">
    <p>引用するにはまずログインしてください</p>
    <button class="btn btn-primary" id="quote-login-button">ログイン</button>
    <button class="btn quote-stock-close-message-button">閉じる</button>
  </div>

  <div class="error-box" id="quote-stock-failed-message" style="display: none">
    <p>引用をストックできませんでした。再度お試しください</p>
    <button class="btn quote-stock-close-message-button">閉じる</button>
  </div>

  <div class="error-box" id="unstockable-quote-message-box" style="display: none; position: absolute; z-index: 3000;">
    <p>限定公開記事のため引用できません。</p>
  </div>
</div>

<script type="x-underscore-template" id="js-requote-button-template">
  <div class="requote-button js-requote-button">
    <button class="requote-button-btn tipsy-top" title="引用する"><i class="blogicon-quote"></i></button>
  </div>
</script>



    
    <div id="hidden-subscribe-button" style="display: none;">
      <div class="hatena-follow-button-box btn-subscribe js-hatena-follow-button-box">

  <a href="https://ptr-yudai.hatenablog.com/entry/2020/03/16/165628#" class="hatena-follow-button js-hatena-follow-button unsubscribing">
    <span class="subscribing">
      <span class="foreground">読者です</span>
      <span class="background">読者をやめる</span>
    </span>
    <span class="unsubscribing" data-track-name="profile-widget-subscribe-button" data-track-once="">
      <span class="foreground">読者になる</span>
      <span class="background">読者になる</span>
    </span>
  </a>
  <div class="subscription-count-box js-subscription-count-box" style="display: block;">
    <i></i>
    <u></u>
    <span class="subscription-count js-subscription-count">73</span>
  </div>
</div>

    </div>

    
  <script type="text/javascript" src="./2020 - Structures that can be used in kernel exploits_files/widgets.js.下載"></script>

<script type="text/javascript" src="./2020 - Structures that can be used in kernel exploits_files/bookmark_button.js.下載" charset="utf-8" async="async"></script>


<script type="text/javascript" src="./2020 - Structures that can be used in kernel exploits_files/jquery.min.js.下載"></script>
<script type="text/javascript" src="./2020 - Structures that can be used in kernel exploits_files/jquery.flot.js.下載"></script>
<script type="text/javascript" src="./2020 - Structures that can be used in kernel exploits_files/jquery.flot.time.js.下載"></script>
<script id="vendor-js" data-env="production" type="text/javascript" src="./2020 - Structures that can be used in kernel exploits_files/vendor.js.下載" crossorigin="anonymous"></script>





<script type="text/javascript" src="./2020 - Structures that can be used in kernel exploits_files/texts-ja.js.下載"></script>
<script id="hatenablog-js" data-env="production" type="text/javascript" src="./2020 - Structures that can be used in kernel exploits_files/hatenablog.js.下載" crossorigin="anonymous"></script><div style="position: fixed; top: 0px; left: 0px; width: 100%; height: 100%; display: none;"></div>


  <script type="text/javascript">Hatena.Diary.GlobalHeader.init()</script>


<script src="./2020 - Structures that can be used in kernel exploits_files/api.js.下載" async="" defer=""></script>






    
  <script id="valve-dmp" data-service="blog" src="./2020 - Structures that can be used in kernel exploits_files/dmp.js.下載" data-test-id="dmpjs" async=""></script>


    





  


<iframe scrolling="no" frameborder="0" allowtransparency="true" src="./2020 - Structures that can be used in kernel exploits_files/widget_iframe.a53eecb4584348a2ad32ec2ae21f6eae.html" title="Twitter settings iframe" style="display: none;"></iframe><div id="cboxOverlay" style="display: none;"></div><div id="colorbox" class="" role="dialog" tabindex="-1" style="display: none;"><div id="cboxWrapper"><div><div id="cboxTopLeft" style="float: left;"></div><div id="cboxTopCenter" style="float: left;"></div><div id="cboxTopRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxMiddleLeft" style="float: left;"></div><div id="cboxContent" style="float: left;"><div id="cboxTitle" style="float: left;"></div><div id="cboxCurrent" style="float: left;"></div><button type="button" id="cboxPrevious"></button><button type="button" id="cboxNext"></button><button type="button" id="cboxSlideshow"></button><div id="cboxLoadingOverlay" style="float: left;"></div><div id="cboxLoadingGraphic" style="float: left;"></div></div><div id="cboxMiddleRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxBottomLeft" style="float: left;"></div><div id="cboxBottomCenter" style="float: left;"></div><div id="cboxBottomRight" style="float: left;"></div></div></div><div style="position: absolute; width: 9999px; visibility: hidden; display: none; max-width: none;"></div></div><div style="top: -9999px; z-index: -9999;"></div><iframe height="0" width="0" style="display: none; visibility: hidden;" src="./2020 - Structures that can be used in kernel exploits_files/activityi.html"></iframe><iframe id="rufous-sandbox" scrolling="no" frameborder="0" allowtransparency="true" allowfullscreen="true" style="position: absolute; visibility: hidden; display: none; width: 0px; height: 0px; padding: 0px; border: none;" title="Twitter analytics iframe" src="./2020 - Structures that can be used in kernel exploits_files/saved_resource(3).html"></iframe><script type="text/javascript" id="">(function(a){var b=a.createElement("iframe"),c="https:"==a.location.protocol?"https://":"http://";b.src=c+"cf.im-apps.net/imid/beacon.html";b.style.display="none";a.body.appendChild(b)})(document);</script><iframe src="./2020 - Structures that can be used in kernel exploits_files/beacon.html" style="display: none;"></iframe><script type="text/javascript" id="" src="./2020 - Structures that can be used in kernel exploits_files/pageview.js.下載"></script><script type="text/javascript" id="">!function(c,d,b,g){if(!d[c]){d[c]=function(){d[c].instances.push(this);this.init&&this.init()};d[c].instances=[];for(var a=0,e=["send"];a<e.length;a++)d[c].prototype[e[a]]=function(f){return function(){this["tmp_"+f]=this["tmp_"+f]||[];this["tmp_"+f].push(Array.prototype.slice.call(arguments))}}(e[a]);a=b.getElementsByTagName(g)[0];b=b.createElement(g);b.async=!0;b.src="//dmp.im-apps.net/mtm/tracker.min.js";a.parentNode.insertBefore(b,a)}}("IMST",window,document,"script");var imst=new IMST;
imst.siteId="6604";imst.imApiToken="TlOjMPj_m54xiIkb8Mzm7Q";imst.send({custom_data:google_tag_manager["GTM-PWRB9N"].macro(14)});</script>
<img width="0" height="0" class="imPageviewImgBcn" referrerpolicy="no-referrer-when-downgrade" src="./2020 - Structures that can be used in kernel exploits_files/beacon.gif" style="visibility: hidden; display: none; width: 0px; height: 0px;"><iframe src="./2020 - Structures that can be used in kernel exploits_files/syncframe.html" id="criteo-syncframe-pbt" style="display: none;"></iframe><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mP8/5+hHgAHggJ/PchI7wAAAABJRU5ErkJggg==" width="1" height="1" border="0" class="bigmining_dmp_beacon" style="display: none;"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mP8/5+hHgAHggJ/PchI7wAAAABJRU5ErkJggg==" width="1" height="1" border="0" class="bigmining_dmp_beacon" style="display: none;"><img src="./2020 - Structures that can be used in kernel exploits_files/adsct" width="1" height="1" border="0" class="bigmining_dmp_beacon" style="display: none;"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-P5GX4M');</script><div style="display: none; visibility: hidden;"><script type="text/javascript">!function(c,d,b,f){if(!d[c]){d[c]=function(){d[c].instances.push(this);this.init&&this.init()};d[c].instances=[];for(var a=0,e=["td_send","td_send_imid"];a<e.length;a++)d[c].prototype[e[a]]=function(a){return function(){this["tmp_"+a]=this["tmp_"+a]||[];this["tmp_"+a].push(Array.prototype.slice.call(arguments))}}(e[a]);a=b.getElementsByTagName(f)[0];b=b.createElement(f);b.async=!0;b.src="//cf.im-apps.net/sdk/tdim-0.11.2.js";a.parentNode.insertBefore(b,a)}}("TDIM",window,document,"script");var t=new TDIM;
t.td_api_key="312/b4f0042d7c26b4f44d2561bbb5c396349b54b10e";t.td_db="cosmi_8045";t.im_api_token="omO0CDJd98sxiIkb8Mzm7Q";t.gtm_dl="dataLayer";t.td_send_imid("pageviews");</script></div><div style="display: none; visibility: hidden;">
<script src="./2020 - Structures that can be used in kernel exploits_files/oct.js.下載" type="text/javascript"></script></div><div style="display: none; visibility: hidden;"></div><div style="display: none; visibility: hidden;"></div></body><iframe sandbox="allow-scripts allow-same-origin" id="2198e1fcd10cb66" frameborder="0" allowtransparency="true" marginheight="0" marginwidth="0" width="0" hspace="0" vspace="0" height="0" style="height:0px;width:0px;display:none;" scrolling="no" src="./2020 - Structures that can be used in kernel exploits_files/showad.html">
    </iframe><iframe sandbox="allow-scripts allow-same-origin" id="22f1a3939114338" frameborder="0" allowtransparency="true" marginheight="0" marginwidth="0" width="0" hspace="0" vspace="0" height="0" style="height:0px;width:0px;display:none;" scrolling="no" src="./2020 - Structures that can be used in kernel exploits_files/async_usersync.html">
    </iframe><iframe sandbox="allow-scripts allow-same-origin" id="236fc55c0d0e0fa" frameborder="0" allowtransparency="true" marginheight="0" marginwidth="0" width="0" hspace="0" vspace="0" height="0" style="height:0px;width:0px;display:none;" scrolling="no" src="./2020 - Structures that can be used in kernel exploits_files/push_sync.html">
    </iframe><iframe sandbox="allow-scripts allow-same-origin" id="24980b580cdbb17" frameborder="0" allowtransparency="true" marginheight="0" marginwidth="0" width="0" hspace="0" vspace="0" height="0" style="height:0px;width:0px;display:none;" scrolling="no" src="./2020 - Structures that can be used in kernel exploits_files/usync.html">
    </iframe><iframe sandbox="allow-scripts allow-same-origin" id="253e773b937288a" frameborder="0" allowtransparency="true" marginheight="0" marginwidth="0" width="0" hspace="0" vspace="0" height="0" style="height:0px;width:0px;display:none;" scrolling="no" src="./2020 - Structures that can be used in kernel exploits_files/pd.html">
    </iframe></html>