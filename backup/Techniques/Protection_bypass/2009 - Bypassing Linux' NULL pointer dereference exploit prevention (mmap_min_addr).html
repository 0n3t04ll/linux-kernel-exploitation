<!DOCTYPE html>
<!-- saved from url=(0062)https://blog.cr0.org/2009/06/bypassing-linux-null-pointer.html -->
<html class="v2" dir="ltr" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link href="./2009 - Bypassing Linux&#39; NULL pointer dereference exploit prevention (mmap_min_addr)_files/1529571102-css_bundle_v2.css" rel="stylesheet" type="text/css">
<meta content="width=1100" name="viewport">

<meta content="blogger" name="generator">
<link href="https://blog.cr0.org/favicon.ico" rel="icon" type="image/x-icon">
<link href="https://blog.cr0.org/2009/06/bypassing-linux-null-pointer.html" rel="canonical">
<link rel="alternate" type="application/atom+xml" title="cr0 blog - Atom" href="https://blog.cr0.org/feeds/posts/default">
<link rel="alternate" type="application/rss+xml" title="cr0 blog - RSS" href="https://blog.cr0.org/feeds/posts/default?alt=rss">
<link rel="service.post" type="application/atom+xml" title="cr0 blog - Atom" href="https://www.blogger.com/feeds/8992811497323121233/posts/default">

<link rel="alternate" type="application/atom+xml" title="cr0 blog - Atom" href="https://blog.cr0.org/feeds/5382334599747832580/comments/default">
<!--[if IE]><script type="text/javascript" src="https://www.blogger.com/static/v1/jsbin/1155466832-ieretrofit.js"></script>
<![endif]-->
<meta content="https://blog.cr0.org/2009/06/bypassing-linux-null-pointer.html" property="og:url">
<meta content="Bypassing Linux&#39; NULL pointer dereference exploit prevention (mmap_min_addr)" property="og:title">
<meta content="EDIT3: Slashdot , the SANS Institute , Threatpost  and others have a story about an exploit by Bradley Spengler  which uses our technique to..." property="og:description">
<!--[if IE]> <script> (function() { var html5 = ("abbr,article,aside,audio,canvas,datalist,details," + "figure,footer,header,hgroup,mark,menu,meter,nav,output," + "progress,section,time,video").split(','); for (var i = 0; i < html5.length; i++) { document.createElement(html5[i]); } try { document.execCommand('BackgroundImageCache', false, true); } catch(e) {} })(); </script> <![endif]-->
<title>cr0 blog: Bypassing Linux' NULL pointer dereference exploit prevention (mmap_min_addr)</title>
<style id="page-skin-1" type="text/css"><!--
/*
-----------------------------------------------
Blogger Template Style
Name:     Simple
Designer: Blogger
URL:      www.blogger.com
----------------------------------------------- */
/* Content
----------------------------------------------- */
body {
font: normal normal 12px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #cccccc;
background: #292929 none repeat scroll top left;
padding: 0 40px 40px 40px;
}
html body .region-inner {
min-width: 0;
max-width: 100%;
width: auto;
}
h2 {
font-size: 22px;
}
a:link {
text-decoration:none;
color: #dd7700;
}
a:visited {
text-decoration:none;
color: #cc6600;
}
a:hover {
text-decoration:underline;
color: #cc6600;
}
.body-fauxcolumn-outer .fauxcolumn-inner {
background: transparent none repeat scroll top left;
_background-image: none;
}
.body-fauxcolumn-outer .cap-top {
position: absolute;
z-index: 1;
height: 400px;
width: 100%;
}
.body-fauxcolumn-outer .cap-top .cap-left {
width: 100%;
background: transparent none repeat-x scroll top left;
_background-image: none;
}
.content-outer {
-moz-box-shadow: 0 0 40px rgba(0, 0, 0, .15);
-webkit-box-shadow: 0 0 5px rgba(0, 0, 0, .15);
-goog-ms-box-shadow: 0 0 10px #333333;
box-shadow: 0 0 40px rgba(0, 0, 0, .15);
margin-bottom: 1px;
}
.content-inner {
padding: 10px 10px;
}
.content-inner {
background-color: #333333;
}
/* Header
----------------------------------------------- */
.header-outer {
background: transparent none repeat-x scroll 0 -400px;
_background-image: none;
}
.Header h1 {
font: normal normal 60px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #ffffff;
text-shadow: -1px -1px 1px rgba(0, 0, 0, .2);
}
.Header h1 a {
color: #ffffff;
}
.Header .description {
font-size: 140%;
color: #aaaaaa;
}
.header-inner .Header .titlewrapper {
padding: 22px 30px;
}
.header-inner .Header .descriptionwrapper {
padding: 0 30px;
}
/* Tabs
----------------------------------------------- */
.tabs-inner .section:first-child {
border-top: 1px solid #404040;
}
.tabs-inner .section:first-child ul {
margin-top: -1px;
border-top: 1px solid #404040;
border-left: 0 solid #404040;
border-right: 0 solid #404040;
}
.tabs-inner .widget ul {
background: #222222 none repeat-x scroll 0 -800px;
_background-image: none;
border-bottom: 1px solid #404040;
margin-top: 0;
margin-left: -30px;
margin-right: -30px;
}
.tabs-inner .widget li a {
display: inline-block;
padding: .6em 1em;
font: normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #999999;
border-left: 1px solid #333333;
border-right: 0 solid #404040;
}
.tabs-inner .widget li:first-child a {
border-left: none;
}
.tabs-inner .widget li.selected a, .tabs-inner .widget li a:hover {
color: #ffffff;
background-color: #000000;
text-decoration: none;
}
/* Columns
----------------------------------------------- */
.main-outer {
border-top: 0 solid #404040;
}
.fauxcolumn-left-outer .fauxcolumn-inner {
border-right: 1px solid #404040;
}
.fauxcolumn-right-outer .fauxcolumn-inner {
border-left: 1px solid #404040;
}
/* Headings
----------------------------------------------- */
div.widget > h2,
div.widget h2.title {
margin: 0 0 1em 0;
font: normal bold 11px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #ffffff;
}
/* Widgets
----------------------------------------------- */
.widget .zippy {
color: #999999;
text-shadow: 2px 2px 1px rgba(0, 0, 0, .1);
}
.widget .popular-posts ul {
list-style: none;
}
/* Posts
----------------------------------------------- */
h2.date-header {
font: normal bold 11px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
}
.date-header span {
background-color: transparent;
color: #cccccc;
padding: inherit;
letter-spacing: inherit;
margin: inherit;
}
.main-inner {
padding-top: 30px;
padding-bottom: 30px;
}
.main-inner .column-center-inner {
padding: 0 15px;
}
.main-inner .column-center-inner .section {
margin: 0 15px;
}
.post {
margin: 0 0 25px 0;
}
h3.post-title, .comments h4 {
font: normal normal 22px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
margin: .75em 0 0;
}
.post-body {
font-size: 110%;
line-height: 1.4;
position: relative;
}
.post-body img, .post-body .tr-caption-container, .Profile img, .Image img,
.BlogList .item-thumbnail img {
padding: 0;
background: #111111;
border: 1px solid #111111;
-moz-box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
-webkit-box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
}
.post-body img, .post-body .tr-caption-container {
padding: 1px;
}
.post-body .tr-caption-container {
color: #cccccc;
}
.post-body .tr-caption-container img {
padding: 0;
background: transparent;
border: none;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .1);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .1);
box-shadow: 0 0 0 rgba(0, 0, 0, .1);
}
.post-header {
margin: 0 0 1.5em;
line-height: 1.6;
font-size: 90%;
}
.post-footer {
margin: 20px -2px 0;
padding: 5px 10px;
color: #888888;
background-color: #303030;
border-bottom: 1px solid #444444;
line-height: 1.6;
font-size: 90%;
}
#comments .comment-author {
padding-top: 1.5em;
border-top: 1px solid #404040;
background-position: 0 1.5em;
}
#comments .comment-author:first-child {
padding-top: 0;
border-top: none;
}
.avatar-image-container {
margin: .2em 0 0;
}
#comments .avatar-image-container img {
border: 1px solid #111111;
}
/* Comments
----------------------------------------------- */
.comments .comments-content .icon.blog-author {
background-repeat: no-repeat;
background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEgAACxIB0t1+/AAAAAd0SU1FB9sLFwMeCjjhcOMAAAD+SURBVDjLtZSvTgNBEIe/WRRnm3U8RC1neQdsm1zSBIU9VVF1FkUguQQsD9ITmD7ECZIJSE4OZo9stoVjC/zc7ky+zH9hXwVwDpTAWWLrgS3QAe8AZgaAJI5zYAmc8r0G4AHYHQKVwII8PZrZFsBFkeRCABYiMh9BRUhnSkPTNCtVXYXURi1FpBDgArj8QU1eVXUzfnjv7yP7kwu1mYrkWlU33vs1QNu2qU8pwN0UpKoqokjWwCztrMuBhEhmh8bD5UDqur75asbcX0BGUB9/HAMB+r32hznJgXy2v0sGLBcyAJ1EK3LFcbo1s91JeLwAbwGYu7TP/3ZGfnXYPgAVNngtqatUNgAAAABJRU5ErkJggg==);
}
.comments .comments-content .loadmore a {
border-top: 1px solid #999999;
border-bottom: 1px solid #999999;
}
.comments .comment-thread.inline-thread {
background-color: #303030;
}
.comments .continue {
border-top: 2px solid #999999;
}
/* Accents
---------------------------------------------- */
.section-columns td.columns-cell {
border-left: 1px solid #404040;
}
.blog-pager {
background: transparent none no-repeat scroll top center;
}
.blog-pager-older-link, .home-link,
.blog-pager-newer-link {
background-color: #333333;
padding: 5px;
}
.footer-outer {
border-top: 0 dashed #bbbbbb;
}
/* Mobile
----------------------------------------------- */
body.mobile  {
background-size: auto;
}
.mobile .body-fauxcolumn-outer {
background: transparent none repeat scroll top left;
}
.mobile .body-fauxcolumn-outer .cap-top {
background-size: 100% auto;
}
.mobile .content-outer {
-webkit-box-shadow: 0 0 3px rgba(0, 0, 0, .15);
box-shadow: 0 0 3px rgba(0, 0, 0, .15);
}
.mobile .tabs-inner .widget ul {
margin-left: 0;
margin-right: 0;
}
.mobile .post {
margin: 0;
}
.mobile .main-inner .column-center-inner .section {
margin: 0;
}
.mobile .date-header span {
padding: 0.1em 10px;
margin: 0 -10px;
}
.mobile h3.post-title {
margin: 0;
}
.mobile .blog-pager {
background: transparent none no-repeat scroll top center;
}
.mobile .footer-outer {
border-top: none;
}
.mobile .main-inner, .mobile .footer-inner {
background-color: #333333;
}
.mobile-index-contents {
color: #cccccc;
}
.mobile-link-button {
background-color: #dd7700;
}
.mobile-link-button a:link, .mobile-link-button a:visited {
color: #ffffff;
}
.mobile .tabs-inner .section:first-child {
border-top: none;
}
.mobile .tabs-inner .PageList .widget-content {
background-color: #000000;
color: #ffffff;
border-top: 1px solid #404040;
border-bottom: 1px solid #404040;
}
.mobile .tabs-inner .PageList .widget-content .pagelist-arrow {
border-left: 1px solid #404040;
}

--></style>
<style id="template-skin-1" type="text/css"><!--
body {
min-width: 960px;
}
.content-outer, .content-fauxcolumn-outer, .region-inner {
min-width: 960px;
max-width: 960px;
_width: 960px;
}
.main-inner .columns {
padding-left: 0;
padding-right: 310px;
}
.main-inner .fauxcolumn-center-outer {
left: 0;
right: 310px;
/* IE6 does not respect left and right together */
_width: expression(this.parentNode.offsetWidth -
parseInt("0") -
parseInt("310px") + 'px');
}
.main-inner .fauxcolumn-left-outer {
width: 0;
}
.main-inner .fauxcolumn-right-outer {
width: 310px;
}
.main-inner .column-left-outer {
width: 0;
right: 100%;
margin-left: -0;
}
.main-inner .column-right-outer {
width: 310px;
margin-right: -310px;
}
#layout {
min-width: 0;
}
#layout .content-outer {
min-width: 0;
width: 800px;
}
#layout .region-inner {
min-width: 0;
width: auto;
}
body#layout div.add_widget {
padding: 8px;
}
body#layout div.add_widget a {
margin-left: 32px;
}
--></style>
<link href="./2009 - Bypassing Linux&#39; NULL pointer dereference exploit prevention (mmap_min_addr)_files/authorization.css" media="all" onload="if(media!=&#39;all&#39;)media=&#39;all&#39;" rel="stylesheet"><noscript><link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=8992811497323121233&amp;zx=bec4f5f9-5299-4aaf-b7e1-68de97c1f169' rel='stylesheet'/></noscript>
<meta name="google-adsense-platform-account" content="ca-host-pub-1556223355139109">
<meta name="google-adsense-platform-domain" content="blogspot.com">

</head>
<body class=" variant-dark">
<div class="navbar no-items section" id="navbar" name="Navbar">
</div>
<div class="body-fauxcolumns">
<div class="fauxcolumn-outer body-fauxcolumn-outer">
<div class="cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left">
<div class="fauxborder-right"></div>
<div class="fauxcolumn-inner">
</div>
</div>
<div class="cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
</div>
<div class="content">
<div class="content-fauxcolumns">
<div class="fauxcolumn-outer content-fauxcolumn-outer">
<div class="cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left">
<div class="fauxborder-right"></div>
<div class="fauxcolumn-inner">
</div>
</div>
<div class="cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
</div>
<div class="content-outer">
<div class="content-cap-top cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left content-fauxborder-left">
<div class="fauxborder-right content-fauxborder-right"></div>
<div class="content-inner">
<header>
<div class="header-outer">
<div class="header-cap-top cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left header-fauxborder-left">
<div class="fauxborder-right header-fauxborder-right"></div>
<div class="region-inner header-inner">
<div class="header section" id="header" name="Header"><div class="widget Header" data-version="1" id="Header1">
<div id="header-inner">
<div class="titlewrapper">
<h1 class="title">
<a href="https://blog.cr0.org/">
cr0 blog
</a>
</h1>
</div>
<div class="descriptionwrapper">
<p class="description"><span>a blog about IT security and other geek interests</span></p>
</div>
</div>
</div></div>
</div>
</div>
<div class="header-cap-bottom cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
</header>
<div class="tabs-outer">
<div class="tabs-cap-top cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left tabs-fauxborder-left">
<div class="fauxborder-right tabs-fauxborder-right"></div>
<div class="region-inner tabs-inner">
<div class="tabs no-items section" id="crosscol" name="Cross-Column"></div>
<div class="tabs no-items section" id="crosscol-overflow" name="Cross-Column 2"></div>
</div>
</div>
<div class="tabs-cap-bottom cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
<div class="main-outer">
<div class="main-cap-top cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left main-fauxborder-left">
<div class="fauxborder-right main-fauxborder-right"></div>
<div class="region-inner main-inner">
<div class="columns fauxcolumns">
<div class="fauxcolumn-outer fauxcolumn-center-outer">
<div class="cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left">
<div class="fauxborder-right"></div>
<div class="fauxcolumn-inner">
</div>
</div>
<div class="cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
<div class="fauxcolumn-outer fauxcolumn-left-outer">
<div class="cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left">
<div class="fauxborder-right"></div>
<div class="fauxcolumn-inner">
</div>
</div>
<div class="cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
<div class="fauxcolumn-outer fauxcolumn-right-outer">
<div class="cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left">
<div class="fauxborder-right"></div>
<div class="fauxcolumn-inner">
</div>
</div>
<div class="cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
<!-- corrects IE6 width calculation -->
<div class="columns-inner">
<div class="column-center-outer">
<div class="column-center-inner">
<div class="main section" id="main" name="Main"><div class="widget Blog" data-version="1" id="Blog1">
<div class="blog-posts hfeed">

          <div class="date-outer">
        
<h2 class="date-header"><span>Friday, June 26, 2009</span></h2>

          <div class="date-posts">
        
<div class="post-outer">
<div class="post hentry uncustomized-post-template" itemprop="blogPost" itemscope="itemscope" itemtype="http://schema.org/BlogPosting">
<meta content="8992811497323121233" itemprop="blogId">
<meta content="5382334599747832580" itemprop="postId">
<a name="5382334599747832580"></a>
<h3 class="post-title entry-title" itemprop="name">
Bypassing Linux' NULL pointer dereference exploit prevention (mmap_min_addr)
</h3>
<div class="post-header">
<div class="post-header-line-1"></div>
</div>
<div class="post-body entry-content" id="post-body-5382334599747832580" itemprop="description articleBody">
EDIT3: <a href="http://it.slashdot.org/story/09/07/18/0136224/New-Linux-Kernel-Flaw-Allows-Null-Pointer-Exploits">Slashdot</a>, the <a href="http://isc.sans.org/diary.html?storyid=6820">SANS Institute</a>, <a href="http://threatpost.com/blogs/researcher-uses-new-linux-kernel-flaw-bypass-selinux-other-protections">Threatpost</a> and others have a story about <a href="http://www.grsecurity.net/~spender/exploit.txt">an exploit by Bradley Spengler</a> which uses our technique to exploit a null pointer dereference in the Linux kernel.<br>
EDIT2: As of July 13th 2009, the Linux kernel <a href="http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git;a=commitdiff;h=f9fabcb58a6d26d6efde842d1703ac7cfa9427b6">integrates our patch</a> (2.6.31-rc3). Our patch also made it into -stable.<br>
EDIT1: This is now referenced as a vulnerability and tracked as CVE-2009-1895<br>
<br>
NULL pointers dereferences are a <a href="https://www.google.com/search?hl=en&amp;q=linux+null+pointer+dereference">common</a> security issue in the Linux kernel.<br>
<br>
In the realm of userland applications, <a href="http://cansecwest.com/core05/memory_vulns_delalleau.pdf">exploiting them</a> usually requires being able to somehow control the target's allocations until you get page zero mapped, and this can be very hard.<br>
<br>
In the paradigm of locally exploiting the Linux kernel however, nothing (before Linux 2.6.23) prevented you from mapping page zero with mmap() and crafting it to suit your needs before triggering the bug in your process' context. Since the kernel's data and code segment both have a base of zero, a null pointer dereference would make the kernel access page zero, a page filled with bytes in your control. Easy.<br>
<br>
This used to not be the case, back in Linux 2.0 when the kernel's data segment's base was above PAGE_OFFSET and the kernel had to explicitely use a segment override (with the fs selector) to access data in userland. The same rough idea is now used in <a href="http://www.grsecurity.net/">PaX/GRSecurity</a>'s UDEREF to prevent exploitation of "unexpected to userland kernel accesses" (it actually makes use of an expand down segment instead of a PAGE_OFFSET segment base, but that's a detail).<br>
<br>
Kernel developpers tried to solve this issue too, but without resorting to segmentation (which is considered deprecated and is mostly not available on x86_64) and in a portable (cross architectures) way. In 2.6.23, they introduced a new sysctl, called vm.mmap_min_addr, that defines the minimum address that you can request a mapping at. Of course, this doesn't solve the complete issue of "to userland pointer dereferences" and it also breaks the somewhat useful feature of being able to map the first pages (this breaks <a href="http://dosemu.sourceforge.net/">Dosemu</a> for instance), but in practice this has been effective enough to make exploitation of many vulnerabilities harder or impossible.<br>
<br>
Recently, <a href="http://taviso.decsystem.org/">Tavis Ormandy</a> and myself had to exploit such a condition in the Linux kernel. We investigated a few ideas, such as:<br>
<ul>
<li>using brk()</li>
<li>creating a MAP_GROWSDOWN mapping just above the forbidden region (usually 64K) and segfaulting the last page of the forbidden region</li>
<li>obscure system calls such as remap_file_pages</li>
<li>putting memory pressure in the address space to let the kernel allocate in this region</li>
<li>using the MAP_PAGE_ZERO personality</li>
</ul>
All of them without any luck at first. The LSM hook responsible for this security check was correctly called every time.<br>
<br>
So what does the default security module do in cap_file_mmap? This is the relevant code (in <a href="http://lxr.linux.no/linux+v2.6.30/security/capability.c#L333">security/capability.c</a> on recent versions of the Linux kernel):<br>
<pre><span style="font-family: courier new; font-size: 130%;">if ((addr &lt; mmap_min_addr)
&amp;&amp; !capable(CAP_SYS_RAWIO))</span><span style="font-size: 130%;">
</span><span style="font-family: courier new; font-size: 130%;">  return -EACCES;</span><span style="font-size: 130%;">
</span><span style="font-family: courier new; font-size: 130%;">return 0;</span></pre>
Meaning that a process with CAP_SYS_RAWIO can bypass this check. How can we get our process to have this capability ? By executing a setuid binary of course! So we set the <a href="http://lxr.linux.no/linux+v2.6.30/fs/binfmt_elf.c#L976">MMAP_PAGE_ZERO personality</a> and execute a setuid binary. Page zero will get mapped, but the setuid binary is executing and we don't have control anymore.<br>
So, how do we get control back ? Using something such as "/bin/su our_user_name" could be tempting, but while this would indeed give us control back, su will drop privileges before giving us control back (it'd be a vulnerability otherwise!), so the Linux kernel will make exec fail in the cap_file_mmap check (due to the MMAP_PAGE_ZERO personality).<br>
<br>
So what we need is a setuid binary that will give us control back without going through exec. We found such a setuid binary that is installed on many Desktop Linux machines by default: pulseaudio. pulseaudio will drop privileges and let you specify a library to load though its -L argument. Exactly what we needed!<br>
<br>
Once we have <span style="font-style: italic;">one page</span> mapped in the forbidden area, it's game over. Nothing will prevent us from using mremap to grow the area and mprotect to change our access rights to <span style="font-family: courier new;">PROT_READ|PROT_WRITE|PROT_EXEC</span>. So this completely bypasses the Linux kernel's protection.<br>
<br>
Note that apart from this problem, the mere fact that MMAP_PAGE_ZERO is not in the <a href="http://lxr.linux.no/linux+v2.6.30/include/linux/personality.h#L43"><span style="font-family: courier new;">PER_CLEAR_ON_SETID</span></a> mask and thus is allowed when executing setuid binaries can be a security issue: being able to map page zero in a process with euid=0, even without controlling its content could be useful when exploiting a null pointer vulnerability in a setuid application.<br>
<br>
We believe that the<a href="http://patchwork.kernel.org/patch/32598/"> correct fix for this issue</a> is to add <span style="font-family: courier new;">MMAP_PAGE_ZERO</span> to the <span style="font-family: courier new;"><a href="http://lxr.linux.no/linux+v2.6.30/include/linux/personality.h#L43">PER_CLEAR_ON_SETID</a> mask.</span><br>
PS: Thanks to Robert Swiecki for some help while investigating this.
<div style="clear: both;"></div>
</div>
<div class="post-footer">
<div class="post-footer-line post-footer-line-1">
<span class="post-author vcard">
By
<span class="fn" itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person">
<span itemprop="name">Julien Tinnes</span>
</span>
</span>
<span class="post-timestamp">
-
<meta content="https://blog.cr0.org/2009/06/bypassing-linux-null-pointer.html" itemprop="url">
<a class="timestamp-link" href="https://blog.cr0.org/2009/06/bypassing-linux-null-pointer.html" rel="bookmark" title="permanent link"><abbr class="published" itemprop="datePublished" title="2009-06-26T11:37:00-07:00">June 26, 2009</abbr></a>
</span>
<span class="post-comment-link">
</span>
<span class="post-icons">
</span>
<div class="post-share-buttons goog-inline-block">
</div>
</div>
<div class="post-footer-line post-footer-line-2">
<span class="post-labels">
Labels:
<a href="https://blog.cr0.org/search/label/Linux" rel="tag">Linux</a>,
<a href="https://blog.cr0.org/search/label/Security" rel="tag">Security</a>,
<a href="https://blog.cr0.org/search/label/vulnerability" rel="tag">vulnerability</a>
</span>
</div>
<div class="post-footer-line post-footer-line-3">
<span class="post-location">
</span>
</div>
</div>
</div>
<div class="comments" id="comments">
<a name="comments"></a>
<h4>7 comments:</h4>
<div class="comments-content">
<script async="async" src="https://blog.cr0.org/2009/06/bypassing-linux-null-pointer.html" type="text/javascript"></script>
<script type="text/javascript">
    (function() {
      var items = null;
      var msgs = null;
      var config = {};

// <![CDATA[
      var cursor = null;
      if (items && items.length > 0) {
        cursor = parseInt(items[items.length - 1].timestamp) + 1;
      }

      var bodyFromEntry = function(entry) {
        var text = (entry &&
                    ((entry.content && entry.content.$t) ||
                     (entry.summary && entry.summary.$t))) ||
            '';
        if (entry && entry.gd$extendedProperty) {
          for (var k in entry.gd$extendedProperty) {
            if (entry.gd$extendedProperty[k].name == 'blogger.contentRemoved') {
              return '<span class="deleted-comment">' + text + '</span>';
            }
          }
        }
        return text;
      }

      var parse = function(data) {
        cursor = null;
        var comments = [];
        if (data && data.feed && data.feed.entry) {
          for (var i = 0, entry; entry = data.feed.entry[i]; i++) {
            var comment = {};
            // comment ID, parsed out of the original id format
            var id = /blog-(\d+).post-(\d+)/.exec(entry.id.$t);
            comment.id = id ? id[2] : null;
            comment.body = bodyFromEntry(entry);
            comment.timestamp = Date.parse(entry.published.$t) + '';
            if (entry.author && entry.author.constructor === Array) {
              var auth = entry.author[0];
              if (auth) {
                comment.author = {
                  name: (auth.name ? auth.name.$t : undefined),
                  profileUrl: (auth.uri ? auth.uri.$t : undefined),
                  avatarUrl: (auth.gd$image ? auth.gd$image.src : undefined)
                };
              }
            }
            if (entry.link) {
              if (entry.link[2]) {
                comment.link = comment.permalink = entry.link[2].href;
              }
              if (entry.link[3]) {
                var pid = /.*comments\/default\/(\d+)\?.*/.exec(entry.link[3].href);
                if (pid && pid[1]) {
                  comment.parentId = pid[1];
                }
              }
            }
            comment.deleteclass = 'item-control blog-admin';
            if (entry.gd$extendedProperty) {
              for (var k in entry.gd$extendedProperty) {
                if (entry.gd$extendedProperty[k].name == 'blogger.itemClass') {
                  comment.deleteclass += ' ' + entry.gd$extendedProperty[k].value;
                } else if (entry.gd$extendedProperty[k].name == 'blogger.displayTime') {
                  comment.displayTime = entry.gd$extendedProperty[k].value;
                }
              }
            }
            comments.push(comment);
          }
        }
        return comments;
      };

      var paginator = function(callback) {
        if (hasMore()) {
          var url = config.feed + '?alt=json&v=2&orderby=published&reverse=false&max-results=50';
          if (cursor) {
            url += '&published-min=' + new Date(cursor).toISOString();
          }
          window.bloggercomments = function(data) {
            var parsed = parse(data);
            cursor = parsed.length < 50 ? null
                : parseInt(parsed[parsed.length - 1].timestamp) + 1
            callback(parsed);
            window.bloggercomments = null;
          }
          url += '&callback=bloggercomments';
          var script = document.createElement('script');
          script.type = 'text/javascript';
          script.src = url;
          document.getElementsByTagName('head')[0].appendChild(script);
        }
      };
      var hasMore = function() {
        return !!cursor;
      };
      var getMeta = function(key, comment) {
        if ('iswriter' == key) {
          var matches = !!comment.author
              && comment.author.name == config.authorName
              && comment.author.profileUrl == config.authorUrl;
          return matches ? 'true' : '';
        } else if ('deletelink' == key) {
          return config.baseUri + '/delete-comment.g?blogID='
               + config.blogId + '&postID=' + comment.id;
        } else if ('deleteclass' == key) {
          return comment.deleteclass;
        }
        return '';
      };

      var replybox = null;
      var replyUrlParts = null;
      var replyParent = undefined;

      var onReply = function(commentId, domId) {
        if (replybox == null) {
          // lazily cache replybox, and adjust to suit this style:
          replybox = document.getElementById('comment-editor');
          if (replybox != null) {
            replybox.height = '250px';
            replybox.style.display = 'block';
            replyUrlParts = replybox.src.split('#');
          }
        }
        if (replybox && (commentId !== replyParent)) {
          replybox.src = '';
          document.getElementById(domId).insertBefore(replybox, null);
          replybox.src = replyUrlParts[0]
              + (commentId ? '&parentID=' + commentId : '')
              + '#' + replyUrlParts[1];
          replyParent = commentId;
        }
      };

      var hash = (window.location.hash || '#').substring(1);
      var startThread, targetComment;
      if (/^comment-form_/.test(hash)) {
        startThread = hash.substring('comment-form_'.length);
      } else if (/^c[0-9]+$/.test(hash)) {
        targetComment = hash.substring(1);
      }

      // Configure commenting API:
      var configJso = {
        'maxDepth': config.maxThreadDepth
      };
      var provider = {
        'id': config.postId,
        'data': items,
        'loadNext': paginator,
        'hasMore': hasMore,
        'getMeta': getMeta,
        'onReply': onReply,
        'rendered': true,
        'initComment': targetComment,
        'initReplyThread': startThread,
        'config': configJso,
        'messages': msgs
      };

      var render = function() {
        if (window.goog && window.goog.comments) {
          var holder = document.getElementById('comment-holder');
          window.goog.comments.render(holder, provider);
        }
      };

      // render now, or queue to render when library loads:
      if (window.goog && window.goog.comments) {
        render();
      } else {
        window.goog = window.goog || {};
        window.goog.comments = window.goog.comments || {};
        window.goog.comments.loadQueue = window.goog.comments.loadQueue || [];
        window.goog.comments.loadQueue.push(render);
      }
    })();
// ]]>
  </script>
<div id="comment-holder">
<div class="comment-thread toplevel-thread"><ol id="top-ra"><li class="comment" id="c3576085421076234864"><div class="avatar-image-container"><img src="./2009 - Bypassing Linux&#39; NULL pointer dereference exploit prevention (mmap_min_addr)_files/blogger_logo_round_35.png" alt=""></div><div class="comment-block"><div class="comment-header"><cite class="user"><a href="https://www.blogger.com/profile/05636781178145883012" rel="nofollow">Julien Tinnes</a></cite><span class="icon user blog-author"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.cr0.org/2009/06/bypassing-linux-null-pointer.html?showComment=1247760443418#c3576085421076234864">July 16, 2009 at 9:07 AM</a></span></div><p class="comment-content">Interestingly, with SELinux, it's likely that your SELinux policy will allow pulseaudio to mmap() at address zero anyway (seems to work on Fedora).<br><br>With SELinux, you don't need the personality trick, and having CVE-2009-1895 fixed is not going to help you, you need to update your policy instead.</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="3576085421076234864" href="javascript:;">Reply</a><span class="item-control blog-admin blog-admin pid-2062996147"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=8992811497323121233&amp;postID=3576085421076234864">Delete</a></span></span></div><div class="comment-replies"><div id="c3576085421076234864-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self" href="javascript:;">Replies</a></span></span><ol id="c3576085421076234864-ra" class="thread-chrome thread-expanded"><div></div><div id="c3576085421076234864-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="3576085421076234864" href="javascript:;">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c3576085421076234864-ce"></div></li><li class="comment" id="c8910146202438659118"><div class="avatar-image-container"><img src="./2009 - Bypassing Linux&#39; NULL pointer dereference exploit prevention (mmap_min_addr)_files/blank.gif" alt=""></div><div class="comment-block"><div class="comment-header"><cite class="user">Anonymous</cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.cr0.org/2009/06/bypassing-linux-null-pointer.html?showComment=1248125126041#c8910146202438659118">July 20, 2009 at 2:25 PM</a></span></div><p class="comment-content">BTW the first 2 things listed in your list of things you tried to do to bypass mmap_min_addr worked just fine for the first 6 months it was in the kernel ;)<br><br>-Brad</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="8910146202438659118" href="javascript:;">Reply</a><span class="item-control blog-admin blog-admin pid-818206072"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=8992811497323121233&amp;postID=8910146202438659118">Delete</a></span></span></div><div class="comment-replies"><div id="c8910146202438659118-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self" href="javascript:;">Replies</a></span></span><ol id="c8910146202438659118-ra" class="thread-chrome thread-expanded"><div></div><div id="c8910146202438659118-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="8910146202438659118" href="javascript:;">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c8910146202438659118-ce"></div></li><li class="comment" id="c8017612123216659731"><div class="avatar-image-container"><img src="./2009 - Bypassing Linux&#39; NULL pointer dereference exploit prevention (mmap_min_addr)_files/blank.gif" alt=""></div><div class="comment-block"><div class="comment-header"><cite class="user">Anonymous</cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.cr0.org/2009/06/bypassing-linux-null-pointer.html?showComment=1250457005467#c8017612123216659731">August 16, 2009 at 2:10 PM</a></span></div><p class="comment-content">I would assume that this should be considered a security bug in pulseaudio, right? Could you please report it there?</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="8017612123216659731" href="javascript:;">Reply</a><span class="item-control blog-admin blog-admin pid-818206072"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=8992811497323121233&amp;postID=8017612123216659731">Delete</a></span></span></div><div class="comment-replies"><div id="c8017612123216659731-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self" href="javascript:;">Replies</a></span></span><ol id="c8017612123216659731-ra" class="thread-chrome thread-expanded"><div></div><div id="c8017612123216659731-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="8017612123216659731" href="javascript:;">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c8017612123216659731-ce"></div></li><li class="comment" id="c6590406992887335759"><div class="avatar-image-container"><img src="./2009 - Bypassing Linux&#39; NULL pointer dereference exploit prevention (mmap_min_addr)_files/blogger_logo_round_35.png" alt=""></div><div class="comment-block"><div class="comment-header"><cite class="user"><a href="https://www.blogger.com/profile/05636781178145883012" rel="nofollow">Julien Tinnes</a></cite><span class="icon user blog-author"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.cr0.org/2009/06/bypassing-linux-null-pointer.html?showComment=1250457414643#c6590406992887335759">August 16, 2009 at 2:16 PM</a></span></div><p class="comment-content">No, it's not a bug in pulseaudio. It was a bug in the Linux kernel and we already corrected it there.</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="6590406992887335759" href="javascript:;">Reply</a><span class="item-control blog-admin blog-admin pid-2062996147"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=8992811497323121233&amp;postID=6590406992887335759">Delete</a></span></span></div><div class="comment-replies"><div id="c6590406992887335759-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self" href="javascript:;">Replies</a></span></span><ol id="c6590406992887335759-ra" class="thread-chrome thread-expanded"><div></div><div id="c6590406992887335759-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="6590406992887335759" href="javascript:;">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c6590406992887335759-ce"></div></li><li class="comment" id="c6750248747298942922"><div class="avatar-image-container"><img src="./2009 - Bypassing Linux&#39; NULL pointer dereference exploit prevention (mmap_min_addr)_files/blank.gif" alt=""></div><div class="comment-block"><div class="comment-header"><cite class="user">Anonymous</cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.cr0.org/2009/06/bypassing-linux-null-pointer.html?showComment=1258986474459#c6750248747298942922">November 23, 2009 at 6:27 AM</a></span></div><p class="comment-content">Could this be used to gain root in Android? The current method does not work anymore, they patched mmap_min_addr.</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="6750248747298942922" href="javascript:;">Reply</a><span class="item-control blog-admin blog-admin pid-818206072"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=8992811497323121233&amp;postID=6750248747298942922">Delete</a></span></span></div><div class="comment-replies"><div id="c6750248747298942922-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self" href="javascript:;">Replies</a></span></span><ol id="c6750248747298942922-ra" class="thread-chrome thread-expanded"><div></div><div id="c6750248747298942922-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="6750248747298942922" href="javascript:;">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c6750248747298942922-ce"></div></li><li class="comment" id="c183426246780533772"><div class="avatar-image-container"><img src="./2009 - Bypassing Linux&#39; NULL pointer dereference exploit prevention (mmap_min_addr)_files/blogger_logo_round_35.png" alt=""></div><div class="comment-block"><div class="comment-header"><cite class="user"><a href="https://www.blogger.com/profile/04032856273646677104" rel="nofollow">Unknown</a></cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.cr0.org/2009/06/bypassing-linux-null-pointer.html?showComment=1259587505352#c183426246780533772">November 30, 2009 at 5:25 AM</a></span></div><p class="comment-content">"So what we need is a setuid binary that will give us control back without going through exec."<br><br>We'd need to find such a binary on Android to use this method as far as I understand.</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="183426246780533772" href="javascript:;">Reply</a><span class="item-control blog-admin blog-admin pid-1480229445"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=8992811497323121233&amp;postID=183426246780533772">Delete</a></span></span></div><div class="comment-replies"><div id="c183426246780533772-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self" href="javascript:;">Replies</a></span></span><ol id="c183426246780533772-ra" class="thread-chrome thread-expanded"><div></div><div id="c183426246780533772-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="183426246780533772" href="javascript:;">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c183426246780533772-ce"></div></li><li class="comment" id="c296394368738341785"><div class="avatar-image-container"><img src="./2009 - Bypassing Linux&#39; NULL pointer dereference exploit prevention (mmap_min_addr)_files/blogger_logo_round_35.png" alt=""></div><div class="comment-block"><div class="comment-header"><cite class="user"><a href="https://www.blogger.com/profile/05636781178145883012" rel="nofollow">Julien Tinnes</a></cite><span class="icon user blog-author"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://blog.cr0.org/2009/06/bypassing-linux-null-pointer.html?showComment=1259884082559#c296394368738341785">December 3, 2009 at 3:48 PM</a></span></div><p class="comment-content">No, we fixed it on Android</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="296394368738341785" href="javascript:;">Reply</a><span class="item-control blog-admin blog-admin pid-2062996147"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=8992811497323121233&amp;postID=296394368738341785">Delete</a></span></span></div><div class="comment-replies"><div id="c296394368738341785-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self" href="javascript:;">Replies</a></span></span><ol id="c296394368738341785-ra" class="thread-chrome thread-expanded"><div></div><div id="c296394368738341785-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="296394368738341785" href="javascript:;">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c296394368738341785-ce"></div></li></ol><div id="top-continue" class="continue"><a class="comment-reply" target="_self" href="javascript:;">Add comment</a></div><div class="comment-replybox-thread" id="top-ce"></div><div class="loadmore hidden" data-post-id="5382334599747832580"><a target="_self">Load more...</a></div></div>
</div>
</div>
<p class="comment-footer">
New comments are not allowed.
</p>
<div id="backlinks-container">
<div id="Blog1_backlinks-container">
</div>
</div>
</div>
</div>

        </div></div>
      
</div>
<div class="blog-pager" id="blog-pager">
<span id="blog-pager-newer-link">
<a class="blog-pager-newer-link" href="https://blog.cr0.org/2009/07/old-school-local-root-vulnerability-in.html" id="Blog1_blog-pager-newer-link" title="Newer Post">Newer Post</a>
</span>
<span id="blog-pager-older-link">
<a class="blog-pager-older-link" href="https://blog.cr0.org/2009/05/time-stamp-counter-disabling-oddities.html" id="Blog1_blog-pager-older-link" title="Older Post">Older Post</a>
</span>
<a class="home-link" href="https://blog.cr0.org/">Home</a>
</div>
<div class="clear"></div>
<div class="post-feeds">
<div class="feed-links">
Subscribe to:
<a class="feed-link" href="https://blog.cr0.org/feeds/5382334599747832580/comments/default" target="_blank" type="application/atom+xml">Post Comments (Atom)</a>
</div>
</div>
</div></div>
</div>
</div>
<div class="column-left-outer">
<div class="column-left-inner">
<aside>
</aside>
</div>
</div>
<div class="column-right-outer">
<div class="column-right-inner">
<aside>
<div class="sidebar section" id="sidebar-right-1"><div class="widget PageList" data-version="1" id="PageList1">
<div class="widget-content">
<ul>
<li>
<a href="https://blog.cr0.org/">Home</a>
</li>
</ul>
<div class="clear"></div>
</div>
</div><div class="widget BlogArchive" data-version="1" id="BlogArchive1">
<h2>Blog Archive</h2>
<div class="widget-content">
<div id="ArchiveList">
<div id="BlogArchive1_ArchiveList">
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://blog.cr0.org/2021/">
2021
</a>
<span class="post-count" dir="ltr">(1)</span>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://blog.cr0.org/2021/06/">
June
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://blog.cr0.org/2012/">
2012
</a>
<span class="post-count" dir="ltr">(1)</span>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://blog.cr0.org/2012/09/">
September
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://blog.cr0.org/2010/">
2010
</a>
<span class="post-count" dir="ltr">(3)</span>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://blog.cr0.org/2010/04/">
April
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://blog.cr0.org/2010/03/">
March
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://blog.cr0.org/2010/01/">
January
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate expanded">
<a class="toggle" href="javascript:void(0)">
<span class="zippy toggle-open">

        ▼&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://blog.cr0.org/2009/">
2009
</a>
<span class="post-count" dir="ltr">(16)</span>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://blog.cr0.org/2009/11/">
November
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://blog.cr0.org/2009/10/">
October
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://blog.cr0.org/2009/09/">
September
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://blog.cr0.org/2009/08/">
August
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://blog.cr0.org/2009/07/">
July
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate expanded">
<a class="toggle" href="javascript:void(0)">
<span class="zippy toggle-open">

        ▼&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://blog.cr0.org/2009/06/">
June
</a>
<span class="post-count" dir="ltr">(1)</span>
<ul class="posts">
<li><a href="https://blog.cr0.org/2009/06/bypassing-linux-null-pointer.html">Bypassing Linux' NULL pointer dereference exploit ...</a></li>
</ul>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://blog.cr0.org/2009/05/">
May
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://blog.cr0.org/2009/04/">
April
</a>
<span class="post-count" dir="ltr">(4)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://blog.cr0.org/2009/03/">
March
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="clear"></div>
</div>
</div></div>
<table border="0" cellpadding="0" cellspacing="0" class="section-columns columns-2">
<tbody>
<tr>
<td class="first columns-cell">
<div class="sidebar section" id="sidebar-right-2-1"><div class="widget HTML" data-version="1" id="HTML1">
<h2 class="title">Julien Tinnes</h2>
<div class="widget-content">
<a href="https://www.linkedin.com/in/julientinnes/">LinkedIn</a><br>
<a href="https://www.cr0.org/">www.cr0.org</a><br>
<a href="https://keybase.io/jln">Keybase</a><br>
<a href="mailto:julien+blog@cr0.org">Contact me</a>
</div>
<div class="clear"></div>
</div></div>
</td>
<td class="columns-cell">
<div class="sidebar no-items section" id="sidebar-right-2-2"></div>
</td>
</tr>
</tbody>
</table>
<div class="sidebar no-items section" id="sidebar-right-3"></div>
</aside>
</div>
</div>
</div>
<div style="clear: both"></div>
<!-- columns -->
</div>
<!-- main -->
</div>
</div>
<div class="main-cap-bottom cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
<footer>
<div class="footer-outer">
<div class="footer-cap-top cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left footer-fauxborder-left">
<div class="fauxborder-right footer-fauxborder-right"></div>
<div class="region-inner footer-inner">
<div class="foot no-items section" id="footer-1"></div>
<table border="0" cellpadding="0" cellspacing="0" class="section-columns columns-2">
<tbody>
<tr>
<td class="first columns-cell">
<div class="foot no-items section" id="footer-2-1"></div>
</td>
<td class="columns-cell">
<div class="foot no-items section" id="footer-2-2"></div>
</td>
</tr>
</tbody>
</table>
<!-- outside of the include in order to lock Attribution widget -->
<div class="foot section" id="footer-3" name="Footer"><div class="widget Attribution" data-version="1" id="Attribution1">
<div class="widget-content" style="text-align: center;">
Simple theme. Powered by <a href="https://www.blogger.com/" target="_blank">Blogger</a>.
</div>
<div class="clear"></div>
</div></div>
</div>
</div>
<div class="footer-cap-bottom cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
</footer>
<!-- content -->
</div>
</div>
<div class="content-cap-bottom cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
</div>
<script type="text/javascript">
    window.setTimeout(function() {
        document.body.className = document.body.className.replace('loading', '');
      }, 10);
  </script>

<script type="text/javascript" src="./2009 - Bypassing Linux&#39; NULL pointer dereference exploit prevention (mmap_min_addr)_files/3630122430-widgets.js.下載"></script>
<script type="text/javascript">
window['__wavt'] = 'AOuZoY4hMKEX2POzUTUa7eg0ucnIUgJATw:1638405293715';_WidgetManager._Init('//www.blogger.com/rearrange?blogID\x3d8992811497323121233','//blog.cr0.org/2009/06/bypassing-linux-null-pointer.html','8992811497323121233');
_WidgetManager._SetDataContext([{'name': 'blog', 'data': {'blogId': '8992811497323121233', 'title': 'cr0 blog', 'url': 'https://blog.cr0.org/2009/06/bypassing-linux-null-pointer.html', 'canonicalUrl': 'https://blog.cr0.org/2009/06/bypassing-linux-null-pointer.html', 'homepageUrl': 'https://blog.cr0.org/', 'searchUrl': 'https://blog.cr0.org/search', 'canonicalHomepageUrl': 'https://blog.cr0.org/', 'blogspotFaviconUrl': 'https://blog.cr0.org/favicon.ico', 'bloggerUrl': 'https://www.blogger.com', 'hasCustomDomain': true, 'httpsEnabled': true, 'enabledCommentProfileImages': true, 'gPlusViewType': 'FILTERED_POSTMOD', 'adultContent': false, 'analyticsAccountNumber': '', 'encoding': 'UTF-8', 'locale': 'en', 'localeUnderscoreDelimited': 'en', 'languageDirection': 'ltr', 'isPrivate': false, 'isMobile': false, 'isMobileRequest': false, 'mobileClass': '', 'isPrivateBlog': false, 'isDynamicViewsAvailable': true, 'feedLinks': '\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22cr0 blog - Atom\x22 href\x3d\x22https://blog.cr0.org/feeds/posts/default\x22 /\x3e\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/rss+xml\x22 title\x3d\x22cr0 blog - RSS\x22 href\x3d\x22https://blog.cr0.org/feeds/posts/default?alt\x3drss\x22 /\x3e\n\x3clink rel\x3d\x22service.post\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22cr0 blog - Atom\x22 href\x3d\x22https://www.blogger.com/feeds/8992811497323121233/posts/default\x22 /\x3e\n\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22cr0 blog - Atom\x22 href\x3d\x22https://blog.cr0.org/feeds/5382334599747832580/comments/default\x22 /\x3e\n', 'meTag': '', 'adsenseHostId': 'ca-host-pub-1556223355139109', 'adsenseHasAds': false, 'adsenseAutoAds': false, 'ieCssRetrofitLinks': '\x3c!--[if IE]\x3e\x3cscript type\x3d\x22text/javascript\x22 src\x3d\x22https://www.blogger.com/static/v1/jsbin/1155466832-ieretrofit.js\x22\x3e\x3c/script\x3e\n\x3c![endif]--\x3e', 'view': '', 'dynamicViewsCommentsSrc': '//www.blogblog.com/dynamicviews/4224c15c4e7c9321/js/comments.js', 'dynamicViewsScriptSrc': '//www.blogblog.com/dynamicviews/67d499d0d1051f24', 'plusOneApiSrc': 'https://apis.google.com/js/plusone.js', 'disableGComments': true, 'sharing': {'platforms': [{'name': 'Get link', 'key': 'link', 'shareMessage': 'Get link', 'target': ''}, {'name': 'Facebook', 'key': 'facebook', 'shareMessage': 'Share to Facebook', 'target': 'facebook'}, {'name': 'BlogThis!', 'key': 'blogThis', 'shareMessage': 'BlogThis!', 'target': 'blog'}, {'name': 'Twitter', 'key': 'twitter', 'shareMessage': 'Share to Twitter', 'target': 'twitter'}, {'name': 'Pinterest', 'key': 'pinterest', 'shareMessage': 'Share to Pinterest', 'target': 'pinterest'}, {'name': 'Email', 'key': 'email', 'shareMessage': 'Email', 'target': 'email'}], 'disableGooglePlus': true, 'googlePlusShareButtonWidth': 0, 'googlePlusBootstrap': '\x3cscript type\x3d\x22text/javascript\x22\x3ewindow.___gcfg \x3d {\x27lang\x27: \x27en\x27};\x3c/script\x3e'}, 'hasCustomJumpLinkMessage': false, 'jumpLinkMessage': 'Read more', 'pageType': 'item', 'postId': '5382334599747832580', 'pageName': 'Bypassing Linux\x27 NULL pointer dereference exploit prevention (mmap_min_addr)', 'pageTitle': 'cr0 blog: Bypassing Linux\x27 NULL pointer dereference exploit prevention (mmap_min_addr)'}}, {'name': 'features', 'data': {'sharing_get_link_dialog': 'true', 'sharing_native': 'false'}}, {'name': 'messages', 'data': {'edit': 'Edit', 'linkCopiedToClipboard': 'Link copied to clipboard!', 'ok': 'Ok', 'postLink': 'Post Link'}}, {'name': 'template', 'data': {'name': 'Simple', 'localizedName': 'Simple', 'isResponsive': false, 'isAlternateRendering': false, 'isCustom': false, 'variant': 'dark', 'variantId': 'dark'}}, {'name': 'view', 'data': {'classic': {'name': 'classic', 'url': '?view\x3dclassic'}, 'flipcard': {'name': 'flipcard', 'url': '?view\x3dflipcard'}, 'magazine': {'name': 'magazine', 'url': '?view\x3dmagazine'}, 'mosaic': {'name': 'mosaic', 'url': '?view\x3dmosaic'}, 'sidebar': {'name': 'sidebar', 'url': '?view\x3dsidebar'}, 'snapshot': {'name': 'snapshot', 'url': '?view\x3dsnapshot'}, 'timeslide': {'name': 'timeslide', 'url': '?view\x3dtimeslide'}, 'isMobile': false, 'title': 'Bypassing Linux\x27 NULL pointer dereference exploit prevention (mmap_min_addr)', 'description': 'EDIT3: Slashdot , the SANS Institute , Threatpost  and others have a story about an exploit by Bradley Spengler  which uses our technique to...', 'url': 'https://blog.cr0.org/2009/06/bypassing-linux-null-pointer.html', 'type': 'item', 'isSingleItem': true, 'isMultipleItems': false, 'isError': false, 'isPage': false, 'isPost': true, 'isHomepage': false, 'isArchive': false, 'isLabelSearch': false, 'postId': 5382334599747832580}}]);
_WidgetManager._RegisterWidget('_HeaderView', new _WidgetInfo('Header1', 'header', document.getElementById('Header1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogView', new _WidgetInfo('Blog1', 'main', document.getElementById('Blog1'), {'cmtInteractionsEnabled': false, 'lightboxEnabled': true, 'lightboxModuleUrl': 'https://www.blogger.com/static/v1/jsbin/1670773809-lbx.js', 'lightboxCssUrl': 'https://www.blogger.com/static/v1/v-css/4076883957-lightbox_bundle.css'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_PageListView', new _WidgetInfo('PageList1', 'sidebar-right-1', document.getElementById('PageList1'), {'title': '', 'links': [{'isCurrentPage': false, 'href': 'https://blog.cr0.org/', 'title': 'Home'}], 'mobile': false}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogArchiveView', new _WidgetInfo('BlogArchive1', 'sidebar-right-1', document.getElementById('BlogArchive1'), {'languageDirection': 'ltr', 'loadingMessage': 'Loading\x26hellip;'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HTMLView', new _WidgetInfo('HTML1', 'sidebar-right-2-1', document.getElementById('HTML1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_AttributionView', new _WidgetInfo('Attribution1', 'footer-3', document.getElementById('Attribution1'), {}, 'displayModeFull'));
</script>

</body></html>